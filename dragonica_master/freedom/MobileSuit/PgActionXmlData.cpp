#include "stdafx.h"
#include "PgActionXmlData.h"

bool PgActionXmlData::Init()
{
	m_kContPath.insert( std::make_pair("A_ACCELERATION", "SKILL/FIGHTER/WARRIOR/ACCELERATION.XML") );
	m_kContPath.insert( std::make_pair("A_ACID ARROW", "SKILL/ARCHER/HUNTER/ACIDARROW.XML") );
	m_kContPath.insert( std::make_pair("A_ACT", "ACTION/ACT.XML") );
	m_kContPath.insert( std::make_pair("A_ADRENALIN", "SKILL/ARCHER/RANGER/SNIPER/ADRENALIN.XML") );
	m_kContPath.insert( std::make_pair("A_AIMING", "SKILL/ARCHER/RANGER/SNIPER/AIMING.XML") );
	m_kContPath.insert( std::make_pair("A_AIONOFF", "SKILL/PET/AIONOFF.XML") );
	m_kContPath.insert( std::make_pair("A_AIR_SMASH", "SKILL/SUMMONER/AIR_SMASH.XML") );
	m_kContPath.insert( std::make_pair("A_AIR_SPRASH", "SKILL/SUMMONER/AIR_SPRASH.XML") );
	m_kContPath.insert( std::make_pair("A_ANNIHILATION", "SKILL/FIGHTER/WARRIOR/ANNIHILATION.XML") );
	m_kContPath.insert( std::make_pair("A_APOLLO", "ACTION/ITEMSKILL/A_APOLLO.XML") );
	m_kContPath.insert( std::make_pair("A_APPEAR", "ACTION/APPEAR.XML") );
	m_kContPath.insert( std::make_pair("A_APPEARANCECHANGE", "ACTION/APPEARANCECHANGE.XML") );
	m_kContPath.insert( std::make_pair("A_APRIL FOOL", "SKILL/THIEF/ASSASSIN/APRILFOOL.XML") );
	m_kContPath.insert( std::make_pair("A_ARAM_BACKWARD_SKILL", "SKILL/ARAMMUTISHA/ARAM_BACKWARD.XML") );
	m_kContPath.insert( std::make_pair("A_ARAM_FRONTWARD_SKILL", "SKILL/ARAMMUTISHA/ARAM_FRONTWARD.XML") );
	m_kContPath.insert( std::make_pair("A_ARC SANCTUARY", "SKILL/MAGICIAN/MAGE/ARCSANCTUARY.XML") );
	m_kContPath.insert( std::make_pair("A_ARC SANCTUARY_PLAY", "SKILL/MAGICIAN/MAGE/ARCSANCTUARY_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHERFLOATSHOT_01", "SKILL/ARCHER/ARCHERFLOATSHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_BACKSTEP_SHOT", "SKILL/ARCHER/ARCHER_BACKSTEP_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_BACK_JUMP_SHOT", "SKILL/ARCHER/ARCHER_BACK_JUMP_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_CHARGE_ARROW", "SKILL/ARCHER/ARCHER_CHARGE_ARROW.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_CHARGE_SHOT", "SKILL/ARCHER/ARCHER_CHARGE_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_DASH_ATTACK", "SKILL/ARCHER/ARCHER_DASHATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_DOWN_SHOT", "SKILL/ARCHER/ARCHER_DOWN_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_FRIENDSHIP", "SKILL/ARCHER/ARCHERFRIENDSHIP.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_JUMP_SHOT", "SKILL/ARCHER/ARCHER_JUMP_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_MELEE", "SKILL/ARCHER/ARCHER_MELEE.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_POWER_SHOT", "SKILL/ARCHER/ARCHER_POWER_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ARCHER_SHOT_01", "SKILL/ARCHER/ARCHER_SHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_ARC_DOWN_ATTACK_01", "SKILL/ARCHER/ARC_DOWNATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_ARC_DOWN_ATTACK_02", "SKILL/ARCHER/ARC_DOWNATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_ARC_DOWN_ATTACK_03", "SKILL/ARCHER/ARC_DOWNATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_ARC_DOWN_ATTACK_FLY", "SKILL/ARCHER/ARC_DOWNATTACK_FLY.XML") );
	m_kContPath.insert( std::make_pair("A_ARMOR BREAK", "SKILL/FIGHTER/ARMORBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_ARROW SHOWER", "SKILL/ARCHER/ARROW_SHOWER.XML") );
	m_kContPath.insert( std::make_pair("A_ASCENSIONDRAGON", "SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/ASCENSIONDRAGON.XML") );
	m_kContPath.insert( std::make_pair("A_ASS_ATTK_DASH", "SKILL/THIEF/ASSASSIN/SIDEDASHATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_ATROPINE", "SKILL/ARCHER/RANGER/SNIPER/ATROPINE.XML") );
	m_kContPath.insert( std::make_pair("A_ATTACK_ADD", "ACTION/ITEMSKILL/ATTACK_ADD.XML") );
	m_kContPath.insert( std::make_pair("A_AUTO SHOOT SYSTEM", "SKILL/ARCHER/RANGER/AUTOSHOOTSYSTEM.XML") );
	m_kContPath.insert( std::make_pair("A_AUTO SHOOT SYSTEM_FIRE", "SKILL/ARCHER/RANGER/AUTOSHOOTSYSTEM_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_AUTO SHOOT SYSTEM_PLAY", "SKILL/ARCHER/RANGER/AUTOSHOOTSYSTEM_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_AWAKECHARGE", "SKILL/COMMON/AWAKECHARGE.XML") );
	m_kContPath.insert( std::make_pair("A_BACK DRAFT", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/BACKDRAFT.XML") );
	m_kContPath.insert( std::make_pair("A_BACK DRAFT FIRE", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/BACKDRAFTFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_BACK_STEP", "ACTION/BACKSTEP.XML") );
	m_kContPath.insert( std::make_pair("A_BARRICADE", "SKILL/FIGHTER/KNIGHT/PALADIN/BARRICADE.XML") );
	m_kContPath.insert( std::make_pair("A_BARRIER", "SKILL/MAGICIAN/MAGE/WIZARD/BARRIER.XML") );
	m_kContPath.insert( std::make_pair("A_BATTLE_IDLE", "ACTION/BATTLE_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_BEAR HANK", "SKILL/FIGHTER/BEARHANK.XML") );
	m_kContPath.insert( std::make_pair("A_BEAR_EMERGENCY_ESCAPE", "SKILL/COMMON/BEAR_EMERGENCY_ESCAPE.XML") );
	m_kContPath.insert( std::make_pair("A_BEAUTIFUL GIRL", "SKILL/ARCHER/BEAUTIFUL_GIRL.XML") );
	m_kContPath.insert( std::make_pair("A_BEG", "EMOTIONS/BEG.XML") );
	m_kContPath.insert( std::make_pair("A_BITE_OFF", "SKILL/PET/BITEOFF.XML") );
	m_kContPath.insert( std::make_pair("A_BLEEDING", "SKILL/ARCHER/BLEEDING.XML") );
	m_kContPath.insert( std::make_pair("A_BLESSING", "SKILL/MAGICIAN/MAGE/WIZARD/BLESSING.XML") );
	m_kContPath.insert( std::make_pair("A_BLIND", "ACTION/BLIND.XML") );
	m_kContPath.insert( std::make_pair("A_BLINK", "SKILL/MAGICIAN/BLINK.XML") );
	m_kContPath.insert( std::make_pair("A_BLITZ", "SKILL/ARCHER/HUNTER/TRAPPER/BLITZ.XML") );
	m_kContPath.insert( std::make_pair("A_BLITZ_PLAY", "SKILL/ARCHER/HUNTER/TRAPPER/BLITZ_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_BLIZZARD", "SKILL/MAGICIAN/BATTLEMAGE/BLIZZARD.XML") );
	m_kContPath.insert( std::make_pair("A_BLIZZARD_ATTACK", "SKILL/MAGICIAN/BATTLEMAGE/BLIZZARD_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_BLIZZARD_PET_A", "SKILL/PET/BLIZZARD_A.XML") );
	m_kContPath.insert( std::make_pair("A_BLIZZARD_PET_B", "SKILL/PET/BLIZZARD_B.XML") );
	m_kContPath.insert( std::make_pair("A_BLIZZARD_PET_C", "SKILL/PET/BLIZZARD_C.XML") );
	m_kContPath.insert( std::make_pair("A_BLOCK", "ACTION/BLOCK.XML") );
	m_kContPath.insert( std::make_pair("A_BLOODY LORE", "SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODYLORE.XML") );
	m_kContPath.insert( std::make_pair("A_BLOODY_MELEE_01", "SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODY_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_BLOODY_MELEE_02", "SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODY_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_BLOODY_MELEE_03", "SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODY_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_DOWN", "ACTION/BLOWDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_UP_LARGE", "ACTION/BLOWUPLARGE.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_UP_LARGE_MON", "ACTION/A_BLOW_UP_LARGE_MON.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_UP_MEDIUM", "ACTION/BLOWUPMEDIUM.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_UP_MEDIUM_MON", "ACTION/A_BLOW_UP_MEDIUM_MON.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_UP_SMALL", "ACTION/BLOWUPSMALL.XML") );
	m_kContPath.insert( std::make_pair("A_BLOW_UP_SMALL_MON", "ACTION/A_BLOW_UP_SMALL_MON.XML") );
	m_kContPath.insert( std::make_pair("A_BODY_BUMP_A", "SKILL/PET/BODYBUMP_A.XML") );
	m_kContPath.insert( std::make_pair("A_BODY_BUMP_B", "SKILL/PET/BODYBUMP_B.XML") );
	m_kContPath.insert( std::make_pair("A_BODY_BUMP_C", "SKILL/PET/BODYBUMP_C.XML") );
	m_kContPath.insert( std::make_pair("A_BOMB_PET", "SKILL/PET/BOMB_PET.XML") );
	m_kContPath.insert( std::make_pair("A_BONEDRAGON_DIE", "SKILL/BONEDRAGON/BONEDRAGON_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_BONEDRAGON_ENDING_MOVIE", "SKILL/BONEDRAGON/BONEDRAGON_ENDING_MOVIE.XML") );
	m_kContPath.insert( std::make_pair("A_BONEDRAGON_SUMMON_MONSTER", "SKILL/BONEDRAGON/BONEDRAGON_SUMMON_MONSTER.XML") );
	m_kContPath.insert( std::make_pair("A_BOOBY TRAP", "SKILL/ARCHER/RANGER/SNIPER/BOOBYTRAP.XML") );
	m_kContPath.insert( std::make_pair("A_BOOBY TRAP_PLAY", "SKILL/ARCHER/RANGER/SNIPER/BOOBYTRAP_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_BOSS_DIE_MOVIE", "SKILL/MONSTER/MON_BOSS_DIE_MOVIE.XML") );
	m_kContPath.insert( std::make_pair("A_BOW", "EMOTIONS/BOW.XML") );
	m_kContPath.insert( std::make_pair("A_BREAKABLE_OBJECT_PULLDOWN", "ACTION/BREAKABLE_OBJECT_PULLDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_BREAKDOWN", "EMOTIONS/BREAKDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_BREAK_FALL", "ACTION/BREAKFALL.XML") );
	m_kContPath.insert( std::make_pair("A_BREATH_OF_NATURE", "SKILL/SUMMONER/BREATH_OF_NATURE.XML") );
	m_kContPath.insert( std::make_pair("A_BROTHER IS GONE", "SKILL/FIGHTER/BROTHERISGONE.XML") );
	m_kContPath.insert( std::make_pair("A_BROTHER IS GONE_PLAY", "SKILL/FIGHTER/BROTHERISGONE_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_BROTHER IS RETURN", "SKILL/FIGHTER/BROTHERISRETURN.XML") );
	m_kContPath.insert( std::make_pair("A_BROTHER IS RETURN_PLAY", "SKILL/FIGHTER/BROTHERISRETURN_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_BRO_ADOGEN", "SKILL/SPECIAL/BROADOGEN.XML") );
	m_kContPath.insert( std::make_pair("A_BRO_ADOGEN_FIRE", "SKILL/SPECIAL/BROADOGENFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_BRO_SPIN", "SKILL/SPECIAL/BROSPIN.XML") );
	m_kContPath.insert( std::make_pair("A_BRO_SPIN_FIRE", "SKILL/SPECIAL/BROSPINFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_BUFF_ADD", "ACTION/ITEMSKILL/BUFF_ADD.XML") );
	m_kContPath.insert( std::make_pair("A_BUGS LIFE", "SKILL/FIGHTER/KNIGHT/PALADIN/BUGSLIFE.XML") );
	m_kContPath.insert( std::make_pair("A_BULLDOG_CANCLE", "ACTION/BULLDOG_CANCLE.XML") );
	m_kContPath.insert( std::make_pair("A_BULLDOG_IDLE", "ACTION/BULLDOG_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_BULLDOG_SELECT", "ACTION/BULLDOG_SELECT.XML") );
	m_kContPath.insert( std::make_pair("A_BULLDOG_SELECT_IDLE", "ACTION/BULLDOG_SELECT_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_BURBERRIAN", "SKILL/MAGICIAN/MAGICIAN_BURBERRIAN.XML") );
	m_kContPath.insert( std::make_pair("A_BURBERRIAN_FREEZE", "SKILL/MAGICIAN/SKILLACTOR/BURBERRIAN_FREEZE.XML") );
	m_kContPath.insert( std::make_pair("A_BURROW1", "SKILL/THIEF/BURROW.XML") );
	m_kContPath.insert( std::make_pair("A_BURROW2", "SKILL/THIEF/BURROW2.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_A", "SKILL/ARCHER/BW_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_B", "SKILL/ARCHER/BW_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C", "SKILL/ARCHER/BW_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C_4_C", "SKILL/ARCHER/BW_COMBO_C_4_C.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C_4_F1", "SKILL/ARCHER/BW_COMBO_C_4_F1.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C_4_F2", "SKILL/ARCHER/BW_COMBO_C_4_F2.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C_4_F3", "SKILL/ARCHER/BW_COMBO_C_4_F3.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C_4_F4", "SKILL/ARCHER/BW_COMBO_C_4_F4.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_C_4_F5", "SKILL/ARCHER/BW_COMBO_C_4_F5.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_D", "SKILL/ARCHER/BW_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_E", "SKILL/ARCHER/BW_COMBO_E.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_1_1", "SKILL/ARCHER/BW_COMBO_Z_1_1.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_1_2", "SKILL/ARCHER/BW_COMBO_Z_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_1_3", "SKILL/ARCHER/BW_COMBO_Z_1_3.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_2_1", "SKILL/ARCHER/BW_COMBO_Z_2_1.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_2_2", "SKILL/ARCHER/BW_COMBO_Z_2_2.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_3_1", "SKILL/ARCHER/BW_COMBO_Z_3_1.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_3_1_2", "SKILL/ARCHER/BW_COMBO_Z_3_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_3_2", "SKILL/ARCHER/BW_COMBO_Z_3_2.XML") );
	m_kContPath.insert( std::make_pair("A_BW_COMBO_Z_4_1", "SKILL/ARCHER/BW_COMBO_Z_4_1.XML") );
	m_kContPath.insert( std::make_pair("A_CALL_TRANS", "SKILL/PET/CALL_TRANS.XML") );
	m_kContPath.insert( std::make_pair("A_CALTRAP", "SKILL/THIEF/ASSASSIN/NINJA/CALTRAP.XML") );
	m_kContPath.insert( std::make_pair("A_CALTRAP SET", "SKILL/THIEF/ASSASSIN/NINJA/CALTRAPSET.XML") );
	m_kContPath.insert( std::make_pair("A_CAMOUFLAGE", "SKILL/ARCHER/RANGER/CAMOUFLAGE.XML") );
	m_kContPath.insert( std::make_pair("A_CARPET BOMBING", "SKILL/ARCHER/RANGER/SNIPER/CARPETBOMBING.XML") );
	m_kContPath.insert( std::make_pair("A_CARPET BOMBING_PLAY", "SKILL/ARCHER/RANGER/SNIPER/CARPETBOMBING_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_A", "SKILL/ARCHER/CBW_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_A_MULTISHOT", "SKILL/ARCHER/CBW_COMBO_A_MULTISHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_A_TWOACTION", "SKILL/ARCHER/CBW_COMBO_A_TWOACTION.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_B", "SKILL/ARCHER/CBW_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_B_MULTISHOT", "SKILL/ARCHER/CBW_COMBO_B_MULTISHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_B_TWOACTION", "SKILL/ARCHER/CBW_COMBO_B_TWOACTION.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C", "SKILL/ARCHER/CBW_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_4_C", "SKILL/ARCHER/CBW_COMBO_C_4_C.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_4_F1", "SKILL/ARCHER/CBW_COMBO_C_4_F1.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_4_F2", "SKILL/ARCHER/CBW_COMBO_C_4_F2.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_4_F3", "SKILL/ARCHER/CBW_COMBO_C_4_F3.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_4_F4", "SKILL/ARCHER/CBW_COMBO_C_4_F4.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_4_F5", "SKILL/ARCHER/CBW_COMBO_C_4_F5.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_MULTISHOT", "SKILL/ARCHER/CBW_COMBO_C_MULTISHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_C_TWOACTION", "SKILL/ARCHER/CBW_COMBO_C_TWOACTION.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_D", "SKILL/ARCHER/CBW_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_D_MULTISHOT", "SKILL/ARCHER/CBW_COMBO_D_MULTISHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_D_TWOACTION", "SKILL/ARCHER/CBW_COMBO_D_TWOACTION.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_E", "SKILL/ARCHER/CBW_COMBO_E.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_E_MULTISHOT", "SKILL/ARCHER/CBW_COMBO_E_MULTISHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_E_TWOACTION", "SKILL/ARCHER/CBW_COMBO_E_TWOACTION.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_1_1", "SKILL/ARCHER/CBW_COMBO_Z_1_1.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_1_2", "SKILL/ARCHER/CBW_COMBO_Z_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_1_3", "SKILL/ARCHER/CBW_COMBO_Z_1_3.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_2_1", "SKILL/ARCHER/CBW_COMBO_Z_2_1.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_2_2", "SKILL/ARCHER/CBW_COMBO_Z_2_2.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_3_1", "SKILL/ARCHER/CBW_COMBO_Z_3_1.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_3_1_2", "SKILL/ARCHER/CBW_COMBO_Z_3_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_3_2", "SKILL/ARCHER/CBW_COMBO_Z_3_2.XML") );
	m_kContPath.insert( std::make_pair("A_CBW_COMBO_Z_4_1", "SKILL/ARCHER/CBW_COMBO_Z_4_1.XML") );
	m_kContPath.insert( std::make_pair("A_CHAIN CRASH", "SKILL/THIEF/CLOWN/CHAINCRASH.XML") );
	m_kContPath.insert( std::make_pair("A_CHAIN HURRICANE KICK", "SKILL/THIEF/ASSASSIN/NINJA/CHAINHURRICANEKICK.XML") );
	m_kContPath.insert( std::make_pair("A_CHAIN LIGHTNING", "SKILL/MAGICIAN/MAGE/WIZARD/CHAINLIGHTNING.XML") );
	m_kContPath.insert( std::make_pair("A_CHAINSHIELD", "SKILL/FIGHTER/KNIGHT/PALADIN/CHAINSHIELD.XML") );
	m_kContPath.insert( std::make_pair("A_CHAINSHIELD_PLAY", "SKILL/FIGHTER/KNIGHT/PALADIN/CHAINSHIELD_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_CHANGE NINJA", "SKILL/THIEF/ASSASSIN/NINJA/CHANGENINJA.XML") );
	m_kContPath.insert( std::make_pair("A_CHANGE_DANCER", "SKILL/THIEF/CLOWN/DANCER/CHANGEDANCER.XML") );
	m_kContPath.insert( std::make_pair("A_CHARGE", "ACTION/CHARGE.XML") );
	m_kContPath.insert( std::make_pair("A_CLASS_PROMOTION_DRAGONIAN", "ACTION/CLASS_PROMOTION_DRAGONIAN.XML") );
	m_kContPath.insert( std::make_pair("A_CLASS_PROMOTION_HUMAN", "ACTION/CLASS_PROMOTION_HUMAN.XML") );
	m_kContPath.insert( std::make_pair("A_CLAW FISHING", "SKILL/THIEF/CLOWN/DANCER/MANIAC/CLAWFISHING.XML") );
	m_kContPath.insert( std::make_pair("A_CLAW FISHING_FINISH", "SKILL/THIEF/CLOWN/DANCER/MANIAC/CLAWFISHINGFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_CLAYMORE", "SKILL/ARCHER/RANGER/CLAYMORE.XML") );
	m_kContPath.insert( std::make_pair("A_CLAYMORE_EXPLOSION", "SKILL/ARCHER/RANGER/CLAYMORE_EXPLOSION.XML") );
	m_kContPath.insert( std::make_pair("A_CLOUD KILL", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/CLOUDKILL.XML") );
	m_kContPath.insert( std::make_pair("A_CLOUD KILL FIRE", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/CLOUDKILL_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_CLOWN_SLIDING_TACKLE", "SKILL/THIEF/CLOWN/CLOWN_SLIDINGTACKLE.XML") );
	m_kContPath.insert( std::make_pair("A_CLUB_MANIA", "SKILL/THIEF/CLOWN/DANCER/MANIAC/CLUBMANIA.XML") );
	m_kContPath.insert( std::make_pair("A_CLUB_MANIA2", "SKILL/THIEF/CLOWN/DANCER/MANIAC/CLUBMANIAFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A", "SKILL/THIEF/CL_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_2", "SKILL/THIEF/CL_COMBO_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_3", "SKILL/THIEF/CL_COMBO_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_4", "SKILL/THIEF/CL_COMBO_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_5", "SKILL/THIEF/CL_COMBO_A_5.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_5_6", "SKILL/THIEF/CL_COMBO_A_5_6.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_6", "SKILL/THIEF/CL_COMBO_A_6.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_A_7", "SKILL/THIEF/CL_COMBO_A_7.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_B", "SKILL/THIEF/CL_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_B_3", "SKILL/THIEF/CL_COMBO_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_B_4", "SKILL/THIEF/CL_COMBO_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_B_5", "SKILL/THIEF/CL_COMBO_B_5.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_B_6", "SKILL/THIEF/CL_COMBO_B_6.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_B_7", "SKILL/THIEF/CL_COMBO_B_7.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_C", "SKILL/THIEF/CL_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_C_4", "SKILL/THIEF/CL_COMBO_C_4.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_C_5", "SKILL/THIEF/CL_COMBO_C_5.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_C_6", "SKILL/THIEF/CL_COMBO_C_6.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_D", "SKILL/THIEF/CL_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_D_5", "SKILL/THIEF/CL_COMBO_D_5.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_D_6", "SKILL/THIEF/CL_COMBO_D_6.XML") );
	m_kContPath.insert( std::make_pair("A_CL_COMBO_E", "SKILL/THIEF/CL_COMBO_E.XML") );
	m_kContPath.insert( std::make_pair("A_CMD_BROADCAST", "SKILL/COMMON/CMDBROADCAST.XML") );
	m_kContPath.insert( std::make_pair("A_COKE SCREW UPPER", "SKILL/THIEF/CLOWN/DANCER/COKESCREWUPPER.XML") );
	m_kContPath.insert( std::make_pair("A_COMBAT_REVIVE_ACT", "ACTION/COMBAT_REVIVE_ACT.XML") );
	m_kContPath.insert( std::make_pair("A_CONCENTRATION", "SKILL/MAGICIAN/MAGICIAN_CONCENTRATION.XML") );
	m_kContPath.insert( std::make_pair("A_CONDOR ATTACK", "SKILL/ARCHER/CONDOR_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_COUPLE_LOVER", "SKILL/COMMON/COUPLE_LOVER.XML") );
	m_kContPath.insert( std::make_pair("A_CRINGE", "ACTION/CRINGE.XML") );
	m_kContPath.insert( std::make_pair("A_CROSS CUT", "SKILL/FIGHTER/KNIGHT/PALADIN/CROSSCUT.XML") );
	m_kContPath.insert( std::make_pair("A_CROSSBLADE", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/A_CROSSBLADE.XML") );
	m_kContPath.insert( std::make_pair("A_CROSSBLADE_PLAY", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/A_CROSSBLADE_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_CRUX SHOT", "SKILL/ARCHER/HUNTER/CRUXSHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CRY", "EMOTIONS/CRY.XML") );
	m_kContPath.insert( std::make_pair("A_CURE", "SKILL/MAGICIAN/MAGE/CURE.XML") );
	m_kContPath.insert( std::make_pair("A_CUSHION SHOT", "SKILL/ARCHER/CUSHION_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A", "SKILL/THIEF/CU_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_2", "SKILL/THIEF/CU_COMBO_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_3", "SKILL/THIEF/CU_COMBO_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_4", "SKILL/THIEF/CU_COMBO_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_5", "SKILL/THIEF/CU_COMBO_A_5.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_5_6", "SKILL/THIEF/CU_COMBO_A_5_6.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_6", "SKILL/THIEF/CU_COMBO_A_6.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_A_7", "SKILL/THIEF/CU_COMBO_A_7.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_B", "SKILL/THIEF/CU_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_B_3", "SKILL/THIEF/CU_COMBO_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_B_4", "SKILL/THIEF/CU_COMBO_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_B_5", "SKILL/THIEF/CU_COMBO_B_5.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_B_6", "SKILL/THIEF/CU_COMBO_B_6.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_B_7", "SKILL/THIEF/CU_COMBO_B_7.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_C", "SKILL/THIEF/CU_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_C_4", "SKILL/THIEF/CU_COMBO_C_4.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_C_5", "SKILL/THIEF/CU_COMBO_C_5.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_C_6", "SKILL/THIEF/CU_COMBO_C_6.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_D", "SKILL/THIEF/CU_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_D_5", "SKILL/THIEF/CU_COMBO_D_5.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_D_6", "SKILL/THIEF/CU_COMBO_D_6.XML") );
	m_kContPath.insert( std::make_pair("A_CU_COMBO_E", "SKILL/THIEF/CU_COMBO_E.XML") );
	m_kContPath.insert( std::make_pair("A_DAEPODONG", "SKILL/ARCHER/DAEPODONG.XML") );
	m_kContPath.insert( std::make_pair("A_DANCE_01", "EMOTIONS/DANCE01.XML") );
	m_kContPath.insert( std::make_pair("A_DANCE_02", "EMOTIONS/DANCE02.XML") );
	m_kContPath.insert( std::make_pair("A_DANCE_03", "EMOTIONS/DANCE03.XML") );
	m_kContPath.insert( std::make_pair("A_DARK_CLOUD_A", "SKILL/PET/DARK_CLOUD_A.XML") );
	m_kContPath.insert( std::make_pair("A_DARK_CLOUD_B", "SKILL/PET/DARK_CLOUD_B.XML") );
	m_kContPath.insert( std::make_pair("A_DARK_CLOUD_C", "SKILL/PET/DARK_CLOUD_C.XML") );
	m_kContPath.insert( std::make_pair("A_DARK_CLOUD_PLAY_A", "SKILL/PET/DARK_CLOUD_PLAY_A.XML") );
	m_kContPath.insert( std::make_pair("A_DARK_CLOUD_PLAY_B", "SKILL/PET/DARK_CLOUD_PLAY_B.XML") );
	m_kContPath.insert( std::make_pair("A_DARK_CLOUD_PLAY_C", "SKILL/PET/DARK_CLOUD_PLAY_C.XML") );
	m_kContPath.insert( std::make_pair("A_DASH", "ACTION/DASH.XML") );
	m_kContPath.insert( std::make_pair("A_DASH_AFTER_ATTK", "SKILL/PET/DASH_BITE.XML") );
	m_kContPath.insert( std::make_pair("A_DASH_ATTACK", "SKILL/COMMON/DASHATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_DASH_BLOWUP", "SKILL/FIGHTER/WARRIOR/DASHBLOWUP.XML") );
	m_kContPath.insert( std::make_pair("A_DASH_JUMP", "ACTION/DASH_JUMP.XML") );
	m_kContPath.insert( std::make_pair("A_DASH_KOONA", "ACTION/DASH_KOONA.XML") );
	m_kContPath.insert( std::make_pair("A_DC_DOWN_01", "SKILL/THIEF/CLOWN/DANCER/DC_DOWNATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_DC_DOWN_02", "SKILL/THIEF/CLOWN/DANCER/DC_DOWNATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_DC_MELEE_01", "SKILL/THIEF/CLOWN/DANCER/DC_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_DC_MELEE_02", "SKILL/THIEF/CLOWN/DANCER/DC_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_DC_MELEE_03", "SKILL/THIEF/CLOWN/DANCER/DC_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_DC_MELEE_04", "SKILL/THIEF/CLOWN/DANCER/DC_MELEE_04.XML") );
	m_kContPath.insert( std::make_pair("A_DC_MELEE_05", "SKILL/THIEF/CLOWN/DANCER/DC_MELEE_05.XML") );
	m_kContPath.insert( std::make_pair("A_DC_MELEE_DROP_01", "SKILL/THIEF/CLOWN/DANCER/DC_MELEE_DROP.XML") );
	m_kContPath.insert( std::make_pair("A_DEATH BOUND", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEATHBOUND.XML") );
	m_kContPath.insert( std::make_pair("A_DEATH SNATCH", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSNATCH.XML") );
	m_kContPath.insert( std::make_pair("A_DEATH SNATCH_FINISH", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSNATCHFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_DEATH SNATCH_HAND_MOVE", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSNATCHHANDMOVE.XML") );
	m_kContPath.insert( std::make_pair("A_DEATHSTINGER", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSTINGER.XML") );
	m_kContPath.insert( std::make_pair("A_DEATHSTINGERSA", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSTINGERSA.XML") );
	m_kContPath.insert( std::make_pair("A_DEBUFF_ADD", "ACTION/ITEMSKILL/DEBUFF_ADD.XML") );
	m_kContPath.insert( std::make_pair("A_DEFENCE_DEC", "ACTION/ITEMSKILL/DEFENCE_DEC.XML") );
	m_kContPath.insert( std::make_pair("A_DEFENCE_TOTEM", "ACTION/ITEMSKILL/DEFENCE_TOTEM.XML") );
	m_kContPath.insert( std::make_pair("A_DEFENSIVE AURA", "SKILL/FIGHTER/KNIGHT/PALADIN/DEFENSIVEAURA.XML") );
	m_kContPath.insert( std::make_pair("A_DEMOLITIONCHARGE", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGE.XML") );
	m_kContPath.insert( std::make_pair("A_DEMOLITIONCHARGE1", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGE1.XML") );
	m_kContPath.insert( std::make_pair("A_DEMOLITIONCHARGE2", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGE2.XML") );
	m_kContPath.insert( std::make_pair("A_DEMOLITIONCHARGESA", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGESA.XML") );
	m_kContPath.insert( std::make_pair("A_DEMOLITION_BOMBER_IDLE", "SKILL/MASTER_SUMMON/DEMOLITIONBOMBER_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_DETECTION", "SKILL/MAGICIAN/MAGICIAN_DETECTION.XML") );
	m_kContPath.insert( std::make_pair("A_DETONATOR", "SKILL/ARCHER/RANGER/DETONATOR.XML") );
	m_kContPath.insert( std::make_pair("A_DEXTERITY", "SKILL/THIEF/CLOWN/DEXTERITY.XML") );
	m_kContPath.insert( std::make_pair("A_DIE", "ACTION/DIE.XML") );
	m_kContPath.insert( std::make_pair("A_DIE2", "ACTION/DIE2.XML") );
	m_kContPath.insert( std::make_pair("A_DIE_BLOWUP", "ACTION/DIE_BLOWUP.XML") );
	m_kContPath.insert( std::make_pair("A_DIE_BLOWUP2", "ACTION/DIE_BLOWUP2.XML") );
	m_kContPath.insert( std::make_pair("A_DIE_BLOWUP3", "ACTION/DIE_BLOWUP3.XML") );
	m_kContPath.insert( std::make_pair("A_DIE_HARD", "ACTION/ITEMSKILL/DIE_HARD.XML") );
	m_kContPath.insert( std::make_pair("A_DIE_SLOWMOTION", "ACTION/DIE_SLOWMOTION.XML") );
	m_kContPath.insert( std::make_pair("A_DIE_SLOWMOTION_CHANGE", "ACTION/DIE_SLOWMOTION2.XML") );
	m_kContPath.insert( std::make_pair("A_DISEASE", "SKILL/MAGICIAN/MAGE/DISEASE.XML") );
	m_kContPath.insert( std::make_pair("A_DISPLACEMENT", "SKILL/ARCHER/HUNTER/DISPLACEMENT.XML") );
	m_kContPath.insert( std::make_pair("A_DIVINE PROTECTION", "SKILL/FIGHTER/DIVINEPROTECTION.XML") );
	m_kContPath.insert( std::make_pair("A_DMG", "ACTION/DMG.XML") );
	m_kContPath.insert( std::make_pair("A_DOMINATION", "ACTION/DOMINATION.XML") );
	m_kContPath.insert( std::make_pair("A_DON'T TOUCH ME!", "SKILL/ARCHER/HUNTER/TRAPPER/DON'TTOUCHME.XML") );
	m_kContPath.insert( std::make_pair("A_DOUBLE CRASH", "SKILL/THIEF/CLOWN/DOUBLECRASH.XML") );
	m_kContPath.insert( std::make_pair("A_DOUBLESHOT", "SKILL/ARCHER/DOUBLESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_DOUBLESHOT_CAST", "SKILL/MAGICIAN/MAGE/WIZARD/DOUBLESHOT_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_ATTACK_01", "SKILL/COMMON/DOWNATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_ATTACK_02", "SKILL/COMMON/DOWNATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_ATTACK_03", "SKILL/COMMON/DOWNATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_ATTACK_FLY", "SKILL/COMMON/DOWNATTACK_FLY.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_DAMAGE", "ACTION/DOWN_DMG.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_DAMAGE_2", "ACTION/DOWN_DMG2.XML") );
	m_kContPath.insert( std::make_pair("A_DOWN_SHOT", "SKILL/COMMON/DOWN_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_DRAGON_DIVE", "SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/A_DRAGON_DIVE.XML") );
	m_kContPath.insert( std::make_pair("A_DRAGON_DIVE_FINISH", "SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/A_DRAGON_DIVE_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_DRAGON_RAGE_FINISH", "SKILL/SUMMONER/DRAGON_RAGE_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_DRAGON_RAGE_START", "SKILL/SUMMONER/DRAGON_RAGE_START.XML") );
	m_kContPath.insert( std::make_pair("A_DRAGON_TOOTH", "SKILL/SUMMONER/DRAGON_TOOTH.XML") );
	m_kContPath.insert( std::make_pair("A_DUEL_SLOWMOTION", "ACTION/DUEL_SLOWMOTION.XML") );
	m_kContPath.insert( std::make_pair("A_DUEL_VICTORY", "ACTION/DUEL_VICTORY.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP BLEEDING", "SKILL/FIGHTER/DUMP8.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP BLINDNESS", "SKILL/FIGHTER/DUMP2.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP BURN", "SKILL/FIGHTER/DUMP7.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP COLD", "SKILL/FIGHTER/DUMP5.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP CURSE", "SKILL/FIGHTER/DUMP14.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP FREEZE", "SKILL/FIGHTER/DUMP12.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP HARD BURN", "SKILL/FIGHTER/DUMP10.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP HARD POISON", "SKILL/FIGHTER/DUMP4.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP OVER BLEEDING", "SKILL/FIGHTER/DUMP11.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP POISON", "SKILL/FIGHTER/DUMP1.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP SLEEP", "SKILL/FIGHTER/DUMP3.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP SLIENCE", "SKILL/FIGHTER/DUMP13.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP SLOW", "SKILL/FIGHTER/DUMP15.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP STONE", "SKILL/FIGHTER/DUMP6.XML") );
	m_kContPath.insert( std::make_pair("A_DUMP STUN", "SKILL/FIGHTER/DUMP9.XML") );
	m_kContPath.insert( std::make_pair("A_EARTHQUAKE", "SKILL/FIGHTER/EARTHQUAKE.XML") );
	m_kContPath.insert( std::make_pair("A_EARTH_QUAKE_CAST", "SKILL/SUMMONER/EARTH_QUAKE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_EARTH_QUAKE_FIRE", "SKILL/SUMMONER/EARTH_QUAKE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_EARTH_CAST", "SKILL/SUMMONER/ELESTORM_EARTH_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_EARTH_FIRE", "SKILL/SUMMONER/ELESTORM_EARTH_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_FLAME_CAST", "SKILL/SUMMONER/ELESTORM_FLAME_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_FLAME_FIRE", "SKILL/SUMMONER/ELESTORM_FLAME_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_ICE_CAST", "SKILL/SUMMONER/ELESTORM_ICE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_ICE_FIRE", "SKILL/SUMMONER/ELESTORM_ICE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_LIGHTNING_CAST", "SKILL/SUMMONER/ELESTORM_LIGHTNING_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_LIGHTNING_FIRE", "SKILL/SUMMONER/ELESTORM_LIGHTNING_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ELESTORM_START", "SKILL/SUMMONER/ELESTORM_START.XML") );
	m_kContPath.insert( std::make_pair("A_EMERGENCY_RETREAT", "SKILL/MAGICIAN/MAGE/WIZARD/EMERGENCYRETREAT.XML") );
	m_kContPath.insert( std::make_pair("A_EMERGENCY_RETREAT_PLAY", "SKILL/MAGICIAN/MAGE/WIZARD/EMERGENCYRETREAT_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_GRAPHAND", "EMOTIONS/GRAP_HAND.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_GRAPHAND2", "EMOTIONS/GRAP_HAND2.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_HUG", "EMOTIONS/HUG.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_HUG2", "EMOTIONS/HUG2.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_KISS", "EMOTIONS/KISS.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_KISS2", "EMOTIONS/KISS2.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_REST07", "EMOTIONS/REST07.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_REST072", "EMOTIONS/REST072.XML") );
	m_kContPath.insert( std::make_pair("A_EMOTION_WEDDING", "EMOTIONS/WEDDING.XML") );
	m_kContPath.insert( std::make_pair("A_EMP", "SKILL/ARCHER/EMP.XML") );
	m_kContPath.insert( std::make_pair("A_ENDING_MOVIE", "SKILL/ARAMMUTISHA/ENDING_MOVIE.XML") );
	m_kContPath.insert( std::make_pair("A_ENERGY BALL", "SKILL/MAGICIAN/BATTLEMAGE/ENERGY_BALL.XML") );
	m_kContPath.insert( std::make_pair("A_ENERGY BALL FIRE", "SKILL/MAGICIAN/BATTLEMAGE/ENERGY_BALL_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ENERGY BURSTER", "SKILL/MAGICIAN/MAGE/ENERGYBUSTER.XML") );
	m_kContPath.insert( std::make_pair("A_ENTERING_PVP", "ACTION/ENTERINGPVP.XML") );
	m_kContPath.insert( std::make_pair("A_EVADE_ADD", "ACTION/ITEMSKILL/EVADE_ADD.XML") );
	m_kContPath.insert( std::make_pair("A_EXERCISE", "ACTION/EXERCISE.XML") );
	m_kContPath.insert( std::make_pair("A_EXIT", "SKILL/THIEF/EXIT.XML") );
	m_kContPath.insert( std::make_pair("A_EXPLOSION DRAGON", "SKILL/THIEF/ASSASSIN/NINJA/EXPLOSIONDRAGON.XML") );
	m_kContPath.insert( std::make_pair("A_EXPLOSION DRAGON_PLAY", "SKILL/THIEF/ASSASSIN/NINJA/EXPLOSIONDRAGON_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_FAKE_CAST", "ACTION/FAKE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_FALCON BEAT", "SKILL/ARCHER/HUNTER/FALCONBEAT.XML") );
	m_kContPath.insert( std::make_pair("A_FALCON BEAT_PLAY", "SKILL/ARCHER/HUNTER/FALCONBEAT_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_FALL", "ACTION/FALL.XML") );
	m_kContPath.insert( std::make_pair("A_FALLING LEAF01", "SKILL/THIEF/ASSASSIN/NINJA/KILLINGMIST.XML") );
	m_kContPath.insert( std::make_pair("A_FAST CAST", "SKILL/MAGICIAN/MAGE/FASTCAST.XML") );
	m_kContPath.insert( std::make_pair("A_FIGHTER_FRIENDSHIP", "SKILL/FIGHTER/FIGHTERFRIENDSHIP.XML") );
	m_kContPath.insert( std::make_pair("A_FIGHTER_JUMP_ATTACK", "SKILL/FIGHTER/FIGHTER_JUMP_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_FIG_FLOATDOWNBLOW1", "SKILL/FIGHTER/FIG_FLOATDOWNBLOW.XML") );
	m_kContPath.insert( std::make_pair("A_FIG_FLOATDOWNBLOW2", "SKILL/FIGHTER/FIG_FLOATDOWNBLOW2.XML") );
	m_kContPath.insert( std::make_pair("A_FINAL DECISION", "SKILL/THIEF/CLOWN/FINALDECISION.XML") );
	m_kContPath.insert( std::make_pair("A_FIRE YOUTH", "SKILL/FIGHTER/FIREYOUTH.XML") );
	m_kContPath.insert( std::make_pair("A_FIRE_BALL_PET", "SKILL/PET/FIREBALL.XML") );
	m_kContPath.insert( std::make_pair("A_FIRE_BALL_PET2", "SKILL/PET/FIREBALL2.XML") );
	m_kContPath.insert( std::make_pair("A_FIRE_CLOUD", "SKILL/PET/FIRE_CLOUD.XML") );
	m_kContPath.insert( std::make_pair("A_FIRE_HURRICANE", "SKILL/PET/FIRE_HURRICANE.XML") );
	m_kContPath.insert( std::make_pair("A_FLASH BANG", "SKILL/ARCHER/RANGER/SNIPER/FLASHBANG.XML") );
	m_kContPath.insert( std::make_pair("A_FLOAT_DMG", "ACTION/FLOATDMG.XML") );
	m_kContPath.insert( std::make_pair("A_FLOAT_DMG_SMALL", "ACTION/FLOATDMG_SMALL.XML") );
	m_kContPath.insert( std::make_pair("A_FLOAT_DMG_VERY_SMALL", "ACTION/FLOATDMG_VERYSMALL.XML") );
	m_kContPath.insert( std::make_pair("A_FLOAT_MELEE_01", "SKILL/FIGHTER/FLOATMELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_FLOAT_MELEE_02", "SKILL/FIGHTER/FLOATMELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_FLOAT_MELEE_03", "SKILL/FIGHTER/FLOATMELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_FLOP", "EMOTIONS/FLOP.XML") );
	m_kContPath.insert( std::make_pair("A_FLY", "ACTION/FLY.XML") );
	m_kContPath.insert( std::make_pair("A_FLY_TO_CAMERA", "ACTION/FLYTOCAMERA.XML") );
	m_kContPath.insert( std::make_pair("A_FOOD_DROP", "SKILL/PET/FOOD_DROP.XML") );
	m_kContPath.insert( std::make_pair("A_FORGET PAIN", "SKILL/FIGHTER/FORGETPAIN.XML") );
	m_kContPath.insert( std::make_pair("A_FORTRESS", "SKILL/MAGICIAN/FORTRESS.XML") );
	m_kContPath.insert( std::make_pair("A_FREEZE", "ACTION/FREEZE.XML") );
	m_kContPath.insert( std::make_pair("A_FREEZING TRAP", "SKILL/ARCHER/HUNTER/TRAPPER/FREEZINGTRAP.XML") );
	m_kContPath.insert( std::make_pair("A_FREEZING TRAP ACTIVE", "SKILL/ARCHER/HUNTER/TRAPPER/FREEZINGTRAPACTIVE.XML") );
	m_kContPath.insert( std::make_pair("A_FROZEN_CHAIN_CAST", "SKILL/SUMMONER/FROZEN_CHAIN_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_FROZEN_CLOUD", "SKILL/PET/FROZEN_CLOUD.XML") );
	m_kContPath.insert( std::make_pair("A_FROZEN_SHOT_PLAY", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/FROZENSHOT_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_FURY_CAMERA", "SKILL/MONSTER/FURY_CAMERA.XML") );
	m_kContPath.insert( std::make_pair("A_GATLING RUSH", "SKILL/ARCHER/RANGER/SNIPER/GATLINGRUSH.XML") );
	m_kContPath.insert( std::make_pair("A_GENESIC GEAR - OFFENSE", "SKILL/FIGHTER/GENESICGEAR-OFFENSE.XML") );
	m_kContPath.insert( std::make_pair("A_GENESIC GEAR - PROTECT", "SKILL/FIGHTER/GENESICGEAR-PROTECT.XML") );
	m_kContPath.insert( std::make_pair("A_GIMMLET", "SKILL/THIEF/ASSASSIN/GIMILET.XML") );
	m_kContPath.insert( std::make_pair("A_GOLD_RUSH", "SKILL/PET/GOLDRUSH.XML") );
	m_kContPath.insert( std::make_pair("A_GROUND MINE", "SKILL/THIEF/ASSASSIN/NINJA/GROUNDMINE.XML") );
	m_kContPath.insert( std::make_pair("A_GROUNDZERO", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/GROUNDZERO.XML") );
	m_kContPath.insert( std::make_pair("A_GROUNDZERO_CREATURE_IDLE", "SKILL/MASTER_SUMMON/GROUNDZERO_CREATURE_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_GROUNDZERO_FINISH", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/GROUNDZEROFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_GROUND_PISTON", "SKILL/SUMMONER/GROUND_PISTON.XML") );
	m_kContPath.insert( std::make_pair("A_GROW BODY", "SKILL/FIGHTER/WARRIOR/GROWBODY.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_A", "SKILL/SUMMONER/GS_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_B", "SKILL/SUMMONER/GS_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C", "SKILL/SUMMONER/GS_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C_4_F0", "SKILL/SUMMONER/GS_COMBO_C_4_F0.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C_4_F1", "SKILL/SUMMONER/GS_COMBO_C_4_F1.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C_4_F2", "SKILL/SUMMONER/GS_COMBO_C_4_F2.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C_4_F3", "SKILL/SUMMONER/GS_COMBO_C_4_F3.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C_4_F4", "SKILL/SUMMONER/GS_COMBO_C_4_F4.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_C_4_F5", "SKILL/SUMMONER/GS_COMBO_C_4_F5.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_D", "SKILL/SUMMONER/GS_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_1", "SKILL/SUMMONER/GS_COMBO_Z_1.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_1_2", "SKILL/SUMMONER/GS_COMBO_Z_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_1_2_3", "SKILL/SUMMONER/GS_COMBO_Z_1_2_3.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_1_3", "SKILL/SUMMONER/GS_COMBO_Z_1_3.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_2", "SKILL/SUMMONER/GS_COMBO_Z_2.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_2_3", "SKILL/SUMMONER/GS_COMBO_Z_2_3.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_2_3_4", "SKILL/SUMMONER/GS_COMBO_Z_2_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_2_4", "SKILL/SUMMONER/GS_COMBO_Z_2_4.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_3", "SKILL/SUMMONER/GS_COMBO_Z_3.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_3_4", "SKILL/SUMMONER/GS_COMBO_Z_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_GS_COMBO_Z_4", "SKILL/SUMMONER/GS_COMBO_Z_4.XML") );
	m_kContPath.insert( std::make_pair("A_GUILD_ACCELERATION", "SKILL/GUILD/GUILD_ACCELERATION.XML") );
	m_kContPath.insert( std::make_pair("A_GUST SLASH", "SKILL/FIGHTER/WARRIOR/GLADIATOR/GUSTSLASH.XML") );
	m_kContPath.insert( std::make_pair("A_HADES_SKILL", "ACTION/ITEMSKILL/A_HADES_SKILL.XML") );
	m_kContPath.insert( std::make_pair("A_HAMMER CRUSH", "SKILL/FIGHTER/HAMMERCRUSH.XML") );
	m_kContPath.insert( std::make_pair("A_HANDCLAP", "EMOTIONS/HANDCLAP.XML") );
	m_kContPath.insert( std::make_pair("A_HANG", "ACTION/HANG.XML") );
	m_kContPath.insert( std::make_pair("A_HAPHAZARD", "SKILL/THIEF/ASSASSIN/HAPHAZARD.XML") );
	m_kContPath.insert( std::make_pair("A_HE GRANADE", "SKILL/ARCHER/HUNTER/TRAPPER/HEGRANADE.XML") );
	m_kContPath.insert( std::make_pair("A_HEAD_SPIN", "SKILL/THIEF/CLOWN/DANCER/HEAD_SPIN.XML") );
	m_kContPath.insert( std::make_pair("A_HEALINGWAVE", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/HEALINGWAVE.XML") );
	m_kContPath.insert( std::make_pair("A_HEARTLESS LIFE", "SKILL/FIGHTER/HEARTLESSLIFE.XML") );
	m_kContPath.insert( std::make_pair("A_HEAVY_DASH", "SKILL/PET/HEAVYDASH.XML") );
	m_kContPath.insert( std::make_pair("A_HELLSHOUT", "SKILL/THIEF/CLOWN/DANCER/MANIAC/HELLSHOUT.XML") );
	m_kContPath.insert( std::make_pair("A_HELLSHOUT_PLAY", "SKILL/THIEF/CLOWN/DANCER/MANIAC/A_HELLSHOUT_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_HI", "EMOTIONS/HI.XML") );
	m_kContPath.insert( std::make_pair("A_HIDE", "ACTION/HIDE.XML") );
	m_kContPath.insert( std::make_pair("A_HITRATE_UP", "SKILL/FIGHTER/KNIGHT/PALADIN/HITRATEUP.XML") );
	m_kContPath.insert( std::make_pair("A_HIT_BUFF", "ACTION/ITEMSKILL/HIT_BUFF.XML") );
	m_kContPath.insert( std::make_pair("A_HOLD_DOWN", "ACTION/HOLDDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_HOLY ARMOR", "SKILL/FIGHTER/KNIGHT/PALADIN/HOLYARMOR.XML") );
	m_kContPath.insert( std::make_pair("A_HOMING MISSILE", "SKILL/ARCHER/RANGER/SNIPER/HOMMINGMISSILE.XML") );
	m_kContPath.insert( std::make_pair("A_HOMING MISSILE GROUND", "SKILL/ARCHER/RANGER/SNIPER/HOMMINGMISSILEGROUND.XML") );
	m_kContPath.insert( std::make_pair("A_HONOR", "EMOTIONS/HONOR.XML") );
	m_kContPath.insert( std::make_pair("A_HP RESTORE", "SKILL/MAGICIAN/MAGE/WIZARD/HPRESTORE.XML") );
	m_kContPath.insert( std::make_pair("A_HURRICANE", "SKILL/PET/HURRICANE.XML") );
	m_kContPath.insert( std::make_pair("A_HURRICANE_P", "SKILL/PET/HURRICANE_P.XML") );
	m_kContPath.insert( std::make_pair("A_HYPER STRENGTH", "SKILL/THIEF/CLOWN/HYPERSTRENGTH.XML") );
	m_kContPath.insert( std::make_pair("A_ICEBERG", "SKILL/THIEF/ASSASSIN/NINJA/ICEBERG.XML") );
	m_kContPath.insert( std::make_pair("A_ICEBERG_PLAY", "SKILL/THIEF/ASSASSIN/NINJA/ICEBERG_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_ICESHOWER", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/ICESHOWER.XML") );
	m_kContPath.insert( std::make_pair("A_ICESHOWERSA", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/ICESHOWERSA.XML") );
	m_kContPath.insert( std::make_pair("A_ICYCLE BOLT", "SKILL/MAGICIAN/BATTLEMAGE/ICYCLE BOLT.XML") );
	m_kContPath.insert( std::make_pair("A_IDLE", "ACTION/IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_IDLE_02", "ACTION/IDLE02.XML") );
	m_kContPath.insert( std::make_pair("A_IDLE_03", "ACTION/IDLE03.XML") );
	m_kContPath.insert( std::make_pair("A_IDLE_KOONA", "ACTION/IDLE_KOONA.XML") );
	m_kContPath.insert( std::make_pair("A_IMPACT_PRESSURE", "SKILL/SUMMONER/IMPACT_PRESSURE.XML") );
	m_kContPath.insert( std::make_pair("A_IMPACT_UNSUMMON", "SKILL/SUMMONER/IMPACT_UNSUMMON.XML") );
	m_kContPath.insert( std::make_pair("A_INCREASED DEFENCE", "SKILL/FIGHTER/INCREASEDDEFENCE.XML") );
	m_kContPath.insert( std::make_pair("A_INCREASED STATUS", "SKILL/ARCHER/INCREASED_STATUS.XML") );
	m_kContPath.insert( std::make_pair("A_INFERNO", "SKILL/SUMMONER/INFERNO.XML") );
	m_kContPath.insert( std::make_pair("A_INSTANCE HEAL", "SKILL/MAGICIAN/MAGE/INSTANCEHEAL.XML") );
	m_kContPath.insert( std::make_pair("A_INTELLUGENT", "SKILL/THIEF/CLOWN/INTELLUGENT.XML") );
	m_kContPath.insert( std::make_pair("A_INTERACTIVE_WALTZ", "EMOTIONS/WALTZ.XML") );
	m_kContPath.insert( std::make_pair("A_INTERACTIVE_WALTZ2", "EMOTIONS/WALTZ2.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_DOWN", "ACTION/INTRO_DOWN.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_DOWN_IDLE", "ACTION/INTRO_DOWN_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_IDLE", "ACTION/INTRO_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_SELECT", "ACTION/INTRO_SELECT.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_SELECT_BACK", "ACTION/INTRO_SELECT_BACK.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_SELECT_IDLE", "ACTION/INTRO_SELECT_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_INTRO_UP", "ACTION/INTRO_UP.XML") );
	m_kContPath.insert( std::make_pair("A_JEUS_SKILL", "ACTION/ITEMSKILL/A_JEUS_SKILL.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_AXE", "SKILL/JOBSKILL/JOBAXE.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_AXE_END", "SKILL/JOBSKILL/JOBAXE_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_CHAINSAW", "SKILL/JOBSKILL/JOBCHAINSAW.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_CHAINSAW_END", "SKILL/JOBSKILL/JOBCHAINSAW_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_COMMON", "SKILL/JOBSKILL/JOBCOMMON.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_DRILL", "SKILL/JOBSKILL/JOBDRILL.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_DRILL_END", "SKILL/JOBSKILL/JOBDRILL_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_FISHING", "SKILL/JOBSKILL/JOBFISHING.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_FISHING_END", "SKILL/JOBSKILL/JOBFISHING_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_FISHNET", "SKILL/JOBSKILL/JOBFISHNET.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_FISHNET_END", "SKILL/JOBSKILL/JOBFISHNET_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_HOE", "SKILL/JOBSKILL/JOBHOE.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_HOE_END", "SKILL/JOBSKILL/JOBHOE_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_PICK", "SKILL/JOBSKILL/JOBPICK.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_PICK_END", "SKILL/JOBSKILL/JOBPICK_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_WEEDER", "SKILL/JOBSKILL/JOBWEEDER.XML") );
	m_kContPath.insert( std::make_pair("A_JOB_WEEDER_END", "SKILL/JOBSKILL/JOBWEEDER_END.XML") );
	m_kContPath.insert( std::make_pair("A_JOINT BREAK", "SKILL/FIGHTER/KNIGHT/JOINTBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_JUDGE DREAD", "SKILL/THIEF/CLOWN/JUDGEDREAD.XML") );
	m_kContPath.insert( std::make_pair("A_JUMP", "ACTION/JUMP.XML") );
	m_kContPath.insert( std::make_pair("A_JUMP_KOONA", "ACTION/JUMP_KOONA.XML") );
	m_kContPath.insert( std::make_pair("A_JUMP_SHOT", "SKILL/COMMON/JUMP_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_KEEPING_WATER", "ACTION/KEEPING_WATER.XML") );
	m_kContPath.insert( std::make_pair("A_KILLING MIST01", "SKILL/THIEF/ASSASSIN/NINJA/FALLINGLEAF.XML") );
	m_kContPath.insert( std::make_pair("A_KNIGHT_BRO_SPIN", "SKILL/FIGHTER/KNIGHT/KNIGHT_BROSPIN.XML") );
	m_kContPath.insert( std::make_pair("A_KNIGHT_BRO_SPIN_FIRE", "SKILL/FIGHTER/KNIGHT/KNIGHT_BROSPINFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_KNI_DASHDOWNBLOW", "SKILL/FIGHTER/KNIGHT/KNI_DASHDOWNBLOW.XML") );
	m_kContPath.insert( std::make_pair("A_KNOCKBACK_DOWN", "ACTION/KNOCKBACK_DOWN.XML") );
	m_kContPath.insert( std::make_pair("A_KNOCKDOWN", "ACTION/KNOCKDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_KNOCK_BACK", "ACTION/KNOCKBACK.XML") );
	m_kContPath.insert( std::make_pair("A_KNOCK_BACK_SMALL", "ACTION/KNOCKBACKSMALL.XML") );
	m_kContPath.insert( std::make_pair("A_KOH_AREA_BOMB", "ACTION/KOH_AREA_BOMB.XML") );
	m_kContPath.insert( std::make_pair("A_KOH_GUARDIAN_CHANGE_BLUE", "ACTION/KOH_GUARDIAN_CHANGE_BLUE.XML") );
	m_kContPath.insert( std::make_pair("A_KOH_GUARDIAN_CHANGE_RED", "ACTION/KOH_GUARDIAN_CHANGE_RED.XML") );
	m_kContPath.insert( std::make_pair("A_KOZAKS DANCE", "SKILL/THIEF/CLOWN/DANCER/KOZAKSDANCE.XML") );
	m_kContPath.insert( std::make_pair("A_KOZAKS DANCE FIRE", "SKILL/THIEF/CLOWN/DANCER/KOZAKSDANCE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_LADDER_DASH", "ACTION/LADDER_DASH.XML") );
	m_kContPath.insert( std::make_pair("A_LADDER_DOWN", "ACTION/LADDER_DOWN.XML") );
	m_kContPath.insert( std::make_pair("A_LADDER_IDLE", "ACTION/LADDER_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_LADDER_UP", "ACTION/LADDER_UP.XML") );
	m_kContPath.insert( std::make_pair("A_LAUGH", "EMOTIONS/LAUGH.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_APPEAR", "SKILL/LAVALON/LAVALON_APPEAR.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_BLAZE", "SKILL/LAVALON/LAVALON_BLAZE.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_BREATH_C", "SKILL/LAVALON/LAVALON_BREATH_C.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_BREATH_L", "SKILL/LAVALON/LAVALON_BREATH_L.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_BREATH_R", "SKILL/LAVALON/LAVALON_BREATH_R.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_DIE", "SKILL/LAVALON/LAVALON_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_DMG_01", "SKILL/LAVALON/LAVALON_DMG_01.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_HEART_DIE", "SKILL/LAVALON/LAVALON_HEART_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_HEART_METEOR", "SKILL/LAVALON/LAVALON_HEART_METEOR.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_HEART_METEOR_BLUE", "SKILL/LAVALON/LAVALON_HEART_METEOR_BLUE.XML") );
	m_kContPath.insert( std::make_pair("A_LAVALON_POWERBREAK", "SKILL/LAVALON/LAVALON_POWERBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_LAZER_PET", "SKILL/PET/LAZER_PET.XML") );
	m_kContPath.insert( std::make_pair("A_LIE", "EMOTIONS/LIE.XML") );
	m_kContPath.insert( std::make_pair("A_LIE_DOWN", "ACTION/LIE_DOWN.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTING_STORM", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTINGSTORM.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTING_STORM2", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTINGSTORMFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNING SLASH", "SKILL/THIEF/ASSASSIN/NINJA/LIGHTNINGSLASH.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNINGMARGNET", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTNINGMARGNET.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNINGMARGNETPLAY", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTNINGMARGNETPLAY.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNINGMARGNETSA", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTNINGMARGNETSA.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNING_ARMOR", "SKILL/MAGICIAN/LIGHTNINGARMOR.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNING_DEFAULT", "ACTION/LIGHTNING_DMG.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNING_FLOAT_DMG", "ACTION/LIGHTNINGFLOATDMG.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNING_LOW", "ACTION/LIGHTNING_DMG_LOW.XML") );
	m_kContPath.insert( std::make_pair("A_LIGHTNING_THROW_DOWN", "ACTION/LIGHTNINGTHROWDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_LIONS_CRYING", "SKILL/PET/LIONSCRYING.XML") );
	m_kContPath.insert( std::make_pair("A_LIONS_TOOTH", "SKILL/PET/LIONSTOOTH.XML") );
	m_kContPath.insert( std::make_pair("A_LOCK_MOVE", "ACTION/LOCK_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_LOVE", "EMOTIONS/LOVE.XML") );
	m_kContPath.insert( std::make_pair("A_LUCKY_STRIKE", "SKILL/PET/LUCKYSTRIKE.XML") );
	m_kContPath.insert( std::make_pair("A_MAGCICANNON_SHOT", "SKILL/LAVALON/MAGCICANNON_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MAGEFLOATSHOT_01", "SKILL/MAGICIAN/MAGE/MAGEFLOATSHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_MAGEFLOATSHOT_02", "SKILL/MAGICIAN/MAGE/MAGEFLOATSHOT_02.XML") );
	m_kContPath.insert( std::make_pair("A_MAGEFLOATSHOT_03", "SKILL/MAGICIAN/MAGE/MAGEFLOATSHOT_03.XML") );
	m_kContPath.insert( std::make_pair("A_MAGE_DOWN_SHOT", "SKILL/MAGICIAN/MAGE/MAGE_DOWN_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MAGIC MISSILE", "SKILL/MAGICIAN/BATTLEMAGE/MAGICMISSILE.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICCANNON_ONLY_CAST", "SKILL/LAVALON/MAGICCANNON_ONLYCAST.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIANFLOATSHOT_01", "SKILL/MAGICIAN/MAGICIANFLOATSHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIANFLOATSHOT_02", "SKILL/MAGICIAN/MAGICIANFLOATSHOT_02.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIANFLOATSHOT_03", "SKILL/MAGICIAN/MAGICIANFLOATSHOT_03.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIANSHOT_01", "SKILL/MAGICIAN/MAGICIANSHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIAN_CHARGE_ATTACK", "SKILL/MAGICIAN/MAGICIAN_CHARGEATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIAN_CHARGE_LASER", "SKILL/MAGICIAN/MAGICIAN_CHARGELASER.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIAN_DASH_ATTACK", "SKILL/MAGICIAN/MAGICIAN_DASHATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIAN_DOWN_SHOT", "SKILL/MAGICIAN/MAGICIAN_DOWN_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIAN_FRIENDSHIP", "SKILL/MAGICIAN/MAGICIANFRIENDSHIP.XML") );
	m_kContPath.insert( std::make_pair("A_MAGICIAN_JUMP_SHOT", "SKILL/MAGICIAN/MAGICIAN_JUMP_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MAGIC_ADD", "ACTION/ITEMSKILL/MAGIC_ADD.XML") );
	m_kContPath.insert( std::make_pair("A_MAGIC_JAIL", "SKILL/SUMMONER/MAGIC_JAIL.XML") );
	m_kContPath.insert( std::make_pair("A_MAGIC_SHIELD", "SKILL/SUMMONER/MAGIC_SHIELD.XML") );
	m_kContPath.insert( std::make_pair("A_MAGIC_TRAP", "SKILL/SUMMONER/MAGIC_TRAP.XML") );
	m_kContPath.insert( std::make_pair("A_MAGMAPISTON", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/MAGMAPISTON.XML") );
	m_kContPath.insert( std::make_pair("A_MAGMAPISTON_ATTACK", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/A_MAGMAPISTON_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_MAGMAPISTON_PLAY", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/A_MAGMAPISTON_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_MAGNUM BREAK", "SKILL/FIGHTER/WARRIOR/GLADIATOR/MAGNUMBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_DOUBLESHOT", "SKILL/MAGICIAN/MAGE/MAGDOUBLESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_DOWN_ATTACK_01", "SKILL/MAGICIAN/MAG_DOWNATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_DOWN_ATTACK_02", "SKILL/MAGICIAN/MAG_DOWNATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_DOWN_ATTACK_03", "SKILL/MAGICIAN/MAG_DOWNATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_DOWN_ATTACK_FLY", "SKILL/MAGICIAN/MAG_DOWNATTACK_FLY.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_MELEE_01", "SKILL/MAGICIAN/BATTLEMAGE/MAG_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_MELEE_02", "SKILL/MAGICIAN/BATTLEMAGE/MAG_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_MAG_MELEE_03", "SKILL/MAGICIAN/BATTLEMAGE/MAG_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_MAHALKA_ATK", "SKILL/COMMON/MELEE_CHANGEMAHALKA.XML") );
	m_kContPath.insert( std::make_pair("A_MANA BURN", "SKILL/ARCHER/HUNTER/TRAPPER/MANABURN.XML") );
	m_kContPath.insert( std::make_pair("A_MANA BURN_PLAY", "SKILL/ARCHER/HUNTER/TRAPPER/MANABURN_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_MANA SHIELD", "SKILL/MAGICIAN/MAGICIAN_MANA_SHIELD.XML") );
	m_kContPath.insert( std::make_pair("A_MANA_BURN", "SKILL/SUMMONER/MANA_BURN.XML") );
	m_kContPath.insert( std::make_pair("A_MAN_COOK", "SKILL/MANUFACTURE/MANCOOK.XML") );
	m_kContPath.insert( std::make_pair("A_MAN_SPELL", "SKILL/MANUFACTURE/MANSPELL.XML") );
	m_kContPath.insert( std::make_pair("A_MAN_WORKMANSHIP", "SKILL/MANUFACTURE/MANWORKMANSHIP.XML") );
	m_kContPath.insert( std::make_pair("A_MAPMOVE", "ACTION/MAPMOVE.XML") );
	m_kContPath.insert( std::make_pair("A_MARIONETTE", "SKILL/THIEF/CLOWN/DANCER/MANIAC/MARIONETTE.XML") );
	m_kContPath.insert( std::make_pair("A_MARIONETTESA", "SKILL/THIEF/CLOWN/DANCER/MANIAC/MARIONETTESA.XML") );
	m_kContPath.insert( std::make_pair("A_MARIONETTE_FINISH", "SKILL/THIEF/CLOWN/DANCER/MANIAC/MARIONETTE_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_MEAL", "ACTION/MEAL.XML") );
	m_kContPath.insert( std::make_pair("A_MEGADRILL", "SKILL/THIEF/CLOWN/DANCER/MEGADRILL.XML") );
	m_kContPath.insert( std::make_pair("A_MEGA_INFERNO", "SKILL/SUMMONER/MEGA_INFERNO.XML") );
	m_kContPath.insert( std::make_pair("A_MEGA_SPARK_WAVE_CAST", "SKILL/SUMMONER/MEGA_SPARK_WAVE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_MEGA_SPARK_WAVE_FIRE", "SKILL/SUMMONER/MEGA_SPARK_WAVE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_MEGA_STORMBLADE", "SKILL/FIGHTER/KNIGHT/PALADIN/MEGASTORMBLADE.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_01", "SKILL/COMMON/MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_02", "SKILL/COMMON/MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_02_PUSH_LONG", "SKILL/COMMON/MELEE_02_PUSH_LONG.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_02_PUSH_SHORT", "SKILL/COMMON/MELEE_02_PUSH_SHORT.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_03", "SKILL/COMMON/MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_03_PUSH_LONG", "SKILL/COMMON/MELEE_03_PUSH_LONG.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_03_PUSH_SHORT", "SKILL/COMMON/MELEE_03_PUSH_SHORT.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_04", "SKILL/COMMON/MELEE_04.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_04_PUSH_LONG", "SKILL/COMMON/MELEE_04_PUSH_LONG.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_04_PUSH_SHORT", "SKILL/COMMON/MELEE_04_PUSH_SHORT.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_05", "SKILL/COMMON/MELEE_05.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_05_PUSH_LONG", "SKILL/COMMON/MELEE_05_PUSH_LONG.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_05_PUSH_SHORT", "SKILL/COMMON/MELEE_05_PUSH_SHORT.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_BLOW_UP", "SKILL/COMMON/MELEE_BLOW_UP.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_CHARGE_ATTACK", "SKILL/COMMON/MELEECHARGEATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_DROP", "SKILL/COMMON/MELEE_DROP.XML") );
	m_kContPath.insert( std::make_pair("A_MELEE_KNOCK_BACK", "SKILL/COMMON/MELEE_KNOCK_BACK.XML") );
	m_kContPath.insert( std::make_pair("A_METEOR STRIKE", "SKILL/MAGICIAN/MAGE/WIZARD/METEORSTRIKE.XML") );
	m_kContPath.insert( std::make_pair("A_METEOR_PET_A", "SKILL/PET/METEOR_A.XML") );
	m_kContPath.insert( std::make_pair("A_METEOR_PET_B", "SKILL/PET/METEOR_B.XML") );
	m_kContPath.insert( std::make_pair("A_METEOR_PET_C", "SKILL/PET/METEOR_C.XML") );
	m_kContPath.insert( std::make_pair("A_METEOR_RAIN_CAST", "SKILL/SUMMONER/METEOR_RAIN_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_METEOR_RAIN_FIRE", "SKILL/SUMMONER/METEOR_RAIN_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_MIND READING", "SKILL/THIEF/ASSASSIN/MINDREADING.XML") );
	m_kContPath.insert( std::make_pair("A_MIRROR IMAGE", "SKILL/MAGICIAN/MAGE/WIZARD/MIRRORIMAGE.XML") );
	m_kContPath.insert( std::make_pair("A_MISSION_PORTAL", "ACTION/MISSION_PORTAL.XML") );
	m_kContPath.insert( std::make_pair("A_MON_360DEGREE_SHOT", "SKILL/MONSTER/MON_360DEGREE_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MON_360DEGREE_SHOT_2", "SKILL/MONSTER/MON_360DEGREE_SHOT_2.XML") );
	m_kContPath.insert( std::make_pair("A_MON_360S_CURVE", "SKILL/MONSTER/MON_SHOT_360S_CURVE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ABSORB", "ACTION/MON_ABSORB.XML") );
	m_kContPath.insert( std::make_pair("A_MON_AIR_STRIKE", "SKILL/MONSTER/MON_AIRSTRIKE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ANTARES_LASER", "SKILL/MONSTER/MON_ANTARES_LASER.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ANTARES_LASER_01", "SKILL/MONSTER/MON_ANTARES_LASER_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ANTARES_LASER_02", "SKILL/MONSTER/MON_ANTARES_LASER_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BAT_MISSILE", "SKILL/MONSTER/MON_BATMISSILE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BAT_MISSILE2", "SKILL/MONSTER/MON_BATMISSILE2.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BAT_MISSILE_03", "SKILL/MONSTER/MON_BATMISSILE_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BLACKHOLE_01", "SKILL/MONSTER/MON_BLACKHOLE_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BLACKHOLE_01_SA", "SKILL/MONSTER/MON_BLACKHOLE_01_SA.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BLOCKING", "SKILL/MONSTER/MON_BLOCKING.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BONEDRAGONMIST_SA", "SKILL/BONEDRAGON/MON_BONEDRAGONMIST_SA.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BREAK_01", "SKILL/MONSTER/MON_BREAK_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BREATH", "SKILL/MONSTER/MON_BREATH.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BREATH_02", "SKILL/MONSTER/MON_BREATH_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BREATH_03", "SKILL/MONSTER/MON_BREATH_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BREATH_04", "SKILL/MONSTER/MON_BREATH_04.XML") );
	m_kContPath.insert( std::make_pair("A_MON_BREATH_05", "SKILL/MONSTER/MON_BREATH_05.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CAST_01", "SKILL/MONSTER/MON_CAST_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CAST_02", "SKILL/MONSTER/MON_CAST_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CAST_03", "SKILL/MONSTER/MON_CAST_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CROSSATTACK_01", "SKILL/MONSTER/MON_CROSSATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CROSSATTACK_02", "SKILL/MONSTER/MON_CROSSATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CROSSATTACK_03", "SKILL/MONSTER/MON_CROSSATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CROSSATTACK_04", "SKILL/MONSTER/MON_CROSSATTACK_04.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CROSSATTACK_05", "SKILL/MONSTER/MON_CROSSATTACK_05.XML") );
	m_kContPath.insert( std::make_pair("A_MON_CROSSATTACK_06", "SKILL/MONSTER/MON_CROSSATTACK_06.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DARKBREATH", "SKILL/BONEDRAGON/MON_DARKBREATH.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DASHATTK", "SKILL/MONSTER/MON_DASHATTK.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DASHATTK_02", "SKILL/MONSTER/MON_DASHATTK_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DASHATTK_03", "SKILL/MONSTER/MON_DASHATTK_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DASH_AFTER_ATTK", "SKILL/MONSTER/MON_DASH_AFTER_ATTK.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DASH_AFTER_ATTK_02", "SKILL/MONSTER/MON_DASH_AFTER_ATTK_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DASH_PIERCING_ATTK", "SKILL/MONSTER/MON_DASH_PIERCING_ATTK.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DIESKILL_01", "SKILL/MONSTER/MON_DIE_SKILL_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DIESKILL_02", "SKILL/MONSTER/MON_DIE_SKILL_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DROP_PROJECTILE", "SKILL/MONSTER/MON_DROP_PROJECTILE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_DROP_PROJECTILE_01", "SKILL/MONSTER/MON_DROP_PROJECTILE_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_EARTHQUAKE", "SKILL/MONSTER/MON_EARTHQUAKE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_EARTHQUAKE_01", "SKILL/MONSTER/MON_EARTHQUAKE_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_EARTHQUAKE_02", "SKILL/MONSTER/MON_EARTHQUAKE_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ELGA02_AIR_STRIKE", "SKILL/MONSTER/MON_ELGA02_AIRSTRIKE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ELGA03_DARK_EYE_IDLE", "SKILL/MONSTER/MON_ELGA03_DARK_EYE_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ELGA03_SUMMON_DARK_EYE", "SKILL/MONSTER/MON_ELGA03_SUMMON_DARK_EYE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ENERGY_EXPLOSION", "SKILL/MONSTER/MON_ENERGY_EXPLOSION.XML") );
	m_kContPath.insert( std::make_pair("A_MON_FURY_01", "SKILL/MONSTER/MON_FURY_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_IDLE", "ACTION/MON_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_JUMPDOWNCRASH", "SKILL/MONSTER/MON_JUMPDOWNCRASH.XML") );
	m_kContPath.insert( std::make_pair("A_MON_JUMPDOWNCRASH_01", "SKILL/MONSTER/MON_JUMPDOWNCRASH_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_JUMPDOWNCRASH_02", "SKILL/MONSTER/MON_JUMPDOWNCRASH_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_JUMPDOWNCRASH_DIAG", "SKILL/MONSTER/MON_JUMPDOWNCRASH_DIAG.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MASSIVE_PROJECTILE", "SKILL/MONSTER/MON_MASSIVE_PROJECTILE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MASSIVE_PROJECTILE_02", "SKILL/MONSTER/MON_MASSIVE_PROJECTILE2.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MASSIVE_PROJECTILE_JUMP", "SKILL/MONSTER/MON_MASSIVE_PROJECTILE_JUMP.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MASSIVE_PROJECTILE_MOVE", "SKILL/MONSTER/MON_MASSIVE_PROJECTILE_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_01", "SKILL/MONSTER/MON_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_02", "SKILL/MONSTER/MON_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_03", "SKILL/MONSTER/MON_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_04", "SKILL/MONSTER/MON_MELEE_04.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_05", "SKILL/MONSTER/MON_MELEE_05.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_06", "SKILL/MONSTER/MON_MELEE_06.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_07", "SKILL/MONSTER/MON_MELEE_07.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_08", "SKILL/MONSTER/MON_MELEE_08.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_B_01", "SKILL/MONSTER/MON_MELEE_B_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_CASTANI", "SKILL/MONSTER/MON_MELEE_CASTANI.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_DELAY_01", "SKILL/MONSTER/MON_MELEE_DELAY_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_DELAY_02", "SKILL/MONSTER/MON_MELEE_DELAY_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_FIN_01", "SKILL/MONSTER/MON_MELEE_FINISH_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_FIN_02", "SKILL/MONSTER/MON_MELEE_FINISH_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_LOOP_01", "SKILL/MONSTER/MON_MELEE_LOOP_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_SKILL_01", "SKILL/MONSTER/MON_MELEE_SKILL_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_SKILL_02", "SKILL/MONSTER/MON_MELEE_SKILL_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MELEE_SKILL_03", "SKILL/MONSTER/MON_MELEE_SKILL_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MOVE", "SKILL/MONSTER/MON_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_MULTI_SHOT_BYS_01", "SKILL/NEVE/MON_MULTI_SHOT_BYS_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_NATURE_HEAL", "SKILL/SUMMONER/MON_NATURE_HEAL.XML") );
	m_kContPath.insert( std::make_pair("A_MON_NORMAL_01", "SKILL/MONSTER/MON_NORMAL_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ONLY_ANI", "SKILL/MONSTER/MON_ONLY_ANI.XML") );
	m_kContPath.insert( std::make_pair("A_MON_ONLY_ANI_02", "SKILL/MONSTER/MON_ONLY_ANI_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_PARIS_LASER", "SKILL/MONSTER/MON_PARIS_LASER.XML") );
	m_kContPath.insert( std::make_pair("A_MON_PARIS_LASER_01", "SKILL/MONSTER/MON_PARIS_LASER_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_PARIS_LASER_MULTI", "SKILL/MONSTER/MON_PARIS_LASER_MULTI.XML") );
	m_kContPath.insert( std::make_pair("A_MON_PATROL", "SKILL/MONSTER/MON_PATROL_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MON_PULL", "SKILL/MONSTER/MON_PULL.XML") );
	m_kContPath.insert( std::make_pair("A_MON_REGEN_POINT_CHOSE", "SKILL/MONSTER/MON_REGEN_POINT_CHOSE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SELECT_SHOTBYKEY_01", "SKILL/MONSTER/MON_SELECT_SHOTBYKEY_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SELECT_SHOT_01", "SKILL/MONSTER/MON_SELECT_SHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SELECT_SHOT_02", "SKILL/MONSTER/MON_SELECT_SHOT_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_01", "SKILL/MONSTER/MON_SHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_02", "SKILL/MONSTER/MON_SHOT_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_03", "SKILL/MONSTER/MON_SHOT_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_AROUND2_01", "SKILL/MONSTER/MON_SHOT_AROUND2_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_AROUND_01", "SKILL/MONSTER/MON_SHOT_AROUND_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_AROUND_02", "SKILL/MONSTER/MON_SHOT_AROUND_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_AROUND_03", "SKILL/MONSTER/MON_SHOT_AROUND_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_AROUND_FINISH", "SKILL/MONSTER/MON_SHOT_AROUND_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SIXSHOT", "SKILL/MONSTER/MON_SHOT_SIXSHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_01", "SKILL/MONSTER/MON_SHOT_SKILL_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_02", "SKILL/MONSTER/MON_SHOT_SKILL_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_03", "SKILL/MONSTER/MON_SHOT_SKILL_03.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_04", "SKILL/MONSTER/MON_SHOT_SKILL_04.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_11", "SKILL/MONSTER/MON_SHOT_SKILL_11.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_12", "SKILL/MONSTER/MON_SHOT_SKILL_12.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SHOT_SKILL_13", "SKILL/MONSTER/MON_SHOT_SKILL_13.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SUMMONBONE", "SKILL/BONEDRAGON/MON_SUMMONBONE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SUMMONBONE_SA", "SKILL/BONEDRAGON/MON_SUMMONBONE_SA.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SUMMON_THORN", "SKILL/MONSTER/MON_SUMMON_THORN.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SUMMON_THORNS", "SKILL/MONSTER/MON_SUMMON_THORNS.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SUMMON_THORNS_SA", "SKILL/MONSTER/MON_SUMMON_THORNSSA.XML") );
	m_kContPath.insert( std::make_pair("A_MON_SUMMON_THORN_SA", "SKILL/MONSTER/MON_SUMMON_THORNSA.XML") );
	m_kContPath.insert( std::make_pair("A_MON_S_CURVE", "SKILL/MONSTER/MON_SHOT_S_CURVE.XML") );
	m_kContPath.insert( std::make_pair("A_MON_TARGET_LOC_SHOT_01", "SKILL/NEVE/MON_TARGET_LOC_SHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_TELEPORT_SKILL_01", "SKILL/MONSTER/MON_TELEPORT_SKILL_01.XML") );
	m_kContPath.insert( std::make_pair("A_MON_TOUCH_UP", "SKILL/MONSTER/MON_SHOT_TOUCH_UP.XML") );
	m_kContPath.insert( std::make_pair("A_MON_TOUCH_UP_02", "SKILL/MONSTER/MON_SHOT_TOUCH_UP_02.XML") );
	m_kContPath.insert( std::make_pair("A_MON_TWIST", "SKILL/MONSTER/MON_SHOT_TWIST.XML") );
	m_kContPath.insert( std::make_pair("A_MON_WHIRLWIND", "SKILL/MONSTER/MON_WHIRLWIND.XML") );
	m_kContPath.insert( std::make_pair("A_MON_WHIRLWIND_MOVE", "SKILL/MONSTER/MON_WHIRLWIND_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_MOON WALK", "SKILL/THIEF/CLOWN/DANCER/MOONWALK.XML") );
	m_kContPath.insert( std::make_pair("A_MOUNT", "SKILL/PET/MOUNT.XML") );
	m_kContPath.insert( std::make_pair("A_MOVING_TREE", "ACTION/MOVINGTREE.XML") );
	m_kContPath.insert( std::make_pair("A_MP TRANSITION", "SKILL/MAGICIAN/MAGE/WIZARD/MPTRANSITION.XML") );
	m_kContPath.insert( std::make_pair("A_MP-ZERO TRAP", "SKILL/ARCHER/HUNTER/TRAPPER/MPZEROTRAP.XML") );
	m_kContPath.insert( std::make_pair("A_MP-ZERO TRAP ACTIVE", "SKILL/ARCHER/HUNTER/TRAPPER/MPZEROTRAPACTIVE.XML") );
	m_kContPath.insert( std::make_pair("A_MULTI SHOT", "SKILL/ARCHER/MULTI_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MULTIPLE SHOT", "SKILL/ARCHER/MULTIPLE SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MULTISHOT", "SKILL/ARCHER/MULTISHOT.XML") );
	m_kContPath.insert( std::make_pair("A_MULTI_STRAPE", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/A_MULTISTRAPE.XML") );
	m_kContPath.insert( std::make_pair("A_MULTI_STRAPE_CREATURE_IDLE", "SKILL/MASTER_SUMMON/MULTISTRAPE_CREATURE_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_MULTI_STRAPE_FIRE", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/A_MULTISTRAPE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_MULTI_STRAPE_MELEE", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/A_MULTISTRAPE_MELEE.XML") );
	m_kContPath.insert( std::make_pair("A_MUTISHA_DIE", "SKILL/ARAMMUTISHA/MUTISHA_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_MUTISHA_INARAM_SKILL", "SKILL/ARAMMUTISHA/MUTISHA_INARAM.XML") );
	m_kContPath.insert( std::make_pair("A_MYSTERIOUS COOKING", "SKILL/ARCHER/HUNTER/TRAPPER/MYSTERIOUSCOOKING.XML") );
	m_kContPath.insert( std::make_pair("A_NATURE_BLESSING", "SKILL/SUMMONER/NATURE_BLESSING.XML") );
	m_kContPath.insert( std::make_pair("A_NET BINDER", "SKILL/ARCHER/RANGER/NETBINDER.XML") );
	m_kContPath.insert( std::make_pair("A_NINETEEN NINETY", "SKILL/THIEF/CLOWN/DANCER/NINETEENNINETY.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_DASH_ATTACK", "SKILL/THIEF/ASSASSIN/NINJA/NJ_DASH_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_FLOAT_MELEE_01", "SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_FLOAT_MELEE_02", "SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_FLOAT_MELEE_03", "SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_FLOAT_MELEE_04", "SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_04.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_FLOAT_MELEE_05", "SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_05.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_MELEE_01", "SKILL/THIEF/ASSASSIN/NINJA/NJ_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_MELEE_02", "SKILL/THIEF/ASSASSIN/NINJA/NJ_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_NJ_MELEE_03", "SKILL/THIEF/ASSASSIN/NINJA/NJ_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_NUCLEAR", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/NUCLEAR.XML") );
	m_kContPath.insert( std::make_pair("A_OBJECT_BREAK", "ACTION/OBJECTBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_OCTOPUS INK", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/OCTOPUSINK.XML") );
	m_kContPath.insert( std::make_pair("A_OFFECSIVE AURA", "SKILL/FIGHTER/KNIGHT/PALADIN/OFFECSIVEAURA.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_A", "SKILL/FIGHTER/OHS_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_A_2", "SKILL/FIGHTER/OHS_COMBO_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_A_3", "SKILL/FIGHTER/OHS_COMBO_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_A_4", "SKILL/FIGHTER/OHS_COMBO_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_A_5", "SKILL/FIGHTER/OHS_COMBO_A_5.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_A_6", "SKILL/FIGHTER/OHS_COMBO_A_6.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_B", "SKILL/FIGHTER/OHS_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_B_3", "SKILL/FIGHTER/OHS_COMBO_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_B_4", "SKILL/FIGHTER/OHS_COMBO_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_B_5", "SKILL/FIGHTER/OHS_COMBO_B_5.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_C", "SKILL/FIGHTER/OHS_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_C_4", "SKILL/FIGHTER/OHS_COMBO_C_4.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_C_4_5", "SKILL/FIGHTER/OHS_COMBO_C_4_5.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_C_4_6", "SKILL/FIGHTER/OHS_COMBO_C_4_6.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_C_5", "SKILL/FIGHTER/OHS_COMBO_C_5.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_C_6", "SKILL/FIGHTER/OHS_COMBO_C_6.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_D", "SKILL/FIGHTER/OHS_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_D_5", "SKILL/FIGHTER/OHS_COMBO_D_5.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_E", "SKILL/FIGHTER/OHS_COMBO_E.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_A", "SKILL/FIGHTER/OHS_COMBO_K_A.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_A_2", "SKILL/FIGHTER/OHS_COMBO_K_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_A_3", "SKILL/FIGHTER/OHS_COMBO_K_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_A_4", "SKILL/FIGHTER/OHS_COMBO_K_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_B", "SKILL/FIGHTER/OHS_COMBO_K_B.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_B_3", "SKILL/FIGHTER/OHS_COMBO_K_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_B_4", "SKILL/FIGHTER/OHS_COMBO_K_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_C", "SKILL/FIGHTER/OHS_COMBO_K_C.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_C_4", "SKILL/FIGHTER/OHS_COMBO_K_C_4.XML") );
	m_kContPath.insert( std::make_pair("A_OHS_COMBO_K_D", "SKILL/FIGHTER/OHS_COMBO_K_D.XML") );
	m_kContPath.insert( std::make_pair("A_OPENING", "ACTION/OPENING.XML") );
	m_kContPath.insert( std::make_pair("A_OPENING_MANUAL", "ACTION/OPENING_MANUAL.XML") );
	m_kContPath.insert( std::make_pair("A_OPENING_MANUAL2", "ACTION/OPENING_MANUAL2.XML") );
	m_kContPath.insert( std::make_pair("A_OPENING_MANUAL3", "ACTION/OPENING_MANUAL3.XML") );
	m_kContPath.insert( std::make_pair("A_OPENING_MOVIE", "SKILL/ARAMMUTISHA/OPENING_MOVIE.XML") );
	m_kContPath.insert( std::make_pair("A_PADONG", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PADONG.XML") );
	m_kContPath.insert( std::make_pair("A_PADONG_SUCCEED_0", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PADONG_SUCCEED_0.XML") );
	m_kContPath.insert( std::make_pair("A_PADONG_SUCCEED_1", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PADONG_SUCCEED_1.XML") );
	m_kContPath.insert( std::make_pair("A_PAREL_DIE", "SKILL/PAREL/PAREL_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_PAREL_JUMPATTACK", "SKILL/PAREL/PAREL_JUMPATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_PARRING", "SKILL/FIGHTER/KNIGHT/PARRING.XML") );
	m_kContPath.insert( std::make_pair("A_PARTICLE_CANON", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/PARTICLECANON.XML") );
	m_kContPath.insert( std::make_pair("A_PARTICLE_CANON_SA", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/PARTICLECANONSA.XML") );
	m_kContPath.insert( std::make_pair("A_PENETRATE", "ACTION/ITEMSKILL/PENETRATE.XML") );
	m_kContPath.insert( std::make_pair("A_PERFECT SANCTUARY", "SKILL/MAGICIAN/MAGE/WIZARD/PERFAECTSANCTUARY.XML") );
	m_kContPath.insert( std::make_pair("A_PETITEMPRODUCE", "SKILL/PET/ITEM_PRODUCE.XML") );
	m_kContPath.insert( std::make_pair("A_PETUIIDLE", "ACTION/PETUIIDLE.XML") );
	m_kContPath.insert( std::make_pair("A_PET_MELEE_01", "SKILL/PET/PET_MELEE_RIDING.XML") );
	m_kContPath.insert( std::make_pair("A_PET_MELEE_02", "SKILL/PET/PET_MELEE02_RIDING.XML") );
	m_kContPath.insert( std::make_pair("A_PET_OPENING", "ACTION/PET_OPENING.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A", "SKILL/TWINS/PG_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_2", "SKILL/TWINS/PG_COMBO_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_3", "SKILL/TWINS/PG_COMBO_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_3_F", "SKILL/TWINS/PG_COMBO_A_3_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_3_S", "SKILL/TWINS/PG_COMBO_A_3_S.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_4", "SKILL/TWINS/PG_COMBO_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_5", "SKILL/TWINS/PG_COMBO_A_5.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_5_F", "SKILL/TWINS/PG_COMBO_A_5_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_A_5_S", "SKILL/TWINS/PG_COMBO_A_5_S.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_B", "SKILL/TWINS/PG_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_B_3", "SKILL/TWINS/PG_COMBO_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_B_4", "SKILL/TWINS/PG_COMBO_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_B_5", "SKILL/TWINS/PG_COMBO_B_5.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_B_5_F", "SKILL/TWINS/PG_COMBO_B_5_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_B_5_S", "SKILL/TWINS/PG_COMBO_B_5_S.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C", "SKILL/TWINS/PG_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C_4", "SKILL/TWINS/PG_COMBO_C_4.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C_5", "SKILL/TWINS/PG_COMBO_C_5.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C_5_F", "SKILL/TWINS/PG_COMBO_C_5_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C_5_S", "SKILL/TWINS/PG_COMBO_C_5_S.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C_F", "SKILL/TWINS/PG_COMBO_C_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_C_S", "SKILL/TWINS/PG_COMBO_C_S.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_D", "SKILL/TWINS/PG_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_D_5", "SKILL/TWINS/PG_COMBO_D_5.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_D_5_F", "SKILL/TWINS/PG_COMBO_D_5_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_D_5_S", "SKILL/TWINS/PG_COMBO_D_5_S.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_D_F", "SKILL/TWINS/PG_COMBO_D_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_E", "SKILL/TWINS/PG_COMBO_E.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_E_F", "SKILL/TWINS/PG_COMBO_E_F.XML") );
	m_kContPath.insert( std::make_pair("A_PG_COMBO_E_S", "SKILL/TWINS/PG_COMBO_E_S.XML") );
	m_kContPath.insert( std::make_pair("A_PHANTOMCLONE", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PHANTOMCLONE.XML") );
	m_kContPath.insert( std::make_pair("A_PHANTOM_NINJA_IDLE", "SKILL/MASTER_SUMMON/NINJA_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_PHANTOM_NINJA_MELEE_01", "SKILL/MASTER_SUMMON/NINJA_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_PHANTOM_NINJA_MELEE_FINISH", "SKILL/MASTER_SUMMON/NINJA_MELEE_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_PHANTOM_WARRIOR_IDLE", "SKILL/MASTER_SUMMON/IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_PIN-POINT ATTACK", "SKILL/ARCHER/RANGER/SNIPER/PINPOINTSHOT.XML") );
	m_kContPath.insert( std::make_pair("A_PINPOINT SHOT", "SKILL/ARCHER/RANGER/SNIPER/PINPOINTSHOT.XML") );
	m_kContPath.insert( std::make_pair("A_PLAY", "ACTION/PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_PLAY_ANIMATION", "ACTION/PLAYANIMATION.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_CLOUD_A", "SKILL/PET/POISON_CLOUD_A.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_CLOUD_B", "SKILL/PET/POISON_CLOUD_B.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_CLOUD_C", "SKILL/PET/POISON_CLOUD_C.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_CLOUD_PLAY_A", "SKILL/PET/POISON_CLOUD_PLAY_A.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_CLOUD_PLAY_B", "SKILL/PET/POISON_CLOUD_PLAY_B.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_CLOUD_PLAY_C", "SKILL/PET/POISON_CLOUD_PLAY_C.XML") );
	m_kContPath.insert( std::make_pair("A_POISON_GUARD", "SKILL/SUMMONER/POISON_GUARD.XML") );
	m_kContPath.insert( std::make_pair("A_PORTAL", "ACTION/PORTAL.XML") );
	m_kContPath.insert( std::make_pair("A_POSEIDON_SKILL", "ACTION/ITEMSKILL/A_POSEIDON_SKILL.XML") );
	m_kContPath.insert( std::make_pair("A_PRAYER", "SKILL/FIGHTER/KNIGHT/PALADIN/PRAYER.XML") );
	m_kContPath.insert( std::make_pair("A_PRESSURE", "SKILL/FIGHTER/KNIGHT/PALADIN/PRESSURE.XML") );
	m_kContPath.insert( std::make_pair("A_PRESSURE_PLAY", "SKILL/FIGHTER/KNIGHT/PALADIN/PRESSURE_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_PRIDE", "EMOTIONS/PRIDE.XML") );
	m_kContPath.insert( std::make_pair("A_PROTECTEDGE", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PROTECTEDGE.XML") );
	m_kContPath.insert( std::make_pair("A_PROVOC", "EMOTIONS/PROVOC.XML") );
	m_kContPath.insert( std::make_pair("A_PULL", "ACTION/PULL.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK", "ACTION/PUSHBACK.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK1", "ACTION/PUSHBACK1.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK2", "ACTION/PUSHBACK2.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_LONG", "ACTION/PUSHBACK_LONG.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_LONG1", "ACTION/PUSHBACK_LONG1.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_LONG2", "ACTION/PUSHBACK_LONG2.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_PUBLIC", "ACTION/PUSHBACK_PUBLIC.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_SHORT", "ACTION/PUSHBACK_SHORT.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_SHORT1", "ACTION/PUSHBACK_SHORT1.XML") );
	m_kContPath.insert( std::make_pair("A_PUSH_BACK_SHORT2", "ACTION/PUSHBACK_SHORT2.XML") );
	m_kContPath.insert( std::make_pair("A_PVP_FLAG_DEFAULT", "ACTION/PVP_FLAG_DEFAULT.XML") );
	m_kContPath.insert( std::make_pair("A_PVP_LOSE", "EMOTIONS/PVP_LOSE.XML") );
	m_kContPath.insert( std::make_pair("A_PVP_WIN", "EMOTIONS/PVP_WIN.XML") );
	m_kContPath.insert( std::make_pair("A_QUAGMIRE", "SKILL/MAGICIAN/MAGE/QUAGMIRE.XML") );
	m_kContPath.insert( std::make_pair("A_QUAGMIRE SET", "SKILL/MAGICIAN/MAGE/QUAGMIRESET.XML") );
	m_kContPath.insert( std::make_pair("A_RAID", "SKILL/THIEF/RAID.XML") );
	m_kContPath.insert( std::make_pair("A_RAIN_OF_FIRE", "SKILL/MAGICIAN/MAGE/RAINOFFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_RAN_FLOATDOWNSHOT", "SKILL/ARCHER/RANGER/FLOATDOWNSHOT.XML") );
	m_kContPath.insert( std::make_pair("A_RAPIDLY SHOT_CAST", "SKILL/ARCHER/RAPIDLY SHOT_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_RAPIDLY SHOT_FIRE", "SKILL/ARCHER/RAPIDLY SHOT_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_RAT TRAP", "SKILL/ARCHER/RAT_TRAP.XML") );
	m_kContPath.insert( std::make_pair("A_RECALL", "SKILL/SUMMONER/RECALL.XML") );
	m_kContPath.insert( std::make_pair("A_RECOVERY AURA", "SKILL/FIGHTER/KNIGHT/PALADIN/RECOVERYAURA.XML") );
	m_kContPath.insert( std::make_pair("A_REGAIN", "SKILL/SUMMONER/REGAIN.XML") );
	m_kContPath.insert( std::make_pair("A_REPOSITION", "ACTION/REPOSITION.XML") );
	m_kContPath.insert( std::make_pair("A_RESOURCE CONVERTER", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/RESOURCECONVERTER.XML") );
	m_kContPath.insert( std::make_pair("A_REST", "ACTION/REST.XML") );
	m_kContPath.insert( std::make_pair("A_REST_EXP01", "ACTION/REST_EXP01.XML") );
	m_kContPath.insert( std::make_pair("A_REST_EXP02", "ACTION/REST_EXP02.XML") );
	m_kContPath.insert( std::make_pair("A_REST_EXP03", "ACTION/REST_EXP03.XML") );
	m_kContPath.insert( std::make_pair("A_REST_EXPSA01", "ACTION/REST_EXPSA01.XML") );
	m_kContPath.insert( std::make_pair("A_RESURRECTION", "SKILL/MAGICIAN/MAGE/RESURRECTION.XML") );
	m_kContPath.insert( std::make_pair("A_RESURRECTION_01", "ACTION/RESURRECTION.XML") );
	m_kContPath.insert( std::make_pair("A_REVENGE", "SKILL/FIGHTER/KNIGHT/REVENGE.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_BLOW_UP", "ACTION/REVERSEBLOWUP.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_BLOW_UP_FAST", "ACTION/REVERSEBLOWUPFAST.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_GRAVITY", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_GRAVITY2", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY2.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_GRAVITY3", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY3.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_GRAVITY4", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY4.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_GRAVITY5", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY5.XML") );
	m_kContPath.insert( std::make_pair("A_REVERSE_GRAVITY6", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITYFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_REVIVE", "ACTION/REVIVE.XML") );
	m_kContPath.insert( std::make_pair("A_RIDE", "ACTION/RIDE.XML") );
	m_kContPath.insert( std::make_pair("A_RIDE_IDLE", "ACTION/RIDE_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_RIDE_RUN", "ACTION/RIDE_RUN.XML") );
	m_kContPath.insert( std::make_pair("A_RIDINGOBJECT_MOVE", "ACTION/RIDINGOBJECT_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_RIDING_GROUND", "ACTION/RIDING_GROUND.XML") );
	m_kContPath.insert( std::make_pair("A_ROCKET PUNCH", "SKILL/THIEF/ROCKETPUNCH.XML") );
	m_kContPath.insert( std::make_pair("A_ROCK_PUNCH", "SKILL/SUMMONER/ROCK_PUNCH.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING LOG", "SKILL/THIEF/ASSASSIN/NINJA/ROLLINGLOG.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING LOG PLAY", "SKILL/THIEF/ASSASSIN/NINJA/ROLLINGLOG_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_A", "SKILL/PET/ROLLING_A.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_ATTACK", "SKILL/SUMMONER/ROLLING_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_B", "SKILL/PET/ROLLING_B.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_C", "SKILL/PET/ROLLING_C.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_GROUND", "SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/ROLLINGGROUND.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_STONE_CAST", "SKILL/SUMMONER/ROLLING_STONE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_ROLLING_STONE_FIRE", "SKILL/SUMMONER/ROLLING_STONE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_ROPE", "ACTION/ROPE.XML") );
	m_kContPath.insert( std::make_pair("A_ROPE_RIDING", "ACTION/ROPERIDING.XML") );
	m_kContPath.insert( std::make_pair("A_ROULETTE", "SKILL/FIGHTER/WARRIOR/ROULETTE.XML") );
	m_kContPath.insert( std::make_pair("A_ROWDY", "EMOTIONS/ROWDY.XML") );
	m_kContPath.insert( std::make_pair("A_RP_IDLE", "ACTION/RP_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_RP_JUMP", "ACTION/RP_JUMP.XML") );
	m_kContPath.insert( std::make_pair("A_RP_WALK", "ACTION/RP_WALK.XML") );
	m_kContPath.insert( std::make_pair("A_RUN", "ACTION/RUN.XML") );
	m_kContPath.insert( std::make_pair("A_RUN_KOONA", "ACTION/RUN_KOONA.XML") );
	m_kContPath.insert( std::make_pair("A_RUN_PET", "ACTION/RUN_PET.XML") );
	m_kContPath.insert( std::make_pair("A_RUSH", "EMOTIONS/RUSH.XML") );
	m_kContPath.insert( std::make_pair("A_RYVIUS", "SKILL/COMMON/ITEMSKILL_RYVIUS.XML") );
	m_kContPath.insert( std::make_pair("A_RYVIUS_FIRE", "SKILL/COMMON/ITEMSKILL_RYVIUS_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_SAKURA SPRINKLE01", "SKILL/THIEF/ASSASSIN/NINJA/SAKURASPRINKLE.XML") );
	m_kContPath.insert( std::make_pair("A_SANCTUARY", "SKILL/MAGICIAN/MAGE/SANCTUARY.XML") );
	m_kContPath.insert( std::make_pair("A_SANCTUARY_ITEM", "SKILL/MAGICIAN/MAGE/SANCTUARY.XML") );
	m_kContPath.insert( std::make_pair("A_SANCTUARY_PLAY", "SKILL/MAGICIAN/MAGE/SANCTUARY_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_SANCTUARY_PLAY_ITEM", "SKILL/MAGICIAN/MAGE/SANCTUARY_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_SA_CLASS_PROMOTION_ACT_DRAGONIAN", "ACTION/SA_CLASS_PROMOTION_ACT_DRAGONIAN.XML") );
	m_kContPath.insert( std::make_pair("A_SA_CLASS_PROMOTION_ACT_HUMAN", "ACTION/SA_CLASS_PROMOTION_ACT_HUMAN.XML") );
	m_kContPath.insert( std::make_pair("A_SA_DRAGON_RAGE_ACT", "SKILL/SUMMONER/SA_DRAGON_RAGE_ACT.XML") );
	m_kContPath.insert( std::make_pair("A_SCREW UPPER", "SKILL/THIEF/CLOWN/SCREWUPPER.XML") );
	m_kContPath.insert( std::make_pair("A_SELF HEAL", "SKILL/MAGICIAN/MAGICIAN_SELF_HEAL.XML") );
	m_kContPath.insert( std::make_pair("A_SELFBOMBER", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/SELFBOMBER.XML") );
	m_kContPath.insert( std::make_pair("A_SELFBOMBER2", "SKILL/ARCHER/RANGER/SNIPER/STRIKER/SELFBOMBER2.XML") );
	m_kContPath.insert( std::make_pair("A_SERVEROBJECT_MOVE", "ACTION/SERVEROBJECT_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_SERVILE_BEG", "EMOTIONS/SERVILE_BEG.XML") );
	m_kContPath.insert( std::make_pair("A_SEVEN", "SKILL/THIEF/CLOWN/DANCER/SEVEN.XML") );
	m_kContPath.insert( std::make_pair("A_SHADOW COPY", "SKILL/THIEF/ASSASSIN/NINJA/SHADOWCOPY.XML") );
	m_kContPath.insert( std::make_pair("A_SHADOW LEAP", "SKILL/THIEF/ASSASSIN/NINJA/SHADOWLEAP.XML") );
	m_kContPath.insert( std::make_pair("A_SHADOW WALK", "SKILL/THIEF/ASSASSIN/SHADOWWALK.XML") );
	m_kContPath.insert( std::make_pair("A_SHADOWBLADE", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/SHADOWBLADE.XML") );
	m_kContPath.insert( std::make_pair("A_SHADOWBLADESA", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/SHADOWBLADESA.XML") );
	m_kContPath.insert( std::make_pair("A_SHADOWBLADESAFINISH", "SKILL/THIEF/ASSASSIN/NINJA/SHADOW/SHADOWBLADESAFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_SHARP SHOOTING", "SKILL/ARCHER/RANGER/SHARPSHOOTING.XML") );
	m_kContPath.insert( std::make_pair("A_SHIELDSTRIKE", "SKILL/FIGHTER/KNIGHT/PALADIN/SHIELDSTRIKE.XML") );
	m_kContPath.insert( std::make_pair("A_SHOULDER_TACKLE", "SKILL/FIGHTER/SHOULDERTACKLE.XML") );
	m_kContPath.insert( std::make_pair("A_SHOUT", "SKILL/THIEF/CLOWN/DANCER/SHOUT.XML") );
	m_kContPath.insert( std::make_pair("A_SHOUT_OF_LIFE", "SKILL/SUMMONER/SHOUT_OF_LIFE.XML") );
	m_kContPath.insert( std::make_pair("A_SIEGE CANNON", "SKILL/ARCHER/SIEGE_CANNON.XML") );
	m_kContPath.insert( std::make_pair("A_SIEGECANON_FIRE", "SKILL/ARCHER/SIEGECANNONFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_SILENCE TRAP", "SKILL/ARCHER/HUNTER/TRAPPER/SILENCETRAP.XML") );
	m_kContPath.insert( std::make_pair("A_SILENCE TRAP ACTIVE", "SKILL/ARCHER/HUNTER/TRAPPER/SILENCETRAPACTIVE.XML") );
	m_kContPath.insert( std::make_pair("A_SIT_DOWN", "ACTION/SIT_DOWN.XML") );
	m_kContPath.insert( std::make_pair("A_SKY PIRCE01", "SKILL/THIEF/ASSASSIN/NINJA/SKYPIERCE.XML") );
	m_kContPath.insert( std::make_pair("A_SLEEP", "EMOTIONS/SLEEP.XML") );
	m_kContPath.insert( std::make_pair("A_SLEEP SMELL", "SKILL/THIEF/ASSASSIN/NINJA/SLEEPSMELL.XML") );
	m_kContPath.insert( std::make_pair("A_SLOW HEAL", "SKILL/MAGICIAN/SLOWHEAL.XML") );
	m_kContPath.insert( std::make_pair("A_SLUMBER", "ACTION/SLEEP.XML") );
	m_kContPath.insert( std::make_pair("A_SMART_SHOT_CAST", "SKILL/SUMMONER/SMART_SHOT_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_SMART_SHOT_FIRE", "SKILL/SUMMONER/SMART_SHOT_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_SMART_SHOT_FIRE_COMBO_A", "SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_SMART_SHOT_FIRE_COMBO_B", "SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_SMART_SHOT_FIRE_COMBO_C", "SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_SMART_SHOT_FIRE_COMBO_D", "SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_SMOKE GRANADE", "SKILL/ARCHER/HUNTER/TRAPPER/SMOKEGRANADE.XML") );
	m_kContPath.insert( std::make_pair("A_SMOKE GRANADE ACTIVE", "SKILL/ARCHER/HUNTER/TRAPPER/SMOKEGRANADEACTIVE.XML") );
	m_kContPath.insert( std::make_pair("A_SNATCH_DOWN", "ACTION/SNATCHDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_SNIPING", "SKILL/ARCHER/RANGER/SNIPER/SNIPING.XML") );
	m_kContPath.insert( std::make_pair("A_SNOW BLUES", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/SNOWBLUES.XML") );
	m_kContPath.insert( std::make_pair("A_SNOW BLUES FIRE", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/SNOWBLUES_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_SOMERSAULTKICK", "SKILL/THIEF/SOMERSAULTKICK.XML") );
	m_kContPath.insert( std::make_pair("A_SONIC BOOM", "SKILL/THIEF/CLOWN/SONICBOOM.XML") );
	m_kContPath.insert( std::make_pair("A_SORRY", "EMOTIONS/SORRY.XML") );
	m_kContPath.insert( std::make_pair("A_SOULDRAIN1", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/SOULDRAIN1.XML") );
	m_kContPath.insert( std::make_pair("A_SOULDRAIN2", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/SOULDRAIN2.XML") );
	m_kContPath.insert( std::make_pair("A_SOULDRAIN3", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/SOULDRAIN3.XML") );
	m_kContPath.insert( std::make_pair("A_SOULDRAIN_PLAY", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/A_SOULDRAIN_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_SPARK_ROCK", "SKILL/MAGICIAN/MAGE/WIZARD/SPARK_ROCK.XML") );
	m_kContPath.insert( std::make_pair("A_SPARK_ROCK_PLAY", "SKILL/MAGICIAN/MAGE/WIZARD/SPARK_ROCK_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_SPARK_WAVE_CAST", "SKILL/SUMMONER/SPARK_WAVE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_SPARK_WAVE_FIRE", "SKILL/SUMMONER/SPARK_WAVE_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_SPAWN", "ACTION/SPAWN.XML") );
	m_kContPath.insert( std::make_pair("A_SPEAR JAB", "SKILL/FIGHTER/KNIGHT/SPEARJAB.XML") );
	m_kContPath.insert( std::make_pair("A_SPECIFICIDLE", "ACTION/SPECIFICIDLE.XML") );
	m_kContPath.insert( std::make_pair("A_SPELL", "ACTION/SPELL_01.XML") );
	m_kContPath.insert( std::make_pair("A_SPIRAL CANNON", "SKILL/MAGICIAN/BATTLEMAGE/SPIRALCANNON.XML") );
	m_kContPath.insert( std::make_pair("A_SPLASH TRAP", "SKILL/ARCHER/HUNTER/SPLASHTRAP.XML") );
	m_kContPath.insert( std::make_pair("A_SPLASH TRAP_EXPLOSION", "SKILL/ARCHER/HUNTER/SPLASHTRAP_EXPLOSION.XML") );
	m_kContPath.insert( std::make_pair("A_SP_APPEAR", "SKILL/SAPPHIRE_DRAGON/SP_APPEAR.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_01", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_01.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_02", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_02.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_03", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_03.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_04", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_04.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_05", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_05.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_06", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_06.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_07", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_07.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_08", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_08.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_09", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_09.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_10", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_10.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_11", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_11.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_12", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_12.XML") );
	m_kContPath.insert( std::make_pair("A_SP_ATTK_13", "SKILL/SAPPHIRE_DRAGON/SP_ATTK_13.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_A", "SKILL/MAGICIAN/SP_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_B", "SKILL/MAGICIAN/SP_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_C", "SKILL/MAGICIAN/SP_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_D", "SKILL/MAGICIAN/SP_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_1", "SKILL/MAGICIAN/SP_COMBO_Z_1.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_1_2", "SKILL/MAGICIAN/SP_COMBO_Z_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_1_2_3", "SKILL/MAGICIAN/SP_COMBO_Z_1_2_3.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_1_3", "SKILL/MAGICIAN/SP_COMBO_Z_1_3.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_2", "SKILL/MAGICIAN/SP_COMBO_Z_2.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_2_3", "SKILL/MAGICIAN/SP_COMBO_Z_2_3.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_2_3_4", "SKILL/MAGICIAN/SP_COMBO_Z_2_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_2_4", "SKILL/MAGICIAN/SP_COMBO_Z_2_4.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_3", "SKILL/MAGICIAN/SP_COMBO_Z_3.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_3_4", "SKILL/MAGICIAN/SP_COMBO_Z_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_SP_COMBO_Z_4", "SKILL/MAGICIAN/SP_COMBO_Z_4.XML") );
	m_kContPath.insert( std::make_pair("A_SP_DAMAGE", "SKILL/SAPPHIRE_DRAGON/SP_DAMAGE.XML") );
	m_kContPath.insert( std::make_pair("A_SP_DIE", "SKILL/SAPPHIRE_DRAGON/SP_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_STAND_UP", "ACTION/STAND_UP.XML") );
	m_kContPath.insert( std::make_pair("A_STEP_THE_BEAT", "SKILL/THIEF/CLOWN/DANCER/STEP_THE_BEAT.XML") );
	m_kContPath.insert( std::make_pair("A_STEP_THE_BEAT_IDLE", "SKILL/THIEF/CLOWN/DANCER/STEP_THE_BEAT_IDLE.XML") );
	m_kContPath.insert( std::make_pair("A_STORM BLADE", "SKILL/FIGHTER/STORMBLADE.XML") );
	m_kContPath.insert( std::make_pair("A_STRIKING", "SKILL/MAGICIAN/MAGE/WIZARD/STRIKING.XML") );
	m_kContPath.insert( std::make_pair("A_STRIP WEAPON", "SKILL/THIEF/STRIPWEAPON.XML") );
	m_kContPath.insert( std::make_pair("A_STUMBLEBUM", "SKILL/FIGHTER/WARRIOR/STUMBLEBUM.XML") );
	m_kContPath.insert( std::make_pair("A_STUN", "ACTION/STUN.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_A", "SKILL/MAGICIAN/ST_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_A_DOUBLESHOT", "SKILL/MAGICIAN/ST_COMBO_A_DOUBLESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_A_THREEWAY", "SKILL/MAGICIAN/ST_COMBO_A_THREEWAY.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_B", "SKILL/MAGICIAN/ST_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_B_DOUBLESHOT", "SKILL/MAGICIAN/ST_COMBO_B_DOUBLESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_B_THREEWAY", "SKILL/MAGICIAN/ST_COMBO_B_THREEWAY.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_C", "SKILL/MAGICIAN/ST_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_C_DOUBLESHOT", "SKILL/MAGICIAN/ST_COMBO_C_DOUBLESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_C_THREEWAY", "SKILL/MAGICIAN/ST_COMBO_C_THREEWAY.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_D", "SKILL/MAGICIAN/ST_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_D_DOUBLESHOT", "SKILL/MAGICIAN/ST_COMBO_D_DOUBLESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_D_THREEWAY", "SKILL/MAGICIAN/ST_COMBO_D_THREEWAY.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_1", "SKILL/MAGICIAN/ST_COMBO_Z_1.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_1_2", "SKILL/MAGICIAN/ST_COMBO_Z_1_2.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_1_2_3", "SKILL/MAGICIAN/ST_COMBO_Z_1_2_3.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_1_3", "SKILL/MAGICIAN/ST_COMBO_Z_1_3.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_2", "SKILL/MAGICIAN/ST_COMBO_Z_2.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_2_3", "SKILL/MAGICIAN/ST_COMBO_Z_2_3.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_2_3_4", "SKILL/MAGICIAN/ST_COMBO_Z_2_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_2_4", "SKILL/MAGICIAN/ST_COMBO_Z_2_4.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_3", "SKILL/MAGICIAN/ST_COMBO_Z_3.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_3_4", "SKILL/MAGICIAN/ST_COMBO_Z_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_ST_COMBO_Z_4", "SKILL/MAGICIAN/ST_COMBO_Z_4.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON", "SKILL/SUMMONER/SUMMON.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_ATTACK", "SKILL/SUMMONER/SUMMON_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_BLASSER", "SKILL/SUMMONER/SUMMON_BLASSER.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DEMOLITION_BOMBER", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONBOMBER.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DEMOLITION_BOMBER2", "SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONBOMBERFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DIKE", "SKILL/SUMMONER/SUMMON_DIKE.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DRAGON_RUSH", "SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/DRAGONRUSH.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DRAGON_RUSH2", "SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/DRAGONRUSHFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DRAGOON", "SKILL/SUMMONER/SUMMON_DRAGOON.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_DUNAMIC", "SKILL/SUMMONER/SUMMON_DUNAMIC.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_GORGON", "SKILL/SUMMONER/SUMMON_GORGON.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_KALKY", "SKILL/SUMMONER/SUMMON_KALKY.XML") );
	m_kContPath.insert( std::make_pair("A_SUMMON_MIST", "SKILL/SUMMONER/SUMMON_MIST.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_DASH_ATTACK", "SKILL/SUMMONER/SUM_DASH_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_DOWN_ATTACK_01", "SKILL/SUMMONER/SUM_DOWN_ATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_DOWN_ATTACK_02", "SKILL/SUMMONER/SUM_DOWN_ATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_DOWN_ATTACK_03", "SKILL/SUMMONER/SUM_DOWN_ATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_RIFLE_CHARGESHOT", "SKILL/SUMMONER/SUM_RIFLE_CHARGESHOT.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_RIFLE_JUMP_SHOT_01", "SKILL/SUMMONER/SUM_RIFLE_JUMP_SHOT_01.XML") );
	m_kContPath.insert( std::make_pair("A_SUM_RIFLE_SHOT", "SKILL/SUMMONER/SUM_RIFLE_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_SURPRISE", "EMOTIONS/SURPRISE.XML") );
	m_kContPath.insert( std::make_pair("A_SWIFTATTACK", "SKILL/THIEF/ASSASSIN/SWIFTATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_SWORD_DANCE", "SKILL/FIGHTER/SWORDDANCE.XML") );
	m_kContPath.insert( std::make_pair("A_SYNC_MOVE", "ACTION/SYNC_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_TALK", "EMOTIONS/TALK.XML") );
	m_kContPath.insert( std::make_pair("A_TAUNT", "SKILL/FIGHTER/KNIGHT/PALADIN/TAUNT.XML") );
	m_kContPath.insert( std::make_pair("A_TAURINE_SUPPORT", "SKILL/PET/TAURINE_SUPPORT.XML") );
	m_kContPath.insert( std::make_pair("A_TELEJUMP", "ACTION/TELEJUMP.XML") );
	m_kContPath.insert( std::make_pair("A_TELEPORT", "ACTION/TELEPORT.XML") );
	m_kContPath.insert( std::make_pair("A_TELEPORT01", "ACTION/TELEPORT01.XML") );
	m_kContPath.insert( std::make_pair("A_TELEPORT01_OUT", "ACTION/TELEPORT01_OUT.XML") );
	m_kContPath.insert( std::make_pair("A_TELEPORT_OUT", "ACTION/TELEPORT_OUT.XML") );
	m_kContPath.insert( std::make_pair("A_TELEPORT_ROCKET", "ACTION/TELEPORT_ROCKET.XML") );
	m_kContPath.insert( std::make_pair("A_TELEPORT_ROCKET_OUT", "ACTION/TELEPORT_ROCKET_OUT.XML") );
	m_kContPath.insert( std::make_pair("A_TEMPTATION_CAST", "SKILL/SUMMONER/TEMPTATION_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_TESLA_COIL", "SKILL/ARCHER/HUNTER/TRAPPER/TESLACOIL.XML") );
	m_kContPath.insert( std::make_pair("A_TESLA_COIL_PLAY", "SKILL/ARCHER/HUNTER/TRAPPER/TESLACOIL_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_THIEF_CHARGE_ATTACK", "SKILL/THIEF/THIEF_CHARGE_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_THIEF_FLOAT_MELEE_01", "SKILL/THIEF/THIEFFLOATMELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_THIEF_FRIENDSHIP", "SKILL/THIEF/THIEFFRIENDSHIP.XML") );
	m_kContPath.insert( std::make_pair("A_THIEF_JUMP_KICK", "SKILL/THIEF/THIEF_JUMP_KICK.XML") );
	m_kContPath.insert( std::make_pair("A_THI_DASH_ATTACK", "SKILL/THIEF/THIDASHATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_THI_DOWN_ATTACK_01", "SKILL/THIEF/THI_DOWNATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_THI_DOWN_ATTACK_02", "SKILL/THIEF/THI_DOWNATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_THI_DOWN_ATTACK_03", "SKILL/THIEF/THI_DOWNATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_THI_DOWN_ATTACK_FLY", "SKILL/THIEF/THI_DOWNATTACK_FLY.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_01", "SKILL/THIEF/THI_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_02", "SKILL/THIEF/THI_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_03", "SKILL/THIEF/THI_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_04", "SKILL/THIEF/THI_MELEE_04.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_05", "SKILL/THIEF/THI_MELEE_05.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_BLOW_UP", "SKILL/THIEF/THI_MELEE_BLOW_UP.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_DROP", "SKILL/THIEF/THI_MELEE_DROP.XML") );
	m_kContPath.insert( std::make_pair("A_THI_MELEE_KNOCK_BACK", "SKILL/THIEF/THI_MELEE_KNOCK_BACK.XML") );
	m_kContPath.insert( std::make_pair("A_THREE WAY_CAST", "SKILL/MAGICIAN/THREEWAY_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_THREE WAY_FIRE", "SKILL/MAGICIAN/THREEWAY_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_THROWING DAGGER", "SKILL/THIEF/ASSASSIN/THROWINGDAGGER.XML") );
	m_kContPath.insert( std::make_pair("A_THROW_DOWN", "ACTION/THROWDOWN.XML") );
	m_kContPath.insert( std::make_pair("A_THROW_DOWN2", "ACTION/THROWDOWN2.XML") );
	m_kContPath.insert( std::make_pair("A_THRUST", "SKILL/ARCHER/THRUST.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A", "SKILL/FIGHTER/THS_COMBO_A.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A_2", "SKILL/FIGHTER/THS_COMBO_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A_3", "SKILL/FIGHTER/THS_COMBO_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A_3_4", "SKILL/FIGHTER/THS_COMBO_A_3_4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A_3_5", "SKILL/FIGHTER/THS_COMBO_A_3_5.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A_4", "SKILL/FIGHTER/THS_COMBO_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_A_5", "SKILL/FIGHTER/THS_COMBO_A_5.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_B", "SKILL/FIGHTER/THS_COMBO_B.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_B_3", "SKILL/FIGHTER/THS_COMBO_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_B_4", "SKILL/FIGHTER/THS_COMBO_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_B_5", "SKILL/FIGHTER/THS_COMBO_B_5.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C", "SKILL/FIGHTER/THS_COMBO_C.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_4", "SKILL/FIGHTER/THS_COMBO_C_4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_5_C", "SKILL/FIGHTER/THS_COMBO_C_5_C.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_5_F1", "SKILL/FIGHTER/THS_COMBO_C_5_F1.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_5_F2", "SKILL/FIGHTER/THS_COMBO_C_5_F2.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_5_F3", "SKILL/FIGHTER/THS_COMBO_C_5_F3.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_5_F4", "SKILL/FIGHTER/THS_COMBO_C_5_F4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_C_5_F5", "SKILL/FIGHTER/THS_COMBO_C_5_F5.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_D", "SKILL/FIGHTER/THS_COMBO_D.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_D_5", "SKILL/FIGHTER/THS_COMBO_D_5.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_A", "SKILL/FIGHTER/THS_COMBO_K_A.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_A_2", "SKILL/FIGHTER/THS_COMBO_K_A_2.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_A_3", "SKILL/FIGHTER/THS_COMBO_K_A_3.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_A_4", "SKILL/FIGHTER/THS_COMBO_K_A_4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_B", "SKILL/FIGHTER/THS_COMBO_K_B.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_B_3", "SKILL/FIGHTER/THS_COMBO_K_B_3.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_B_4", "SKILL/FIGHTER/THS_COMBO_K_B_4.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_C", "SKILL/FIGHTER/THS_COMBO_K_C.XML") );
	m_kContPath.insert( std::make_pair("A_THS_COMBO_K_D", "SKILL/FIGHTER/THS_COMBO_K_D.XML") );
	m_kContPath.insert( std::make_pair("A_THUNDER BREAK", "SKILL/MAGICIAN/MAGE/WIZARD/THUNDERBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_THUNDERBOLT", "SKILL/PET/THUNDERBOLT.XML") );
	m_kContPath.insert( std::make_pair("A_TIGER_BUFF", "SKILL/PET/TIGER_BUFF.XML") );
	m_kContPath.insert( std::make_pair("A_TIME FREEZE", "SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/TIMEFREEZE.XML") );
	m_kContPath.insert( std::make_pair("A_TIME REVERSE", "SKILL/FIGHTER/KNIGHT/PALADIN/TIMEREVERSE.XML") );
	m_kContPath.insert( std::make_pair("A_TIME_FREEZE_EFFECT", "ACTION/TIMEFREEZEEFFECT.XML") );
	m_kContPath.insert( std::make_pair("A_TITANIUM_BODY", "SKILL/PET/TITANIUMBODY.XML") );
	m_kContPath.insert( std::make_pair("A_TORNADO", "SKILL/MAGICIAN/BATTLEMAGE/TORNADO.XML") );
	m_kContPath.insert( std::make_pair("A_TOUCH_DMG", "ACTION/TOUCH_DMG.XML") );
	m_kContPath.insert( std::make_pair("A_TRACE_FLY", "ACTION/TRACE_FLY.XML") );
	m_kContPath.insert( std::make_pair("A_TRACE_FLY2", "ACTION/TRACE_FLY2.XML") );
	m_kContPath.insert( std::make_pair("A_TRACE_GROUND", "ACTION/TRACE_GROUND.XML") );
	m_kContPath.insert( std::make_pair("A_TRACE_GROUND2", "ACTION/TRACE_GROUND2.XML") );
	m_kContPath.insert( std::make_pair("A_TRACE_IDLE", "ACTION/TRACEIDLE.XML") );
	m_kContPath.insert( std::make_pair("A_TRANSFORMATION", "SKILL/MAGICIAN/MAGICIAN_TRANSFORMATION.XML") );
	m_kContPath.insert( std::make_pair("A_TRAP", "ACTION/TRAP.XML") );
	m_kContPath.insert( std::make_pair("A_TUMBLING", "SKILL/ARCHER/TUMBLING.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_ABS_PROTECT_FU", "SKILL/TWINS/FU_ABS_PROTECT.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_BOOST_FU", "SKILL/TWINS/FU_BOOST.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_BUNKER_BUSTER", "SKILL/TWINS/TWIN_BUNKER_BUSTER.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CHAIN_BLOW", "SKILL/TWINS/TWIN_CHAIN_BLOW.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CHAIN_BLOW_S", "SKILL/TWINS/TWIN_CHAIN_BLOW_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CHARGE_SHOT", "SKILL/TWINS/TWIN_CHARGE_SHOT.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CHARGE_SHOT1_S", "SKILL/TWINS/TWIN_CHARGE_SHOT1_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CHARGE_SHOT2_S", "SKILL/TWINS/TWIN_CHARGE_SHOT2_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_COMBAT_REVIVE_CAST", "SKILL/TWINS/TWIN_COMBAT_REVIVE_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CROSS_FIST_FINISH", "SKILL/TWINS/TWIN_CROSS_FIST_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CROSS_FIST_FINISH_S", "SKILL/TWINS/TWIN_CROSS_FIST_FINISH_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CROSS_FIST_START", "SKILL/TWINS/TWIN_CROSS_FIST_START.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_CROSS_FIST_START_S", "SKILL/TWINS/TWIN_CROSS_FIST_START_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DASH_ATTACK", "SKILL/TWINS/TWIN_DASH_ATTACK.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DEADLY_SPOT_CAST", "SKILL/TWINS/TWIN_DEADLY_SPOT_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DEADLY_SPOT_FIRE", "SKILL/TWINS/TWIN_DEADLY_SPOT_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DOWN_ATTACK_01", "SKILL/TWINS/TWIN_DOWN_ATTACK_01.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DOWN_ATTACK_02", "SKILL/TWINS/TWIN_DOWN_ATTACK_02.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DOWN_ATTACK_03", "SKILL/TWINS/TWIN_DOWN_ATTACK_03.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DRAGON_KICK_S", "SKILL/TWINS/TWIN_DRAGON_KICK_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_DRAGON_UPPER", "SKILL/TWINS/TWIN_DRAGON_UPPER.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FINISH_IMPACT_FU", "SKILL/TWINS/FU_FINISH_IMPACT.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FINISH_MOVE_FU", "SKILL/TWINS/FU_FINISH_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FIST_STORM_DASH", "SKILL/TWINS/TWIN_FIST_STORM_DASH.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FIST_STORM_FINISH", "SKILL/TWINS/TWIN_FIST_STORM_FINISH.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FIST_STORM_FIRE", "SKILL/TWINS/TWIN_FIST_STORM_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FIST_STORM_S", "SKILL/TWINS/TWIN_FIST_STORM_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FLOAT_MELEE_01", "SKILL/TWINS/TWIN_FLOAT_MELEE_01.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FLOAT_MELEE_02", "SKILL/TWINS/TWIN_FLOAT_MELEE_02.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FLOAT_MELEE_03", "SKILL/TWINS/TWIN_FLOAT_MELEE_03.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_FUSION", "SKILL/TWINS/TWIN_FUSION.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_GHOST_FIGHTER_FU", "SKILL/TWINS/FU_GHOST_FIGHTER.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_HYPER_KNEE_KICK", "SKILL/TWINS/TWIN_HYPER_KNEE_KICK.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_IMPACT_BLOW_FU", "SKILL/TWINS/FU_IMPACT_BLOW.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_INFINITE_KICK", "SKILL/TWINS/TWIN_INFINITE_KICK.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_LIGHTNING_FLASH", "SKILL/TWINS/TWIN_LIGHTNING_FLASH.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_LIGHTNING_KICK2_S", "SKILL/TWINS/TWIN_LIGHTNING_KICK2_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_LIGHTNING_KICK_S", "SKILL/TWINS/TWIN_LIGHTNING_KICK_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_LION_ROAR", "SKILL/TWINS/TWIN_LION_ROAR.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_MAKE_TWO", "SKILL/TWINS/TWIN_MAKE_TWO.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_MELEE_01_M", "SKILL/TWINS/TWIN_MELEE_01_M.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_MELEE_02_M", "SKILL/TWINS/TWIN_MELEE_02_M.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_MELEE_03_S", "SKILL/TWINS/TWIN_MELEE_03_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_MELEE_04_M", "SKILL/TWINS/TWIN_MELEE_04_M.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_MELEE_05_S", "SKILL/TWINS/TWIN_MELEE_05_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_POWER_FIST", "SKILL/TWINS/TWIN_POWER_FIST.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_POWER_WEAVING", "SKILL/TWINS/TWIN_POWER_WEAVING.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_RAPID_STANCE", "SKILL/TWINS/TWIN_RAPID_STANCE.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_RISING_DROP_KICK_S", "SKILL/TWINS/TWIN_RISING_DROP_KICK_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_ROCKET_BLOW_S", "SKILL/TWINS/TWIN_ROCKET_BLOW_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_ROLLING_GRABBLE_S", "SKILL/TWINS/TWIN_ROLLING_GRABBLE_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SCREW_DROP_KICK", "SKILL/TWINS/TWIN_SCREW_DROP_KICK.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SLIDE_WHIRL", "SKILL/TWINS/TWIN_SLIDE_WHIRL.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SLIDING_BATTER_S", "SKILL/TWINS/TWIN_SLIDING_BATTER_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SMASH_KICK_S", "SKILL/TWINS/TWIN_SMASH_KICK_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SPIN_BLADE_S", "SKILL/TWINS/TWIN_SPIN_BLADE_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SPIN_BOOM_S", "SKILL/TWINS/TWIN_SPIN_BOOM_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SPIN_KICK", "SKILL/TWINS/TWIN_SPIN_KICK.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SPIN_KICK_S", "SKILL/TWINS/TWIN_SPIN_KICK_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SPIRIT_RELEASE_FU", "SKILL/TWINS/FU_SPIRIT_RELEASE.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SPIRIT_SPEAR_S", "SKILL/TWINS/TWIN_SPIRIT_SPEAR_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_STAMPER_S", "SKILL/TWINS/TWIN_STAMPER_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SUB_REPOS", "ACTION/TWIN_REPOS_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SUB_TRACE_GROUND", "ACTION/TWIN_SUB_TRACE_GROUND.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SUMMERSOLT", "SKILL/TWINS/TWIN_SUMMERSOLT.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SUMMERSOLT_S", "SKILL/TWINS/TWIN_SUMMERSOLT_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_SWISH_KICK_S", "SKILL/TWINS/TWIN_SWISH_KICK_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_TORNADO_SPIN", "SKILL/TWINS/TWIN_TORNADO_SPIN.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_TORNADO_UPPER", "SKILL/TWINS/TWIN_TORNADO_UPPER.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_TRAINING_TIME", "SKILL/TWINS/TWIN_TRAINING_TIME.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_WEAVING", "SKILL/TWINS/TWIN_WEAVING.XML") );
	m_kContPath.insert( std::make_pair("A_TWIN_WEAVING_S", "SKILL/TWINS/TWIN_WEAVING_S.XML") );
	m_kContPath.insert( std::make_pair("A_TWOACTION_CAST", "SKILL/ARCHER/RANGER/TWOACTION_CAST.XML") );
	m_kContPath.insert( std::make_pair("A_TWOACTION_FIRE", "SKILL/ARCHER/RANGER/TWOACTION_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_UNHIDE", "ACTION/UNHIDE.XML") );
	m_kContPath.insert( std::make_pair("A_UNLOCK_MOVE", "ACTION/UNLOCK_MOVE.XML") );
	m_kContPath.insert( std::make_pair("A_USE COOK", "SKILL/ARCHER/HUNTER/TRAPPER/USECOOK.XML") );
	m_kContPath.insert( std::make_pair("A_USE ENCHANT", "SKILL/MAGICIAN/MAGE/WIZARD/USEENCHANT.XML") );
	m_kContPath.insert( std::make_pair("A_USE REPAIR", "SKILL/FIGHTER/KNIGHT/PALADIN/USEREPAIR.XML") );
	m_kContPath.insert( std::make_pair("A_VALCAN 300", "SKILL/ARCHER/RANGER/SNIPER/VALCAN300.XML") );
	m_kContPath.insert( std::make_pair("A_VALCAN 300 PLAY", "SKILL/ARCHER/RANGER/SNIPER/VALCAN300_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_VENDOR", "ACTION/VENDOR.XML") );
	m_kContPath.insert( std::make_pair("A_VENOM", "SKILL/THIEF/VENOM.XML") );
	m_kContPath.insert( std::make_pair("A_VENOM CRASHER", "SKILL/THIEF/ASSASSIN/VENOMCRASHER.XML") );
	m_kContPath.insert( std::make_pair("A_VICTORY", "EMOTIONS/VICTORY.XML") );
	m_kContPath.insert( std::make_pair("A_VIOLENCE BLOW", "SKILL/THIEF/CLOWN/VIOLENCEBLOW.XML") );
	m_kContPath.insert( std::make_pair("A_VITALITY", "SKILL/THIEF/CLOWN/VITALITY.XML") );
	m_kContPath.insert( std::make_pair("A_VOLCANO", "SKILL/SUMMONER/VOLCANO.XML") );
	m_kContPath.insert( std::make_pair("A_VOLUNTARILY_DIE", "ACTION/VOLUNTARILY_DIE.XML") );
	m_kContPath.insert( std::make_pair("A_VOTE", "EMOTIONS/VOTE.XML") );
	m_kContPath.insert( std::make_pair("A_WALK_DOWN", "ACTION/WALK_DOWN.XML") );
	m_kContPath.insert( std::make_pair("A_WALK_LEFT", "ACTION/WALK_LEFT.XML") );
	m_kContPath.insert( std::make_pair("A_WALK_RIGHT", "ACTION/WALK_RIGHT.XML") );
	m_kContPath.insert( std::make_pair("A_WALK_UP", "ACTION/WALK_UP.XML") );
	m_kContPath.insert( std::make_pair("A_WARP", "ACTION/WARP.XML") );
	m_kContPath.insert( std::make_pair("A_WEAPON BREAK", "SKILL/FIGHTER/WARRIOR/GLADIATOR/WEAPONBREAK.XML") );
	m_kContPath.insert( std::make_pair("A_WEAPON BREAK_FIRE", "SKILL/FIGHTER/WARRIOR/GLADIATOR/WEAPONBREAK_FIRE.XML") );
	m_kContPath.insert( std::make_pair("A_WEAPON CRASHER", "SKILL/FIGHTER/KNIGHT/PALADIN/WEAPONCRASHER.XML") );
	m_kContPath.insert( std::make_pair("A_WEAPON FREEZING", "SKILL/FIGHTER/KNIGHT/WEAPONFREEZING.XML") );
	m_kContPath.insert( std::make_pair("A_WEAPON QUICKEN", "SKILL/FIGHTER/WARRIOR/GLADIATOR/WEAPONQUICKEN.XML") );
	m_kContPath.insert( std::make_pair("A_WHEEL WIND", "SKILL/FIGHTER/WARRIOR/GLADIATOR/WHEELWIND.XML") );
	m_kContPath.insert( std::make_pair("A_WIDE HEAL", "SKILL/MAGICIAN/MAGE/WIDEHEAL.XML") );
	m_kContPath.insert( std::make_pair("A_WILD RAGE", "SKILL/FIGHTER/WARRIOR/WILDRAGE.XML") );
	m_kContPath.insert( std::make_pair("A_WIND STEP", "SKILL/ARCHER/WIND_STEP.XML") );
	m_kContPath.insert( std::make_pair("A_WIND SURIKEN", "SKILL/THIEF/ASSASSIN/NINJA/WINDSURIKEN.XML") );
	m_kContPath.insert( std::make_pair("A_WINDBLADE", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WINDBLADE.XML") );
	m_kContPath.insert( std::make_pair("A_WINDBLADESA", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WINDBLADESA.XML") );
	m_kContPath.insert( std::make_pair("A_WINDMILL", "SKILL/THIEF/CLOWN/DANCER/WINDMILL.XML") );
	m_kContPath.insert( std::make_pair("A_WINDSTEP", "SKILL/THIEF/ASSASSIN/NINJA/WINDSTEP.XML") );
	m_kContPath.insert( std::make_pair("A_WIRE ACTION", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WIREACTION.XML") );
	m_kContPath.insert( std::make_pair("A_WIRE ACTION_FINISH", "SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WIREACTIONFINISH.XML") );
	m_kContPath.insert( std::make_pair("A_WOLF RUSH", "SKILL/ARCHER/HUNTER/WOLFRUSH.XML") );
	m_kContPath.insert( std::make_pair("A_WOLF RUSH_PLAY", "SKILL/ARCHER/HUNTER/WOLFRUSH_PLAY.XML") );
	m_kContPath.insert( std::make_pair("A_WP GRANADE", "SKILL/ARCHER/RANGER/SNIPER/WPGRANADE.XML") );
	m_kContPath.insert( std::make_pair("A_WP GRANADE FIRE", "SKILL/ARCHER/RANGER/SNIPER/WPGRANADEFIRE.XML") );
	m_kContPath.insert( std::make_pair("A_WRATHOFHEAVEN", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/WRATHOFHEAVEN.XML") );
	m_kContPath.insert( std::make_pair("A_WRATHOFHEAVENSA", "SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/WRATHOFHEAVENSA.XML") );
	m_kContPath.insert( std::make_pair("A_WYVERN BLADE", "SKILL/FIGHTER/WARRIOR/GLADIATOR/WYVERNBLADE.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSHLONG", "ACTION/MON_PUSHLONG.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSHMIDDLE", "ACTION/MON_PUSHMIDDLE.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSHSHORT", "ACTION/MON_PUSHSHORT.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSH_ATOT", "ACTION/MON_PUSH_ATOT.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSH_BACK", "ACTION/MON_PUSHBACK.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSH_BACK_LONG", "ACTION/MON_PUSHBACK_LONG.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSH_BACK_LONG_2", "ACTION/MON_PUSH_BACK_LONG_2.XML") );
	m_kContPath.insert( std::make_pair("MON_PUSH_BACK_SHORT", "ACTION/MON_PUSHBACK_SHORT.XML") );
	m_kContPath.insert( std::make_pair("M_CHAOSBOOM", "MON/CHAOSBOOM.XML") );

	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/ACCELERATION.XML", "<ACTION ID=\"a_Acceleration\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_Acceleration_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_Acceleration_02_char_root\"       HIT_SOUND_ID=\"Acceleration\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/ACIDARROW.XML", "<ACTION ID=\"a_Acid Arrow\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID=\"PROJECTILE_ACID_ARROW\"       HIT_SOUND_ID=\"AcidArrow\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ACT.XML", "<ACTION ID=\"a_act\" CHECK_CAN_ENTER=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Action\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/ADRENALIN.XML", "<ACTION ID=\"a_Adrenalin\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_Adrenalin_01_char_root\"       HIT_SOUND_ID=\"Adrenalin\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/AIMING.XML", "<ACTION ID=\"a_Aiming\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"true\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_Eiming_02_char_root\"              HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID=\"ef_Eiming_01_char_root\"       HIT_SOUND_ID=\"Aeming\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/AIONOFF.XML", "<ACTION ID=\"a_aionoff\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Pet_AIOnOff\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/AIR_SMASH.XML", "<ACTION ID=\"a_Air_Smash\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Skill_Air_Smash\"/>	<FSM SCRIPT=\"Air_Smash\" 	NO_DAMAGE_HOLD=\"TRUE\" 	ATTCK_DOWN_STATE=\"TRUE\" 	HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"	HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/AIR_SPRASH.XML", "<ACTION ID=\"a_Air_Sprash\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Skill_Air_Sprash\"/>  <FSM SCRIPT=\"Air_Sprash\"	NO_DAMAGE_HOLD=\"TRUE\" 	HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"	HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"    /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/ANNIHILATION.XML", "<ACTION ID=\"a_Annihilation\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Act_Melee_Default\"              HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_skill_Annihilation_02\"       HIT_SOUND_ID=\"Annihilation\" />    </ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/A_APOLLO.XML", "<ACTION ID=\"a_apollo\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/APPEAR.XML", "<ACTION ID=\"a_appear\" LOOP=\"FALSE\">	<SLOT NAME=\"appear\"/>	<FSM SCRIPT=\"Act_SP_Crystal\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/APPEARANCECHANGE.XML", "<ACTION ID=\"a_AppearanceChange\" NEXT=\"a_idle\" TYPE=\"EFFECT\">	<SLOT NAME=\"appearance_change_01\"/>	<FSM SCRIPT=\"Act_AppearanceChange\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/APRILFOOL.XML", "<ACTION ID=\"a_April Fool\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       NO_WEAPON_TRAIL=\"TRUE\"	   HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID =\"eff_skill_april_01\"	   HIT_SOUND_ID=\"AprilFool\"       />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARAMMUTISHA/ARAM_BACKWARD.XML", "<ACTION ID=\"a_aram_backward_skill\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"aram_backward_skill_start\"/>	<SLOT NAME=\"aram_backward_skill_01\"/>	<SLOT NAME=\"aram_backward_skill_02\"/>	<SLOT NAME=\"aram_backward_skill_03\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Aram_Backward\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARAMMUTISHA/ARAM_FRONTWARD.XML", "<ACTION ID=\"a_aram_frontward_skill\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"aram_frontward_skill_start\"/>	<SLOT NAME=\"aram_frontward_skill_01\"/>	<SLOT NAME=\"aram_frontward_skill_02\"/>	<SLOT NAME=\"aram_frontward_skill_03\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Aram_Frontward\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/ARCSANCTUARY.XML", "<ACTION ID=\"a_Arc Sanctuary\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_down_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"Sanctuary\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/ARCSANCTUARY_PLAY.XML", "<ACTION ID=\"a_Arc Sanctuary_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"opening\"/>  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Santuary_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHERFLOATSHOT_01.XML", "<ACTION ID=\"a_ArcherFloatShot_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"ArcherFloatShot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_BACKSTEP_SHOT.XML", "<ACTION ID=\"a_archer_backstep_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"back_step_combo_Attk\"/>	<SLOT NAME=\"back_step_combo_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"	     		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo01_a\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"  />	</ACTION>	") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_BACK_JUMP_SHOT.XML", "<ACTION ID=\"a_archer_back_jump_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Bow_attk_backstep_01\"/>  <FSM SCRIPT=\"Archer_Jump_Shot\" JumpHeight =\"50\" HorizMoveSpeed=\"60\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_CHARGE_ARROW.XML", "<ACTION ID=\"a_archer_charge_arrow\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_charge_01\"/>  <SLOT NAME=\"attk_charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_charge_03\"/>  <FSM SCRIPT=\"Skill_Archer_Charge_Arrow\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_CHARGE_SHOT.XML", "<ACTION ID=\"a_archer_charge_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_charge_01\"/>  <SLOT NAME=\"attk_charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_charge_03\"/>  <FSM SCRIPT=\"Skill_Archer_Charge_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_DASHATTACK.XML", "<ACTION ID=\"a_archer_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dash_attk_01\"/>  <FSM SCRIPT=\"Skill_Dash_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_DOWN_SHOT.XML", "<ACTION ID=\"a_archer_down_shot\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"jump_down_attk2_01\"/>  <SLOT NAME=\"jump_down_attk2_02\"/>  <SLOT NAME=\"jump_down_attk2_03\"/>    <FSM SCRIPT=\"Archer_Down_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHERFRIENDSHIP.XML", "<ACTION ID=\"a_Archer_Friendship\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"FriendShipBuff\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_JUMP_SHOT.XML", "<ACTION ID=\"a_archer_jump_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Bow_attk_fly_01\"/>  <FSM SCRIPT=\"Archer_Jump_Shot\" PROJECTILE_ID=\"PROJECTILE_ARCHER_JUMPSHOT\" ARROW_ROTATE=\"-10\" ATTCK_DOWN_STATE=\"TRUE\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_MELEE.XML", "<ACTION ID=\"a_archer_melee\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\">  <SLOT NAME=\"attk_03\"/>   <FSM SCRIPT=\"Act_Melee_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_POWER_SHOT.XML", "<ACTION ID=\"a_archer_power_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Archer_Power_Shot\" PROJECTILE_ID=\"PROJECTILE_POWERSHOT\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARCHER_SHOT_01.XML", "<ACTION ID=\"a_archer_shot_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"archer_shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARC_DOWNATTACK_01.XML", "<ACTION ID=\"a_arc_down_attack_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARC_DOWNATTACK_02.XML", "<ACTION ID=\"a_arc_down_attack_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARC_DOWNATTACK_03.XML", "<ACTION ID=\"a_arc_down_attack_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_03\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARC_DOWNATTACK_FLY.XML", "<ACTION ID=\"a_arc_down_attack_fly\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\"  CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_fly\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/ARMORBREAK.XML", "<ACTION ID=\"a_Armor Break\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_armor_break_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"ArmorBreak\" WEAPON_XML=\"../XML/Item/Common/12_Weapon/09_special/ArmorBreakAxe.xml\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Armor_Break_01_char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"	/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/ARROW_SHOWER.XML", "<ACTION ID=\"a_Arrow Shower\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"attk_charge_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"ArrowShower_01\"/>	<FSM SCRIPT=\"Skill_Arrow_Shower\"        PROJECTILE_ID=\"PROJECTILE_ARROW_SHOWER_ARROW\" 	     ATTACH_NODE=\"p_wp_r_hand\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/ASCENSIONDRAGON.XML", "<ACTION ID=\"a_AscensionDragon\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"AscensionDragon_01_01\"/>  <SLOT NAME=\"AscensionDragon_01_02\"/>  <SLOT NAME=\"AscensionDragon_01_03\"/>  <FSM SCRIPT=\"Skill_DragonKnight_AscensionDragon\"       CASTING_EFFECT_EFFECT_ID=\"ef_skill_Ascension_Dragon_01_char_root\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_Ascension_Dragon_Dragon_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_SOUND_ID=\"AscensionDragon\"	   MULTI_HIT_NUM=\"10\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/SIDEDASHATTACK.XML", "<ACTION ID=\"a_ass_attk_dash\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Claw_dash_attk_L_01\"/>  <SLOT NAME=\"Claw_dash_attk_R_01\"/>  <FSM SCRIPT=\"Skill_SideDashAttack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/ATROPINE.XML", "<ACTION ID=\"a_Atropine\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Atropine_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID=\"ef_Atropine_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_wp_r_hand\"       FIRE_CASTER_EFFECT_ID=\"ef_Atropine_01_p_wp_r_hand\"       FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       HIT_SOUND_ID=\"Atropine\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       HIDE_WEAPON=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/ATTACK_ADD.XML", "<ACTION ID=\"a_attack_add\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/AUTOSHOOTSYSTEM.XML", "<ACTION ID=\"a_Auto Shoot System\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       BROADCAST_TARGETLIST=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/AUTOSHOOTSYSTEM_FIRE.XML", "<ACTION ID=\"a_Auto Shoot System_Fire\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Skill_AutoShootSystem_Fire\" PROJECTILE_ID=\"PROJECTILE_FORTRESS\"       HIT_SOUND_ID=\"AutoShootSystem\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/AUTOSHOOTSYSTEM_PLAY.XML", "<ACTION ID=\"a_Auto Shoot System_Play\" NEXT=\"a_Auto Shoot System_Play\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Skill_AutoShootSystem_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/AWAKECHARGE.XML", "<ACTION ID=\"a_AwakeCharge\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">    <SLOT NAME=\"Awake_Charge_Cast\"/>  <SLOT NAME=\"Awake_Charging\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"AwakeCharge\"       NO_WEAPON_TRAIL=\"TRUE\"	   FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Awakeharge_01_char_root\"	   DETACH_FIRE_EFFECT_AT_LEAVE=\"TRUE\"       FIRE_SOUND_ID=\"awakecharge_skill_fire\"	   	   />	   <!--LOOP_SOUND_ID=\"awakeCharge_skill_loop\"--></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/BACKDRAFT.XML", "<ACTION ID=\"a_Back Draft\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"BackDraft\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/BACKDRAFTFIRE.XML", "<ACTION ID=\"a_Back Draft Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_BackDraft_Fire\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BACKSTEP.XML", "<ACTION ID=\"a_back_step\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"back_step_combo_Attk\"/>	<SLOT NAME=\"back_step_combo_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"       />	</ACTION>	") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/BARRICADE.XML", "<ACTION ID=\"a_Barricade\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_skill_Barricade_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_SOUND_ID=\"Barricade\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/BARRIER.XML", "<ACTION ID=\"a_Barrier\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_05\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"Barrier\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BATTLE_IDLE.XML", "<ACTION ID=\"a_battle_idle\" TYPE=\"IDLE\" CAN_FOLLOW=\"TRUE\" LOOP=\"TRUE\" NEXT=\"a_battle_idle\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"battle_idle\"/>  <SLOT NAME=\"btlidle_01\"/>  	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/BEARHANK.XML", "<ACTION ID=\"a_Bear Hank\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"BearHank\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/BEAR_EMERGENCY_ESCAPE.XML", "<ACTION ID=\"a_bear_emergency_escape\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"carry_shot\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"efx_ctf_bear_explosion_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"				FIRE_SOUND_ID=\"love_bear_explosion_01\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BEAUTIFUL_GIRL.XML", "<ACTION ID=\"a_Beautiful Girl\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/BEG.XML", "<ACTION ID=\"a_beg\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_beg_01\"/>	<SLOT NAME=\"emotion_beg_02\"/>	<SLOT NAME=\"emotion_beg_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BITEOFF.XML", "<ACTION ID=\"a_bite_off\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"run\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       HIT_CASTER_EFFECT_ID=\"ef_bitt_off_00_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       MULTI_HIT_NUM=\"1\"       HIT_RUN_STOP=\"TRUE\"       MOVING_ATTACK_TICK=\"0.0\"       FIRE_SOUND_ID=\"leo-skill-bitt_off\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BLEEDING.XML", "<ACTION ID=\"a_Bleeding\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID =\"PROJECTILE_BLEEDING\"       HIT_SOUND_ID=\"Bleeding\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/BLESSING.XML", "<ACTION ID=\"a_Blessing\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       HIT_CASTER_EFFECT_ID =\"ef_blessing_01_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE =\"char_root\"       HIT_TARGET_EFFECT_ID = \"ef_blessing_02_char_root\"       HIT_SOUND_ID=\"Blessing\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BLIND.XML", "<ACTION ID=\"a_Blind\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Act_Blind\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BLINK.XML", "<ACTION ID=\"a_Blink\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"Blink_Attk\"/>	<SLOT NAME=\"Blink_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"		FIRE_SOUND_ID=\"Blink\"		EFFECT_CNT_WHEN_MOVE_START=\"1\"		EFFECT_TYPE_WHEN_MOVE_START_1=\"6\"		EFFECT_ID_WHEN_MOVE_START_1=\"ef_show_01_p_ef_heart\"		EFFECT_TARGET_NODE_WHEN_MOVE_START_1=\"p_ef_heart\"				EFFECT_CNT_WHEN_MOVE_END=\"1\"		EFFECT_TYPE_WHEN_MOVE_END_1=\"6\"		EFFECT_ID_WHEN_MOVE_END_1=\"ef_show_01_p_ef_heart\"		EFFECT_TARGET_NODE_WHEN_MOVE_END_1=\"p_ef_heart\"	   /></ACTION>  ") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/BLITZ.XML", "<ACTION ID=\"a_Blitz\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Skill_Blitz\"       HIT_SOUND_ID=\"FalconBeat\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/BLITZ_PLAY.XML", "<ACTION ID=\"a_Blitz_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_Blitz_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/BLIZZARD.XML", "<ACTION ID=\"a_Blizzard\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"debuff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"Blizzard1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/BLIZZARD_ATTACK.XML", "<ACTION ID=\"a_Blizzard_Attack\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BLIZZARD_A.XML", "<ACTION ID=\"a_blizzard_pet_a\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" >  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       PROJECTILE_ID=\"PROJECTILE_Blizzard_pet\"       FIRE_SOUND_ID=\"skill-blizzard_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BLIZZARD_B.XML", "<ACTION ID=\"a_blizzard_pet_b\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" >  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       PROJECTILE_ID=\"PROJECTILE_Blizzard_pet\"       FIRE_SOUND_ID=\"skill-blizzard_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BLIZZARD_C.XML", "<ACTION ID=\"a_blizzard_pet_c\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" >  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       PROJECTILE_ID=\"PROJECTILE_Blizzard_pet\"       FIRE_SOUND_ID=\"skill-blizzard_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BLOCK.XML", "<ACTION ID=\"a_block\" NEXT=\"a_battle_idle\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"blocking\"/>  <FSM SCRIPT=\"Block\" 		USE_TLM=\"FALSE\"		CANCEL_TYPE=\"1\"		EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"	EFFECT_ID_WHEN_ANI_SLOT1_1=\"ef_blocking_01\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODYLORE.XML", "<ACTION ID=\"a_Bloody Lore\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_shot_04\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID_MALE=\"Male_BloodyLore\"       HIT_SOUND_ID_FEMALE=\"Female_BloodyLore\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODY_MELEE_01.XML", "<ACTION ID=\"a_Bloody_melee_01\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODY_MELEE_02.XML", "<ACTION ID=\"a_Bloody_melee_02\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"melee_02\"/>  <FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/BLOODY_MELEE_03.XML", "<ACTION ID=\"a_Bloody_melee_03\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"melee_03\"/>  <FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BLOWDOWN.XML", "<ACTION ID=\"a_blow_down\"  TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"10\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BLOWUPLARGE.XML", "<ACTION ID=\"a_blow_up_large\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\"  CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"160\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/A_BLOW_UP_LARGE_MON.XML", "<ACTION ID=\"a_blow_up_large_mon\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\"  CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"150\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BLOWUPMEDIUM.XML", "<ACTION ID=\"a_blow_up_medium\"  TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"150\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/A_BLOW_UP_MEDIUM_MON.XML", "<ACTION ID=\"a_blow_up_medium_mon\"  TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"100\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BLOWUPSMALL.XML", "<ACTION ID=\"a_blow_up_small\"  TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"60\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/A_BLOW_UP_SMALL_MON.XML", "<ACTION ID=\"a_blow_up_small_mon\"  TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"50\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BODYBUMP_A.XML", "<ACTION ID=\"a_body_bump_a\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dash_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       HIT_CASTER_EFFECT_ID=\"ef_body_bump_00_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       MULTI_HIT_NUM=\"1\"       HIT_RUN_STOP=\"TRUE\"       MOVING_ATTACK_TICK=\"0.0\"       FIRE_SOUND_ID=\"skill-body_bump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BODYBUMP_B.XML", "<ACTION ID=\"a_body_bump_b\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dash_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       HIT_CASTER_EFFECT_ID=\"ef_body_bump_00_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       MULTI_HIT_NUM=\"1\"       HIT_RUN_STOP=\"TRUE\"       MOVING_ATTACK_TICK=\"0.0\"       FIRE_SOUND_ID=\"skill-body_bump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BODYBUMP_C.XML", "<ACTION ID=\"a_body_bump_c\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dash_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       HIT_CASTER_EFFECT_ID=\"ef_body_bump_00_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       MULTI_HIT_NUM=\"1\"       HIT_RUN_STOP=\"TRUE\"       MOVING_ATTACK_TICK=\"0.0\"       FIRE_SOUND_ID=\"skill-body_bump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/BOMB_PET.XML", "<ACTION ID=\"a_bomb_pet\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <!--SLOT NAME=\"btlidle_01_shot_start\"/-->  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"CommonSkillAction\"       USE_PROJECTILE=\"TRUE\"	   	WHEN_START_DIRECTION=\"TARGET\"		PRE_FIND_TARGET_RANGE=\"140\"				FIRE_PROJECTILE_ID_1 = \"Projectile_WildBomb_shot_01\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/BONEDRAGON_DIE.XML", "<ACTION ID=\"a_bonedragon_die\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"die_01\"/>	<SLOT NAME=\"die_idle_01\"/>	<FSM SCRIPT=\"Act_BoneDragon_Die\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/BONEDRAGON_ENDING_MOVIE.XML", "<ACTION ID=\"a_bonedragon_ending_movie\" LOOP=\"FALSE\">	<SLOT NAME=\"ending_movie\"/>	<FSM SCRIPT=\"Act_BoneDragon_Ending_Movie\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/BONEDRAGON_SUMMON_MONSTER.XML", "<ACTION ID=\"a_bonedragon_summon_monster\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"bonedragon_summon_monster_start\"/>	<SLOT NAME=\"bonedragon_summon_monster_battleidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"bonedragon_summon_monster_attack\"/>	<SLOT NAME=\"bonedragon_summon_monster_loop\" LOOP=\"TRUE\"/>	<SLOT NAME=\"bonedragon_summon_monster_finish\"/>	<FSM SCRIPT=\"Act_BoneDragon_Summon_Monster\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/BOOBYTRAP.XML", "<ACTION ID=\"a_Booby Trap\" NEXT=\"a_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_BoobyTrap_01\"/>  <FSM SCRIPT=\"Skill_BoobyTrap\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/BOOBYTRAP_PLAY.XML", "<ACTION ID=\"a_Booby Trap_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_BoobyTrap_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BOSS_DIE_MOVIE.XML", "<ACTION ID=\"a_boss_die_movie\" NEXT=\"a_idle\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"die_01\"/>	<SLOT NAME=\"die_idle_01\"/>	<FSM SCRIPT=\"Act_Boss_Die_Movie\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/BOW.XML", "<ACTION ID=\"a_bow\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_bow\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BREAKABLE_OBJECT_PULLDOWN.XML", "<ACTION ID=\"a_breakable_object_pulldown\" NEXT=\"a_idle\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Breakable_Object_Pulldown\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/BREAKDOWN.XML", "<ACTION ID=\"a_breakdown\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_OTL_01\"/>	<SLOT NAME=\"emotion_OTL_02\"/>	<SLOT NAME=\"emotion_OTL_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BREAKFALL.XML", "<ACTION ID=\"a_break_fall\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE-EVENT=\"TRUE\" >  <SLOT NAME=\"Com_breakfall_Backward\"/>  <SLOT NAME=\"Com_breakfall_Foward\"/>  <SLOT NAME=\"Com_breakfall_Left\"/>  <SLOT NAME=\"Com_breakfall_Right\"/>  <FSM SCRIPT=\"Act_BreakFall\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/BREATH_OF_NATURE.XML", "<ACTION ID=\"a_Breath_Of_Nature\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\" >  <SLOT NAME=\"breath_of_nature_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"breath_of_nature_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\"		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smn_breath_of_nature_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_smn_breath_of_nature_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				FIRE_CASTER_EFFECT_CNT=\"1\"		FIRE_CASTER_EFFECT_TYPE_1=\"0\"		FIRE_CASTER_EFFECT_TARGET_NODE_1 = \"char_root\"		FIRE_CASTER_EFFECT_ID_1 = \"eff_sum_skill_smn_breath_of_nature_01\"		FIRE_CASTER_EFFECT_SCALE_1=\"1\"		FIRE_SOUND_ID=\"buff_skill_give\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/BROTHERISGONE.XML", "<ACTION ID=\"a_Brother is Gone\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_03\"/>  <FSM SCRIPT=\"Skill_BrotherIsGone\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/BROTHERISGONE_PLAY.XML", "<ACTION ID=\"a_Brother is Gone_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"skill_Brother_is_return_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"skill_02\"/>  <FSM SCRIPT=\"Skill_BrotherIsGone_Play\" FIRE_SOUND_ID=\"Singha1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/BROTHERISRETURN.XML", "<ACTION ID=\"a_Brother is Return\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_03\"/>  <FSM SCRIPT=\"Skill_BrotherIsReturn\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/BROTHERISRETURN_PLAY.XML", "<ACTION ID=\"a_Brother is Return_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"skill_Brother_is_return_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"skill_Brother_is_return_01_02\"/>  <SLOT NAME=\"skill_Brother_is_return_01_03\"/>  <FSM SCRIPT=\"Skill_BrotherIsReturn_Play\" FIRE_SOUND_ID=\"Singha2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SPECIAL/BROADOGEN.XML", "<ACTION ID=\"a_Bro_Adogen\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Special_Skill_Shot\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SPECIAL/BROADOGENFIRE.XML", "<ACTION ID=\"a_Bro_Adogen_Fire\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"skill_03\"/>  <SLOT NAME=\"idle_01\"/>    <FSM SCRIPT=\"Skill_Bro_Adogen_Fire\" PROJECTILE_ID=\"PROJECTILE_BRO_ADOGEN\" FIRE_SOUND_ID=\"Singha_Fire\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SPECIAL/BROSPIN.XML", "<ACTION ID=\"a_Bro_Spin\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Special_Skill_Shot\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SPECIAL/BROSPINFIRE.XML", "<ACTION ID=\"a_Bro_Spin_Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"skill_04\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_Bro_Spin_Fire\" FIRE_SOUND_ID=\"Singha_Spin\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/BUFF_ADD.XML", "<ACTION ID=\"a_buff_add\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/BUGSLIFE.XML", "<ACTION ID=\"a_Bugs Life\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Skill_Bugs_Life\"       HIT_SOUND_ID=\"Bugs_Life\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Bugslife_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BULLDOG_CANCLE.XML", "<ACTION ID=\"a_BullDog_Cancle\" NEXT=\"a_BullDog_Cancle\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_BullDog_Idle\"/>	<SLOT NAME=\"Intro_Down\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BULLDOG_IDLE.XML", "<ACTION ID=\"a_BullDog_Idle\" NEXT=\"a_BullDog_Idle\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_BullDog_Idle\"/>	<SLOT NAME=\"Intro_idle_01\"/>	<SLOT NAME=\"Intro_idle_02\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BULLDOG_SELECT.XML", "<ACTION ID=\"a_BullDog_Select\" NEXT=\"a_BullDog_Select\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_BullDog_Idle\"/>	<SLOT NAME=\"Intro_Up\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/BULLDOG_SELECT_IDLE.XML", "<ACTION ID=\"a_BullDog_Select_Idle\" NEXT=\"a_BullDog_Select_Idle\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_BullDog_Idle\"/>	<SLOT NAME=\"Intro_Select_01\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_BURBERRIAN.XML", "<ACTION ID=\"a_Burberrian\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_07\"/>  <FSM SCRIPT=\"Skill_Burberrian\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SKILLACTOR/BURBERRIAN_FREEZE.XML", "<ACTION ID=\"a_Burberrian_Freeze\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"freeze\"/>  <FSM SCRIPT=\"Skill_Burberrian_Freeze\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/BURROW.XML", "<ACTION ID=\"a_Burrow1\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"Burrow\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/BURROW2.XML", "<ACTION ID=\"a_Burrow2\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"Burrow\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_A.XML", "<ACTION ID=\"a_bw_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_a_Attk\"/>	<SLOT NAME=\"bw_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"					FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo01_a\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_B.XML", "<ACTION ID=\"a_bw_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_b_Attk\"/>	<SLOT NAME=\"bw_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"					FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_heart\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo01_b\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C.XML", "<ACTION ID=\"a_bw_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_Attk\"/>	<SLOT NAME=\"bw_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"					FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_heart\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo01_c\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C_4_C.XML", "<ACTION ID=\"a_bw_combo_c_4_C\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_4_C_Start\"/>	<SLOT NAME=\"bw_combo_c_4_C_btlidle\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_COMBO_CHARGE=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.1\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"0.2\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo02_charge00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Bip01 L Hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"						EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_bow_combo02_charge01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"TRUE\"				CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.85\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_1=\"0.63\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_2=\"0.38\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_3=\"0.25\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_4=\"0.05\"				SAVE_CAMERA_POS=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C_4_F1.XML", "<ACTION ID=\"a_bw_combo_c_4_F1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_4_F1_Attk\"/>	<SLOT NAME=\"bw_combo_c_4_F1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\"      	USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_C_4_F1\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"				NO_DAMAGE_HOLD =\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C_4_F2.XML", "<ACTION ID=\"a_bw_combo_c_4_F2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_4_F2_Attk\"/>	<SLOT NAME=\"bw_combo_c_4_F2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_C_4_F2\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C_4_F3.XML", "<ACTION ID=\"a_bw_combo_c_4_F3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_4_F3_Attk\"/>	<SLOT NAME=\"bw_combo_c_4_F3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.7\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.7\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_C_4_F3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C_4_F4.XML", "<ACTION ID=\"a_bw_combo_c_4_F4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_4_F4_Attk\"/>	<SLOT NAME=\"bw_combo_c_4_F4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_C_4_F4\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_C_4_F5.XML", "<ACTION ID=\"a_bw_combo_c_4_F5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_c_4_F5_Attk\"/>	<SLOT NAME=\"bw_combo_c_4_F5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.9\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"4\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION =\"0.9\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_C_4_F5\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_D.XML", "<ACTION ID=\"a_bw_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_d_Attk\"/>	<SLOT NAME=\"bw_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"5.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"							EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo01_d\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_heart\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_DEG1_1=\"-10.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"10.833\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_E.XML", "<ACTION ID=\"a_bw_combo_e\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_e_Attk\"/>	<SLOT NAME=\"bw_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.0\"		CMA_MSG_QUAKE_CAMERA_FREQ = \"10\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_e\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"Bip01 L Hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo01_e\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_1_1.XML", "<ACTION ID=\"a_bw_combo_Z_1_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_1_1_Attk\"/>	<SLOT NAME=\"bw_combo_Z_1_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"			FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"	FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"	FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_EFFECT_TARGET_NODE=\"\"	HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo03_z_1_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_1_2.XML", "<ACTION ID=\"a_bw_combo_Z_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_1_2_Attk\"/>	<SLOT NAME=\"bw_combo_Z_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"			FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"	FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"	FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_EFFECT_TARGET_NODE=\"\"	HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo03_z_1_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_1_3.XML", "<ACTION ID=\"a_bw_combo_Z_1_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_1_3_Attk\"/>	<SLOT NAME=\"bw_combo_Z_1_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"			FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"	FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"	FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_EFFECT_TARGET_NODE=\"\"	HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo03_z_1_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_2_1.XML", "<ACTION ID=\"a_bw_combo_Z_2_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_2_1_Attk\"/>	<SLOT NAME=\"bw_combo_Z_2_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo04_z_2_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_bow_combo04_z_2_1_hand\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"p_wp_r_hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_2_2.XML", "<ACTION ID=\"a_bw_combo_Z_2_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_2_2_Attk\"/>	<SLOT NAME=\"bw_combo_Z_2_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo04_z_2_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_bow_combo04_z_2_2_hand\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"p_wp_r_hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_3_1.XML", "<ACTION ID=\"a_bw_combo_Z_3_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_3_1_Attk\"/>	<SLOT NAME=\"bw_combo_Z_3_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"55\"		MOVE_GOAL_POS_DIST_1=\"150\"		MOVE_COMPLETE_TIME_1=\"0.1667\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_3_1_2.XML", "<ACTION ID=\"a_bw_combo_Z_3_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_3_1_2_Attk\"/>	<SLOT NAME=\"bw_combo_Z_3_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"2\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo05_z_3_1_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_bow_combo05_z_3_1_2_dust\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_3_2.XML", "<ACTION ID=\"a_bw_combo_Z_3_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_3_2_Attk\"/>	<SLOT NAME=\"bw_combo_Z_3_2_Finish\"/>	<FSM SCRIPT=\"Skill_bw_combo_Z_3_2\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_HIT_MSG=\"1\"		EFFECT_TYPE_WHEN_HIT_MSG_1=\"7\"		EFFECT_ID_WHEN_HIT_MSG_1=\"eff_bow_combo05_z_3_2_bottom\"		EFFECT_TARGET_NODE_WHEN_HIT_MSG_1=\"char_root\"		EFFECT_DIST_WHEN_HIT_MSG_1=\"0\"		EFFECT_SCALE_WHEN_HIT_MSG_1=\"1\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo05_z_3_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_bow_combo05_z_3_2_finish\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT1_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/BW_COMBO_Z_4_1.XML", "<ACTION ID=\"a_bw_combo_Z_4_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"bw_combo_Z_4_1_Attk\"/>	<SLOT NAME=\"bw_combo_Z_4_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_BW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_bow_combo06_z_4_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/CALL_TRANS.XML", "<ACTION ID=\"a_call_trans\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Pet_Call_Trans\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/CALTRAP.XML", "<ACTION ID=\"a_Caltrap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shoot_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"Caltrap_start\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/CALTRAPSET.XML", "<ACTION ID=\"a_Caltrap Set\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault_Play\" TYPE=\"BOMB\"       HIT_SOUND_ID=\"Caltrap_EX\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/CAMOUFLAGE.XML", "<ACTION ID=\"a_Camouflage\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"Camouflage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/CARPETBOMBING.XML", "<ACTION ID=\"a_Carpet Bombing\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_CarpetBombing_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_CarpetBombing_01_02\"/>  <FSM SCRIPT=\"Skill_CarpetBombing\"       CASTING_SOUND_ID=\"CarpetBombing_start\"       HIT_SOUND_ID=\"CarpetBombing\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/CARPETBOMBING_PLAY.XML", "<ACTION ID=\"a_Carpet Bombing_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_CarpetBombing_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_A.XML", "<ACTION ID=\"a_cbw_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_a_Attk\"/>	<SLOT NAME=\"cbw_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"						EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_a\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_A_MULTISHOT.XML", "<ACTION ID=\"a_cbw_combo_a_Multishot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_a_Attk\"/>	<SLOT NAME=\"cbw_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"2\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_a\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_A_TWOACTION.XML", "<ACTION ID=\"a_cbw_combo_a_twoaction\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_a_Attk\"/>	<SLOT NAME=\"cbw_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_TWOACTION_ARROW\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_a\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_B.XML", "<ACTION ID=\"a_cbw_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_b_Attk\"/>	<SLOT NAME=\"cbw_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"								EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_b\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_B_MULTISHOT.XML", "<ACTION ID=\"a_cbw_combo_b_Multishot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_b_Attk\"/>	<SLOT NAME=\"cbw_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"2\"				FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_b\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_B_TWOACTION.XML", "<ACTION ID=\"a_cbw_combo_b_twoaction\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_b_Attk\"/>	<SLOT NAME=\"cbw_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_TWOACTION_ARROW\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_b\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C.XML", "<ACTION ID=\"a_cbw_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_Attk\"/>	<SLOT NAME=\"cbw_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"								EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_c\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_4_C.XML", "<ACTION ID=\"a_cbw_combo_c_4_C\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_4_C_Start\"/>	<SLOT NAME=\"cbw_combo_c_4_C_btlidle\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_COMBO_CHARGE=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.1\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"0.2\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo02_charge00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"						EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_cbw_combo02_charge01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"TRUE\"				CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.85\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_1=\"0.63\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_2=\"0.38\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_3=\"0.25\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_4=\"0.05\"				SAVE_CAMERA_POS=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_4_F1.XML", "<ACTION ID=\"a_cbw_combo_c_4_F1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_4_F1_Attk\"/>	<SLOT NAME=\"cbw_combo_c_4_F1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 	USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_C_4_F1\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_4_F2.XML", "<ACTION ID=\"a_cbw_combo_c_4_F2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_4_F2_Attk\"/>	<SLOT NAME=\"cbw_combo_c_4_F2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_C_4_F2\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_EFFECT_MSG1=\"0\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_4_F3.XML", "<ACTION ID=\"a_cbw_combo_c_4_F3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_4_F3_Attk\"/>	<SLOT NAME=\"cbw_combo_c_4_F3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 	USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.7\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.7\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"								FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_C_4_F3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_4_F4.XML", "<ACTION ID=\"a_cbw_combo_c_4_F4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_4_F4_Attk\"/>	<SLOT NAME=\"cbw_combo_c_4_F4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 	USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_C_4_F4\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_4_F5.XML", "<ACTION ID=\"a_cbw_combo_c_4_F5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_4_F5_Attk\"/>	<SLOT NAME=\"cbw_combo_c_4_F5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 	USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.9\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"4\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION =\"0.9\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_C_4_F5\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo02_d5\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_MULTISHOT.XML", "<ACTION ID=\"a_cbw_combo_c_Multishot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_Attk\"/>	<SLOT NAME=\"cbw_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"2\"				FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_c\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_C_TWOACTION.XML", "<ACTION ID=\"a_cbw_combo_c_twoaction\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_c_Attk\"/>	<SLOT NAME=\"cbw_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_TWOACTION_ARROW\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"									HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_c\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_D.XML", "<ACTION ID=\"a_cbw_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_d_Attk\"/>	<SLOT NAME=\"cbw_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_DEG1_1=\"-10.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"10.833\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_d\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_D_MULTISHOT.XML", "<ACTION ID=\"a_cbw_combo_d_Multishot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_d_Attk\"/>	<SLOT NAME=\"cbw_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_DEG1_1=\"-10.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"10.833\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_d\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_D_TWOACTION.XML", "<ACTION ID=\"a_cbw_combo_d_twoaction\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_d_Attk\"/>	<SLOT NAME=\"cbw_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_TWOACTION_ARROW\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_DEG1_1=\"-10.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"10.833\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"					EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_d\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_E.XML", "<ACTION ID=\"a_cbw_combo_e\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_e_Attk\"/>	<SLOT NAME=\"cbw_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"			TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.0\"		CMA_MSG_QUAKE_CAMERA_FREQ = \"10\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_e\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_e\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_E_MULTISHOT.XML", "<ACTION ID=\"a_cbw_combo_e_Multishot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_e_Attk\"/>	<SLOT NAME=\"cbw_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"			TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.0\"		CMA_MSG_QUAKE_CAMERA_FREQ = \"10\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_e\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"2\"				FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_e\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_E_TWOACTION.XML", "<ACTION ID=\"a_cbw_combo_e_twoaction\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_e_Attk\"/>	<SLOT NAME=\"cbw_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"			TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.0\"		CMA_MSG_QUAKE_CAMERA_FREQ = \"10\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_TWOACTION_ARROW\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"									HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo01_e\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_1_1.XML", "<ACTION ID=\"a_cbw_combo_Z_1_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_1_1_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_1_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo03_z_1_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_1_2.XML", "<ACTION ID=\"a_cbw_combo_Z_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_1_2_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo03_z_1_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_1_3.XML", "<ACTION ID=\"a_cbw_combo_Z_1_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_1_3_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_1_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"					FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo03_z_1_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_2_1.XML", "<ACTION ID=\"a_cbw_combo_Z_2_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_2_1_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_2_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"					FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo04_z_2_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_2_2.XML", "<ACTION ID=\"a_cbw_combo_Z_2_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_2_2_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_2_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo04_z_2_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_cbw_combo04_z_2_2_hand\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"p_wp_l_hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_3_1.XML", "<ACTION ID=\"a_cbw_combo_Z_3_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_3_1_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_3_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"			MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"55\"		MOVE_GOAL_POS_DIST_1=\"150\"		MOVE_COMPLETE_TIME_1=\"0.1667\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_3_1_2.XML", "<ACTION ID=\"a_cbw_combo_Z_3_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_3_1_2_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_3_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"2\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"				HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo05_z_3_1_2\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo05_z_3_1_2_dust\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_3_2.XML", "<ACTION ID=\"a_cbw_combo_Z_3_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_3_2_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_3_2_Finish\"/>	<FSM SCRIPT=\"Skill_bw_combo_Z_3_2\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_HIT_MSG=\"1\"		EFFECT_TYPE_WHEN_HIT_MSG_1=\"7\"		EFFECT_ID_WHEN_HIT_MSG_1=\"eff_cbw_combo05_z_3_2_bottom\"		EFFECT_TARGET_NODE_WHEN_HIT_MSG_1=\"char_root\"		EFFECT_DIST_WHEN_HIT_MSG_1=\"0\"		EFFECT_SCALE_WHEN_HIT_MSG_1=\"1\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_cbw_combo05_z_3_2\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"ef_enchant_01\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo05_z_3_2_dust\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DAMAGE_HOLD =\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CBW_COMBO_Z_4_1.XML", "<ACTION ID=\"a_cbw_combo_Z_4_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cbw_combo_Z_4_1_Attk\"/>	<SLOT NAME=\"cbw_combo_Z_4_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_CBW_COMBO_DEFAULT\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_wp_l_hand\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					HIT_TARGET_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_cbw_combo06_z_4_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/CHAINCRASH.XML", "<ACTION ID=\"a_Chain Crash\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_ChainCrash_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        MULTI_HIT_NUM=\"3\"       FIRE_CASTER_EFFECT_TARGET_NODE =\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Com_skill_ChainCrash_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"ChainCrash\"             /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/CHAINHURRICANEKICK.XML", "<ACTION ID=\"a_Chain Hurricane Kick\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Com_skill_Chain_Hurricane_Kick_01\"/>  <FSM SCRIPT=\"Skill_ChainHurricaneKick\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/CHAINLIGHTNING.XML", "<ACTION ID=\"a_Chain Lightning\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_skill_ChainLightning_01\"/>  <SLOT NAME=\"Com_skill_ChainLightning_02\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_ChainLightning\"       HIT_SOUND_ID=\"ChainLightning\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/CHAINSHIELD.XML", "<ACTION ID=\"a_chainshield\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Fig_Onehand_skill_Chain_Shield_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" 	FIRE_SOUND_ID=\"chain_shield01\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/CHAINSHIELD_PLAY.XML", "<ACTION ID=\"a_chainshield_play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"opening\"/>  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Spark_Rock_Play\"  		INSTALL_EFFECT_TARGET_NODE=\"\"		INSTALL_EFFECT_ID=\"\"		FIRE_CASTER_SCALE_NORMALIZE=\"\"		HIT_TIMER_TIME=\"\"		HIT_TIMER_TICK=\"0.3\"				FOLLOW_PLAYER_DIRECTION=\"FALSE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/CHANGENINJA.XML", "<ACTION ID=\"a_Change Ninja\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\" CASTING_SOUND_ID=\"Ninja_Poof\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/CHANGEDANCER.XML", "<ACTION ID=\"a_Change_Dancer\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\" CASTING_SOUND_ID=\"Ninja_Poof\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/CHARGE.XML", "<ACTION ID=\"a_charge\" NEXT=\"a_idle\" LOOP=\"TRUE\">	<SLOT NAME=\"charge\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Charge\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/CLASS_PROMOTION_DRAGONIAN.XML", "<ACTION ID=\"a_class_promotion_dragonian\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"class_promotion\"/>  	<FSM SCRIPT=\"ClassPromotion\" 		USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				HIDE_WEAPON_WHEN_ANI_SLOT1=\"TRUE\"		FIRE_SOUND_ID=\"classpromotion\"		SEE_FRONT=\"1\"				DECO_ACTOR_TYPE=\"10001\"		DECO_ACTOR_CLASS_NO=\"100011\"		DECO_ACTOR_ACTIONTIME=\"5\"		DECO_ACTOR_ACTION_NAME=\"a_sa_class_promotion_act_dragonian\"		DECO_ACTOR_WHEN_START_DIRECTION=\"CALLER\"				DECO_ACTOR_POS_DIST_DIR_ROTATE_HORIZ_DEG=\"0\"		DECO_ACTOR_POS_DIST_DIR_ROTATE_VERT_DEG=\"0\"		DECO_ACTOR_DIST=\"0\"				WFF_COLOR_ALPHA_ACTION_TIME=\"5\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.001\"		WFF_COLOR_ALPHA_COLOR=\"0\"		WFF_COLOR_ALPHA_START=\"0\"		WFF_COLOR_ALPHA_END=\"1\"		WFF_COLOR_ALPHA_KEEP=\"2\"				DRAW_ACTOR_FILTER_USE=\"1\"		DRAW_ACTOR_FILTER_CLEAR=\"1\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_com_class_promotion_dragon01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"				UI_CONTROL_TYPE_WHEN_UI_MSG1=\"1\"				UI_CONTROL_TYPE_WHEN_UI_MSG2=\"3\"		UI_CONTROL_CALL_ID_WHEN_UI_MSG2=\"FRM_CLASS_PROMOTION\"				UI_CONTROL_TYPE_WHEN_UI_MSG3=\"2\"				HIDE_NAME_TITLE=\"1\"		HIDE_SUB_ACTOR=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/CLASS_PROMOTION_HUMAN.XML", "<ACTION ID=\"a_class_promotion_human\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"class_promotion\"/>  	<FSM SCRIPT=\"ClassPromotion\" 		USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				HIDE_WEAPON_WHEN_ANI_SLOT1=\"TRUE\"		FIRE_SOUND_ID=\"classpromotion\"		SEE_FRONT=\"1\"				DECO_ACTOR_TYPE=\"10001\"		DECO_ACTOR_CLASS_NO=\"100011\"		DECO_ACTOR_ACTIONTIME=\"5\"		DECO_ACTOR_ACTION_NAME=\"a_sa_class_promotion_act_human\"		DECO_ACTOR_WHEN_START_DIRECTION=\"CALLER\"				DECO_ACTOR_POS_DIST_DIR_ROTATE_HORIZ_DEG=\"0\"		DECO_ACTOR_POS_DIST_DIR_ROTATE_VERT_DEG=\"0\"		DECO_ACTOR_DIST=\"0\"				WFF_COLOR_ALPHA_ACTION_TIME=\"5\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.001\"		WFF_COLOR_ALPHA_COLOR=\"0\"		WFF_COLOR_ALPHA_START=\"0\"		WFF_COLOR_ALPHA_END=\"1\"		WFF_COLOR_ALPHA_KEEP=\"2\"				DRAW_ACTOR_FILTER_USE=\"1\"		DRAW_ACTOR_FILTER_CLEAR=\"1\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_com_class_promotion_human01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"				UI_CONTROL_TYPE_WHEN_UI_MSG1=\"1\"				UI_CONTROL_TYPE_WHEN_UI_MSG2=\"3\"		UI_CONTROL_CALL_ID_WHEN_UI_MSG2=\"FRM_CLASS_PROMOTION\"				UI_CONTROL_TYPE_WHEN_UI_MSG3=\"2\"				HIDE_NAME_TITLE=\"1\"		HIDE_SUB_ACTOR=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/CLAWFISHING.XML", "<ACTION ID=\"a_Claw Fishing\" NEXT=\"a_Claw Fishing_Finish\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Claw_skill_ClowFishing_01_01\" />  <SLOT NAME=\"Claw_skill_ClowFishing_01_02\" />  <SLOT NAME=\"Claw_skill_ClowFishing_01_03\" />  <FSM SCRIPT=\"Skill_DeathSnatch\" FLY_ANGLE=\"0\" HAND_CLASS_NO=\"900017\" HIDE_HAND_CREATION_ANIMATION=\"TRUE\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_wire_action_02_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/CLAWFISHINGFINISH.XML", "<ACTION ID=\"a_Claw Fishing_Finish\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"battle_idle\" />  <FSM SCRIPT=\"Skill_DeathSnatchFinish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/CLAYMORE.XML", "<ACTION ID=\"a_Claymore\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"Claymore\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/CLAYMORE_EXPLOSION.XML", "<ACTION ID=\"a_Claymore_Explosion\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Claymore_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/CLOUDKILL.XML", "<ACTION ID=\"a_Cloud Kill\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_CloudKill_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"CloudKill01\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/CLOUDKILL_PLAY.XML", "<ACTION ID=\"a_Cloud Kill Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_BackDraft_Fire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/CLOWN_SLIDINGTACKLE.XML", "<ACTION ID=\"a_clown_sliding_tackle\" NEXT=\"a_battle_idle\">  <SLOT NAME=\"Claw_dash_sliding_01\"/>  <SLOT NAME=\"Claw_dash_sliding_02\"/>  <FSM SCRIPT=\"Skill_Sliding_Tackle\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/CLUBMANIA.XML", "<ACTION ID=\"a_Club_Mania\" NEXT=\"a_Club_Mania2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Claw_Skill_ClubMania_01\" />  <FSM SCRIPT=\"Skill_Club_Mania\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_hell_shouting_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_SOUND_ID=\"\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       HIT_TIMER_TIME=\"2.5\"       HIT_TIMER_TICK=\"0.3\"       SUMMON_CLASSNO=\"900107\"       SUMMON_RESERVE_ACTION=\"a_Demolition_Bomber_idle\"	   	   CASTING_SOUND_ID_MALE=\"Male_ClubMania\"	   CASTING_SOUND_ID_FEMALE=\"Female_ClubMania\"	   MULTIPLE_ATTACK=\"TRUE\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/CLUBMANIAFINISH.XML", "<ACTION ID=\"a_Club_Mania2\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\"  ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Claw_Skill_ClubMania_02\" />  <FSM SCRIPT=\"Skill_Club_Mania_Finish\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"       CHECK_CAN_PREV_ACTION_ID=\"a_Club_Mania\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A.XML", "<ACTION ID=\"a_cl_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_Attk\"/>	<SLOT NAME=\"cl_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_a\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_2.XML", "<ACTION ID=\"a_cl_combo_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_2_Attk\"/>	<SLOT NAME=\"cl_combo_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_3.XML", "<ACTION ID=\"a_cl_combo_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_3_Attk\"/>	<SLOT NAME=\"cl_combo_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_4.XML", "<ACTION ID=\"a_cl_combo_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_4_Attk\"/>	<SLOT NAME=\"cl_combo_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_5.XML", "<ACTION ID=\"a_cl_combo_a_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_5_Attk\"/>	<SLOT NAME=\"cl_combo_a_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_5_6.XML", "<ACTION ID=\"a_cl_combo_a_5_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_5_6_Attk\"/>	<SLOT NAME=\"cl_combo_a_5_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAEMRA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_06_a_5_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_6.XML", "<ACTION ID=\"a_cl_combo_a_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_6_Attk\"/>	<SLOT NAME=\"cl_combo_a_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_A_7.XML", "<ACTION ID=\"a_cl_combo_a_7\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_a_7_Attk\"/>	<SLOT NAME=\"cl_combo_a_7_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAEMRA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_7\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_B.XML", "<ACTION ID=\"a_cl_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_b_Attk\"/>	<SLOT NAME=\"cl_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_b\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_B_3.XML", "<ACTION ID=\"a_cl_combo_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_b_3_Attk\"/>	<SLOT NAME=\"cl_combo_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				CAM_MSG_QUAKE_CAMERA_DUTATION = \"0.2\"		CAM_MSG_QUAKE_CAMERA_FACTOR =\"1\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_B_4.XML", "<ACTION ID=\"a_cl_combo_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_b_4_Attk\"/>	<SLOT NAME=\"cl_combo_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_B_5.XML", "<ACTION ID=\"a_cl_combo_b_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_b_5_Attk\"/>	<SLOT NAME=\"cl_combo_b_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ =\"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_B_6.XML", "<ACTION ID=\"a_cl_combo_b_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_b_6_Attk\"/>	<SLOT NAME=\"cl_combo_b_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_B_7.XML", "<ACTION ID=\"a_cl_combo_b_7\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_b_7_Attk\"/>	<SLOT NAME=\"cl_combo_b_7_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_7\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_C.XML", "<ACTION ID=\"a_cl_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_c_Attk\"/>	<SLOT NAME=\"cl_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_c\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_C_4.XML", "<ACTION ID=\"a_cl_combo_c_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_c_4_Attk\"/>	<SLOT NAME=\"cl_combo_c_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_03_c_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_C_5.XML", "<ACTION ID=\"a_cl_combo_c_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_c_5_Attk\"/>	<SLOT NAME=\"cl_combo_c_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_03_c_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_C_6.XML", "<ACTION ID=\"a_cl_combo_c_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_c_6_Attk\"/>	<SLOT NAME=\"cl_combo_c_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"			CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_03_c_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_D.XML", "<ACTION ID=\"a_cl_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_d_Attk\"/>	<SLOT NAME=\"cl_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_d\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_D_5.XML", "<ACTION ID=\"a_cl_combo_d_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_d_5_Attk\"/>	<SLOT NAME=\"cl_combo_d_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_02_d_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_D_6.XML", "<ACTION ID=\"a_cl_combo_d_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_d_6_Attk\"/>	<SLOT NAME=\"cl_combo_d_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_02_d_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CL_COMBO_E.XML", "<ACTION ID=\"a_cl_combo_e\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cl_combo_e_Attk\"/>	<SLOT NAME=\"cl_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_e\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/CMDBROADCAST.XML", "<ACTION ID=\"a_cmd_broadcast\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">    <FSM SCRIPT=\"Cmd_BroadCast\"/>	   </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/COKESCREWUPPER.XML", "<ACTION ID=\"a_Coke Screw Upper\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Claw_Skill_Raid_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIND_TARGET_TYPE =\"BAR\"        HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"        HIT_CASTER_EFFECT_ID=\"ef_Cokescrewupper_01_char_root\"        /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/COMBAT_REVIVE_ACT.XML", "<ACTION ID=\"a_combat_revive\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"combat_revive_act\"/>	<FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_CONCENTRATION.XML", "<ACTION ID=\"a_Concentration\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_05\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"Concentration\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CONDOR_ATTACK.XML", "<ACTION ID=\"a_Condor Attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"com_skill_buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"CondorAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/COUPLE_LOVER.XML", "<ACTION ID=\"a_Couple_Lover\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_Guild_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Guild_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIND_TARGET_TYPE=\"SPHERE\"       NO_DEFAULT_HIT_EFFECT =\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/CRINGE.XML", "<ACTION ID=\"a_cringe\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\">	<SLOT NAME=\"cringe_01\"/>	<FSM SCRIPT=\"Act_Cringe\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/CROSSCUT.XML", "<ACTION ID=\"a_Cross Cut\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_Skill_CrossCut_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        MULTI_HIT_NUM =\"2\"       FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Crosscut_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"p_wp_r_hand\"       FIRE_CASTER_EFFECT_ID2=\"ef_Crosscut_01_p_wp_r_hand\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH=\"TRUE\"       NO_WEAPON_TRAIL =\"TRUE\"       HIT_SOUND_ID=\"CrossCut\"       APPLY_EFFECT_ONLY_LAST_HIT=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/A_CROSSBLADE.XML", "<ACTION ID=\"a_crossblade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Kattar_skill_ProtectEdge_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Kattar_skill_CrossBlade_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"   	CASTING_EFFECT_EFFECT_ID =\"ef_skill_cross_blade_02_char_root\" 	CASTING_EFFECT_TARGET_NODE =\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH = \"TRUE\"		    FIRE_CASTER_EFFECT_ID=\"ef_skill_cross_blade_01_char_root\"    FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"    DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   		HIT_SOUND_ID=\"CrossBlade\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/A_CROSSBLADE_PLAY.XML", "<ACTION ID=\"a_crossblade_play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"melee_01\"/>  <SLOT NAME=\"melee_02\"/>  <SLOT NAME=\"melee_03\"/>  <!--SLOT NAME=\"attk_down_01\"/>    <SLOT NAME=\"melee_blow_up\"/-->  <SLOT NAME=\"attk_down_03\"/>  <SLOT NAME=\"dash_attk_01\"/>  <SLOT NAME=\"Com_spell_01\"/>  <FSM SCRIPT=\"Skill_CrossBlade_Play\"  	HIT_SOUND_ID=\"\"		CASTING_EFFECT_EFFECT_ID =\"ef_smog_03_char_root\" 	CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS = \"char_root\"	DETACH_CASTING_EFFECT_AT_FINISH = \"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/CRUXSHOT.XML", "<ACTION ID=\"a_Crux Shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Cruxshot_01_char_root\"        HIT_SOUND_ID=\"CruxShot\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/CRY.XML", "<ACTION ID=\"a_cry\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_cry\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/CURE.XML", "<ACTION ID=\"a_Cure\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Cure_01_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_Cure_02_char_root\"       HIT_SOUND_ID=\"Cure\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/CUSHION_SHOT.XML", "<ACTION ID=\"a_Cushion Shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP = \"TRUE\"/>  	<SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_Cushion\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"PROJECTILE_CUSHION_SHOT_ARROW\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A.XML", "<ACTION ID=\"a_cu_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_Attk\"/>	<SLOT NAME=\"cu_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_a\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_2.XML", "<ACTION ID=\"a_cu_combo_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_2_Attk\"/>	<SLOT NAME=\"cu_combo_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_3.XML", "<ACTION ID=\"a_cu_combo_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_3_Attk\"/>	<SLOT NAME=\"cu_combo_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_4.XML", "<ACTION ID=\"a_cu_combo_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_4_Attk\"/>	<SLOT NAME=\"cu_combo_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_5.XML", "<ACTION ID=\"a_cu_combo_a_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_5_Attk\"/>	<SLOT NAME=\"cu_combo_a_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_5_6.XML", "<ACTION ID=\"a_cu_combo_a_5_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_5_6_Attk\"/>	<SLOT NAME=\"cu_combo_a_5_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAEMRA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_06_a_5_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_6.XML", "<ACTION ID=\"a_cu_combo_a_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_6_Attk\"/>	<SLOT NAME=\"cu_combo_a_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_A_7.XML", "<ACTION ID=\"a_cu_combo_a_7\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_a_7_Attk\"/>	<SLOT NAME=\"cu_combo_a_7_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAEMRA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_05_a_7\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_B.XML", "<ACTION ID=\"a_cu_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_b_Attk\"/>	<SLOT NAME=\"cu_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_b\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_B_3.XML", "<ACTION ID=\"a_cu_combo_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_b_3_Attk\"/>	<SLOT NAME=\"cu_combo_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				CAM_MSG_QUAKE_CAMERA_DUTATION = \"0.2\"		CAM_MSG_QUAKE_CAMERA_FACTOR =\"1\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_B_4.XML", "<ACTION ID=\"a_cu_combo_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_b_4_Attk\"/>	<SLOT NAME=\"cu_combo_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_B_5.XML", "<ACTION ID=\"a_cu_combo_b_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_b_5_Attk\"/>	<SLOT NAME=\"cu_combo_b_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ =\"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_B_6.XML", "<ACTION ID=\"a_cu_combo_b_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_b_6_Attk\"/>	<SLOT NAME=\"cu_combo_b_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_B_7.XML", "<ACTION ID=\"a_cu_combo_b_7\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_b_7_Attk\"/>	<SLOT NAME=\"cu_combo_b_7_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_04_b_7\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_C.XML", "<ACTION ID=\"a_cu_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_c_Attk\"/>	<SLOT NAME=\"cu_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_c\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_C_4.XML", "<ACTION ID=\"a_cu_combo_c_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_c_4_Attk\"/>	<SLOT NAME=\"cu_combo_c_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_03_c_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_C_5.XML", "<ACTION ID=\"a_cu_combo_c_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_c_5_Attk\"/>	<SLOT NAME=\"cu_combo_c_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_03_c_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_C_6.XML", "<ACTION ID=\"a_cu_combo_c_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_c_6_Attk\"/>	<SLOT NAME=\"cu_combo_c_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"			CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_03_c_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_D.XML", "<ACTION ID=\"a_cu_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_d_Attk\"/>	<SLOT NAME=\"cu_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_d\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_D_5.XML", "<ACTION ID=\"a_cu_combo_d_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_d_5_Attk\"/>	<SLOT NAME=\"cu_combo_d_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_02_d_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_D_6.XML", "<ACTION ID=\"a_cu_combo_d_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_d_6_Attk\"/>	<SLOT NAME=\"cu_combo_d_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_02_d_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CU_COMBO_E.XML", "<ACTION ID=\"a_cu_combo_e\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"cu_combo_e_Attk\"/>	<SLOT NAME=\"cu_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_claw_combo_01_e\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/DAEPODONG.XML", "<ACTION ID=\"a_Daepodong\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<!--	<SLOT NAME=\"attk_charge_02\" LOOP=\"TRUE\"/> -->  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>	<FSM SCRIPT=\"Skill_Daepodong\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\" ATTACH_NODE=\"p_wp_r_hand\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"Projectile_Daepodong\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"e_skill_reverse_gravity_mon_fallen\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/DANCE01.XML", "<ACTION ID=\"a_dance_01\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_dance_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/DANCE02.XML", "<ACTION ID=\"a_dance_02\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_dance_02\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/DANCE03.XML", "<ACTION ID=\"a_dance_03\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_dance_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DARK_CLOUD_A.XML", "<ACTION ID=\"a_dark_cloud_a\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       FIRE_SOUND_ID=\"skill-dark_cloudt\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DARK_CLOUD_B.XML", "<ACTION ID=\"a_dark_cloud_b\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       FIRE_SOUND_ID=\"skill-dark_cloudt\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DARK_CLOUD_C.XML", "<ACTION ID=\"a_dark_cloud_c\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       FIRE_SOUND_ID=\"skill-dark_cloudt\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DARK_CLOUD_PLAY_A.XML", "<ACTION ID=\"a_dark_cloud_play_a\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Pet_CloudFire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DARK_CLOUD_PLAY_B.XML", "<ACTION ID=\"a_dark_cloud_play_b\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Pet_CloudFire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DARK_CLOUD_PLAY_C.XML", "<ACTION ID=\"a_dark_cloud_play_c\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Pet_CloudFire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DASH.XML", "<ACTION ID=\"a_dash\" NEXT=\"a_idle\" LOOP=\"TRUE\" USE_CFUNC=\"TRUE\" TYPE=\"MOVE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_FOLLOW=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"dash\"/>	<FSM SCRIPT=\"Act_Dash\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/DASH_BITE.XML", "<ACTION ID=\"a_dash_after_attk\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"dash_after_attk_btlidle_01_start\"/>   	<SLOT NAME=\"dash_after_attk_rush\"/>   	<SLOT NAME=\"dash_after_attk_01_02\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"			USE_SAVE_PRE_TARGET_LIST=\"TRUE\"			PRE_FIND_TARGET_TYPE=\"0\"	PRE_FIND_TARGET_RANGE=\"140\"	PRE_FIND_TARGET_AREA_PARAM2=\"0\"		WHEN_START_DIRECTION=\"SAVED_TARGET\"	WHEN_MOVE_DIRECTION_1=\"SAVED_TARGET\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"-30\"		MOVE_COMPLETE_TIME_1=\"0.1\"	MOVE_DIR_UPDATE_1=\"TRUE\"		MOVE_SPEED_1=\"0\"	MOVE_GOAL_POS_UPDATE_1=\"FALSE\"		MOVE_STOP_OPTION_1=\"\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/DASHATTACK.XML", "<ACTION ID=\"a_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"dash_attk_01\"/>	<FSM SCRIPT=\"Skill_Dash_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/DASHBLOWUP.XML", "<ACTION ID=\"a_dash_blowup\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Twohand_dash_attk_fly_01\"/>	<FSM SCRIPT=\"Skill_Dash_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DASH_JUMP.XML", "<ACTION ID=\"a_dash_jump\" NEXT=\"a_idle\" TYPE=\"MOVE\" USE_CFUNC=\"TRUE\" LOOP=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CAN_FOLLOW=\"TRUE\" MONITOR=\"TRUE\">	<SLOT NAME=\"dash_jump_01\"/>	<SLOT NAME=\"dash_jump_idle\"/>	<SLOT NAME=\"dash_jump_02\"/>  <FSM SCRIPT=\"Act_Dash_Jump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DASH_KOONA.XML", "<ACTION ID=\"a_dash_koona\" NEXT=\"a_idle\" LOOP=\"TRUE\" USE_CFUNC=\"TRUE\" TYPE=\"MOVE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_FOLLOW=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"carry_dash\"/>	<FSM SCRIPT=\"Act_Dash_Bear\"		BAN_USER_INPUT_SC_SKILL=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_DOWNATTACK_01.XML", "<ACTION ID=\"a_dc_down_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" >	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_DOWNATTACK_02.XML", "<ACTION ID=\"a_dc_down_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" >	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_MELEE_01.XML", "<ACTION ID=\"a_dc_melee_01\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_MELEE_02.XML", "<ACTION ID=\"a_dc_melee_02\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_02\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_MELEE_03.XML", "<ACTION ID=\"a_dc_melee_03\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_03\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_MELEE_04.XML", "<ACTION ID=\"a_dc_melee_04\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_04\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_MELEE_05.XML", "<ACTION ID=\"a_dc_melee_05\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_05\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/DC_MELEE_DROP.XML", "<ACTION ID=\"a_dc_melee_drop_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"jump_down_attk\"/>  <SLOT NAME=\"jump_down_attk_up\"/>  <FSM SCRIPT=\"Skill_Melee_Drop\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEATHBOUND.XML", "<ACTION ID=\"a_Death Bound\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Twohand_skill_DeathBound_01\" />  <FSM SCRIPT=\"EarthQuake\"       DEATH_BOUND=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSNATCH.XML", "<ACTION ID=\"a_Death Snatch\" NEXT=\"a_Death Snatch_Finish\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Twohand_skill_DeathSnatch_01_01\" />  <SLOT NAME=\"Twohand_skill_DeathSnatch_01_02\" />  <SLOT NAME=\"Twohand_skill_DeathSnatch_01_03\" />  <FSM SCRIPT=\"Skill_DeathSnatch\" FLY_ANGLE=\"45\" HAND_CLASS_NO=\"900016\" HIDE_WEAPON=\"TRUE\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_death_snatch_02_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSNATCHFINISH.XML", "<ACTION ID=\"a_Death Snatch_Finish\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"battle_idle\" />  <FSM SCRIPT=\"Skill_DeathSnatchFinish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSNATCHHANDMOVE.XML", "<ACTION ID=\"a_Death Snatch_Hand_Move\" NEXT=\"a_idle\" USE-EVENT=\"FALSE\" CHECK_CAN_ENTER=\"FALSE\">  <SLOT NAME=\"skill_01\" />  <SLOT NAME=\"skill_02\" />  <SLOT NAME=\"skill_03\" />  <FSM SCRIPT=\"Skill_DeathSnatchHandMove\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSTINGER.XML", "<ACTION ID=\"a_DeathStinger\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Twohand_skill_DeathStinger_01\"/>	<SLOT NAME=\"Twohand_skill_DeathStinger_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Twohand_skill_DeathStinger_03\"/>	<FSM SCRIPT=\"Skill_DeathStinger\" FIRE_SOUND_ID=\"DeathStinger_Attk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEATHSTINGERSA.XML", "<ACTION ID=\"a_DeathStingerSA\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"Death_StingerSA_01\"/>	<SLOT NAME=\"Death_StingerSA_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Death_StingerSA_03\"/>	<FSM SCRIPT=\"Skill_DeathStingerSA\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/DEBUFF_ADD.XML", "<ACTION ID=\"a_debuff_add\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/DEFENCE_DEC.XML", "<ACTION ID=\"a_defence_dec\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/DEFENCE_TOTEM.XML", "<ACTION ID=\"a_defence_totem\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_down_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"Sanctuary\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DEFENSIVEAURA.XML", "<ACTION ID=\"a_Defensive Aura\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_shot_04\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Offecsiveaura_01_char_root\"       HIT_SOUND_ID=\"OffenciveAura\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGE.XML", "<ACTION ID=\"a_DemolitionCharge\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Twohand_skill_DemolitionCharge_01\"/>	<SLOT NAME=\"Twohand_skill_DemolitionCharge_02\"/>	<SLOT NAME=\"Twohand_skill_DemolitionCharge_03\"/>	<SLOT NAME=\"Twohand_skill_DemolitionCharge_04\"/>	<FSM SCRIPT=\"Skill_DemolitionCharge\" FIRE_SOUND_ID=\"DemolitionCharge_06\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGE1.XML", "<ACTION ID=\"a_DemolitionCharge1\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Twohand_skill_DemolitionCharge_04\"/>	<FSM SCRIPT=\"Skill_DemolitionCharge1\" FIRE_SOUND_ID=\"DemolitionCharge_06\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGE2.XML", "<ACTION ID=\"a_DemolitionCharge2\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Twohand_skill_DemolitionCharge_04\"/>	<FSM SCRIPT=\"Skill_DemolitionCharge1\" FIRE_SOUND_ID=\"DemolitionCharge_06\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONCHARGESA.XML", "<ACTION ID=\"a_DemolitionChargeSA\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >	<SLOT NAME=\"Twohand_skill_DemolitionCharge_01\"/>	<SLOT NAME=\"Twohand_skill_DemolitionCharge_02\"/>	<SLOT NAME=\"Twohand_skill_DemolitionCharge_03\"/>	<SLOT NAME=\"Twohand_skill_DemolitionCharge_04\"/>	<FSM SCRIPT=\"Skill_DemolitionChargeSA\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/DEMOLITIONBOMBER_IDLE.XML", "<ACTION ID=\"a_Demolition_Bomber_idle\" NEXT=\"a_Demolition_Bomber_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"melee_01\"/>	<FSM SCRIPT=\"Skill_Demolition_Bomber_Idle\"       HIT_CASTER_EFFECT_ID=\"ef_skill_Demolition_Bomber_03_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_DETECTION.XML", "<ACTION ID=\"a_Detection\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_CASTER_EFFECT_ID=\"ef_skill_discovery\" HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"		HIT_CASTER_EFFECT_TARGET_NODE2=\"char_root\"		HIT_CASTER_EFFECT_ID2=\"eff_pc_detection00\"		HIT_CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR2=\"10\"	          HIT_SOUND_ID=\"Detection\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/DETONATOR.XML", "<ACTION ID=\"a_Detonator\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Skill_Detonator\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DEXTERITY.XML", "<ACTION ID=\"a_Dexterity\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_CASTER_EFFECT_ID=\"ef_Mask_Dexterity_01_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_Mask_Dexterity_02_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       HIT_SOUND_ID=\"Dexterity\"       FIND_TARGET_TYPE=\"SPHERE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE.XML", "<ACTION ID=\"a_die\" TYPE=\"EFFECT\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\" >  <SLOT NAME=\"die_01\"/>  <SLOT NAME=\"die_idle_01\"/>  <FSM SCRIPT=\"Act_Die\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE2.XML", "<ACTION ID=\"a_die2\" TYPE=\"EFFECT\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"die_01\"/>  <SLOT NAME=\"die_idle_01\"/>  <FSM SCRIPT=\"Act_Die2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE_BLOWUP.XML", "<ACTION ID=\"a_die_blowup\" TYPE=\"EFFECT\" >  <SLOT NAME=\"Die_BlowUp_Start\" />  <SLOT NAME=\"Die_BlowUp_Start_To_Loop\" />  <SLOT NAME=\"Die_BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Die_BlowUp_Down\"/>  <SLOT NAME=\"die_blending_01\"/>  <SLOT NAME=\"die_01\"/>  <FSM SCRIPT=\"Act_Die_BlowUp\" VELOCITY=\"150\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE_BLOWUP2.XML", "<ACTION ID=\"a_die_blowup2\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" >	<SLOT NAME=\"Die_BlowUp_Start\" />	<SLOT NAME=\"Die_BlowUp_Start_To_Loop\" />	<SLOT NAME=\"Die_BlowUp_Loop\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Die_BlowUp_Down\"/>	<SLOT NAME=\"die_01\"/>	<SLOT NAME=\"die_01_loop\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Die_BlowUp\" VELOCITY=\"150\" TYPE=\"CHANGE_KFM\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE_BLOWUP3.XML", "<ACTION ID=\"a_die_blowup3\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Die_BlowUp_Start\" />  <SLOT NAME=\"Die_BlowUp_Start_To_Loop\" />  <SLOT NAME=\"Die_BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Die_BlowUp_Down\"/>  <SLOT NAME=\"die_blending_01\"/>  <SLOT NAME=\"die_01\"/>  <FSM SCRIPT=\"Act_Die_BlowUp\" VELOCITY=\"150\" TYPE=\"CHANGE_KFM2\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/DIE_HARD.XML", "</ACTION><ACTION ID=\"a_die_hard\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE_SLOWMOTION.XML", "<ACTION ID=\"a_die_slowmotion\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"die_01\"/>	<SLOT NAME=\"die_idle_01\"/>	<FSM SCRIPT=\"Act_Die_SlowMotion\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DIE_SLOWMOTION2.XML", "<ACTION ID=\"a_die_slowmotion_change\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"die_01\"/>	<SLOT NAME=\"die_idle_01\"/>	<FSM SCRIPT=\"Act_Die_SlowMotion\" TYPE=\"CHANGE_KFM\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/DISEASE.XML", "<ACTION ID=\"a_Disease\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_07\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Disease_attk_02_char_root\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_Disease_attk_03_char_root\"       HIT_SOUND_ID=\"Disease\"       FIND_TARGET_TYPE=\"SPHERE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/DISPLACEMENT.XML", "<ACTION ID=\"a_Displacement\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"Displacement\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DIVINEPROTECTION.XML", "<ACTION ID=\"a_Divine Protection\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DMG.XML", "<ACTION ID=\"a_dmg\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\">	<SLOT NAME=\"dmg_01\"/>	<SLOT NAME=\"dmg_02\"/>	<FSM SCRIPT=\"Act_Damage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DOMINATION.XML", "<ACTION ID=\"a_domination\" TYPE=\"IDLE\" NEXT=\"a_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"domination_start\"/>	<SLOT NAME=\"domination_loop\"/>  	<FSM SCRIPT=\"Skill_Domination\" 		USE_TLM=\"FALSE\"		CANCEL_TYPE=\"1\"			TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_Burrow1\"		TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_Burrow2\"		TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_Shadow Walk\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/DON'TTOUCHME.XML", "<ACTION ID=\"a_Don't touch me!\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_SOUND_ID=\"DonTouch\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DOUBLECRASH.XML", "<ACTION ID=\"a_Double Crash\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_DoubleCrash_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" MULTI_HIT_NUM=\"2\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID =\"ef_Com_skill_DoubleCrash_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"DoubleCrash\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/DOUBLESHOT.XML", "<ACTION ID=\"a_DoubleShot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"attk_02\"/>	<FSM SCRIPT=\"Skill_DoubleShot\" PROJECTILE_ID=\"PROJECTILE_DOUBLE_STRIKE\"       HIT_SOUND_ID=\"DoubleShot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/DOUBLESHOT_CAST.XML", "<ACTION ID=\"a_doubleshot_cast\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       CASTING_SOUND_ID=\"ThreeWayCannon\"       HIT_SOUND_ID=\"Parring\"       HIT_SOUND_ID_MALE=\"voice_male5\"       HIT_SOUND_ID_FEMALE=\"voice_female5\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/DOWNATTACK_01.XML", "<ACTION ID=\"a_down_attack_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/DOWNATTACK_02.XML", "<ACTION ID=\"a_down_attack_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/DOWNATTACK_03.XML", "<ACTION ID=\"a_down_attack_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_03\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/DOWNATTACK_FLY.XML", "<ACTION ID=\"a_down_attack_fly\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_fly\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DOWN_DMG.XML", "<ACTION ID=\"a_down_damage\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\">  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_Down_Damage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DOWN_DMG2.XML", "<ACTION ID=\"a_down_damage_2\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\">  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_Down_Damage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/DOWN_SHOT.XML", "<ACTION ID=\"a_down_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_down_attk_01\"/>  <FSM SCRIPT=\"Skill_Down_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/A_DRAGON_DIVE.XML", "<ACTION ID=\"a_dragon_dive\" NEXT=\"a_dragon_dive_finish\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Onehand_skill_DragonDive_01\"/>	<SLOT NAME=\"Onehand_skill_DragonDive_02\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Skill_Dragon_Dive\"			/>	<!--HIT_SOUND_ID=\"Swd_dmg_01\"-->	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/A_DRAGON_DIVE_FINISH.XML", "<ACTION ID=\"a_dragon_dive_finish\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Onehand_skill_DragonDive_03\"/>		<FSM SCRIPT=\"Skill_Dragon_Dive_Finish\"			/>	<!--HIT_SOUND_ID=\"Swd_dmg_01\"--></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/DRAGON_RAGE_FINISH.XML", "<ACTION ID=\"a_dragon_rage_finish\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"dragon_rage_finish\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"						SEE_FRONT=\"1\"				HIT_SOUND_ID=\"\"				WFF_COLOR_ALPHA_ACTION_TIME=\"2\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"1\"		WFF_COLOR_ALPHA_COLOR=\"16777215\"		WFF_COLOR_ALPHA_START=\"1\"		WFF_COLOR_ALPHA_END=\"0\"		WFF_COLOR_ALPHA_KEEP=\"0\"				DRAW_ACTOR_FILTER_USE=\"1\"		DRAW_ACTOR_FILTER_CLEAR=\"1\"				HIT_TARGET_EFFECT_ID=\"eff_sum_skill_dragon_rage_buff00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"		CAM_MSG_QUAKE_CAMERA_DURATION_1=\"1\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"2\"  				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/DRAGON_RAGE_START.XML", "<ACTION ID=\"a_dragon_rage_start\" NEXT=\"a_dragon_rage_finish\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"dragon_rage_cast\"/>	<SLOT NAME=\"dragon_rage_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				NO_DAMAGE_HOLD =\"TRUE\"				DECO_ACTOR_CLASS_NO=\"9900000\"		DECO_ACTOR_ACTIONTIME=\"5\"		DECO_ACTOR_ACTION_NAME=\"a_sa_dragon_rage_act\"		DECO_ACTOR_WHEN_START_DIRECTION=\"CALLER\"				DECO_ACTOR_POS_DIST_DIR_ROTATE_HORIZ_DEG=\"0\"		DECO_ACTOR_POS_DIST_DIR_ROTATE_VERT_DEG=\"0\"		DECO_ACTOR_DIST=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_skill_mog_dragon_rage_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				SEE_FRONT=\"1\"				WFF_COLOR_ALPHA_ACTION_TIME=\"5\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.4\"		WFF_COLOR_ALPHA_COLOR=\"0\"		WFF_COLOR_ALPHA_START=\"0\"		WFF_COLOR_ALPHA_END=\"1\"		WFF_COLOR_ALPHA_KEEP=\"1\"				DRAW_ACTOR_FILTER_USE=\"1\"		CAM_MSG_QUAKE_CAMERA_DURATION_1=\"3\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"0.8\"		CAM_MSG_QUAKE_CAMERA_DURATION_2=\"3.8\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_2=\"2\"   	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/DRAGON_TOOTH.XML", "<ACTION ID=\"a_dragon_tooth\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"dragon_tooth\"/>  <FSM SCRIPT=\"Skill_Multiple_Shot\"       PROJECTILE_ID=\"PROJECTILE_DRAGON_TOOTH\"	HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"	HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit02\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DUEL_SLOWMOTION.XML", "<ACTION ID=\"a_duel_slowmotion\" TYPE=\"EFFECT\">	<SLOT NAME=\"emotion_OTL_01\"/>	<SLOT NAME=\"emotion_OTL_02\"/>	<FSM SCRIPT=\"Act_Duel_SlowMotion\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/DUEL_VICTORY.XML", "<ACTION ID=\"a_duel_victory\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_victory_01\"/>	<FSM SCRIPT=\"Act_Duel_Victory\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP8.XML", "<ACTION ID=\"a_Dump Bleeding\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP2.XML", "<ACTION ID=\"a_Dump Blindness\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP7.XML", "<ACTION ID=\"a_Dump Burn\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP5.XML", "<ACTION ID=\"a_Dump Cold\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP14.XML", "<ACTION ID=\"a_Dump Curse\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP12.XML", "<ACTION ID=\"a_Dump Freeze\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP10.XML", "<ACTION ID=\"a_Dump Hard Burn\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP4.XML", "<ACTION ID=\"a_Dump Hard Poison\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP11.XML", "<ACTION ID=\"a_Dump Over Bleeding\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP1.XML", "<ACTION ID=\"a_Dump Poison\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP3.XML", "<ACTION ID=\"a_Dump Sleep\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP13.XML", "<ACTION ID=\"a_Dump Slience\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP15.XML", "<ACTION ID=\"a_Dump Slow\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP6.XML", "<ACTION ID=\"a_Dump Stone\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/DUMP9.XML", "<ACTION ID=\"a_Dump Stun\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/>  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/EARTHQUAKE.XML", "<ACTION ID=\"a_Earthquake\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_skill_Earthquake_01\"/>  <FSM SCRIPT=\"EarthQuake\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/EARTH_QUAKE_CAST.XML", "<ACTION ID=\"a_earth_quake_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">		<SLOT NAME=\"earth_quake_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"earth_quake_02\"/>    <FSM SCRIPT=\"CommonSkillAction\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_quake_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Bip01 L Hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"				HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"		HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"		HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"		HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"		HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/EARTH_QUAKE_FIRE.XML", "<ACTION ID=\"a_earth_quake_fire\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				WHEN_ATTACK_TIMER_START=\"ENTER\"		ATTACK_TIMER_TIME=\"60\"		ATTACK_TIMER_TICK=\"0.5\"						EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_smw_quake_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"p_ef_point\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_EARTH_CAST.XML", "<ACTION ID=\"a_elestorm_earth_cast\" NEXT=\"a_elestorm_flame_cast\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"elestorm_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"elestorm_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_rifle_skill_mog_element_storm_m\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"\"		EFFECT_HORIZ_DEG_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_DIST_WHEN_ANI_SLOT1_1=\"0\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_EARTH_FIRE.XML", "<ACTION ID=\"a_elestorm_earth_fire\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_element_storm_rock00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_element_storm_rock01\"				EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"							HIT_MSG_SOUND_ID=\"element_storm_rock\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_FLAME_CAST.XML", "<ACTION ID=\"a_elestorm_flame_cast\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"elestorm_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"elestorm_fire\"/>	<SLOT NAME=\"elestorm_finish\"/>	  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_rifle_skill_mog_element_storm_r\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"\"		EFFECT_HORIZ_DEG_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_DIST_WHEN_ANI_SLOT1_1=\"0\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_FLAME_FIRE.XML", "<ACTION ID=\"a_elestorm_flame_fire\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_element_storm_fire00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_element_storm_fire01\"				EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"							HIT_MSG_SOUND_ID=\"element_storm_fire\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_ICE_CAST.XML", "<ACTION ID=\"a_elestorm_ice_cast\" NEXT=\"a_elestorm_earth_cast\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"elestorm_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"elestorm_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_rifle_skill_mog_element_storm_c\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"\"		EFFECT_HORIZ_DEG_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_DIST_WHEN_ANI_SLOT1_1=\"0\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_ICE_FIRE.XML", "<ACTION ID=\"a_elestorm_ice_fire\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_element_storm_ice00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_element_storm_ice01\"				EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"							HIT_MSG_SOUND_ID=\"element_storm_ice\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_LIGHTNING_CAST.XML", "<ACTION ID=\"a_elestorm_lightning_cast\" NEXT=\"a_elestorm_ice_cast\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"elestorm_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"elestorm_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_rifle_skill_mog_element_storm_g\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"\"		EFFECT_HORIZ_DEG_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_DIST_WHEN_ANI_SLOT1_1=\"0\"							/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_LIGHTNING_FIRE.XML", "<ACTION ID=\"a_elestorm_lightning_fire\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_element_storm_thunder00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_element_storm_thunder01\"				EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"							HIT_MSG_SOUND_ID=\"element_storm_elec\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ELESTORM_START.XML", "<ACTION ID=\"a_elestorm_start\" NEXT=\"a_elestorm_lightning_cast\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"elestorm_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"elestorm_fire\" />	  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_element_storm_magic_g\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"char_root\"		EFFECT_SCALE_WHEN_EFFECT_MSG1_1=\"1\"		EFFECT_HORIZ_DEG_WHEN_EFFECT_MSG1_1=\"-39.8056\"		EFFECT_VERT_DEG_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_DIST_WHEN_EFFECT_MSG1_1=\"78.1025\"				EFFECT_CNT_WHEN_EFFECT_MSG2=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG2_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG2_1=\"eff_element_storm_magic_c\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG2_1=\"char_root\"		EFFECT_SCALE_WHEN_EFFECT_MSG2_1=\"1\"		EFFECT_HORIZ_DEG_WHEN_EFFECT_MSG2_1=\"22.6199\"		EFFECT_VERT_DEG_WHEN_EFFECT_MSG2_1=\"0\"		EFFECT_DIST_WHEN_EFFECT_MSG2_1=\"130\"				EFFECT_CNT_WHEN_EFFECT_MSG3=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG3_1=\"5\"				EFFECT_ID_WHEN_EFFECT_MSG3_1=\"eff_element_storm_magic_m\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG3_1=\"char_root\"		EFFECT_HORIZ_DEG_WHEN_EFFECT_MSG3_1=\"-15.5241\"		EFFECT_DIST_WHEN_EFFECT_MSG3_1=\"186.815\"				EFFECT_SCALE_WHEN_EFFECT_MSG3_1=\"1\"				EFFECT_CNT_WHEN_EFFECT_MSG4=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG4_1=\"5\"		EFFECT_ID_WHEN_EFFECT_MSG4_1=\"eff_element_storm_magic_r\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG4_1=\"char_root\"		EFFECT_HORIZ_DEG_WHEN_EFFECT_MSG4_1=\"11.7683\"		EFFECT_DIST_WHEN_EFFECT_MSG4_1=\"245.153\"				EFFECT_SCALE_WHEN_EFFECT_MSG4_1=\"1\"			CAM_MSG_QUAKE_CAMERA_DURATION_1=\"0.3\"		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"0.5\" 	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/EMERGENCYRETREAT.XML", "<ACTION ID=\"a_emergency_retreat\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" 	BROADCAST_TARGETLIST=\"TRUE\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"	FIRE_CASTER_EFFECT_ID=\"eff_pc_detection01\"	FIRE_CASTER_EFFECT_SIZE_TO_SKILLRANGE_FACTOR=\"10\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/EMERGENCYRETREAT_PLAY.XML", "<ACTION ID=\"a_emergency_retreat_play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"opening\"/>  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Santuary_Play\"	FIRE_SOUND_ID=\"emergencyretreat02\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/GRAP_HAND.XML", "<ACTION ID=\"a_Emotion_GrapHand\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">	<SLOT NAME=\"emotion_grap_hand_01\"/>	<SLOT NAME=\"emotion_grap_hand_02\"/>	<SLOT NAME=\"emotion_grap_hand_03\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/GRAP_HAND2.XML", "<ACTION ID=\"a_Emotion_GrapHand2\" NEXT=\"a_idle\" TYPE=\"IDLE\" >	<SLOT NAME=\"emotion_grap_hand_01\"/>	<SLOT NAME=\"emotion_grap_hand_02\"/>	<SLOT NAME=\"emotion_grap_hand_03\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_ThreeStage2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/HUG.XML", "<ACTION ID=\"a_Emotion_Hug\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"emotion_hug_01\"/>	<SLOT NAME=\"emotion_hug_02\"/>	<SLOT NAME=\"emotion_hug_03\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/HUG2.XML", "<ACTION ID=\"a_Emotion_Hug2\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_hug_01\"/>	<SLOT NAME=\"emotion_hug_02\"/>	<SLOT NAME=\"emotion_hug_03\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_ThreeStage2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/KISS.XML", "<ACTION ID=\"a_Emotion_Kiss\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"emotion_kiss\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/KISS2.XML", "<ACTION ID=\"a_Emotion_Kiss2\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_kiss\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_SingleStage2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/REST07.XML", "<ACTION ID=\"a_Emotion_rest07\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"emotion_balloon\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/REST072.XML", "<ACTION ID=\"a_Emotion_rest072\"  NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_balloon\"/>	<FSM SCRIPT=\"Act_Couple_Emotion_SingleStage2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/WEDDING.XML", "<ACTION ID=\"a_Emotion_Wedding\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"emotion_wedding\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/EMP.XML", "<ACTION ID=\"a_EMP\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"attk_charge_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Skill_EMP\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"PROJECTILE_THRUST_ARROW\"	 MONSTER_UP_EFFECT_ID=\"\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARAMMUTISHA/ENDING_MOVIE.XML", "<ACTION ID=\"a_ending_movie\" LOOP=\"FALSE\">	<SLOT NAME=\"ending_movie\"/>	<FSM SCRIPT=\"Act_Ending_Movie\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/ENERGY_BALL.XML", "<ACTION ID=\"a_Energy Ball\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_SKill_Energy_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_SKill_Energy_01_02\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_EnergyBall_01_char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/ENERGY_BALL_FIRE.XML", "<ACTION ID=\"a_Energy Ball Fire\" NEXT=\"a_idle\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Energy_Ball_Play\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/ENERGYBUSTER.XML", "<ACTION ID=\"a_Energy Burster\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_EnergyBuster_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIND_TARGET_TYPE =\"BAR\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_skill_EnergyBurster_01_char_root\"        FIRE_CASTER_EFFECT_TARGET_NODE2=\"p_wp_l_hand\"       FIRE_CASTER_EFFECT_ID2=\"Energy _Burster\"       FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH=\"TRUE\"       DETACH_FIRE_EFFECT_AT_FINISH =\"TRUE\"       HIDE_WEAPON=\"TRUE\"       HIT_SOUND_ID =\"Energy_Burster\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ENTERINGPVP.XML", "<ACTION ID=\"a_entering_pvp\" NEXT=\"a_idle\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Act_EnteringPvP\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/EVADE_ADD.XML", "<ACTION ID=\"a_evade_add\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/EXERCISE.XML", "<ACTION ID=\"a_exercise\" NEXT=\"a_PetUIIdle\" >	<SLOT NAME=\"exercise\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/EXIT.XML", "<ACTION ID=\"a_EXIT\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"Exit\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/EXPLOSIONDRAGON.XML", "<ACTION ID=\"a_Explosion Dragon\" NEXT=\"a_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Debuff_02_01\"/>  <SLOT NAME=\"Com_Skill_Debuff_02_02\"/>  <FSM SCRIPT=\"Skill_Iceberg\" ACTOR_CLASS_NO=\"900014\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/EXPLOSIONDRAGON_PLAY.XML", "<ACTION ID=\"a_Explosion Dragon_Play\" NEXT=\"a_idle\" USE-EVENT=\"true\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"create\"/>  <SLOT NAME=\"idle\"/>  <SLOT NAME=\"attack\"/>  <FSM SCRIPT=\"Skill_Iceberg_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FAKE_CAST.XML", "<ACTION ID=\"a_fake_cast\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Com_Guild_spell_01\"/>	<FSM SCRIPT=\"Act_FakeCasting\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/FALCONBEAT.XML", "<ACTION ID=\"a_Falcon Beat\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Skill_Falcon_Beat\"       HIT_SOUND_ID=\"FalconBeat\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/FALCONBEAT_PLAY.XML", "<ACTION ID=\"a_Falcon Beat_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_Falcon_Beat_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FALL.XML", "<ACTION ID=\"a_fall\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_Fall\" INITIAL_SPEED=\"0\" ACCELATION=\"800\" STAY_DOWN_TIME=\"0.1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/KILLINGMIST.XML", "<ACTION ID=\"a_Falling Leaf01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_KillingMist_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"         CASTING_EFFECT_TARGET_NODE =\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_metamorphosis_skill_killingmist_01\"	   DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"	   CASTING_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/FASTCAST.XML", "<ACTION ID=\"a_Fast Cast\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       HIT_CASTER_EFFECT_TARGET_NODE=\"p_ef_star\"       HIT_CASTER_EFFECT_ID=\"ef_Casting_accelation_p_ef_star\"       HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_star\"       HIT_TARGET_EFFECT_ID=\"ef_Casting_accelation_p_ef_star\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"Fastcast\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FIGHTERFRIENDSHIP.XML", "<ACTION ID=\"a_Fighter_Friendship\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"FriendShipBuff\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_fighter_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FIGHTER_JUMP_ATTACK.XML", "<ACTION ID=\"a_fighter_jump_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER =\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Skill_Fighter_Jump_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FIG_FLOATDOWNBLOW.XML", "<ACTION ID=\"a_fig_floatdownblow1\" NEXT=\"a_jump\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"jump_attk_03\"/>  <FSM SCRIPT=\"Skill_FloatDownBlow\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FIG_FLOATDOWNBLOW2.XML", "<ACTION ID=\"a_fig_floatdownblow2\" NEXT=\"a_jump\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"jump_attk_03\"/>  <FSM SCRIPT=\"Skill_FloatDownBlow\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/FINALDECISION.XML", "<ACTION ID=\"a_Final Decision\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_FinalDecision_01\"/>  <FSM SCRIPT=\"Skill_FinalDecision\"        MULTI_HIT_NUM=\"9\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID =\"ef_Com_skill_FinalDecision_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       NO_DAMAGE_HOLD=\"TRUE\"       HIT_SOUND_ID=\"FinalDecision\"       FIND_TARGET_TYPE=\"SPHERE\"      /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FIREYOUTH.XML", "<ACTION ID=\"a_Fire Youth\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Hammer_Crush_01\"/>  <FSM SCRIPT=\"HammerCrush\"       WEAPON_XML=\"Item/Common/12_Weapon/09_special/fire_hammer.xml\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/FIREBALL.XML", "<ACTION ID=\"a_fire_ball_pet\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       USE_PROJECTILE=\"TRUE\"       PROJECTILE_ID=\"PROJECTILE_MAGICIAN_PET_SHOT\"       ATTACH_NODE_ID=\"p_ef_mouth\"       FIRE_SOUND_ID=\"pingmao-skill-fire_ball_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/FIREBALL2.XML", "<ACTION ID=\"a_fire_ball_pet2\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       USE_PROJECTILE=\"TRUE\"       PROJECTILE_ID=\"PROJECTILE_MAGICIAN_DEFAULT_SHOT\"       ATTACH_NODE_ID=\"p_ef_mouth\"       FIRE_SOUND_ID=\"pingmao-skill-fire_ball_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/FIRE_CLOUD.XML", "<ACTION ID=\"a_fire_cloud\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"frozen_01_start\"/>   	<SLOT NAME=\"frozen_01_idle\"/>   	<SLOT NAME=\"frozen_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/FIRE_HURRICANE.XML", "<ACTION ID=\"a_fire_hurricane\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"hurricane_01_start\"/>   	<SLOT NAME=\"hurricane_01_idle\"/>   	<SLOT NAME=\"hurricane_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_FIRE_HURRICANE\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"4\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"5\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"6\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"7\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV6=\"8\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV7=\"9\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV8=\"10\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV9=\"11\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV10=\"12\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"char_root\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			FIRE_PROJECTILE_DEG1_1=\"304.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_4=\"60.833\"		FIRE_PROJECTILE_DEG1_3=\"243.332\"		FIRE_PROJECTILE_DEG1_5=\"121.666\"		FIRE_PROJECTILE_DEG1_6=\"182.499\"		FIRE_PROJECTILE_DEG1_7=\"320\"		FIRE_PROJECTILE_DEG1_8=\"80\"		FIRE_PROJECTILE_DEG1_9=\"140\"		FIRE_PROJECTILE_DEG1_10=\"280\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/FLASHBANG.XML", "<ACTION ID=\"a_Flash Bang\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Projectile_HandGrenade\" PROJECTILE_ID =\"PROJECTILE_FlashBang\"       HIT_SOUND_ID=\"WP_Granade_Fire\"       ATTACH_NODE_ID=\"p_wp_r_hand\"       HIDE_WEAPON=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FLOATDMG.XML", "<ACTION ID=\"a_float_dmg\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <SLOT NAME=\"StandUp\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"21\" NO_HORI_MOVE=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FLOATDMG_SMALL.XML", "<ACTION ID=\"a_float_dmg_small\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"4\" NO_HORI_MOVE=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FLOATDMG_VERYSMALL.XML", "<ACTION ID=\"a_float_dmg_very_small\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"1\" NO_HORI_MOVE=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FLOATMELEE_01.XML", "<ACTION ID=\"a_float_melee_01\" NEXT=\"a_jump\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FLOATMELEE_02.XML", "<ACTION ID=\"a_float_melee_02\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_02\"/>	<FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FLOATMELEE_03.XML", "<ACTION ID=\"a_float_melee_03\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_03\"/>	<FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/FLOP.XML", "<ACTION ID=\"a_flop\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_flop_01\"/>	<SLOT NAME=\"emotion_flop_02\"/>	<SLOT NAME=\"emotion_flop_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FLY.XML", "<ACTION ID=\"a_fly\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Fly\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FLYTOCAMERA.XML", "<ACTION ID=\"a_fly_to_camera\"  TYPE=\"EFFECT\" NEXT=\"a_idle\" >  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_FlyToCamera\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/FOOD_DROP.XML", "<ACTION ID=\"a_food_drop\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"petfood_01_start\"/>   	<SLOT NAME=\"petfood_01_idle\"/>   	<SLOT NAME=\"petfood_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		EFFECT_CNT_WHEN_ANI_SLOT3=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT3_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT3_1=\"eff_common_anger00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT3_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT3_1=\"3\"		EFFECT_DETACH_TIME_ANI_SLOT3_1=\"CLEAN_UP\"		HIT_SOUND_ID=\"DarkWizard_Skill03\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/FORGETPAIN.XML", "<ACTION ID=\"a_Forget Pain\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"ForgetPain\" FIRE_CASTER_EFFECT_ID=\"ef_Forget Pain_01_char_root\" FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/FORTRESS.XML", "<ACTION ID=\"a_Fortress\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Fortress_01\"/>  <FSM SCRIPT=\"Fortress\" PROJECTILE_ID=\"PROJECTILE_FORTRESS\" UPGRADE_PROJECTILE_ID=\"PROJECTILE_POWERUP_FORTRESS\" HIT_SOUND_ID=\"Fortress\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/FREEZE.XML", "<ACTION ID=\"a_freeze\"  NEXT=\"a_idle\" >  <SLOT NAME=\"idle_01\" />  <FSM SCRIPT=\"Act_Freeze\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/FREEZINGTRAP.XML", "<ACTION ID=\"a_Freezing Trap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_skill_RatTrap_01\"/>  <SLOT NAME=\"Bow_Skill_JumpTrap_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"Freezing_Trap\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/FREEZINGTRAPACTIVE.XML", "<ACTION ID=\"a_Freezing Trap Active\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Trap_Play\"       TYPE=\"BOMB\"        SERACH_TYPE=\"FULLSEARCH\"        BOMB_EFFECT_ID=\"ef_Trap_Freezing_02\"       BOME_AFTER_EFFECT_ID=\"e_ef_fossilearth_explosion\"        BOME_AFTER_EFFECT_SCALE=\"0.4\"       HIT_SOUND_ID=\"Deapodong\"       BOME_AFTER_SOUND_ID=\"SplashTrap2\"	          IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_ID=\"ef_Trap_Freezing_01\"       IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_TARGET_NODE_POS=\"Dummy01\"	          INSTALL_EFFECT_ID2=\"ef_dust_01\"       INSTALL_EFFECT_TARGET_NODE_POS2=\"Dummy01\"	   	   TRANSFORM_EFFECT_ID=\"ef_dust_01\"       TRANSFORM_EFFECT_TARGET_NODE_POS=\"Dummy01\"	   TRANSFORM_SOUND_ID=\"Needle_Trap_01\"	   	   TARGET_SCALE=\"0.5\"	   TARGET_SCALE_TIME=\"1000\"	          FIND_TARGET_TYPE=\"SPHERE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/FROZEN_CHAIN_CAST.XML", "<ACTION ID=\"a_frozen_chain_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"frozen_chain_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"frozen_chain_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_frozenchain_start00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/FROZEN_CLOUD.XML", "<ACTION ID=\"a_frozen_cloud\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"frozen_01_start\"/>   	<SLOT NAME=\"frozen_01_idle\"/>   	<SLOT NAME=\"frozen_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/FROZENSHOT_PLAY.XML", "<ACTION ID=\"a_frozen_shot_play\" NEXT=\"a_idle\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_FrozenShot_Play\" 		PROJECTILE_ID=\"PROJECTILE_FROZEN_SHOT\" ATTACH_NODE_ID=\"char_root\"       FIRE_SOUND_ID=\"frozen_shot\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/FURY_CAMERA.XML", "<ACTION ID=\"a_fury_camera\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"fury_camera_start\"/><SLOT NAME=\"fury_camera_btlidle\" LOOP=\"TRUE\"/><SLOT NAME=\"fury_camera_fire\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Fury_Camera\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/GATLINGRUSH.XML", "<ACTION ID=\"a_Gatling Rush\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"Csb_skill_GatlingRush_01_01\"/>  <FSM SCRIPT=\"Skill_Gatling_Rush\"       FIRE_CASTER_EFFECT_ID=\"ef_GatlingRush_01_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       HIT_SOUND_ID=\"GatlingRush\"       MULTI_HIT_NUM=\"10\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/GENESICGEAR-OFFENSE.XML", "<ACTION ID=\"a_Genesic Gear - Offense\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"GGOffense\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/GENESICGEAR-PROTECT.XML", "<ACTION ID=\"a_Genesic Gear - Protect\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"GGProtect\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/GIMILET.XML", "<ACTION ID=\"a_Gimmlet\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Skill_Gimilet\" PROJECTILE_ID =\"PROJECTILE_GIMILET\"       HIT_SOUND_ID=\"Gimmlet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/GOLDRUSH.XML", "<ACTION ID=\"a_gold_rush\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dash_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_Pet_dash_01_p_ef_attk_02\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_dash_01\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/GROUNDMINE.XML", "<ACTION ID=\"a_Ground Mine\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shoot_01\"/>  <SLOT NAME=\"Com_skill_Ground_01\"/>  <FSM SCRIPT=\"Skill_GroundMine\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/GROUNDZERO.XML", "<ACTION ID=\"a_groundzero\" NEXT=\"a_groundzero_finish\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Arc_Csb_Skill_GroundZero_01_01\"/>  <FSM SCRIPT=\"Skill_Master_Summon_Common\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_multi_stripe_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_multi_stripe_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"		   NO_DAMAGE_HOLD =\"TRUE\"	       HIT_TIMER_TIME=\"4.5\"       HIT_TIMER_TICK=\"0.3\"       SUMMON_CLASSNO=\"900106\"       SUMMON_RESERVE_ACTION=\"a_groundzero_creature_idle\"		   HIT_TARGET_EFFECT_ID=\"\"	   HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"	   	   CASTING_SOUND_ID_MALE=\"Male_GroundZero\"	   CASTING_SOUND_ID_FEMALE=\"Female_GroundZero\"	   MULTIPLE_ATTACK=\"TRUE\"	   />	   <!--WEAPON_XML=\"../XML/Item/Common/12_Weapon/09_special/GroundZero_Gun.xml\" --></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/GROUNDZERO_CREATURE_IDLE.XML", "<ACTION ID=\"a_groundzero_creature_idle\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Skill_GroundZero_Creature_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/GROUNDZEROFINISH.XML", "<ACTION ID=\"a_groundzero_finish\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\"  ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Arc_Csb_Skill_GroundZero_01_02\" />  <FSM SCRIPT=\"Skill_Master_Summon_Finish\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"			   NO_DAMAGE_HOLD =\"TRUE\"		       CHECK_CAN_PREV_ACTION_ID=\"a_groundzero\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GROUND_PISTON.XML", "<ACTION ID=\"a_Ground_Piston\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" >  <SLOT NAME=\"Skill_Ground_Piston\"/>  <FSM SCRIPT=\"Skill_Melee_Blow_Up\"		HIT_MSG_QUAKE_CAMERA_DURATION=\"0.25\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"0.5\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GROWBODY.XML", "<ACTION ID=\"a_Grow Body\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"GrowBody\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_A.XML", "<ACTION ID=\"a_gs_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_a_Attk\"/>	<SLOT NAME=\"gs_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_comboshot_01\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"1\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_B.XML", "<ACTION ID=\"a_gs_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_b_Attk\"/>	<SLOT NAME=\"gs_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_comboshot_01\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"1\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C.XML", "<ACTION ID=\"a_gs_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_Attk\"/>	<SLOT NAME=\"gs_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_comboshot_01_2\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"35\"		MOVE_COMPLETE_TIME_1=\"0.3\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.85\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_1=\"0.63\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_2=\"0.38\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_3=\"0.25\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_4=\"0.05\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C_4_F0.XML", "<ACTION ID=\"a_gs_combo_c_4_F0\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_4_F0_Start\"/>	<SLOT NAME=\"gs_combo_c_4_F0_btlidle\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_COMBO_CHARGE=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.1\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"0.2\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo01_c4_charge_hand01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"						EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_gs_combo01_c4_muzz_bottom01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"TRUE\"				CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.85\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_1=\"0.63\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_2=\"0.38\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_3=\"0.25\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_4=\"0.05\"				SAVE_CAMERA_POS=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C_4_F1.XML", "<ACTION ID=\"a_gs_combo_c_4_F1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_4_F1_Attk\"/>	<SLOT NAME=\"gs_combo_c_4_F1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\"      	USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"0\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo01_c4_muzz00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_charge_shot_01\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"								FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"1\"		NO_DAMAGE_HOLD=\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C_4_F2.XML", "<ACTION ID=\"a_gs_combo_c_4_F2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_4_F2_Attk\"/>	<SLOT NAME=\"gs_combo_c_4_F2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_charge_shot_01\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"								FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"1\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"0\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo01_c4_muzz_bottom01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_gs_combo01_c4_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C_4_F3.XML", "<ACTION ID=\"a_gs_combo_c_4_F3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_4_F3_Attk\"/>	<SLOT NAME=\"gs_combo_c_4_F3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.7\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.7\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_charge_shot_02\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"								FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"1.0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"-50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"1\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"0\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo01_c4_muzz_bottom01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_gs_combo01_c4_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"char_root\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C_4_F4.XML", "<ACTION ID=\"a_gs_combo_c_4_F4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_4_F4_Attk\"/>	<SLOT NAME=\"gs_combo_c_4_F4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"						FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_charge_shot_02\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"5\"			FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"1.0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"1.0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_4 = \"-50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_4 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST1_1_4 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_4 = \"-50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_4 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST2_1_4 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_5 = \"-90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_5 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST1_1_5 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_5 = \"-90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_5 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST2_1_5 = \"1\"			NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"0\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo01_c4_muzz_bottom01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_gs_combo01_c4_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"char_root\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_C_4_F5.XML", "<ACTION ID=\"a_gs_combo_c_4_F5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_4_F5_Attk\"/>	<SLOT NAME=\"gs_combo_c_4_F5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.9\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"4\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION =\"0.9\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_charge_shot_02\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"9\"						FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"1.0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"70\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"70\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"70\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"70\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"1.0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_4 = \"30\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_4 = \"30\"		FIRE_PROJECTILE_BEZIER_DIST1_1_4 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_4 = \"30\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_4 = \"30\"		FIRE_PROJECTILE_BEZIER_DIST2_1_4 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_5 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_5 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST1_1_5 = \"0\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_5 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_5 = \"0\"		FIRE_PROJECTILE_BEZIER_DIST2_1_5 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_6 = \"-30\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_6 = \"30\"		FIRE_PROJECTILE_BEZIER_DIST1_1_6 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_6 = \"-30\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_6 = \"30\"		FIRE_PROJECTILE_BEZIER_DIST2_1_6 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_7 = \"-50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_7 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST1_1_7 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_7 = \"-50\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_7 = \"50\"		FIRE_PROJECTILE_BEZIER_DIST2_1_7 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_8 = \"-70\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_8 = \"70\"		FIRE_PROJECTILE_BEZIER_DIST1_1_8 = \"0.8\"			FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_8 = \"-70\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_8 = \"70\"		FIRE_PROJECTILE_BEZIER_DIST2_1_8 = \"1\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_9 = \"-90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_9 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST1_1_9 = \"0.8\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_9 = \"-90\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_9 = \"90\"		FIRE_PROJECTILE_BEZIER_DIST2_1_9 = \"1\"					NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT0=\"0\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo01_c4_muzz_bottom01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"		EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_gs_combo01_c4_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"char_root\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_D.XML", "<ACTION ID=\"a_gs_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_d_Attk\"/>	<SLOT NAME=\"gs_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"Projectile_Summoner_comboshot_03\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.1\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD=\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_1.XML", "<ACTION ID=\"a_gs_combo_z_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_1_Attk\"/>	<SLOT NAME=\"gs_combo_z_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"		TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_gs_combo_z_4\"		TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_gs_combo_z_1_2_3\"		TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_gs_combo_z_1_3\"		TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_gs_combo_z_2_3_4\"		TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_gs_combo_z_2_4\"		TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_gs_combo_z_3_4\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo06_z_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_gs_combo06_z_1_range\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD=\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_1_2.XML", "<ACTION ID=\"a_gs_combo_z_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_1_2_Attk\"/>	<SLOT NAME=\"gs_combo_z_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo06_z_1_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Bip01 L Hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_1_2_3.XML", "<ACTION ID=\"a_gs_combo_z_1_2_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_1_2_3_Attk\"/>	<SLOT NAME=\"gs_combo_z_1_2_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo07_Z_1_2_3_hand00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Bip01 L Hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_gs_combo07_Z_1_2_3_sum00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"50\"		MOVE_COMPLETE_TIME_1=\"0.5\"		NO_DAMAGE_HOLD=\"TRUE\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_1_3.XML", "<ACTION ID=\"a_gs_combo_z_1_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_1_3_Attk\"/>	<SLOT NAME=\"gs_combo_z_1_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_gs_combo06_Z_1_3_hand00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_gs_combo06_Z_1_3_vine00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"20\"		MOVE_COMPLETE_TIME_1=\"0.2\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_2.XML", "<ACTION ID=\"a_gs_combo_z_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_2_Attk\"/>	<SLOT NAME=\"gs_combo_z_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_2_3.XML", "<ACTION ID=\"a_gs_combo_z_2_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_2_3_Attk\"/>	<SLOT NAME=\"gs_combo_z_2_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo04_z_2_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_Magician_z_3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_DEG1_1=\"-12.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"12.833\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_2_3_4.XML", "<ACTION ID=\"a_gs_combo_z_2_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_2_3_4_Attk\"/>	<SLOT NAME=\"gs_combo_z_2_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_Magician_z_2_3_4\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_2_4.XML", "<ACTION ID=\"a_gs_combo_z_2_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_2_4_Attk\"/>	<SLOT NAME=\"gs_combo_z_2_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_3.XML", "<ACTION ID=\"a_gs_combo_z_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_3_Attk\"/>	<SLOT NAME=\"gs_combo_z_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_3_4.XML", "<ACTION ID=\"a_gs_combo_z_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_3_4_Attk\"/>	<SLOT NAME=\"gs_combo_z_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"				EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/GS_COMBO_Z_4.XML", "<ACTION ID=\"a_gs_combo_z_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_z_4_Attk\"/>	<SLOT NAME=\"gs_combo_z_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"FALSE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"3\"				EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_3=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_3=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_3=\"Weapon_Bone01_R\"		EFFECT_SCALE_WHEN_ANI_SLOT0_3=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_3=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/GUILD/GUILD_ACCELERATION.XML", "<ACTION ID=\"a_Guild_Acceleration\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_Guild_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Guild_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_Acceleration_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_Acceleration_02_char_root\"       HIT_SOUND_ID=\"Acceleration\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/GUSTSLASH.XML", "<ACTION ID=\"a_Gust Slash\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Twohand_skill_GustSlash_01\" />  <FSM SCRIPT=\"Act_Melee_Default\"       MULTI_HIT_NUM=\"3\"       FIRE_CASTER_EFFECT_ID=\"ef_Gustslash_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       NO_DAMAGE_HOLD=\"TRUE\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/A_HADES_SKILL.XML", "<ACTION ID=\"a_hades_skill\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/HAMMERCRUSH.XML", "<ACTION ID=\"a_Hammer Crush\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Hammer_Crush_01\"/>  <FSM SCRIPT=\"HammerCrush\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/HANDCLAP.XML", "<ACTION ID=\"a_handclap\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_handclap_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/HANG.XML", "<ACTION ID=\"a_hang\" NEXT=\"a_idle\" LOOP=\"TRUE\" MONITOR=\"TRUE\">	<SLOT NAME=\"hang_ready\"/>	<SLOT NAME=\"hang_idle\"/>	<SLOT NAME=\"hang_up\"/>	<FSM SCRIPT=\"Act_Hang\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/HAPHAZARD.XML", "<ACTION ID=\"a_Haphazard\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_RollingStinger_01\"/>  <SLOT NAME=\"Com_skill_RollingStinger_02\"  LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_RollingStinger_03\"/>  <FSM SCRIPT=\"Skill_Haphazard\"        NO_WEAPON_TRAIL=\"TRUE\"      /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/HEGRANADE.XML", "<ACTION ID=\"a_HE Granade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"Com_shot_05\"/>  <FSM SCRIPT=\"Projectile_HandGrenade\" PROJECTILE_ID =\"PROJECTILE_HEGrenade\"       USE_MULTI_SHOT=\"TRUE\"       HIT_SOUND_ID=\"He_Granade\"       ATTACH_NODE_ID=\"p_wp_r_hand\"       HIDE_WEAPON=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/HEAD_SPIN.XML", "<ACTION ID=\"a_head_spin\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Thi_Claw_skill_HeadSpin_01\"/>  <SLOT NAME=\"Thi_Claw_skill_HeadSpin_01_finish\"/>  <FSM SCRIPT=\"Skill_HeadSpin\"       HIT_SOUND_ID=\"\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"efx_skill_add_headspin\"				FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"		FIRE_CASTER_EFFECT_ID2=\"ef_Windmill_01_char_root\"				ENTER_TIMER_TIME=\"5\"		ENTER_TIMER_TICK=\"0.3\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/HEALINGWAVE.XML", "<ACTION ID=\"a_HealingWave\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"skill_healing_wave_01\"/>  <SLOT NAME=\"skill_healing_wave_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"skill_healing_wave_03\"/>  <FSM SCRIPT=\"Skill_HealingWave\"       HIT_SOUND_ID=\"HealingWave_Heal\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/HEARTLESSLIFE.XML", "<ACTION ID=\"a_Heartless Life\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Hammer_Crush_01\"/>  <FSM SCRIPT=\"HammerCrush\"       WEAPON_XML=\"Item/Common/12_Weapon/09_special/ice_hammer.xml\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/HEAVYDASH.XML", "<ACTION ID=\"a_heavy_dash\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dash_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_Pet_dash_01_p_ef_attk_02\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_dash_01\"       FIRE_CASTER_EFFECT_ID2=\"ef_strong_dash_00_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       FIRE_SOUND_ID=\"pingmao-skill-strong_dash\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/HELLSHOUT.XML", "<ACTION ID=\"a_HellShout\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Claw_skill_HellShouting_01\"/>  <FSM SCRIPT=\"Skill_Maniac_HellShout\"       CASTING_EFFECT_EFFECT_ID=\"ef_skill_hell_shouting_01_char_root\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"\"       FIRE_SOUND_ID=\"HellShout\"	   MULTI_HIT_NUM=\"10\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/A_HELLSHOUT_PLAY.XML", "<ACTION ID=\"a_HellShout_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Hell_Shouting_skill_01\"/>  <FSM SCRIPT=\"Skill_HellShout_play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/HI.XML", "<ACTION ID=\"a_hi\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_hi\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/HIDE.XML", "<ACTION ID=\"a_hide\" NEXT=\"a_hide_idle\" CHECK_CAN_ENTER =\"TRUE\">	<SLOT NAME=\"close_01\"/>	<FSM SCRIPT=\"Act_Hide\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/HITRATEUP.XML", "<ACTION ID=\"a_hitrate_up\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"eff_buf_theTarget00\"       HIT_SOUND_ID=\"Acceleration\"	   NO_WEAPON_TRAIL=\"TRUE\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/HIT_BUFF.XML", "<ACTION ID=\"a_hit_buff\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/HOLDDOWN.XML", "<ACTION ID=\"a_hold_down\"  TYPE=\"EFFECT\" NEXT=\"a_idle\" >  <SLOT NAME=\"dmg_01\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <SLOT NAME=\"StandUp\"/>  <FSM SCRIPT=\"Act_HoldDown\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/HOLYARMOR.XML", "<ACTION ID=\"a_Holy Armor\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>    <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Holyarmor_01_char_root\"       HIT_SOUND_ID=\"HolyArmor\"       SHOW_TEXT_TARGETLIST_COUNT_NUM=\"1\"       SHOW_TEXT_TARGETLIST_TEXTNO=\"41001\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/HOMMINGMISSILE.XML", "<ACTION ID=\"a_Homing Missile\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_HomingMissile_01\"/>  <FSM SCRIPT=\"Skill_HommingMissile\"        PROJECTILE_ID=\"Projectile_HommingMissile\"       WEAPON_HIDE=\"TRUE\"       FIRE_CASTER_EFFECT_ID=\"Homing_Missile\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_wp_r_hand\"       FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       HIT_SOUND_ID=\"Bazooka\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/HOMMINGMISSILEGROUND.XML", "<ACTION ID=\"a_Homing Missile Ground\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bazuka_01\"/>  <FSM SCRIPT=\"Projectile_Default\"        PROJECTILE_ID=\"Projectile_HommingMissile\"       HIDE_WEAPON=\"TRUE\"       FIRE_CASTER_EFFECT_ID=\"Homing_Missile\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_wp_r_hand\"       FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       HIT_SOUND_ID=\"Bazooka\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/HONOR.XML", "<ACTION ID=\"a_honor\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_honor_01\"/>	<SLOT NAME=\"emotion_honor_02\"/>	<SLOT NAME=\"emotion_honor_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/HPRESTORE.XML", "<ACTION ID=\"a_HP Restore\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID =\"ef_HPrestore_01_char_root\"	   FIRE_SOUND_ID=\"HP_Restore\"	   	   CASTING_EFFECT_TARGET_NODE=\"char_root\"	   CASTING_EFFECT_EFFECT_ID=\"eff_hp_restore00\"	   CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"	   CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR=\"10\"	          /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/HURRICANE.XML", "<ACTION ID=\"a_hurricane\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"hurricane_01_start\"/>   	<SLOT NAME=\"hurricane_01_idle\"/>   	<SLOT NAME=\"hurricane_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_HURRICANE\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"4\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"5\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"6\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"7\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV6=\"8\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV7=\"9\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV8=\"10\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV9=\"11\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV10=\"12\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"char_root\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			FIRE_PROJECTILE_DEG1_1=\"304.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_4=\"60.833\"		FIRE_PROJECTILE_DEG1_3=\"243.332\"		FIRE_PROJECTILE_DEG1_5=\"121.666\"		FIRE_PROJECTILE_DEG1_6=\"182.499\"		FIRE_PROJECTILE_DEG1_7=\"320\"		FIRE_PROJECTILE_DEG1_8=\"80\"		FIRE_PROJECTILE_DEG1_9=\"140\"		FIRE_PROJECTILE_DEG1_10=\"280\"	/>		EFFECT_CNT_WHEN_ANI_SLOT3=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT3_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT3_1=\"eff_boxing_mc_skill_dft_weaving_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT3_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT3_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT3_1=\"CLEAN_UP\"								MOVE_TYPE_3=\"I\"		MOVE_GOAL_POS_TARGET_3=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_3=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_3=\"0\"		MOVE_GOAL_POS_DIST_3=\"120\"		MOVE_COMPLETE_TIME_3=\"0.367\"		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/HURRICANE_P.XML", "<ACTION ID=\"a_hurricane_p\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"hurricane_01_start\"/>   	<SLOT NAME=\"hurricane_01_idle\"/>   	<SLOT NAME=\"hurricane_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_HURRICANE\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"4\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"5\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"6\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"7\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV6=\"8\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV7=\"9\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV8=\"10\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV9=\"11\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV10=\"12\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"p_efx_tornado\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			FIRE_PROJECTILE_DEG1_1=\"304.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_4=\"60.833\"		FIRE_PROJECTILE_DEG1_3=\"243.332\"		FIRE_PROJECTILE_DEG1_5=\"121.666\"		FIRE_PROJECTILE_DEG1_6=\"182.499\"		FIRE_PROJECTILE_DEG1_7=\"320\"		FIRE_PROJECTILE_DEG1_8=\"80\"		FIRE_PROJECTILE_DEG1_9=\"140\"		FIRE_PROJECTILE_DEG1_10=\"280\"	/>		EFFECT_CNT_WHEN_ANI_SLOT3=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT3_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT3_1=\"eff_boxing_mc_skill_dft_weaving_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT3_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT3_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT3_1=\"CLEAN_UP\"								MOVE_TYPE_3=\"I\"		MOVE_GOAL_POS_TARGET_3=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_3=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_3=\"0\"		MOVE_GOAL_POS_DIST_3=\"120\"		MOVE_COMPLETE_TIME_3=\"0.367\"		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/HYPERSTRENGTH.XML", "<ACTION ID=\"a_Hyper Strength\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_CASTER_EFFECT_ID=\"ef_Mask_Hyperstrengh_01_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_Mask_Hyperstrengh_02_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       HIT_SOUND_ID=\"Dexterity\"       FIND_TARGET_TYPE=\"SPHERE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/ICEBERG.XML", "<ACTION ID=\"a_Iceberg\" NEXT=\"a_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Debuff_02_01\"/>  <SLOT NAME=\"Com_Skill_Debuff_02_02\"/>  <FSM SCRIPT=\"Skill_Iceberg\" ACTOR_CLASS_NO=\"900013\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/ICEBERG_PLAY.XML", "<ACTION ID=\"a_Iceberg_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"create\"/>  <SLOT NAME=\"idle\"/>  <SLOT NAME=\"attack\"/>  <FSM SCRIPT=\"Skill_Iceberg_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/ICESHOWER.XML", "<ACTION ID=\"a_IceShower\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Ice_Shower\"/>	<FSM SCRIPT=\"Skill_Ice_Shower\" PROJECTILE_ID=\"PROJECTILE_IceShower\"       FIRE_SOUND_ID=\"Ice_Shower\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/ICESHOWERSA.XML", "<ACTION ID=\"a_IceShowerSA\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Ice_ShowerSA_Fire\"/>	<FSM SCRIPT=\"Skill_Ice_ShowerSA\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/ICYCLE BOLT.XML", "<ACTION ID=\"a_Icycle Bolt\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"IcycleBolt\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/IDLE.XML", "<ACTION ID=\"a_idle\" TYPE=\"IDLE\" NEXT=\"a_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"battle_idle\"/>  <SLOT NAME=\"btlidle_01\"/>  <SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/IDLE02.XML", "<ACTION ID=\"a_idle_02\" TYPE=\"IDLE\" NEXT=\"a_idle_02\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_02\"/>  <SLOT NAME=\"battle_idle\"/>  <SLOT NAME=\"btlidle_01\"/>  <SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/IDLE03.XML", "<ACTION ID=\"a_idle_03\" TYPE=\"IDLE\" NEXT=\"a_idle_03\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_03\"/>  <SLOT NAME=\"battle_idle\"/>  <SLOT NAME=\"btlidle_01\"/>  <SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/IDLE_KOONA.XML", "<ACTION ID=\"a_idle_koona\" TYPE=\"IDLE\" NEXT=\"a_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"carry_idle\"/>  <SLOT NAME=\"carry_idle\"/>  <SLOT NAME=\"carry_idle\"/>  <SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Idle_Bear\"		BAN_USER_INPUT_SC_SKILL=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/IMPACT_PRESSURE.XML", "<ACTION ID=\"a_impact_pressure\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"impact_pressure\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"		HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"		HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"		HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"		HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"				NO_DAMAGE_HOLD=\"TRUE\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/IMPACT_UNSUMMON.XML", "<ACTION ID=\"a_Impact_Unsummon\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"impact_unsummon\"/> 	<FSM SCRIPT=\"Skill_Regain\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"		AUTO_BROADCAST_WHEN_CASTING_COMPLETED = \"FALSE\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_mon_impect_unsummon_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/INCREASEDDEFENCE.XML", "<ACTION ID=\"a_Increased Defence\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"IncDef\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/INCREASED_STATUS.XML", "<ACTION ID=\"a_Increased Status\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"IncStat\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/INFERNO.XML", "<ACTION ID=\"a_inferno\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"inferno_01\"/>	<SLOT NAME=\"inferno_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"inferno_03\" /> <!--   ,     -->	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_sum_skill_smw_inferno_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT3=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT3_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT3_1=\"eff_sum_skill_smw_inferno_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT3_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT3_1=\"1\"						CANCEL_TYPE=\"4\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/INSTANCEHEAL.XML", "<ACTION ID=\"a_Instance Heal\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID =\"ef_skill_InstanceHeal_01_char_root\"              FIRE_CASTER_EFFECT_TARGET_NODE2 = \"char_root\"       FIRE_CASTER_EFFECT_ID2 = \"ef_skill_InstanceHeal_02\"              HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID =\"ef_skill_InstanceHeal_02\"              NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"Heal\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/INTELLUGENT.XML", "<ACTION ID=\"a_Intellugent\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_CASTER_EFFECT_ID=\"ef_Mask_Intelligence_01_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_Mask_Intelligence_02_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       HIT_SOUND_ID=\"Dexterity\"       FIND_TARGET_TYPE=\"SPHERE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/WALTZ.XML", "<ACTION ID=\"a_interactive_waltz\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"Interactive_Emotion_Waltz1\"/>	<SLOT NAME=\"Interactive_Emotion_Waltz1\"/>	<SLOT NAME=\"Interactive_Emotion_Waltz2\"/>	<FSM SCRIPT=\"Interactive_Emotion_SingleStage\" CHECK_SAME_GENDER=\"TRUE\" />	<!----></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/WALTZ2.XML", "<ACTION ID=\"a_interactive_waltz2\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Interactive_Emotion_Waltz1\"/>	<SLOT NAME=\"Interactive_Emotion_Waltz1\"/>	<SLOT NAME=\"Interactive_Emotion_Waltz2\"/>	<FSM SCRIPT=\"Interactive_Emotion_SingleStage2\" CHECK_SAME_GENDER=\"TRUE\"/>	<!-- --></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_DOWN.XML", "<ACTION ID=\"a_intro_down\" NEXT=\"a_intro_idle\">	<SLOT NAME=\"intro_down_01\"/>	<SLOT NAME=\"intro_down_02\"/>	<SLOT NAME=\"intro_down_03\"/>	<SLOT NAME=\"intro_down_04\"/>	<SLOT NAME=\"intro_down_05\"/>	<SLOT NAME=\"intro_down_06\"/>	<SLOT NAME=\"intro_down_07\"/>	<SLOT NAME=\"intro_down_08\"/>	<FSM SCRIPT=\"Act_Intro_Down\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_DOWN_IDLE.XML", "<ACTION ID=\"a_intro_down_idle\" NEXT=\"a_intro_down_idle\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_Intro_Idle\"/>	<SLOT NAME=\"intro_down_idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_IDLE.XML", "<ACTION ID=\"a_intro_idle\" NEXT=\"a_intro_idle\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_Intro_Idle\"/>	<SLOT NAME=\"intro_idle_01\"/>	<SLOT NAME=\"intro_idle_02\"/>	<SLOT NAME=\"intro_idle_03\"/>	<SLOT NAME=\"intro_idle_04\"/>	<SLOT NAME=\"intro_idle_05\"/>	<SLOT NAME=\"intro_idle_06\"/>	<SLOT NAME=\"intro_idle_07\"/>	<SLOT NAME=\"intro_idle_08\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_SELECT.XML", "<ACTION ID=\"a_intro_select\" NEXT=\"a_intro_select_idle\" LOOP=\"true\">	<FSM SCRIPT=\"Act_Intro_Select\"/>	<SLOT NAME=\"intro_select\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_SELECT_BACK.XML", "<ACTION ID=\"a_intro_select_back\" NEXT=\"a_intro_down\">	<SLOT NAME=\"intro_select_back\"/>	<FSM SCRIPT=\"Act_Intro_Select_Back\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_SELECT_IDLE.XML", "<ACTION ID=\"a_intro_select_idle\" NEXT=\"a_intro_select_idle\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_Intro_Select_Idle\"/>	<SLOT NAME=\"intro_select_idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/INTRO_UP.XML", "<ACTION ID=\"a_intro_up\" NEXT=\"a_intro_select\" LOOP=\"true\">	<FSM SCRIPT=\"Act_Intro_Up\"/>	<SLOT NAME=\"intro_up_01\"/>	<SLOT NAME=\"intro_up_02\"/>	<SLOT NAME=\"intro_up_03\"/>	<SLOT NAME=\"intro_up_04\"/>	<SLOT NAME=\"intro_up_05\"/>	<SLOT NAME=\"intro_up_06\"/>	<SLOT NAME=\"intro_up_07\"/>	<SLOT NAME=\"intro_up_08\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/A_JEUS_SKILL.XML", "<ACTION ID=\"a_jeus_skill\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBAXE.XML", "<ACTION ID=\"a_Job_Axe\" NEXT=\"a_Job_Axe_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Lumber_Axe_01\"/>		<SLOT NAME=\"Common_Com_Job_Lumber_Axe_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"		JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Axe\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"\"		JOB_SKILL_EFFECT_ID1=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Axe\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_lumber_axe_02\"		JOB_SKILL_EFFECT_ID2=\"eff_com_job_lumber_axe\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBAXE_END.XML", "<ACTION ID=\"a_Job_Axe_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Lumber_Axe_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\" 				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Axe\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"\"		JOB_SKILL_EFFECT_ID3=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBCHAINSAW.XML", "<ACTION ID=\"a_Job_Chainsaw\" NEXT=\"a_Job_Chainsaw_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Lumber_Chainsaw_01\"/>		<SLOT NAME=\"Common_Com_Job_Lumber_Chainsaw_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"			JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Chainsaw_01\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"job_lumber_chainsaw_01\"		JOB_SKILL_EFFECT_ID1=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Chainsaw_02\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_lumber_chainsaw_02\"		JOB_SKILL_EFFECT_ID2=\"\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"\"				JOB_SKILL_CRITICAL_EFFECT_ID=\"eff_etc_change_00\"		JOB_SKILL_CRITICAL_TARGET_NODE=\"char_root\"		JOB_SKILL_CRITICAL_SOUND=\"job-cri\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBCHAINSAW_END.XML", "<ACTION ID=\"a_Job_Chainsaw_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Lumber_Chainsaw_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\"			JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Chainsaw_03\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"job_lumber_chainsaw_03\"		JOB_SKILL_EFFECT_ID3=\"\"		JOB_SKILL_EFFECT_TARGET_NODE3=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBCOMMON.XML", "<ACTION ID=\"a_job_common\" NEXT=\"a_idle\">		<SLOT NAME=\"idle_01\"/>		<FSM SCRIPT=\"Link_JobSkill\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBDRILL.XML", "<ACTION ID=\"a_Job_Drill\" NEXT=\"a_Job_Drill_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Mining_Drill_01\"/>		<SLOT NAME=\"Common_Com_Job_Mining_Drill_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"			JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Drill_01\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"job_mining_drill__01\"		JOB_SKILL_EFFECT_ID1=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Drill_02\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_mining_drill__02\"		JOB_SKILL_EFFECT_ID2=\"eff_com_job_mining_drill\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"char_root\"				JOB_SKILL_CRITICAL_EFFECT_ID=\"eff_etc_change_00\"		JOB_SKILL_CRITICAL_TARGET_NODE=\"char_root\"		JOB_SKILL_CRITICAL_SOUND=\"job-cri\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBDRILL_END.XML", "<ACTION ID=\"a_Job_Drill_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Mining_Drill_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\"				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Drill_03\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"job_mining_drill__03\"		JOB_SKILL_EFFECT_ID3=\"\"		JOB_SKILL_EFFECT_TARGET_NODE3=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBFISHING.XML", "<ACTION ID=\"a_Job_Fishing\" NEXT=\"a_Job_Fishing_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Fishing_Fishing_01\"/>		<SLOT NAME=\"Common_Com_Job_Fishing_Fishing_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"				JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Fishing_01\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"job_fishing_fishing_01\"		JOB_SKILL_EFFECT_ID1=\"eff_com_job_fishing_fishing_start\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"char_root\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Fishing_02\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_fishing_fishing_02\"		JOB_SKILL_EFFECT_ID2=\"eff_com_job_fishing_fishing_loop\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBFISHING_END.XML", "<ACTION ID=\"a_Job_Fishing_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Fishing_Fishing_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\" 				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Fishing_03\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"job_fishing_fishing_03\"		JOB_SKILL_EFFECT_ID3=\"eff_com_job_fishing_fishing_finish\"		JOB_SKILL_EFFECT_TARGET_NODE3=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBFISHNET.XML", "<ACTION ID=\"a_Job_FishNet\" NEXT=\"a_Job_FishNet_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Fishing_Net_01\"/>		<SLOT NAME=\"Common_Com_Job_Fishing_Net_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"			JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_FishingNet_01\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"job_fishing_net_01\"		JOB_SKILL_EFFECT_ID1=\"eff_com_job_fishing_net_start\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"char_root\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_FishingNet_02\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_fishing_net_02\"		JOB_SKILL_EFFECT_ID2=\"eff_com_job_fishing_net_loop\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"char_root\"				JOB_SKILL_CRITICAL_EFFECT_ID=\"eff_etc_change_00\"		JOB_SKILL_CRITICAL_TARGET_NODE=\"char_root\"		JOB_SKILL_CRITICAL_SOUND=\"job-cri\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBFISHNET_END.XML", "<ACTION ID=\"a_Job_FishNet_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Fishing_Net_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\" 				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_FishingNet_03\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"job_fishing_net_03\"		JOB_SKILL_EFFECT_ID3=\"eff_com_job_fishing_net_finish\"		JOB_SKILL_EFFECT_TARGET_NODE3=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBHOE.XML", "<ACTION ID=\"a_Job_Hoe\" NEXT=\"a_Job_Hoe_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Gather_Hoe_01\"/>		<SLOT NAME=\"Common_Com_Job_Gather_Hoe_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"				JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Hoe\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"\"		JOB_SKILL_EFFECT_ID1=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Hoe\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_gather_hoe_02\"		JOB_SKILL_EFFECT_ID2=\"eff_com_job_gather_hoe\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBHOE_END.XML", "<ACTION ID=\"a_Job_Hoe_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Gather_Hoe_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\" 				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Hoe\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"\"		JOB_SKILL_EFFECT_ID3=\"\"		JOB_SKILL_EFFECT_TARGET_NODE3=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBPICK.XML", "<ACTION ID=\"a_Job_Pick\" NEXT=\"a_Job_Pick_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Mining_Pick_01\"/>		<SLOT NAME=\"Common_Com_Job_Mining_Pick_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"			JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Pick\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"\"		JOB_SKILL_EFFECT_ID1=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Pick\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_mining_pick_02\"		JOB_SKILL_EFFECT_ID2=\"eff_com_job_mining_pick\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBPICK_END.XML", "<ACTION ID=\"a_Job_Pick_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Mining_Pick_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\" 				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Pick\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"\"		JOB_SKILL_EFFECT_ID3=\"\"		JOB_SKILL_EFFECT_TARGET_NODE3=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBWEEDER.XML", "<ACTION ID=\"a_Job_Weeder\" NEXT=\"a_Job_Weeder_End\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">		<SLOT NAME=\"Common_Com_Job_Gather_Weeder_01\"/>		<SLOT NAME=\"Common_Com_Job_Gather_Weeder_02\"/>	<FSM SCRIPT=\"JobSkill_Begin\"			JOB_SKILL_TOOL_EFFECT_ID1=\"ef_Job_Weeder_01\"		JOB_SKILL_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND1=\"job_gather_weeder_01\"		JOB_SKILL_EFFECT_ID1=\"\"		JOB_SKILL_EFFECT_TARGET_NODE1=\"\"				JOB_SKILL_TOOL_EFFECT_ID2=\"ef_Job_Weeder_02\"		JOB_SKILL_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND2=\"job_gather_weeder_02\"		JOB_SKILL_EFFECT_ID2=\"\"		JOB_SKILL_EFFECT_TARGET_NODE2=\"\"				JOB_SKILL_CRITICAL_EFFECT_ID=\"eff_etc_change_00\"		JOB_SKILL_CRITICAL_TARGET_NODE=\"char_root\"		JOB_SKILL_CRITICAL_SOUND=\"job-cri\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/JOBSKILL/JOBWEEDER_END.XML", "<ACTION ID=\"a_Job_Weeder_End\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"JOB_SKILL\">	<SLOT NAME=\"Common_Com_Job_Gather_Weeder_03\"/>	<SLOT NAME=\"Common_Com_Job_Gain\"/>	<FSM SCRIPT=\"JobSkill_End\" 				JOB_SKILL_TOOL_EFFECT_ID3=\"ef_Job_Weeder_03\"		JOB_SKILL_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		JOB_SKILL_TOOL_SOUND3=\"job_gather_weeder_03\"		JOB_SKILL_EFFECT_ID3=\"\"				JOB_SKILL_EFFECT_TARGET_NODE3=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/JOINTBREAK.XML", "<ACTION ID=\"a_Joint Break\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_skill_JointBreak_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"Onehand_skill_JointBreak_01_char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       NO_WEAPON_TRAIL=\"TRUE\"       FIRE_SOUND_ID=\"Jointbreak_Start\"       WEAPON_XML=\"Item/Common/12_Weapon/09_special/comic_bat.xml\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/JUDGEDREAD.XML", "<ACTION ID=\"a_Judge Dread\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" >	<SLOT NAME=\"Com_skill_JudgeDread_01\"/>	<FSM SCRIPT=\"Skill_JudgeDread\"       FIRE_CASTER_EFFECT_TARGET_NODE =\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_JudgeDread_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/JUMP.XML", "<ACTION ID=\"a_jump\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\" CHECK_CAN_ENTER =\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"jump_01\"/>	<SLOT NAME=\"jump_02\"/>	<SLOT NAME=\"jump_03\"/>	<SLOT NAME=\"jump_04\"/>	<FSM SCRIPT=\"Act_Jump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/JUMP_KOONA.XML", "<ACTION ID=\"a_jump_koona\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\" CHECK_CAN_ENTER =\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"carry_jump_01\"/>	<SLOT NAME=\"carry_jump_02\"/>	<SLOT NAME=\"carry_jump_03\"/>	<SLOT NAME=\"carry_jump_04\"/>		<FSM SCRIPT=\"Act_Jump_Bear\"		BAN_USER_INPUT_SC_SKILL=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/JUMP_SHOT.XML", "<ACTION ID=\"a_jump_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_Jump_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KEEPING_WATER.XML", "<ACTION ID=\"a_keeping_water\" NEXT=\"a_keeping_water\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"up_01\"/>	<SLOT NAME=\"up_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"dmg_01\"/>	<FSM SCRIPT=\"Act_KeepingWater\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/FALLINGLEAF.XML", "<ACTION ID=\"a_Killing Mist01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_FallingLeaf_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        CASTING_EFFECT_TARGET_NODE =\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_metamorphosis_skill_fallingleaf_01\"	   DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"	   CASTING_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"         MULTI_HIT_NUM=\"3\"       NO_WEAPON_TRAIL=\"TRUE\"       NO_DAMAGE_HOLD=\"TRUE\"      /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/KNIGHT_BROSPIN.XML", "<ACTION ID=\"a_Knight_Bro_Spin\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Special_Skill_Shot\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/KNIGHT_BROSPINFIRE.XML", "<ACTION ID=\"a_Knight_Bro_Spin_Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"skill_04\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_Knight_Bro_Spin_Fire\" FIRE_SOUND_ID=\"Singha_Spin\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/KNI_DASHDOWNBLOW.XML", "<ACTION ID=\"a_kni_dashdownblow\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"Onehand_jump_dash_attk_01\"/>  <SLOT NAME=\"jump_down_attk_up\"/>  <FSM SCRIPT=\"Skill_DashDownBlow\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KNOCKBACK_DOWN.XML", "<ACTION ID=\"a_knockback_down\" TYPE=\"EFFECT\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET = \"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Down\"/>  <SLOT NAME=\"StandUp\"/>  <FSM SCRIPT=\"Act_knockback_down\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KNOCKDOWN.XML", "<ACTION ID=\"a_knockdown\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"knockdown_01\"/>	<SLOT NAME=\"knockdown_up\"/>	<FSM SCRIPT=\"Act_Knockdown\"/>></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KNOCKBACK.XML", "<ACTION ID=\"a_knock_back\" TYPE=\"EFFECT\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET = \"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <SLOT NAME=\"StandUp\"/>  <FSM SCRIPT=\"Act_KnockBack\" VELOCITY=\"80\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KNOCKBACKSMALL.XML", "<ACTION ID=\"a_knock_back_small\" TYPE=\"EFFECT\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET = \"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KOH_AREA_BOMB.XML", "<ACTION ID=\"a_KOH_area_bomb\" TYPE=\"IDLE\" NEXT=\"a_battle_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"KOH_area_bomb_start\"/>  	<FSM SCRIPT=\"Skill_KOH_area_bomb\" 		USE_TLM=\"FALSE\"		CANCEL_TYPE=\"0\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KOH_GUARDIAN_CHANGE_BLUE.XML", "<ACTION ID=\"a_KOH_guardian_change_blue\" TYPE=\"IDLE\" NEXT=\"a_battle_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"KOH_guardian_change_blue\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/KOH_GUARDIAN_CHANGE_RED.XML", "<ACTION ID=\"a_KOH_guardian_change_red\" TYPE=\"IDLE\" NEXT=\"a_battle_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"KOH_guardian_change_red\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/KOZAKSDANCE.XML", "<ACTION ID=\"a_Kozaks Dance\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       INSTALL_EFFECT_ID=\"ef_KazaksDance_02_char_root\"       INSTALL_EFFECT_TARGET_NODE=\"char_root\"       HIT_SOUND_ID=\"Cossack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/KOZAKSDANCE_FIRE.XML", "<ACTION ID=\"a_Kozaks Dance Fire\" NEXT=\"a_idle\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Energy_Ball_Play\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LADDER_DASH.XML", "<ACTION ID=\"a_ladder_dash\" CAN_FOLLOW=\"TRUE\" NEXT=\"a_ladder_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"ladder_up\"/>	<FSM SCRIPT=\"Act_Ladder_Dash\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LADDER_DOWN.XML", "<ACTION ID=\"a_ladder_down\" NEXT=\"a_ladder_idle\" CAN_FOLLOW=\"TRUE\" LOOP=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"ladder_down\"/>	<FSM SCRIPT=\"Act_Ladder\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LADDER_IDLE.XML", "<ACTION ID=\"a_ladder_idle\" NEXT=\"a_ladder_idle\" CAN_FOLLOW=\"TRUE\" TYPE=\"IDLE\" LOOP=\"TRUE\">	<SLOT NAME=\"ladder_idle\"/>	<FSM SCRIPT=\"Act_Ladder_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LADDER_UP.XML", "<ACTION ID=\"a_ladder_up\" NEXT=\"a_ladder_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"ladder_up\"/>	<FSM SCRIPT=\"Act_Ladder\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/LAUGH.XML", "<ACTION ID=\"a_laugh\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_laugh_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_APPEAR.XML", "<ACTION ID=\"a_lavalon_appear\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"opening_01\"/>	<FSM SCRIPT=\"Act_LAVALON_Appear\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_BLAZE.XML", "<ACTION ID=\"a_lavalon_blaze\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"attk_start_L\"/>	<SLOT NAME=\"attk_loop_L\"/>	<SLOT NAME=\"attk_shot_L\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_LAVALON_Blaze\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_BREATH_C.XML", "<ACTION ID=\"a_lavalon_breath_c\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"firebreath_01\"/>	<FSM SCRIPT=\"Act_LAVALON_breath_c\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_BREATH_L.XML", "<ACTION ID=\"a_lavalon_breath_l\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"fireturn_Left\"/>	<FSM SCRIPT=\"Act_LAVALON_breath_l\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_BREATH_R.XML", "<ACTION ID=\"a_lavalon_breath_r\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"fireturn_Right\"/>	<FSM SCRIPT=\"Act_LAVALON_breath_r\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_DIE.XML", "<ACTION ID=\"a_lavalon_die\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"die_01\"/>	<FSM SCRIPT=\"Act_LAVALON_Die\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_DMG_01.XML", "<ACTION ID=\"a_lavalon_dmg_01\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"dmg_01\"/>	<SLOT NAME=\"powerbreak_01\"/>	<FSM SCRIPT=\"Act_LAVALON_Dmg\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_HEART_DIE.XML", "<ACTION ID=\"a_lavalon_heart_die\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"die_01\"/>	<FSM SCRIPT=\"Act_LAVALON_HEART_Die\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_HEART_METEOR.XML", "<ACTION ID=\"a_lavalon_heart_meteor\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"a_idle\"/>	<FSM SCRIPT=\"Act_LAVALON_HEART_METEOR\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_HEART_METEOR_BLUE.XML", "<ACTION ID=\"a_lavalon_heart_meteor_blue\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"a_idle\"/>	<FSM SCRIPT=\"Act_LAVALON_HEART_METEOR_BLUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/LAVALON_POWERBREAK.XML", "<ACTION ID=\"a_lavalon_powerbreak\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"powerbreak_start\"/>	<SLOT NAME=\"powerbreak_loop\"/>	<SLOT NAME=\"powerbreak_shot\"/>	<FSM SCRIPT=\"Act_LAVALON_Powerbreak\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/LAZER_PET.XML", "<ACTION ID=\"a_lazer_pet\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>	<!--SLOT NAME=\"btlidle_01_shot_start\"/-->	<SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"CommonSkillAction\"       ATTACH_NODE_ID=\"p_ef_fire\"       HIT_SOUND_ID=\"pingmao-skill-fire_ball_pet\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/LIE.XML", "<ACTION ID=\"a_lie\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"lie_down\"/>	<SLOT NAME=\"lie_idle\"/>	<SLOT NAME=\"lie_up\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LIE_DOWN.XML", "<ACTION ID=\"a_lie_down\" NEXT=\"a_idle\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"lie_down\"/>	<SLOT NAME=\"lie_idle\"/>	<SLOT NAME=\"lie_up\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTINGSTORM.XML", "<ACTION ID=\"a_Lighting_Storm\" NEXT=\"a_Lighting_Storm2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Staff_skill_LightningStorm_01_01\" />  <SLOT NAME=\"Staff_skill_LightningStorm_01_02\" />  <FSM SCRIPT=\"Skill_Lighting_Storm\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_lightingstorm_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_lightingstorm_03_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       FIRE_SOUND_ID=\"LightningStorm\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       HIT_TARGET_EFFECT_ID=\"ef_skill_lightingstorm_02_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TIMER_TIME=\"4\"       HIT_TIMER_TICK=\"0.35\"	   	   CASTING_SOUND_ID_MALE=\"Male_LightningStorm\"	   CASTING_SOUND_ID_FEMALE=\"Female_LightningStorm\"	   MULTIPLE_ATTACK=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTINGSTORMFINISH.XML", "<ACTION ID=\"a_Lighting_Storm2\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\"  ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Staff_skill_LightningStorm_01_03\" />  <FSM SCRIPT=\"Skill_Lighting_Storm_Finish\"              HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_skill_lightingstorm_02_char_root\"              CHECK_CAN_PREV_ACTION_ID=\"a_Lighting_Storm\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/LIGHTNINGSLASH.XML", "<ACTION ID=\"a_Lightning Slash\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Com_skill_LightningSlash_01\"/>  <SLOT NAME=\"Com_skill_LightningSlash_02\"/>  <FSM SCRIPT=\"Skill_Lightning_Slash\"       HIT_SOUND_ID=\"LightningSlash\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTNINGMARGNET.XML", "<ACTION ID=\"a_LightningMargnet\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_lightning_margnet\"/>	<FSM SCRIPT=\"Skill_InstallDefault\"      CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"      CASTING_EFFECT_EFFECT_ID=\"ef_skill_lightingmagnet_02_char_root\"      DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTNINGMARGNETPLAY.XML", "<ACTION ID=\"a_LightningMargnetPlay\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"Lighting_MargnetSA_01\"/>	<SLOT NAME=\"Lighting_MargnetSA_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Lighting_MargnetSA_03\"/>	<FSM SCRIPT=\"Skill_LightningMargnetPlay\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/LIGHTNINGMARGNETSA.XML", "<ACTION ID=\"a_LightningMargnetSA\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Skill_LightningMargnetSA\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/LIGHTNINGARMOR.XML", "<ACTION ID=\"a_lightning_armor\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Com_Skill_LightnigArmor_01\"/>  <SLOT NAME=\"Com_Skill_LightnigArmor_02\"/>  <FSM SCRIPT=\"ShoulderTackle\" FIRE_SOUND_ID=\"LightningArmor\"       HIT_TARGET_EFFECT_ID=\"ef_Lightningamor_02_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LIGHTNING_DMG.XML", "<ACTION ID=\"a_lightning_default\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\">  <SLOT NAME=\"dmg_01\"/>  <SLOT NAME=\"dmg_02\"/>  <FSM SCRIPT=\"Lightning_Default_Dmg\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LIGHTNINGFLOATDMG.XML", "<ACTION ID=\"a_lightning_float_dmg\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_BlowUp\" VELOCITY=\"21\" NO_HORI_MOVE=\"TRUE\" LIGHTNING_DMG=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LIGHTNING_DMG_LOW.XML", "<ACTION ID=\"a_lightning_low\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\">  <SLOT NAME=\"dmg_01\"/>  <SLOT NAME=\"dmg_02\"/>  <FSM SCRIPT=\"Lightning_Default_Dmg\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LIGHTNINGTHROWDOWN.XML", "<ACTION ID=\"a_lightning_throw_down\"  TYPE=\"EFFECT\" NEXT=\"a_idle\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_ThrowDown\" VELOCITY=\"-50\" LIGHTNING_DMG=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/LIONSCRYING.XML", "<ACTION ID=\"a_lions_crying\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_Pet_sajahu_01_p_ef_heart\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_heart\"	   FIRE_CASTER_EFFECT_SCALE_NORMALIZE=\"133.33\"	          FIRE_CASTER_EFFECT_ID2=\"ef_lion_roar_00_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"	   FIRE_CASTER_EFFECT_SCALE_NORMALIZE2=\"133.33\"       FIRE_SOUND_ID=\"leo-skill-lion_roar\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/LIONSTOOTH.XML", "<ACTION ID=\"a_lions_tooth\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_Pet_buf_03_p_ef_star\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_star\"       NO_DEFAULT_HIT_EFFECT=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/LOCK_MOVE.XML", "<ACTION ID=\"a_lock_move\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" TYPE=\"IDLE\">	<SLOT NAME=\"idle_01\" LOOP = \"TRUE\" />	<SLOT NAME=\"ride_01\" LOOP = \"TRUE\" />	<FSM SCRIPT=\"Act_Lock_Move\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/LOVE.XML", "<ACTION ID=\"a_love\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_love_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/LUCKYSTRIKE.XML", "<ACTION ID=\"a_lucky_strike\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_Pet_buf_02_p_ef_star\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_star\"       NO_DEFAULT_HIT_EFFECT=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/MAGCICANNON_SHOT.XML", "<ACTION ID=\"a_magcicannon_shot\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\"><!--ACTION ID=\"a_magcicannon_shot\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"-->	<SLOT NAME=\"shot_magiccannon_01\"/>	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"MagicCannon_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/MAGEFLOATSHOT_01.XML", "<ACTION ID=\"a_magefloatshot_01\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/MAGEFLOATSHOT_02.XML", "<ACTION ID=\"a_magefloatshot_02\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/MAGEFLOATSHOT_03.XML", "<ACTION ID=\"a_magefloatshot_03\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/MAGE_DOWN_SHOT.XML", "<ACTION ID=\"a_mage_down_shot\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_down_attk\"/>  <FSM SCRIPT=\"Mage_Down_Shot\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\" ATTACH_NODE=\"p_wp_r_hand\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"Projectile_Magician_Down_Shot\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"e_skill_reverse_gravity_mon_fallen\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/MAGICMISSILE.XML", "<ACTION ID=\"a_Magic Missile\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_05\"/>  <FSM SCRIPT=\"MagicMissle\" PROJECTILE_ID=\"PROJECTILE_MAGIC_MISSILE\"       HIT_SOUND_ID=\"MagicMissile\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/LAVALON/MAGICCANNON_ONLYCAST.XML", "<ACTION ID=\"a_magiccannon_only_cast\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"mgacicannon_onlycast_start_01\"/>	<SLOT NAME=\"mgacicannon_onlycast_idle_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_MagicCannon_OnlyCast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIANFLOATSHOT_01.XML", "<ACTION ID=\"a_MagicianFloatShot_01\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIANFLOATSHOT_02.XML", "<ACTION ID=\"a_MagicianFloatShot_02\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIANFLOATSHOT_03.XML", "<ACTION ID=\"a_MagicianFloatShot_03\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIANSHOT_01.XML", "<ACTION ID=\"a_MagicianShot_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" MONITOR=\"TRUE\">	<SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"MagicianShot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_CHARGEATTACK.XML", "<ACTION ID=\"a_magician_charge_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Skill_Magician_Charge_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_CHARGELASER.XML", "<ACTION ID=\"a_magician_charge_laser\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Cold_Burst_01\"/>  <FSM SCRIPT=\"Skill_Magician_Charge_Laser\" HIT_SOUND_ID=\"ChargedAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_DASHATTACK.XML", "<ACTION ID=\"a_magician_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dash_attk_01\"/>  <FSM SCRIPT=\"Skill_Dash_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_DOWN_SHOT.XML", "<ACTION ID=\"a_magician_down_shot\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_down_attk\"/>  <FSM SCRIPT=\"Magician_Down_Shot\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\" ATTACH_NODE=\"p_wp_r_hand\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"Projectile_Magician_Down_Shot\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"e_skill_reverse_gravity_mon_fallen\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIANFRIENDSHIP.XML", "<ACTION ID=\"a_Magician_Friendship\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"FriendShipBuff\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_magicion_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_JUMP_SHOT.XML", "<ACTION ID=\"a_magician_jump_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Skill_Jump_Shot\" PROJECTILE_ID=\"PROJECTILE_MAGICIAN_DEFAULT_SHOT\" ATTACH_NODE=\"p_wp_l_hand\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/MAGIC_ADD.XML", "<ACTION ID=\"a_magic_add\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MAGIC_JAIL.XML", "<ACTION ID=\"a_magic_jail\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"magic_jail_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"magic_jail_fire\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"							EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_stone_jail_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				NO_DAMAGE_HOLD=\"TRUE\"	/>		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MAGIC_SHIELD.XML", "<ACTION ID=\"a_magic_shield\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"magic_shield_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"magic_shield_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\"	USE_TLM=\"TRUE\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"	EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_stone_guard_00\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"	EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"		EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"	EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_smw_stone_guard_02\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MAGIC_TRAP.XML", "<ACTION ID=\"a_magic_trap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"magic_trap_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"magic_trap_fire\"/>    <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_mon_mana_burn_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"CLEAN_UP\"				CANCEL_TYPE =\"1\"				NO_DAMAGE_HOLD=\"TRUE\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/MAGMAPISTON.XML", "<ACTION ID=\"a_MagmaPiston\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"skill_summon_01_01\"/>  <SLOT NAME=\"skill_summon_01_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"skill_summon_01_03\"/>  <FSM SCRIPT=\"Skill_WarLord_MagmaPiston\"       CASTING_EFFECT_EFFECT_ID=\"\"       CASTING_EFFECT_TARGET_NODE=\"\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_magmapiston_03_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_SOUND_ID=\"MagmaPiston\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/A_MAGMAPISTON_ATTACK.XML", "<ACTION ID=\"a_MagmaPiston_attack\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_MagmaPiston_attack\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_magmapiston_01\"	   FIRE_CASTER_EFFECT_TARGET_NODE=\"Rectangle02\"	   HIT_SOUND_ID=\"Mon_dmg_01\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/A_MAGMAPISTON_PLAY.XML", "<ACTION ID=\"a_MagmaPiston_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"MagmaPiston_Skill_01_start\"/>  <SLOT NAME=\"MagmaPiston_Skill_01_attack\" LOOP=\"TRUE\"/>/>  <SLOT NAME=\"MagmaPiston_Skill_01_finish\"/>  <FSM SCRIPT=\"Skill_MagmaPiston_play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/MAGNUMBREAK.XML", "<ACTION ID=\"a_Magnum Break\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Twohand_skill_MagnumBreak_01\"/>  <FSM SCRIPT=\"Skill_MagnumBreak\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/MAGDOUBLESHOT.XML", "<ACTION ID=\"a_mag_doubleshot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"slow_shot_01\"/>  <FSM SCRIPT=\"MagMultiShot\" FIRE_COUNT=\"2\" PROJECTILE_ID=\"PROJECTILE_MAGICIAN_DEFAULT_SHOT\" HIT_SOUND_ID=\"Stf_ThreeShot1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAG_DOWNATTACK_01.XML", "<ACTION ID=\"a_mag_down_attack_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAG_DOWNATTACK_02.XML", "<ACTION ID=\"a_mag_down_attack_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAG_DOWNATTACK_03.XML", "<ACTION ID=\"a_mag_down_attack_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_03\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAG_DOWNATTACK_FLY.XML", "<ACTION ID=\"a_mag_down_attack_fly\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\"  CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_fly\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/MAG_MELEE_01.XML", "<ACTION ID=\"a_mag_melee_01\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/MAG_MELEE_02.XML", "<ACTION ID=\"a_mag_melee_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_02\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/MAG_MELEE_03.XML", "<ACTION ID=\"a_mag_melee_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_03\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_CHANGEMAHALKA.XML", "<ACTION ID=\"a_Mahalka_atk\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/MANABURN.XML", "<ACTION ID=\"a_Mana Burn\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/MANABURN_PLAY.XML", "<ACTION ID=\"a_Mana Burn_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Trap_Play\" TYPE=\"BOMB\"	   TRANSFORM_EFFECT_ID=\"ef_dust_01\"       TRANSFORM_EFFECT_TARGET_NODE_POS=\"Dummy01\"	   TRANSFORM_SOUND_ID=\"Needle_Trap_01\"	   	   TARGET_SCALE=\"0.5\"	   TARGET_SCALE_TIME=\"1000\"	     /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_MANA_SHIELD.XML", "<ACTION ID=\"a_Mana Shield\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\"/>  <SLOT NAME=\"Com_Shot_02\"/>  <FSM SCRIPT=\"Skill_Mana_Shield\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MANA_BURN.XML", "<ACTION ID=\"a_mana_burn\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"mana_burn_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"mana_burn_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_mon_mana_burn_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_mon_mana_burn_03\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MANUFACTURE/MANCOOK.XML", "<ACTION ID=\"a_Man_Cook\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" >		<SLOT NAME=\"Common_Com_Work_Cook_Start\"/>		<SLOT NAME=\"Common_Com_Work_Cook_Work\"/>	<SLOT NAME=\"Common_Com_Work_Cook_Success\"/>	<SLOT NAME=\"Common_Com_Work_Cook_Fail\"/>	<FSM SCRIPT=\"Manufacture\"		MANUFACTURE_TOOL_EFFECT_ID1=\"eff_com_work_cook_02_all\"		MANUFACTURE_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND1=\"work_cook_start\"		MANUFACTURE_EFFECT_ID1=\"eff_com_work_cook_03_start\"		MANUFACTURE_EFFECT_TARGET_NODE1=\"char_root\"				MANUFACTURE_TOOL_EFFECT_ID2=\"eff_com_work_cook_02_all\"		MANUFACTURE_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND2=\"work_cook_ing\"		MANUFACTURE_EFFECT_ID2=\"eff_com_work_cook_03_work\"		MANUFACTURE_EFFECT_TARGET_NODE2=\"char_root\"		MANUFACTURE_TOOL_EFFECT_ID3=\"eff_com_work_cook_02_all\"		MANUFACTURE_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND3=\"work_success\"		MANUFACTURE_EFFECT_ID3=\"eff_com_work_cook_03_work\"		MANUFACTURE_EFFECT_TARGET_NODE3=\"char_root\"		MANUFACTURE_TOOL_EFFECT_ID4=\"eff_com_work_cook_02_all\"		MANUFACTURE_TOOL_TARGET_NODE4=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND4=\"work_fail\"		MANUFACTURE_EFFECT_ID4=\"eff_com_work_cook_03_work\"		MANUFACTURE_EFFECT_TARGET_NODE4=\"char_root\"		HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MANUFACTURE/MANSPELL.XML", "<ACTION ID=\"a_Man_Spell\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" >		<SLOT NAME=\"Common_Com_Work_Spell_01_Start\"/>		<SLOT NAME=\"Common_Com_Work_Spell_01_Work\"/>	<SLOT NAME=\"Common_Com_Work_Spell_01_Success\"/>	<SLOT NAME=\"Common_Com_Work_Spell_01_Fail\"/>	<FSM SCRIPT=\"Manufacture\"		MANUFACTURE_TOOL_EFFECT_ID1=\"\"		MANUFACTURE_TOOL_TARGET_NODE1=\"\"		MANUFACTURE_TOOL_SOUND1=\"work_spell_start\"		MANUFACTURE_EFFECT_ID1=\"\"		MANUFACTURE_EFFECT_TARGET_NODE1=\"\"				MANUFACTURE_TOOL_EFFECT_ID2=\"eff_com_work_spell_01_work\"		MANUFACTURE_TOOL_TARGET_NODE2=\"Bip01 L Hand\"		MANUFACTURE_TOOL_SOUND2=\"work_spell_ing\"		MANUFACTURE_EFFECT_ID2=\"\"		MANUFACTURE_EFFECT_TARGET_NODE2=\"\"		MANUFACTURE_TOOL_EFFECT_ID3=\"eff_com_work_spell_01_success\"		MANUFACTURE_TOOL_TARGET_NODE3=\"Bip01 L Hand\"		MANUFACTURE_TOOL_SOUND3=\"work_success\"		MANUFACTURE_EFFECT_ID3=\"\"		MANUFACTURE_EFFECT_TARGET_NODE3=\"\"		MANUFACTURE_TOOL_EFFECT_ID4=\"eff_com_work_spell_01_fail\"		MANUFACTURE_TOOL_TARGET_NODE4=\"Bip01 L Hand\"		MANUFACTURE_TOOL_SOUND4=\"work_fail\"		MANUFACTURE_EFFECT_ID4=\"\"		MANUFACTURE_EFFECT_TARGET_NODE4=\"\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MANUFACTURE/MANWORKMANSHIP.XML", "<ACTION ID=\"a_Man_Workmanship\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" >		<SLOT NAME=\"Common_Com_Work_Workmanship_Start\"/>		<SLOT NAME=\"Common_Com_Work_Workmanship_Work\"/>	<SLOT NAME=\"Common_Com_Work_Workmanship_Success\"/>	<SLOT NAME=\"Common_Com_Work_Workmanship_Fail\"/>	<FSM SCRIPT=\"Manufacture\"		MANUFACTURE_TOOL_EFFECT_ID1=\"eff_com_work_carve_02_all\"		MANUFACTURE_TOOL_TARGET_NODE1=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND1=\"work_workmanship_start\"		MANUFACTURE_EFFECT_ID1=\"eff_com_work_carve_03_start\"		MANUFACTURE_EFFECT_TARGET_NODE1=\"char_root\"				MANUFACTURE_TOOL_EFFECT_ID2=\"eff_com_work_carve_02_all\"		MANUFACTURE_TOOL_TARGET_NODE2=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND2=\"work_workmanship_ing\"		MANUFACTURE_EFFECT_ID2=\"eff_com_work_carve_03_work\"		MANUFACTURE_EFFECT_TARGET_NODE2=\"char_root\"		MANUFACTURE_TOOL_EFFECT_ID3=\"eff_com_work_carve_02_all\"		MANUFACTURE_TOOL_TARGET_NODE3=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND3=\"work_success\"		MANUFACTURE_EFFECT_ID3=\"eff_com_work_carve_03_success\"		MANUFACTURE_EFFECT_TARGET_NODE3=\"char_root\"		MANUFACTURE_TOOL_EFFECT_ID4=\"eff_com_work_carve_02_all\"		MANUFACTURE_TOOL_TARGET_NODE4=\"p_pt_r_hand\"		MANUFACTURE_TOOL_SOUND4=\"work_fail\"		MANUFACTURE_EFFECT_ID4=\"eff_com_work_carve_03_fail\"		MANUFACTURE_EFFECT_TARGET_NODE4=\"char_root\"				HIDE_WEAPON=\"TRUE\"		NO_WEAPON_TRAIL=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MAPMOVE.XML", "<ACTION ID=\"a_mapmove\" NEXT=\"a_idle\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_MapMove\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/MARIONETTE.XML", "<ACTION ID=\"a_Marionette\" NEXT=\"a_Marionette_Finish\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Claw_skill_Marionette_01\"/>	<SLOT NAME=\"Claw_skill_Marionette_02\"/>	<SLOT NAME=\"Claw_skill_Marionette_03\"/>	<SLOT NAME=\"Claw_skill_Marionette_03\"/>	<FSM SCRIPT=\"Skill_Maniac_Marionette\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_hell_shouting_01_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_marionette_01_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		NO_DAMAGE_HOLD=\"TRUE\"		MULTI_HIT_NUM=\"14\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/MARIONETTESA.XML", "<ACTION ID=\"a_MarionetteSA\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Marionette_skill_01\"/>  <SLOT NAME=\"Marionette_skill_02\"/>  <SLOT NAME=\"Marionette_skill_03\"/>  <SLOT NAME=\"Marionette_skill_03\"/>  <SLOT NAME=\"Marionette_skill_04\"/>  <FSM SCRIPT=\"Skill_Maniac_MarionetteSA\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MANIAC/MARIONETTE_FINISH.XML", "<ACTION ID=\"a_Marionette_Finish\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Claw_skill_Marionette_04\"/>  <FSM SCRIPT=\"Skill_Maniac_Marionette_Finish\"       CASTING_EFFECT_EFFECT_ID=\"\"       CASTING_EFFECT_TARGET_NODE=\"\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_marionette_02\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_SOUND_ID=\"Marrionette_03\"	   NO_DAMAGE_HOLD=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MEAL.XML", "<ACTION ID=\"a_meal\" NEXT=\"a_PetUIIdle\" >	<SLOT NAME=\"meal\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MEGADRILL.XML", "<ACTION ID=\"a_MegaDrill\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Com_skill_Headspin_01\"/>  <SLOT NAME=\"Com_skill_Headspin_02\"/>  <SLOT NAME=\"Com_skill_Headspin_03\"/>  <FSM SCRIPT=\"Skill_MegaDrill\"       HIT_SOUND_ID=\"headspin\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MEGA_INFERNO.XML", "<ACTION ID=\"a_mega_inferno\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"mega_inferno_01\"/>	<SLOT NAME=\"mega_inferno_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"mega_inferno_03\" /> <!--   ,     -->	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"							EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_sum_skill_mon_mega_inferno_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT3=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT3_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT3_1=\"eff_sum_skill_mon_mega_inferno_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT3_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT3_1=\"1\"				CANCEL_TYPE=\"4\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MEGA_SPARK_WAVE_CAST.XML", "<ACTION ID=\"a_mega_spark_wave_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">		<SLOT NAME=\"mega_spark_wave_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"mega_spark_wave_fire\"/>    <FSM SCRIPT=\"CommonSkillAction\"		USE_TLM=\"FALSE\"		HIDE_WEAPON_WHEN_ANI_SLOT0=\"TRUE\"					/>			</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MEGA_SPARK_WAVE_FIRE.XML", "<ACTION ID=\"a_mega_spark_wave_fire\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				WHEN_ATTACK_TIMER_START=\"ENTER\"		ATTACK_TIMER_TIME=\"60\"		ATTACK_TIMER_TICK=\"0.5\"					NO_DAMAGE_HOLD =\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_mon_mega_ivyrush_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				HIT_SOUND_ID=\"sum-hit-04-elec\"	/>		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/MEGASTORMBLADE.XML", "<ACTION ID=\"a_mega_stormblade\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StormBlade_01\"/>  <FSM SCRIPT=\"StormBlade\"	FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"    FIRE_CASTER_EFFECT_ID=\"eff_megaStorm_blade_char_root\"	FIRE_CASTER_EFFECT_SCALE=\"1.4\"    FIRE_SOUND_ID=\"megastorm_blade01\"		RISING_MOVING_DELTA=\"70\"	SPIN_DEG_PER_SEC=\"2760\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_01.XML", "<ACTION ID=\"a_melee_01\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_02.XML", "<ACTION ID=\"a_melee_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_02\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_02_PUSH_LONG.XML", "<ACTION ID=\"a_melee_02_push_long\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_02\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_02_PUSH_SHORT.XML", "<ACTION ID=\"a_melee_02_push_short\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_02\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_03.XML", "<ACTION ID=\"a_melee_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_03\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_03_PUSH_LONG.XML", "<ACTION ID=\"a_melee_03_push_long\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_03\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_03_PUSH_SHORT.XML", "<ACTION ID=\"a_melee_03_push_short\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_03\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_04.XML", "<ACTION ID=\"a_melee_04\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_04\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_04_PUSH_LONG.XML", "<ACTION ID=\"a_melee_04_push_long\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_04\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_04_PUSH_SHORT.XML", "<ACTION ID=\"a_melee_04_push_short\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"melee_04\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_05.XML", "<ACTION ID=\"a_melee_05\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"melee_05\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_05_PUSH_LONG.XML", "<ACTION ID=\"a_melee_05_push_long\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"melee_05\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_05_PUSH_SHORT.XML", "<ACTION ID=\"a_melee_05_push_short\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"melee_05\"/>	<FSM SCRIPT=\"Act_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_BLOW_UP.XML", "<ACTION ID=\"a_melee_blow_up\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"melee_blow_up\"/>	<FSM SCRIPT=\"Skill_Melee_Blow_Up\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEECHARGEATTACK.XML", "<ACTION ID=\"a_melee_charge_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Skill_Melee_Charge_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_DROP.XML", "<ACTION ID=\"a_melee_drop\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"jump_down_attk\"/>  <SLOT NAME=\"jump_down_attk_up\"/>  <FSM SCRIPT=\"Skill_Melee_Drop\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/MELEE_KNOCK_BACK.XML", "<ACTION ID=\"a_melee_knock_back\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"melee_knock_back\"/>	<FSM SCRIPT=\"Skill_Melee_Knock_Back\" DIRECTION=\"LEFT\"		NO_DAMAGE_HOLD = \"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/METEORSTRIKE.XML", "<ACTION ID=\"a_Meteor Strike\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff_02_01\"/>  <SLOT NAME=\"Com_Skill_Buff_02_02\"/>  <FSM SCRIPT=\"Skill_Meteor\" PROJECTILE_ID=\"Projectile_MeteorStrike\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/METEOR_A.XML", "<ACTION ID=\"a_meteor_pet_a\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" >  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       PROJECTILE_ID=\"PROJECTILE_Meteor_pet\"       FIRE_SOUND_ID=\"skill-meteor_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/METEOR_B.XML", "<ACTION ID=\"a_meteor_pet_b\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" >  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       PROJECTILE_ID=\"PROJECTILE_Meteor_pet\"       FIRE_SOUND_ID=\"skill-meteor_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/METEOR_C.XML", "<ACTION ID=\"a_meteor_pet_c\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" >  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       PROJECTILE_ID=\"PROJECTILE_Meteor_pet\"       FIRE_SOUND_ID=\"skill-meteor_pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/METEOR_RAIN_CAST.XML", "<ACTION ID=\"a_meteor_rain_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">		<SLOT NAME=\"meteor_rain_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"meteor_rain_02\"/>    <FSM SCRIPT=\"CommonSkillAction\"		USE_TLM=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_meteo_rain_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"				EFFECT_HORIZ_DEG_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_VERT_DEG_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"150\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/METEOR_RAIN_FIRE.XML", "<ACTION ID=\"a_meteor_rain_fire\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				WHEN_ATTACK_TIMER_START=\"ENTER\"		ATTACK_TIMER_TIME=\"60\"		ATTACK_TIMER_TICK=\"0.5\"					NO_DAMAGE_HOLD =\"TRUE\"				FIRE_CASTER_EFFECT_CNT=\"1\"				FIRE_CASTER_EFFECT_TYPE_1=\"3\"		FIRE_CASTER_EFFECT_TARGET_NODE_1 = \"Dummy01\"		FIRE_CASTER_EFFECT_ID_1 = \"eff_sum_skill_smw_meteo_rain_01\"		FIRE_CASTER_EFFECT_SCALE_1=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/MINDREADING.XML", "<ACTION ID=\"a_Mind Reading\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Shout_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"MindReading\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/MIRRORIMAGE.XML", "<ACTION ID=\"a_Mirror Image\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_04\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"MirrorImage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MISSION_PORTAL.XML", "<ACTION ID=\"a_mission_portal\" NEXT=\"a_idle\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Mission_Portal\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_360DEGREE_SHOT.XML", "<ACTION ID=\"a_mon_360degree_shot\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"360_btlidle_01_start\"/>  <SLOT NAME=\"360_btlidle_01\"/>  <SLOT NAME=\"360_01\"/>	<FSM SCRIPT=\"Skill_Mon_360Degree_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_360DEGREE_SHOT_2.XML", "<ACTION ID=\"a_mon_360Degree_Shot_2\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"FALSE\">	<SLOT NAME=\"btlidle_04_shot_start\"/>	<SLOT NAME=\"btlidle_04_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_04\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_360S_CURVE.XML", "<ACTION ID=\"a_mon_360s_curve\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"FALSE\">	<SLOT NAME=\"360s_curve_start\"/>	<SLOT NAME=\"360s_curve_idle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"360s_curve_fire\"/>	<SLOT NAME=\"360s_curve_finish\"/>	<FSM SCRIPT=\"Act_Mon_Shot_S_Curve\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_ABSORB.XML", "<ACTION ID=\"a_mon_absorb\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"breath_btlidle_01_start\"/>	<SLOT NAME=\"breath_btlidle_01\"/>	<SLOT NAME=\"breath_01\"/>	<SLOT NAME=\"breath_01_finish\"/>		<FSM SCRIPT=\"Skill_Mon_Breath\"/></ACTION><!--  -->			<!--ITEM NAME=\"breath_btlidle_01_start\" ANIMATION=\"1000345\"/>			<ITEM NAME=\"breath_btlidle_01\" ANIMATION=\"1000346\"/>			<ITEM NAME=\"breath_01\" ANIMATION=\"1000347\"/>			<ITEM NAME=\"breath_01_finish\" ANIMATION=\"1000348\"/-->") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_AIRSTRIKE.XML", "<ACTION ID=\"a_mon_air_strike\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"air_strike_start\"/>	<SLOT NAME=\"air_strike_idle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"air_strike_fire\"/>	<SLOT NAME=\"btlidle_01\"/>	<SLOT NAME=\"air_strike_finish\"/>	<FSM SCRIPT=\"Act_Mon_AirStrike\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ANTARES_LASER.XML", "<ACTION ID=\"a_mon_antares_laser\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_01_shot_start\"/>	<SLOT NAME=\"btlidle_01_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_01\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"shot_return_01\"/>	<FSM SCRIPT=\"Act_Mon_Antares_Laser\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ANTARES_LASER_01.XML", "<ACTION ID=\"a_mon_antares_laser_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_01_antares_shot_start\"/>	<SLOT NAME=\"btlidle_01_antares_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_antares_shot_01\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"shot_antares_return_01\"/>	<FSM SCRIPT=\"Act_Mon_Antares_Laser\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ANTARES_LASER_02.XML", "<ACTION ID=\"a_mon_antares_laser_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_02_antares_shot_start\"/>	<SLOT NAME=\"btlidle_02_antares_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_antares_shot_02\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"shot_antares_return_02\"/>	<FSM SCRIPT=\"Act_Mon_Antares_Laser\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BATMISSILE.XML", "<ACTION ID=\"a_mon_bat_missile\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Bat_Missile_start_01\"/>	<SLOT NAME=\"Bat_Missile_btlidle_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Bat_Missile_01\"/>	<FSM SCRIPT=\"Skill_Mon_BatMissle\"        HIT_SOUND_ID=\"MagicMissile\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BATMISSILE2.XML", "<ACTION ID=\"a_mon_bat_missile2\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Bat_Missile_start_02\"/>	<SLOT NAME=\"Bat_Missile_btlidle_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Bat_Missile_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Skill_Mon_BatMissle\" HIT_SOUND_ID=\"MagicMissile\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BATMISSILE_03.XML", "<ACTION ID=\"a_mon_bat_missile_03\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Bat_Missile_start_03\"/>	<SLOT NAME=\"Bat_Missile_btlidle_03\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Bat_Missile_fire_03\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"Bat_Missile_finish_03\"/>	<FSM SCRIPT=\"Skill_Mon_BatMissle\" HIT_SOUND_ID=\"MagicMissile\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BLACKHOLE_01.XML", "<ACTION ID=\"a_mon_blackhole_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"blackhole_01_start\"/><SLOT NAME=\"blackhole_01\" LOOP=\"TRUE\"/><SLOT NAME=\"blackhole_01_02\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BLACKHOLE_01_SA.XML", "<ACTION ID=\"a_mon_blackhole_01_sa\" NEXT=\"a_idle\" LOOP=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BLOCKING.XML", "<ACTION ID=\"a_mon_blocking\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"blocking_btlidle_01_start\"/>  <SLOT NAME=\"blocking_btlidle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"blocking_01\"/>  <SLOT NAME=\"blocking_01_idle\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Skill_Mon_Blocking\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/MON_BONEDRAGONMIST_SA.XML", "<ACTION ID=\"a_mon_bonedragonmist_sa\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BREAK_01.XML", "<ACTION ID=\"a_mon_break_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"break_01_start\"/><SLOT NAME=\"break_01\" LOOP=\"TRUE\"/><SLOT NAME=\"break_01_02\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BREATH.XML", "<ACTION ID=\"a_mon_breath\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"breath_btlidle_01_start\"/>	<SLOT NAME=\"breath_btlidle_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"breath_01\"/>	<SLOT NAME=\"breath_01_finish\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Skill_Mon_Breath\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BREATH_02.XML", "<ACTION ID=\"a_mon_breath_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"breath_btlidle_02_start\"/>	<SLOT NAME=\"breath_btlidle_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"breath_02\"/>	<SLOT NAME=\"breath_02_finish\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Skill_Mon_Breath\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BREATH_03.XML", "<ACTION ID=\"a_mon_breath_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"breath_btlidle_03_start\"/>	<SLOT NAME=\"breath_btlidle_03\" LOOP=\"TRUE\"/>	<SLOT NAME=\"breath_03\"/>	<SLOT NAME=\"breath_03_finish\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Skill_Mon_Breath\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BREATH_04.XML", "<ACTION ID=\"a_mon_breath_04\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"breath_btlidle_04_start\"/>	<SLOT NAME=\"breath_btlidle_04\" LOOP=\"TRUE\"/>	<SLOT NAME=\"breath_04\"/>	<SLOT NAME=\"breath_04_finish\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Skill_Mon_Breath\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_BREATH_05.XML", "<ACTION ID=\"a_mon_breath_05\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"breath_btlidle_05_start\"/>	<SLOT NAME=\"breath_btlidle_05\" LOOP=\"TRUE\"/>	<SLOT NAME=\"breath_05\"/>	<SLOT NAME=\"breath_05_finish\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Skill_Mon_Breath\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CAST_01.XML", "<ACTION ID=\"a_mon_cast_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"cast_01\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CAST_02.XML", "<ACTION ID=\"a_mon_cast_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"cast_02\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CAST_03.XML", "<ACTION ID=\"a_mon_cast_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"cast_03\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CROSSATTACK_01.XML", "<ACTION ID=\"a_mon_crossattack_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"crossattack_01_start\"/>  <SLOT NAME=\"crossattack_01_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"crossattack_01_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"crossattack_01_finish\"/>  <FSM SCRIPT=\"Act_Mon_CrossAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CROSSATTACK_02.XML", "<ACTION ID=\"a_mon_crossattack_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"crossattack_02_start\"/>  <SLOT NAME=\"crossattack_02_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"crossattack_02_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"crossattack_02_finish\"/>  <FSM SCRIPT=\"Act_Mon_CrossAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CROSSATTACK_03.XML", "<ACTION ID=\"a_mon_crossattack_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"crossattack_03_start\"/>  <SLOT NAME=\"crossattack_03_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"crossattack_03_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"crossattack_03_finish\"/>  <FSM SCRIPT=\"Act_Mon_CrossAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CROSSATTACK_04.XML", "<ACTION ID=\"a_mon_crossattack_04\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"crossattack_04_start\"/>  <SLOT NAME=\"crossattack_04_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"crossattack_04_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"crossattack_04_finish\"/>  <FSM SCRIPT=\"Act_Mon_CrossAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CROSSATTACK_05.XML", "<ACTION ID=\"a_mon_crossattack_05\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"crossattack_05_start\"/>  <SLOT NAME=\"crossattack_05_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"crossattack_05_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"crossattack_05_finish\"/>  <FSM SCRIPT=\"Act_Mon_CrossAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_CROSSATTACK_06.XML", "<ACTION ID=\"a_mon_crossattack_06\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"crossattack_06_start\"/>  <SLOT NAME=\"crossattack_06_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"crossattack_06_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"crossattack_06_finish\"/>  <FSM SCRIPT=\"Act_Mon_CrossAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/MON_DARKBREATH.XML", "<ACTION ID=\"a_mon_darkbreath\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\" NO_SET_WALKING_TARGET_LOC=\"TRUE\" IGNORE_PHYSX=\"TRUE\">  <SLOT NAME=\"darkbreath_start\"/>  <SLOT NAME=\"darkbreath_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"darkbreath_run\"/>  <SLOT NAME=\"darkbreath_fire_ready\"/>  <SLOT NAME=\"darkbreath_battleidle\"/>  <SLOT NAME=\"darkbreath_finish\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"darkbreath_fire\"/>  <FSM SCRIPT=\"Act_Mon_DarkBreath\" MOVE=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DASHATTK.XML", "<ACTION ID=\"a_mon_dashattk\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\">  <SLOT NAME=\"dashattk_btlidle_01_start\"/>  <SLOT NAME=\"dashattk_btlidle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dashattk_rush\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"dashattk_finish\"/>  <FSM SCRIPT=\"Act_Mon_Rush\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DASHATTK_02.XML", "<ACTION ID=\"a_mon_dashattk_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\">  <SLOT NAME=\"dashattk_btlidle_02_start\"/>  <SLOT NAME=\"dashattk_btlidle_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dashattk_rush_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"dashattk_finish_02\"/>  <FSM SCRIPT=\"Act_Mon_Rush\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DASHATTK_03.XML", "<ACTION ID=\"a_mon_dashattk_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\">  <SLOT NAME=\"dashattk_btlidle_03_start\"/>  <SLOT NAME=\"dashattk_btlidle_03\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dashattk_rush_03\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"dashattk_finish_03\"/>  <FSM SCRIPT=\"Act_Mon_Rush\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DASH_AFTER_ATTK.XML", "<ACTION ID=\"a_mon_dash_after_attk\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"dash_after_attk_btlidle_01_start\"/>	<SLOT NAME=\"dash_after_attk_btlidle_01\" LOOP = \"true\"/>	<SLOT NAME=\"dash_after_attk_rush\"/>	<SLOT NAME=\"dash_after_attk_01_02\"/>	<FSM SCRIPT=\"Act_Mon_RushAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DASH_AFTER_ATTK_02.XML", "<ACTION ID=\"a_mon_dash_after_attk\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"dash_after_attk_btlidle_02_start\"/>	<SLOT NAME=\"dash_after_attk_btlidle_02\" LOOP=\"true\"/>	<SLOT NAME=\"dash_after_attk_rush_02\"/>	<SLOT NAME=\"dash_after_attk_02_02\"/>	<FSM SCRIPT=\"Act_Mon_RushAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DASH_PIERCING_ATTK.XML", "<ACTION ID=\"a_mon_dash_piercing_attk\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"dash_piercing_attk_btlidle_01_start\"/>  <SLOT NAME=\"dash_piercing_attk_btlidle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dash_piercing_attk_rush\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"dash_piercing_attk_finish\"/>  <FSM SCRIPT=\"Act_Mon_RushPiercing\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DIE_SKILL_01.XML", "<ACTION ID=\"a_mon_dieskill_01\" NEXT=\"a_die\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"dieskill_btlidle_01_start\"/>	<SLOT NAME=\"dieskill_btlidle_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"dieskill_attk_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_DieSkill\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DIE_SKILL_02.XML", "<ACTION ID=\"a_mon_dieskill_02\" NEXT=\"a_die\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"dieskill_btlidle_02_start\"/>	<SLOT NAME=\"dieskill_btlidle_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"dieskill_attk_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_DieSkill\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DROP_PROJECTILE.XML", "<ACTION ID=\"a_mon_drop_projectile\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"drop_projectile_btlidle_start\"/>	<SLOT NAME=\"drop_projectile_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"drop_projectile_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_DropProjectile\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_DROP_PROJECTILE_01.XML", "<ACTION ID=\"a_mon_drop_projectile_01\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"drop_projectile01_btlidle_start\"/>	<SLOT NAME=\"drop_projectile01_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"drop_projectile01_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_DropProjectile_01\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_EARTHQUAKE.XML", "<ACTION ID=\"a_mon_earthquake\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"FALSE\">  <SLOT NAME=\"earthquake_battleidle_start\"/>  <SLOT NAME=\"earthquake_battleidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"earthquake_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"earthquake_finish\"/>	<FSM SCRIPT=\"Act_Mon_Earthquake\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_EARTHQUAKE_01.XML", "<ACTION ID=\"a_mon_earthquake_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"FALSE\">  <SLOT NAME=\"earthquake01_battleidle_start\"/>  <SLOT NAME=\"earthquake01_battleidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"earthquake01_fire\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Act_Mon_Earthquake\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_EARTHQUAKE_02.XML", "<ACTION ID=\"a_mon_earthquake_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"FALSE\">  <SLOT NAME=\"earthquake02_battleidle_start\"/>  <SLOT NAME=\"earthquake02_battleidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"earthquake02_fire\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Act_Mon_Earthquake\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ELGA02_AIRSTRIKE.XML", "<ACTION ID=\"a_mon_elga02_air_strike\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"FALSE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"elga02_air_strike_start\"/>	<SLOT NAME=\"elga02_air_strike_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"elga02_air_strike_fire\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"elga02_air_strike_finish\"/>	<FSM SCRIPT=\"Act_Mon_Antares_Laser\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ELGA03_DARK_EYE_IDLE.XML", "<ACTION ID=\"a_mon_elga03_dark_eye_idle\" TYPE=\"IDLE\" NEXT=\"a_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"dark_eye_idle\"/>  <SLOT NAME=\"battle_idle\"/>  <SLOT NAME=\"btlidle_01\"/>  <SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ELGA03_SUMMON_DARK_EYE.XML", "<ACTION ID=\"a_mon_elga03_summon_dark_eye\" NEXT=\"a_mon_elga03_dark_eye_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">  <SLOT NAME=\"elga03_summon_dark_eye_start\"/>  <SLOT NAME=\"elga03_summon_dark_eye_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"elga03_summon_dark_eye_fire\"/>  <SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ENERGY_EXPLOSION.XML", "<ACTION ID=\"a_mon_energy_explosion\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"energy_explosion_btlidle_start\"/>  <SLOT NAME=\"energy_explosion_btlidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"energy_explosion_fire\"/>  <SLOT NAME=\"btlidle_01\"/>  <SLOT NAME=\"energy_explosion_finish\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Act_Mon_EnergyExplosion\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_FURY_01.XML", "<ACTION ID=\"a_mon_fury_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"fury_01_start\"/><SLOT NAME=\"fury_01\" LOOP=\"TRUE\"/><SLOT NAME=\"fury_01_02\" USE_EVENTSCRIPT=\"TRUE\" FIRE_EFFECT_NODE=\"char_root\" FIRE_EFFECT=\"eff_common_anger00\" FIRE_EFFECT_AUTO_SCALE=\"TRUE\" /><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_IDLE.XML", "<ACTION ID=\"a_mon_idle\" TYPE=\"IDLE\" NEXT=\"a_mon_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"battle_idle\"/>  <SLOT NAME=\"btlidle_01\"/>  <SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_JUMPDOWNCRASH.XML", "<ACTION ID=\"a_mon_jumpdowncrash\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"jumpdowncrash_up\"/>  <SLOT NAME=\"jumpdowncrash_down\"/>  <SLOT NAME=\"jumpdowncrash_getup\"/>  <FSM SCRIPT=\"Skill_Mon_JumpDownCrash\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_JUMPDOWNCRASH_01.XML", "<ACTION ID=\"a_mon_jumpdowncrash_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"jumpdowncrash_up_01\"/>  <SLOT NAME=\"jumpdowncrash_down_01\"/>  <SLOT NAME=\"jumpdowncrash_getup_01\"/>  <FSM SCRIPT=\"Skill_Mon_JumpDownCrash\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_JUMPDOWNCRASH_02.XML", "<ACTION ID=\"a_mon_jumpdowncrash_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"jumpdowncrash_up_02\"/>  <SLOT NAME=\"jumpdowncrash_down_02\"/>  <SLOT NAME=\"jumpdowncrash_getup_02\"/>  <FSM SCRIPT=\"Skill_Mon_JumpDownCrash02\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_JUMPDOWNCRASH_DIAG.XML", "<ACTION ID=\"a_mon_jumpdowncrash_diag\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"jumpdowncrash_diag_up\"/>	<SLOT NAME=\"jumpdowncrash_diag_down\"/>	<SLOT NAME=\"jumpdowncrash_diag_getup\"/>	<FSM SCRIPT=\"Skill_Mon_JumpDownCrash_Diag\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MASSIVE_PROJECTILE.XML", "<ACTION ID=\"a_mon_massive_projectile\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">  <SLOT NAME=\"massive_projectile_btlidle_start\"/>  <SLOT NAME=\"massive_projectile_btlidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"massive_projectile_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"massive_projectile_finish\"/>  <FSM SCRIPT=\"Act_Mon_MassiveProjectile\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MASSIVE_PROJECTILE2.XML", "<ACTION ID=\"a_mon_massive_projectile_02\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">  <SLOT NAME=\"massive_projectile_02_btlidle_start\"/>  <SLOT NAME=\"massive_projectile_02_btlidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"massive_projectile_02_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"massive_projectile_02_finish\"/>  <FSM SCRIPT=\"Act_Mon_MassiveProjectile2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MASSIVE_PROJECTILE_JUMP.XML", "<ACTION ID=\"a_mon_massive_projectile_jump\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"massive_projectile_jump_btlidle_start\"/>  <SLOT NAME=\"massive_projectile_jump_btlidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"massive_projectile_jump_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"massive_projectile_jump_finish\"/>  <FSM SCRIPT=\"Act_Mon_MassiveProjectile_Jump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MASSIVE_PROJECTILE_MOVE.XML", "<ACTION ID=\"a_mon_massive_projectile_move\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"massive_projectile_btlidle_start\"/>  <SLOT NAME=\"massive_projectile_btlidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"massive_projectile_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"massive_projectile_finish\"/>  <FSM SCRIPT=\"Act_Mon_MassiveProjectile_Move\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_01.XML", "<ACTION ID=\"a_mon_melee_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"btlidle_01_start\"/><SLOT NAME=\"btlidle_01\" LOOP=\"TRUE\"/><SLOT NAME=\"attk_01_02\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_02.XML", "<ACTION ID=\"a_mon_melee_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_02_01_start\"/>	<SLOT NAME=\"attk_02_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_02_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_03.XML", "<ACTION ID=\"a_mon_melee_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_03_01_start\"/>	<SLOT NAME=\"attk_03_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_03_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_04.XML", "<ACTION ID=\"a_mon_melee_04\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_04_01_start\"/>	<SLOT NAME=\"attk_04_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_04_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_05.XML", "<ACTION ID=\"a_mon_melee_05\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_05_01_start\"/>	<SLOT NAME=\"attk_05_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_05_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_06.XML", "<ACTION ID=\"a_mon_melee_06\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_06_01_start\"/>	<SLOT NAME=\"attk_06_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_06_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_07.XML", "<ACTION ID=\"a_mon_melee_07\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_07_01_start\"/>	<SLOT NAME=\"attk_07_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_07_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_08.XML", "<ACTION ID=\"a_mon_melee_08\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_08_01_start\"/>	<SLOT NAME=\"attk_08_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_08_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_B_01.XML", "<ACTION ID=\"a_mon_melee_b_01\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">  <SLOT NAME=\"attk_b_01_01_start\"/>  <SLOT NAME=\"attk_b_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_b_01_02\"/>  <SLOT NAME=\"btlidle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_CASTANI.XML", "<ACTION ID=\"a_mon_melee_castani\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"castani_01\"/>	<SLOT NAME=\"btlidle_cast_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"castani_02\"/>	<SLOT NAME=\"btlidle_cast_03\" LOOP=\"TRUE\"/>	<SLOT NAME=\"castani_03\"/>	<SLOT NAME=\"btlidle_cast_04\" LOOP=\"TRUE\"/>	<SLOT NAME=\"castani_04\"/>	<SLOT NAME=\"btlidle_cast_05\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_castani_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee_CastAni\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_DELAY_01.XML", "<ACTION ID=\"a_mon_melee_delay_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_delay_01_start\"/>	<SLOT NAME=\"btlidle_delay_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_delay_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee_Delay\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_DELAY_02.XML", "<ACTION ID=\"a_mon_melee_delay_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_delay_02_start\"/>	<SLOT NAME=\"btlidle_delay_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_delay_02\"/>	<SLOT NAME=\"idle_02\"/>	<FSM SCRIPT=\"Act_Mon_Melee_Delay\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_FINISH_01.XML", "<ACTION ID=\"a_mon_melee_fin_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_fin_01_start\"/>	<SLOT NAME=\"attk_fin_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_fin_01_fire\"/>	<SLOT NAME=\"attk_fin_01_fin_01\"/>	<SLOT NAME=\"attk_fin_01_fin_02\"/>	<SLOT NAME=\"attk_fin_01_fin_03\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee_Finish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_FINISH_02.XML", "<ACTION ID=\"a_mon_melee_fin_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"attk_fin_02_start\"/>	<SLOT NAME=\"attk_fin_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_fin_02_fire\"/>	<SLOT NAME=\"attk_fin_02_fin_01\"/>	<SLOT NAME=\"attk_fin_02_fin_02\"/>	<SLOT NAME=\"attk_fin_02_fin_03\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee_Finish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_LOOP_01.XML", "<ACTION ID=\"a_mon_melee_loop_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_loop_01_start\"/>	<SLOT NAME=\"btlidle_loop_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"attk_loop_01\"/>	<SLOT NAME=\"attk_after_loop_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"finish_loop_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee_Loop\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_SKILL_01.XML", "<ACTION ID=\"a_mon_melee_skill_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_01_skill_attk_start\"/>	<SLOT NAME=\"btlidle_01_skill_attk\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_attk_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_SKILL_02.XML", "<ACTION ID=\"a_mon_melee_skill_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_02_skill_attk_start\"/>	<SLOT NAME=\"btlidle_02_skill_attk\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_attk_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MELEE_SKILL_03.XML", "<ACTION ID=\"a_mon_melee_skill_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_03_skill_attk_start\"/>	<SLOT NAME=\"btlidle_03_skill_attk\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_attk_03\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_MOVE.XML", "<ACTION ID=\"a_mon_move\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"FALSE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"move_01\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Mon_Move\" MOVE=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/NEVE/MON_MULTI_SHOT_BYS_01.XML", "<ACTION ID=\"a_mon_multi_shot_byS_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"multi_shot_byS_01_start\"/>  <SLOT NAME=\"multi_shot_byS_01_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"multi_shot_byS_01_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"multi_shot_byS_01_finish\"/>  <FSM SCRIPT=\"Act_Mon_Multi_Shot_byS\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/MON_NATURE_HEAL.XML", "<ACTION ID=\"a_mon_nature_heal\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"btlidle_01_start\"/><SLOT NAME=\"btlidle_01\" LOOP=\"TRUE\"/><SLOT NAME=\"attk_01_02\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"		APPLY_ACTION_EFFECTS=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_NORMAL_01.XML", "<ACTION ID=\"a_mon_normal_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\"><SLOT NAME=\"normal_01_start\"/><SLOT NAME=\"normal_01\" LOOP=\"TRUE\"/><SLOT NAME=\"normal_01_02\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ONLY_ANI.XML", "<ACTION ID=\"a_mon_only_ani\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"only_ani_start_01\"/>	<SLOT NAME=\"only_ani_idle_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"only_ani_01_01\"/>	<SLOT NAME=\"only_ani_01_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Only_Ani\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_ONLY_ANI_02.XML", "<ACTION ID=\"a_mon_only_ani_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"only_ani_start_02\"/>	<SLOT NAME=\"only_ani_idle_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"only_ani_02_01\"/>	<SLOT NAME=\"only_ani_02_02\"/>	<FSM SCRIPT=\"Act_Mon_Only_Ani\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_PARIS_LASER.XML", "<ACTION ID=\"a_mon_paris_laser\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" ALWAYS_UPDATE=\"TRUE\">	<SLOT NAME=\"btlidle_01_shot_start\"/>	<SLOT NAME=\"btlidle_01_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"shot_return_01\"/>	<FSM SCRIPT=\"Act_Mon_Paris_Laser\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_PARIS_LASER_01.XML", "<ACTION ID=\"a_mon_paris_laser_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" ALWAYS_UPDATE=\"TRUE\">	<SLOT NAME=\"paris_laser_01_start\"/>	<SLOT NAME=\"paris_laser_01_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"paris_laser_01_shot_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"paris_laser_01_return\"/>	<FSM SCRIPT=\"Act_Mon_Paris_Laser\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_PARIS_LASER_MULTI.XML", "<ACTION ID=\"a_mon_paris_laser_multi\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"false\" ALWAYS_UPDATE=\"TRUE\">	<SLOT NAME=\"btlidle_02_shot_start\"/>	<SLOT NAME=\"btlidle_02_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"shot_return_02\"/>	<FSM SCRIPT=\"Act_Mon_Paris_Laser_Multi\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_PATROL_SHOT.XML", "<ACTION ID=\"a_mon_patrol\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC = \"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" NO_CHANGE_TELEPORT_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"patrol_btlidle_start\"/>	<SLOT NAME=\"patrol_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"patrol_attack\"/>	<SLOT NAME=\"patrol_finish_01\"/>	<SLOT NAME=\"patrol_finish_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_PATROL_SHOT\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_PULL.XML", "<ACTION ID=\"a_mon_pull\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Skill_Mon_Pull\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_REGEN_POINT_CHOSE.XML", "<ACTION ID=\"a_mon_regen_point_chose\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"regen_point_chose_btlidle_start\"/>	<SLOT NAME=\"regen_point_chose_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"regen_point_chose_attk\"/>	<SLOT NAME=\"idle_01\"/>		<FSM SCRIPT=\"Act_Mon_RegenPointChoose\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SELECT_SHOTBYKEY_01.XML", "<ACTION ID=\"a_mon_select_shotbykey_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\"><SLOT NAME=\"select_shotbykey_start\"/><SLOT NAME=\"select_shotbykey_idle\" LOOP=\"TRUE\"/><SLOT NAME=\"select_shotbykey_fire\"/><SLOT NAME=\"idle_01\"/><FSM SCRIPT=\"Act_Mon_Select_ShotbyKey\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SELECT_SHOT_01.XML", "<ACTION ID=\"a_mon_select_shot_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\"><SLOT NAME=\"select_shot_start\"/><SLOT NAME=\"select_shot_idle\" LOOP=\"TRUE\"/><SLOT NAME=\"select_shot_fire\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Select_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SELECT_SHOT_02.XML", "<ACTION ID=\"a_mon_select_shot_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\"><SLOT NAME=\"select_shot02_start\"/><SLOT NAME=\"select_shot02_idle\" LOOP=\"TRUE\"/><SLOT NAME=\"select_shot02_fire\"/><SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Select_Shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_01.XML", "<ACTION ID=\"a_mon_shot_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_01_shot_start\"/>	<SLOT NAME=\"btlidle_01_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_01\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"btlidle_01_shot_middle\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_02.XML", "<ACTION ID=\"a_mon_shot_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_02_shot_start\"/>	<SLOT NAME=\"btlidle_02_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_02\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_03.XML", "<ACTION ID=\"a_mon_shot_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_03_shot_start\"/>	<SLOT NAME=\"btlidle_03_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_03\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_AROUND2_01.XML", "<ACTION ID=\"a_mon_shot_around2_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"shot_around2_01_start\"/>	<SLOT NAME=\"shot_around2_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_around2_01_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Around2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_AROUND_01.XML", "<ACTION ID=\"a_mon_shot_around_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"shot_around_01_start\"/>	<SLOT NAME=\"shot_around_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_around_01_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Around\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_AROUND_02.XML", "<ACTION ID=\"a_mon_shot_around_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"shot_around_02_start\"/>	<SLOT NAME=\"shot_around_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_around_02_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Around\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_AROUND_03.XML", "<ACTION ID=\"a_mon_shot_around_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"shot_around_03_start\"/>	<SLOT NAME=\"shot_around_03\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_around_03_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Bidirection\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_AROUND_FINISH.XML", "<ACTION ID=\"a_mon_shot_around_finish\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"shot_around_01_start\"/>	<SLOT NAME=\"shot_around_01_fire\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"shot_around_01_finish\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Around_Finish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SIXSHOT.XML", "<ACTION ID=\"a_mon_shot_sixshot\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"shot_sixshot_01_start\"/>	<SLOT NAME=\"shot_sixshot01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"shot_sixshot_01_fire\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Sixshot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_01.XML", "<ACTION ID=\"a_mon_shot_skill_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_01_skill_shot_start\"/>	<SLOT NAME=\"btlidle_01_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_01\"/>	<SLOT NAME=\"idle_01\"/><!--,  .-->	<SLOT NAME=\"shot_return_01\"/>	<SLOT NAME=\"btlidle_01_skill_shot_middle\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_02.XML", "<ACTION ID=\"a_mon_shot_skill_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_02_skill_shot_start\"/>	<SLOT NAME=\"btlidle_02_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_02\"/>	<SLOT NAME=\"idle_01\"/> <!--,  .-->	<SLOT NAME=\"shot_return_02\"/>	<SLOT NAME=\"btlidle_02_skill_shot_middle\" LOOP=\"TRUE\"/>		<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_03.XML", "<ACTION ID=\"a_mon_shot_skill_03\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"btlidle_03_skill_shot_start\"/>	<SLOT NAME=\"btlidle_03_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_03\"/>	<SLOT NAME=\"idle_01\"/> <!--,  .-->	<SLOT NAME=\"shot_return_03\"/>	<SLOT NAME=\"btlidle_03_skill_shot_middle\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_04.XML", "<ACTION ID=\"a_mon_shot_skill_04\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">  <SLOT NAME=\"btlidle_01_start\"/>  <SLOT NAME=\"btlidle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"skill_vagabond_01\"/>  <FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_11.XML", "<ACTION ID=\"a_mon_shot_skill_11\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"FALSE\">	<SLOT NAME=\"btlidle_11_skill_shot_start\"/>	<SLOT NAME=\"btlidle_11_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_11\"/>	<SLOT NAME=\"idle_01\"/> <!--,  .-->	<SLOT NAME=\"shot_return_11\"/>	<SLOT NAME=\"btlidle_11_skill_shot_middle\" LOOP=\"TRUE\"/>		<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_12.XML", "<ACTION ID=\"a_mon_shot_skill_12\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"FALSE\">	<SLOT NAME=\"btlidle_12_skill_shot_start\"/>	<SLOT NAME=\"btlidle_12_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_12\"/>	<SLOT NAME=\"idle_01\"/> <!--,  .-->	<SLOT NAME=\"shot_return_12\"/>	<SLOT NAME=\"btlidle_12_skill_shot_middle\" LOOP=\"TRUE\"/>		<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_SKILL_13.XML", "<ACTION ID=\"a_mon_shot_skill_13\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"FALSE\">	<SLOT NAME=\"btlidle_13_skill_shot_start\"/>	<SLOT NAME=\"btlidle_13_skill_shot\" LOOP=\"TRUE\"/>	<SLOT NAME=\"skill_shot_13\"/>	<SLOT NAME=\"idle_01\"/> <!--,  .-->	<SLOT NAME=\"shot_return_13\"/>	<SLOT NAME=\"btlidle_13_skill_shot_middle\" LOOP=\"TRUE\"/>		<FSM SCRIPT=\"Act_Mon_RangeAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/MON_SUMMONBONE.XML", "<ACTION ID=\"a_mon_summonbone\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"FALSE\">  <SLOT NAME=\"summonbone_battleidle_start\"/>  <SLOT NAME=\"summonbone_battleidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"summonbone_fire\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Act_Mon_SummonBone\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/BONEDRAGON/MON_SUMMONBONE_SA.XML", "<ACTION ID=\"a_mon_summonbone_sa\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Act_Mon_SummonBone_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SUMMON_THORN.XML", "<ACTION ID=\"a_mon_summon_thorn\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"summon_thorn_btlidle_start\"/>	<SLOT NAME=\"summon_thorn_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"summon_thorn_fire\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"Act_Mon_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SUMMON_THORNS.XML", "<ACTION ID=\"a_mon_summon_thorns\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"summon_thorns_btlidle_start\"/>	<SLOT NAME=\"summon_thorns_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"summon_thorns_fire\"/>	<SLOT NAME=\"idle_01\"/>  	<SLOT NAME=\"summon_thorns_finish\"/>	<FSM SCRIPT=\"Act_Mon_SummonThorns\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SUMMON_THORNSSA.XML", "<ACTION ID=\"a_mon_summon_thorns_sa\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Act_Mon_SummonThornsSA\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SUMMON_THORNSA.XML", "<ACTION ID=\"a_mon_summon_thorn_sa\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Act_Mon_SummonThornSA\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_S_CURVE.XML", "<ACTION ID=\"a_mon_s_curve\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"s_curve_start\"/>	<SLOT NAME=\"s_curve_idle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"s_curve_fire\"/>	<SLOT NAME=\"s_curve_finish\"/>	<FSM SCRIPT=\"Act_Mon_Shot_S_Curve\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/NEVE/MON_TARGET_LOC_SHOT_01.XML", "<ACTION ID=\"a_mon_target_loc_shot_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"target_loc_shot_01_start\"/>  <SLOT NAME=\"target_loc_shot_01_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"target_loc_shot_01_fire\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"target_loc_shot_01_finish\"/>  <FSM SCRIPT=\"Act_Mon_Target_Loc\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_TELEPORT_SKILL_01.XML", "<ACTION ID=\"a_mon_teleport_skill_01\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"teleport_skill_01_start\"/>	<SLOT NAME=\"teleport_skill_01_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"teleport_skill_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mon_Teleport\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_TOUCH_UP.XML", "<ACTION ID=\"a_mon_touch_up\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"touch_up_start\"/>	<SLOT NAME=\"touch_up_idle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"touch_up_fire\"/>	<SLOT NAME=\"touch_up_finish\"/>	<FSM SCRIPT=\"Act_Mon_Touch_up\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_TOUCH_UP_02.XML", "<ACTION ID=\"a_mon_touch_up_02\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"touch_up_02_start\"/>	<SLOT NAME=\"touch_up_02_idle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"touch_up_02_fire\"/>	<SLOT NAME=\"touch_up_02_finish\"/>	<FSM SCRIPT=\"Act_Mon_Touch_up\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_SHOT_TWIST.XML", "<ACTION ID=\"a_mon_twist\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"twist_start\"/>	<SLOT NAME=\"twist_idle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"twist_fire\"/>	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"twist_finish\"/>	<FSM SCRIPT=\"Act_Mon_Shot_Twist\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_WHIRLWIND.XML", "<ACTION ID=\"a_mon_whirlwind\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">  <SLOT NAME=\"whirlwind_btlidle_01_start\"/>  <SLOT NAME=\"whirlwind_btlidle_01\"/>  <SLOT NAME=\"whirlwind_01\"/>	<FSM SCRIPT=\"Skill_Mon_WhirlWind\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MONSTER/MON_WHIRLWIND_MOVE.XML", "<ACTION ID=\"a_mon_whirlwind_move\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"whirlwind_btlidle_01_start\"/>	<SLOT NAME=\"whirlwind_btlidle_01\"/>	<SLOT NAME=\"whirlwind_01\"/>	<SLOT NAME=\"whirlwind_01_finish\"/>	<FSM SCRIPT=\"Skill_Mon_WhirlWind\" MOVE=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/MOONWALK.XML", "<ACTION ID=\"a_Moon Walk\" NEXT=\"a_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"walk\"/>  <SLOT NAME=\"com_skill_moonwalk_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_Moon_Dance\"       HIT_SOUND_ID=\"moonwalk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/MOUNT.XML", "<ACTION ID=\"a_mount\" NEXT=\"a_riding_ground\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Pet_Mount\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MOVINGTREE.XML", "<ACTION ID=\"a_moving_tree\" LOOP=\"TRUE\">	<FSM SCRIPT=\"Act_Moving_Tree\"/>	<SLOT NAME=\"tree_turn_01\"/>	<SLOT NAME=\"tree_idle_02\"/>	<SLOT NAME=\"tree_turn_02\"/>	<SLOT NAME=\"tree_idle_01\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/MPTRANSITION.XML", "<ACTION ID=\"a_MP Transition\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID =\"ef_MPtransition_01_char_root\"       NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"MP_Transition\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/MPZEROTRAP.XML", "<ACTION ID=\"a_MP-Zero Trap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_skill_RatTrap_01\"/>  <SLOT NAME=\"Bow_Skill_JumpTrap_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"MP_Zero\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/MPZEROTRAPACTIVE.XML", "<ACTION ID=\"a_MP-Zero Trap Active\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Trap_Play\"        TYPE=\"BOMB\"        SERACH_TYPE=\"FULLSEARCH\"       BOMB_EFFECT_ID=\"ef_mag_charge01_result\"       BOME_AFTER_EFFECT_ID=\"e_ef_fossilearth_explosion\"        BOME_AFTER_EFFECT_SCALE=\"0.4\"       HIT_SOUND_ID=\"Deapodong\"       BOME_AFTER_SOUND_ID=\"SplashTrap2\"	          IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_ID=\"ef_Trap_Bound_01\"       IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_TARGET_NODE_POS=\"Dummy01\"	          INSTALL_EFFECT_ID2=\"ef_dust_01\"       INSTALL_EFFECT_TARGET_NODE_POS2=\"Dummy01\"	   	   TRANSFORM_EFFECT_ID=\"ef_dust_01\"       TRANSFORM_EFFECT_TARGET_NODE_POS=\"Dummy01\"	   TRANSFORM_SOUND_ID=\"Needle_Trap_01\"	   	   TARGET_SCALE=\"0.5\"	   TARGET_SCALE_TIME=\"1000\"	          FIND_TARGET_TYPE=\"SPHERE\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/MULTI_SHOT.XML", "<ACTION ID=\"a_Multi Shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Multi_shot\"/>  <FSM SCRIPT=\"Skill_Multi_Shot\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"PROJECTILE_MULTI_SHOT_ARROW\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"e_skill_reverse_gravity_mon_fallen\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/MULTIPLE SHOT.XML", "<ACTION ID=\"a_Multiple Shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"Multi_shot\"/>  <FSM SCRIPT=\"Skill_Multiple_Shot\"       PROJECTILE_ID=\"PROJECTILE_Multi_shot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/MULTISHOT.XML", "<ACTION ID=\"a_MultiShot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"multi_shot_01\"/>  <FSM SCRIPT=\"Skill_MultiShot\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"PROJECTILE_THUNDER_ARROW\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"e_skill_reverse_gravity_mon_fallen\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/A_MULTISTRAPE.XML", "<ACTION ID=\"a_multi_strape\" NEXT=\"a_multi_strape_fire\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Arc_Bow_skill_Multi_Stripe_01\"/>  <!--SLOT NAME=\"Arc_Bow_skill_Multi_Stripe_02\"/-->  <FSM SCRIPT=\"Skill_Multi_Strape\"	   SUMMON_CLASSNO=\"900104\"       SUMMON_RESERVE_ACTION=\"a_multi_strape_creature_idle\"	   	   FIRE_CASTER_EFFECT_ID=\"ef_skill_multi_stripe_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_multi_stripe_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   	   CASTING_SOUND_ID=\"MultiStripe_FIRE\"	   FIRE_SOUND_ID=\"\"	   FIRE_SOUND_ID1=\"\"	   	   CASTING_SOUND_ID_MALE=\"Male_MultiStripe\"	   CASTING_SOUND_ID_FEMALE=\"Female_MultiStripe\"	/>  <!--FSM SCRIPT=\"Skill_Multi_Strape\"	FIRE_SOUND_ID1=\"MultiStripe_02\"         FIRE_CASTER_EFFECT_ID=\"ef_skill_Demolition_Bomber_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_Demolition_Bomber_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"              DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"-->       </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/MULTISTRAPE_CREATURE_IDLE.XML", "<ACTION ID=\"a_multi_strape_creature_idle\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Skill_MutiStrape_Creature_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/A_MULTISTRAPE_FIRE.XML", "<ACTION ID=\"a_multi_strape_fire\" NEXT=\"a_multi_strape_melee\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Arc_Bow_skill_Multi_Stripe_02\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_Multi_Strape_Fire\" PROJECTILE_ID=\"PROJECTILE_MULTISTRAPE_ARROW\"  	   	   FIRE_CASTER_EFFECT_ID=\"ef_skill_multi_stripe_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_multi_stripe_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	/>	  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/A_MULTISTRAPE_MELEE.XML", "<ACTION ID=\"a_multi_strape_melee\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Arc_Bow_skill_Multi_Stripe_03\"/>	<!--SLOT NAME=\"attk_01\"/-->		 <FSM SCRIPT=\"Skill_MultiStrape_Melee\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"       CHECK_CAN_PREV_ACTION_ID=\"a_multi_strape_fire\"	   	   SUMMON_CLASSNO=\"900105\"       SUMMON_RESERVE_ACTION=\"a_multi_strape_creature_idle\"	   	   	   FIRE_CASTER_EFFECT_ID=\"ef_skill_multi_stripe_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_multi_stripe_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   	   FIRE_SOUND_ID=\"MultiStripe_02\"	   />		<!--FSM SCRIPT=\"Skill_MultiStrape_Melee\"/-->	<!--FSM SCRIPT=\"Skill_Master_Summon_Finish\"              FIRE_CASTER_EFFECT_ID=\"ef_skill_Demolition_Bomber_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_Demolition_Bomber_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"              DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"              /-->	   </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARAMMUTISHA/MUTISHA_DIE.XML", "<ACTION ID=\"a_mutisha_die\" TYPE=\"EFFECT\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"mutisha_die\"/>	<SLOT NAME=\"mutisha_die_idle\" LOOP=\"TRUE\"/>		<FSM SCRIPT=\"Act_Mutisha_Die\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARAMMUTISHA/MUTISHA_INARAM.XML", "<ACTION ID=\"a_mutisha_inaram_skill\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" BIDIRECTION=\"TRUE\">	<SLOT NAME=\"a_mutisha_inaram_skill_start\"/>	<SLOT NAME=\"a_mutisha_inaram_skill_btlidle\" LOOP=\"TRUE\"/>	<SLOT NAME=\"a_mutisha_inaram_skill\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Mutisha_InAram\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/MYSTERIOUSCOOKING.XML", "<ACTION ID=\"a_Mysterious Cooking\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"com_skill_buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_ID =\"ef_Mysteryouscooking_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE =\"char_root\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/NATURE_BLESSING.XML", "<ACTION ID=\"a_Nature_Blessing\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"breath_of_nature_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"breath_of_nature_fire\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"			EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_nature_range00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"CLEAN_UP\"			/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/NETBINDER.XML", "<ACTION ID=\"a_Net Binder\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID=\"PROJECTILE_NET_BINDER\"       HIT_SOUND_ID=\"NetBinder\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/NINETEENNINETY.XML", "<ACTION ID=\"a_Nineteen Ninety\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_Skill_NineteenNine_01_01\"/>  <SLOT NAME=\"Com_Skill_NineteenNine_01_01\"/>  <SLOT NAME=\"Com_Skill_NineteenNine_01_02\"/>  <SLOT NAME=\"Com_Skill_NineteenNine_01_03\"/>  <FSM SCRIPT=\"Skill_NineteenNinety\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_DASH_ATTACK.XML", "<ACTION ID=\"a_nj_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"dash_attk_01\"/>	<FSM SCRIPT=\"Skill_Dash_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_01.XML", "<ACTION ID=\"a_nj_float_melee_01\" NEXT=\"a_jump\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_02.XML", "<ACTION ID=\"a_nj_float_melee_02\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_02\"/>	<FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_03.XML", "<ACTION ID=\"a_nj_float_melee_03\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_03\"/>	<FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_04.XML", "<ACTION ID=\"a_nj_float_melee_04\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_04\"/>	<FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_FLOATMELEE_05.XML", "<ACTION ID=\"a_nj_float_melee_05\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_05\"/>	<FSM SCRIPT=\"Act_FloatMelee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_MELEE_01.XML", "<ACTION ID=\"a_nj_melee_01\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_MELEE_02.XML", "<ACTION ID=\"a_nj_melee_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\"  >	<SLOT NAME=\"melee_02\"/>	<FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/NJ_MELEE_03.XML", "<ACTION ID=\"a_nj_melee_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >	<SLOT NAME=\"melee_03\"/>	<FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/NUCLEAR.XML", "<ACTION ID=\"a_nuclear\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Arc_Csb_Skill_NuClear_01\" />  <FSM SCRIPT=\"Skill_Nuclear\" PROJECTILE_ID=\"PROJECTILE_NUCLEAR\"		FIRE_SOUND_ID=\"NuClear_Shot\"	/>	  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/OBJECTBREAK.XML", "<ACTION ID=\"a_object_break\" TYPE=\"EFFECT\">  <SLOT NAME=\"die_01\"/>  <FSM SCRIPT=\"Act_Object_Break\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/OCTOPUSINK.XML", "<ACTION ID=\"a_Octopus Ink\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_04\"/>  <FSM SCRIPT=\"Skill_OctopusInk\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID=\"ef_Octopusink_01_char_root\"       HIT_SOUND_ID=\"OctopusInk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/OFFECSIVEAURA.XML", "<ACTION ID=\"a_Offecsive Aura\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_shot_04\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Offecsiveaura_01_char_root\"       HIT_SOUND_ID=\"OffenciveAura\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_A.XML", "<ACTION ID=\"a_ohs_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_a_Attk\"/>	<SLOT NAME=\"ohs_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"30\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_A_2.XML", "<ACTION ID=\"a_ohs_combo_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_a_2_Attk\"/>	<SLOT NAME=\"ohs_combo_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo06_a_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_A_3.XML", "<ACTION ID=\"a_ohs_combo_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_a_3_Attk\"/>	<SLOT NAME=\"ohs_combo_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo06_a_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_A_4.XML", "<ACTION ID=\"a_ohs_combo_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_a_4_Attk\"/>	<SLOT NAME=\"ohs_combo_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo06_a_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		SAVE_CAMERA_POS=\"TRUE\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.7\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_A_5.XML", "<ACTION ID=\"a_ohs_combo_a_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_a_5_Attk\"/>	<SLOT NAME=\"ohs_combo_a_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo06_a_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.2\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_A_6.XML", "<ACTION ID=\"a_ohs_combo_a_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_a_6_Attk\"/>	<SLOT NAME=\"ohs_combo_a_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo06_a_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.8\"		CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"					/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_B.XML", "<ACTION ID=\"a_ohs_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_b_Attk\"/>	<SLOT NAME=\"ohs_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_B_3.XML", "<ACTION ID=\"a_ohs_combo_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_b_3_Attk\"/>	<SLOT NAME=\"ohs_combo_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo05_b_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_B_4.XML", "<ACTION ID=\"a_ohs_combo_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_b_4_Attk\"/>	<SLOT NAME=\"ohs_combo_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo05_b_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_B_5.XML", "<ACTION ID=\"a_ohs_combo_b_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_b_5_Attk\"/>	<SLOT NAME=\"ohs_combo_b_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo05_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_C.XML", "<ACTION ID=\"a_ohs_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_c_Attk\"/>	<SLOT NAME=\"ohs_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo03\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_C_4.XML", "<ACTION ID=\"a_ohs_combo_c_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_c_4_Attk\"/>	<SLOT NAME=\"ohs_combo_c_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HiT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo03_c_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_C_4_5.XML", "<ACTION ID=\"a_ohs_combo_c_4_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_c_4_5_Attk\"/>	<SLOT NAME=\"ohs_combo_c_4_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ =\"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo04_c_4_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_C_4_6.XML", "<ACTION ID=\"a_ohs_combo_c_4_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_c_4_6_Attk\"/>	<SLOT NAME=\"ohs_combo_c_4_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo04_c_4_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_C_5.XML", "<ACTION ID=\"a_ohs_combo_c_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_c_5_Attk\"/>	<SLOT NAME=\"ohs_combo_c_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo03_c_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_C_6.XML", "<ACTION ID=\"a_ohs_combo_c_6\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_c_6_Attk\"/>	<SLOT NAME=\"ohs_combo_c_6_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo03_c_6\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_D.XML", "<ACTION ID=\"a_ohs_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_d_Attk\"/>	<SLOT NAME=\"ohs_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo04\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_D_5.XML", "<ACTION ID=\"a_ohs_combo_d_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_d_5_Attk\"/>	<SLOT NAME=\"ohs_combo_d_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		CAM_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo02_d_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_E.XML", "<ACTION ID=\"a_ohs_combo_e\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_e_Attk\"/>	<SLOT NAME=\"ohs_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ohs_combo05\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_A.XML", "<ACTION ID=\"a_ohs_combo_k_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_a_Attk\"/>	<SLOT NAME=\"ohs_combo_k_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_A_2.XML", "<ACTION ID=\"a_ohs_combo_k_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_a_2_Attk\"/>	<SLOT NAME=\"ohs_combo_k_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_A_3.XML", "<ACTION ID=\"a_ohs_combo_k_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_a_3_Attk\"/>	<SLOT NAME=\"ohs_combo_k_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_A_4.XML", "<ACTION ID=\"a_ohs_combo_k_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_a_4_Attk\"/>	<SLOT NAME=\"ohs_combo_k_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_B.XML", "<ACTION ID=\"a_ohs_combo_k_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_b_Attk\"/>	<SLOT NAME=\"ohs_combo_k_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_B_3.XML", "<ACTION ID=\"a_ohs_combo_k_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_b_3_Attk\"/>	<SLOT NAME=\"ohs_combo_k_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_B_4.XML", "<ACTION ID=\"a_ohs_combo_k_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_b_4_Attk\"/>	<SLOT NAME=\"ohs_combo_k_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_C.XML", "<ACTION ID=\"a_ohs_combo_k_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_c_Attk\"/>	<SLOT NAME=\"ohs_combo_k_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_C_4.XML", "<ACTION ID=\"a_ohs_combo_k_c_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_c_4_Attk\"/>	<SLOT NAME=\"ohs_combo_k_c_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/OHS_COMBO_K_D.XML", "<ACTION ID=\"a_ohs_combo_k_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ohs_combo_k_d_Attk\"/>	<SLOT NAME=\"ohs_combo_k_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.4\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ohs_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/OPENING.XML", "<ACTION ID=\"a_opening\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"Opening\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Opening\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/OPENING_MANUAL.XML", "<ACTION ID=\"a_opening_manual\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"Opening\"/>	<SLOT NAME=\"idle_01\" LOOP = \"TRUE\"/>	<FSM SCRIPT=\"Act_Opening_Manual\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/OPENING_MANUAL2.XML", "<ACTION ID=\"a_opening_manual2\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"Opening\"/>	<SLOT NAME=\"idle_01\" LOOP = \"TRUE\"/>	<FSM SCRIPT=\"Act_Opening_Manual2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/OPENING_MANUAL3.XML", "<ACTION ID=\"a_opening_manual3\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"Opening\"/>	<SLOT NAME=\"idle_01\" LOOP = \"TRUE\"/>	<FSM SCRIPT=\"Act_Opening_Manual3\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARAMMUTISHA/OPENING_MOVIE.XML", "<ACTION ID=\"a_opening_movie\" LOOP=\"FALSE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"opening_movie\"/>	<FSM SCRIPT=\"Act_Opening_Movie\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PADONG.XML", "<ACTION ID=\"a_Padong\" NEXT=\"a_cmd_broadcast\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>    <FSM SCRIPT=\"Cmd_Skill_Begin\"  	HIT_SOUND_ID=\"\"		CASTING_EFFECT_EFFECT_ID =\"ef_smog_03_char_root\" 	CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS = \"char_root\"	DETACH_CASTING_EFFECT_AT_FINISH = \"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PADONG_SUCCEED_0.XML", "<ACTION ID=\"a_Padong_Succeed_0\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"charge_03\"/>  <SLOT NAME=\"charge_03\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Cmd_Skill_Succeed\"  	HIT_SOUND_ID=\"\"		CASTING_EFFECT_EFFECT_ID =\"\" 	CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS = \"\"	DETACH_CASTING_EFFECT_AT_FINISH = \"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"		HIT_TIMER_TIME=\"2\"	HIT_TIMER_TICK=\"0.2\"	  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PADONG_SUCCEED_1.XML", "<ACTION ID=\"a_Padong_Succeed_1\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"charge_03\"/>  <SLOT NAME=\"charge_03\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Cmd_Skill_Succeed\"  	HIT_SOUND_ID=\"\"		CASTING_EFFECT_EFFECT_ID =\"\" 	CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS = \"\"	DETACH_CASTING_EFFECT_AT_FINISH = \"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PAREL/PAREL_DIE.XML", "<ACTION ID=\"a_parel_die\" NEXT=\"a_idle\" TYPE=\"EFFECT\">	<SLOT NAME=\"knockdown_01\"/>	<SLOT NAME=\"knockdown_idle_01\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_PAREL_Die\" VELOCITY=\"150\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PAREL/PAREL_JUMPATTACK.XML", "<ACTION ID=\"a_parel_jumpattack\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\">	<SLOT NAME=\"jumpattack_up\"/>	<SLOT NAME=\"jumpattack_down\" LOOP=\"TRUE\"/>	<SLOT NAME=\"jumpattack_getup\"/>	<FSM SCRIPT=\"Act_PAREL_JumpAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PARRING.XML", "<ACTION ID=\"a_Parring\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID=\"ef_Parring_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Parring_01_char_root\"       HIT_SOUND_ID=\"Parring\"       HIT_SOUND_ID_MALE=\"voice_male5\"       HIT_SOUND_ID_FEMALE=\"voice_female5\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/PARTICLECANON.XML", "<ACTION ID=\"a_particle_canon\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Csb_skill_ParticleCanon_01\"/>	<SLOT NAME=\"Csb_skill_ParticleCanon_02\"/>	<SLOT NAME=\"Csb_skill_ParticleCanon_03\"/>	<FSM SCRIPT=\"Skill_ParticleCanon\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/PARTICLECANONSA.XML", "<ACTION ID=\"a_particle_canon_sa\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Particle_Canon_Start\"/>	<FSM SCRIPT=\"Skill_ParticleCanonSA\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/PENETRATE.XML", "<ACTION ID=\"a_penetrate\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/PERFAECTSANCTUARY.XML", "<ACTION ID=\"a_Perfect Sanctuary\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_05\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"PerfectSan\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/ITEM_PRODUCE.XML", "<ACTION ID=\"a_PetItemProduce\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">   	<SLOT NAME=\"ItemProduce_01_start\"/>   	<SLOT NAME=\"ItemProduce_01_idle\"/>   	<SLOT NAME=\"ItemProduce_01_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\" 	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PETUIIDLE.XML", "<ACTION ID=\"a_PetUIIdle\" TYPE=\"IDLE\" NEXT=\"a_PetUIIdle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<SLOT NAME=\"idle_03\"/>	<SLOT NAME=\"hungry\"/>	<SLOT NAME=\"sleep\"/>	<SLOT NAME=\"annoy\"/>	<FSM SCRIPT=\"Act_PetUIIdle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/PET_MELEE_RIDING.XML", "<ACTION ID=\"a_pet_melee_01\" NEXT=\"a_riding_ground\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" MONITOR=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">   	<SLOT NAME=\"riding_shot_01\"/>	<FSM SCRIPT=\"PetMeleeRiding\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/PET_MELEE02_RIDING.XML", "<ACTION ID=\"a_pet_melee_02\" NEXT=\"a_riding_ground\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" MONITOR=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">   	<SLOT NAME=\"riding_shot_01\"/>	<FSM SCRIPT=\"PetMeleeRiding\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PET_OPENING.XML", "<ACTION ID=\"a_pet_opening\" NEXT=\"a_trace_ground2\">	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Pet_Opening\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A.XML", "<ACTION ID=\"a_pg_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_Attk\"/>	<SLOT NAME=\"pg_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				ORDER_ACTION_TIME_1=\"ENTER\"		ORDER_ACTION_TARGET_1=\"SC\"		ORDER_ACTION_NAME_1=\"a_twin_sub_repos\"		ORDER_ACTION_ALLOW_TARGET_ACTION_NAME_0_1=\"battle_idle\"		ORDER_ACTION_ALLOW_TARGET_ACTION_NAME_0_2=\"idle_01\"		ORDER_ACTION_ALLOW_TARGET_ACTION_NAME_0_3=\"run\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_mc_a\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_2.XML", "<ACTION ID=\"a_pg_combo_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_2_Attk\"/>	<SLOT NAME=\"pg_combo_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo05_mc_a_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_3.XML", "<ACTION ID=\"a_pg_combo_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_3_Attk\"/>	<SLOT NAME=\"pg_combo_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_3_F.XML", "<ACTION ID=\"a_pg_combo_a_3_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_3_f_Attk\"/>	<SLOT NAME=\"pg_combo_a_3_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"80\"		MOVE_COMPLETE_TIME_1=\"0.1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo05_fu_a_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"70\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_3_S.XML", "<ACTION ID=\"a_pg_combo_a_3_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_3_s_Attk\"/>	<SLOT NAME=\"pg_combo_a_3_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"60\"		MOVE_COMPLETE_TIME_1=\"0.1\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo05_sc_a_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"65\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_4.XML", "<ACTION ID=\"a_pg_combo_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_4_Attk\"/>	<SLOT NAME=\"pg_combo_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"80\"		MOVE_COMPLETE_TIME_1=\"0.2\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo05_mc_a_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"70\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_5.XML", "<ACTION ID=\"a_pg_combo_a_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_5_Attk\"/>	<SLOT NAME=\"pg_combo_a_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_5_F.XML", "<ACTION ID=\"a_pg_combo_a_5_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_5_f_Attk\"/>	<SLOT NAME=\"pg_combo_a_5_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"20\"		MOVE_COMPLETE_TIME_1=\"0.1\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"5\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo05_fu_a_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"20\" 		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_A_5_S.XML", "<ACTION ID=\"a_pg_combo_a_5_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_a_5_s_Attk\"/>	<SLOT NAME=\"pg_combo_a_5_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"60\"		MOVE_COMPLETE_TIME_1=\"0.1\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"5\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo05_sc_a_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"60\" 		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_B.XML", "<ACTION ID=\"a_pg_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_b_Attk\"/>	<SLOT NAME=\"pg_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_mc_b\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_B_3.XML", "<ACTION ID=\"a_pg_combo_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_b_3_Attk\"/>	<SLOT NAME=\"pg_combo_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo04_mc_b_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"40\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_B_4.XML", "<ACTION ID=\"a_pg_combo_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_b_4_Attk\"/>	<SLOT NAME=\"pg_combo_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"50\"		MOVE_COMPLETE_TIME_1=\"0.1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo04_mc_b_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"50\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_B_5.XML", "<ACTION ID=\"a_pg_combo_b_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_b_5_Attk\"/>	<SLOT NAME=\"pg_combo_b_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo04_fu_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_B_5_F.XML", "<ACTION ID=\"a_pg_combo_b_5_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_b_5_f_Attk\"/>	<SLOT NAME=\"pg_combo_b_5_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"120\"		MOVE_COMPLETE_TIME_1=\"0.4\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo04_fu_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_B_5_S.XML", "<ACTION ID=\"a_pg_combo_b_5_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_b_5_s_Attk\"/>	<SLOT NAME=\"pg_combo_b_5_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"70\"		MOVE_COMPLETE_TIME_1=\"0.4\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo04_fu_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C.XML", "<ACTION ID=\"a_pg_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_Attk\"/>	<SLOT NAME=\"pg_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C_4.XML", "<ACTION ID=\"a_pg_combo_c_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_4_Attk\"/>	<SLOT NAME=\"pg_combo_c_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"	USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"			CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"5\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"80\"		MOVE_COMPLETE_TIME_1=\"0.333\"		EFFECT_CNT_WHEN_HIT_MSG=\"1\"		EFFECT_TYPE_WHEN_HIT_MSG_1=\"7\"		EFFECT_ID_WHEN_HIT_MSG_1=\"efx_boxing_fu_skill_mrg_finish_impact_01\"		EFFECT_TARGET_NODE_WHEN_HIT_MSG_1=\"char_root\"		EFFECT_DIST_WHEN_HIT_MSG_1=\"0\"		EFFECT_SCALE_WHEN_HIT_MSG_1=\"1\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C_5.XML", "<ACTION ID=\"a_pg_combo_c_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_5_Attk\"/>	<SLOT NAME=\"pg_combo_c_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C_5_F.XML", "<ACTION ID=\"a_pg_combo_c_5_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_5_f_Attk\"/>	<SLOT NAME=\"pg_combo_c_5_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.333\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo03_sc_c_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"45\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C_5_S.XML", "<ACTION ID=\"a_pg_combo_c_5_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_5_s_Attk\"/>	<SLOT NAME=\"pg_combo_c_5_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"		USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"50\"		MOVE_COMPLETE_TIME_1=\"0.15\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo03_sc_c_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"90\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C_F.XML", "<ACTION ID=\"a_pg_combo_c_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_f_Attk\"/>	<SLOT NAME=\"pg_combo_c_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				WHEN_START_DIRECTION=\"CALLER\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"50\"		MOVE_COMPLETE_TIME_1=\"0.1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_fu_c\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"50\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_C_S.XML", "<ACTION ID=\"a_pg_combo_c_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_c_s_Attk\"/>	<SLOT NAME=\"pg_combo_c_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					WHEN_START_DIRECTION=\"CALLER\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"5\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.333\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_sc_c\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"60\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_D.XML", "<ACTION ID=\"a_pg_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_d_Attk\"/>	<SLOT NAME=\"pg_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"						TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"					MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"80\"		MOVE_COMPLETE_TIME_1=\"0.333\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_mc_d\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"80\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_D_5.XML", "<ACTION ID=\"a_pg_combo_d_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_d_5_Attk\"/>	<SLOT NAME=\"pg_combo_d_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_D_5_F.XML", "<ACTION ID=\"a_pg_combo_d_5_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_d_5_f_Attk\"/>	<SLOT NAME=\"pg_combo_d_5_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.333\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo02_fu_d_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"40\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_D_5_S.XML", "<ACTION ID=\"a_pg_combo_d_5_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_d_5_s_Attk\"/>	<SLOT NAME=\"pg_combo_d_5_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"20\"		MOVE_COMPLETE_TIME_1=\"0.333\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo02_sc_d_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT0_1=\"20\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_D_F.XML", "<ACTION ID=\"a_pg_combo_d_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_d_f_Attk\"/>	<SLOT NAME=\"pg_combo_d_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_fu_d\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"        EFFECT_DIST_WHEN_ANI_SLOT0_1=\"40\" 		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_E.XML", "<ACTION ID=\"a_pg_combo_e\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_e_Attk\"/>	<SLOT NAME=\"pg_combo_e_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_E_F.XML", "<ACTION ID=\"a_pg_combo_e_f\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_e_f_Attk\"/>	<SLOT NAME=\"pg_combo_e_f_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"40\"		MOVE_COMPLETE_TIME_1=\"0.1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_fu_e\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"        EFFECT_DIST_WHEN_ANI_SLOT0_1=\"40\" 		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/PG_COMBO_E_S.XML", "<ACTION ID=\"a_pg_combo_e_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"pg_combo_e_s_Attk\"/>	<SLOT NAME=\"pg_combo_e_s_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"				TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"5\"				TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"1\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"1\"					TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"60\"		MOVE_COMPLETE_TIME_1=\"0.1\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_pg_combo01_sc_e\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"        EFFECT_DIST_WHEN_ANI_SLOT0_1=\"60\"   				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PHANTOMCLONE.XML", "<ACTION ID=\"a_PhantomClone\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Kattar_skill_PhantomWarrior_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_Master_PhantomClone\"       FIRE_SOUND_ID=\"PhantomWarrior\"	   	   CASTING_SOUND_ID_MALE=\"Male_HwanYungBunSinSoul\"	   CASTING_SOUND_ID_FEMALE=\"Female_HwanYungBunSinSoul\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/NINJA_IDLE.XML", "<ACTION ID=\"a_Phantom_Ninja_idle\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"run\"/>	<FSM SCRIPT=\"Skill_Phantom_Ninja_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/NINJA_MELEE_01.XML", "<ACTION ID=\"a_Phantom_Ninja_melee_01\" NEXT=\"a_Phantom_Ninja_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"melee_01\"/>  <SLOT NAME=\"melee_02\"/>  <SLOT NAME=\"melee_03\"/>  <SLOT NAME=\"melee_01\"/>  <SLOT NAME=\"melee_02\"/>  <SLOT NAME=\"melee_03\"/>  <FSM SCRIPT=\"Skill_Phantom_Ninja_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/NINJA_MELEE_FINISH.XML", "<ACTION ID=\"a_Phantom_Ninja_melee_finish\" NEXT=\"a_Phantom_Ninja_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"attk_down_03\"/>  <SLOT NAME=\"dash_attk_01\"/>  <SLOT NAME=\"Com_skill_KillingMist_01\"/>  <FSM SCRIPT=\"Skill_Phantom_Ninja_Melee\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MASTER_SUMMON/IDLE.XML", "<ACTION ID=\"a_Phantom_Warrior_idle\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Skill_Phantom_Warrior_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/PINPOINTSHOT.XML", "<ACTION ID=\"a_Pin-Point Attack\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"csb_skill_PinpointShot_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"csb_skill_PinpointShot_01_02\"/>  <FSM SCRIPT=\"Projectile_Default\"      HIT_CASTER_EFFECT_TARGET_NODE=\"p_ef_head\"       HIT_CASTER_EFFECT_ID=\"ef_Pinpoint_01_char_root\"     /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/PINPOINTSHOT.XML", "<ACTION ID=\"a_Pin-Point Attack\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"csb_skill_PinpointShot_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"csb_skill_PinpointShot_01_02\"/>  <FSM SCRIPT=\"Projectile_Default\"      HIT_CASTER_EFFECT_TARGET_NODE=\"p_ef_head\"       HIT_CASTER_EFFECT_ID=\"ef_Pinpoint_01_char_root\"     /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PLAY.XML", "<ACTION ID=\"a_play\" NEXT=\"a_PetUIIdle\" >	<SLOT NAME=\"play\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PLAYANIMATION.XML", "<ACTION ID=\"a_play_animation\" NEXT=\"a_idle\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_PlayAnimation\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/POISON_CLOUD_A.XML", "<ACTION ID=\"a_poison_cloud_a\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       FIRE_SOUND_ID=\"skill-poison_cloud\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/POISON_CLOUD_B.XML", "<ACTION ID=\"a_poison_cloud_b\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       FIRE_SOUND_ID=\"skill-poison_cloud\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/POISON_CLOUD_C.XML", "<ACTION ID=\"a_poison_cloud_c\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       FIRE_SOUND_ID=\"skill-poison_cloud\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/POISON_CLOUD_PLAY_A.XML", "<ACTION ID=\"a_poison_cloud_play_a\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Pet_CloudFire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/POISON_CLOUD_PLAY_B.XML", "<ACTION ID=\"a_poison_cloud_play_b\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Pet_CloudFire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/POISON_CLOUD_PLAY_C.XML", "<ACTION ID=\"a_poison_cloud_play_c\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Pet_CloudFire\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND=\"CloudKill02\"        ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/POISON_GUARD.XML", "<ACTION ID=\"a_poison_guard\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"poison_guard_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"poison_guard_02\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_mon_poison_guard_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"		/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PORTAL.XML", "<ACTION ID=\"a_portal\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"ride_01\"/> <FSM SCRIPT=\"Act_Portal\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ITEMSKILL/A_POSEIDON_SKILL.XML", "<ACTION ID=\"a_poseidon_skill\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_shot_01\"/><FSM SCRIPT=\"Act_Melee_Default\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_archer_friendship\"		  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/PRAYER.XML", "<ACTION ID=\"a_Prayer\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        NO_WEAPON_TRAIL =\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/PRESSURE.XML", "<ACTION ID=\"a_Pressure\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_03\"/>  <FSM SCRIPT=\"Skill_Pressure\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/PRESSURE_PLAY.XML", "<ACTION ID=\"a_Pressure_Play\" NEXT=\"a_idle\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"drop\"/>  <FSM SCRIPT=\"Skill_Pressure_Play\"       HIT_SOUND_ID=\"Pressure\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/PRIDE.XML", "<ACTION ID=\"a_pride\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_pride\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/PROTECTEDGE.XML", "<ACTION ID=\"a_ProtectEdge\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Kattar_skill_ProtectEdge_01_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Kattar_skill_ProtectEdge_01_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_protect_edge_03_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_protect_edge_02_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/PROVOC.XML", "<ACTION ID=\"a_provoc\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_provoc_01\"/>	<SLOT NAME=\"emotion_provoc_02\"/>	<SLOT NAME=\"emotion_provoc_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PULL.XML", "<ACTION ID=\"a_pull\" TYPE=\"EFFECT\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg\" />  <FSM SCRIPT=\"Act_Pull\" EFFECT=\"ef_Pattern_Magnet_p_ef_star\" EFFECT_NODE=\"p_ef_star\" SCALE=\"3\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK.XML", "<ACTION ID=\"a_push_back\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK1.XML", "<ACTION ID=\"a_push_back1\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK2.XML", "<ACTION ID=\"a_push_back2\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_LONG.XML", "<ACTION ID=\"a_push_back_long\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_LONG1.XML", "<ACTION ID=\"a_push_back_long1\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_LONG2.XML", "<ACTION ID=\"a_push_back_long2\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_PUBLIC.XML", "<ACTION ID=\"a_push_back_public\" TYPE=\"EFFECT\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET = \"TRUE\">  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_public\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_SHORT.XML", "<ACTION ID=\"a_push_back_short\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_SHORT1.XML", "<ACTION ID=\"a_push_back_short1\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PUSHBACK_SHORT2.XML", "<ACTION ID=\"a_push_back_short2\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_PushBack_Fast\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/PVP_FLAG_DEFAULT.XML", "<ACTION ID=\"a_pvp_flag_default\" TYPE=\"IDLE\" NEXT=\"a_pvp_flag_default\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" MONITOR=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\">	<SLOT NAME=\"opening_01\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_PVP_FLAG\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/PVP_LOSE.XML", "<ACTION ID=\"a_pvp_lose\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_cry\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_PvP_Emotion\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/PVP_WIN.XML", "<ACTION ID=\"a_pvp_win\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_victory_01\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_PvP_Emotion\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/QUAGMIRE.XML", "<ACTION ID=\"a_Quagmire\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_07\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"Quagmire\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/QUAGMIRESET.XML", "<ACTION ID=\"a_Quagmire Set\" NEXT=\"a_idle\" LOOP=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/RAID.XML", "<ACTION ID=\"a_Raid\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Claw_Skill_Raid_01\"/>	<FSM SCRIPT=\"Skill_Raid\" 		FIRE_CASTER_EFFECT_ID=\"ef_Claw_Skill_Raid_01_char_root\" 		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		NO_WEAPON_TRAIL=\"FALSE\"		HIT_SOUND_ID=\"Raid\"       /> </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/RAINOFFIRE.XML", "<ACTION ID=\"a_Rain_Of_Fire\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">		<SLOT NAME=\"spell_02\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Staff_skill_LightningStorm_01_03\"/>		<FSM SCRIPT=\"Skill_RainOfFire\" 				CASTING_SOUND_ID=\"rainoffire-01\"				CASTING_EFFECT_TARGET_NODE=\"p_wp_r_hand\"        CASTING_EFFECT_EFFECT_ID=\"ef_skill_RainOfFire_01_p_wp_r_hand\"		 		CASTING_EFFECT_TARGET_NODE1=\"p_wp_l_hand\"		 CASTING_EFFECT_EFFECT_ID1=\"ef_skill_RainOfFire_01_p_wp_r_hand\"		 		 		FIRE_CASTER_EFFECT_ID=\"ef_skill_RainOfFire_00_char_root\" 		FIRE_CASTER_EFFECT_TARGET_NODE=\"__FRONT_ACTOR\"				FIRE_SOUND_ID=\"rainoffire-02\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       /> </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/FLOATDOWNSHOT.XML", "<ACTION ID=\"a_ran_floatdownshot\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Csb_jump_down_attk_02\"/>  <FSM SCRIPT=\"Skill_FloatDownShot\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RAPIDLY SHOT_CAST.XML", "<ACTION ID=\"a_Rapidly Shot_Cast\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Arc_Csb_skill_TwoActionshot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"FireShot\"	   HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID=\"ef_speedshot_02_char_root\"              />	   <!--	   CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_speedshot_01_char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"FALSE\"       CASTING_EFFECT_ID_DEFAULT_DETACH=\"FALSE\"	   --></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RAPIDLY SHOT_FIRE.XML", "<ACTION ID=\"a_Rapidly Shot_Fire\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"attk_02\"/>  <FSM SCRIPT=\"Projectile_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RAT_TRAP.XML", "<ACTION ID=\"a_Rat Trap\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"com_skill_buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/RECALL.XML", "<ACTION ID=\"a_Recall\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\"  USE-EVENT=\"TRUE\" >  <SLOT NAME=\"recall\"/>  <FSM SCRIPT=\"Skill_Regain\" 	USE_TLM=\"TRUE\"	USE_DMG_EFFECT=\"FALSE\"	AUTO_BROADCAST_WHEN_CASTING_COMPLETED = \"FALSE\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"	EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_recall_01\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"	EFFECT_DETACH_TIME_ANI_SLOT0_1=\"CLEAN_UP\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/RECOVERYAURA.XML", "<ACTION ID=\"a_Recovery Aura\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"RecoveryAura\"	   	   NO_WEAPON_TRAIL=\"TRUE\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       FIND_TARGET_TYPE=\"SPHERE\"	   	   />	   </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/REGAIN.XML", "<ACTION ID=\"a_Regain\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Skill_Regain\"/>  <FSM SCRIPT=\"Skill_Regain\" 		USE_TLM=\"TRUE\"		AUTO_BROADCAST_WHEN_CASTING_COMPLETED = \"FALSE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smn_regain_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REPOSITION.XML", "<ACTION ID=\"a_Reposition\" NEXT=\"a_idle\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Act_RePosition\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/RESOURCECONVERTER.XML", "<ACTION ID=\"a_Resource Converter\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resoruceconverter_01_char_root\"       HIT_SOUND_ID=\"ResourceCoverter\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REST.XML", "<ACTION ID=\"a_rest\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"sit_down\"/>	<SLOT NAME=\"sit_idle\"/>	<SLOT NAME=\"sit_up\"/>	<FSM SCRIPT=\"Act_Rest\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REST_EXP01.XML", "<ACTION ID=\"a_rest_exp01\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Com_Rest13_idle_01\"/>	<SLOT NAME=\"Com_Rest13_idle_02\"/>	<FSM SCRIPT=\"Act_Rest_Exp\"		 SA_CLASSNO=\"100001\"		 EFT_ID=\"70001610\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REST_EXP02.XML", "<ACTION ID=\"a_rest_exp02\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Com_Rest15_idle_01\"/>	<SLOT NAME=\"Com_Rest15_idle_02\"/>	<FSM SCRIPT=\"Act_Rest_Exp\"		 SA_CLASSNO=\"100002\"		 EFT_ID=\"70001620\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REST_EXP03.XML", "<ACTION ID=\"a_rest_exp03\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"Com_Rest14_idle_01\"/>	<SLOT NAME=\"Com_Rest14_idle_02\"/>	<FSM SCRIPT=\"Act_Rest_Exp\"		 SA_CLASSNO=\"100003\"		 EFT_ID=\"70001630\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REST_EXPSA01.XML", "<ACTION ID=\"a_rest_expSA01\" NEXT=\"a_idle\" TYPE=\"IDLE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<FSM SCRIPT=\"Act_Rest_ExpSA\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/RESURRECTION.XML", "<ACTION ID=\"a_Resurrection\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Skill_ResurrectCast\" FIND_TARGET_TYPE=\"SPHERE\"              CASTING_EFFECT_TARGET_NODE =\"char_root\"       CASTING_EFFECT_EFFECT_ID =\"ef_Resurrection_01_01_char_root\"                 HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID =\"ef_mag_charge01_result\"              NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"Rebirth\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RESURRECTION.XML", "<ACTION ID=\"a_Resurrection_01\" TYPE=\"EFFECT\" NEXT=\"a_idle\">  <SLOT NAME=\"Com_Resurrection_01\"/>  <FSM SCRIPT=\"Resurrecton01\"       NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/REVENGE.XML", "<ACTION ID=\"a_Revenge\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_revenge_02_char_root\"       HIT_SOUND_ID=\"Revenge\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REVERSEBLOWUP.XML", "<ACTION ID=\"a_reverse_blow_up\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\"  CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_Reverse_BlowUp\" VELOCITY=\"80\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REVERSEBLOWUPFAST.XML", "<ACTION ID=\"a_reverse_blow_up_fast\" TYPE=\"EFFECT\" NEXT=\"a_stand_up\"  CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_Reverse_BlowUp\" VELOCITY=\"120\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY.XML", "<ACTION ID=\"a_Reverse_Gravity\" NEXT=\"a_Reverse_Gravity2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Spear_skill_ReverseGravity_01_01\"/>  <FSM SCRIPT=\"Skill_Reverse_Gravity\"       HIT_TARGET_EFFECT_ID=\"ef_Reversegravity_03_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND=\"TRUE\"        FIRE_SOUND_ID=\"ReverseGravity\"				CASTING_SOUND_ID_MALE=\"Male_ReversGravity\"		CASTING_SOUND_ID_FEMALE=\"Female_ReversGravity\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY2.XML", "<ACTION ID=\"a_Reverse_Gravity2\" NEXT=\"a_Reverse_Gravity3\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Spear_skill_ReverseGravity_01_02\"/>  <FSM SCRIPT=\"Skill_Reverse_Gravity2\"       CHECK_CAN_PREV_ACTION_ID=\"a_Reverse_Gravity\"       QUAKE_TIME=\"1\"       QUAKE_POWER=\"5\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"       HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY3.XML", "<ACTION ID=\"a_Reverse_Gravity3\" NEXT=\"a_Reverse_Gravity4\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Spear_skill_ReverseGravity_01_03\"/>  <FSM SCRIPT=\"Skill_Reverse_Gravity2\"       CHECK_CAN_PREV_ACTION_ID=\"a_Reverse_Gravity2\"       HIT_TARGET_EFFECT_ID=\"ef_Reversegravity_03_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY4.XML", "<ACTION ID=\"a_Reverse_Gravity4\" NEXT=\"a_Reverse_Gravity5\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Spear_skill_ReverseGravity_01_04\"/>  <FSM SCRIPT=\"Skill_Reverse_Gravity2\"       CHECK_CAN_PREV_ACTION_ID=\"a_Reverse_Gravity3\"       QUAKE_TIME=\"1\"       QUAKE_POWER=\"5\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"       HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITY5.XML", "<ACTION ID=\"a_Reverse_Gravity5\" NEXT=\"a_Reverse_Gravity6\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Spear_skill_ReverseGravity_01_05\"/>  <FSM SCRIPT=\"Skill_Reverse_Gravity2\"       CHECK_CAN_PREV_ACTION_ID=\"a_Reverse_Gravity4\"       HIT_TARGET_EFFECT_ID=\"ef_Reversegravity_03_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/REVERSEGRAVITYFINISH.XML", "<ACTION ID=\"a_Reverse_Gravity6\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\"  ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Spear_skill_ReverseGravity_01_06\" />  <FSM SCRIPT=\"Skill_Reverse_Gravity2\"       CHECK_CAN_PREV_ACTION_ID=\"a_Reverse_Gravity5\"       END_ACTION =\"TRUE\"       QUAKE_TIME=\"1\"       QUAKE_POWER=\"7\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"       HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/REVIVE.XML", "<ACTION ID=\"a_revive\" TYPE=\"EFFECT\" NEXT=\"a_idle\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Revive\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RIDE.XML", "<ACTION ID=\"a_ride\" LOOP=\"TRUE\" NEXT=\"a_ride_idle\">	<SLOT NAME=\"riding_idle\"/>	<FSM SCRIPT=\"Act_Riding\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RIDE_IDLE.XML", "<ACTION ID=\"a_ride_idle\" LOOP=\"TRUE\" NEXT=\"a_ride_idle\">	<SLOT NAME=\"riding_idle\"/>	<FSM SCRIPT=\"Act_Riding_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RIDE_RUN.XML", "<ACTION ID=\"a_ride_run\" LOOP=\"TRUE\" NEXT=\"a_ride_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"riding_idle\"/>	<FSM SCRIPT=\"Act_Riding_Run\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RIDINGOBJECT_MOVE.XML", "<ACTION ID=\"a_ridingobject_move\" NEXT=\"a_idle\" TYPE=\"MOVE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_RidingObject_Move\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RIDING_GROUND.XML", "<ACTION ID=\"a_riding_ground\" TYPE=\"IDLE\" NEXT=\"a_trace_ground2\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<SLOT NAME=\"idle_03\"/>	<SLOT NAME=\"btlidle_01\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"riding_run\"/>	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"jump_01\"/>	<SLOT NAME=\"jump_02\"/>	<SLOT NAME=\"jump_idle_01\"/>	<SLOT NAME=\"jump_03\"/>	<SLOT NAME=\"jump_idle_02\"/>	<SLOT NAME=\"dmg_01\"/>	<SLOT NAME=\"btlidle_01_shot_start\"/>	<SLOT NAME=\"btlidle_01_shot\"/>	<SLOT NAME=\"shot_01\"/>		<SLOT NAME=\"warp_01\"/>	<SLOT NAME=\"r_idle_01\"/>		<FSM SCRIPT=\"Act_Riding_Ground\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ROCKETPUNCH.XML", "<ACTION ID=\"a_Rocket Punch\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Claw_Skill_Rocket_Punch_01\"/>  <FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID=\"PROJECTILE_ROCKETPUNCH\" ATTACH_NODE_ID=\"Bip01 R Hand\" HIT_SOUND_ID=\"RocketPunch1\"       FIRE_CASTER_EFFECT_ID=\"ef_roket_punch_p_ef_point\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"Bip01 R Hand\"       DETACH_FIRE_CASTER_EFFECT_AT_HIT=\"TRUE\"       SKILL_LEVEL_TO_SIZE=\"TRUE\"       SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE=\"0.3\"       SKILL_LEVEL_TO_SIZE_DOT_POINT=\"0.14\"       SKILL_LEVEL_TO_SIZE_LEVEL_POINT=\"1\"       HIDE_WEAPON=\"TRUE\"        /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ROCK_PUNCH.XML", "<ACTION ID=\"a_Rock_Punch\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC=\"TRUE\">  <SLOT NAME=\"Rock_Punch_start\"/>  <SLOT NAME=\"Rock_Punch_btlidle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Rock_Punch_rush\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"Rock_Punch_finish\"/>  <FSM SCRIPT=\"Sum_Rock_Punch\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/ROLLINGLOG.XML", "<ACTION ID=\"a_Rolling Log\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Debuff_02_01\"/>    <FSM SCRIPT=\"Skill_InstallDefault\"         CASTING_EFFECT_TARGET_NODE=\"char_root\"         CASTING_EFFECT_EFFECT_ID=\"ef_RollingLog_01_char_root\"		 DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		 CASTING_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"         CASTING_SOUND_ID=\"RollingLog\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/ROLLINGLOG_PLAY.XML", "<ACTION ID=\"a_Rolling Log Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_RollingLog_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/ROLLING_A.XML", "<ACTION ID=\"a_rolling_a\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"wheelwind_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_rolling_00_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_star\"       HIT_TARGET_EFFECT_ID=\"ef_rolling_01_p_ef_star\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       ROTATION_ANGLE_VALUE_TICK=\"15\"        FIRE_SOUND_ID=\"skill-rolling\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ROLLING_ATTACK.XML", "<ACTION ID=\"a_Rolling_Attack\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" DONT_LOOK_TARGET=\"TRUE\" NO_SET_WALKING_TARGET_LOC=\"TRUE\">  <SLOT NAME=\"Rolling_Attack_start\"/>  <SLOT NAME=\"Rolling_Attack_btlidle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Rolling_Attack_rush\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"Rolling_Attack_finish\"/>  <FSM SCRIPT=\"Skill_Sum_Rolling_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/ROLLING_B.XML", "<ACTION ID=\"a_rolling_b\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"wheelwind_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_rolling_00_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_star\"       HIT_TARGET_EFFECT_ID=\"ef_rolling_01_p_ef_star\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       ROTATION_ANGLE_VALUE_TICK=\"15\"        FIRE_SOUND_ID=\"skill-rolling\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/ROLLING_C.XML", "<ACTION ID=\"a_rolling_c\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"wheelwind_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_rolling_00_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_star\"       HIT_TARGET_EFFECT_ID=\"ef_rolling_01_p_ef_star\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       ROTATION_ANGLE_VALUE_TICK=\"15\"        FIRE_SOUND_ID=\"skill-rolling\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/ROLLINGGROUND.XML", "<ACTION ID=\"a_rolling_ground\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Onehand_skill_RollingGround_01\"/>	<SLOT NAME=\"Onehand_skill_RollingGround_02\"/>	<SLOT NAME=\"Onehand_skill_RollingGround_03\"/>	<FSM SCRIPT=\"Skill_RollingGround\"       FIRE_SOUND_ID=\"RollingGround\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ROLLING_STONE_CAST.XML", "<ACTION ID=\"a_rolling_stone_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">		<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"rolling_stone_01\"/>	<SLOT NAME=\"rolling_stone_02\"/>    <FSM SCRIPT=\"CommonSkillAction\"			USE_TLM=\"FALSE\"				HIDE_WEAPON_WHEN_ANI_SLOT1=\"TRUE\"					/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/ROLLING_STONE_FIRE.XML", "<ACTION ID=\"a_rolling_stone_fire\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"opening\"/>  <SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				AUTO_BROADCAST=\"FALSE\"				WHEN_ATTACK_TIMER_START=\"ENTER\"		ATTACK_TIMER_TIME=\"60\"		ATTACK_TIMER_TICK=\"0.5\"					NO_DAMAGE_HOLD =\"TRUE\"				MOVE_TYPE_1=\"V\"		MOVE_GOAL_POS_TARGET_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_SPEED_1=\"50\"					EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_mon_rolling_stone_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT1_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"eff_sum_skill_mon_rolling_stone_01\"				EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1.1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"CLEAN_UP\"						EFFECT_TYPE_WHEN_ANI_SLOT2_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_2=\"eff_sum_skill_mon_rolling_stone_04\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_2=\"1.5\"		EFFECT_DETACH_TIME_ANI_SLOT2_2=\"ANI_DONE\"				CLEANUP_CASTER_EFFECT_CNT=\"1\"			CLEANUP_CASTER_EFFECT_TYPE_1=\"5\"		CLEANUP_CASTER_EFFECT_ID_1=\"eff_sum_skill_mon_rolling_stone_02\"		CLEANUP_CASTER_EFFECT_TARGET_NODE_1=\"char_root\"		CLEANUP_CASTER_EFFECT_SCALE_1=\"1\"		CLEANUP_SOUND_ID = \"frozen_shot\"		HIT_SOUND_ID=\"sum-hit-01\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ROPE.XML", "<ACTION ID=\"a_rope\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"rope_idle\"/>	<SLOT NAME=\"rope_01\"/>	<FSM SCRIPT=\"Act_Rope\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/ROPERIDING.XML", "<ACTION ID=\"a_rope_riding\" NEXT=\"a_idle\" CAN_CHANGE_ACTOR_POS=\"FALSE\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_RopeRiding\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/ROULETTE.XML", "<ACTION ID=\"a_Roulette\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Skill_Roulette\"       HIT_SOUND_ID=\"Dice_Result\"       NO_USE_TLM=\"TRUE\"       FIRE_CASTER_EFFECT_ID=\"ef_gamble_001_p_ef_star\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_star\"       FIND_TARGET_TYPE=\"SPHERE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/ROWDY.XML", "<ACTION ID=\"a_rowdy\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_rowdy_01\"/>	<SLOT NAME=\"emotion_rowdy_02\"/>	<SLOT NAME=\"emotion_rowdy_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RP_IDLE.XML", "<ACTION ID=\"a_rp_idle\" NEXT=\"a_rp_idle\" LOOP=\"TRUE\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_RP_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RP_JUMP.XML", "<ACTION ID=\"a_rp_jump\" NEXT=\"a_rp_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" MONITOR=\"TRUE\" >	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_RP_Jump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RP_WALK.XML", "<ACTION ID=\"a_rp_walk\" NEXT=\"a_rp_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_RP_Walk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RUN.XML", "<ACTION ID=\"a_run\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" CAN_FOLLOW=\"TRUE\" MONITOR=\"TRUE\" USE_CFUNC=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"run\" LOOP=\"TRUE\"/>	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Run\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RUN_KOONA.XML", "<ACTION ID=\"a_run_koona\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" CAN_FOLLOW=\"TRUE\" MONITOR=\"TRUE\" USE_CFUNC=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"carry_run\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Run_Bear\"		BAN_USER_INPUT_SC_SKILL=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/RUN_PET.XML", "<ACTION ID=\"a_run_pet\" NEXT=\"a_trace_ground2\" OVERRIDE_PACKET=\"TRUE\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\">	<SLOT NAME=\"run\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Run_Pet\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/RUSH.XML", "<ACTION ID=\"a_rush\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_rush_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/ITEMSKILL_RYVIUS.XML", "<ACTION ID=\"a_ryvius\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">    <SLOT NAME=\"Common_Com_Skill_Dark_Wheelwind_01\"/>    <FSM SCRIPT=\"Skill_InstallDefault\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/COMMON/ITEMSKILL_RYVIUS_FIRE.XML", "<ACTION ID=\"a_ryvius_fire\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\" USE-EVENT=\"TRUE\">    <SLOT NAME=\"attk_01\"/>    <FSM SCRIPT=\"Skill_BackDraft_Fire\" 	NO_DAMAGE_HOLD = \"TRUE\"	NO_TICK_ATTACK = \"TRUE\"	DARK_BG = \"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SAKURASPRINKLE.XML", "<ACTION ID=\"a_Sakura Sprinkle01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_SakuraSprinkle_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        CASTING_EFFECT_TARGET_NODE =\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_metamorphosis_skill_sakurasprinkle_01\"	   DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"	   CASTING_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"    /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/SANCTUARY.XML", "<ACTION ID=\"a_Sanctuary\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_down_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"Sanctuary\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/SANCTUARY.XML", "<ACTION ID=\"a_Sanctuary\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_down_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       HIT_SOUND_ID=\"Sanctuary\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/SANCTUARY_PLAY.XML", "<ACTION ID=\"a_Sanctuary_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"opening\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"die_01\"/>  <FSM SCRIPT=\"Skill_Santuary_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/SANCTUARY_PLAY.XML", "<ACTION ID=\"a_Sanctuary_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"opening\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"die_01\"/>  <FSM SCRIPT=\"Skill_Santuary_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SA_CLASS_PROMOTION_ACT_DRAGONIAN.XML", "<ACTION ID=\"a_sa_class_promotion_act_dragonian\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"dragonian\" LOOP=\"TRUE\"/>	<SLOT NAME=\"dragonian\"/>  	<FSM SCRIPT=\"CommonSkillAction\"				USE_TLM=\"FALSE\"		REMOVE_ON_NEXTUPDATE=\"TRUE\"						C_CAM_MSG_KEEP=\"0\"		C_CAM_MSG_TYPE_1=\"10010\"		C_CAM_MSG_CAMERA_NAME_1=\"camera01\"						MSG_ALPHA_START_1=\"1\"		MSG_ALPHA_END_1=\"0\"		MSG_ALPHA_TIME_1=\"0.5\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SA_CLASS_PROMOTION_ACT_HUMAN.XML", "<ACTION ID=\"a_sa_class_promotion_act_human\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"human\" LOOP=\"TRUE\"/>	<SLOT NAME=\"human\"/>  	<FSM SCRIPT=\"CommonSkillAction\"				USE_TLM=\"FALSE\"		REMOVE_ON_NEXTUPDATE=\"TRUE\"				C_CAM_MSG_KEEP=\"0\"		C_CAM_MSG_TYPE_1=\"10010\"		C_CAM_MSG_CAMERA_NAME_1=\"camera01\"						MSG_ALPHA_START_1=\"1\"		MSG_ALPHA_END_1=\"0\"		MSG_ALPHA_TIME_1=\"0.5\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SA_DRAGON_RAGE_ACT.XML", "<ACTION ID=\"a_sa_dragon_rage_act\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"fire\"/>	<SLOT NAME=\"finish\"/>  	<FSM SCRIPT=\"CommonSkillAction\"				USE_TLM=\"FALSE\"		REMOVE_ON_NEXTUPDATE=\"TRUE\"				MSG_ALPHA_START_1=\"0.001\"		MSG_ALPHA_END_1=\"1\"		MSG_ALPHA_TIME_1=\"2\"						MSG_ALPHA_START_2=\"1\"		MSG_ALPHA_END_2=\"0\"		MSG_ALPHA_TIME_2=\"0.5\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"10002\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_dragon_rage_skill_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"					/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/SCREWUPPER.XML", "<ACTION ID=\"a_Screw Upper\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_ScrewUpper_01\"/>  <SLOT NAME=\"Com_skill_ScrewUpper_02\"/>  <FSM SCRIPT=\"Skill_ScrewUpper\"        FIRE_CASTER_EFFECT_ID=\"ef_Claw_Skill_Raid_01_char_root\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"ScrewUpper\"	   	   NO_DAMAGE_HOLD=\"FALSE\"	   DAMAGE_HOLD_TIME=\"\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_SELF_HEAL.XML", "<ACTION ID=\"a_Self Heal\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_04\"/>  <FSM SCRIPT=\"Skill_Self_Heal\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/SELFBOMBER.XML", "<ACTION ID=\"a_SelfBomber\" NEXT=\"a_SelfBomber2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\"/>  <SLOT NAME=\"Self_Bomber_skill_01_01\"/>  <SLOT NAME=\"Self_Bomber_skill_01_02\"/>  <FSM SCRIPT=\"Skill_Striker_SelfBomber\"	   FIRE_SOUND_ID=\"SelfBomber\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/STRIKER/SELFBOMBER2.XML", "<ACTION ID=\"a_SelfBomber2\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Arc_Csb_Skill_SelfBomber_01\"/>  <FSM SCRIPT=\"Skill_Striker_SelfBomber2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SERVEROBJECT_MOVE.XML", "<ACTION ID=\"a_serverobject_move\" NEXT=\"a_idle\" TYPE=\"MOVE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_ServerObject_Move\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/SERVILE_BEG.XML", "<ACTION ID=\"a_servile_beg\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_beg_04\"/>	<SLOT NAME=\"emotion_beg_05\"/>	<SLOT NAME=\"emotion_beg_06\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/SEVEN.XML", "<ACTION ID=\"a_Seven\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Seven_01\"/>  <FSM SCRIPT=\"Skill_Seven\"			          FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Seven_01_char_root\"		       HIT_SOUND_ID=\"seven\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOWCOPY.XML", "<ACTION ID=\"a_Shadow Copy\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_SonicBoom_01\"/>  <FSM SCRIPT=\"Skill_InstallSelf\"       HIT_SOUND_ID=\"ShadowCopy\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOWLEAP.XML", "<ACTION ID=\"a_Shadow Leap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_skill_ShadowLeap_01_01\"/>  <SLOT NAME=\"Com_skill_ShadowLeap_01_02\"/>  <FSM SCRIPT=\"Skill_ShadowLeap\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/SHADOWWALK.XML", "<ACTION ID=\"a_Shadow Walk\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"ShadowWalk\"       NO_WEAPON_TRAIL=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/SHADOWBLADE.XML", "<ACTION ID=\"a_ShadowBlade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Kattar_skill_PhantomWarrior_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_Shadow_ShadowBlade\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_shadow_blade_02_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_shadow_blade_01_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		CASTING_SOUND_ID=\"ShadowBlade_Cast\"		FIRE_SOUND_ID=\"ShadowBlade\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/SHADOWBLADESA.XML", "<ACTION ID=\"a_ShadowBladeSA\" NEXT=\"a_ShadowBladeSAFinish\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Skill_ShadowBlade_01_01\"/>  <FSM SCRIPT=\"Skill_Shadow_ShadowBladeSA\"  		CASTING_EFFECT_EFFECT_ID=\"ef_smog_03_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_shadow_blade_03_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		NO_DAMAGE_HOLD=\"TRUE\"		MULTI_HIT_NUM=\"3\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SHADOW/SHADOWBLADESAFINISH.XML", "<ACTION ID=\"a_ShadowBladeSAFinish\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Skill_ShadowBlade_01_02\"/>  <FSM SCRIPT=\"Skill_Shadow_ShadowBladeSAFinish\"  		CASTING_EFFECT_EFFECT_ID=\"\"		CASTING_EFFECT_TARGET_NODE=\"\"		FIRE_CASTER_EFFECT_ID=\"\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"\"		FIRE_SOUND_ID=\"Ninja_Dash_Attk\"		NO_DAMAGE_HOLD=\"TRUE\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SHARPSHOOTING.XML", "<ACTION ID=\"a_Sharp Shooting\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Bow_skill_SharpShooting_01\"/>  <SLOT NAME=\"Bow_skill_SharpShooting_02\"/>  <FSM SCRIPT=\"SharpShooting\" PROJECTILE_ID =\"PROJECTILE_SHARPSHOOTING\"       HIT_SOUND_ID=\"SharpShooting\"       FIRE_SOUND_ID=\"SharpShooting_Start\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_SharpShooting_01_char_root\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/SHIELDSTRIKE.XML", "<ACTION ID=\"a_shieldstrike\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Fig_Onehand_skill_Shield_Strike_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"eff_Shield_Strike_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       FIRE_SOUND_ID=\"\"      	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/SHOULDERTACKLE.XML", "<ACTION ID=\"a_shoulder_tackle\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Com_skill_ShoulderTackle_01\"/>  <SLOT NAME=\"Com_skill_ShoulderTackle_02\"/>  <FSM SCRIPT=\"ShoulderTackle\" FIRE_SOUND_ID=\"ShoulderTackle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/SHOUT.XML", "<ACTION ID=\"a_Shout\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Shout_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Shout_01_char_root\"       FIND_TARGET_TYPE=\"SPHERE\"       HIT_SOUND_ID=\"shout\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SHOUT_OF_LIFE.XML", "<ACTION ID=\"a_Shout_of_Life\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"shout_of_life_cast\" LOOP=\"TRUE\"/> 	<SLOT NAME=\"shout_of_life_fire\"/> 	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_shout_of_life_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Bip01 L Hand\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"			EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_smw_shout_of_life_03\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/SIEGE_CANNON.XML", "<ACTION ID=\"a_Siege Cannon\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/SIEGECANNONFIRE.XML", "<ACTION ID=\"a_siegecanon_fire\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID=\"Projectile_GroundUpper\" NO_AUTO_CONNECT=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SILENCETRAP.XML", "<ACTION ID=\"a_Silence Trap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_RatTrap_01\"/>  <SLOT NAME=\"Bow_Skill_JumpTrap_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"Freezing_Trap\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SILENCETRAPACTIVE.XML", "<ACTION ID=\"a_Silence Trap Active\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Trap_Play\"       TYPE=\"BOMB\"       SERACH_TYPE=\"FULLSEARCH\"       BOMB_EFFECT_ID=\"ef_Trap_Silemnce_02\"       BOME_AFTER_EFFECT_ID=\"e_ef_fossilearth_explosion\"       BOME_AFTER_EFFECT_SCALE=\"0.4\"       HIT_SOUND_ID=\"Deapodong\"       BOME_AFTER_SOUND_ID=\"SplashTrap2\"	          IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_ID=\"ef_Trap_Silemnce_01\"       IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_TARGET_NODE_POS=\"Dummy01\"	          INSTALL_EFFECT_ID2=\"ef_dust_01\"       INSTALL_EFFECT_TARGET_NODE_POS2=\"Dummy01\"	   	   TRANSFORM_EFFECT_ID=\"ef_dust_01\"       TRANSFORM_EFFECT_TARGET_NODE_POS=\"Dummy01\"	   TRANSFORM_SOUND_ID=\"Needle_Trap_01\"	   	   TARGET_SCALE=\"0.5\"	   TARGET_SCALE_TIME=\"1000\"	          FIND_TARGET_TYPE=\"SPHERE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SIT_DOWN.XML", "<ACTION ID=\"a_sit_down\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"sit_down\"/>	<SLOT NAME=\"sit_idle\"/>	<SLOT NAME=\"sit_up\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SKYPIERCE.XML", "<ACTION ID=\"a_Sky Pirce01\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_SkyPrice_01\"/>  <FSM SCRIPT=\"StormBlade\"  	FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"    FIRE_CASTER_EFFECT_ID=\"ef_storm_blade_char_root\"	FIRE_CASTER_EFFECT_SCALE=\"1\"    FIRE_SOUND_ID=\"StormBlade\"		RISING_MOVING_DELTA=\"50\"    NO_WEAPON_TRAIL=\"TRUE\"	SPIN_DEG_PER_SEC=\"2760\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/SLEEP.XML", "<ACTION ID=\"a_sleep\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_sleep_02\"/>	<SLOT NAME=\"emotion_sleep_02\"/>	<SLOT NAME=\"emotion_sleep_03\"/>	<FSM SCRIPT=\"Act_Single_Emotion_ThreeStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/SLEEPSMELL.XML", "<ACTION ID=\"a_Sleep Smell\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_SleepSmell_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_SleepSmell_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"SleepSmell\"       FIND_TARGET_TYPE=\"SPHERE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SLOWHEAL.XML", "<ACTION ID=\"a_Slow Heal\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_slowheal_01_02_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE=\"char_root\"       HIT_CASTER_EFFECT_ID =\"ef_slowheal_01_char_root\"       	   FIRE_SOUND_ID=\"SlowHeal\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SLEEP.XML", "<ACTION ID=\"a_Slumber\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" LOOP=\"TRUE\">  <SLOT NAME=\"Stun\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Stun\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SMART_SHOT_CAST.XML", "<ACTION ID=\"a_smart_shot_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"smart_shot_cast\" LOOP=\"TRUE\"/> 	<SLOT NAME=\"smart_shot_castfire\"/> 		<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_common_mon_energy07\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Bip01 L Finger1\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_mon_smart_shot_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SMART_SHOT_FIRE.XML", "<ACTION ID=\"a_smart_shot_fire\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Smart_Rifle_Shot\"/> 	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"TRUE\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_SMART_SHOT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.3\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"0.6\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"0.5\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.4\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"0.7\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_A.XML", "<ACTION ID=\"a_smart_shot_fire_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_a_Attk\"/>	<SLOT NAME=\"gs_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"TRUE\"				FIRE_PROJECTILE_NUM_FROM_PARENT_SKILL_NO=\"300301301\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_SMART_SHOT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.3\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"0.6\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"0.5\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.4\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"0.7\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_B.XML", "<ACTION ID=\"a_smart_shot_fire_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_b_Attk\"/>	<SLOT NAME=\"gs_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"TRUE\"				FIRE_PROJECTILE_NUM_FROM_PARENT_SKILL_NO=\"300301301\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_SMART_SHOT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.3\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"0.6\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"0.5\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.4\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"0.7\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_C.XML", "<ACTION ID=\"a_smart_shot_fire_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_c_Attk\"/>	<SLOT NAME=\"gs_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"TRUE\"				FIRE_PROJECTILE_NUM_FROM_PARENT_SKILL_NO=\"300301301\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_SMART_SHOT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.3\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"0.6\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"0.5\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.4\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"0.7\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SMART_SHOT_FIRE_COMBO_D.XML", "<ACTION ID=\"a_smart_shot_fire_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"gs_combo_d_Attk\"/>	<SLOT NAME=\"gs_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"TRUE\"				FIRE_PROJECTILE_NUM_FROM_PARENT_SKILL_NO=\"300301301\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_SMART_SHOT\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"1\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"				FIRE_PROJECTILE_START_NODE_POS_1 = \"p_ef_fire\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"1\"				FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.3\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"0.6\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.2\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"0.5\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"15\"		FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.4\"				FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"		FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"-15\"		FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"0.7\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"0\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_sum_skill_smn_muzz00\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"p_ef_fire\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SMOKEGRANADE.XML", "<ACTION ID=\"a_Smoke Granade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Projectile_HandGrenade\" PROJECTILE_ID =\"PROJECTILE_HEGrenade\"       ATTACH_NODE_ID=\"p_wp_r_hand\"       HIDE_WEAPON=\"TRUE\"       HIT_SOUND_ID=\"WP_Granade_Fire\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SMOKEGRANADEACTIVE.XML", "<ACTION ID=\"a_Smoke Granade Active\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_BackDraft_Fire\"       FIND_TARGET_TYPE=\"SPHERE\"       ATTACK_TIME=\"1.0\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SNATCHDOWN.XML", "<ACTION ID=\"a_snatch_down\"  TYPE=\"EFFECT\" NEXT=\"a_idle\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"idle_01\" />  <FSM SCRIPT=\"Act_SnatchDown\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/SNIPING.XML", "<ACTION ID=\"a_sniping\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Arc_Csb_skill_Sniping_01_01\"/>  <SLOT NAME=\"Arc_Csb_skill_Sniping_01_02\"/>  <SLOT NAME=\"Arc_Csb_skill_Sniping_01_03\"/>  <FSM SCRIPT=\"Sniping\"  	HIT_SOUND_ID=\"sniping_01_03-02\"    FIRE_SOUND_ID=\"sniping_01_03-01\"    CASTING_EFFECT_TARGET_NODE=\"\"    CASTING_EFFECT_EFFECT_ID=\"\"	   	FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"	FIRE_CASTER_EFFECT_ID=\"eff_skill_Sniping_02\"			START_EFFECT_ID=\"eff_skill_Sniping_01\"	START_EFFECT_TARGET_NODEI=\"char_root\"    /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/SNOWBLUES.XML", "<ACTION ID=\"a_Snow Blues\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_07\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"SnowBlues\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/SNOWBLUES_PLAY.XML", "<ACTION ID=\"a_Snow Blues Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"walk\"/>  <SLOT NAME=\"walk_2\"/>  <SLOT NAME=\"walk_3\"/>  <FSM SCRIPT=\"Skill_SnowBlues_Play\"	HIT_TARGET_EFFECT_ID=\"ef_Blizzard_00002\"	HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/SOMERSAULTKICK.XML", "<ACTION ID=\"a_Somersaultkick\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" >	<SLOT NAME=\"Com_skill_SomersaultKick_01\"/>	<FSM SCRIPT=\"Skill_SomersaultKick\"       CASTING_EFFECT_TARGET_NODE =\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_SomersaultKick_01_char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       NO_WEAPON_TRAIL=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/SONICBOOM.XML", "<ACTION ID=\"a_Sonic Boom\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Ground_01\"/>  <FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID=\"Projectile_Boomerang\" ATTACH_NODE_ID=\"Bip01 L Hand\"       FIRE_CASTER_EFFECT_ID=\"ef_SonicBoom_01_p_wp_l_hand\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_wp_r_hand\"       DETACH_FIRE_CASTER_EFFECT_AT_HIT=\"TRUE\"       HIDE_WEAPON=\"TRUE\"       HIT_SOUND_ID=\"SonicBoom\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/SORRY.XML", "<ACTION ID=\"a_sorry\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_sorry_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/SOULDRAIN1.XML", "<ACTION ID=\"a_SoulDrain1\" NEXT=\"a_SoulDrain2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"skill_summon_01_01\"/>  <FSM SCRIPT=\"Skill_WarLord_SoulDrain_Ready\"       CASTING_EFFECT_EFFECT_ID=\"ef_skill_souldrain_02_char_root\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_flash_02\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_SOUND_ID=\"SoulDrain_emp\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/SOULDRAIN2.XML", "<ACTION ID=\"a_SoulDrain2\" NEXT=\"a_SoulDrain3\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"skill_summon_01_02\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Skill_WarLord_SoulDrain\"       FIRE_CASTER_EFFECT_ID=\"\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"\"	   HIT_TARGET_EFFECT_ID =\"ef_skill_souldrain_03_P_ef_head\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"	   HIT_SOUND_ID=\"\"	   MULTI_HIT_NUM=\"10\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/SOULDRAIN3.XML", "<ACTION ID=\"a_SoulDrain3\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"skill_summon_01_03\"/>  <FSM SCRIPT=\"Skill_WarLord_SoulDrain_Finish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/A_SOULDRAIN_PLAY.XML", "<ACTION ID=\"a_SoulDrain_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"SoulDrain_Skill_01_start\"/>  <SLOT NAME=\"SoulDrain_Skill_01_attack\" LOOP=\"TRUE\"/>  <SLOT NAME=\"SoulDrain_Skill_01_finish\"/>  <FSM SCRIPT=\"Skill_SoulDrain_play\"		FIRE_CASTER_EFFECT_ID=\"\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/SPARK_ROCK.XML", "<ACTION ID=\"a_Spark_Rock\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  	<SLOT NAME=\"Com_Guild_spell_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Com_Skill_Debuff_02_01\"/>>    <FSM SCRIPT=\"Skill_InstallDefault\"         CASTING_EFFECT_TARGET_NODE=\"p_wp_r_hand\"         CASTING_EFFECT_EFFECT_ID=\"ef_skill_SparkRock_00_p_wp_r_hand\"		 		 CASTING_EFFECT_TARGET_NODE1=\"p_wp_l_hand\"		 CASTING_EFFECT_EFFECT_ID1=\"ef_skill_SparkRock_00_p_wp_r_hand\"         CASTING_SOUND_ID=\"sparkrock-01\"		 		 DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		 /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/SPARK_ROCK_PLAY.XML", "<ACTION ID=\"a_Spark_Rock_Play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Spark_Rock_Play\"	 INSTALL_EFFECT_TARGET_NODE=\"char_root\"	 INSTALL_EFFECT_ID=\"ef_Skill_SparkRock\"	 FIRE_CASTER_SCALE_NORMALIZE=\"60\"	 ENTER_TIMER_TIME=\"\"     ENTER_TIMER_TICK=\"0.3\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SPARK_WAVE_CAST.XML", "<ACTION ID=\"a_spark_wave_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">		<SLOT NAME=\"spark_wave_cast\" LOOP=\"TRUE\"/>		<SLOT NAME=\"spark_wave_fire\"/>    <FSM SCRIPT=\"CommonSkillAction\"		USE_TLM=\"FALSE\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SPARK_WAVE_FIRE.XML", "<ACTION ID=\"a_spark_wave_fire\" NEXT=\"a_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				WHEN_ATTACK_TIMER_START=\"ENTER\"		ATTACK_TIMER_TIME=\"60\"		ATTACK_TIMER_TICK=\"0.5\"					NO_DAMAGE_HOLD =\"TRUE\"								EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_smn_ivy_rush_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"p_ef_point\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				HIT_SOUND_ID=\"sum-hit-04-elec\"	/>		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SPAWN.XML", "<ACTION ID=\"a_spawn\" NEXT=\"a_idle\">	<SLOT NAME=\"opening_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Spawn\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/SPEARJAB.XML", "<ACTION ID=\"a_Spear Jab\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_skill_Spear_Jab_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        MULTI_HIT_NUM=\"5\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"Onehand_skill_Spear_Jab_01_char_root\"   	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       WEAPON_XML=\"Item/Common/12_Weapon/09_special/SpearJab.xml\"       NO_WEAPON_TRAIL=\"TRUE\"       NO_DAMAGE_HOLD=\"TRUE\"       MULTI_HIT_RANDOM_OFFSET=\"15\"       HIT_TARGET_EFFECT_RANDOM_OFFSET=\"7\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SPECIFICIDLE.XML", "<ACTION ID=\"a_SpecificIdle\" TYPE=\"EFFECT\" NEXT=\"a_SpecificIdle\" LOOP=\"TRUE\">  <SLOT NAME=\"SpecificIdle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"SpecificIdle_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"SpecificIdle_03\" LOOP=\"TRUE\"/>  <SLOT NAME=\"SpecificIdle_04\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_SpecificIdle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SPELL_01.XML", "<ACTION ID=\"a_spell_01\" NEXT=\"a_idle\" LOOP=\"TRUE\">	<SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Spell\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/SPIRALCANNON.XML", "<ACTION ID=\"a_Spiral Cannon\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_04\"/>  <SLOT NAME=\"Com_Shot_08\"/>  <FSM SCRIPT=\"Skill_SpiralCannon\"        FIND_TARGET_TYPE=\"BAR\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_mag_Spiralcannon_01_char_root\"       FIRE_SOUND_ID=\"SprialCannon\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/SPLASHTRAP.XML", "<ACTION ID=\"a_Splash Trap\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_skill_RatTrap_01\"/>  <SLOT NAME=\"Bow_Skill_JumpTrap_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"SplashTrap1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/SPLASHTRAP_EXPLOSION.XML", "<ACTION ID=\"a_Splash Trap_Explosion\" NEXT=\"a_battle_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Trap_Play\"        TYPE=\"BOMB\"       SERACH_TYPE=\"FULLSEARCH\"        BOMB_EFFECT_ID=\"ef_Splash_Trap_dummy01\"        BOME_AFTER_EFFECT_ID=\"e_ef_fossilearth_explosion\"        BOME_AFTER_EFFECT_SCALE=\"0.4\"       HIT_SOUND_ID=\"Deapodong\"       BOME_AFTER_SOUND_ID=\"SplashTrap2\"	          IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_ID=\"ef_Trap_Splash_01\"       IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_TARGET_NODE_POS=\"Dummy01\"	          INSTALL_EFFECT_ID2=\"ef_dust_01\"       INSTALL_EFFECT_TARGET_NODE_POS2=\"Dummy01\"	   	   TRANSFORM_EFFECT_ID=\"ef_dust_01\"       TRANSFORM_EFFECT_TARGET_NODE_POS=\"Dummy01\"	   TRANSFORM_SOUND_ID=\"Needle_Trap_01\"	   	   TARGET_SCALE=\"0.5\"	   TARGET_SCALE_TIME=\"1000\"	          FIND_TARGET_TYPE=\"SPHERE\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_APPEAR.XML", "<ACTION ID=\"a_sp_appear\" NEXT=\"a_idle\">	<SLOT NAME=\"openning\"/>	<FSM SCRIPT=\"Act_SP_Appear\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_01.XML", "<ACTION ID=\"a_sp_attk_01\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_01_01\"/>	<SLOT NAME=\"attk_01_03\"/>	<SLOT NAME=\"attk_01_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_01\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_02.XML", "<ACTION ID=\"a_sp_attk_02\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_02_01\"/>	<SLOT NAME=\"attk_02_03\"/>	<SLOT NAME=\"attk_02_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_02\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_03.XML", "<ACTION ID=\"a_sp_attk_03\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_03_01\"/>	<SLOT NAME=\"attk_03_03\"/>	<SLOT NAME=\"attk_03_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_03\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_04.XML", "<ACTION ID=\"a_sp_attk_04\" NEXT=\"a_idle\">	<!--    -->	<SLOT NAME=\"attk_04_01\"/>	<SLOT NAME=\"attk_04_02\"/>	<SLOT NAME=\"attk_04_03\"/>	<FSM SCRIPT=\"Act_SP_Attk_04\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_05.XML", "<ACTION ID=\"a_sp_attk_05\" NEXT=\"a_idle\">	<!--    -->	<SLOT NAME=\"attk_05_01\"/>	<SLOT NAME=\"attk_05_02\"/>	<SLOT NAME=\"attk_05_03\"/>	<FSM SCRIPT=\"Act_SP_Attk_05\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_06.XML", "<ACTION ID=\"a_sp_attk_06\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_06\"/>	<FSM SCRIPT=\"Act_SP_Attk_06\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_07.XML", "<ACTION ID=\"a_sp_attk_07\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_07_01\"/>	<SLOT NAME=\"attk_07_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_07\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_08.XML", "<ACTION ID=\"a_sp_attk_08\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_08_01\"/>	<SLOT NAME=\"attk_08_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_08\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_09.XML", "<ACTION ID=\"a_sp_attk_09\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_01_01\"/>	<SLOT NAME=\"attk_01_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_09\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_10.XML", "<ACTION ID=\"a_sp_attk_10\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_02_01\"/>	<SLOT NAME=\"attk_02_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_10\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_11.XML", "<ACTION ID=\"a_sp_attk_11\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_04_01\"/>	<SLOT NAME=\"attk_04_02\"/>	<SLOT NAME=\"attk_04_03\"/>	<SLOT NAME=\"attk_08_01\"/>	<SLOT NAME=\"attk_02_03\"/>	<SLOT NAME=\"attk_02_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_11\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_12.XML", "<ACTION ID=\"a_sp_attk_12\" NEXT=\"a_idle\">	<SLOT NAME=\"attk_05_01\"/>	<SLOT NAME=\"attk_05_02\"/>	<SLOT NAME=\"attk_05_03\"/>	<SLOT NAME=\"attk_07_01\"/>	<SLOT NAME=\"attk_01_03\"/>	<SLOT NAME=\"attk_01_02\"/>	<FSM SCRIPT=\"Act_SP_Attk_12\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_ATTK_13.XML", "<ACTION ID=\"a_sp_attk_13\" NEXT=\"a_idle\"> <!--    -->	<SLOT NAME=\"attk_07\"/>	<FSM SCRIPT=\"Act_SP_Attk_13\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_A.XML", "<ACTION ID=\"a_sp_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_a_Attk\"/>	<SLOT NAME=\"sp_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_B.XML", "<ACTION ID=\"a_sp_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_b_Attk\"/>	<SLOT NAME=\"sp_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_C.XML", "<ACTION ID=\"a_sp_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_c_Attk\"/>	<SLOT NAME=\"sp_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_D.XML", "<ACTION ID=\"a_sp_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_d_Attk\"/>	<SLOT NAME=\"sp_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_1.XML", "<ACTION ID=\"a_sp_combo_z_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_1_Attk\"/>	<SLOT NAME=\"sp_combo_z_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"		TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_sp_combo_z_4\"		TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_sp_combo_z_1_2_3\"		TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_sp_combo_z_1_3\"		TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_sp_combo_z_2_3_4\"		TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_sp_combo_z_2_4\"		TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_sp_combo_z_3_4\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_1_2.XML", "<ACTION ID=\"a_sp_combo_z_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_1_2_Attk\"/>	<SLOT NAME=\"sp_combo_z_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo06_z_1_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_1_2_3.XML", "<ACTION ID=\"a_sp_combo_z_1_2_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_1_2_3_Attk\"/>	<SLOT NAME=\"sp_combo_z_1_2_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo07_z_1_2_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_st_combo07_z_1_2_3_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"Weapon_Bone01_R\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_1_3.XML", "<ACTION ID=\"a_sp_combo_z_1_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_1_3_Attk\"/>	<SLOT NAME=\"sp_combo_z_1_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo06_z_1_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_2.XML", "<ACTION ID=\"a_sp_combo_z_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_2_Attk\"/>	<SLOT NAME=\"sp_combo_z_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_2_3.XML", "<ACTION ID=\"a_sp_combo_z_2_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_2_3_Attk\"/>	<SLOT NAME=\"sp_combo_z_2_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo04_z_2_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_Magician_z_3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"char_root\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_DEG1_1=\"-12.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"12.833\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_2_3_4.XML", "<ACTION ID=\"a_sp_combo_z_2_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_2_3_4_Attk\"/>	<SLOT NAME=\"sp_combo_z_2_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_Magician_z_2_3_4\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"char_root\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo05_z_2_3_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_2_4.XML", "<ACTION ID=\"a_sp_combo_z_2_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_2_4_Attk\"/>	<SLOT NAME=\"sp_combo_z_2_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo04_z_2_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_3.XML", "<ACTION ID=\"a_sp_combo_z_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_3_Attk\"/>	<SLOT NAME=\"sp_combo_z_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_3_4.XML", "<ACTION ID=\"a_sp_combo_z_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_3_4_Attk\"/>	<SLOT NAME=\"sp_combo_z_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"				EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo03_z_3_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_st_combo03_z_3_4_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/SP_COMBO_Z_4.XML", "<ACTION ID=\"a_sp_combo_z_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"sp_combo_z_4_Attk\"/>	<SLOT NAME=\"sp_combo_z_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"3\"				EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_st_combo02_z_4_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_3=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_3=\"eff_st_combo02_z_4_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_3=\"Weapon_Bone01_R\"		EFFECT_SCALE_WHEN_ANI_SLOT0_3=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_3=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_DAMAGE.XML", "<ACTION ID=\"a_sp_damage\" NEXT=\"a_idle\">	<SLOT NAME=\"dmg_01\"/>	<FSM SCRIPT=\"Act_SP_Damage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SAPPHIRE_DRAGON/SP_DIE.XML", "<ACTION ID=\"a_sp_damage\" NEXT=\"a_idle\">	<SLOT NAME=\"die\"/>	<FSM SCRIPT=\"Act_SP_Die\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/STAND_UP.XML", "<ACTION ID=\"a_stand_up\" NEXT=\"a_battle_idle\" TYPE=\"IDLE\">	<SLOT NAME=\"StandUp\"/>	<FSM SCRIPT=\"Act_StandUp\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/STEP_THE_BEAT.XML", "<ACTION ID=\"a_step_the_beat\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_CASTER_EFFECT_ID=\"\"       HIT_CASTER_EFFECT_TARGET_NODE=\"\"       HIT_TARGET_EFFECT_ID=\"\"       HIT_TARGET_EFFECT_TARGET_NODE=\"\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       	   CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR=\"45\"	   HIT_SOUND_ID=\"stepthebit01\"	          FIND_TARGET_TYPE=\"SPHERE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/STEP_THE_BEAT_IDLE.XML", "<ACTION ID=\"a_step_the_beat_idle\" TYPE=\"IDLE\" NEXT=\"a_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"StepTheBeat_idle\"/>  <SLOT NAME=\"StepTheBeat_idle\"/>  <SLOT NAME=\"StepTheBeat_idle\"/>	<FSM SCRIPT=\"Act_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/STORMBLADE.XML", "<ACTION ID=\"a_storm blade\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StormBlade_01\"/>  <FSM SCRIPT=\"StormBlade\"  	FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"    FIRE_CASTER_EFFECT_ID=\"ef_storm_blade_char_root\"	FIRE_CASTER_EFFECT_SCALE=\"1\"    FIRE_SOUND_ID=\"StormBlade\"		RISING_MOVING_DELTA=\"50\"	SPIN_DEG_PER_SEC=\"2760\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/STRIKING.XML", "<ACTION ID=\"a_Striking\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       NO_WEAPON_TRAIL =\"TRUE\"       HIT_SOUND_ID=\"Striking\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/STRIPWEAPON.XML", "<ACTION ID=\"a_Strip Weapon\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_StripWeapon_01_char_root\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_SOUND_ID=\"StripWeapon\"       />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/STUMBLEBUM.XML", "<ACTION ID=\"a_Stumblebum\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_02\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Stumblebum_01_char_root\"       HIT_SOUND_ID_MALE=\"Male_Shout\"       HIT_SOUND_ID_FEMALE=\"Female_Shout\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/STUN.XML", "<ACTION ID=\"a_stun\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" LOOP=\"TRUE\">  <SLOT NAME=\"Stun\" LOOP=\"TRUE\"/>  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Stun\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_A.XML", "<ACTION ID=\"a_st_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_a_Attk\"/>	<SLOT NAME=\"st_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"								FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_A_DOUBLESHOT.XML", "<ACTION ID=\"a_st_combo_a_Doubleshot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_a_Attk\"/>	<SLOT NAME=\"st_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_A_THREEWAY.XML", "<ACTION ID=\"a_st_combo_a_ThreeWay\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_a_Attk\"/>	<SLOT NAME=\"st_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV6=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV7=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV8=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV9=\"3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV10=\"3\"					FIRE_PROJECTILE_DEG1_1=\"0\"		FIRE_PROJECTILE_DEG1_2=\"25\"		FIRE_PROJECTILE_DEG1_3=\"-25\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_B.XML", "<ACTION ID=\"a_st_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_b_Attk\"/>	<SLOT NAME=\"st_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_B_DOUBLESHOT.XML", "<ACTION ID=\"a_st_combo_b_Doubleshot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_b_Attk\"/>	<SLOT NAME=\"st_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_B_THREEWAY.XML", "<ACTION ID=\"a_st_combo_b_ThreeWay\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_b_Attk\"/>	<SLOT NAME=\"st_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_DEG1_1=\"0\"		FIRE_PROJECTILE_DEG1_2=\"25\"		FIRE_PROJECTILE_DEG1_3=\"-25\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_C.XML", "<ACTION ID=\"a_st_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_c_Attk\"/>	<SLOT NAME=\"st_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_C_DOUBLESHOT.XML", "<ACTION ID=\"a_st_combo_c_Doubleshot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_c_Attk\"/>	<SLOT NAME=\"st_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_C_THREEWAY.XML", "<ACTION ID=\"a_st_combo_c_ThreeWay\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_c_Attk\"/>	<SLOT NAME=\"st_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_DEG1_1=\"0\"		FIRE_PROJECTILE_DEG1_2=\"25\"		FIRE_PROJECTILE_DEG1_3=\"-25\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_D.XML", "<ACTION ID=\"a_st_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_d_Attk\"/>	<SLOT NAME=\"st_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_D_DOUBLESHOT.XML", "<ACTION ID=\"a_st_combo_d_Doubleshot\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_d_Attk\"/>	<SLOT NAME=\"st_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"						FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"							FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_1=\"10\"		FIRE_PROJECTILE_START_POS_ADD_Z_1_2=\"-10\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_D_THREEWAY.XML", "<ACTION ID=\"a_st_combo_d_ThreeWay\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_d_Attk\"/>	<SLOT NAME=\"st_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"		USE_MOVE_CONTROL=\"TRUE\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_MAGIC_PROJECTILE\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"ef_enchant_01\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_DEG1_1=\"0\"		FIRE_PROJECTILE_DEG1_2=\"25\"		FIRE_PROJECTILE_DEG1_3=\"-25\"		HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"				EFFECT_CNT_WHEN_FIRE_MSG=\"1\"		EFFECT_TYPE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_ID_WHEN_FIRE_MSG_1=\"eff_st_combo01_abcd\"		EFFECT_TARGET_NODE_WHEN_FIRE_MSG_1=\"ef_enchant_01\"		EFFECT_SCALE_WHEN_FIRE_MSG_1=\"1\"		EFFECT_DETACH_TIME_FIRE_MSG_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_1.XML", "<ACTION ID=\"a_st_combo_z_1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_1_Attk\"/>	<SLOT NAME=\"st_combo_z_1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"		TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_st_combo_z_4\"		TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_st_combo_z_1_2_3\"		TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_st_combo_z_1_3\"		TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_st_combo_z_2_3_4\"		TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_st_combo_z_2_4\"		TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_st_combo_z_3_4\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_1_2.XML", "<ACTION ID=\"a_st_combo_z_1_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_1_2_Attk\"/>	<SLOT NAME=\"st_combo_z_1_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo06_z_1_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_1_2_3.XML", "<ACTION ID=\"a_st_combo_z_1_2_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_1_2_3_Attk\"/>	<SLOT NAME=\"st_combo_z_1_2_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo07_z_1_2_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_st_combo07_z_1_2_3_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"Weapon_Bone01_R\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_1_3.XML", "<ACTION ID=\"a_st_combo_z_1_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_1_3_Attk\"/>	<SLOT NAME=\"st_combo_z_1_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo06_z_1_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_2.XML", "<ACTION ID=\"a_st_combo_z_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_2_Attk\"/>	<SLOT NAME=\"st_combo_z_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_2_3.XML", "<ACTION ID=\"a_st_combo_z_2_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_2_3_Attk\"/>	<SLOT NAME=\"st_combo_z_2_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo04_z_2_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_Magician_z_3\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"3\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"char_root\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"					FIRE_PROJECTILE_DEG1_1=\"-12.215\"		FIRE_PROJECTILE_DEG1_2=\"0\"		FIRE_PROJECTILE_DEG1_3=\"12.833\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_2_3_4.XML", "<ACTION ID=\"a_st_combo_z_2_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_2_3_4_Attk\"/>	<SLOT NAME=\"st_combo_z_2_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_Magician_z_2_3_4\"		FIRE_PROJECTILE_START_NODE_POS_1 = \"char_root\"		FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"			FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"			HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo05_z_2_3_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"			/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_2_4.XML", "<ACTION ID=\"a_st_combo_z_2_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_2_4_Attk\"/>	<SLOT NAME=\"st_combo_z_2_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo04_z_2_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_3.XML", "<ACTION ID=\"a_st_combo_z_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_3_Attk\"/>	<SLOT NAME=\"st_combo_z_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_3_4.XML", "<ACTION ID=\"a_st_combo_z_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_3_4_Attk\"/>	<SLOT NAME=\"st_combo_z_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"				EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo03_z_3_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_st_combo03_z_3_4_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/ST_COMBO_Z_4.XML", "<ACTION ID=\"a_st_combo_z_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"st_combo_z_4_Attk\"/>	<SLOT NAME=\"st_combo_z_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"						EFFECT_CNT_WHEN_ANI_SLOT0=\"3\"				EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"7\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_st_combo02_z_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_st_combo02_z_4_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"\"		EFFECT_TYPE_WHEN_ANI_SLOT0_3=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_3=\"eff_st_combo02_z_4_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_3=\"Weapon_Bone01_R\"		EFFECT_SCALE_WHEN_ANI_SLOT0_3=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_3=\"\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON.XML", "<ACTION ID=\"a_Summon\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_ATTACK.XML", "<ACTION ID=\"a_summon_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"summon_attack\"/> 	<FSM SCRIPT=\"Skill_Regain\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"		AUTO_BROADCAST_WHEN_CASTING_COMPLETED = \"FALSE\"								EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_mon_protect_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				FIRE_CASTER_EFFECT_CNT=\"1\"		FIRE_CASTER_EFFECT_TYPE_1=\"2\"		FIRE_CASTER_EFFECT_ID_1=\"eff_sum_skill_mon_protect_00\"		FIRE_CASTER_EFFECT_TARGET_NODE_1=\"char_root\"		FIRE_CASTER_EFFECT_SCALE_1=\"1\"		FIRE_CASTER_EFFECT_HORIZ_DEG_1=\"0\"		FIRE_CASTER_EFFECT_VERT_DEG_1=\"0\"		FIRE_CASTER_EFFECT_DIST_1=\"150\"		NO_DAMAGE_HOLD=\"TRUE\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_BLASSER.XML", "<ACTION ID=\"a_Summon_Blasser\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONBOMBER.XML", "<ACTION ID=\"a_Summon_Demolition_Bomber\" NEXT=\"a_Summon_Demolition_Bomber2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Twohand_skill_Demolition_Bomber_01\" />  <FSM SCRIPT=\"Skill_Master_Summon_Common\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_Demolition_Bomber_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_Demolition_Bomber_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       FIRE_SOUND_ID=\"DemolitionBomber\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"       SUMMON_CLASSNO=\"900102\"       SUMMON_RESERVE_ACTION=\"a_Demolition_Bomber_idle\"	   	   CASTING_SOUND_ID_MALE=\"Male_DemolitionBomber\"	   CASTING_SOUND_ID_FEMALE=\"Female_DemolitionBomber\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/DEMOLITION/DEMOLITIONBOMBERFINISH.XML", "<ACTION ID=\"a_Summon_Demolition_Bomber2\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\"  ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Twohand_skill_Demolition_Bomber_02\" />  <FSM SCRIPT=\"Skill_Master_Summon_Finish\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_boom_01\"       CHECK_CAN_PREV_ACTION_ID=\"a_Summon_Demolition_Bomber\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_DIKE.XML", "<ACTION ID=\"a_Summon_Dike\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/DRAGONRUSH.XML", "<ACTION ID=\"a_Summon_Dragon_Rush\" NEXT=\"a_Summon_Dragon_Rush2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_skill_DragonRush_01\" />  <FSM SCRIPT=\"Skill_Master_Summon_Common\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_Dragon_Rush_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID2=\"ef_skill_Dragon_Rush_02_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"       FIRE_SOUND_ID=\"DragonRush\"       DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	       HIT_TIMER_TIME=\"1.8\"       HIT_TIMER_TICK=\"0.2\"       SUMMON_CLASSNO=\"900103\"       SUMMON_RESERVE_ACTION=\"a_Demolition_Bomber_idle\"	   	   CASTING_SOUND_ID_MALE=\"Male_DragonRush\"	   CASTING_SOUND_ID_FEMALE=\"Female_DragonRush\"	   	   MULTIPLE_ATTACK=\"TRUE\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/DRAGONKNIGHT/DRAGONRUSHFINISH.XML", "<ACTION ID=\"a_Summon_Dragon_Rush2\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\"  ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Onehand_skill_DragonRush_02\" />  <FSM SCRIPT=\"Skill_Master_Summon_Finish\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_skill_dragon_rush_lightning_01\"       CHECK_CAN_PREV_ACTION_ID=\"a_Summon_Dragon_Rush\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_DRAGOON.XML", "<ACTION ID=\"a_Summon_Dragoon\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>   <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_DUNAMIC.XML", "<ACTION ID=\"a_Summon_Dunamic\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_GORGON.XML", "<ACTION ID=\"a_Summon_Gorgon\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_KALKY.XML", "<ACTION ID=\"a_Summon_Kalky\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>  <FSM SCRIPT=\"Skill_Summon\" />  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUMMON_MIST.XML", "<ACTION ID=\"a_Summon_Mist\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"Skill_Summon\"/>   <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"		USE_DMG_EFFECT=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_DASH_ATTACK.XML", "<ACTION ID=\"a_Sum_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"dash_attk_01\"/>	<FSM SCRIPT=\"Skill_Dash_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_DOWN_ATTACK_01.XML", "<ACTION ID=\"a_Sum_Down_Attack_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_DOWN_ATTACK_02.XML", "<ACTION ID=\"a_Sum_Down_Attack_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_DOWN_ATTACK_03.XML", "<ACTION ID=\"a_Sum_Down_Attack_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_RIFLE_CHARGESHOT.XML", "<ACTION ID=\"a_Sum_Rifle_ChargeShot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Sum_Rifle_ChargeShot\"	PROJECTILE_ID=\"PROJECTILE_RIFLE_CHARGE_SHOT\"	HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"	HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit00\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_RIFLE_JUMP_SHOT_01.XML", "<ACTION ID=\"a_Sum_Rifle_Jump_Shot_01\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Sum_Rifle_Jump_Shot\"	PROJECTILE_ID=\"PROJECTILE_RIFLE_DEFAULT_SHOT\"	HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"	HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/SUM_RIFLE_SHOT.XML", "<ACTION ID=\"a_Sum_Rifle_Shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Rifle_Shot\"/>  <FSM SCRIPT=\"Sum_Rifle_Shot\"	PROJECTILE_ID=\"PROJECTILE_RIFLE_DEFAULT_SHOT\"	HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"	HIT_TARGET_EFFECT_ID=\"eff_sum_common_hit01\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/SURPRISE.XML", "<ACTION ID=\"a_surprise\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_surprise_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/SWIFTATTACK.XML", "<ACTION ID=\"a_Swiftattack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\">  	<SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Skill_Swiftattack\"       PROJECTILE_ID=\"PROJECTILE_SWIFTATTACK\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/SWORDDANCE.XML", "<ACTION ID=\"a_sword_dance\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"SwordDance\" PROJECTILE_ID=\"PROJECTILE_SWORDDANCE\"		HIT_SOUND_ID =\"ShieldBoom\"		HIDE_WEAPON=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/SYNC_MOVE.XML", "<ACTION ID=\"a_sync_move\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Sync_Move\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/TALK.XML", "<ACTION ID=\"a_talk\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_talk_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/TAUNT.XML", "<ACTION ID=\"a_taunt\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"Com_shot_04\" LOOP=\"TRUE\"/>	<FSM SCRIPT=\"Act_Melee_Default\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"\"		FIRE_CASTER_EFFECT_ID=\"\"		HIT_SOUND_ID=\"buff_prov\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/TAURINE_SUPPORT.XML", "<ACTION ID=\"a_taurine_support\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"shot_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"              FIRE_SOUND_ID=\"self_heal_root\"	   NO_USE_TLM=\"TRUE\"	   NO_DEFAULT_HIT_EFFECT =\"TRUE\"	   HIT_TARGET_EFFECT_ID=\"ef_skill_heal_self\"	   HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEJUMP.XML", "<ACTION ID=\"a_telejump\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" SMALLL_AREA_CHECK=\"FALSE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"jump_01\"/>	<SLOT NAME=\"jump_02\"/>	<SLOT NAME=\"jump_03\"/>	<SLOT NAME=\"jump_04\"/>	<SLOT NAME=\"ride_01\"/>	<FSM SCRIPT=\"Act_TeleJump\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEPORT.XML", "<ACTION ID=\"a_teleport\" NEXT=\"a_teleport_out\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"EFFECT\" KIND_OF_TRIGGER_ACTION=\"TRUE\">	<SLOT NAME=\"teleport\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"ladder_idle\"/> <!--      . -->	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"Com_Bootster_up\"/>	<FSM SCRIPT=\"Act_Teleport\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEPORT01.XML", "<ACTION ID=\"a_teleport01\" NEXT=\"a_teleport01_out\" USE-EVENT=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"EFFECT\">	<SLOT NAME=\"teleport01\"/>	<SLOT NAME=\"teleport02\"/>	<FSM SCRIPT=\"Act_Teleport01\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEPORT01_OUT.XML", "<ACTION ID=\"a_teleport01_out\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"EFFECT\">	<SLOT NAME=\"teleport01_out\"/>	<SLOT NAME=\"teleport02_out\"/>	<FSM SCRIPT=\"Act_Teleport01_Out\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEPORT_OUT.XML", "<ACTION ID=\"a_teleport_out\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"EFFECT\" KIND_OF_TRIGGER_ACTION=\"TRUE\">	<SLOT NAME=\"teleport_out\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"jump_01\"/>	<SLOT NAME=\"ride_01\"/>	<SLOT NAME=\"Com_Booster_down\"/>	<FSM SCRIPT=\"Act_Teleport_Out\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEPORT_ROCKET.XML", "<ACTION ID=\"a_teleport_rocket\" NEXT=\"a_teleport_rocket_out\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" TYPE=\"EFFECT\" KIND_OF_TRIGGER_ACTION=\"TRUE\">	<SLOT NAME=\"Com_Bootster_up\"/>	<FSM SCRIPT=\"Act_Teleport_Rocket\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TELEPORT_ROCKET_OUT.XML", "<ACTION ID=\"a_teleport_rocket_out\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"EFFECT\" KIND_OF_TRIGGER_ACTION=\"TRUE\">	<SLOT NAME=\"Com_Booster_down\"/>	<FSM SCRIPT=\"Act_Teleport_Rocket_Out\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/TEMPTATION_CAST.XML", "<ACTION ID=\"a_temptation_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"temptation_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"temptation_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"1\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_temptation_magic00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/TESLACOIL.XML", "<ACTION ID=\"a_tesla_coil\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_skill_RatTrap_01\"/>  <SLOT NAME=\"Bow_Skill_JumpTrap_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\"       FIRE_SOUND_ID=\"\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/TESLACOIL_PLAY.XML", "<ACTION ID=\"a_tesla_coil_play\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <FSM SCRIPT=\"Skill_Spark_Rock_Play\"	 INSTALL_EFFECT_TARGET_NODE=\"char_root\"	 INSTALL_EFFECT_ID=\"ef_Skill_SparkRock\"	 FIRE_CASTER_SCALE_NORMALIZE=\"60\"	 	 ENTER_TIMER_TIME=\"\"     ENTER_TIMER_TICK=\"0.6\"	 	 FOLLOW_PLAYER_DIRECTION=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THIEF_CHARGE_ATTACK.XML", "<ACTION ID=\"a_thief_charge_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Skill_Melee_Charge_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THIEFFLOATMELEE_01.XML", "<ACTION ID=\"a_thief_float_melee_01\" NEXT=\"a_jump\"  CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"ThiefFloatAttack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THIEFFRIENDSHIP.XML", "<ACTION ID=\"a_Thief_Friendship\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"FriendShipBuff\"  		CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"		CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"		DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"		CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"				FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"        FIRE_CASTER_EFFECT_ID=\"ef_Resurrection_01_02_char_root\"		ENTER_SOUND_ID=\"\"		FIRE_SOUND_ID=\"buff_skill_give\"				MARK_EFFECT_ID=\"e_ef_theif_friendship\"		  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THIEF_JUMP_KICK.XML", "<ACTION ID=\"a_thief_jump_kick\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Skill_Fighter_Jump_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THIDASHATTACK.XML", "<ACTION ID=\"a_thi_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"dash_attk_01\"/>	<FSM SCRIPT=\"Skill_Dash_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_DOWNATTACK_01.XML", "<ACTION ID=\"a_thi_down_attack_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_DOWNATTACK_02.XML", "<ACTION ID=\"a_thi_down_attack_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_DOWNATTACK_03.XML", "<ACTION ID=\"a_thi_down_attack_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_03\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_DOWNATTACK_FLY.XML", "<ACTION ID=\"a_thi_down_attack_fly\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\"  CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"attk_down_fly\"/>	<FSM SCRIPT=\"Skill_Down_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_01.XML", "<ACTION ID=\"a_thi_melee_01\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_02.XML", "<ACTION ID=\"a_thi_melee_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\"  >	<SLOT NAME=\"melee_02\"/>	<FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_03.XML", "<ACTION ID=\"a_thi_melee_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >	<SLOT NAME=\"melee_03\"/>	<FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_04.XML", "<ACTION ID=\"a_thi_melee_04\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >	<SLOT NAME=\"melee_04\"/>	<FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_05.XML", "<ACTION ID=\"a_thi_melee_05\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >	<SLOT NAME=\"melee_05\"/>	<FSM SCRIPT=\"Act_Melee\" NO_USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_BLOW_UP.XML", "<ACTION ID=\"a_thi_melee_blow_up\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"melee_blow_up\"/>	<FSM SCRIPT=\"Skill_Melee_Blow_Up\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_DROP.XML", "<ACTION ID=\"a_thi_melee_drop\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"jump_down_attk\"/>  <SLOT NAME=\"jump_down_attk_up\"/>  <FSM SCRIPT=\"Skill_Melee_Drop\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/THI_MELEE_KNOCK_BACK.XML", "<ACTION ID=\"a_thi_melee_knock_back\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"melee_knock_back\"/>	<FSM SCRIPT=\"Skill_Melee_Knock_Back\" DIRECTION=\"LEFT\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/THREEWAY_CAST.XML", "<ACTION ID=\"a_Three Way_Cast\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       CASTING_SOUND_ID=\"ThreeWayCannon\"       HIT_SOUND_ID=\"Parring\"       HIT_SOUND_ID_MALE=\"voice_male5\"       HIT_SOUND_ID_FEMALE=\"voice_female5\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/THREEWAY_FIRE.XML", "<ACTION ID=\"a_Three Way_Fire\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"slow_shot_01\"/>  <FSM SCRIPT=\"MagMultiShot\" FIRE_COUNT=\"3\" PROJECTILE_ID=\"PROJECTILE_MAGICIAN_DEFAULT_SHOT\" HIT_SOUND_ID=\"Stf_ThreeShot1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/THROWINGDAGGER.XML", "<ACTION ID=\"a_Throwing Dagger\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" OVERRIDE_PACKET=\"TRUE\">  <SLOT NAME=\"Com_skill_WindSuriken_01\"/>  <FSM SCRIPT=\"Skill_Multiple_Shot\" PROJECTILE_ID=\"Projectile_Seukelreteon_dagger\" ATTACH_NODE_ID=\"Bip01 L Hand\"       HIT_SOUND_ID=\"ThrowingDagger\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/THROWDOWN.XML", "<ACTION ID=\"a_throw_down\"  TYPE=\"EFFECT\" NEXT=\"a_idle\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_ThrowDown\" VELOCITY=\"-50\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/THROWDOWN2.XML", "<ACTION ID=\"a_throw_down2\"  TYPE=\"EFFECT\" NEXT=\"a_idle\" BREAK_FALL=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <FSM SCRIPT=\"Act_ThrowDown\" VELOCITY2=\"200\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/THRUST.XML", "<ACTION ID=\"a_Thrust\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"TRUE\"/>  <SLOT NAME=\"attk_01\"/>	<FSM SCRIPT=\"Skill_Thrust\" FIRE_ATTACH_EFFECT_ID=\"e_arrow\"   FIRE_ATTACH_EFFECT_TARGET_HELPER_ID=\"char_root\" HIT_EFFECT_ID=\"e_dmg_cri\"   PROJECTILE_ID=\"PROJECTILE_THRUST_ARROW\"	 MONSTER_UP_EFFECT_ID=\"e_jump\" MONSTER_DOWN_EFFECT_ID=\"\"	 MONSTER_FALLEN_EFFECT_ID=\"e_skill_reverse_gravity_mon_fallen\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A.XML", "<ACTION ID=\"a_ths_combo_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_Attk\"/>	<SLOT NAME=\"ths_combo_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"						HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT-TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A_2.XML", "<ACTION ID=\"a_ths_combo_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_2_Attk\"/>	<SLOT NAME=\"ths_combo_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_05_a_2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"		NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A_3.XML", "<ACTION ID=\"a_ths_combo_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_3_Attk\"/>	<SLOT NAME=\"ths_combo_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_05_a_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				SAVE_CAMERA_POS=\"TRUE\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.7\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A_3_4.XML", "<ACTION ID=\"a_ths_combo_a_3_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_3_4_Attk\"/>	<SLOT NAME=\"ths_combo_a_3_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ =\"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ =\"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_06_a_3_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.2\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A_3_5.XML", "<ACTION ID=\"a_ths_combo_a_3_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_3_5_Attk\"/>	<SLOT NAME=\"ths_combo_a_3_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_06_a_3_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"        CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.8\"		CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A_4.XML", "<ACTION ID=\"a_ths_combo_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_4_Attk\"/>	<SLOT NAME=\"ths_combo_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CMA_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_05_a_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.3\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_A_5.XML", "<ACTION ID=\"a_ths_combo_a_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_a_5_Attk\"/>	<SLOT NAME=\"ths_combo_a_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.7\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"			CAM_MSG_QUAKE_CAMERA_DURATION =\"0.7\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ =\"20\"			WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_05_a_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"eff_ths_combo_05_charge_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"Weapon_Bone01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1.5\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"TRUE\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.8\"		CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_B.XML", "<ACTION ID=\"a_ths_combo_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_b_Attk\"/>	<SLOT NAME=\"ths_combo_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_02\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_B_3.XML", "<ACTION ID=\"a_ths_combo_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_b_3_Attk\"/>	<SLOT NAME=\"ths_combo_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_04_b_3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_B_4.XML", "<ACTION ID=\"a_ths_combo_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_b_4_Attk\"/>	<SLOT NAME=\"ths_combo_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_04_b_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_B_5.XML", "<ACTION ID=\"a_ths_combo_b_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_b_5_Attk\"/>	<SLOT NAME=\"ths_combo_b_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_04_b_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C.XML", "<ACTION ID=\"a_ths_combo_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_Attk\"/>	<SLOT NAME=\"ths_combo_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARKET_QUAKE_CMAERA_FREQ = \"20\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_4.XML", "<ACTION ID=\"a_ths_combo_c_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_4_Attk\"/>	<SLOT NAME=\"ths_combo_c_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_c_4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_5_C.XML", "<ACTION ID=\"a_ths_combo_c_5_C\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_5_C_Start\"/>	<SLOT NAME=\"ths_combo_c_5_C_btlidle\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_COMBO_CHARGE=\"TRUE\"		USE_TLM=\"TRUE\"				CAM_MSG_QUAKE_CAMERA_DURATION = \"0.1\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"0.2\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"1\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_charge_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"Weapon_Bone01\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"TRUE\"						EFFECT_TYPE_WHEN_ANI_SLOT0_2=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_2=\"ef_end_spot_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_2=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_2=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_2=\"TRUE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"ef_end_spot_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT1_1=\"\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"						EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"eff_ths_combo_03_charge_01\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"Weapon_Bone01\"				EFFECT_CNT_WHEN_EFFECT_MSG2=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG2_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG2_1=\"eff_ths_combo_03_charge_02\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG2_1=\"Weapon_Bone01\"				EFFECT_CNT_WHEN_EFFECT_MSG3=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG3_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG3_1=\"eff_ths_combo_03_charge_03\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG3_1=\"Weapon_Bone01\"				EFFECT_CNT_WHEN_EFFECT_MSG4=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG4_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG4_1=\"eff_ths_combo_03_charge_04\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG4_1=\"Weapon_Bone01\"				EFFECT_CNT_WHEN_EFFECT_MSG5=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG5_1=\"0\"		EFFECT_ID_WHEN_EFFECT_MSG5_1=\"eff_ths_combo_03_charge_05\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG5_1=\"Weapon_Bone01\"				CAMERA_ZOOM_WHEN_Z_CAM_MSG_0=\"0.85\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_1=\"0.63\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_2=\"0.38\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_3=\"0.25\"		CAMERA_ZOOM_WHEN_Z_CAM_MSG_4=\"0.05\"				SAVE_CAMERA_POS=\"TRUE\"		CAMERA_ZOOM_RESTORE_WHEN_ON_CLEANUP_CANCEL_COMBO=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_5_F1.XML", "<ACTION ID=\"a_ths_combo_c_5_F1\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_5_F1_Attk\"/>	<SLOT NAME=\"ths_combo_c_5_F1_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_c_5_f1\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_5_F2.XML", "<ACTION ID=\"a_ths_combo_c_5_F2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_5_F2_Attk\"/>	<SLOT NAME=\"ths_combo_c_5_F2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.6\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_c_5_f2\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_5_F3.XML", "<ACTION ID=\"a_ths_combo_c_5_F3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_5_F3_Attk\"/>	<SLOT NAME=\"ths_combo_c_5_F3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.7\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.7\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_c_5_f3\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_5_F4.XML", "<ACTION ID=\"a_ths_combo_c_5_F4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_5_F4_Attk\"/>	<SLOT NAME=\"ths_combo_c_5_F4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_c_5_f4\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_C_5_F5.XML", "<ACTION ID=\"a_ths_combo_c_5_F5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_c_5_F5_Attk\"/>	<SLOT NAME=\"ths_combo_c_5_F5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.9\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"4\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION =\"0.9\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"1.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_03_c_5_f5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				CAMERA_ZOOM_RESTORE_WHEN_HIT_MSG=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_D.XML", "<ACTION ID=\"a_ths_combo_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_d_Attk\"/>	<SLOT NAME=\"ths_combo_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.5\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"2\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_04\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.5\"		WFF_COLOR_ALPHA_KEEP=\"0\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_D_5.XML", "<ACTION ID=\"a_ths_combo_d_5\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_d_5_Attk\"/>	<SLOT NAME=\"ths_combo_d_5_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"FALSE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.8\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARGET_QUAKE_CAMERA_FREQ =\"20\"		CAM_MSG_QUAKE_CAMERA_DURATION = \"0.8\"		CAM_MSG_QUAKE_CAMERA_FACTOR = \"2.5\"		CAM_MSG_QUAKE_CAMERA_FREQ = \"20\"				WFF_COLOR_ALPHA_ACTION_TIME=\"13\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.05\"		WFF_COLOR_ALPHA_COLOR=\"-1\"		WFF_COLOR_ALPHA_START=\"0.0\"		WFF_COLOR_ALPHA_END=\"0.2\"		WFF_COLOR_ALPHA_KEEP=\"0\"				EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_ths_combo_02_d_5\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"				EFFECT_DETACH_TIME_ANI_SLOT0_1=\"\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_A.XML", "<ACTION ID=\"a_ths_combo_k_a\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_a_Attk\"/>	<SLOT NAME=\"ths_combo_k_a_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_A_2.XML", "<ACTION ID=\"a_ths_combo_k_a_2\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_a_2_Attk\"/>	<SLOT NAME=\"ths_combo_k_a_2_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_A_3.XML", "<ACTION ID=\"a_ths_combo_k_a_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_a_3_Attk\"/>	<SLOT NAME=\"ths_combo_k_a_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.2\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1\"		HIT_TARKET_QUAKE_CAMERA_FRREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_A_4.XML", "<ACTION ID=\"a_ths_combo_k_a_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_a_4_Attk\"/>	<SLOT NAME=\"ths_combo_k_a_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_B.XML", "<ACTION ID=\"a_ths_combo_k_b\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_b_Attk\"/>	<SLOT NAME=\"ths_combo_k_b_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_B_3.XML", "<ACTION ID=\"a_ths_combo_k_b_3\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_b_3_Attk\"/>	<SLOT NAME=\"ths_combo_k_b_3_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.5\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_B_4.XML", "<ACTION ID=\"a_ths_combo_k_b_4\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_b_4_Attk\"/>	<SLOT NAME=\"ths_combo_k_b_4_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.6\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"3\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_C.XML", "<ACTION ID=\"a_ths_combo_k_c\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_c_Attk\"/>	<SLOT NAME=\"ths_combo_k_c_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.3\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"1.5\"		HIT_TARGET_QUAKE_CAMERA_FREQ = \"20\"				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"		NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/THS_COMBO_K_D.XML", "<ACTION ID=\"a_ths_combo_k_d\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"ths_combo_k_d_Attk\"/>	<SLOT NAME=\"ths_combo_k_d_Finish\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_COMBO=\"TRUE\"		USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"2\"		TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_jump\"				HIT_TARGET_QUAKE_CAMERA_DURATION = \"0.4\"		HIT_TARGET_QUAKE_CAMERA_FACTOR = \"2.5\"		HIT_TARKET_QUAKE_CAMERA_FREQ = \"20\" 				NO_DEFAULT_HIT_EFFECT=\"TRUE\"		HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_01_00\"		CRITICAL_HIT_TARGET_EFFECT_ID=\"eff_ths_combo_hit_cri_01_00\"		HIT_TARGET_EFFECT_TARGET_NODE=\"p_ef_heart\"				NO_DAMAGE_HOLD =\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/THUNDERBREAK.XML", "<ACTION ID=\"a_Thunder Break\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_Thunderbreak_00_char_root\"       NO_WEAPON_TRAIL =\"TRUE\"       HIT_SOUND_ID=\"ThunderBreak_Start\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/THUNDERBOLT.XML", "<ACTION ID=\"a_thunderbolt\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"       HIT_TARGET_EFFECT_ID=\"ef_skill_lighting_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"	   FIRE_SOUND_ID=\"pooyan-skill-thunderbolt\"	   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/TIGER_BUFF.XML", "<ACTION ID=\"a_tiger_buff\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">  	<SLOT NAME=\"btlidle_01\" LOOP=\"TRUE\"/>   	<SLOT NAME=\"tiger_buff_start\"/>   	<SLOT NAME=\"tiger_buff_shot\"/>	<FSM SCRIPT=\"CommonSkillAction\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/WARMAGE/WARLORD/TIMEFREEZE.XML", "<ACTION ID=\"a_Time Freeze\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Spear_Skill_TimeFreeze_01\"/>  <FSM SCRIPT=\"Skill_TimeFreeze\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/TIMEREVERSE.XML", "<ACTION ID=\"a_Time Reverse\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_shot_04\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"TimeRiverse\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TIMEFREEZEEFFECT.XML", "<ACTION ID=\"a_time_freeze_effect\"  TYPE=\"EFFECT\" NEXT=\"a_fall\" CAN_CHANGE_ACTOR_POS=\"TRUE\" >  <SLOT NAME=\"dmg_01\" />  <FSM SCRIPT=\"Act_TimeFreezeEffect\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/PET/TITANIUMBODY.XML", "<ACTION ID=\"a_titanium_body\" NEXT=\"a_trace_ground2\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"idle_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"buff_01\"/>  <FSM SCRIPT=\"Act_Pet_Melee_Default\"        FIRE_CASTER_EFFECT_ID=\"ef_Pet_buf_01_p_ef_star\"        FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_star\"        NO_DEFAULT_HIT_EFFECT=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/BATTLEMAGE/TORNADO.XML", "<ACTION ID=\"a_Tornado\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Skill_Tornado\"       HIT_SOUND_ID=\"Tornado\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TOUCH_DMG.XML", "<ACTION ID=\"a_touch_dmg\" NEXT=\"a_idle\" TYPE=\"EFFECT\" CAN_CHANGE_ACTOR_POS=\"TRUE\">	<SLOT NAME=\"dmg_01\"/>  <SLOT NAME=\"dmg_02\"/>  <FSM SCRIPT=\"Act_TouchDamage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TRACE_FLY.XML", "<ACTION ID=\"a_trace_fly\" TYPE=\"IDLE\" NEXT=\"a_trace_fly\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"run\"/>	<SLOT NAME=\"opening\"/>	<FSM SCRIPT=\"Act_Trace_Fly\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TRACE_FLY2.XML", "<ACTION ID=\"a_trace_fly2\" TYPE=\"IDLE\" NEXT=\"a_trace_fly2\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<SLOT NAME=\"idle_03\"/>	<SLOT NAME=\"hungry\"/>	<SLOT NAME=\"sleep\"/>	<SLOT NAME=\"annoy\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"run\"/>	<SLOT NAME=\"opening\"/>	<FSM SCRIPT=\"Act_Trace_Fly2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TRACE_GROUND.XML", "<ACTION ID=\"a_trace_ground\" TYPE=\"IDLE\" NEXT=\"a_trace_ground\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"run\"/>	<SLOT NAME=\"opening\"/>	<FSM SCRIPT=\"Act_Trace_Ground\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TRACE_GROUND2.XML", "<ACTION ID=\"a_trace_ground2\" TYPE=\"IDLE\" NEXT=\"a_trace_ground2\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<SLOT NAME=\"idle_03\"/>	<SLOT NAME=\"hungry\"/>	<SLOT NAME=\"sleep\"/>	<SLOT NAME=\"annoy\"/>	<SLOT NAME=\"walk\"/>	<SLOT NAME=\"run\"/>	<SLOT NAME=\"opening\"/>	<FSM SCRIPT=\"Act_Trace_Ground2\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TRACEIDLE.XML", "<ACTION ID=\"a_trace_idle\" TYPE=\"IDLE\" NEXT=\"a_trace_idle\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<SLOT NAME=\"idle_03\"/>	<SLOT NAME=\"idle_04\"/>	<SLOT NAME=\"run_01\"/>	<SLOT NAME=\"talk_01\"/>	<SLOT NAME=\"opening_02\"/>	<FSM SCRIPT=\"Act_trace_Idle\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGICIAN_TRANSFORMATION.XML", "<ACTION ID=\"a_Transformation\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_03\"/>  <FSM SCRIPT=\"Skill_Transformation\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TRAP.XML", "<ACTION ID=\"a_trap\" NEXT=\"a_idle\" TYPE=\"MOVE\" LOOP=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"BlowUp_Start\" />  <SLOT NAME=\"BlowUp_Loop\" LOOP=\"TRUE\"/>  <SLOT NAME=\"BlowUp_Down\"/>  <SLOT NAME=\"StandUp\"/>  <FSM SCRIPT=\"Act_Trap\" VELOCITY=\"80\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/TUMBLING.XML", "<ACTION ID=\"a_Tumbling\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"skill_neckcut_01\"/>  <SLOT NAME=\"skill_neckcut_02\"/>  <FSM SCRIPT=\"Skill_Tumbling\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_ABS_PROTECT.XML", "<ACTION ID=\"a_twin_abs_protect_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_abs_protect\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			CANCEL_TYPE=\"2\"	CANCEL_ACTION_NAME1=\"a_twin_fist_storm_dash_fu\"	CANCEL_ACTION_EFFECT_NO1=\"400301201\"		CANCEL_ACTION_NAME2=\"a_twin_abs_protect_fu\"	CANCEL_ACTION_EFFECT_NO2=\"400301201\"	CANCEL_ACTION_NAME3=\"a_twin_finish_impact_fu\"	CANCEL_ACTION_EFFECT_NO3=\"400301201\"	CANCEL_ACTION_NAME4=\"a_twin_finish_move_fu\"	CANCEL_ACTION_EFFECT_NO4=\"400301201\"	CANCEL_ACTION_NAME5=\"a_twin_spirit_release_fu\"	CANCEL_ACTION_EFFECT_NO5=\"400301201\"	CANCEL_ACTION_NAME6=\"a_twin_ghost_fighter_fu\"	CANCEL_ACTION_EFFECT_NO6=\"400301201\"	CANCEL_ACTION_NAME7=\"a_twin_impact_blow_fu\"	CANCEL_ACTION_EFFECT_NO7=\"400301201\"	  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_BOOST.XML", "<ACTION ID=\"a_twin_boost_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"fu_boost_cast\" LOOP=\"true\"/>  <SLOT NAME=\"fu_boost_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_BUNKER_BUSTER.XML", "<ACTION ID=\"a_twin_bunker_buster\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"bunker_buster_start\"/>  <SLOT NAME=\"bunker_buster_finish\"/>    <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		HIT_MSG_QUAKE_CAMERA_DURATION=\"0.3\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"		EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"2\"	EFFECT_ID_WHEN_ANI_SLOT2_1=\"efx_boxing_mc_skill_mrg_bunker_buster_01\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"	EFFECT_DETACH_TIME_ANI_SLOT2_1=\"\"	EFFECT_HORIZ_DEG_WHEN_ANI_SLOT2_1	= \"0\"	EFFECT_VERT_DEG_WHEN_ANI_SLOT2_1 	= \"0\"	EFFECT_DIST_WHEN_ANI_SLOT2_1 		= \"0\"			MOVE_TYPE_1=\"V\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"-90\"	MOVE_SPEED_1=\"650\"	MOVE_STOP_OPTION_1=\"MEET_FLOOR\"			MEET_FLOOR_THEN_NEXT_ANI_SLOT=\"1\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CHAIN_BLOW.XML", "<ACTION ID=\"a_twin_chain_blow\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"chain_blow_casting\"/>	<SLOT NAME=\"chain_blow_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD=\"TRUE\"				WHEN_START_DIRECTION=\"CALLER\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"200\"		MOVE_COMPLETE_TIME_1=\"0.4\"				ORDER_ACTION_TIME_1=\"ENTER\"		ORDER_ACTION_TARGET_1=\"SC\"		ORDER_ACTION_NAME_1=\"a_twin_chain_blow_s\"				WHEN_ATTACK_TIMER_START=\"MSG_HIT\"		ATTACK_TIMER_TIME=\"2\"		ATTACK_TIMER_TICK=\"0.3\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"efx_boxing_sc_skill_drf_twin_attack_01_rhand\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"Bip01 R Hand\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"5\"		TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"2\"		TRAIL_PATH_WHEN_ANI_SLOT0_1=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT0_2=\"3\"		TRAIL_PATH_WHEN_ANI_SLOT0_2=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_2=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_2=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT0_3=\"4\"		TRAIL_PATH_WHEN_ANI_SLOT0_3=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_3=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_3=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT0_4=\"5\"		TRAIL_PATH_WHEN_ANI_SLOT0_4=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_4=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_4=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_5=\"1\"		TRAIL_PATH_WHEN_ANI_SLOT0_5=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_5=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_5=\"0.1\"				CAM_MSG_QUAKE_CAMERA_DURATION_1=\"1\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"3\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CHAIN_BLOW_S.XML", "<ACTION ID=\"a_twin_chain_blow_s\" NEXT=\"a_twin_sub_repos\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"chain_blow_s_casting\"/>	<SLOT NAME=\"chain_blow_s_fire\"/>	<SLOT NAME=\"chain_blow_s_finish\"/>	  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"				WHEN_START_DIRECTION=\"CALLER\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"100\"		MOVE_COMPLETE_TIME_1=\"0.7\"				WHEN_ATTACK_TIMER_START=\"MSG_HIT\"		ATTACK_TIMER_TIME=\"10\"		ATTACK_TIMER_TICK=\"0.5\"				CAM_MSG_QUAKE_CAMERA_DURATION_1=\"1.7\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CHARGE_SHOT.XML", "<ACTION ID=\"a_twin_charge_shot\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"Skill_Melee_Charge_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CHARGE_SHOT1_S.XML", "<ACTION ID=\"a_twin_charge_shot1_s\" NEXT=\"a_twin_charge_shot2_s\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"repos\"/>  <SLOT NAME=\"charge_01\"/>  <SLOT NAME=\"charge_02\" LOOP=\"TRUE\"/>  <FSM SCRIPT=\"CommonSkillAction\"  	WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"-25\"	MOVE_COMPLETE_TIME_1=\"0.5\"	MOVE_GOAL_POS_UPDATE_1=\"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CHARGE_SHOT2_S.XML", "<ACTION ID=\"a_twin_charge_shot2_s\" NEXT=\"a_twin_sub_repos\" USE-EVENT=\"FALSE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"charge_03\"/>  <FSM SCRIPT=\"CommonSkillAction\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_COMBAT_REVIVE_CAST.XML", "<ACTION ID=\"a_twin_combat_revive_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"combat_revive_cast\" LOOP=\"true\"/>  <SLOT NAME=\"combat_revive_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CROSS_FIST_FINISH.XML", "<ACTION ID=\"a_twin_cross_fist_finish\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"cross_fist_finish\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT1=\"5\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"2\"		TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_2=\"3\"		TRAIL_PATH_WHEN_ANI_SLOT1_2=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_2=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_2=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_3=\"4\"		TRAIL_PATH_WHEN_ANI_SLOT1_3=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_3=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_3=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_4=\"5\"		TRAIL_PATH_WHEN_ANI_SLOT1_4=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_4=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_4=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_5=\"1\"		TRAIL_PATH_WHEN_ANI_SLOT1_5=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_5=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_5=\"0.1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_3=\"0\"		MOVE_GOAL_POS_DIST_1=\"50\"		MOVE_COMPLETE_TIME_1=\"0.4667\"				EFFECT_CNT_WHEN_ANI_SLOT2=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT2_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT2_1=\"\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT2_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT2_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT2_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT3=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT3_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT3_1=\"\"				EFFECT_TARGET_NODE_WHEN_ANI_SLOT3_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT3_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT3_1=\"ANI_DONE\"							WFF_COLOR_ALPHA_ACTION_TIME=\"2\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"1\"		WFF_COLOR_ALPHA_COLOR=\"16777215\"		WFF_COLOR_ALPHA_START=\"1\"		WFF_COLOR_ALPHA_END=\"0\"		WFF_COLOR_ALPHA_KEEP=\"0\"				DRAW_ACTOR_FILTER_USE=\"1\"		DRAW_ACTOR_FILTER_CLEAR=\"1\"				HIT_SOUND_ID=\"\"				NO_DAMAGE_HOLD=\"TRUE\"	/>		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CROSS_FIST_FINISH_S.XML", "<ACTION ID=\"a_twin_cross_fist_finish_s\" NEXT=\"a_twin_sub_repos\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"cross_fist_finish_s\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				WHEN_START_DIRECTION=\"CALLER\"					USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT1=\"5\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"2\"		TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_2=\"3\"		TRAIL_PATH_WHEN_ANI_SLOT1_2=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_2=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_2=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_3=\"4\"		TRAIL_PATH_WHEN_ANI_SLOT1_3=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_3=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_3=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_4=\"5\"		TRAIL_PATH_WHEN_ANI_SLOT1_4=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_4=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_4=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_5=\"1\"		TRAIL_PATH_WHEN_ANI_SLOT1_5=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_5=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_5=\"0.1\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_3=\"0\"		MOVE_GOAL_POS_DIST_1=\"-50\"		MOVE_COMPLETE_TIME_1=\"0.4667\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CROSS_FIST_START.XML", "<ACTION ID=\"a_twin_cross_fist_start\" NEXT=\"a_twin_cross_fist_finish\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"cross_fist_start\"/>	<SLOT NAME=\"cross_fist_charge\"/>	<SLOT NAME=\"cross_fist_dash\"/>	<SLOT NAME=\"cross_fist_hit\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD =\"TRUE\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"115\"		MOVE_COMPLETE_TIME_1=\"0.6\"				MOVE_TYPE_2=\"I\"		MOVE_GOAL_POS_TARGET_2=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"		MOVE_GOAL_POS_DIST_2=\"-95\"		MOVE_COMPLETE_TIME_2=\"0.1666\"				EFFECT_CNT_WHEN_ANI_SLOT4=\"2\"		EFFECT_TYPE_WHEN_ANI_SLOT4_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT4_1=\"efx_boxing_mc_skill_drf_cross_fist_01_cr_03\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT4_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT4_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT4_1=\"\"		EFFECT_DIST_WHEN_ANI_SLOT4_1=\"21\"				EFFECT_TYPE_WHEN_ANI_SLOT4_2=\"2\"		EFFECT_ID_WHEN_ANI_SLOT4_2=\"efx_boxing_mc_skill_drf_cross_fist_01_cf_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT4_2=\"p_efx_cf_01\"		EFFECT_SCALE_WHEN_ANI_SLOT4_2=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT4_2=\"\"		EFFECT_DIST_WHEN_ANI_SLOT4_2=\"21\"					ORDER_ACTION_TIME_1=\"ENTER\"		ORDER_ACTION_TARGET_1=\"SC\"		ORDER_ACTION_NAME_1=\"a_twin_cross_fist_start_s\"				WHEN_ATTACK_TIMER_START=\"MSG_HIT\"		ATTACK_TIMER_TIME=\"10\"		ATTACK_TIMER_TICK=\"0.3\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT1=\"5\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"2\"		TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_2=\"3\"		TRAIL_PATH_WHEN_ANI_SLOT1_2=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_2=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_2=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_3=\"4\"		TRAIL_PATH_WHEN_ANI_SLOT1_3=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_3=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_3=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_4=\"5\"		TRAIL_PATH_WHEN_ANI_SLOT1_4=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_4=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_4=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_5=\"1\"		TRAIL_PATH_WHEN_ANI_SLOT1_5=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_5=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_5=\"0.1\"				WFF_COLOR_ALPHA_ACTION_TIME=\"5\"		WFF_COLOR_ALPHA_TARGET=\"1\"		WFF_COLOR_ALPHA_TOTAL=\"0.4\"		WFF_COLOR_ALPHA_COLOR=\"0\"		WFF_COLOR_ALPHA_START=\"0\"		WFF_COLOR_ALPHA_END=\"1\"		WFF_COLOR_ALPHA_KEEP=\"1\"				DRAW_ACTOR_FILTER_USE=\"1\"		DRAW_ACTOR_FILTER_CLEAR=\"1\"				CAM_MSG_QUAKE_CAMERA_DURATION_1=\"0.6\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"1\"		CAM_MSG_QUAKE_CAMERA_DURATION_2=\"1.8\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_2=\"2\"		CAM_MSG_QUAKE_CAMERA_DURATION_3=\"0.5\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_3=\"3\"				C_CAM_MSG_KEEP=\"1\"		C_CAM_MSG_TYPE_1=\"10001\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_CROSS_FIST_START_S.XML", "<ACTION ID=\"a_twin_cross_fist_start_s\" NEXT=\"a_twin_cross_fist_finish_s\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"cross_fist_start_s\"/>	<SLOT NAME=\"cross_fist_charge_s\"/>	<SLOT NAME=\"cross_fist_dash_s\"/>	<SLOT NAME=\"cross_fist_hit_s\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				WHEN_START_DIRECTION=\"CALLER\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"-115\"		MOVE_COMPLETE_TIME_1=\"0.6\"				MOVE_TYPE_2=\"I\"		MOVE_GOAL_POS_TARGET_2=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_2=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"		MOVE_GOAL_POS_DIST_2=\"-125\"		MOVE_COMPLETE_TIME_2=\"0.1666\"		USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT1=\"5\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"2\"		TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_2=\"3\"		TRAIL_PATH_WHEN_ANI_SLOT1_2=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_2=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_2=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_3=\"4\"		TRAIL_PATH_WHEN_ANI_SLOT1_3=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_3=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_3=\"0.1\"			TRAIL_TYPE_WHEN_ANI_SLOT1_4=\"5\"		TRAIL_PATH_WHEN_ANI_SLOT1_4=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_4=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_4=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_5=\"1\"		TRAIL_PATH_WHEN_ANI_SLOT1_5=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_5=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_5=\"0.1\"	/>	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DASH_ATTACK.XML", "<ACTION ID=\"a_twin_dash_attack\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">	<SLOT NAME=\"dash_attk_01\"/>	<FSM SCRIPT=\"Skill_Dash_Attack\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DEADLY_SPOT_CAST.XML", "<ACTION ID=\"a_twin_deadly_spot_cast\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\">		<SLOT NAME=\"deadly_spot_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"deadly_spot_fire\"/>	    <FSM SCRIPT=\"CommonSkillAction\"		USE_TLM=\"FALSE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DEADLY_SPOT_FIRE.XML", "<ACTION ID=\"a_twin_deadly_spot_fire\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"opening\"/>	<SLOT NAME=\"idle_01\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"FALSE\"				WHEN_START_DIRECTION=\"CALLER\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_deadly_spot_idle00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"	/>		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DOWN_ATTACK_01.XML", "<ACTION ID=\"a_twin_down_attack_01\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"attk_down_01\"/>	<FSM SCRIPT=\"Skill_Down_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DOWN_ATTACK_02.XML", "<ACTION ID=\"a_twin_down_attack_02\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"attk_down_02\"/>	<FSM SCRIPT=\"Skill_Down_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DOWN_ATTACK_03.XML", "<ACTION ID=\"a_twin_down_attack_03\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >	<SLOT NAME=\"attk_down_03\"/>	<FSM SCRIPT=\"Skill_Down_Attack\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DRAGON_KICK_S.XML", "<ACTION ID=\"a_twin_dragon_kick_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dragon_kick\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT1=\"1\"	TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"	WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"70\"	MOVE_COMPLETE_TIME_1=\"0.367\"		WHEN_ATTACK_TIMER_START=\"MSG_HIT\"	ATTACK_TIMER_TIME=\"1\"	ATTACK_TIMER_TICK=\"0.1\"		NO_DAMAGE_HOLD=\"TRUE\"  />    </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_DRAGON_UPPER.XML", "<ACTION ID=\"a_twin_dragon_upper\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"dragon_upper\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"55\"	MOVE_GOAL_POS_DIST_1=\"200\"	MOVE_COMPLETE_TIME_1=\"0.4667\"		WHEN_ATTACK_TIMER_START=\"MSG_HIT\"	ATTACK_TIMER_TIME=\"1\"	ATTACK_TIMER_TICK=\"0.15\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_FINISH_IMPACT.XML", "<ACTION ID=\"a_twin_finish_impact_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_finish_impact\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"80\"	MOVE_COMPLETE_TIME_1=\"0.6\"		CANCEL_TYPE=\"2\"	CANCEL_ACTION_NAME1=\"a_twin_fist_storm_dash_fu\"	CANCEL_ACTION_EFFECT_NO1=\"400301201\"		CANCEL_ACTION_NAME2=\"a_twin_abs_protect_fu\"	CANCEL_ACTION_EFFECT_NO2=\"400301201\"	CANCEL_ACTION_NAME3=\"a_twin_finish_impact_fu\"	CANCEL_ACTION_EFFECT_NO3=\"400301201\"	CANCEL_ACTION_NAME4=\"a_twin_finish_move_fu\"	CANCEL_ACTION_EFFECT_NO4=\"400301201\"	CANCEL_ACTION_NAME5=\"a_twin_spirit_release_fu\"	CANCEL_ACTION_EFFECT_NO5=\"400301201\"	CANCEL_ACTION_NAME6=\"a_twin_ghost_fighter_fu\"	CANCEL_ACTION_EFFECT_NO6=\"400301201\"	CANCEL_ACTION_NAME7=\"a_twin_impact_blow_fu\"	CANCEL_ACTION_EFFECT_NO7=\"400301201\"			USE_LINKAGE_SOUND=\"tws_harmony \"	USE_LINKAGE_EFFECT_PT1=\"eff_buff_harmony_aroused_01\"	USE_LINKAGE_EFFECT_TARGET_PT1=\"char_root\"	USE_LINKAGE_EFFECT_PT2=\"eff_buff_harmony_aroused_02\"	USE_LINKAGE_EFFECT_TARGET_PT2=\"char_root\"	USE_LINKAGE_EFFECT_PT3=\"eff_buff_harmony_aroused_03\"	USE_LINKAGE_EFFECT_TARGET_PT3=\"char_root\"	USE_LINKAGE_EFFECT_PT4=\"eff_buff_harmony_aroused_04\"	USE_LINKAGE_EFFECT_TARGET_PT4=\"char_root\"	USE_LINKAGE_EFFECT_PT5=\"eff_buff_harmony_aroused_05\"	USE_LINKAGE_EFFECT_TARGET_PT5=\"char_root\"			NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_FINISH_MOVE.XML", "<ACTION ID=\"a_twin_finish_move_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_finish_move\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"80\"	MOVE_COMPLETE_TIME_1=\"1.0667\"			CANCEL_TYPE=\"2\"	CANCEL_ACTION_NAME1=\"a_twin_fist_storm_dash_fu\"	CANCEL_ACTION_EFFECT_NO1=\"400301201\"		CANCEL_ACTION_NAME2=\"a_twin_abs_protect_fu\"	CANCEL_ACTION_EFFECT_NO2=\"400301201\"	CANCEL_ACTION_NAME3=\"a_twin_finish_impact_fu\"	CANCEL_ACTION_EFFECT_NO3=\"400301201\"	CANCEL_ACTION_NAME4=\"a_twin_finish_move_fu\"	CANCEL_ACTION_EFFECT_NO4=\"400301201\"	CANCEL_ACTION_NAME5=\"a_twin_spirit_release_fu\"	CANCEL_ACTION_EFFECT_NO5=\"400301201\"	CANCEL_ACTION_NAME6=\"a_twin_ghost_fighter_fu\"	CANCEL_ACTION_EFFECT_NO6=\"400301201\"	CANCEL_ACTION_NAME7=\"a_twin_impact_blow_fu\"	CANCEL_ACTION_EFFECT_NO7=\"400301201\"		USE_LINKAGE_SOUND=\"tws_harmony \"	USE_LINKAGE_EFFECT_PT1=\"eff_buff_harmony_aroused_01\"	USE_LINKAGE_EFFECT_TARGET_PT1=\"char_root\"	USE_LINKAGE_EFFECT_PT2=\"eff_buff_harmony_aroused_02\"	USE_LINKAGE_EFFECT_TARGET_PT2=\"char_root\"	USE_LINKAGE_EFFECT_PT3=\"eff_buff_harmony_aroused_03\"	USE_LINKAGE_EFFECT_TARGET_PT3=\"char_root\"	USE_LINKAGE_EFFECT_PT4=\"eff_buff_harmony_aroused_04\"	USE_LINKAGE_EFFECT_TARGET_PT4=\"char_root\"	USE_LINKAGE_EFFECT_PT5=\"eff_buff_harmony_aroused_05\"	USE_LINKAGE_EFFECT_TARGET_PT5=\"char_root\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FIST_STORM_DASH.XML", "<ACTION ID=\"a_twin_fist_storm_dash\" NEXT=\"a_twin_fist_storm_fire\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <!--SLOT NAME=\"casting01\" LOOP=\"TRUE\"/-->  <SLOT NAME=\"fist_storm_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fist_storm_dash\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"FALSE\"			USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT0=\"5\"	TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"2\"	TRAIL_PATH_WHEN_ANI_SLOT0_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_2=\"3\"	TRAIL_PATH_WHEN_ANI_SLOT0_2=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_2=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_2=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_3=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT0_3=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_3=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_3=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_4=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT0_4=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_4=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_4=\"0.1\"	TRAIL_TYPE_WHEN_ANI_SLOT0_5=\"1\"	TRAIL_PATH_WHEN_ANI_SLOT0_5=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_5=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_5=\"0.1\"		MOVE_TYPE_1=\"SEEK\"	MOVE_GOAL_POS_TARGET_1=\"TARGET\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"-30\"			MOVE_SPEED_1=\"500\"		MOVE_GOAL_POS_UPDATE_1=\"TRUE\"	MOVE_DIR_UPDATE_1=\"TRUE\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FIST_STORM_FINISH.XML", "<ACTION ID=\"a_twin_fist_storm_finish\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">    <SLOT NAME=\"fist_storm_fisnish_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fist_storm_fisnish_cast\"/>  <SLOT NAME=\"fist_storm_fisnish_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT0=\"5\"	TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"2\"	TRAIL_PATH_WHEN_ANI_SLOT0_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_2=\"3\"	TRAIL_PATH_WHEN_ANI_SLOT0_2=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_2=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_2=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_3=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT0_3=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_3=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_3=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_4=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT0_4=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_4=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_4=\"0.1\"	TRAIL_TYPE_WHEN_ANI_SLOT0_5=\"1\"	TRAIL_PATH_WHEN_ANI_SLOT0_5=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_5=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_5=\"0.1\"		WHEN_ATTACK_TIMER_START=\"MSG_HIT\"	ATTACK_TIMER_TIME=\"6\"	ATTACK_TIMER_TICK=\"0.2\"  		NO_DAMAGE_HOLD=\"TRUE\"		CAM_MSG_QUAKE_CAMERA_DURATION_1=\"0.4\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"2\"		CANCEL_TYPE=\"1\"		BAN_USER_INPUT_SC_SKILL=\"1\"  />  	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FIST_STORM_FIRE.XML", "<ACTION ID=\"a_twin_fist_storm_fire\" NEXT=\"a_twin_fist_storm_finish\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fist_storm_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT1=\"5\"	TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"2\"	TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_2=\"3\"	TRAIL_PATH_WHEN_ANI_SLOT1_2=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_2=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_2=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_3=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT1_3=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_3=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_3=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_4=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT1_4=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_4=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_4=\"0.1\"	TRAIL_TYPE_WHEN_ANI_SLOT1_5=\"1\"	TRAIL_PATH_WHEN_ANI_SLOT1_5=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_5=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_5=\"0.1\"		MOVE_TYPE_1=\"SEEK2\"	MOVE_GOAL_POS_TARGET_1=\"TARGET\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"-30\"	MOVE_SPEED_1=\"500\"		MOVE_GOAL_POS_UPDATE_1=\"TRUE\"	MOVE_DIR_UPDATE_1=\"TRUE\"		NO_DAMAGE_HOLD=\"TRUE\"		WHEN_ATTACK_TIMER_START=\"ENTER\"	ATTACK_TIMER_TIME=\"20\"	ATTACK_TIMER_TICK=\"0.2\"  		ORDER_ACTION_TIME_1=\"ENTER\"	ORDER_ACTION_TARGET_1=\"SC\"	ORDER_ACTION_NAME_1=\"a_twin_sub_repos\"		ORDER_ACTION_TIME_2=\"MSG_SC_START\"	ORDER_ACTION_TARGET_2=\"SC\"	ORDER_ACTION_NAME_2=\"a_twin_fist_storm_s\"	CAM_MSG_QUAKE_CAMERA_DURATION_1=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"1\"  	CAM_MSG_QUAKE_CAMERA_DURATION_2=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_2=\"1\"      CAM_MSG_QUAKE_CAMERA_DURATION_3=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_3=\"1\"	CAM_MSG_QUAKE_CAMERA_DURATION_4=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_4=\"1\"    	CAM_MSG_QUAKE_CAMERA_DURATION_5=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_5=\"1\"    	CAM_MSG_QUAKE_CAMERA_DURATION_6=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_6=\"1\"    	CAM_MSG_QUAKE_CAMERA_DURATION_7=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_7=\"1\"    	CAM_MSG_QUAKE_CAMERA_DURATION_8=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_8=\"1\"    	CAM_MSG_QUAKE_CAMERA_DURATION_9=\"0.1\"     	CAM_MSG_QUAKE_CAMERA_FACTOR_9=\"1\"		CANCEL_TYPE=\"1\"	BAN_USER_INPUT_SC_SKILL=\"1\"  />  	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FIST_STORM_S.XML", "<ACTION ID=\"a_twin_fist_storm_s\" NEXT=\"a_twin_sub_repos\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"fist_storm_s_start\"/>	<SLOT NAME=\"fist_storm_s_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				MOVE_TYPE_1=\"I\"		MOVE_GOAL_POS_TARGET_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"		MOVE_GOAL_POS_DIST_1=\"70\"		MOVE_COMPLETE_TIME_1=\"0.4667\"				USE_TRAIL=\"TRUE\"		TRAIL_CNT_WHEN_ANI_SLOT0=\"1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"4\"		TRAIL_PATH_WHEN_ANI_SLOT0_1=\"\"		TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"0.5\"		TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"0.1\"					CAM_MSG_QUAKE_CAMERA_DURATION_1=\"0.5\"     		CAM_MSG_QUAKE_CAMERA_FACTOR_1=\"1\"		NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FLOAT_MELEE_01.XML", "<ACTION ID=\"a_twin_float_melee_01\" NEXT=\"a_jump\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">  <SLOT NAME=\"jump_attk_01\"/>  <FSM SCRIPT=\"Act_FloatMelee\" USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FLOAT_MELEE_02.XML", "<ACTION ID=\"a_twin_float_melee_02\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_02\"/>	<FSM SCRIPT=\"Act_FloatMelee\" USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FLOAT_MELEE_03.XML", "<ACTION ID=\"a_twin_float_melee_03\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"jump_attk_03\"/>	<FSM SCRIPT=\"Act_FloatMelee\" USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_FUSION.XML", "<ACTION ID=\"a_twin_fusion\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fusion\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"FALSE\"	  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_GHOST_FIGHTER.XML", "<ACTION ID=\"a_twin_ghost_fighter_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"fu_ghost_fighter_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_ghost_fighter_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT0=\"5\"		TRAIL_TYPE_WHEN_ANI_SLOT0_1=\"2\"	TRAIL_PATH_WHEN_ANI_SLOT0_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_1=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_2=\"3\"	TRAIL_PATH_WHEN_ANI_SLOT0_2=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_2=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_2=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_3=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT0_3=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_3=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_3=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT0_4=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT0_4=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_4=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_4=\"0.1\"	TRAIL_TYPE_WHEN_ANI_SLOT0_5=\"1\"	TRAIL_PATH_WHEN_ANI_SLOT0_5=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT0_5=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT0_5=\"0.1\"		USE_SAVE_PRE_TARGET_LIST=\"TRUE\"			PRE_FIND_TARGET_TYPE=\"0\"	PRE_FIND_TARGET_RANGE=\"200\"	PRE_FIND_TARGET_AREA_PARAM2=\"0\"		WHEN_START_DIRECTION=\"SAVED_TARGET\"		MOVE_TYPE_1=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_1=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"		MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"-30\"		MOVE_COMPLETE_TIME_1=\"0.1\"	MOVE_DIR_UPDATE_1=\"TRUE\"		MOVE_SPEED_1=\"0\"	MOVE_GOAL_POS_UPDATE_1=\"FALSE\"		MOVE_STOP_OPTION_1=\"\"			MOVE_TYPE_2=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_2=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"			MOVE_GOAL_POS_DIST_2=\"-30\"	MOVE_COMPLETE_TIME_2=\"0.0344\"	MOVE_DIR_UPDATE_2=\"TRUE\"		MOVE_TYPE_3=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_3=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_3=\"SELF\"			MOVE_GOAL_POS_DIST_3=\"-30\"	MOVE_COMPLETE_TIME_3=\"0.0344\"	MOVE_DIR_UPDATE_3=\"TRUE\"		MOVE_TYPE_4=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_4=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_4=\"SELF\"			MOVE_GOAL_POS_DIST_4=\"-30\"	MOVE_COMPLETE_TIME_4=\"0.0344\"	MOVE_DIR_UPDATE_4=\"TRUE\"		MOVE_TYPE_5=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_5=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_5=\"SELF\"			MOVE_GOAL_POS_DIST_5=\"-30\"	MOVE_COMPLETE_TIME_5=\"0.0344\"	MOVE_DIR_UPDATE_5=\"TRUE\"		MOVE_TYPE_6=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_6=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_6=\"SELF\"			MOVE_GOAL_POS_DIST_6=\"-30\"	MOVE_COMPLETE_TIME_6=\"0.0344\"	MOVE_DIR_UPDATE_6=\"TRUE\"		MOVE_TYPE_7=\"TELEPORT\"	MOVE_GOAL_POS_TARGET_7=\"SAVED_TARGET\"	MOVE_GOAL_POS_DIST_DIR_7=\"SELF\"			MOVE_GOAL_POS_DIST_7=\"-30\"	MOVE_COMPLETE_TIME_7=\"0.0344\"	MOVE_DIR_UPDATE_7=\"TRUE\"		NO_DAMAGE_HOLD=\"TRUE\"		WHEN_ATTACK_TIMER_START=\"MSG_HIT\"	ATTACK_TIMER_TIME=\"10\"	ATTACK_TIMER_TICK=\"0.15\"			CANCEL_TYPE=\"2\"	CANCEL_ACTION_NAME1=\"a_twin_fist_storm_dash_fu\"	CANCEL_ACTION_EFFECT_NO1=\"400301201\"		CANCEL_ACTION_NAME2=\"a_twin_abs_protect_fu\"	CANCEL_ACTION_EFFECT_NO2=\"400301201\"	CANCEL_ACTION_NAME3=\"a_twin_finish_impact_fu\"	CANCEL_ACTION_EFFECT_NO3=\"400301201\"	CANCEL_ACTION_NAME4=\"a_twin_finish_move_fu\"	CANCEL_ACTION_EFFECT_NO4=\"400301201\"	CANCEL_ACTION_NAME5=\"a_twin_spirit_release_fu\"	CANCEL_ACTION_EFFECT_NO5=\"400301201\"	CANCEL_ACTION_NAME6=\"a_twin_ghost_fighter_fu\"	CANCEL_ACTION_EFFECT_NO6=\"400301201\"	CANCEL_ACTION_NAME7=\"a_twin_impact_blow_fu\"	CANCEL_ACTION_EFFECT_NO7=\"400301201\"	  />  	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_HYPER_KNEE_KICK.XML", "<ACTION ID=\"a_twin_hyper_knee_kick\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"hyper_knee_kick\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"200\"	MOVE_COMPLETE_TIME_1=\"0.5\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_IMPACT_BLOW.XML", "<ACTION ID=\"a_twin_impact_blow_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_impact_blow\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"10\"	MOVE_COMPLETE_TIME_1=\"0.1\"			CANCEL_TYPE=\"2\"	CANCEL_ACTION_NAME1=\"a_twin_fist_storm_dash_fu\"	CANCEL_ACTION_EFFECT_NO1=\"400301201\"		CANCEL_ACTION_NAME2=\"a_twin_abs_protect_fu\"	CANCEL_ACTION_EFFECT_NO2=\"400301201\"	CANCEL_ACTION_NAME3=\"a_twin_finish_impact_fu\"	CANCEL_ACTION_EFFECT_NO3=\"400301201\"	CANCEL_ACTION_NAME4=\"a_twin_finish_move_fu\"	CANCEL_ACTION_EFFECT_NO4=\"400301201\"	CANCEL_ACTION_NAME5=\"a_twin_spirit_release_fu\"	CANCEL_ACTION_EFFECT_NO5=\"400301201\"	CANCEL_ACTION_NAME6=\"a_twin_ghost_fighter_fu\"	CANCEL_ACTION_EFFECT_NO6=\"400301201\"	CANCEL_ACTION_NAME7=\"a_twin_impact_blow_fu\"	CANCEL_ACTION_EFFECT_NO7=\"400301201\"	NO_DAMAGE_HOLD=\"TRUE\"	  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_INFINITE_KICK.XML", "<ACTION ID=\"a_twin_infinite_kick\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"infinite_kick\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"150\"	MOVE_COMPLETE_TIME_1=\"1.2666\"				NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_LIGHTNING_FLASH.XML", "<ACTION ID=\"a_twin_lightning_flash\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"lightning_flash_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"lightning_flash_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_LIGHTNING_KICK2_S.XML", "<ACTION ID=\"a_twin_lightning_kick2_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"repos\"/>  <SLOT NAME=\"lightning_kick2_start\"/>  <SLOT NAME=\"lightning_kick2_attack\"/>  <SLOT NAME=\"lightning_kick2_finish\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"	WHEN_START_DIRECTION=\"CALLER\"		REPEAT_ANISLOT3_ON_SKILL_LV1 = \"2\"	REPEAT_ANISLOT3_ON_SKILL_LV2 = \"2\"	REPEAT_ANISLOT3_ON_SKILL_LV3 = \"3\"	REPEAT_ANISLOT3_ON_SKILL_LV4 = \"3\"	REPEAT_ANISLOT3_ON_SKILL_LV5 = \"4\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"30\"	MOVE_COMPLETE_TIME_1=\"0.5\"			MOVE_TYPE_2=\"I\"	MOVE_GOAL_POS_TARGET_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"	MOVE_GOAL_POS_DIST_2=\"30\"	MOVE_COMPLETE_TIME_2=\"1.0666\"		MOVE_TYPE_3=\"I\"	MOVE_GOAL_POS_TARGET_3=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_3=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_3=\"0\"	MOVE_GOAL_POS_DIST_3=\"30\"	MOVE_COMPLETE_TIME_3=\"1.0666\"		MOVE_TYPE_4=\"I\"	MOVE_GOAL_POS_TARGET_4=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_4=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_4=\"0\"	MOVE_GOAL_POS_DIST_4=\"30\"	MOVE_COMPLETE_TIME_4=\"1.0666\"		MOVE_TYPE_5=\"I\"	MOVE_GOAL_POS_TARGET_5=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_5=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_5=\"0\"	MOVE_GOAL_POS_DIST_5=\"30\"	MOVE_COMPLETE_TIME_5=\"1.0666\"		NO_DAMAGE_HOLD=\"TRUE\"		  />   		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_LIGHTNING_KICK_S.XML", "<ACTION ID=\"a_twin_lightning_kick_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"repos\"/>  <SLOT NAME=\"lightning_kick\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"	WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"30\"	MOVE_COMPLETE_TIME_1=\"0.5\"  	NO_DAMAGE_HOLD=\"TRUE\"	  />    </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_LION_ROAR.XML", "<ACTION ID=\"a_twin_lion_roar\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"lion_roar\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_MAKE_TWO.XML", "<ACTION ID=\"a_twin_make_two\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"make_two\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_MELEE_01_M.XML", "<ACTION ID=\"a_twin_melee_01_m\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"melee_01\"/>  <FSM SCRIPT=\"Act_Melee\" USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_MELEE_02_M.XML", "<ACTION ID=\"a_twin_melee_02_m\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"melee_02\"/>  <FSM SCRIPT=\"Act_Melee\" USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_MELEE_03_S.XML", "<ACTION ID=\"a_twin_melee_03_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"ready_to_skill\"/>  <SLOT NAME=\"melee_03\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT1=\"1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"10\"	MOVE_COMPLETE_TIME_1=\"0.333\"		NO_DAMAGE_HOLD=\"TRUE\"  />    </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_MELEE_04_M.XML", "<ACTION ID=\"a_twin_melee_04_m\" NEXT=\"a_battle_idle\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\"USE_CFUNC_ONTARGET=\"TRUE\" >  <SLOT NAME=\"melee_04\"/>  <FSM SCRIPT=\"Act_Melee\" USE_TLM=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_MELEE_05_S.XML", "<ACTION ID=\"a_twin_melee_05_s\" NEXT=\"a_twin_sub_repos\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"ready_to_skill\"/>  <SLOT NAME=\"melee_05\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT1=\"2\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_2=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT1_2=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_2=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_2=\"0.1\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_POWER_FIST.XML", "<ACTION ID=\"a_twin_power_fist\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"power_fist\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"	MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"100\"	MOVE_COMPLETE_TIME_1=\"0.1\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_POWER_WEAVING.XML", "<ACTION ID=\"a_twin_power_weaving\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" OVERRIDE_PACKET=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"power_weaving\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"	EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_boxing_mc_skill_twn_power_weaving_01\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"			MOVE_SYNC_INPUT_DIR=\"TRUE\"				MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"USER_INPUT_DIR\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"0\"			MOVE_GOAL_POS_DIST_1=\"100\"	MOVE_COMPLETE_TIME_1=\"0.367\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_RAPID_STANCE.XML", "<ACTION ID=\"a_twin_rapid_stance\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"rapid_stance_cast\" LOOP=\"TRUE\"/>  <SLOT NAME=\"rapid_stance_fire\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		USE_DMG_EFFECT=\"FALSE\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"0\"	EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_boxing_mc_skill_dft_repid_stense_00\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"	EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"			EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"	EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_boxing_mc_skill_dft_repid_stense_01\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_RISING_DROP_KICK_S.XML", "<ACTION ID=\"a_twin_rising_drop_kick_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"rising_drop_kick\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"	WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"135\"	MOVE_COMPLETE_TIME_1=\"0.5667\"		WHEN_ATTACK_TIMER_START=\"MSG_HIT\"	ATTACK_TIMER_TIME=\"10\"	ATTACK_TIMER_TICK=\"0.15\"			NO_DAMAGE_HOLD=\"TRUE\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_ROCKET_BLOW_S.XML", "<ACTION ID=\"a_twin_rocket_blow_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"rocket_blow\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"				TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"18\"	MOVE_COMPLETE_TIME_1=\"0.234\"	NO_DAMAGE_HOLD=\"TRUE\"  />      </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_ROLLING_GRABBLE_S.XML", "<ACTION ID=\"a_twin_rolling_grabble_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"rolling_grabble\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"			MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"20\"	MOVE_COMPLETE_TIME_1=\"0.5\"		MOVE_TYPE_2=\"I\"	MOVE_GOAL_POS_TARGET_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"	MOVE_GOAL_POS_DIST_2=\"210\"	MOVE_COMPLETE_TIME_2=\"0.8334\"		WHEN_ATTACK_TIMER_START=\"MSG_HIT\"	ATTACK_TIMER_TIME=\"10\"	ATTACK_TIMER_TICK=\"0.15\"	NO_DAMAGE_HOLD=\"TRUE\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SCREW_DROP_KICK.XML", "<ACTION ID=\"a_twin_screw_drop_kick\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"screw_drop_kick_start\"/>  <SLOT NAME=\"screw_drop_kick_process\"/>  <SLOT NAME=\"screw_drop_kick_end\"/>   <FSM SCRIPT=\"CommonSkillAction\" 	  	USE_TLM=\"TRUE\"	MOVE_TYPE_1=\"V\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_VERT_DEG_1=\"-45\"	MOVE_SPEED_1=\"650\"	MOVE_STOP_OPTION_1=\"MEET_FLOOR\"			MEET_FLOOR_THEN_NEXT_ANI_SLOT=\"2\"		HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SLIDE_WHIRL.XML", "<ACTION ID=\"a_twin_slide_whirl\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_charge_02\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SLIDING_BATTER_S.XML", "<ACTION ID=\"a_twin_sliding_batter_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"sliding_batter\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"	MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"30\"	MOVE_COMPLETE_TIME_1=\"0.4667\"		MOVE_TYPE_2=\"I\"	MOVE_GOAL_POS_TARGET_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"	MOVE_GOAL_POS_DIST_2=\"110\"	MOVE_COMPLETE_TIME_2=\"0.6\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SMASH_KICK_S.XML", "<ACTION ID=\"a_twin_smash_kick_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"smash_kick_start\"/>  <SLOT NAME=\"smash_kick_fire\"/>  <SLOT NAME=\"smash_kick_end\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"		REPEAT_ANISLOT2_ON_SKILL_LV1 = \"2\"	REPEAT_ANISLOT2_ON_SKILL_LV2 = \"3\"	REPEAT_ANISLOT2_ON_SKILL_LV3 = \"4\"	REPEAT_ANISLOT2_ON_SKILL_LV4 = \"5\"	REPEAT_ANISLOT2_ON_SKILL_LV5 = \"6\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"40\"	MOVE_COMPLETE_TIME_1=\"0.2334\"		MOVE_TYPE_2=\"I\"	MOVE_GOAL_POS_TARGET_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"	MOVE_GOAL_POS_DIST_2=\"40\"	MOVE_COMPLETE_TIME_2=\"0.1\"		NO_DAMAGE_HOLD=\"TRUE\"  />   	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SPIN_BLADE_S.XML", "<ACTION ID=\"a_twin_spin_blade_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"repos\"/>  <SLOT NAME=\"spin_blade_start\"/>  <SLOT NAME=\"spin_blade_attack\"/>  <SLOT NAME=\"spin_blade_finish\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"		REPEAT_ANISLOT3_ON_SKILL_LV1 = \"2\"	REPEAT_ANISLOT3_ON_SKILL_LV2 = \"3\"	REPEAT_ANISLOT3_ON_SKILL_LV3 = \"4\"	REPEAT_ANISLOT3_ON_SKILL_LV4 = \"5\"	REPEAT_ANISLOT3_ON_SKILL_LV5 = \"6\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"30\"	MOVE_COMPLETE_TIME_1=\"0.5\"		MOVE_TYPE_2=\"I\"	MOVE_GOAL_POS_TARGET_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"	MOVE_GOAL_POS_DIST_2=\"50\"	MOVE_COMPLETE_TIME_2=\"1.0666\"		MOVE_TYPE_3=\"I\"	MOVE_GOAL_POS_TARGET_3=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_3=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_3=\"0\"	MOVE_GOAL_POS_DIST_3=\"50\"	MOVE_COMPLETE_TIME_3=\"1.0666\"		MOVE_TYPE_4=\"I\"	MOVE_GOAL_POS_TARGET_4=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_4=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_4=\"0\"	MOVE_GOAL_POS_DIST_4=\"50\"	MOVE_COMPLETE_TIME_4=\"1.0666\"		MOVE_TYPE_5=\"I\"	MOVE_GOAL_POS_TARGET_5=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_5=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_5=\"0\"	MOVE_GOAL_POS_DIST_5=\"30\"	MOVE_COMPLETE_TIME_5=\"1.0666\"		MOVE_TYPE_6=\"I\"	MOVE_GOAL_POS_TARGET_6=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_6=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_6=\"0\"	MOVE_GOAL_POS_DIST_6=\"50\"	MOVE_COMPLETE_TIME_6=\"1.0666\"		MOVE_TYPE_7=\"I\"	MOVE_GOAL_POS_TARGET_7=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_7=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_7=\"0\"	MOVE_GOAL_POS_DIST_7=\"50\"	MOVE_COMPLETE_TIME_7=\"1.0666\"		NO_DAMAGE_HOLD=\"TRUE\"  />   		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SPIN_BOOM_S.XML", "<ACTION ID=\"a_twin_spin_boom_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"spin_boom\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"			TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"				FIRE_PROJECTILE_ID_1 = \"PROJECTILE_SPIN_BOOM\"	FIRE_PROJECTILE_START_NODE_POS_1 = \"p_pt_ride\"	FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"0\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"1\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"1\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"1\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"1\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"1\"			FIRE_PROJECTILE_ID_2 = \"PROJECTILE_SPIN_BOOM\"	FIRE_PROJECTILE_START_NODE_POS_2 = \"p_pt_ride\"	FIRE_PROJECTILE_ARRIVE_POS_TYPE_2 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_2=\"0\"	FIRE_PROJECTILE_NUM_2_ON_SKILL_LV1=\"1\"	FIRE_PROJECTILE_NUM_2_ON_SKILL_LV2=\"1\"	FIRE_PROJECTILE_NUM_2_ON_SKILL_LV3=\"1\"	FIRE_PROJECTILE_NUM_2_ON_SKILL_LV4=\"1\"	FIRE_PROJECTILE_NUM_2_ON_SKILL_LV5=\"1\"		HIT_TARGET_EFFECT_TARGET_NODE=\"\"	HIT_TARGET_EFFECT_ID=\"\"	  />	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SPIN_KICK.XML", "<ACTION ID=\"a_twin_spin_kick\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_charge_04\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT1=\"1\"	TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"4\"	TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			HIT_MSG_QUAKE_CAMERA_DURATION=\"0.4\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"0.7\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"		NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SPIN_KICK_S.XML", "<ACTION ID=\"a_twin_spin_kick_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"spin_kick_s\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"10\"	MOVE_COMPLETE_TIME_1=\"0.267\"	NO_DAMAGE_HOLD=\"TRUE\"  />    </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/FU_SPIRIT_RELEASE.XML", "<ACTION ID=\"a_twin_spirit_release_fu\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_spirit_blow_cast\"/>  <SLOT NAME=\"fu_spirit_blow_cast_idle\" LOOP=\"TRUE\"/>  <SLOT NAME=\"fu_spirit_blow_fire\"/>  <SLOT NAME=\"fu_spirit_blow_fire_idle\"/>  <SLOT NAME=\"fu_spirit_blow_finish\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		REPEAT_ANISLOT4_ON_SKILL_LV1 = \"2\"	REPEAT_ANISLOT4_ON_SKILL_LV2 = \"2\"	REPEAT_ANISLOT4_ON_SKILL_LV3 = \"3\"	REPEAT_ANISLOT4_ON_SKILL_LV4 = \"4\"	REPEAT_ANISLOT4_ON_SKILL_LV5 = \"5\"				EFFECT_CNT_WHEN_HIT_MSG = \"1\"	EFFECT_TYPE_WHEN_HIT_MSG_1 = \"2\"	EFFECT_ID_WHEN_HIT_MSG_1 = \"efx_boxing_fu_skill_twn_fighting_spirit_01_cr\"	EFFECT_TARGET_NODE_WHEN_HIT_MSG_1 = \"char_root\"	EFFECT_SCALE_WHEN_HIT_MSG_1 = \"1\"			HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"2\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"		NO_DAMAGE_HOLD=\"TRUE\"			CANCEL_TYPE=\"2\"	CANCEL_ACTION_NAME1=\"a_twin_fist_storm_dash_fu\"	CANCEL_ACTION_EFFECT_NO1=\"400301201\"		CANCEL_ACTION_NAME2=\"a_twin_abs_protect_fu\"	CANCEL_ACTION_EFFECT_NO2=\"400301201\"	CANCEL_ACTION_NAME3=\"a_twin_finish_impact_fu\"	CANCEL_ACTION_EFFECT_NO3=\"400301201\"	CANCEL_ACTION_NAME4=\"a_twin_finish_move_fu\"	CANCEL_ACTION_EFFECT_NO4=\"400301201\"	CANCEL_ACTION_NAME5=\"a_twin_spirit_release_fu\"	CANCEL_ACTION_EFFECT_NO5=\"400301201\"	CANCEL_ACTION_NAME6=\"a_twin_ghost_fighter_fu\"	CANCEL_ACTION_EFFECT_NO6=\"400301201\"	CANCEL_ACTION_NAME7=\"a_twin_impact_blow_fu\"	CANCEL_ACTION_EFFECT_NO7=\"400301201\"  />	</ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SPIRIT_SPEAR_S.XML", "<ACTION ID=\"a_twin_spirit_spear_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"spirit_spear\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_ATTACK_TIMER_START=\"ENTER\"	ATTACK_TIMER_TIME=\"0.6\"	ATTACK_TIMER_TICK=\"0.3\"			WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"150\"	MOVE_COMPLETE_TIME_1=\"0.4333\"		NO_DAMAGE_HOLD=\"TRUE\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_STAMPER_S.XML", "<ACTION ID=\"a_twin_stamper_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <!--SLOT NAME=\"ready_to_skill\"/-->  <SLOT NAME=\"stamper\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"80\"	MOVE_COMPLETE_TIME_1=\"1.0666\"	NO_DAMAGE_HOLD=\"TRUE\"  />   		</ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TWIN_REPOS_S.XML", "<ACTION ID=\"a_twin_sub_repos\" NEXT=\"a_twin_sub_trace_ground\"  USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"repos\"/>  <FSM SCRIPT=\"CommonSkillAction\" 		WHEN_START_DIRECTION=\"CALLER\"		USE_TLM=\"FALSE\"			TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"180\"	MOVE_GOAL_POS_DIST_1=\"25\"	MOVE_COMPLETE_TIME_1=\"0.5\"	MOVE_GOAL_POS_UPDATE_1=\"TRUE\"	  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/TWIN_SUB_TRACE_GROUND.XML", "<ACTION ID=\"a_twin_sub_trace_ground\" NEXT=\"a_twin_sub_trace_ground\" LOOP=\"TRUE\" CAN_FOLLOW=\"TRUE\" NO_RANDOM_ANIMATION=\"TRUE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" TYPE=\"MOVE\">	<SLOT NAME=\"idle_01\"/>	<SLOT NAME=\"idle_02\"/>	<SLOT NAME=\"idle_03\"/>	<SLOT NAME=\"battle_idle\"/>  	<!--3/-->	<SLOT NAME=\"repos_warp_start\"/>	<!--4/-->	<SLOT NAME=\"repos_warp_end\"/>  	<!--5/-->	<SLOT NAME=\"run\"/>	<!--   -->	<SLOT NAME=\"dash\"/>  <!--      -->	<SLOT NAME=\"opening\"/>	<FSM SCRIPT=\"Act_Twin_Sub_Trace_Ground\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SUMMERSOLT.XML", "<ACTION ID=\"a_twin_summersolt\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"attk_charge_03\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SUMMERSOLT_S.XML", "<ACTION ID=\"a_twin_summersolt_s\" NEXT=\"a_twin_sub_repos\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"attk_charge_03\"/>  <FSM SCRIPT=\"Skill_Melee_Blow_Up\" 	USE_TLM=\"FALSE\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_SWISH_KICK_S.XML", "<ACTION ID=\"a_twin_swish_kick_s\" NEXT=\"a_twin_sub_repos\"  USE-EVENT=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"swish_kick\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"	USE_TRAIL=\"TRUE\"	TRAIL_CNT_WHEN_ANI_SLOT1=\"1\"		TRAIL_TYPE_WHEN_ANI_SLOT1_1=\"5\"	TRAIL_PATH_WHEN_ANI_SLOT1_1=\"\"	TRAIL_TOTAL_TIME_WHEN_ANI_SLOT1_1=\"0.5\"	TRAIL_BRIGHT_TIME_WHEN_ANI_SLOT1_1=\"0.1\"			TRANSIT_CHECK_TYPE=\"1\"	TRANSIT_CHECK_PREV_ACTION_NAME1=\"a_battle_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME2=\"a_idle\"	TRANSIT_CHECK_PREV_ACTION_NAME3=\"a_twin_sub_repos\"	TRANSIT_CHECK_PREV_ACTION_NAME4=\"a_run\"	TRANSIT_CHECK_PREV_ACTION_NAME5=\"a_twin_sub_trace_ground\"	TRANSIT_CHECK_PREV_ACTION_NAME6=\"a_twin_melee_03_s\"	TRANSIT_CHECK_PREV_ACTION_NAME7=\"a_twin_melee_05_s\"		TRANSIT_ACTION1=\"a_battle_idle\"	TRANSIT_ACTION_CONDITION1_1=\"10\"		WHEN_START_DIRECTION=\"CALLER\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_1=\"CALLER\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"140\"	MOVE_COMPLETE_TIME_1=\"0.4\"		MOVE_TYPE_2=\"I\"	MOVE_GOAL_POS_TARGET_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_2=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_2=\"0\"	MOVE_GOAL_POS_DIST_2=\"-140\"	MOVE_COMPLETE_TIME_2=\"0.3667\"	NO_DAMAGE_HOLD=\"TRUE\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_TORNADO_SPIN.XML", "<ACTION ID=\"a_twin_tornado_spin\" NEXT=\"a_jump\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>    <SLOT NAME=\"tornado_spin\"/>     <FSM SCRIPT=\"StormBlade\"  	FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"    FIRE_CASTER_EFFECT_ID=\"efx_boxing_mc_skill_dft_tornado_spin_01\"	FIRE_CASTER_EFFECT_SCALE=\"1\"    FIRE_SOUND_ID=\"\"		RISING_MOVING_DELTA=\"50\"	NO_DAMAGE_HOLD=\"TRUE\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_TORNADO_UPPER.XML", "<ACTION ID=\"a_twin_tornado_upper\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"tornado_upper\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		FIRE_PROJECTILE_ID_1 = \"PROJECTILE_TORNADOUPPER\"	FIRE_PROJECTILE_START_NODE_POS_1 = \"p_pt_ride\"	FIRE_PROJECTILE_ARRIVE_POS_TYPE_1 = \"0\"		FIRE_PROJECTILE_MOVE_TYPE_1=\"2\"		FIRE_PROJECTILE_NUM_1_ON_SKILL_LV1=\"2\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV2=\"2\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV3=\"2\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV4=\"2\"	FIRE_PROJECTILE_NUM_1_ON_SKILL_LV5=\"2\"			FIRE_PROJECTILE_DEG1_1=\"0\"	FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_1 = \"75\"	FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_1 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST1_1_1 = \"0.8\"			FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_1 = \"-45\"	FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_1 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST2_1_1 = \"1.0\"		FIRE_PROJECTILE_DEG1_2=\"0\"	FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_2 = \"-75\"	FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_2 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST1_1_2 = \"0.8\"			FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_2 = \"45\"	FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_2 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST2_1_2 = \"1\"		FIRE_PROJECTILE_DEG1_3=\"30\"	FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_3 = \"120\"	FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_3 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST1_1_3 = \"0.8\"			FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_3 = \"0\"	FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_3 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST2_1_3 = \"1.0\"		FIRE_PROJECTILE_DEG1_4=\"-30\"	FIRE_PROJECTILE_BEZIER_HOREZ_DEG1_1_4 = \"-120\"	FIRE_PROJECTILE_BEZIER_VERT_DEG1_1_4 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST1_1_4 = \"0.8\"			FIRE_PROJECTILE_BEZIER_HOREZ_DEG2_1_4 = \"0\"	FIRE_PROJECTILE_BEZIER_VERT_DEG2_1_4 = \"0\"	FIRE_PROJECTILE_BEZIER_DIST2_1_4 = \"1\"		HIT_TARGET_EFFECT_TARGET_NODE=\"\"	HIT_TARGET_EFFECT_ID=\"\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_TRAINING_TIME.XML", "<ACTION ID=\"a_twin_training_time\" NEXT=\"a_battle_idle\" USE_CFUNC_ONTARGET=\"TRUE\"  USE_CFUNC=\"TRUE\" USE-EVENT=\"TRUE\">	<SLOT NAME=\"training_time_cast\" LOOP=\"TRUE\"/>	<SLOT NAME=\"training_time_fire\"/>  	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"				EFFECT_CNT_WHEN_EFFECT_MSG1=\"1\"		EFFECT_TYPE_WHEN_EFFECT_MSG1_1=\"2\"		EFFECT_ID_WHEN_EFFECT_MSG1_1=\"efx_boxing_mc_skill_trainingtime_01_cr\"		EFFECT_TARGET_NODE_WHEN_EFFECT_MSG1_1=\"char_root\"		EFFECT_SCALE_WHEN_EFFECT_MSG1_1=\"1\"		EFFECT_HORIZ_DEG_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_VERT_DEG_WHEN_EFFECT_MSG1_1=\"0\"		EFFECT_DIST_WHEN_EFFECT_MSG1_1=\"0\"				NO_DAMAGE_HOLD=\"TRUE\"				CANCEL_TYPE=\"1\"	  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_WEAVING.XML", "<ACTION ID=\"a_twin_weaving\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"weaving\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"TRUE\"		EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"	EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"0\"	EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_boxing_mc_skill_dft_weaving_01\"	EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"	EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"		MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"120\"	MOVE_COMPLETE_TIME_1=\"0.367\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/TWINS/TWIN_WEAVING_S.XML", "<ACTION ID=\"a_twin_weaving_s\" NEXT=\"a_twin_sub_trace_ground\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"casting01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"weaving\"/>  <FSM SCRIPT=\"CommonSkillAction\" 	USE_TLM=\"FALSE\"	MOVE_TYPE_1=\"I\"	MOVE_GOAL_POS_TARGET_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_1=\"SELF\"	MOVE_GOAL_POS_DIST_DIR_ROTATE_HORIZ_DEG_1=\"0\"	MOVE_GOAL_POS_DIST_1=\"100\"	MOVE_COMPLETE_TIME_1=\"0.367\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/TWOACTION_CAST.XML", "<ACTION ID=\"a_twoaction_cast\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Arc_Csb_skill_TwoActionshot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_SOUND_ID=\"TwoActionShot_01\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_twoactionshot_01_char_root\"       />	   <!--	   HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_CASTER_EFFECT_ID=\"ef_twoactionshot_02_char_root\"	   	   DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_ID_DEFAULT_DETACH=\"TRUE\" 	   --></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/TWOACTION_FIRE.XML", "<ACTION ID=\"a_twoaction_fire\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"TwoActionFire\" PROJECTILE_ID=\"PROJECTILE_TWOACTION_ARROW\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/UNHIDE.XML", "<ACTION ID=\"a_unhide\" NEXT=\"a_idle\" CHECK_CAN_ENTER =\"TRUE\">	<SLOT NAME=\"opening_01\"/>	<FSM SCRIPT=\"Act_Unhide\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/UNLOCK_MOVE.XML", "<ACTION ID=\"a_unlock_move\" NEXT=\"a_idle\" CAN_FOLLOW=\"TRUE\" TYPE=\"IDLE\">	<SLOT NAME=\"idle_01\" LOOP = \"TRUE\" />	<SLOT NAME=\"ride_01\" LOOP = \"TRUE\" />	<FSM SCRIPT=\"Act_Unlock_Move\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/USECOOK.XML", "<ACTION ID=\"a_Use Cook\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>    <FSM SCRIPT=\"Act_Use_UICall\"       CALL_UI_NAME=\"SFRM_ITEM_MAKING_COOK\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/USEENCHANT.XML", "<ACTION ID=\"a_Use Enchant\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>    <FSM SCRIPT=\"Act_Use_UICall\"       CALL_UI_NAME=\"SFRM_ITEM_PLUS_UPGRADE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/USEREPAIR.XML", "<ACTION ID=\"a_Use Repair\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_03\"/>    <FSM SCRIPT=\"Act_Use_UICall\"       CALL_UI_NAME=\"SFRM_REPAIR\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/VALCAN300.XML", "<ACTION ID=\"a_Valcan 300\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/VALCAN300_PLAY.XML", "<ACTION ID=\"a_Valcan 300 Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" >  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_Valcan300_Play\" PROJECTILE_ID=\"PROJECTILE_VALCAN300\" ATTACH_NODE_ID=\"p_ef_dummy\"       HIT_SOUND_ID=\"AutoShootSystem\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/VENDOR.XML", "<ACTION ID=\"a_vendor\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"sit_down\"/>	<SLOT NAME=\"sit_idle\"/>	<SLOT NAME=\"sit_up\"/>	<FSM SCRIPT=\"Act_vendor\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/VENOM.XML", "<ACTION ID=\"a_Venom\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Venom_01\"/>  <FSM SCRIPT=\"Skill_Venom\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/VENOMCRASHER.XML", "<ACTION ID=\"a_Venom Crasher\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_PoisonCrasher_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       CASTING_SOUND_ID=\"VenomBoil\"       CASTING_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_PoisonCrasher_01_char_root\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/VICTORY.XML", "<ACTION ID=\"a_victory\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_victory_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_SingleStage\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/VIOLENCEBLOW.XML", "<ACTION ID=\"a_Violence Blow\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_ViolenceBlow_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       MULTI_HIT_NUM=\"5\"       FIRE_CASTER_EFFECT_TARGET_NODE =\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Com_skill_ViolenceBlow_01_char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       NO_WEAPON_TRAIL=\"TRUE\"      /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/VITALITY.XML", "<ACTION ID=\"a_Vitality\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_Buff\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       NO_WEAPON_TRAIL=\"TRUE\"       HIT_CASTER_EFFECT_ID=\"ef_Mask_Vitality_01_char_root\"       HIT_CASTER_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID=\"ef_Mask_Vitality_02_char_root\"       HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       HIT_SOUND_ID=\"Dexterity\"       FIND_TARGET_TYPE=\"SPHERE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/SUMMONER/VOLCANO.XML", "<ACTION ID=\"a_volcano\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" USE_CFUNC=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\">		<SLOT NAME=\"volcano_01\" LOOP=\"TRUE\"/>	<SLOT NAME=\"volcano_02\"/>	<FSM SCRIPT=\"CommonSkillAction\" 		USE_TLM=\"TRUE\"		EFFECT_CNT_WHEN_ANI_SLOT0=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT0_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT0_1=\"eff_sum_skill_smw_volcano_00\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT0_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT0_1=\"1\"		EFFECT_DETACH_TIME_ANI_SLOT0_1=\"ANI_DONE\"				EFFECT_CNT_WHEN_ANI_SLOT1=\"1\"		EFFECT_TYPE_WHEN_ANI_SLOT1_1=\"2\"		EFFECT_ID_WHEN_ANI_SLOT1_1=\"eff_sum_skill_smw_volcano_01\"		EFFECT_TARGET_NODE_WHEN_ANI_SLOT1_1=\"char_root\"		EFFECT_SCALE_WHEN_ANI_SLOT1_1=\"1\"						HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"		HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"		HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"		HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"		HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"				NO_DAMAGE_HOLD=\"TRUE\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/VOLUNTARILY_DIE.XML", "<ACTION ID=\"a_voluntarily_die\" TYPE=\"EFFECT\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"voluntarily_die_01\"/>  <SLOT NAME=\"voluntarily_die_idle_01\"/>  <SLOT NAME=\"die_01\"/>  <FSM SCRIPT=\"Act_Die\"		HIT_MSG_QUAKE_CAMERA_DURATION=\"0.5\"	HIT_MSG_QUAKE_CAMERA_FACTOR=\"1\"	HIT_MSG_QUAKE_CAMERA_TYPE=\"0\"	HIT_MSG_QUAKE_CAMERA_FREQ=\"0\"	HIT_MSG_QUAKE_CAMERA_COUNT=\"0\"  /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("EMOTIONS/VOTE.XML", "<ACTION ID=\"a_vote\" NEXT=\"a_idle\" TYPE=\"IDLE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"emotion_vote_01\"/>	<FSM SCRIPT=\"Act_Single_Emotion_Picket\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/WALK_DOWN.XML", "<ACTION ID=\"a_walk_down\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Walk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/WALK_LEFT.XML", "<ACTION ID=\"a_walk_left\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Walk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/WALK_RIGHT.XML", "<ACTION ID=\"a_walk_right\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Walk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/WALK_UP.XML", "<ACTION ID=\"a_walk_up\" NEXT=\"a_idle\" LOOP=\"TRUE\" TYPE=\"MOVE\" MONITOR=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\" USE_CFUNC=\"TRUE\">	<SLOT NAME=\"walk\"/>	<FSM SCRIPT=\"Act_Walk\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/WARP.XML", "<ACTION ID=\"a_warp\" NEXT=\"a_idle\">	<SLOT NAME=\"Warp\"/>	<SLOT NAME=\"idle_01\"/>	<FSM SCRIPT=\"Act_Opening\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/WEAPONBREAK.XML", "<ACTION ID=\"a_Weapon Break\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Skill_InstallDefault\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/WEAPONBREAK_FIRE.XML", "<ACTION ID=\"a_Weapon Break_Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <SLOT NAME=\"finish_01\"/>  <FSM SCRIPT=\"Skill_Weapon_Break_Fire\" /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/PALADIN/WEAPONCRASHER.XML", "<ACTION ID=\"a_Weapon Crasher\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_armor_break_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"        HIT_SOUND_ID=\"ArmorBreak\"        WEAPON_XML=\"../XML/Item/Common/12_Weapon/09_special/WeaponCrasher.xml\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Armor_Break_01_char_root\"	   DETACH_FIRE_EFFECT_AT_FINISH=\"TRUE\"	   FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH=\"TRUE\"       NO_WEAPON_TRAIL=\"TRUE\" />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/KNIGHT/WEAPONFREEZING.XML", "<ACTION ID=\"a_Weapon Freezing\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Onehand_skill_WeaponFreezing_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_wp_r_hand\"       FIRE_CASTER_EFFECT_ID=\"ef_WeaponFreezing_01_p_wp_hand\"       HIT_SOUND_ID=\"Weaponfreeze\"       WEAPON_XML=\"Item/Common/12_Weapon/09_special/WeaponFreezing.xml\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/WEAPONQUICKEN.XML", "<ACTION ID=\"a_Weapon Quicken\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       FIRE_CASTER_EFFECT_ID=\"ef_Waeponquicken_01_char_root\"       HIT_SOUND_ID=\"WeaponQuicken\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/WHEELWIND.XML", "<ACTION ID=\"a_Wheel Wind\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StormBlade_01\"/>  <FSM SCRIPT=\"Skill_WheelWind\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIDEHEAL.XML", "<ACTION ID=\"a_Wide Heal\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Shot_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\" FIND_TARGET_TYPE=\"SPHERE\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"__FRONT_ACTOR\"        FIRE_CASTER_EFFECT_ID=\"Nurse_Call\"              CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS =\"char_root\"       CASTING_EFFECT_EFFECT_ID =\"ef_skill_Wideheal_01_char_root\"                 HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       HIT_CASTER_EFFECT_ID =\"ef_skill_Wideheal_02_char_root\"              HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"       HIT_TARGET_EFFECT_ID =\"ef_skill_Wideheal_03_char_root\"              NO_DEFAULT_HIT_EFFECT =\"TRUE\"       HIT_SOUND_ID=\"Heal\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/WILDRAGE.XML", "<ACTION ID=\"a_Wild Rage\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Bup_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"       HIT_SOUND_ID=\"WildRage\"       FIND_TARGET_TYPE=\"SPHERE\"       FIRE_CASTER_EFFECT_ID=\"ef_skill_wildrage_01_char_root\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"       CASTING_EFFECT_EFFECT_ID=\"ef_area_circle_B_001\"       CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS=\"char_root\"       DETACH_CASTING_EFFECT_AT_FINISH=\"TRUE\"       CASTING_EFFECT_SIZE_TO_SKILLRANGE=\"TRUE\"       NO_DEFAULT_HIT_EFFECT =\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/WIND_STEP.XML", "<ACTION ID=\"a_Wind Step\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">	<SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\" />	<SLOT NAME=\"com_skill_buff\"/>   <FSM SCRIPT=\"Act_Melee_Default\" HIT_SOUND_ID=\"WindStep\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/WINDSURIKEN.XML", "<ACTION ID=\"a_Wind Suriken\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"Com_skill_Fire_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_skill_Ground_01\"/>  <FSM SCRIPT=\"Projectile_Default\" PROJECTILE_ID=\"Projectile_Windsuriken\"       HIT_SOUND_ID=\"WindSuriken\"       FIRE_CASTER_EFFECT_ID=\"ef_Ground_01_p_wp_r_hand\"       FIRE_CASTER_EFFECT_TARGET_NODE=\"p_wp_r_hand\"       DETACH_FIRE_CASTER_EFFECT_AT_HIT=\"TRUE\"       SKILL_LEVEL_TO_SIZE=\"TRUE\"       SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE=\"0.9\"       HIDE_WEAPON=\"TRUE\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WINDBLADE.XML", "<ACTION ID=\"a_WindBlade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"csb_skill_PinpointShot_01_01\"/>	<FSM SCRIPT=\"Skill_Sentinel_WindBlade\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_iceshower_01_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_iceshower_02_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID2=\"ef_skill_wind_blade_04_char_root\"		FIRE_CASTER_EFFECT_TARGET_NODE2=\"char_root\"		MULTI_HIT_NUM=\"10\"		FIRE_SOUND_ID=\"WindBlade_1\"	/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WINDBLADESA.XML", "<ACTION ID=\"a_WindBladeSA\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">	<SLOT NAME=\"Wind_Blade_skill_01\"/>	<FSM SCRIPT=\"Skill_Sentinel_WindBladeSA\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_wind_blade_01_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/CLOWN/DANCER/WINDMILL.XML", "<ACTION ID=\"a_Windmill\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" CAN_CHANGE_ACTOR_POS=\"TRUE\">  <SLOT NAME=\"Com_skill_wind_mill_01_01\"/>  <SLOT NAME=\"Com_skill_wind_mill_01_01\"/>  <SLOT NAME=\"Com_skill_wind_mill_01_02\"/>  <SLOT NAME=\"Com_skill_wind_mill_01_03\"/>  <FSM SCRIPT=\"Skill_WindMill\"       HIT_SOUND_ID=\"windmill\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/THIEF/ASSASSIN/NINJA/WINDSTEP.XML", "<ACTION ID=\"a_windstep\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StripWeapon_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"   	CASTING_EFFECT_EFFECT_ID =\"\" 	CASTING_EFFECT_TARGET_NODE =\"\"		DETACH_CASTING_EFFECT_AT_FINISH = \"TRUE\"		    FIRE_CASTER_EFFECT_ID=\"\"    FIRE_CASTER_EFFECT_TARGET_NODE=\"\"    DETACH_FIRE_EFFECT_AT_FINISH=\"\"		HIT_SOUND_ID=\"buff_blueaura\"		NO_WEAPON_TRAIL=\"TRUE\"  />  </ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WIREACTION.XML", "<ACTION ID=\"a_Wire Action\" NEXT=\"a_Wire Action_Finish\" CHECK_CAN_ENTER=\"TRUE\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Bow_skill_WireAction_01_01\" />  <SLOT NAME=\"Bow_skill_WireAction_01_02\" />  <SLOT NAME=\"Bow_skill_WireAction_01_03\" />  <FSM SCRIPT=\"Skill_DeathSnatch\" FLY_ANGLE=\"0\" HAND_CLASS_NO=\"900018\" HIDE_HAND_CREATION_ANIMATION=\"TRUE\" HAND_COUNT=\"5\" HAND_GAP_ANGLE=\"15\"  TRAIL_TEXTURE=\"../Data/5_Effect/9_Tex/swift_01.tga\" TRAIL_TOTAL_TIME=\"500\" TRAIL_BRIGHT_TIME=\"0\" TRAIL_EXTEND_LENGTH=\"0\"   /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/TRAPPER/SENTINEL/WIREACTIONFINISH.XML", "<ACTION ID=\"a_Wire Action_Finish\" NEXT=\"a_battle_idle\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"battle_idle\" />  <FSM SCRIPT=\"Skill_DeathSnatchFinish\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/WOLFRUSH.XML", "<ACTION ID=\"a_Wolf Rush\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Skill_Wolf_Rush\"       HIT_SOUND_ID=\"WolfRush\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/HUNTER/WOLFRUSH_PLAY.XML", "<ACTION ID=\"a_Wolf Rush_Play\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC=\"TRUE\">  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"idle_01\"/>  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Skill_Wolf_Rush_Play\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/WPGRANADE.XML", "<ACTION ID=\"a_WP Granade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\"  IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"com_skill_spell_01\" LOOP = \"true\"/>  <SLOT NAME=\"Com_shot_04\"/>  <FSM SCRIPT=\"Projectile_HandGrenade\" PROJECTILE_ID =\"PROJECTILE_HEGrenade\"        ATTACH_NODE_ID=\"p_wp_r_hand\"        HIDE_WEAPON=\"TRUE\"       HIT_SOUND_ID=\"WP_Granade_Fire\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/ARCHER/RANGER/SNIPER/WPGRANADEFIRE.XML", "<ACTION ID=\"a_WP Granade Fire\" NEXT=\"a_idle\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"attk_01\"/>  <FSM SCRIPT=\"Act_Melee_Default\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/WRATHOFHEAVEN.XML", "<ACTION ID=\"a_WrathOfHeaven\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\" USE_CFUNC_ONTARGET=\"TRUE\" ALWAYS_IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"skill_RaceOfHeaven_01\"/>  <FSM SCRIPT=\"Skill_Arcmage_WrathOfHeaven\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_lightingmagnet_02_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"\"		HIT_CASTER_EFFECT_ID=\"\"		HIT_CASTER_EFFECT_TARGET_NODE=\"\"		HIT_TARGET_EFFECT_ID=\"ef_skill_lightingstorm_02_char_root\"		HIT_TARGET_EFFECT_TARGET_NODE=\"char_root\"		MULTI_HIT_NUM=\"5\"		FIRE_SOUND_ID=\"WrathOfHeaven\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/MAGICIAN/MAGE/WIZARD/ARCHMAGE/WRATHOFHEAVENSA.XML", "<ACTION ID=\"a_WrathOfHeavenSA\" NEXT=\"a_idle\" USE-EVENT=\"TRUE\">  <SLOT NAME=\"RaceOfHeaven_skill_01\"/>  <FSM SCRIPT=\"Skill_Arcmage_WrathOfHeavenSA\"		CASTING_EFFECT_EFFECT_ID=\"ef_skill_LightingMagnet_01_char_root\"		CASTING_EFFECT_TARGET_NODE=\"char_root\"		FIRE_CASTER_EFFECT_ID=\"ef_skill_raceofheaven_01_p_ef_r_hand\"		FIRE_CASTER_EFFECT_TARGET_NODE=\"p_ef_r_hand\"       /></ACTION>") );
	m_kContXmlData.insert( std::make_pair("SKILL/FIGHTER/WARRIOR/GLADIATOR/WYVERNBLADE.XML", "<ACTION ID=\"a_Wyvern Blade\" NEXT=\"a_battle_idle\" USE-EVENT=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" IGNORE_DMG_EFFECT=\"TRUE\">  <SLOT NAME=\"Com_spell_01\" LOOP=\"TRUE\"/>  <SLOT NAME=\"Com_Skill_StormBlade_01\"/>  <FSM SCRIPT=\"WyvernBlade\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSHLONG.XML", "<ACTION ID=\"mon_push_long\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">   <SLOT NAME=\"dmg_01\" />     <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE = \"260\" VELOCITY = \"300\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSHMIDDLE.XML", "<ACTION ID=\"mon_pushmiddle\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"dmg_01\" />   <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE = \"180\" VELOCITY = \"300\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSHSHORT.XML", "<ACTION ID=\"mon_pushshort\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"dmg_01\" />     <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE=\"100\" VELOCITY = \"300\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSH_ATOT.XML", "<!-- (Attacker)  (target)    --><ACTION ID=\"mon_push_atot\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">   <SLOT NAME=\"dmg_01\" />     <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE = \"260\" VELOCITY = \"300\" IS_OVERLAP=\"TRUE\" PUSH_TYPE=\"1\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSHBACK.XML", "<ACTION ID=\"mon_push_back\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">  <SLOT NAME=\"BlowUp_Down\" />    <SLOT NAME=\"BlowUp_Stand\"/>  <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE=\"180\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSHBACK_LONG.XML", "<ACTION ID=\"mon_push_back_long\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">   <SLOT NAME=\"BlowUp_Down\" />    <SLOT NAME=\"BlowUp_Stand\"/>  <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE = \"260\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSH_BACK_LONG_2.XML", "<ACTION ID=\"mon_push_back_long_2\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\">   <SLOT NAME=\"BlowUp_Down\" />    <SLOT NAME=\"BlowUp_Stand\"/>  <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE = \"500\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("ACTION/MON_PUSHBACK_SHORT.XML", "<ACTION ID=\"mon_push_back_short\" TYPE=\"EFFECT\" NEXT=\"a_battle_idle\" CAN_CHANGE_ACTOR_POS=\"TRUE\" BREAK_FALL=\"TRUE\" CHECK_CAN_ENTER=\"TRUE\" >  <SLOT NAME=\"BlowUp_Down\" />    <SLOT NAME=\"BlowUp_Stand\"/>  <FSM SCRIPT=\"Act_PushBack_Fast\" DISTANCE=\"100\" IS_OVERLAP=\"TRUE\"/></ACTION>") );
	m_kContXmlData.insert( std::make_pair("MON/CHAOSBOOM.XML", "<?xml version=\"1.0\" encoding=\"euc-kr\"?><ACTOR NAME=\"m_Chaosboom\"><TEXTURE SRC=\"N_BombMentha.dds\">../Data/2_Mon/N_Mentha_Longifolia_Mission04/N_BombMentha.dds</TEXTURE><TEXTURE SRC=\"N_BombMentha_Fire.dds\">../Data/2_Mon/N_Mentha_Longifolia_Mission04/N_BombMentha_Fire.dds</TEXTURE>		<WORLDOBJECT>		<KFMPATH SCALE=\"0.5\">../Data/1_Cha/9_SSkill/Chaos_Bomber/Chaos_Bomber.kfm</KFMPATH>		<SCRIPT SRC=\"Actor/mob_base.lua\">			<ITEM NAME=\"Actor_Mob_Base\" TYPE=\"EVENT\"/>		</SCRIPT>		<SLOT>			<!-- Basic Movement -->			<ITEM NAME=\"btlidle_01\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"attk_02_01\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"attk_02_02\" ANIMATION=\"1000201\"/>			<!-- Basic Movement -->			<ITEM NAME=\"dmg_01\" ANIMATION=\"1000000\" RANDOM=\"100\"/>			<ITEM NAME=\"dmg_02\" ANIMATION=\"1000000\" RANDOM=\"100\"/>			<ITEM NAME=\"idle_01\" ANIMATION=\"1000000\"/>			<!--<ITEM NAME=\"idle_01\" ANIMATION=\"1000001\" RANDOM=\"100\"/>-->			<ITEM NAME=\"walk\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"die_01\" ANIMATION=\"1000021\"/>			<ITEM NAME=\"StandUp\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"Stun\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"BlowUp_Down\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"BlowUp_Loop\" ANIMATION=\"1000000\" VELOCITY=\"10\" VELOCITY_INIT=\"10\"/>			<ITEM NAME=\"Opening\" ANIMATION=\"1000000\"/>			<ITEM NAME=\"run\" ANIMATION=\"1000055\"/>			<ITEM NAME=\"walk\" ANIMATION=\"1000055\"/>		</SLOT>	</WORLDOBJECT></ACTOR>") );

	m_kContLuaText.push_back(std::string("--[[\n\
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\
Script   action Param     .\n\
    \n\
Param      .\n\
\n\
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////\n\
]]\n\
--[[\n\
///////////////\n\
@ ActionParam @\n\
///////////////\n\
	action:SetParam(0, \"GoNext\") 		--     , \n\
	                                       OnLeave      , ( \"GoNext\" )\n\
										        Update 	\n\
	action:SetParam(1, \"end\")			-- \"end\"  OnLeave  \n\
	action:SetParamInt(2,0) 			--    Hit \n\
	action:SetParam(3,\"1\") 				--  \"0\":  , \"1\":   (int        )\n\
	\n\
	action:GetParamInt(15)  			--  1   iTotalHit     	\n\
	\n\
	action:SetParamInt(30,iTotalHit)	--      (DB      )\n\
	\n\
	10000 ~	50000 -  \n\
	20000 -   Fire  \n\
	20001 -   Fire  \n\
	60000 -  \n\
	100000,  \n\
///////////////					\n\
@  Slot @\n\
///////////////\n\
		7211 - HIT_TARGET_EFFECT_ID		:    \n\
		7212 - FIRE_CASTER_EFFECT_ID	:     1\n\
	    7213 - FIRE_CASTER_EFFECT_ID2	:     2\n\
		7214 - HIT_CASTER_EFFECT_ID 	: HIT     \n\
		7215 - CASTING_EFFECT_EFFECT_ID :   \n\
	    7216 - CLEANUP_CASTER_EFFECT_ID :   \n\
]]\n\
--   ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\
\n\
function SkillHelpFunc_InitMaxFireCnt(action)\n\
--   Fire  \n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	local iMaxFireCnt = action:GetAbil(AT_COUNT)\n\
	if(0 == iMaxFireCnt) then iMaxFireCnt = 1 end	\n\
	action:SetParamInt(20000, iMaxFireCnt)\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_GetMaxFireCnt(action)\n\
--   Fire  \n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return 0 end\n\
	local iMaxFireCnt = action:GetParamInt(20000)\n\
	if(0 == iMaxFireCnt) then iMaxFireCnt = 1 end	\n\
	return iMaxFireCnt\n\
end\n\
\n\
function SkillHelpFunc_GetCurFireCnt(action)\n\
--   Fire \n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return 0 end\n\
	local iFireCnt = action:GetParamInt(20001)	\n\
	return iFireCnt\n\
end\n\
\n\
function SkillHelpFunc_IncCurFireCnt(action, iInc)\n\
if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	local iFireCnt = action:GetParamInt(20001)+iInc	\n\
	local iMaxCnt = SkillHelpFunc_GetMaxFireCnt(action)\n\
	action:SetParamInt(20001, iFireCnt)	\n\
	if(iFireCnt > iMaxCnt) then \n\
		return false\n\
	end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)\n\
--       . \"_CleanUp\"  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	local   action = actor:GetAction()\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	\n\
	if true == SkillHelpFunc_IsCastingState(action) then\n\
		--   \n\
		--    \n\
		SkillHelpFunc_DetachCastingEffect(actor, action)\n\
		if( false == actor:PlayNext()) then \n\
		--   \n\
			action:SetNextActionName(\"a_battle_idle\")			\n\
		end\n\
		-- update  \n\
		action:ChangeToNextActionOnNextUpdate(true,true)\n\
		return true\n\
	end	\n\
	return false\n\
end\n\
	\n\
function SkillHelpFunc_DoDividedDamage(actor, action, iHitCount)\n\
--  1 ,     \n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local kTargetList = action:GetTargetList()\n\
	local iTargetCount = kTargetList:size()\n\
	local iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
	\n\
	if 0 < iTargetCount then\n\
	\n\
		local bWeaponSoundPlayed = false\n\
		local i =0\n\
		while i<iTargetCount do\n\
			local actionResult = action:GetTargetActionResult(i)\n\
			if actionResult:IsNil() == false then\n\
			\n\
				if iHitCount == iTotalHit-1 then\n\
					local iOneDmg = actionResult:GetValue()/(iTotalHit)					\n\
					SkillHelpFunc_SetDividedDamage(action, iOneDmg)	--    ?     \n\
					actionResult:SetValue( actionResult:GetValue() - iOneDmg*(iTotalHit-1))\n\
				end\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i)\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
			\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					local actorTarget = kTargetPilot:GetActor()\n\
					\n\
					if bWeaponSoundPlayed == false then\n\
						bWeaponSoundPlayed = true\n\
						--   \n\
						SkillHelpFunc_PlayWeaponSound(actor, action, actionResult:GetCritical(), actorTarget, action:GetTargetInfo(i))\n\
					end\n\
					SkillHelpFunc_DefaultDoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i))\n\
				end\n\
			end\n\
			i=i+1\n\
		end\n\
		\n\
		if iHitCount == iTotalHit-1 then\n\
			--ODS(\"   \\n\", false, 912)	\n\
			action:GetTargetList():ApplyActionEffects()\n\
		else\n\
			--ODS(\"  \\n\", false, 912)\n\
			action:GetTargetList():ApplyOnlyDamage(iTotalHit)\n\
		end\n\
	end\n\
end\n\
\n\
function SkillHelpFunc_IsReservedNextAction(kCurAction, kNetxtAction)\n\
	if( false == SkillHelpFunc_NilCheck_Action(kCurAction)) then return false end\n\
	if( false == SkillHelpFunc_NilCheck_Action(kNetxtAction)) then return false end	\n\
	if kCurAction:GetNextActionName() ~= kNetxtAction:GetID() then\n\
		--ODS(\" :\"..kCurAction:GetNextActionName()..\" \"..kNetxtAction:GetID()..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
	return true\n\
end\n\
\n\
--     ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\
\n\
--///////////////////////////////////////////////////--\n\
--  (HitCount)\n\
function SkillHelpFunc_InitHitCount(action)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	action:SetParamInt(2,0)\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_SetHitCount(action, iHitCount)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	action:SetParamInt(2,iHitCount)\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_GetHitCount(action)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return -1 end\n\
	return action:GetParamInt(2)\n\
end\n\
\n\
function SkillHelpFunc_IncHitCount(action, iVal)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return -1 end\n\
	local iNewHitCnt = SkillHelpFunc_GetHitCount(action)+iVal		--        ?\n\
	if(true == SkillHelpFunc_SetHitCount(action, iNewHitCnt)) then\n\
		return iNewHitCnt\n\
	end\n\
	return -1\n\
end\n\
\n\
--///////////////////////////////////////////////////--\n\
--   (TotalHit)\n\
function SkillHelpFunc_GetTotalHitCount(action)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return 0 end\n\
	local kSkillDef = GetSkillDef(action:GetActionNo())	\n\
	if kSkillDef:IsNil() == false then\n\
		return kSkillDef:GetAbil(AT_COUNT)\n\
	end	\n\
	return 0\n\
end\n\
\n\
--///////////////////////////////////////////////////--\n\
--        \n\
function SkillHelpFunc_SetDividedDamage(action, iOneDmg)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	action:SetParamInt(15,iOneDmg)\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_GetDividedDamage(action)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return 0 end\n\
	return action:GetParamInt(15)\n\
end\n\
\n\
--///////////////////////////////////////////////////--\n\
--  \n\
function SkillHelpFunc_SetCastingState(action)\n\
--     \n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	action:SetParam(3,\"1\")\n\
	return true\n\
end	\n\
\n\
function SkillHelpFunc_SetNoneCastingState(action)\n\
--     \n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	action:SetParam(3,\"0\")\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_IsCastingState(action)\n\
-- (   )?\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	if(\"1\" == action:GetParam(3)) then\n\
		return true\n\
	end\n\
	return false\n\
end	\n\
\n\
--///////////////////////////////////////////////////--\n\
-- 4         ?\n\
function SkillHelpFunc_GetTranslateCmdCnt(action)\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return 0 end\n\
	local iCmdCnt_InputedByDeveloper = action:GetAbil(AT_TRANSLATE_SKILL_CMD_CNT) --    \n\
	----ODS(\"iCmdCnt_InputedByDeveloper:\"..iCmdCnt_InputedByDeveloper..\"\\n\", 0, 912)\n\
	local iTranslateSkillCnt = action:GetTranslateSkillCnt()					  --    	\n\
	----ODS(\"iCmdCnt_InputedByDeveloper:\"..iCmdCnt_InputedByDeveloper..\" iTranslateSkillCnt:\"..iTranslateSkillCnt..\"\\n\", 0, 912)\n\
	\n\
	if(iTranslateSkillCnt >= iCmdCnt_InputedByDeveloper) then\n\
		return iTranslateSkillCnt												  --       \n\
	end\n\
	\n\
	return iCmdCnt_InputedByDeveloper\n\
end\n\
\n\
--     ,    \n\
function SkillHelpFunc_GetNextTranslateActionName(action, iCorrectCmdCnt)	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return \"\" end\n\
	----ODS(\"SkillHelpFunc_GetNextTranslateActionName\\n\", 0, 912)\n\
	local iTotalCmdCnt = SkillHelpFunc_GetTranslateCmdCnt(action)	--  \n\
	----ODS(\"iTotalCmdCnt:\"..iTotalCmdCnt..\"\\n\", 0, 912)\n\
	\n\
	if(0 < iTotalCmdCnt) then\n\
		----ODS(\"if \\n\", 0, 912)\n\
		local iTotalTranslatSkillCnt = action:GetTranslateSkillCnt() 	--     		\n\
		if(iTotalTranslatSkillCnt == 0) then iTotalTranslatSkillCnt = 1 end\n\
		local fUnitSkillRate = 1/iTotalTranslatSkillCnt	 				--     (/ \n\
		\n\
		local fCmdCorrectRate = iCorrectCmdCnt/iTotalCmdCnt			 	--  %  \n\
		local i =0\n\
		while(i < iTotalTranslatSkillCnt) do\n\
			local fSkillRate = (i+1)*fUnitSkillRate\n\
			if(fSkillRate > fCmdCorrectRate) then\n\
				local iTranslateActionNo = action:GetAbil(AT_TRANSLATE_SKILL01+i)\n\
				if(0 < iTranslateActionNo) then\n\
					local kSkillDef = GetSkillDef(iTranslateActionNo);\n\
					if kSkillDef:IsNil() == false then\n\
						----ODS(\" \\n\", 0, 912)\n\
						local kActionName = kSkillDef:GetActionName()						\n\
						return 	kActionName:GetStr()--    \n\
					end\n\
					break\n\
				end\n\
			end\n\
			i = i+1\n\
		end		\n\
	end\n\
	return \"\"\n\
end\n\
\n\
--   ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\
\n\
--/////////////////////////////////////////////////////////////////////////////////////////////////////////--\n\
-- Particle  \n\
function SkillHelpFunc_AttachParticleToNode(iSlot, ParticleScriptParam, TargetNodeScriptParam, iScale, actor, action)\n\
--    \n\
	if(false == SkillHelpFunc_CheckParam(iSlot, ParticleScriptParam, TargetNodeScriptParam, iScale, actor, action))  then\n\
		return false\n\
	end\n\
	\n\
	local   kEffectID = action:GetScriptParam(ParticleScriptParam)\n\
    local   kEffectTargetNodeID = action:GetScriptParam(TargetNodeScriptParam)\n\
    \n\
    if kEffectID ~= \"\" and kEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPointS(iSlot,kDir,kEffectID, iScale)\n\
            \n\
        else\n\
            actor:AttachParticleS(iSlot,kEffectTargetNodeID,kEffectID, iScale)\n\
        end    \n\
    end	\n\
	return true\n\
end\n\
\n\
\n\
function SkillHelpFunc_AttachParticleToNodePos(iSlot, ParticleScriptParam, TargetNodeScriptParam, iScale, actor, action)\n\
--     \n\
	if(false == SkillHelpFunc_CheckParam(iSlot, ParticleScriptParam, TargetNodeScriptParam, iScale, actor, action))  then\n\
		return false\n\
	end\n\
	\n\
	local   kEffectID = action:GetScriptParam(ParticleScriptParam)\n\
    local   kEffectTargetNodeID = action:GetScriptParam(TargetNodeScriptParam)\n\
	--ODS(\"SkillHelpFunc_AttachParticleToNodePos-ffectID:\"..kEffectID..\"\\n\", false, 912)\n\
    --ODS(\"SkillHelpFunc_AttachParticleToNodePos-TargetNode:\"..kEffectTargetNodeID..\"\\n\", false, 912)\n\
	\n\
    if kEffectID ~= \"\" and kEffectTargetNodeID ~= \"\" then\n\
    --[[[\n\
        if kEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPointS(iSlot,kDir,kEffectID, iScale)\n\
        ]]    \n\
        --else	\n\
			actor:AttachParticleToPointS(iSlot, actor:GetNodeWorldPos(kEffectTargetNodeID),kEffectID, iScale)\n\
        --end   \n\
    end	\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_ExpressCastingEffect(actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	SkillHelpFunc_SetNoneCastingState(action)\n\
	\n\
	local   kCastingEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\")\n\
    local   kCastingEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\")\n\
	local   kCastingEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
    \n\
    if kCastingEffectID ~= \"\" and kCastingEffectTargetNodeID ~= \"\" or kCastingEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then		\n\
			local iFactor = 100\n\
			local kFactor = action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR\")\n\
			if(\"\" ~= kFactor) then\n\
				iFactor = tonumber(kFactor)				\n\
			end	\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / iFactor)\n\
		end\n\
		\n\
        if kCastingEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kCastingEffectID, iSize)\n\
            \n\
        elseif kCastingEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kCastingEffectTargetNodeID,kCastingEffectID,iSize)\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kCastingEffectTargetNodeIDToPos),kCastingEffectID,iSize)\n\
") + std::string("        end	\n\
		SkillHelpFunc_SetCastingState(action)\n\
    end\n\
	\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_ExpressFireEffect(actor, action)\n\
--    \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID)            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID)\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID)\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\")\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\")\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID)\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID)\n\
        end    \n\
    end\n\
	\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, action)\n\
--      \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	if action:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then	\n\
		return SkillHelpFunc_DetachFireEffect(actor, action)\n\
	end\n\
	\n\
	return false\n\
end\n\
function SkillHelpFunc_DetachFireEffect(actor, action)\n\
--    \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	local DefaultDetaChID = false\n\
	local DefaultDetaChID2 = false\n\
	\n\
	if action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
		DefaultDetaChID = true\n\
	end\n\
	if action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
		DefaultDetaChID2 = true\n\
	end\n\
    actor:DetachFrom(7212,DefaultDetaChID)\n\
    actor:DetachFrom(7213,DefaultDetaChID2)\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, action)\n\
--     \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	-- [DETACH_CASTING_EFFECT_AT_FINISH] :   CASTING_EFFECT_EFFECT_ID   \n\
	if action:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		return SkillHelpFunc_DetachCastingEffect(actor, action)		\n\
	end\n\
	return false\n\
end\n\
\n\
function SkillHelpFunc_DetachCastingEffect(actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	local DefaultDetaChID = false\n\
	-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
	if action:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
		DefaultDetaChID = true\n\
	end\n\
	actor:DetachFrom(7215,DefaultDetaChID)\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_ExpressCleanUpEffect(actor, action)\n\
-- CleanUp( )  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	\n\
	local   kCleanUpEffectID = action:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\")\n\
    local   kCleanUpEffectTargetNodeID = action:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\")\n\
	local	fCleanUpScale = tonumber(action:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"))\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale)\n\
		 return true\n\
	end\n\
	\n\
	return false\n\
end\n\
\n\
function SkillHelpFunc_ExpressHitTargetEffect(actor, action, actorTarget, bCri)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(actorTarget)) then return false end\n\
	\n\
	local   kHitTargetEffectTargetNodeID = action:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
	local DamageEff = \"\"\n\
	if false == bCri then	-- \n\
		local   kHitTargetEffectID = action:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
		if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
			DamageEff = kHitTargetEffectID\n\
		end\n\
	else--\n\
		local   kCriticlaHitTargetEffectID = action:GetScriptParam(\"CRITICAL_HIT_TARGET_EFFECT_ID\");\n\
		if kCriticlaHitTargetEffectID ~= \"\" then\n\
			DamageEff = kCriticlaHitTargetEffectID\n\
		end\n\
	end\n\
    if DamageEff ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,DamageEff)\n\
		return true\n\
    end\n\
	return false\n\
end\n\
\n\
\n\
function SkillHelpFunc_ExpressHitCasterEffect(actor, action)\n\
--     \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
		\n\
    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\")\n\
    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
		if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
			actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID)\n\
		elseif kHitEffectTargetNodeID ~= \"\" then\n\
	           actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID)\n\
		elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID)			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
	    end\n\
		return true\n\
	end\n\
	\n\
	return false\n\
end\n\
\n\
function SkillHelpFunc_DetachHitCasterEffect(actor)\n\
--     \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	actor:DetachFrom(7214)\n\
	return true \n\
end\n\
function SkillHelpFunc_ChangeWeapon(actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"))\n\
		--ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\")\n\
	end		\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_RestoreWeapon(actor, action)\n\
--    \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON)\n\
	end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_HideWeapon(actor, action)\n\
--  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	--ODS(\"SkillHelpFunc_HideWeapon\\n\", false, 912)\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true)\n\
		--ODS(\" \\n\", false, 912)\n\
	end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_ShowWeapon(actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false)\n\
	end\n\
end\n\
\n\
function SkillHelpFunc_AttachWeaponTrail(actor, action)\n\
--    \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail()\n\
	end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_DetachWeaponTrail(actor, action)\n\
--    \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail()\n\
	end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_TransformShape(actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID == \"\" then\n\
		return false\n\
	end\n\
    \n\
    local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"))\n\
     if nil == iTransformEffectID then\n\
		return false\n\
	 end\n\
	\n\
    local kMan = GetStatusEffectMan()\n\
    kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0)\n\
    \n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_RestoreShape(actor, action)\n\
--   \n\
   if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID == \"\" then\n\
		return false\n\
	end\n\
    \n\
       \n\
    local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"))\n\
     if nil == iTransformEffectID then\n\
		return false\n\
	 end\n\
	--    (  curAction    !!!)\n\
    local kMan = GetStatusEffectMan()\n\
    kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID)\n\
	\n\
	return true\n\
end\n\
--/////////////////////////////////////////////////////////////////////////////////////////////////////////--\n\
-- SOUND\n\
\n\
function SkillHelpFunc_PlayCastingSound(actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	-- \n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID)\n\
	end\n\
	\n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
	-- \n\
		kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID_MALE\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2786,kSoundID)\n\
			--ODS(\"\\n\", false, 912)\n\
		end	\n\
	\n\
	else\n\
	-- \n\
		kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID_FEMALE\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2786,kSoundID)\n\
			--ODS(\"\\n\", false, 912)\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_PlayFireSound(actor, action)\n\
--  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID)\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"FIRE_SOUND_ID_MALE\")\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2)\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"FIRE_SOUND_ID_FEMALE\")\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2)\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end \n\
	\n\
function SkillHelpFunc_AttachSoundToActorPos(SoundIDScriptParam, actor, action)\n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	if( false == SkillHelpFunc_NilCheck_World()) then return false end\n\
	if(nil == SoundIDScriptParam) then return false end\n\
	--ODS(\"SkillHelpFunc_AttachSoundToActorPos-SoundIDScriptParam:\"..SoundIDScriptParam..\"\\n\", false, 912)\n\
	local	kSoundID = action:GetScriptParam(SoundIDScriptParam)\n\
	if kSoundID ~= \"\" then	\n\
		--ODS(\"SkillHelpFunc_AttachSoundToActorPos-kSoundID:\"..kSoundID..\"\\n\", false, 912)\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AttachSound(kSoundID, actor:GetPos())\n\
		--ODS(\"SkillHelpFunc_AttachSoundToActorPos \\n\", false, 912)\n\
		return true\n\
	end\n\
	return false\n\
end\n\
\n\
function SkillHelpFunc_PlayHitSound(actor, action)\n\
--  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID)\n\
	end\n\
\n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
	-- \n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\")\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2)\n\
		end		\n\
	else\n\
	-- \n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\")\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2)\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_PlayWeaponSound(actor, action, bCritical, TargetActor, actionTargetInfo)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	local actionName = action:GetID()\n\
	if bCritical then\n\
		actionName = \"Critical_dmg\"\n\
	end\n\
    TargetActor:PlayWeaponSound(WST_HIT, actor, actionName, 0, actionTargetInfo)\n\
	return true\n\
end\n\
\n\
\n\
function SkillHelpFunc_PlaySound(actor, action, SoundScriptParam)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	if(nil == SoundScriptParam) then return false end\n\
	\n\
	-- \n\
	local	kSoundID = action:GetScriptParam(SoundScriptParam)\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID)\n\
	end\n\
	\n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
	-- \n\
	\n\
		kSoundID = action:GetScriptParam(SoundScriptParam..\"_MALE\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2786,kSoundID)\n\
			--ODS(\"\\n\", false, 912)\n\
") + std::string("		end	\n\
	\n\
	else\n\
	-- \n\
		kSoundID = action:GetScriptParam(SoundScriptParam..\"_FEMALE\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2786,kSoundID)\n\
			--ODS(\"\\n\", false, 912)\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end	\n\
\n\
function SkillHelpFunc_StopSound(actor, action, SoundScriptParam)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end	\n\
	if(nil == SoundScriptParam) then return false end\n\
	\n\
	-- \n\
	local	kSoundID = action:GetScriptParam(SoundScriptParam)\n\
	if kSoundID~=\"\" then\n\
		StopSoundByID(kSoundID)\n\
	end\n\
	\n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
	-- \n\
	\n\
		kSoundID = action:GetScriptParam(SoundScriptParam..\"_MALE\")\n\
		if kSoundID~=\"\" then\n\
			StopSoundByID(kSoundID)\n\
			--ODS(\" \\n\", false, 912)\n\
		end	\n\
	\n\
	else\n\
	-- \n\
		kSoundID = action:GetScriptParam(SoundScriptParam..\"_FEMALE\")\n\
		if kSoundID~=\"\" then\n\
			StopSoundByID(kSoundID)\n\
			--ODS(\" \\n\", false, 912)\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end	\n\
--/////////////////////////////////////////////////////////////////////////////////////////////////////////--\n\
-- \n\
function SkillHelpFunc_MakeDarkBG(actor)\n\
--  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_NilCheck_World()) then return false end\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true)\n\
	end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_RemoveDarkBG(actor)\n\
--  (,)  \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_NilCheck_World()) then return false end\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false)\n\
	end\n\
	return true\n\
end\n\
\n\
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n\
-- -- --  SkillHelpFunc       -- -- -- -- \n\
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- \n\
\n\
\n\
function SkillHelpFunc_CheckParam(iSlot, ParticleScriptParam, TargetNodeScriptParam, iScale, actor, action)\n\
--   \n\
	if( false == SkillHelpFunc_IsNotNil(actor)) then return false end	\n\
	if( false == SkillHelpFunc_IsNotNil(action)) then return false end\n\
	\n\
	if(nil == ParticleScriptParam) then return false end\n\
	if(nil == TargetNodeScriptParam) then return false end	\n\
	--ODS(\"SkillHelpFunc_CheckParam-ParticleScriptParam:\"..ParticleScriptParam..\"\\n\", false, 912)\n\
    --ODS(\"SkillHelpFunc_CheckParam-TargetNodeScriptParam:\"..TargetNodeScriptParam..\"\\n\", false, 912)\n\
	\n\
	if(0 > iSlot) then return false end\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_IsNotNil(kObj)\n\
	if(nil == kObj) then \n\
		--ODS(\"nil\\n\", false, 912)\n\
		SetBreak()\n\
		return false \n\
	end\n\
	\n\
	if(true == kObj:IsNil()) then \n\
		--ODS(\"NULL\\n\", false, 912)\n\
		SetBreak()\n\
		return false \n\
	end\n\
		\n\
	return true\n\
end\n\
\n\
function SkillHelpFunc_NilCheck_World()\n\
	if(nil == g_world) then return false end\n\
	return true\n\
end") );
	m_kContLuaText.push_back(std::string("-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Act_Melee_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_Melee_OnCheckCanEnter(actor,action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	--     \n\
	if actor:IsRidingPet() == true then\n\
		local kPetActor = actor:GetMountTargetPet()\n\
		if kPetActor:IsNil() == true then\n\
			return false\n\
		end\n\
		if kPetActor:CheckCanRidingAttack() == true then\n\
			kPetActor:ReserveTransitAction(\"a_pet_melee_01\")\n\
		else\n\
			kPetActor:ReserveTransitAction(\"a_pet_melee_02\")\n\
		end\n\
		return false\n\
	end\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
	if(iBaseActorType == CT_DOUBLE_FIGHTER) then\n\
		local kSubActor = actor:GetSubPlayer()\n\
		if( false == kSubActor:IsNil() ) then\n\
			local kSubActorAction = kSubActor:GetAction()\n\
			if( kSubActorAction:IsNil() ) then return false end\n\
			--local	iComboCount = actor:GetComboCount()\n\
			if (\"a_twin_melee_03_s\" == kSubActorAction:GetID()) then			\n\
				kSubActorAction:SetNextActionName(\"a_twin_melee_05_s\")\n\
			end	\n\
		end\n\
	end\n\
		\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMeetFloor() == false then\n\
		if actor:GetFloatHeight(70)<70 then\n\
			return	false;	\n\
		end\n\
	end\n\
	\n\
	if actor:IsMeetFloor() == false then	\n\
		if Act_Melee_ToFloatAttackCheck(actor,action) == false then\n\
			return	false;\n\
		end\n\
	end	\n\
	\n\
	--  \n\
	if g_pilotMan:IsLockMyInput() == true then\n\
		return false;\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
\n\
function Act_Melee_ToFloatAttackCheck(actor,action)\n\
	ODS(\"Act_Melee_ToFloatAttackCheck actor:IsMeetFloor() == false\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
    \n\
    local	kNextActionName =\"\";\n\
\n\
	if (actor:GetJumpTime()>0.5 and actor:GetComboCount() == 0) or Act_Melee_IsToDownAttack(actor,action) then\n\
		\n\
		if actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			kNextActionName = \"a_dc_melee_drop_01\";\n\
		elseif iBaseActorType == CT_MAGICIAN then\n\
			kNextActionName = \"a_magician_down_shot\";\n\
		elseif iBaseActorType == CT_THIEF then\n\
			kNextActionName = \"a_thi_melee_drop\";\n\
		elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
			kNextActionName = \"a_twin_bunker_buster\";\n\
		else\n\
			kNextActionName = \"a_melee_drop\";\n\
		end\n\
	end\n\
	\n\
	if kNextActionName~=\"\" and action:CheckCanEnter(actor,kNextActionName) then\n\
		return	true;\n\
	end\n\
	\n\
	kNextActionName =\"\";\n\
	\n\
	if actor:GetParam(\"FLOAT_ATTACK_ENABLE\")~=\"FALSE\" then\n\
	\n\
	    local iComboCount = actor:GetComboCount();\n\
	    \n\
		if(2 < iComboCount) then \n\
			iComboCount = 1  \n\
			--ODS(\"  1\\n\", false, 912) \n\
		end\n\
		\n\
	    if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then\n\
			kNextActionName = \"a_nj_float_melee_0\"..(iComboCount+1);\n\
		elseif actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			return false;\n\
	    elseif iBaseActorType == CT_THIEF then\n\
			kNextActionName = \"a_thief_float_melee_01\";\n\
		elseif iBaseActorType == CT_MAGICIAN then\n\
			local MageSkillName = \"a_magefloatshot_0\"..(iComboCount+1);\n\
			if action:CheckCanEnter(actor, MageSkillName) then\n\
				kNextActionName = MageSkillName;\n\
			else\n\
				kNextActionName = \"a_MagicianFloatShot_0\"..(iComboCount+1);\n\
			end\n\
		elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
			kNextActionName = \"a_twin_float_melee_0\"..(iComboCount+1);\n\
		else\n\
			kNextActionName = \"a_float_melee_0\"..(iComboCount+1);\n\
			--ODS(\"a_float_melee_0 + \"..iComboCount..\"\\n\",false, 912)\n\
        end\n\
	end			\n\
	\n\
	if kNextActionName~=\"\" and action:CheckCanEnter(actor,kNextActionName) then\n\
		return	true;\n\
	end\n\
		\n\
	return	false;\n\
end\n\
function Act_Melee_ToFloatAttack(actor,action)\n\
	ODS(\"Act_Melee_ToFloatAttack actor:IsMeetFloor() == false\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
    \n\
    local	kNextActionName =\"\";\n\
\n\
	if (actor:GetJumpTime()>0.5 and actor:GetComboCount() == 0) or Act_Melee_IsToDownAttack(actor,action) then\n\
		\n\
		if actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			kNextActionName = \"a_dc_melee_drop_01\";\n\
		elseif iBaseActorType == CT_MAGICIAN then\n\
			kNextActionName = \"a_magician_down_shot\";\n\
		elseif iBaseActorType == CT_THIEF then\n\
			kNextActionName = \"a_thi_melee_drop\";\n\
		elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
			kNextActionName = \"a_twin_bunker_buster\";\n\
		else\n\
			kNextActionName = \"a_melee_drop\";\n\
		end\n\
	end\n\
	\n\
	ODS(\"Magician Shot kNextActionName : \"..kNextActionName..\"\\n\");\n\
	\n\
	if kNextActionName~=\"\" and action:CheckCanEnter(actor,kNextActionName) then\n\
		actor:SetComboCount(0);	\n\
		action:SetNextActionName(kNextActionName);\n\
		action:ChangeToNextActionOnNextUpdate(true, true)\n\
		return	true;\n\
	end\n\
	\n\
	kNextActionName =\"\";\n\
	\n\
	if actor:GetParam(\"FLOAT_ATTACK_ENABLE\")~=\"FALSE\" then\n\
	\n\
	    local iComboCount = actor:GetComboCount();\n\
	    \n\
		if(2 < iComboCount) then \n\
			iComboCount = 1  \n\
			--ODS(\"  2\\n\", false, 912) \n\
		end\n\
		\n\
	    if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then\n\
			kNextActionName = \"a_nj_float_melee_0\"..(iComboCount+1);\n\
		elseif actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			kNextActionName = \"a_dc_melee_0\"..(iComboCount+1);	    \n\
	    elseif iBaseActorType == CT_THIEF then\n\
			kNextActionName = \"a_thief_float_melee_01\";\n\
		elseif iBaseActorType == CT_MAGICIAN then\n\
			local MageSkillName = \"a_magefloatshot_0\"..(iComboCount+1);\n\
			if action:CheckCanEnter(actor, MageSkillName) then\n\
				kNextActionName = MageSkillName;\n\
			else\n\
				kNextActionName = \"a_MagicianFloatShot_0\"..(iComboCount+1);\n\
			end\n\
		elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
			kNextActionName = \"a_twin_float_melee_0\"..(iComboCount+1);\n\
		else\n\
			kNextActionName = \"a_float_melee_0\"..(iComboCount+1);\n\
        end\n\
	end			\n\
	\n\
	if kNextActionName~=\"\" and action:CheckCanEnter(actor,kNextActionName) then\n\
		action:SetNextActionName(kNextActionName);\n\
		action:ChangeToNextActionOnNextUpdate(true, true)\n\
		return	true;\n\
	end\n\
		\n\
	return	false;\n\
end\n\
\n\
function Act_Melee_ToDownAttack(actor,action,bFlyAttack)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
	local	iComboCount = tonumber(actor:GetParam(\"DOWN_ATTACK_COMBO_COUNT\"));\n\
	if iComboCount == nil then\n\
		iComboCount = 0\n\
	end\n\
	\n\
	\n\
	--local	kCurActionID = actor:GetAction():GetID();\n\
	\n\
	local	fLastDownAttackTime = tonumber(actor:GetParam(\"LAST_DOWN_ATTACK_TIME\"));\n\
	if fLastDownAttackTime == nil then\n\
		fLastDownAttackTime = 0.0\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local	fNowTime = g_world:GetAccumTime();\n\
	\n\
	if fNowTime - fLastDownAttackTime > 0.5 then\n\
		iComboCount = 0;\n\
	end		\n\
	\n\
	if  bFlyAttack then\n\
		if iComboCount < 2 then\n\
			return false\n\
		end\n\
	end\n\
	\n\
	local	iNextComboCount = iComboCount+1;\n\
	local iMaxCount = 3;\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
		iMaxCount = 2;\n\
	end\n\
\n\
	if iNextComboCount >= iMaxCount then\n\
		iNextComboCount = 0\n\
	end\n\
	\n\
	actor:SetParam(\"DOWN_ATTACK_COMBO_COUNT\",\"\"..iNextComboCount);\n\
	\n\
	local	kNextActionName = \"\";\n\
	\n\
	if bFlyAttack then\n\
		if iComboCount < 2 then\n\
			return	false\n\
		end\n\
		if iBaseActorType == CT_MAGICIAN then\n\
			kNextActionName = \"a_mag_down_attack_fly\";\n\
		elseif iBaseActorType == CT_ARCHER then\n\
			kNextActionName = \"a_arc_down_attack_fly\";\n\
		elseif iBaseActorType == CT_THIEF then\n\
			kNextActionName = \"a_thi_down_attack_fly\";\n\
		else\n\
			kNextActionName = \"a_down_attack_fly\";\n\
		end\n\
	else\n\
		if actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			kNextActionName = (\"a_dc_down_0\"..(iComboCount+1));	\n\
		elseif iBaseActorType == CT_MAGICIAN then\n\
			kNextActionName = (\"a_mag_down_attack_0\"..(iComboCount+1));\n\
		elseif iBaseActorType == CT_ARCHER then\n\
			kNextActionName = (\"a_arc_down_attack_0\"..(iComboCount+1));\n\
		elseif iBaseActorType == CT_THIEF then\n\
			kNextActionName = (\"a_thi_down_attack_0\"..(iComboCount+1));\n\
		elseif iBaseActorType == CT_SHAMAN then\n\
			kNextActionName = (\"a_Sum_Down_Attack_0\"..(iComboCount+1));\n\
		elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
			kNextActionName = (\"a_twin_down_attack_0\"..(iComboCount+1));\n\
		else\n\
		    kNextActionName = (\"a_down_attack_0\"..(iComboCount+1));\n\
		end\n\
    end\n\
    \n\
\n\
	if action:CheckTargetExist(actor,kNextActionName) == false or \n\
		action:CheckCanEnter(actor,kNextActionName) == false then\n\
		\n\
		actor:SetParam(\"DOWN_ATTACK_COMBO_COUNT\",\"\"..0);\n\
		return	false\n\
	end\n\
    action:SetNextActionName(kNextActionName);\n\
    action:ChangeToNextActionOnNextUpdate(true,true);\n\
    \n\
    actor:SetComboCount(0);\n\
    return true;		\n\
end\n\
\n\
function Act_Melee_ToBlowUpAttack(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
	local	iComboCount = actor:GetComboCount();\n\
	--if iComboCount<2 or iBaseActorType == CT_MAGICIAN then\n\
	\n\
	--	if Act_Melee_ToDownAttack(actor,action,true) then\n\
	--		return	true\n\
	--	end\n\
	\n\
	--	return	false\n\
	--end\n\
	\n\
	local	kNextActionName = \"\";\n\
	\n\
	if iBaseActorType == CT_THIEF then\n\
		kNextActionName = \"a_thi_melee_blow_up\"\n\
	else\n\
		kNextActionName = \"a_melee_blow_up\"\n\
	end\n\
	\n\
	if kNextActionName ~= \"\" then\n\
		if action:CheckCanEnter(actor,kNextActionName) then\n\
			action:SetNextActionName(kNextActionName);\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return true;	\n\
		end\n\
    end\n\
    \n\
    return	false;\n\
end\n\
\n\
function Act_Melee_ToKnockBackAttack(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
	\n\
	if iBaseActorType == CT_MAGICIAN then\n\
		return	false\n\
	end\n\
\n\
	--local	iComboCount = actor:GetComboCount();\n\
	--if iComboCount<2 then\n\
	--	return	false\n\
	--end\n\
	\n\
	local	kNextActionName = \"\";\n\
	\n\
	if iBaseActorType == CT_THIEF then\n\
		kNextActionName = \"a_thi_melee_knock_back\"\n\
	else\n\
		kNextActionName = \"a_melee_knock_back\"\n\
	end\n\
	\n\
	if kNextActionName ~= \"\" then	\n\
		if action:CheckCanEnter(actor,kNextActionName) then\n\
		   action:SetNextActionName(kNextActionName);\n\
		   action:ChangeToNextActionOnNextUpdate(true,true);\n\
		   return true;\n\
		end\n\
    end\n\
    \n\
    return	false;\n\
end\n\
\n\
function Act_Melee_IsToDownAttack(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	if action == nil then\n\
		return	false\n\
	end\n\
	\n\
	if	KeyIsDown(KEY_DOWN)	then\n\
		return	true\n\
	end\n\
	\n\
	local	kInputSlotInfo = action:GetInputSlotInfo();\n\
	if kInputSlotInfo:IsNil() == false then\n\
	\n\
		if	kInputSlotInfo:GetUKey() == KEY_DOWN_ATTACK then\n\
			return	true\n\
		end\n\
	\n\
	end\n\
	\n\
	return	false;\n\
	\n\
end\n\
\n\
function Act_Melee_GetMaxComboCount(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
	\n\
	if weapontype == WT_BTS	then	--	 4\n\
		return	4\n\
	elseif weapontype == WT_SPR then	--	 3\n\
		return	3\n\
	end\n\
	\n\
	if(iBaseActorType == CT_DOUBLE_FIGHTER) then \n\
		return 3\n\
	end\n\
		\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then\n\
		return	3;\n\
	end\n\
\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
		return 5;\n\
	end	    \n\
\n\
	if actor:CheckStatusEffectExist(\"se_Bloody_Lore\") then\n\
		return	3	\n\
	end\n\
	\n\
	return	5;\n\
\n\
end\n\
\n\
function Act_Melee_IsToUpAttack(actor,action)\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if	KeyIsDown(KEY_UP)	then\n\
		return	true\n\
	end\n\
	\n\
	local	kInputSlotInfo = action:GetInputSlotInfo();\n\
	if kInputSlotInfo:IsNil() == false then\n\
	\n\
		if	kInputSlotInfo:GetUKey() == KEY_UP_ATTACK then\n\
			return	true\n\
		end\n\
	\n\
	end\n\
	\n\
	return	false;\n\
	\n\
end\n\
function Act_Melee_IsToLeftAttack(actor,action)\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if	KeyIsDown(KEY_LEFT)	then\n\
		return	true\n\
	end\n\
	\n\
	local	kInputSlotInfo = action:GetInputSlotInfo();\n\
	if kInputSlotInfo:IsNil() == false then\n\
	\n\
		if	kInputSlotInfo:GetUKey() == KEY_LEFT_ATTACK then\n\
			return	true\n\
		end\n\
	\n\
	end\n\
	\n\
	return	false;\n\
	\n\
end\n\
function Act_Melee_IsToRightAttack(actor,action)\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if	KeyIsDown(KEY_RIGHT)	then\n\
		return	true\n\
	end\n\
	\n\
	local	kInputSlotInfo = action:GetInputSlotInfo();\n\
	if kInputSlotInfo:IsNil() == false then\n\
	\n\
		if	kInputSlotInfo:GetUKey() == KEY_RIGHT_ATTACK then\n\
			return	true\n\
		end\n\
	\n\
	end\n\
	\n\
	return	false;\n\
	\n\
end\n\
function Act_Melee_OnEnter(actor, action)\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	ODS(\"Act_Melee_OnEnter action:\"..action:GetID()..\"\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetParam(1, \"\");\n\
	\n\
	if actor:IsMyActor() == true then		\n\
		local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
		\n\
		action:SetParam(4, \"\");\n\
		\n\
		if actor:IsMeetFloor() == false then	\n\
			if Act_Melee_ToFloatAttack(actor,action) then\n\
				return	true\n\
			end\n\
			return false;\n\
		end\n\
		\n\
		if Act_Melee_IsToDownAttack(actor,action) then\n\
			if	Act_Melee_ToDownAttack(actor,action) then\n\
				return	true\n\
			end\n\
		end\n\
		\n\
		if Act_Melee_IsToUpAttack(actor,action) then\n\
			if Act_Melee_ToBlowUpAttack(actor,action) then\n\
				return	true\n\
			end\n\
		end\n\
		\n\
		action:SetParam(0,\"\");\n\
		\n\
		-- New SkillCombo System -----------------------------------------------------------\n\
		if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
			local iWeaponType = actor:GetEquippedWeaponType();\n\
			local bUseCombo = false\n\
			if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then	\n\
				--action:SetNextActionName(\"a_nj_melee_01\");\n\
			elseif actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
				--action:SetNextActionName(\"a_dc_melee_01\");\n\
			elseif iBaseActorType == CT_FIGHTER then\n\
				if 1 == iWeaponType then\n\
					actor:ReserveTransitAction(\"a_ohs_combo_a\");\n\
					bUseCombo = true\n\
				elseif 2 == iWeaponType then\n\
					actor:ReserveTransitAction(\"a_ths_combo_a\");\n\
					bUseCombo = true\n\
				end\n\
			elseif iBaseActorType == CT_THIEF then\n\
				if 7 == iWeaponType then\n\
					actor:ReserveTransitAction(\"a_cl_combo_a\");\n\
					bUseCombo = true\n\
				elseif 8 == iWeaponType then\n\
					actor:ReserveTransitAction(\"a_cu_combo_a\");\n\
					bUseCombo = true\n\
				end\n\
			elseif iBaseActorType == CT_DOUBLE_FIGHTER then				\n\
					actor:ReserveTransitAction(\"a_pg_combo_a\");\n\
					bUseCombo = true\n\
			end\n\
			if true == bUseCombo then\n\
				actor:ResetAnimation();\n\
				return false;\n\
			end\n\
		end\n\
		-- End : New SkillCombo System --------------------------------------------------------\n\
		\n\
		local	iComboCount = actor:GetComboCount();	\n\
") + std::string("		local	iNextComboCount = iComboCount+1;\n\
		\n\
		if iComboCount == 0 and \n\
			action:GetID() ~= \"a_melee_01\" and \n\
			action:GetID() ~= \"a_Bloody_melee_01\" and \n\
			action:GetID() ~= \"a_nj_melee_01\" and \n\
		    action:GetID() ~= \"a_dc_melee_01\" and \n\
			action:GetID() ~= \"a_thi_melee_01\" 	and\n\
			action:GetID() ~= \"a_mag_melee_01\" 	and\n\
			action:GetID() ~= \"a_twin_melee_01_m\"\n\
			then				   \n\
			actor:SetComboCount(0);	\n\
		\n\
			if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then	\n\
				action:SetNextActionName(\"a_nj_melee_01\");\n\
			elseif actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
				action:SetNextActionName(\"a_dc_melee_01\");\n\
			elseif actor:CheckStatusEffectExist(\"se_Bloody_Lore\") then\n\
				action:SetNextActionName(\"a_Bloody_melee_01\");\n\
			elseif iBaseActorType == CT_FIGHTER then\n\
				action:SetNextActionName(\"a_melee_01\");\n\
			elseif iBaseActorType == CT_THIEF then\n\
				action:SetNextActionName(\"a_thi_melee_01\");\n\
			elseif iBaseActorType == CT_MAGICIAN then\n\
				action:SetNextActionName(\"a_mag_melee_01\");\n\
			elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
				action:SetNextActionName(\"a_twin_melee_01_m\");\n\
			end\n\
		\n\
			action:ChangeToNextActionOnNextUpdate(true,true);					\n\
			\n\
			return true;\n\
		end\n\
		\n\
		if iComboCount > 0 then\n\
		\n\
			if actor:CanNowConnectToNextComboAttack(0.4) == false 	 then\n\
				actor:SetComboCount(0);	\n\
				\n\
				if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then	\n\
					action:SetNextActionName(\"a_nj_melee_01\");\n\
				elseif actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
					action:SetNextActionName(\"a_dc_melee_01\");\n\
				elseif actor:CheckStatusEffectExist(\"se_Bloody_Lore\") then\n\
					action:SetNextActionName(\"a_Bloody_melee_01\");\n\
				elseif iBaseActorType == CT_FIGHTER then\n\
					action:SetNextActionName(\"a_melee_01\");\n\
				elseif iBaseActorType == CT_THIEF then\n\
					action:SetNextActionName(\"a_thi_melee_01\");\n\
				elseif iBaseActorType == CT_DOUBLE_FIGHTER then				\n\
					action:SetNextActionName(\"a_twin_melee_01_m\");\n\
				end\n\
				\n\
				action:ChangeToNextActionOnNextUpdate(true,true);					\n\
				return true;\n\
			end	\n\
			\n\
			if iNextComboCount >= Act_Melee_GetMaxComboCount(actor,action) then\n\
				iNextComboCount = 0;\n\
			end\n\
		\n\
		end\n\
				\n\
		local	kMeleeActions = {\"a_melee_01\",\"a_melee_02\",\"a_melee_03\",\"a_melee_04\",\"a_melee_05\"};\n\
		\n\
		if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then\n\
			kMeleeActions = {\"a_nj_melee_01\",\"a_nj_melee_02\",\"a_nj_melee_03\"};\n\
		elseif actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			kMeleeActions = {\"a_dc_melee_01\",\"a_dc_melee_02\",\"a_dc_melee_03\",\"a_dc_melee_04\",\"a_dc_melee_05\"};\n\
		elseif actor:CheckStatusEffectExist(\"se_Bloody_Lore\") then\n\
			kMeleeActions = {\"a_Bloody_melee_01\",\"a_Bloody_melee_02\",\"a_Bloody_melee_03\"};\n\
		elseif iBaseActorType == CT_THIEF then\n\
			kMeleeActions = {\"a_thi_melee_01\",\"a_thi_melee_02\",\"a_thi_melee_03\",\"a_thi_melee_04\",\"a_thi_melee_05\"};\n\
		elseif iBaseActorType == CT_MAGICIAN then\n\
			kMeleeActions = {\"a_mag_melee_01\",\"a_mag_melee_02\",\"a_mag_melee_03\"};\n\
		elseif iBaseActorType == CT_DOUBLE_FIGHTER then\n\
			kMeleeActions = {\"a_twin_melee_01_m\", \"a_twin_melee_02_m\", \"a_twin_melee_04_m\"};\n\
		end\n\
		\n\
		local iNextActionIndex = iComboCount+1;\n\
		if iNextActionIndex == 0 \n\
			or	iNextActionIndex > table.maxn(kMeleeActions)\n\
		then\n\
		    iNextActionIndex = 1;\n\
		end\n\
		\n\
		local kPrevAction = actor:GetAction()\n\
		if(false == kPrevAction:IsNil() and iBaseActorType == CT_DOUBLE_FIGHTER) then\n\
			local kSubActor = actor:GetSubPlayer()\n\
			if( false == kSubActor:IsNil() ) then\n\
				local kSubActorAction = kSubActor:GetAction()\n\
				if( false == kSubActorAction:IsNil() ) then 						\n\
					if (1 == iNextActionIndex) then	\n\
						if (\"a_twin_melee_03_s\" == kSubActorAction:GetID()) then						\n\
							kSubActorAction:SetNextActionName(\"a_twin_melee_05_s\")\n\
						elseif( IsAbleSubPlayerMeleeAttack( kSubActorAction:GetID() ) ) then\n\
							TryMustChangeSubPlayerAction(actor, \"a_twin_sub_repos\", action:GetDirection())\n\
						end\n\
					elseif(3 == iNextActionIndex) then\n\
						if( IsAbleSubPlayerMeleeAttack( kSubActorAction:GetID() ) ) then\n\
							TryMustChangeSubPlayerAction(actor, \"a_twin_melee_03_s\", kPrevAction:GetDirection())\n\
						end\n\
					end	\n\
				end\n\
			end\n\
		end\n\
		\n\
		if kMeleeActions[iNextActionIndex] ~= action:GetID() then\n\
		\n\
			action:SetNextActionName(kMeleeActions[iNextActionIndex]);\n\
			action:ChangeToNextActionOnNextUpdate(true,true);					\n\
			return true;		    \n\
		    \n\
		end		\n\
		actor:SetComboCount(iNextComboCount);		\n\
		\n\
		local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
		\n\
		if bUseTLM == false then\n\
			action:CreateActionTargetList(actor);\n\
		end\n\
		\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	\n\
	if actor:IsMyActor() then     \n\
	\n\
	     \n\
	    ODS(\"GetComboAdvisor():OnNewActionEnter : \"..action:GetID()..\"\\n\");\n\
	    \n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	    \n\
	    if actor:GetComboCount()<Act_Melee_GetMaxComboCount(actor,action) then\n\
	    \n\
	        local kNormalAttackActionID = actor:GetNormalAttackActionID();\n\
            GetComboAdvisor():AddNextAction(kNormalAttackActionID);\n\
    \n\
	        if actor:GetComboCount()>=2 then\n\
    	    \n\
    			if iBaseActorType == CT_THIEF then\n\
\n\
					GetComboAdvisor():AddNextAction(\"a_thi_melee_blow_up\");\n\
					GetComboAdvisor():AddNextAction(\"a_thi_melee_knock_back\");\n\
\n\
    			else\n\
    			\n\
					GetComboAdvisor():AddNextAction(\"a_melee_blow_up\");\n\
					GetComboAdvisor():AddNextAction(\"a_melee_knock_back\");\n\
		            \n\
	            end\n\
        	    \n\
	        end\n\
    	    \n\
	    end\n\
	\n\
	end\n\
	\n\
	\n\
	action:SetParamInt(3,0)	--	Hit Count\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Melee_OnFindTarget(actor,action,kTargets)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
end\n\
\n\
function Act_Melee_Finished(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local nextActionName = action:GetNextActionName()\n\
	local curActionParam = action:GetParam(0)\n\
	\n\
	ODS(\"Act_Melee_Finished curActionParam:\"..curActionParam..\" nextActionName : \"..nextActionName..\"\\n\");\n\
	\n\
	actor:SetNormalAttackEndTime();\n\
			\n\
	if action:GetParam(2) ~= \"HIT\" then\n\
		actor:SetComboCount(0)\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
	\n\
		if KeyIsDown(KEY_FIRE) == true then\n\
			actor:ReserveTransitAction(actor:GetNormalAttackActionID(),DIR_NONE);\n\
			action:SetParam(1, \"end\")\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	if nextActionName ~= \"a_battle_idle\" or\n\
		KeyIsDown(KEY_LEFT) or \n\
		KeyIsDown(KEY_RIGHT) or\n\
		KeyIsDown(KEY_UP) or\n\
		KeyIsDown(KEY_DOWN) then\n\
		\n\
		action:SetParam(1, \"end\")\n\
		\n\
		return	false;\n\
	else\n\
		action:SetParam(1, \"delay\")\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(0,g_world:GetAccumTime());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Melee_OnUpdate(actor, accumTime, frameTime)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	local animDone = actor:IsAnimationDone()\n\
	local param = action:GetParam(1)\n\
		\n\
	if(\"end\" == param) then\n\
		return false\n\
	end\n\
	\n\
	if	action:GetParam(1) == \"delay\" then\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0)\n\
		if fElapsedTime > 0.1 then\n\
			action:SetParam(1, \"end\")\n\
			return	false\n\
		end\n\
		return	true;\n\
	end\n\
	\n\
	if animDone == true then\n\
		return Act_Melee_Finished(actor,action);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Melee_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Act_Melee_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
	\n\
	ODS(\"Act_Melee_OnLeave actionID:\"..actionID..\" curParam:\"..curParam..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		actor:SetComboCount(0);	\n\
		\n\
		if iBaseActorType == CT_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_melee_01\");\n\
		elseif iBaseActorType == CT_THIEF then\n\
			actor:SetNormalAttackActionID(\"a_thi_melee_01\");\n\
		end\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" or curParam == \"null\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
	    ODS(\"Enable false\\n\");\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
		if curParam == \"delay\" then\n\
			return	true\n\
		end\n\
		\n\
		if curAction:GetParam(2) == \"HIT\" or \n\
			actionID == \"a_run\" then\n\
			\n\
			curAction:SetNextActionName(actionID);\n\
			curAction:SetNextActionInputSlotInfo(action:GetInputSlotInfo());\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		\n\
		if iBaseActorType == CT_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_melee_01\");\n\
		elseif iBaseActorType == CT_THIEF then\n\
			actor:SetNormalAttackActionID(\"a_thi_melee_01\");\n\
		end\n\
		\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Melee_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction();\n\
--	local actionID = kAction:GetID()\n\
	local iComboCount = actor:GetComboCount();\n\
		\n\
	kAction:SetParam(4,\"DoDamage\");\n\
\n\
	local	iSphereIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex);\n\
	\n\
	local bCri = kActionResult:GetCritical()\n\
	local DamageEff = actor:GetDamageEffectID(bCri)\n\
	if nil==DamageEff or 0==string.len(DamageEff) then\n\
		if bCri then\n\
			DamageEff = \"e_dmg_cri\"			\n\
		else\n\
			DamageEff = \"e_dmg\"\n\
		end\n\
	end\n\
	actorTarget:AttachParticleToPoint(12, pt, DamageEff)\n\
	\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	local	iHoldTime = iShakeTime;\n\
	\n\
	if iComboCount == Act_Melee_GetMaxComboCount(actor,kAction)-1 then	--	5  \n\
		iHoldTime = g_fThirdAttackFreezeTime * 1000;\n\
	end\n\
	\n\
	actor:SetAnimSpeedInPeriod(0.0001, iHoldTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime/2);		\n\
	\n\
\n\
end\n\
\n\
function Act_Melee_IsDoubleAttack(actor,action)\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local iTargetCount = action:GetTargetCount();\n\
	\n\
	if iTargetCount == 0 then\n\
	    return  false\n\
    end\n\
    \n\
    local actionResult = action:GetTargetActionResult(0);\n\
    local	iHitCount = actionResult:GetAbil(AT_HIT_COUNT)\n\
    \n\
    ODS(\"Act_Melee_IsDoubleAttack iHitCount:\"..iHitCount..\"\\n\");\n\
    \n\
    return  (iHitCount == 2);\n\
\n\
end\n\
\n\
BASE_ATTACK_EFFECT = {}\n\
BASE_ATTACK_EFFECT[WT_SWORD] = {[\"a_melee_01\"] = \"edge_swd_01_01\", [\"a_melee_02\"] = \"edge_swd_01_02\",\n\
[\"a_melee_03\"] = \"edge_swd_01_03\", [\"a_melee_04\"] = \"edge_swd_01_031\", [\"a_melee_05\"] = \"edge_swd_01_032\"}\n\
BASE_ATTACK_EFFECT[WT_BTS] = {[\"a_melee_01\"] = \"edge_swd_02_01\", [\"a_melee_02\"] = \"edge_swd_02_02\",\n\
[\"a_melee_03\"] = \"edge_swd_02_03\", [\"a_melee_04\"] = \"edge_swd_02_04\", [\"a_melee_05\"] = \"edge_swd_02_05\"}\n\
BASE_ATTACK_EFFECT[WT_CLAW] = {[\"a_thi_melee_01\"] = \"edge_claw_01_01\", [\"a_thi_melee_02\"] = \"edge_claw_01_02\",\n\
[\"a_thi_melee_03\"] = \"edge_claw_01_03\", [\"a_thi_melee_04\"] = \"edge_claw_01_04\", [\"a_thi_melee_05\"] = \"edge_claw_01_05\"}\n\
BASE_ATTACK_EFFECT[WT_KAT] = {[\"a_thi_melee_01\"] = \"edge_kattar_01_01\", [\"a_thi_melee_02\"] = \"edge_kattar_01_02\",\n\
[\"a_thi_melee_03\"] = \"edge_kattar_01_03\", [\"a_thi_melee_04\"] = \"edge_kattar_01_04\", [\"a_thi_melee_05\"] = \"edge_kattar_01_05\"}\n\
\n\
function Act_Melee_HitOneTime(actor,action,bIsDoubleAttack)\n\
\n\
	ODS(\"Act_Melee_HitOneTime\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	\n\
    action:SetParam(2,\"HIT\");	\n\
\n\
	local iTotalHit = 1;\n\
	if bIsDoubleAttack then\n\
		iTotalHit= 2\n\
	end\n\
	\n\
	local	iCurrentHitCount = action:GetParamInt(3)\n\
	\n\
	if iCurrentHitCount >= iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	bIsFinalHit = (iCurrentHitCount>=(iTotalHit-1));\n\
	local	bIsFirstHit = (iCurrentHitCount == 0)\n\
	\n\
\n\
	if bIsFinalHit then\n\
		actor:ClearIgnoreEffectList();\n\
		\n\
    end\n\
    \n\
    \n\
    if bIsFirstHit then\n\
		local weapontype = actor:GetEquippedWeaponType()\n\
		local szNode = \"char_root\"\n\
		local iSlot = 32+math.random(0,20)\n\
		local kScale = 1.0\n\
		local szActionID = action:GetID()\n\
		local szEffName = \"edge_swd_01_01\"\n\
		if nil~=BASE_ATTACK_EFFECT[weapontype] and nil~=BASE_ATTACK_EFFECT[weapontype][szActionID] then\n\
			szEffName = BASE_ATTACK_EFFECT[weapontype][szActionID]\n\
		end\n\
\n\
		--if actor:GetPilot():GetBaseClassID() == CT_FIGHTER  and false == actor:CheckStatusEffectExist(\"se_Bloody_Lore\") then\n\
		if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
			local kAEffect = actor:GetAttackEffect(szActionID)\n\
			if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
				szEffName = kAEffect:GetEffectName()\n\
				szNode = kAEffect:GetNodeName()\n\
				kScale = kAEffect:GetScale()\n\
			end\n\
\n\
			actor:AttachParticleToPointWithRotate(iSlot,actor:GetNodeWorldPos(szNode),szEffName,actor:GetRotateQuaternion(), kScale)\n\
		\n\
		elseif actor:GetPilot():GetBaseClassID() == CT_THIEF and false == actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") and false == actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			local kAEffect = actor:GetAttackEffect(szActionID)\n\
			if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
				szEffName = kAEffect:GetEffectName()\n\
				szNode = kAEffect:GetNodeName()\n\
				kScale = kAEffect:GetScale()\n\
			end\n\
\n\
			actor:AttachParticleToPointWithRotate(iSlot,actor:GetNodeWorldPos(szNode),szEffName,actor:GetRotateQuaternion(), kScale)\n\
		\n\
		end\n\
\n\
	end\n\
	\n\
		\n\
	if bIsFinalHit then\n\
	\n\
		local iTargetCount = action:GetTargetCount();\n\
		local i =0;\n\
		if iTargetCount>0 then\n\
			\n\
			local bWeaponSoundPlayed = false;\n\
			\n\
			while i<iTargetCount do\n\
			\n\
				local actionResult = action:GetTargetActionResult(i);\n\
				if actionResult:IsNil() == false then\n\
				\n\
					action:SetParamInt(4,actionResult:GetValue()/(iTotalHit));\n\
					local	iOneDmg = action:GetParamInt(4);\n\
				\n\
					actionResult:SetValue(\n\
						actionResult:GetValue() - iOneDmg*(iTotalHit-1));\n\
						\n\
					local kTargetGUID = action:GetTargetGUID(i);\n\
					local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
						\n\
						local actorTarget = kTargetPilot:GetActor();\n\
						\n\
	                    if bWeaponSoundPlayed == false then\n\
	                        bWeaponSoundPlayed = true;\n\
                            --   \n\
                            local actionName = action:GetID();\n\
							if actionResult:GetCritical() then\n\
								actionName = \"Critical_dmg\"\n\
							end\n\
							actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                        end				\n\
") + std::string("						Act_Melee_DoDamage(actor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
					end\n\
					\n\
				end\n\
				\n\
				i=i+1;\n\
			\n\
			end\n\
		end\n\
				\n\
		action:GetTargetList():ApplyActionEffects();\n\
		actor:ClearIgnoreEffectList();\n\
	\n\
	else\n\
	\n\
		action:GetTargetList():ApplyOnlyDamage(iTotalHit);\n\
		\n\
		local iTargetCount = action:GetTargetCount();\n\
		local i =0;\n\
		if iTargetCount>0 then\n\
			\n\
			local bWeaponSoundPlayed = false;\n\
			while i<iTargetCount do\n\
			\n\
				local actionResult = action:GetTargetActionResult(i);\n\
				if actionResult:IsNil() == false then\n\
				\n\
					local kTargetGUID = action:GetTargetGUID(i);\n\
					local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
						\n\
						local actorTarget = kTargetPilot:GetActor();\n\
						\n\
	                    if bWeaponSoundPlayed == false then\n\
	                        bWeaponSoundPlayed = true;\n\
                            --   \n\
							local actionName = action:GetID();\n\
							if actionResult:GetCritical() then\n\
								actionName = \"Critical_dmg\"\n\
							end\n\
							actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                        end							\n\
						\n\
						Act_Melee_DoDamage(actor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
					end\n\
				end\n\
				\n\
				i=i+1;\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
	\n\
	\n\
	iCurrentHitCount = iCurrentHitCount + 1;\n\
	action:SetParamInt(3,iCurrentHitCount);\n\
\n\
end\n\
\n\
function Act_Melee_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
                Act_Melee_HitOneTime(actor,action,false);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Act_Melee_OnEvent(actor,textKey,seqID)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	ODS(\"Act_Melee_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"end\" then\n\
\n\
		local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
		\n\
		local	bIsDoubleAttack = Act_Melee_IsDoubleAttack(actor,kAction);\n\
		if bIsDoubleAttack then\n\
			ODS(\"Act_Melee_OnEvent bIsDoubleAttack is true\\n\");\n\
		end\n\
		\n\
		if bIsDoubleAttack == false then\n\
			if textKey ~= \"hit\" then\n\
				return\n\
			end\n\
		end\n\
		\n\
	\n\
		if bIsDoubleAttack then	--	  TLM    .\n\
			bUseTLM = false\n\
		end\n\
		\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			if bUseTLM then\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Act_Melee_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
			\n\
		end\n\
		\n\
		Act_Melee_HitOneTime(actor,kAction,bIsDoubleAttack)\n\
		\n\
	end\n\
	return	true;\n\
end\n\
\n\
function IsAbleSubPlayerMeleeAttack(strAtionID)\n\
	if( \"a_twin_sub_trace_ground\" == strAtionID\n\
		or \"a_twin_sub_repos\" == strAtionID\n\
		or \"a_idle\" == strAtionID\n\
		or \"a_battle_idle\" == strAtionID\n\
	) then\n\
		return true\n\
	end	\n\
	return false\n\
end\n\
\n\
function IsAbleSubPlayerMeleeAttack2(kOwnerActor)\n\
	if( nil == kOwnerActor ) then return false end	\n\
	if( kOwnerActor:IsNil() ) then return false end	\n\
	local kSubActor = kOwnerActor:GetSubPlayer()\n\
	if( kSubActor:IsNil() ) then return false end	\n\
	local kSubActorAction = kSubActor:GetAction()\n\
	if( kSubActorAction:IsNil() ) then return false end\n\
	\n\
	return IsAbleSubPlayerMeleeAttack( kSubActorAction:GetID() )\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
function Act_FloatMelee_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_FloatMelee_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	if actor:GetFloatHeight(30)<40 then\n\
		ODS(\"Act_FloatMelee_OnCheckCanEnter actor:GetFloatHeight(30):\"..actor:GetFloatHeight(30)..\"\\n\");\n\
		return	false;	\n\
	end\n\
	\n\
	if actor:GetParam(\"FLOAT_ATTACK_ENABLE\")==\"FALSE\" then\n\
		return false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Act_FloatMelee_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_FloatMelee_OnEnter action : ..\"..action:GetID()..\"\\n\");\n\
\n\
	if actor:IsMyActor() == true then\n\
		action:SetParam(4, \"\");\n\
		\n\
		if action:GetID() ~= \"a_float_melee_01\" and\n\
		    action:GetID() ~= \"a_float_melee_02\" and\n\
		    action:GetID() ~= \"a_float_melee_03\" and\n\
		    action:GetID() ~= \"a_fig_floatdownblow1\" and\n\
			action:GetID() ~= \"a_fig_floatdownblow2\" and\n\
            action:GetID() ~= \"a_MagicianFloatShot_01\" and\n\
		    action:GetID() ~= \"a_MagicianFloatShot_02\" and\n\
		    action:GetID() ~= \"a_MagicianFloatShot_03\" and\n\
			action:GetID() ~= \"a_magefloatshot_01\" and\n\
			action:GetID() ~= \"a_magefloatshot_02\" and\n\
			action:GetID() ~= \"a_magefloatshot_03\" and\n\
            action:GetID() ~= \"a_nj_float_melee_01\" and\n\
		    action:GetID() ~= \"a_nj_float_melee_02\" and\n\
		    action:GetID() ~= \"a_nj_float_melee_03\" and		   		    \n\
		    action:GetID() ~= \"a_nj_float_melee_04\" and		   		    \n\
		    action:GetID() ~= \"a_nj_float_melee_05\" and\n\
			-- \n\
			action:GetID() ~= \"a_twin_float_melee_01\" and\n\
			action:GetID() ~= \"a_twin_float_melee_02\" and\n\
			action:GetID() ~= \"a_twin_float_melee_03\"\n\
		    then\n\
		    \n\
			actor:SetComboCount(0);	\n\
			action:ChangeToNextActionOnNextUpdate(true,true);					\n\
			return true;		    \n\
		    \n\
		end\n\
		\n\
		local iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
		if iBaseClassID == CT_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_melee_01\");\n\
		elseif iBaseClassID == CT_MAGICIAN then\n\
			actor:SetNormalAttackActionID(\"a_MagicianShot_01\");\n\
		elseif iBaseClassID == CT_ARCHER then\n\
			actor:SetNormalAttackActionID(\"a_archer_shot_01\");\n\
		elseif iBaseClassID == CT_THIEF then\n\
			actor:SetNormalAttackActionID(\"a_thi_melee_01\");\n\
		elseif iBaseClassID == CT_DOUBLE_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_twin_melee_01_m\");\n\
		end\n\
\n\
		local	iComboCount = actor:GetComboCount();\n\
		local	iNextComboCount = iComboCount+1;\n\
\n\
		ODS(\"Act_FloatMelee_OnEnter iComboCount : \"..iComboCount..\"\\n\");\n\
		\n\
		local	iMaxComboCount = 3\n\
		if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") then\n\
			iMaxComboCount = 5;\n\
		end\n\
		\n\
		if iNextComboCount >= iMaxComboCount then\n\
			iNextComboCount = 0\n\
			actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
		end\n\
\n\
		actor:SetComboCount(iNextComboCount);\n\
		\n\
		action:SetParam(0,\"\");\n\
		\n\
		local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
		\n\
		if bUseTLM == false then\n\
			action:CreateActionTargetList(actor);\n\
		end\n\
		\n\
		GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
				\n\
		if iBaseClassID == CT_FIGHTER or iBaseClassID == CT_THIEF then\n\
		    GetComboAdvisor():AddNextAction(\"a_melee_drop\");\n\
    		\n\
		    if action:GetID() == \"a_float_melee_01\" then\n\
		        GetComboAdvisor():AddNextAction(\"a_float_melee_02\");\n\
		    elseif action:GetID() == \"a_float_melee_02\" then\n\
		        GetComboAdvisor():AddNextAction(\"a_float_melee_03\");\n\
\n\
				local kActionName = \"a_fig_floatdownblow\";\n\
				if actor:GetPilot():IsCorrectClass(CT_KNIGHT,true) then\n\
					kActionName = kActionName..\"1\";\n\
					GetComboAdvisor():AddNextAction(kActionName);\n\
				elseif actor:GetPilot():IsCorrectClass(CT_WARRIOR,true) then\n\
					kActionName = kActionName..\"2\";\n\
					GetComboAdvisor():AddNextAction(kActionName);\n\
				end		        \n\
		    end\n\
    		\n\
		elseif iBaseClassID == CT_MAGICIAN then\n\
		    GetComboAdvisor():AddNextAction(\"a_magician_down_shot\");\n\
		    if action:GetID() == \"a_MagicianFloatShot_01\" then\n\
		        GetComboAdvisor():AddNextAction(\"a_MagicianFloatShot_02\");\n\
		    elseif action:GetID() == \"a_MagicianFloatShot_02\" then\n\
		        GetComboAdvisor():AddNextAction(\"a_MagicianFloatShot_03\");\n\
		    end\n\
		elseif iBaseClassID == CT_DOUBLE_FIGHTER then\n\
		    GetComboAdvisor():AddNextAction(\"\");\n\
		    if action:GetID() == \"a_twin_float_melee_01\" then\n\
		        GetComboAdvisor():AddNextAction(\"a_twin_float_melee_02\");\n\
		    elseif action:GetID() == \"a_twin_float_melee_02\" then\n\
		        GetComboAdvisor():AddNextAction(\"a_twin_float_melee_03\");\n\
		    end\n\
		end\n\
		\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:FreeMove(true);	\n\
	actor:StopJump();\n\
	\n\
	if actor:GetPilot():GetBaseClassID() == CT_THIEF then\n\
		actor:StartWeaponTrail();\n\
	end\n\
\n\
	actor:SetParam(\"DOUBLE_JUMP\",\"FALSE\"); --    \n\
	\n\
	return true\n\
end\n\
\n\
function Act_FloatMelee_OnFindTarget(actor,action,kTargets)\n\
\n\
	if( CheckNil(nil==actor) ) then return 0 end\n\
	if( CheckNil(actor:IsNil()) ) then return 0 end\n\
	\n\
	if( CheckNil(nil==action) ) then return 0 end\n\
	if( CheckNil(action:IsNil()) ) then return 0 end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 60\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
	\n\
	local iTargetCount = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"Act_FloatMelee_OnFindTarget iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	return	iTargetCount;\n\
	\n\
end\n\
\n\
function Act_FloatMelee_Finished(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local	actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	actor:SetNormalAttackEndTime();\n\
	\n\
	nextActionName = action:GetParam(1);\n\
\n\
			\n\
	local curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		\n\
		action:SetNextActionName(nextActionName)\n\
		\n\
		if nextActionName ~= \"a_melee_01\" and \n\
			nextActionName ~= \"a_thi_melee_01\" and\n\
			nextActionName ~= \"a_MagicianShot_01\" and\n\
			nextActionName ~= \"a_twin_melee_01_m\" then\n\
			actor:SetComboCount(0)\n\
			actor:FreeMove(false);\n\
			ODS(\"actor:SetComboCount(0) 0\\n\");\n\
			actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
		end\n\
	else\n\
		actor:FreeMove(false);\n\
	end\n\
	\n\
	if action:GetParam(2) ~= \"ATTACKED\" then\n\
		actor:SetComboCount(0)\n\
		actor:FreeMove(false);\n\
		actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
		\n\
		ODS(\"actor:SetComboCount(0) 1\\n\");\n\
	end\n\
	\n\
	\n\
	action:SetParam(0, \"null\")\n\
	action:SetParam(1, \"end\")\n\
\n\
	return false\n\
end\n\
\n\
function Act_FloatMelee_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		return Act_FloatMelee_Finished(actor,action);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_FloatMelee_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	actor:FreeMove(false);\n\
	actor:EndWeaponTrail();\n\
\n\
	if action:GetID() == \"a_jump\" then\n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Act_FloatMelee_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		actor:SetComboCount(0);	\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
		local	bCorrect = false;\n\
		\n\
		if 	actionID == \"a_run\" then\n\
			\n\
			bCorrect = false;\n\
			\n\
		else\n\
			if curAction:GetParam(2) == \"ATTACKED\" then\n\
			\n\
				bCorrect = true;\n\
			\n\
			end\n\
		end\n\
	\n\
		if bCorrect then\n\
	\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_FloatMelee_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction();\n\
			\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	local	iSphereIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex);\n\
	\n\
	local	iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
	if iBaseClassID == CT_FIGHTER  or\n\
		iBaseClassID == CT_THIEF then\n\
	\n\
		local bCri = kActionResult:GetCritical()\n\
		local DamageEff = actor:GetDamageEffectID(bCri)\n\
		if nil==DamageEff or 0==string.len(DamageEff) then\n\
			if bCri then\n\
				DamageEff = \"e_dmg_cri\"\n\
			else\n\
				DamageEff = \"e_dmg\"\n\
			end\n\
		end	\n\
		actorTarget:AttachParticleToPoint(12, pt, DamageEff)\n\
	end\n\
	\n\
end\n\
function Act_FloatMelee_DoDamageToTargetList(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
end\n\
\n\
function Act_FloatMelee_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"ATTACKED\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
                Act_FloatMelee_DoDamageToTargetList(actor,action);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Act_FloatMelee_OnEvent(actor,textKey,seqID)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
\n\
	if textKey == \"fire_end\" then\n\
	\n\
		actor:DetachFrom(10);\n\
	\n\
	end\n\
\n\
	if ( textKey == \"hit\" or textKey == \"fire\" )and kAction:GetParamInt(20) == 0 then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Act_FloatMelee_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
			\n\
		end\n\
	\n\
	\n\
		kAction:SetParam(2,\"ATTACKED\");		\n\
		\n\
		kAction:SetParamInt(20,1);	--	hit   !! ,    .\n\
	\n\
		local iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
	\n\
		if  iBaseClassID == CT_FIGHTER then\n\
					\n\
			if kAction:GetID() == \"a_float_melee_03\" and kAction:GetTargetCount()>0 then\n\
				if actor:IsMyActor() then\n\
					QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
					, g_fMeleeDropQuakeValue[2]\n\
					, g_fMeleeDropQuakeValue[3]\n\
					, g_fMeleeDropQuakeValue[4]\n\
					, g_fMeleeDropQuakeValue[5])\n\
				end	\n\
			end			\n\
			if kAction:GetID() == \"a_float_melee_01\" then\n\
				actor:AttachParticle(32,\"char_root\",\"edge_swd_01_01\");\n\
			elseif kAction:GetID() == \"a_float_melee_02\" then\n\
				actor:AttachParticle(33,\"char_root\",\"edge_swd_01_02\");\n\
			else\n\
				actor:AttachParticle(34,\"char_root\",\"edge_swd_01_07\");\n\
			end\n\
		elseif iBaseClassID == CT_MAGICIAN then\n\
		\n\
			local actionName = kAction:GetID()\n\
			\n\
			if string.sub(actionName, 1, 19) == \"a_MagicianFloatShot\" then\n\
				actor:AttachParticle(10,\"char_root\",\"ef_mag_lightning_char_root\");\n\
			else\n\
				local ActorPos = actor:GetNodeWorldPos(\"char_root\");\n\
				local ActorQuat = actor:GetRotateQuaternion();\n\
				local kRotateAxis = Point3(0, 0, 1);\n\
				local fRotateAngle = 20.0 * math.pi/180.0;\n\
				\n\
				local CtQuat = ActorQuat:Multiply(Quaternion(0, kRotateAxis));\n\
				local LtQuat = ActorQuat:Multiply(Quaternion(-fRotateAngle, kRotateAxis));\n\
				local RtQuat = ActorQuat:Multiply(Quaternion(fRotateAngle, kRotateAxis));\n\
			\n\
				--actor:AttachParticleToPoint(10, ActorPos, \"ef_mag_lightning_char_root\");\n\
				actor:AttachParticleToPointWithRotate(10,ActorPos,\"ef_mag_lightning_char_root\",CtQuat,1.0);\n\
				actor:AttachParticleToPointWithRotate(11,ActorPos,\"ef_mag_lightning_char_root\",LtQuat,1.0);\n\
				actor:AttachParticleToPointWithRotate(12,ActorPos,\"ef_mag_lightning_char_root\",RtQuat,1.0);\n\
			end\n\
		end\n\
	\n\
		Act_FloatMelee_DoDamageToTargetList(actor,kAction);\n\
		\n\
	end\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR] :    Size       Factor\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
-- Melee\n\
function Act_Melee_Default_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	--     \n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then	\n\
		if \"a_telejump\" == kCurAction:GetID() or \n\
			false == (false == actor:IsDownState() and false == actor:IsBlowUp() and true == actor:IsMeetFloor()) or\n\
			\"a_jump\" == kCurAction:GetID() or \n\
			\"a_dash_jump\" == kCurAction:GetID() then\n\
			if \"a_Change Ninja\" == action:GetID() then\n\
				return false;\n\
			end\n\
		end\n\
	end\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if action:GetID()==\"a_Couple_Lover\" then\n\
		return Couple_OnCheckCanEnter(actor, action)\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Melee_Default_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Act_Melee_Default_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
function Act_Melee_Default_Fire(actor,action)\n\
	--ODS(\"RestoreItemModel Act_Melee_Default_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		--ODS(\"Act_Melee_Default_Fire(actor,action)\\n\", false, 912)\n\
		action:CreateActionTargetList(actor);\n\
		if action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
			local iTargetCount = action:GetTargetCount();\n\
			if iTargetCount == tonumber(action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
				AddWarnDataStr(GetTextW(tonumber(action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2);		\n\
			end\n\
		end\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		--ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Act_Melee_Default_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Act_Melee_Default_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Act_Melee_Default_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
\n\
	local kParam = FindTargetParam();	\n\
		\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 80\n\
		end	\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
\n\
		iFindTargetType = TAT_SPHERE;\n\
\n\
		if 3 == action:GetAbil(AT_1ST_AREA_TYPE) then\n\
			kDir:Multiply(iAttackRange);\n\
			kPos:Add(kDir);\n\
			kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    		kParam:SetParam_2(0,0,iParam2,0);\n\
		else\n\
			kParam:SetParam_1(actor:GetPos(), actor:GetLookingDir());\n\
    		kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
		end\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	if \"a_Raid\" == action:GetID() then\n\
		kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP);	\n\
	end\n\
\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Act_Melee_Default_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	--ODS(\"Act_Melee_Default_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local fSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then		\n\
			local fFactor = 100\n\
			local kFactor = action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR\")\n\
			if(\"\" ~= kFactor) then\n\
				fFactor = tonumber(kFactor)				\n\
			end	\n\
			fSize = fSize * (action:GetSkillRange(0,actor) / fFactor)\n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, fSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,fSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,fSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end\n\
\n\
	kSoundID = action:GetScriptParam(\"ENTER_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
\n\
	local   kMarkEffectID = action:GetScriptParam(\"MARK_EFFECT_ID\");\n\
	if(kMarkEffectID ~= \"\") then\n\
		local kPos = actor:GetPos()\n\
		--kPos:SetZ(kPos:GetZ()+ 70)\n\
		kPos:SetZ(kPos:GetZ()-20)\n\
		actor:AttachParticleToPointWithRotate(128, kPos, kMarkEffectID, Quaternion(0, Point3(0,0,1)), 5)\n\
	end\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Act_Melee_Default_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Melee_Default_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		local nextActionName = action:GetNextActionName()\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Melee_Default_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	--ODS(\"RestoreItemModel Act_Melee_Default_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
") + std::string("		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
	\n\
--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
\n\
	local   kMarkEffectID = kCurAction:GetScriptParam(\"MARK_EFFECT_ID\");\n\
	if(kMarkEffectID ~= \"\") then\n\
		actor:DetachFrom(128,true)\n\
	end\n\
	return true;\n\
end\n\
\n\
function Act_Melee_Default_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_rp_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Melee_Default_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
function ActMelee_Default_AttachParticleOnHit(actor,action)\n\
	\n\
	if( CheckNil(nil==actor)  ) then return  end\n\
	if( CheckNil(actor:IsNil()) ) then return  end\n\
	\n\
	if( CheckNil(nil==action) ) then return  end\n\
	if( CheckNil(action:IsNil()) ) then return  end\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
		local 	iHitEffectSizeFactor = action:GetScriptParam(\"HIT_CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR\");\n\
		local fSize = 1\n\
		if(\"\" ~= iHitEffectSizeFactor) then \n\
			iHitEffectSizeFactor = tonumber(iHitEffectSizeFactor)\n\
			fSize = fSize * (action:GetSkillRange(0,actor) / iHitEffectSizeFactor)\n\
		end				\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticleS(7214,kHitEffectTargetNodeID,kHitEffectID, fSize);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticleS(7214,kHitEffectTargetNodeID,kHitEffectID, fSize);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPointS(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID, fSize);\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion(), fSize)\n\
		    end\n\
		end\n\
		\n\
		\n\
	    kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID2\");\n\
	    kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE2\");\n\
		kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS2\");\n\
		kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE2\");\n\
		iHitEffectSizeFactor = action:GetScriptParam(\"HIT_CASTING_EFFECT_SIZE_TO_SKILLRANGE_FACTOR2\");\n\
		\n\
		local fSize = 1\n\
		if(\"\" ~= iHitEffectSizeFactor) then \n\
			iHitEffectSizeFactor = tonumber(iHitEffectSizeFactor)\n\
			fSize = fSize * (action:GetSkillRange(0,actor) / iHitEffectSizeFactor)\n\
		end		\n\
		\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticleS(7217,kHitEffectTargetNodeID,kHitEffectID,fSize);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticleS(7217,kHitEffectTargetNodeID,kHitEffectID,fSize);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7217,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID,fSize);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7217,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion(),fSize)\n\
		    end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Melee_Default_HitOneTime(actor,action)\n\
	\n\
	if( CheckNil(nil==actor)  ) then return  end\n\
	if( CheckNil(actor:IsNil()) ) then return  end\n\
	\n\
	if( CheckNil(nil==action) ) then return  end\n\
	if( CheckNil(action:IsNil()) ) then return  end\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	ActMelee_Default_AttachParticleOnHit(actor,action)\n\
	\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Act_Melee_Default_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Act_Melee_Default_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		SkillHelpFunc_PlayHitSound(actor, kAction);\n\
		\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
				--ODS(\"Act_Melee_Default_OnEvent(actor,action)\\n\", false, 912)\n\
				kAction:CreateActionTargetList(actor);\n\
				if kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
					local iTargetCount = kAction:GetTargetCount();\n\
					if iTargetCount == tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
						AddWarnDataStr(GetTextW(tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2);		\n\
					end\n\
				end\n\
\n\
				if IsSingleMode() then\n\
		        \n\
					Act_Melee_Default_HitOneTime(actor,kAction)\n\
					Act_Melee_Default_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
		        \n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		            \n\
				end			\n\
			\n\
			end	\n\
		end\n\
		ActMelee_Default_AttachParticleOnHit(actor,kAction)       \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
function Skill_Melee_Blow_Up_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Melee_Blow_Up_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());	\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
    if actor:IsMyActor() == false then\n\
        return true\n\
    end\n\
    \n\
    local	kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		if kCurAction:GetID() == \"a_dash\" then\n\
			if actor:GetPilot():IsCorrectClass(CT_WARRIOR) then\n\
				actor:ReserveTransitAction(\"a_dash_blowup\");\n\
				return	false;			\n\
			end\n\
		end\n\
    end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then		--    .\n\
		return	false;\n\
	end	\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Skill_Melee_Blow_Up_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	--ODS(\"Skill_Melee_Blow_Up_OnEnter\\n\", false, 3851);\n\
	\n\
	if actor:IsMyActor() == true then\n\
\n\
		actor:SetComboCount(0);\n\
\n\
		if iBaseActorType == CT_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_melee_01\");\n\
		elseif iBaseActorType == CT_THIEF then\n\
			actor:SetNormalAttackActionID(\"a_thi_melee_01\");\n\
		elseif iBaseActorType == CT_SHAMAN then\n\
			--actor:SetNormalAttackActionID(\"a_Sum_Rifle_Shot\");\n\
		end\n\
		\n\
		GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
		GetComboAdvisor():AddNextAction(\"a_jump\");\n\
				\n\
	end\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	action:SetParam(2,\"\");\n\
\n\
    local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
	\n\
	if actor:GetPilot():GetBaseClassID() == CT_SHAMAN then			\n\
		local	kMovingVec = actor:GetLookingDir();\n\
		local	fDistance = -action:GetAbil(AT_SKILL_BACK_DISTANCE) +40\n\
		\n\
		kMovingVec:Multiply(fDistance);\n\
		kMovingVec:Add(actor:GetNodeWorldPos(\"char_root\"))\n\
		actor:AttachParticleToPoint(9,kMovingVec,\"eff_sum_skill_smn_ground_piston_01\");	\n\
	end\n\
	\n\
	return true\n\
end\n\
function Skill_Melee_Blow_Up_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
--	local	kDir = actor:GetLookingDir();\n\
--\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = g_fMeleeBlowUpAttackAngle\n\
	end\n\
	\n\
		\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
end\n\
\n\
function Skill_Melee_Blow_Up_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());		\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local iMaxActionSlot = action:GetSlotCount();\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
--	local actionID = action:GetID();\n\
\n\
	if animDone == true then\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end\n\
	return true\n\
end\n\
function Skill_Melee_Blow_Up_OnCleanUp(actor)\n\
	ODS(\"Skill_Melee_Blow_Up_ReallyLeave\\n\");\n\
	\n\
	return true;\n\
end\n\
function Skill_Melee_Blow_Up_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
	local	curAction = actor:GetAction();\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if curAction:GetParam(2) == \"HIT\" then\n\
			return true;\n\
		end\n\
		curAction:SetParam(3,\"a_jump\");\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		\n\
		if iBaseActorType == CT_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_melee_01\");\n\
		elseif iBaseActorType == CT_THIEF then\n\
			actor:SetNormalAttackActionID(\"a_thi_melee_01\");\n\
		elseif iBaseActorType == CT_SHAMAN then\n\
			--actor:SetNormalAttackActionID(\"a_Sum_Rifle_Shot\");\n\
		end\n\
		\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
function Skill_Melee_Blow_Up_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            --if actor:IsUnderMyControl()  then\n\
				--action:GetTargetList():ApplyActionEffects(true,true);\n\
            --else\n\
                SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
\n\
            --end\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
function Skill_Melee_Blow_Up_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	\n\
	ODS(\"Skill_Melee_Blow_Up_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	if textKey == \"hit\" then\n\
	\n\
		if actor:IsMyActor() then\n\
			QuakeCamera(g_fBlowUpQuakeValue[1]\n\
			, g_fBlowUpQuakeValue[2]\n\
			, g_fBlowUpQuakeValue[3]\n\
			, g_fBlowUpQuakeValue[4]\n\
			, g_fBlowUpQuakeValue[5])\n\
		end\n\
		\n\
		SkillFunc_QuakeCamera(actor:GetAction(), 6)		 --Hit  quake camera \n\
		if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
			actor:AttachParticle(31,\"char_root\",\"edge_swd_01_05\");\n\
		elseif  actor:GetPilot():GetBaseClassID() == CT_THIEF and false == actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") and false == actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			actor:AttachParticle(31,\"char_root\",\"ef_attk_fly_01_char_root\");\n\
		end\n\
		\n\
		local kAction = actor:GetAction();\n\
		\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Melee_Blow_Up_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
		\n\
		end\n\
		kAction:SetParam(2,\"HIT\");\n\
				\n\
		--Actor_PC_Base_DoDefaultMeleeAttack(actor,kAction);\n\
		--actor:ClearIgnoreEffectList();\n\
		\n\
		if actor:IsMyActor() then\n\
		\n\
			if actor:GetAction():GetParam(3) == \"a_jump\" then\n\
			\n\
				actor:ReserveTransitAction(\"a_jump\");\n\
				\n\
			end\n\
			\n\
		end\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- [DIRECTION] :    \"LEFT\" or \"RIGHT\"\n\
\n\
function Skill_Melee_Knock_Back_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Melee_Knock_Back_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
    if actor:IsMyActor() == false then\n\
        return true\n\
    end\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then\n\
		if actor:GetJumpAccumHeight()<50 then	\n\
			return	false;\n\
		end		\n\
	end\n\
	\n\
	--if actor:GetComboCount()<2 then\n\
	--	if iBaseActorType == CT_FIGHTER then	\n\
	--		actor:ReserveTransitAction(\"a_melee_01\");\n\
	--	elseif iBaseActorType == CT_THIEF then	\n\
	--		actor:ReserveTransitAction(\"a_thi_melee_01\");\n\
	--	end\n\
		\n\
	--	return	false;\n\
	--end		\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Melee_Knock_Back_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	SkillFunc_InitUseDmgEffect(action)\n\
	\n\
	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Melee_Knock_Back_OnEnter\\n\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			if actorID==\"c_fighter_male\" or actorID==\"c_fighter_female\" then\n\
				action:SetNextActionName(\"a_fighter_jump_attack\");\n\
			elseif actorID ==\"c_thief_male\" or actorID ==\"c_thief_female\" then\n\
				action:SetNextActionName(\"a_thief_jump_kick\");\n\
			end\n\
			\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		\n\
		actor:SetComboCount(0);\n\
\n\
		local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
		\n\
		if iBaseActorType == CT_FIGHTER then\n\
			actor:SetNormalAttackActionID(\"a_melee_01\");		\n\
		elseif iBaseActorType == CT_THIEF then\n\
			actor:SetNormalAttackActionID(\"a_thi_melee_01\");		\n\
		end\n\
		\n\
	end\n\
		\n\
\n\
	if actor:IsMyActor() == true then\n\
		GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	--actor:StartWeaponTrail();\n\
	\n\
	return true\n\
end\n\
function Skill_Melee_Knock_Back_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
--	local	kDir = actor:GetLookingDir();\n\
\n\
	local	kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Melee_Knock_Back_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
--	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
	\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
		\n\
	end\n\
	\n\
	return true\n\
end\n\
function Skill_Melee_Knock_Back_OnCleanUp(actor)\n\
	--actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
function Skill_Melee_Knock_Back_OnLeave(actor, action)\n\
\n\
    ODS(\"Skill_Melee_Knock_Back_OnLeave action : \"..action:GetID()..\"\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		return false;\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		actor:SetNormalAttackActionID(\"a_melee_01\");\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
function Skill_Melee_Knock_Back_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
				SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
function Skill_Melee_Knock_Back_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	if textKey == \"hit\" then\n\
	\n\
	    actor:ClearIgnoreEffectList();\n\
		if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
			\n\
			actor:AttachParticle(31,\"char_root\",\"edge_swd_01_06\");\n\
		\n\
		end\n\
\n\
		local kAction = actor:GetAction();\n\
					\n\
		CheckNil(nil==kAction);\n\
		CheckNil(kAction:IsNil());\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Melee_Knock_Back_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
			\n\
		end\n\
		kAction:SetParam(2,\"HIT\");\n\
			\n\
		if actor:IsMyActor() then\n\
			if actor:IsToLeft() == true then\n\
				QuakeCamera(g_fMeleeKnockBackQuakeValue_Left[1]\n\
				, g_fMeleeKnockBackQuakeValue_Left[2]\n\
				, g_fMeleeKnockBackQuakeValue_Left[3]\n\
				, g_fMeleeKnockBackQuakeValue_Left[4]\n\
				, g_fMeleeKnockBackQuakeValue_Left[5])  \n\
			else\n\
				QuakeCamera(g_fMeleeKnockBackQuakeValue_Right[1]\n\
				, g_fMeleeKnockBackQuakeValue_Right[2]\n\
				, g_fMeleeKnockBackQuakeValue_Right[3]\n\
				, g_fMeleeKnockBackQuakeValue_Right[4]\n\
				, g_fMeleeKnockBackQuakeValue_Right[5])  \n\
			end\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
use_cam_effect = false;\n\
function Skill_Melee_Drop_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Melee_Drop_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	if actor:GetFloatHeight(70)<70 then\n\
		return	false;	\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Skill_Melee_Drop_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	--actor:StartWeaponTrail();\n\
	action:SetParamInt(0,0);\n\
	\n\
	--  \n\
	if use_cam_effect == true then\n\
	\n\
			local	trn = GetCameraTrn()\n\
			local	rot = GetCameraRot()\n\
			trn:SetY(trn:GetY() - 80)\n\
			trn:SetZ(trn:GetZ() - 120)\n\
			if actor:IsToLeft() == true then\n\
				rot:SetX(-90)\n\
			else\n\
				rot:SetX(90)\n\
			end\n\
			rot:SetZ(rot:GetZ() + 20)\n\
			SetCameraSetting(trn, rot)\n\
	\n\
	end\n\
	\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	action:SetParamInt(4,0);\n\
	\n\
	action:SetParamFloat(2,-400);	-- Drop Speed!\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());	\n\
	end\n\
	\n\
	return true\n\
end\n\
function Skill_Melee_Drop_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	local	kTargetPos = actor:GetLookingDir();\n\
	kTargetPos:Multiply(iAttackRange);\n\
	kTargetPos:Add(actor:GetPos());\n\
	\n\
	local actorID = actor:GetID();\n\
	if actorID == \"c_thief_male\" or actorID == \"c_thief_female\" then\n\
		kTargetPos = actor:GetPos();\n\
	end\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = iAttackRange\n\
	end\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,Point3(0,0,-1));\n\
	kParam:SetParam_2(0,30,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR_COLL_PATH,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Melee_Drop_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	slotNum = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(4);\n\
	\n\
	ODS(\"iState : \"..iState..\" Param[0] : \"..action:GetParamInt(0)..\" slotNum:\"..slotNum..\" curActionParam:\"..action:GetParam(3)..\"\\n\");\n\
	if animDone then \n\
	\n\
	    ODS(\"Skill_Melee_Drop_OnUpdate animDone\\n\");\n\
	\n\
	end\n\
	\n\
	if iState == 0 then\n\
		\n\
		if animDone == true then\n\
		\n\
			if slotNum == 1 or slotNum == 2 then\n\
				local	curActionParam = action:GetParam(3)	\n\
				if curActionParam == \"GoNext\" then\n\
					nextActionName = action:GetParam(1);\n\
\n\
					action:SetParam(3, \"null\")\n\
					action:SetParam(1, \"end\")\n\
					if nextActionName~=\"\" then\n\
					    action:SetNextActionName(nextActionName)\n\
					end\n\
					\n\
					return false;\n\
				else\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			end\n\
		\n\
		end\n\
		\n\
		if action:GetParamInt(0) == 1 then\n\
			\n\
			local	fVel = action:GetParamFloat(2)\n\
			actor:SetMovingDelta(Point3(0,0,fVel))\n\
\n\
			action:SetParamFloat(2, fVel+ fVel * 10 * frameTime )\n\
			\n\
			if actor:IsMeetFloor() == true then\n\
				Skill_Melee_Drop_OnMeetFloor(actor,action,accumTime);\n\
			end\n\
		end\n\
		\n\
	else\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(5);\n\
		if fElapsedTime>=g_fMeleeDropFreezeTime then\n\
			actor:PlayCurrentSlot();\n\
			action:SetParamInt(4,0);\n\
		end		\n\
		\n\
	end\n\
	return true\n\
end\n\
function Skill_Melee_Drop_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:FreeMove(false);\n\
\n\
	actor:SetAnimOriginalSpeed()\n\
	--actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
function Skill_Melee_Drop_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Melee_Drop_OnLeave actionID:\"..actionID..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
\n\
	if actionID == \"a_jump\" then \n\
        if curAction:GetParam(6) == \"HIT\" then\n\
			return	true;\n\
		end\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end	\n\
\n\
	if action:GetEnable() == false then		\n\
		if curParam==actionID then\n\
			curAction:SetParam(1,\"\");\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
		if actionID == \"a_run\" or \n\
			string.sub(actionID,1,7) == \"a_melee\" or \n\
			string.sub(actionID,1,11) == \"a_thi_melee\" then\n\
	\n\
			curAction:SetParam(3,\"GoNext\");\n\
			curAction:SetParam(1,actionID);	\n\
			\n\
		elseif actionID == \"a_telejump\" or \n\
			actionID == \"a_teleport\" then\n\
			actor:DetachFrom(32)\n\
			return true\n\
		end\n\
	\n\
		return false;	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Melee_Drop_DoDamage(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(4,1);\n\
	action:SetParamFloat(5,accumTime);		\n\
\n\
	local	iTargetCount = action:GetTargetCount();\n\
	action:SetSlot(1);	\n\
	\n\
	if 	iTargetCount == 0 then\n\
		return true;\n\
	end\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
end\n\
\n\
function Skill_Melee_Drop_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        if action:GetParam(6) == \"HIT\" then\n\
            --  hit  \n\
            --    .\n\
            --if actor:IsMyActor()  then\n\
				--action:GetTargetList():ApplyActionEffects(true,true);\n\
            --else\n\
                Skill_Melee_Drop_DoDamage(actor,action);\n\
            --end\n\
        end\n\
    end\n\
end\n\
\n\
function Skill_Melee_Drop_OnMeetFloor(actor,action,accumTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(6,\"HIT\");\n\
	action:SetParamInt(0,2);	--	 Stop Drop!\n\
	actor:FindPathNormal();\n\
	\n\
	actor:FreeMove(false);\n\
	\n\
	if actor:IsMyActor() then\n\
		QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
		, g_fMeleeDropQuakeValue[2]\n\
		, g_fMeleeDropQuakeValue[3]\n\
		, g_fMeleeDropQuakeValue[4]\n\
		, g_fMeleeDropQuakeValue[5])\n\
	end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	\n\
	if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
		\n\
		kPos = actor:GetLookingDir();\n\
		local	fDistance = 50;\n\
		kPos:Multiply(fDistance);\n\
		kPos:Add(actor:GetPos());\n\
		\n\
	end\n\
\n\
	actor:AttachParticleToPoint(12, kPos, \"ef_thi_jump_down_attk\")\n\
	\n\
	if actor:IsUnderMyControl() then\n\
	\n\
		local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
		\n\
		if bUseTLM then\n\
		\n\
			action:CreateActionTargetList(actor);\n\
			if IsSingleMode() then\n\
				Act_Melee_OnTargetListModified(actor,action,false)\n\
			else\n\
				action:BroadCastTargetListModify(actor:GetPilot());\n\
			end			\n\
		\n\
		end	\n\
		\n\
	end\n\
	\n\
	action:SetSlot(1);		\n\
end\n\
\n\
\n\
function Skill_Melee_Drop_OnEvent(actor,textKey,seqID)\n\
\n\
    ODS(\"Skill_Melee_Drop_OnEvent textKey:\"..textKey..\"\\n\");\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if (textKey == \"drop\" or textKey == \"end\") and action:GetParamInt(0) == 0 then\n\
		\n\
		if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
			\n\
			actor:AttachParticle(32,\"char_root\",\"edge_swd_01_08\");\n\
		\n\
		end	\n\
			\n\
--		local	actorID = actor:GetID();\n\
	\n\
		action:SetParamInt(0,1);		--	Start Drop!\n\
		action:SetParamFloat(2,-700);	-- Drop Speed!\n\
		\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function archer_shot_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	--   \n\
	if g_pilotMan:IsLockMyInput() == true then\n\
		return\n\
	end	\n\
			\n\
	return		true;\n\
	\n\
end\n\
function archer_shot_FindTarget(kActor,kAction)\n\
	\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = archer_shot_OnFindTarget(kActor,kAction,kTargets);\n\
	\n\
	return	kTargets;\n\
end\n\
function archer_shot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,20,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
function archer_shot_ToFloatAttack(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	if (Act_Melee_IsToLeftAttack(actor,action) and actor:IsToLeft()) or \n\
		(Act_Melee_IsToRightAttack(actor,action) and actor:IsToLeft() == false)   then\n\
	    \n\
		if actor:GetPilot():IsCorrectClass(CT_RANGER) \n\
			and action:CheckCanEnter(actor,\"a_ran_floatdownshot\") then\n\
		\n\
			local	iShotCount = tonumber(actor:GetParam(\"RANGER_FLOATDOWNSHOT_COUNT\"));\n\
			if iShotCount==nil then\n\
				iShotCount = 0\n\
			end\n\
	\n\
			ODS(\"archer_shot_ToFloatAttack iShotCount:\"..iShotCount..\"\\n\");\n\
			\n\
			if iShotCount<5 then\n\
			\n\
				ODS(\"archer_shot_ToFloatAttack To Ranger FloatDownShot\\n\");\n\
				actor:SetComboCount(0);	\n\
				action:SetNextActionName(\"a_ran_floatdownshot\");\n\
				action:ChangeToNextActionOnNextUpdate(true, true)\n\
				return	true;		\n\
				\n\
			end\n\
		end\n\
	    \n\
	end\n\
	\n\
	if actor:GetJumpTime()>0.5 or Act_Melee_IsToDownAttack(actor,action) then\n\
		if action:CheckCanEnter(actor,\"a_archer_down_shot\") then\n\
			actor:SetComboCount(0);	\n\
			action:SetNextActionName(\"a_archer_down_shot\");\n\
			action:ChangeToNextActionOnNextUpdate(true, true)\n\
			return	true;\n\
	    end\n\
	end\n\
	return	false;\n\
end\n\
\n\
function archer_shot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"archer_shot_OnEnter\\n\");\n\
	\n\
	--	 \n\
	local	iTargetCount = 0;\n\
\n\
	if actor:IsMyActor() == true then\n\
\n\
		if actor:IsMeetFloor() == false then\n\
			if	archer_shot_ToFloatAttack(actor,action)	then\n\
				return	true\n\
			end\n\
		end	\n\
\n\
		local	iComboCount = actor:GetComboCount();\n\
		\n\
		ODS(\"archer_shot iComboCount:\"..iComboCount..\"\\n\");\n\
		\n\
		if iComboCount > 0 then\n\
		\n\
			if actor:CanNowConnectToNextComboAttack(1.0) == false 	 then\n\
				iComboCount = 0;\n\
			end	\n\
		end		\n\
		\n\
		if Act_Melee_IsToDownAttack(actor,action) then\n\
			if	Act_Melee_ToDownAttack(actor,action) then\n\
				return	true\n\
			end\n\
		end		\n\
		\n\
		if Act_Melee_IsToUpAttack(actor,action) then\n\
			if Act_Melee_ToDownAttack(actor,action,true) then\n\
				return	true\n\
			end\n\
		end		\n\
		\n\
		--    \n\
		if(0 < actor:GetAbil(AT_SKILL_EXTENDED)) then \n\
			-- \n\
			actor:SetComboCount(0)\n\
			action:ClearTargetList()\n\
			\n\
			if actor:GetAbil(AT_SKILL_EXTENDED) == 1 then	--	 !!			\n\
				if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
					actor:ReserveTransitAction(\"a_cbw_combo_a_Multishot\");\n\
					actor:ResetAnimation();\n\
					return false;\n\
				end\n\
				action:SetNextActionName(\"a_Rapidly Shot_Fire\")\n\
			elseif actor:GetAbil(AT_SKILL_EXTENDED) == 2 then	--	  \n\
				if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
					actor:ReserveTransitAction(\"a_cbw_combo_a_twoaction\");\n\
					actor:ResetAnimation();\n\
					return false;\n\
				end\n\
				action:SetNextActionName(\"a_twoaction_fire\")\n\
			end\n\
			-- \n\
			action:ChangeToNextActionOnNextUpdate(true, true)\n\
			return	true\n\
		end\n\
			\n\
		-- New SkillCombo System -----------------------------------------------------------\n\
		if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
			local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
			local iWeaponType = actor:GetEquippedWeaponType();\n\
			local bUseCombo = false\n\
			if iBaseActorType == CT_ARCHER then\n\
				if actor:IsMeetFloor() == true then\n\
					if 5 == iWeaponType then\n\
						actor:ReserveTransitAction(\"a_bw_combo_a\");\n\
						bUseCombo = true\n\
					elseif 6 == iWeaponType then\n\
						actor:ReserveTransitAction(\"a_cbw_combo_a\");\n\
						bUseCombo = true\n\
					end\n\
				end\n\
			end\n\
			if true == bUseCombo then\n\
				actor:ResetAnimation();\n\
				return false;\n\
			end\n\
		end\n\
		-- End : New SkillCombo System --------------------------------------------------------		\n\
			\n\
		local	iNextComboCount = iComboCount+1;\n\
		\n\
		actor:SetComboCount(iNextComboCount);\n\
		ODS(\"Archer Shot ComboCount : \"..iNextComboCount..\"\\n\");\n\
		\n\
			\n\
		--	  \n\
		local	fLastShotTime = tonumber(actor:GetParam(\"ARCHER_SHOT_TIME\"));\n\
		if fLastShotTime == nil then\n\
			fLastShotTime = 0\n\
		end\n\
		\n\
		local iAttackCoolTime = g_fArcherDefaultAttackCoolTime + (actor:GetAbil(AT_ADD_ATTACK_COOL_TIME) / 1000);\n\
		if iAttackCoolTime < 0 then\n\
			iAttackCoolTime = 0.1;\n\
		end\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
			ODS(\"g_fArcherDefaultAttackCoolTime : \" ..iAttackCoolTime .. \"\\n\");\n\
		if	g_world:GetAccumTime() - fLastShotTime < iAttackCoolTime then\n\
			ODS(\"Shot Time Not Over\\n\");\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		actor:SetParam(\"FLOAT_SHOT_COUNT\",\"0\");\n\
		\n\
        GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
        GetComboAdvisor():AddNextAction(action:GetID());\n\
        \n\
        --	  \n\
        actor:SetParam(\"ARCHER_SHOT_TIME\",\"\"..g_world:GetAccumTime());\n\
	end\n\
	\n\
\n\
	actor:ResetAnimation();\n\
	action:SetParamInt(6,0);\n\
	\n\
	actor:StopJump();\n\
	\n\
	return true\n\
end\n\
\n\
function	archer_shot_LoadArrowToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(actor:GetEquippedWeaponProjectileID(),action,actor:GetPilotGuid());\n\
\n\
	local	kPosition = actor:GetNodeWorldPos(\"p_ef_heart\");\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fMoveDistance = 30.0;\n\
	\n\
	kDir:Multiply(fMoveDistance);\n\
	kPosition:Add(kDir);\n\
	\n\
	kNewArrow:SetWorldPos(kPosition);\n\
	\n\
	return	kNewArrow;\n\
	\n\
end\n\
\n\
function archer_shot_Finished(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"archer_shot_Finished\\n\");\n\
\n\
	if actor:IsMeetFloor() == false then\n\
	    action:SetNextActionName(\"a_jump\");\n\
	end\n\
	\n\
		\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	actionID = action:GetID();\n\
			\n\
	actor:SetNormalAttackEndTime();\n\
\n\
		\n\
--	local	curActionSlot = action:GetCurrentSlot()\n\
	local	curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = action:GetParam(1);\n\
\n\
		action:SetParam(0, \"null\")\n\
		action:SetParam(1, \"end\")\n\
		\n\
		action:SetNextActionName(nextActionName)\n\
		return false;\n\
	else\n\
\n\
		action:SetParam(1, \"end\")\n\
\n\
		return false\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function archer_shot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local	actorID = actor:GetID()\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if animDone == true then\n\
		return	archer_shot_Finished(actor,action);\n\
	end\n\
	\n\
	return true\n\
end\n\
function archer_shot_OnCleanUp(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"archer_shot_ReallyLeave nextaction : \"..action:GetID()..\"\\n\");\n\
	\n\
	actor:FreeMove(false);\n\
	\n\
	return true;\n\
end\n\
function archer_shot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"archer_shot_OnLeave NEXTACTION : \"..actionID..\" curParam:\"..curParam..\"\\n\");\n\
\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	if actionID == \"a_archer_backstep_shot\" then\n\
		return	true\n\
	end\n\
	\n\
	local	kNextActionName = curAction:GetNextActionName();\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetNextActionName(\"a_battle_idle\");\n\
			return false;\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
\n\
		if curAction:GetParamInt(7)==1 and actionID == \"a_run\" then	--	     .\n\
			return	true;\n\
		end\n\
		\n\
		if curAction:GetParamInt(7)==1 or actionID == \"a_run\" then\n\
			curAction:SetNextActionName(actionID);\n\
			curAction:SetNextActionInputSlotInfo(action:GetInputSlotInfo());\n\
        end\n\
\n\
		return false;\n\
	\n\
	elseif (curParam == \"end\" or curAction:GetParamInt(7)==1) and\n\
		(actionID == \"a_run\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function archer_shot_DoEffect(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
    actor:FreeMove(false);\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then	--	 DB  ...\n\
		iAttackRange = 200\n\
	end\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = archer_shot_LoadArrowToWeapon(actor,action);\n\
	\n\
\n\
--	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
			\n\
		local iPentrationCount = actor:GetAbil(AT_PENETRATION_COUNT);\n\
		kArrow:SetPenetrationCount(iPentrationCount);--   \n\
		if iPentrationCount ~= 0 then\n\
			kArrow:SetMultipleAttack(true);\n\
		end\n\
			\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local kAEffect = actor:GetAttackEffect(action:GetID())\n\
		if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
			actor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
			\n\
		kMovingDir:Multiply(iAttackRange-45);\n\
		kMovingDir:Add(arrow_worldpos);\n\
		kArrow:SetTargetLoc(kMovingDir);	\n\
		\n\
		kArrow:Fire();\n\
		actor:ClearIgnoreEffectList();\n\
	\n\
	end\n\
	\n\
	\n\
end\n\
\n\
function archer_shot_OnEvent(actor, textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"archer_shot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\" or textKey == \"end\" then\n\
	\n\
		if action:GetParamInt(7) == 0 then\n\
		\n\
			action:SetParamInt(7,1);\n\
			archer_shot_DoEffect(actor);	\n\
	\n\
		end\n\
\n\
	end\n\
end\n\
\n\
function archer_shot_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
function Skill_Down_Shot_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Down_Shot_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		local weapontype = actor:GetEquippedWeaponType();\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
	\n\
end\n\
function Skill_Down_Shot_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
	\n\
		if actor:GetJumpAccumHeight()<50 then\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
	\n\
	end\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Down_Shot_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
\n\
	if actor:IsMyActor() == true then\n\
		Skill_Down_Shot_FindTargets(actor,action);\n\
	else\n\
		GetActionResultCS(action, actor)\n\
	end\n\
	\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	return true\n\
end\n\
function Skill_Down_Shot_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local iAttackRange = action:GetSkillRange(0,actor);\n\
	local	arrow_worldpos = actor:GetPos();--kNewArrow:GetWorldPos();	--	 \n\
	\n\
--  \n\
	local	kRotateAxis = actor:GetLookingDir();\n\
	kRotateAxis:Cross(Point3(0,0,1));\n\
	kRotateAxis:Unitize();\n\
	local	fRotateAngle = 20.0*3.141592/180.0;\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,20,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);		\n\
\n\
	local	kFireTargetDir = Point3(0.1,0.1,-1);\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle);\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir);\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
	kFireTargetDir = Point3(0.1,0.1,-1);\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle*2);\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir);\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
	kFireTargetDir = Point3(0.1,0.1,-1);\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle*3);\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir);\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
end\n\
\n\
function Skill_Down_Shot_FindTargets(actor,action)\n\
\n\
    action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function Skill_Down_Shot_LoadToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	kAttackNodeName = \"p_ef_heart\";\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Down_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
\n\
	if animDone == true then\n\
	\n\
--		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(1, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Down_Shot_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
	\n\
	return true;\n\
end\n\
function Skill_Down_Shot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		return true;\n\
	end	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curAction:GetParam(1)==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Down_Shot_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		local	action = actor:GetAction()\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
		\n\
		local	iAttackRange = action:GetSkillRange(0,actor);\n\
		actor:FreeMove(false);	\n\
		\n\
		\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		\n\
--		local	iTargetCount = action:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
\n\
		--  \n\
		local	kRotateAxis = actor:GetLookingDir();\n\
		kRotateAxis:Cross(Point3(0,0,1));\n\
		kRotateAxis:Unitize();\n\
		fRotateAngle = 20.0*3.141592/180.0;			\n\
		local	i = 0;\n\
		\n\
		local	kActionTargetList = action:GetTargetList();\n\
		\n\
		while i<3 do\n\
		\n\
			local	kTargetActor = nil;\n\
			local	kActionTargetInfo = kActionTargetList:GetTargetInfo(0);\n\
			iTargetABVShapeIndex = 0;\n\
			\n\
			if kActionTargetInfo:IsNil() == false then\n\
			\n\
				iTargetABVShapeIndex = kActionTargetInfo:GetABVIndex();\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kActionTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
					kTargetActor = kTargetPilot:GetActor();\n\
				end			\n\
				\n\
			end\n\
\n\
			local	kArrow = Skill_Down_Shot_LoadToWeapon(actor,action);\n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
			if kTargetActor ~= nil and kTargetActor:IsNil() == false and kActionTargetInfo~=nil and kActionTargetInfo:IsNil() == false then\n\
				kArrow:SetTargetObject(kActionTargetInfo);	\n\
				kActionTargetList:DeleteTargetInfo(0);\n\
			end\n\
			\n\
			local	kFireTarget = Point3(0.1,0.1,-1);\n\
			kFireTarget:Multiply(iAttackRange);\n\
			kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i+1));\n\
			kFireTarget:Add(arrow_worldpos);			\n\
			kArrow:SetTargetLoc(kFireTarget);	\n\
			kArrow:Fire();--	!\n\
\n\
			i=i+1;\n\
		end\n\
		\n\
		actor:GetAction():SetParam(7,\"FIRED\");\n\
		actor:ClearIgnoreEffectList();\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
function Archer_Down_Shot_OnCheckCanEnter(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
--	local kCurAction = actor:GetAction()\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	if weapontype == 0 then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
	\n\
end\n\
function Archer_Down_Shot_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if actor:IsMyActor() == true then\n\
	\n\
		if actor:GetFloatHeight(40)<50 then\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		if actor:GetParam(\"JUMP_DOWN_ATTACK_ENABLE\") ~= nil and\n\
		    actor:GetParam(\"JUMP_DOWN_ATTACK_ENABLE\") == \"FALSE\" then\n\
		    \n\
		    action:SetNextActionName(\"a_battle_idle\");\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;		\n\
			    \n\
		end\n\
		\n\
		actor:SetParam(\"JUMP_DOWN_ATTACK_ENABLE\",\"FALSE\");		\n\
	\n\
	end\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Archer_Down_Shot_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
	\n\
	local iShotTime = action:GetAbil(AT_COUNT)--   \n\
	if(iShotTime <= 0) then iShotTime = 1 end\n\
	action:SetParamInt(100, iShotTime)\n\
	action:SetParamInt(101, iShotTime) --   \n\
	action:SetSlot(0)\n\
	actor:PlayCurrentSlot()\n\
	return true\n\
end\n\
\n\
\n\
function Archer_Down_Shot_LoadToWeapon(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	kAttackNodeName = \"p_ef_heart\";\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function Archer_Down_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	iCurActionSlot = action:GetCurrentSlot()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
\n\
	if animDone == true or actor:IsMeetFloor() then\n\
		local iReaminShotTime = action:GetParamInt(101)\n\
		\n\
		if(iReaminShotTime <= 0) then\n\
			--action:SetSlot(2) \n\
			actor:PlayNext() --   \n\
		end\n\
		\n\
		if(actor:IsMeetFloor() or iCurActionSlot == iMaxActionSlot-1) then \n\
			actor:FreeMove(false);	--   ,  \n\
		\n\
			local	curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				nextActionName = action:GetParam(1);\n\
\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				action:SetNextActionName(nextActionName)\n\
				return false;\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		elseif(iReaminShotTime > 0) then --   \n\
			iReaminShotTime = iReaminShotTime - 1\n\
			action:SetSlot(1)				\n\
			actor:PlayCurrentSlot()			\n\
			action:SetParamInt(101, iReaminShotTime)			\n\
			return true\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Archer_Down_Shot_OnCleanUp(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
\n\
	actor:FreeMove(false);\n\
	\n\
	return true;\n\
end\n\
function Archer_Down_Shot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Archer_Down_Shot_OnLeave actionID:\"..actionID..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == false then\n\
	\n\
		if actionID == \"a_jump\" then\n\
			action:SetSlot(2)\n\
		end\n\
	\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		return true;\n\
	end	\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		return  true;\n\
	end\n\
\n\
	if action:GetEnable() == false then\n\
		\n\
		if curAction:GetParam(1)==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		if actionID == \"a_archer_shot_01\" then\n\
		    return  false\n\
        end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
	return false \n\
end\n\
\n\
function Archer_Down_Shot_OnEvent(actor, textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		local	action = actor:GetAction()\n\
		\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
		local	iAttackRange = action:GetSkillRange(0,actor);\n\
		\n\
		ODS(\"Archer_Down_Shot_OnEvent iAttackRange : \"..iAttackRange..\"\\n\");\n\
		--actor:FreeMove(false);	\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		\n\
--		local	iTargetCount = action:GetTargetCount();\n\
--		local	iTargetABVShapeIndex = 0;\n\
\n\
		--  \n\
		local	kRotateAxis = actor:GetLookingDir();\n\
		kRotateAxis:Cross(Point3(0,0,1));\n\
		kRotateAxis:Unitize();\n\
		fRotateAngle = -20*DEGTORAD;			\n\
		local	i = 0;\n\
		local iShotTime = action:GetParamInt(100)\n\
		if(iShotTime == 0) then iShotTime = 1 end\n\
		local iProjectilNum =  action:GetAbil(AT_PROJECTILE_NUM)\n\
		local iMaxProjectileNum =  iProjectilNum/ iShotTime\n\
		\n\
		\n\
		if(iMaxProjectileNum <= 0) then iMaxProjectileNum = 3 end 		\n\
		local	kActionTargetList = action:GetTargetList();\n\
		\n\
		while i<iMaxProjectileNum do\n\
		\n\
			local	kArrow = Archer_Down_Shot_LoadToWeapon(actor,action);\n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
			local	kFireTarget = actor:GetLookingDir();\n\
			kFireTarget:Multiply(iAttackRange);\n\
			kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i+1));\n\
			kFireTarget:Add(arrow_worldpos);			\n\
			kArrow:SetTargetLoc(kFireTarget);	\n\
			kArrow:Fire();--	!\n\
\n\
			i=i+1;\n\
		end\n\
		\n\
		actor:ClearIgnoreEffectList();\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
-- [HorizMoveSpeed] :   \n\
-- [ARROW_ROTATE] :     Degree\n\
-- [ATTCK_DOWN_STATE] :    \n\
\n\
function Archer_Jump_Shot_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Archer_Jump_Shot_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		local weapontype = actor:GetEquippedWeaponType();\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
	\n\
end\n\
function Archer_Jump_Shot_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Archer_Jump_Shot_OnEnter weapontype : \"..weapontype..\" ComboCount:\"..actor:GetComboCount()..\"\\n\");\n\
\n\
	--Archer_Jump_Shot_LoadToWeapon(actor,action);\n\
	\n\
	if actor:IsMyActor() == true then\n\
	\n\
		actor:SetComboCount(0);	\n\
	\n\
	end\n\
	\n\
	actor:SetComboCount(0);\n\
\n\
	return true\n\
end\n\
function Archer_Jump_Shot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,20,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
end\n\
\n\
function Archer_Jump_Shot_FindTargets(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    action:CreateActionTargetList(actor,true);\n\
	\n\
end\n\
\n\
function Archer_Jump_Shot_LoadToWeapon(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	kAttackNodeName = \"p_ef_heart\";\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
\n\
	return	kNewArrow;\n\
end\n\
\n\
function Archer_Jump_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
	\n\
	if animDone then\n\
	\n\
		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(1, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Archer_Jump_Shot_OnCleanUp(actor)\n\
	return true;\n\
end\n\
function Archer_Jump_Shot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	if action:GetEnable() then\n\
		ODS(\"Archer_Jump_Shot_OnLeave action:\"..action:GetID()..\" Enable\\n\");\n\
	else\n\
		ODS(\"Archer_Jump_Shot_OnLeave action:\"..action:GetID()..\" Disable\\n\");\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curAction:GetParam(1)==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		if actionID == \"a_archer_shot_01\" then\n\
		\n\
		\n\
		    if Act_Melee_IsToUpAttack(actor,action) then\n\
		    \n\
		        actionID = \"a_ArcherFloatShot_01\"\n\
		    else\n\
		        return false;\n\
		    end\n\
		\n\
        end	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Archer_Jump_Shot_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    ODS(\"Archer_Jump_Shot_OnEvent textKey : \"..textKey..\"\\n\");\n\
\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
	\n\
	\n\
		local	action = actor:GetAction()\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
	\n\
	    if action:GetParam(7) == \"FIRED\" then\n\
	        return\n\
        end\n\
\n\
		\n\
		local	iAttackRange = action:GetSkillRange(0,actor);\n\
			\n\
		local	kProjectileMan = GetProjectileMan();\n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
\n\
		local	i = 0;\n\
		\n\
		Archer_Jump_Shot_FindTargets(actor,action);\n\
		\n\
		local	kActionTargetList = action:GetTargetList();\n\
		\n\
		local	kTargetActor = nil;\n\
		local	kActionTargetInfo = kActionTargetList:GetTargetInfo(0);\n\
		iTargetABVShapeIndex = 0;\n\
		\n\
		local pt = nil;\n\
		\n\
		if kActionTargetInfo:IsNil() == false then\n\
		\n\
			iTargetABVShapeIndex = kActionTargetInfo:GetABVIndex();\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kActionTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
				kTargetActor = kTargetPilot:GetActor();\n\
				\n\
				pt = kTargetActor:GetNodeWorldPos(\"char_root\");\n\
				\n\
			end			\n\
			\n\
		end\n\
\n\
		local	kArrow = Archer_Jump_Shot_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		if pt == nil then\n\
		    local	kFireTarget = actor:GetLookingDir();\n\
		    kFireTarget:Multiply(iAttackRange-50);\n\
		    kFireTarget:Add(arrow_worldpos);			\n\
		    kArrow:SetTargetLoc(kFireTarget);	\n\
		else\n\
    		kArrow:SetTargetLoc(pt);	\n\
		end\n\
		\n\
		kArrow:Fire();--	!\n\
\n\
		\n\
		action:SetParam(7,\"FIRED\");\n\
		kActionTargetList:clear();\n\
		actor:ClearIgnoreEffectList();\n\
		\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
\n\
-- Melee\n\
function Skill_Jump_Shot_OnCheckCanEnter(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		if actor:GetJumpAccumHeight() < 50 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
\n\
		local weapontype = actor:GetEquippedWeaponType();\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
	\n\
end\n\
function Skill_Jump_Shot_OnCastingCompleted(actor, action)\n\
		\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	Skill_Jump_Shot_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Skill_Jump_Shot_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Skill_Jump_Shot_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
function Skill_Jump_Shot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),30,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);		\n\
end\n\
\n\
function Skill_Jump_Shot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Skill_Jump_Shot_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Jump_Shot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Jump_Shot_OnCleanUp(actor,action)\n\
	return true;\n\
end\n\
\n\
function Skill_Jump_Shot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Jump_Shot_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Skill_Jump_Shot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_Jump_Shot_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			local	iTargetCount = kAction:GetTargetCount();\n\
			local	iTargetABVShapeIndex = 0;\n\
			local	kActionTargetInfo = nil\n\
			if iTargetCount>0 then\n\
					--	  \n\
				local	kTargetGUID = kAction:GetTargetGUID(0);\n\
				iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
				kActionTargetInfo = kAction:GetTargetInfo(0);\n\
				targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
				if targetobject:IsNil() == false then\n\
					local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
					actor:LookAt(pt);\n\
				end						\n\
			end\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
				\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kMovingDir:Add(arrow_worldpos);\n\
				kArrow:SetTargetLoc(kMovingDir);	\n\
				\n\
			else\n\
				kArrow:SetTargetObjectList(kAction:GetTargetList());	\n\
			end\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Melee_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_Melee_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
			\n\
		local iClassNo = actor:GetAbil(AT_CLASS)\n\
		local iSeqID = actor:GetAniSequenceID()\n\
		--ODS(\"iClassNo = \"..iClassNo..\" / iSeqID = \"..iSeqID..\"\\n\", false, 3851)\n\
		if 2004001 == iClassNo and 1000207 == iSeqID then\n\
			actor:AttachParticleS(3851, \"char_root\", \"efx_dunamic_rolling_attack_02_02_hold\", 1.0)\n\
		end\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
		\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	local DetachEffect = actor:GetAnimationInfo(\"DETACH_RANGE_EFFECT\")\n\
	if nil~=DetachEffect and \"TRUE\"==DetachEffect then\n\
		actor:DetachFrom(81190)	--Act_Mon_MassiveProjectile\n\
	end\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_Melee_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\")\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	if( \"FALSE\" == action:GetScriptParam(\"APPLY_ACTION_EFFECTS\") ) then\n\
		action:SetParamInt(20110615,1)\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	action:SetParamInt(88, 0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
	else	\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_Melee_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_Melee_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Melee_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Melee_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Mon_Melee_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Mon_Melee_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					local iClassNo = actor:GetAbil(AT_CLASS)\n\
					local iSeqID = actor:GetAniSequenceID()\n\
					if 2006001 == iClassNo then\n\
						PlaySoundByID( \"sum-blasser\" )\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	Skill_ChainLightning_Fire(actor,action)\n\
	actor:SetParam(\"lightning\", \"false\")\n\
end\n\
\n\
function Act_Mon_Melee_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			local nextAction = actor:GetAnimationInfo(\"NEXT_ACTION\")\n\
			if nil~=nextAction and \"NONE\"~=nextAction then\n\
				action:SetNextActionName(nextAction)\n\
			end\n\
			return false\n\
		end\n\
		if \"true\"==actor:GetParam(\"lightning\") then\n\
			local   fLastUpdateTime = action:GetParamFloat(3);\n\
			if accumTime - fLastUpdateTime > 0.5 then\n\
				local path = actor:GetAnimationInfo(\"LIGHTNING_PATH\")\n\
				Skill_ChainLightning_CreateLinkedPlane(actor,action,path)\n\
				action:SetParamFloat(3,accumTime);\n\
			end\n\
			local node = actor:GetAnimationInfo(\"LIGHTNING_START_NODE\")\n\
			Skill_ChainLightning_UpdatePlanePos(actor, action, node)	\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if(0 == action:GetParamInt(20110510) ) then --        \n\
				actor:ResetAnimation();	\n\
				actor:PlayCurrentSlot();\n\
				action:SetParamInt(20110510, 1)\n\
			end\n\
			\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Melee_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local   iGroupNum = actor:GetAction():GetParamInt(2);\n\
    if iGroupNum ~= -1 then\n\
        local   kMan = GetLinkedPlaneGroupMan();\n\
        kMan:ReleaseLinkedPlaneGroup(iGroupNum);\n\
        actor:GetAction():SetParamInt(2,-1);\n\
		actor:GetAction():ClearTargetList();\n\
    end\n\
	\n\
	actor:DetachFrom(122)\n\
end\n\
\n\
function Act_Mon_Melee_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	--ODS(\"Act_Mon_Melee_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_Cast_Effect(actor,textKey)\n\
	if actor == nil or textKey == nil then\n\
		return\n\
	end\n\
	\n\
	if textKey == \"start\" then\n\
		local action = actor:GetAction()\n\
		if action:IsNil() then\n\
			return\n\
		end\n\
		\n\
		local iFirst = action:GetParamInt(88)		\n\
		\n\
		if iFirst == 0 then\n\
			if action:GetActionParam() ~= AP_FIRE then\n\
				local EffectNode = actor:GetAnimationInfo(\"CAST_EFFECT_NODE\")\n\
				if EffectNode == nil then\n\
					EffectNode = \"char_root\"\n\
				end\n\
				local Effect = actor:GetAnimationInfo(\"CAST_EFFECT\")\n\
				local EffectScale = actor:GetAnimationInfo(\"CAST_EFFECT_SCALE\")\n\
				if nil==EffectScale or \"\"==EffectScale then\n\
					EffectScale = 1\n\
				else\n\
					EffectScale = tonumber(EffectScale)\n\
				end\n\
				\n\
				if nil~=Effect then\n\
					actor:AttachParticleS(122, EffectNode, Effect, EffectScale)\n\
				end\n\
				\n\
			end\n\
		end\n\
		action:SetParamInt(88, 1)\n\
	elseif textKey == \"elga_jump\" then\n\
		actor:DetachFrom(122)\n\
	end\n\
end\n\
\n\
function Act_Mon_Melee_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
    --ODS(\"Act_Mon_Melee_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
	\n\
	Act_Mon_Cast_Effect(actor,textKey)\n\
	\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
        local   action = actor:GetAction();\n\
		\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
		local path = actor:GetAnimationInfo(\"LIGHTNING_PATH\")\n\
		if nil~=path and \"\"~=path then\n\
			Skill_ChainLightning_CreateLinkedPlane(actor,action, path)\n\
			actor:SetParam(\"lightning\", \"true\")\n\
		end\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local kSoundID = actor:GetAnimationInfo(\"HIT_SOUND_ID\")\n\
		if nil ~= kSoundID and \"\" ~= kSoundID then\n\
			--ODS(\"actor:GetAnimationInfo(HIT_SOUND_ID)\\n\")\n\
			actor:AttachSound(2785,kSoundID);\n\
		end\n\
\n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectFront = actor:GetAnimationInfo(\"FIRE_EFFECT_FRONT\")\n\
		local EffectScale = nil\n\
		local EffectAutoScale = actor:GetAnimationInfo(\"FIRE_EFFECT_AUTO_SCALE\")\n\
		if nil~=EffectAutoScale then\n\
			EffectAutoScale = string.upper(EffectAutoScale)\n\
			if \"TRUE\"==EffectAutoScale then\n\
				EffectScale = GetEffectAutoScale(actor)\n\
			end\n\
		else\n\
			EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		end\n\
\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
\n\
		if nil~=EffectNode and nil~=Effect then\n\
			actor:AttachParticleS(125, EffectNode, Effect, EffectScale)\n\
		elseif nil~=EffectFront and nil~=Effect then\n\
			EffectFront = tonumber(EffectFront)\n\
			local kLook = actor:GetLookingDir()\n\
			kLook:Unitize()\n\
			kLook:Multiply(EffectFront)\n\
			local kPos = actor:GetTranslate()\n\
			kPos:Add(kLook)\n\
			\n\
			local const_rotate = Quaternion(-90.0*math.pi/180.0, Point3(0,0,1))\n\
			local Quat = actor:GetRotateQuaternion()\n\
			Quat = Quat:Multiply(const_rotate)\n\
			actor:AttachParticleToPointWithRotate(125, kPos, Effect, Quat, EffectScale)\n\
		end\n\
	elseif textKey == \"start\" then\n\
		local   action = actor:GetAction();\n\
		\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
		\n\
		if true==action:IsSlotEventScript() then\n\
			local EventScriptNo = actor:GetAnimationInfo(\"EVENTSCRIPT_NO\")\n\
			local EventScriptViewDistance = actor:GetAnimationInfo(\"EVENTSCRIPT_VIEW_DISTANCE\")\n\
			if nil==EventScriptViewDistance or \"\"==EventScriptViewDistance then\n\
				EventScriptViewDistance = 300\n\
			else\n\
				EventScriptViewDistance = tonumber(EventScriptViewDistance)\n\
			end\n\
\n\
			local kSubPos = actor:GetPos():_Subtract(GetMyActor():GetPos())\n\
			--ODS(\"kSubPos x: \"..kSubPos:GetX()..\", y:\"..kSubPos:GetY()..\", z:\"..kSubPos:GetZ()..\"\\n\")\n\
\n\
			if nil == EventScriptNo or \"\" == EventScriptNo then\n\
				EventScriptNo = 0\n\
			end\n\
			\n\
			if EventScriptViewDistance > math.abs(kSubPos:GetX()) then\n\
				if EventScriptNo > 0 then\n\
					GetEventScriptSystem():ActivateEvent(EventScriptNo)\n\
				else\n\
					CreateFuryCamera(actor, tonumber(actor:GetAnimationInfo(\"FURY_CAMERA_DISTANCE\")))\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Melee_OnTargetListModified(actor,action,bIsBefore)\n\
	if bIsBefore == false then\n\
		--  hit  \n\
		--    .\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action);\n\
   end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
-- Add      .         .\n\
--\n\
function Act_Mon_Melee_CastAni_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_SetState(actor,action,kState)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
\n\
	local fLenth = actor:GetAnimationLength(action:GetSlotAnimName(kState))\n\
\n\
	--ODS(\"Act_Mon_Melee_CastAni_SetState \"..kState..\" \"..action:GetSlotAnimName(kState)..\"\\n\", false, 1509)\n\
\n\
	action:SetSlot(kState)\n\
\n\
	if 0==kState%2 then	--idle\n\
		if fLenth == 0 then\n\
			action:SetSlot(8);	--	 Idle     Idle  .\n\
		end\n\
	else				--action\n\
		if fLenth == 0 then\n\
			action:SetSlot(9)\n\
		end\n\
	end\n\
\n\
	Act_Mon_Melee_CastAni_AddEffect(actor,action,kState)\n\
\n\
	iNewState = kState\n\
\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_AddEffect(actor,action,kState)\n\
	local kAniName = action:GetSlotAnimName(kState)\n\
\n\
	for i=1,3 do	--3  \n\
		local lwName = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT\"..i, kAniName)\n\
		local iSlot = math.random(9999, 99999)\n\
		local fScale = 1.0\n\
		local szNode = \"char_root\"\n\
		if false==lwName:IsNil() then\n\
			local lwSlot = actor:GetAnimationInfoFromAniName(\"SLOT\"..i, kAniName)\n\
			if false==lwSlot:IsNil() then\n\
				iSlot = tonumber(lwSlot:GetStr())\n\
			end\n\
			local lwScale = actor:GetAnimationInfoFromAniName(\"SCALE\"..i, kAniName)\n\
			if false==lwScale:IsNil() then\n\
				fScale = tonumber(lwScale:GetStr())\n\
			end\n\
			local lwNode = actor:GetAnimationInfoFromAniName(\"EFFECT_NODE\"..i, kAniName)\n\
			if false==lwNode:IsNil() then\n\
				szNode = lwNode:GetStr()\n\
			end\n\
			--ODS(\"AddEffect Node:\"..szNode..\" Name:\"..lwName:GetStr()..\" Slot:\"..iSlot..\"\\n\", false, 1509)\n\
			actor:AttachParticleS(iSlot, szNode, lwName:GetStr(), fScale)\n\
			action:SetParamInt(10+action:GetParamInt(9), iSlot)	--.   \n\
			action:SetParamInt(9, action:GetParamInt(9)+1)\n\
		else\n\
			break\n\
		end\n\
	end\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_OnEnter(actor, action)\n\
	--ODS(\"Act_Mon_Melee_CastAni_OnEnter\\n\", false, 1509)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local iCastTime = action:GetAbil(AT_CAST_TIME)\n\
\n\
	action:SetParamFloat(1, iCastTime*0.001)\n\
\n\
	local iNum = actor:GetAnimationInfoFromAniName(\"CAST_ANI_NUM\", \"castani_01\"):GetStr()\n\
	if nil==iNum then\n\
		iNum=1\n\
	else\n\
		iNum = tonumber(iNum)\n\
	end\n\
\n\
	local fInter = (iCastTime*0.001)/iNum\n\
\n\
\n\
	action:SetParamFloat(2, fInter)		--\n\
	action:SetParamFloat(3, fInter)		-- \n\
	action:SetParamInt(9, 0)		--  ?\n\
\n\
	actor:ResetAnimation()\n\
\n\
	Act_Mon_Melee_CastAni_SetState(actor,action,0)\n\
\n\
	return true\n\
end\n\
function Act_Mon_Melee_CastAni_OnCastingCompleted(actor,action)\n\
	Act_Mon_Melee_CastAni_SetState(actor,action,8)\n\
	Act_Mon_Melee_Fire(actor,action)\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_OnUpdate(actor, accumTime, frameTime)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		local fInter = action:GetParamFloat(3)\n\
		fInter = fInter - frameTime\n\
\n\
		if iState%2 == 0 then\n\
			if actor:IsAnimationDone() then\n\
				iState = iState+1\n\
				Act_Mon_Melee_CastAni_SetState(actor,action,iState)\n\
			end\n\
		else\n\
			if fInter <= 0 then\n\
				fInter = fInter + action:GetParamFloat(2)\n\
				iState = iState+1\n\
				Act_Mon_Melee_CastAni_SetState(actor,action,iState)\n\
			end\n\
		end\n\
\n\
		action:SetParamFloat(3, fInter)\n\
\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Melee_CastAni_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Melee_CastAni_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_OnLeave(actor, action)\n\
	--ODS(\"Act_Mon_Melee_CastAni_OnLeave\\n\", false, 1509)\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
\n\
	local kCurAction = actor:GetAction()\n\
	if( CheckNil(nil==kCurAction) ) then return true end\n\
	if( CheckNil(kCurAction:IsNil()) ) then return true end\n\
\n\
	local iNo = kCurAction:GetParamInt(9)\n\
	if 0<iNo then\n\
		for i=0,iNo-1 do\n\
			--ODS(\"Detach : \"..kCurAction:GetParamInt(10+i)..\"\\n\", false, 1509)\n\
			actor:DetachFrom(kCurAction:GetParamInt(10+i))\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_Melee_CastAni_DoDamage(actor,action)\n\
	Act_Mon_Melee_DoDamage(actor,action)\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_OnEvent(actor,textKey)\n\
	return Act_Mon_Melee_OnEvent(actor,textKey)\n\
end\n\
\n\
function Act_Mon_Melee_CastAni_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_RangeAttack_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_RangeAttack_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
			return false\n\
		end		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_RangeAttack_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_RangeAttack_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_RangeAttack_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_RangeAttack_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_RangeAttack_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	if iProjectileIndex>0 and kProjectileID==nil then\n\
		return	nil\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
\n\
	local	fZ = actor:GetAnimationInfo(\"Z_FACTOR\")\n\
	if nil~=fZ and \"\"~=fZ then\n\
		kNewArrow:SetParamValue(\"Z_FACTOR\", fZ)\n\
	end\n\
\n\
	local	kSound = actor:GetAnimationInfo(\"ARRIVED_SOUND\")\n\
	if nil~=kSound and \"\"~=kSound then\n\
		kNewArrow:SetParamValue(\"ARRIVED_SOUND\", kSound)\n\
	end\n\
\n\
	local	kEffect = actor:GetAnimationInfo(\"ARRIVED_EFFECT\")\n\
	if nil~=kEffect and \"\"~=kEffect then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT\", kEffect)\n\
	end\n\
\n\
	local	kScale = actor:GetAnimationInfo(\"ARRIVED_EFFECT_SCALE\")\n\
	if nil~=kScale and \"\"~=kScale then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT_SCALE\", kScale)\n\
	end\n\
\n\
	local	kFactor = actor:GetAnimationInfo(\"PROJECTILE_QUAKE_FACTOR\")\n\
	if nil~=kFactor and \"\"~=kFactor then\n\
		kNewArrow:SetParamValue(\"QUAKE_FACTOR\", kFactor)\n\
	end\n\
	\n\
	local	kEndNode = actor:GetAnimationInfo(\"PROJECTILE_END_NODE\"..kAttachID)\n\
	if nil~=kEndNode and \"\"~=kEndNode then\n\
		kNewArrow:SetTargetEndNode(kEndNode)\n\
	end\n\
\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	return kNewArrow\n\
\n\
end\n\
\n\
function Act_Mon_RangeAttack_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_RangeAttack_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	action:SetParamInt(3,0)\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	\n\
	action:SetParam(9,\"none\")\n\
	local	kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
\n\
		local byPacketType = kPacket:PopByte()\n\
		local iCount = kPacket:PopInt()\n\
		\n\
		if 2==byPacketType then				---SSPT_SKILL_PACKET_GUID\n\
\n\
			local kGuid = kPacket:PopGuid()\n\
			if nil~=kGuid and false==kGuid:IsNil() then\n\
				action:SetParam(9,kGuid:GetString())\n\
			end\n\
\n\
		elseif 1==byPacketType then			---SSPT_SKILL_PACKET_POSITION\n\
\n\
			local kTargetPos = kPacket:PopPoint3()\n\
			if nil~=kTargetPos and false==kTargetPos:IsZero() then\n\
				action:SetParamAsPoint(9,kTargetPos)\n\
			end\n\
\n\
		end\n\
\n\
	end\n\
	\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_RangeAttack_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_RangeAttack_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_RangeAttack Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_RangeAttack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	local	iState = action:GetParamInt(0)\n\
	local	kParam1 = action:GetParam(1)	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if bIsBoomerang or action:GetParamInt(3) == 1 then\n\
\n\
			if kParam1 == \"end\" then\n\
				return	false\n\
			elseif kParam1 == \"wait_animdone\" then\n\
				if animDone == true then\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			elseif kParam1 == \"none\" then\n\
				if animDone and actor:GetAnimationLength(action:GetSlotAnimName(5)) ~= 0 then	--\n\
					action:SetSlot(5)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					action:SetParam(1, \"\")\n\
				end\n\
			end	\n\
			return	true\n\
		end\n\
		\n\
		if animDone == true then\n\
			if 2==iState then\n\
				if false==Act_Mon_RangeAttack_SetState(actor,action,\"RETURN\") then\n\
					return false\n\
				end\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if animDone then\n\
				Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		elseif iState == 1 and 0 == action:GetParamInt(21) then\n\
			action:SetParamInt(21,1)\n\
			local load = actor:GetAnimationInfo(\"PROJECTILE_LOAD\")\n\
			if nil~=load then\n\
				local	iProjectileIndex = 0	\n\
				while iProjectileIndex<5 do	\n\
					local	kArrow = Act_Mon_RangeAttack_LoadToWeapon(actor,action,iProjectileIndex)\n\
					if nil ~= kArrow and false == kArrow:IsNil() then\n\
						action:SetParamInt(10+iProjectileIndex, kArrow:GetUID())\n\
					end\n\
	\n\
					iProjectileIndex = iProjectileIndex + 1\n\
				end\n\
				action:SetParamInt(20, action:GetActionInstanceID())\n\
			end\n\
\n\
			local eff = actor:GetAnimationInfo(\"FIRE_EFFECT\") --   \n\
			if nil~=eff then\n\
				local node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil==node then\n\
					node = \"char_root\"\n\
				end\n\
				actor:AttachParticle(230, node, eff)\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_RangeAttack_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_RangeAttack_OnCleanUp(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if actor:GetAction():GetParamInt(4) == 1 then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
		actor:GetAction():SetParamInt(4,0)\n\
	end	\n\
\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	if nil~=action and false==action:IsNil() then\n\
		local actionid = action:GetParamInt(20)\n\
		for i=0,9 do \n\
			local uid = action:GetParamInt(10+i)\n\
			if 0 <= uid and 0==action:GetParamInt(30+i) then	--UID   \n\
				kProjectileMan:DeleteProjectileByUID(actor:GetPilotGuid(), actionid, uid) 			\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_RangeAttack_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_RangeAttack_OnLeave\\n\")\n\
	return true\n\
end\n\
function Act_Mon_RangeAttack_SwordReturn(actor,iActionInstanceID)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end	\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0)\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
			action:SetParam(1,\"end\")										-- \n\
		else\n\
			Act_Mon_RangeAttack_SetState(actor,action,\"RETURN\")				--\n\
			action:SetParam(1,\"wait_animdone\")								--  \n\
		end\n\
	\n\
	end\n\
\n\
end\n\
function Act_Mon_RangeAttack_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_RangeAttack_OnEvent AniName: \" .. kAction:GetCurrentSlotAnimName() .. \", textKey:\"..textKey..\"\\n\")	\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
	\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
		local	kDelay = tonumber(actor:GetAnimationInfo(\"PROJECTILE_DELAY\"))\n\
		if nil==kDelay then\n\
			kDelay = 0\n\
		end\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
\n\
		local kUseAtDistance = actor:GetAnimationInfo(\"USE_AT_DISTANCE\")\n\
		if nil~=kUseAtDistance and \"1\"==kUseAtDistance then\n\
			local iDistance = actor:GetAbil(AT_DISTANCE)\n\
			if 0 ~= iDistance then\n\
				iAttackRange = iDistance\n\
			end\n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan()\n\
		\n\
		local	iProjectileIndex = 0\n\
		local	iPentrationCount = kAction:GetAbil(AT_PENETRATION_COUNT);\n\
		\n\
		while iProjectileIndex<5 do\n\
		\n\
			ODS(\"iProjectileIndex : \"..iProjectileIndex..\"\\n\");\n\
			\n\
			local	kArrow = nil\n\
			local UID = kAction:GetParamInt(10+iProjectileIndex)\n\
			if 0<=UID then\n\
				kArrow = kProjectileMan:GetProjectile(actor:GetPilotGuid(), kAction:GetParamInt(20), UID)\n\
			else\n\
				kArrow = Act_Mon_RangeAttack_LoadToWeapon(actor,kAction,iProjectileIndex)\n\
			end\n\
			if kArrow == nil or kArrow:IsNil() then\n\
				break\n\
			end\n\
			\n\
			if bIsBoomerang then\n\
				kArrow:SetMultipleAttack(true)\n\
			end\n\
\n\
			-- \n\
			kArrow:SetPenetrationCount(iPentrationCount);--   \n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
			\n\
			local	targetobject = nil\n\
\n\
			if kArrow:IsNil() == false then\n\
			\n\
				local	kMovingDir = actor:GetLookingDir()	--    \n\
				WriteToConsole(\"________MovingDir : \" .. kMovingDir:GetX() .. \", \" .. kMovingDir:GetY() .. \", \" .. kMovingDir:GetZ() .. \"\\n\")\n\
				local	arrow_worldpos = kArrow:GetWorldPos()	--	 \n\
				\n\
				local	iTargetCount = kAction:GetTargetCount()\n\
				local	iTargetABVShapeIndex = 0\n\
				local	kActionTargetInfo = nil\n\
				if iTargetCount>0 then\n\
						--	  \n\
					local	kTargetGUID = kAction:GetTargetGUID(0)\n\
					iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0)\n\
					kActionTargetInfo = kAction:GetTargetInfo(0)\n\
					targetobject = g_pilotMan:FindPilot(kTargetGUID)\n\
					if targetobject:IsNil() == false then\n\
						local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex)\n\
						actor:LookAt(pt,true,true)\n\
					end						\n\
				end\n\
				\n\
				kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
				local	kSkillDef	= GetSkillDef(kArrow:GetParentActionNo())\n\
				local at = false\n\
				if false==kSkillDef:IsNil() then\n\
					at = kSkillDef:IsSkillAtt(SAT_CLIENT_CTRL_PROJECTILE)\n\
				end\n\
				\n\
				if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true or true == at then\n\
					--pkSkillDef->IsSkillAtt(SAT_CLIENT_CTRL_PROJECTILE) true\n\
					\n\
					local kEndNode = kArrow:GetTargetEndNode()\n\
					if nil~=kEndNode and \"\"~=kEndNode then\n\
						kMovingDir = actor:GetNodeWorldPos(kEndNode)\n\
					else\n\
						kMovingDir:Multiply(iAttackRange)\n\
						kMovingDir:Add(arrow_worldpos)\n\
					end\n\
\n\
					kArrow:SetTargetLoc(kMovingDir)\n\
				else\n\
				\n\
					ODS(\"kArrow:SetTargetObjectList(kAction:GetTargetList())	\\n\")\n\
				\n\
					kArrow:SetTargetObjectList(kAction:GetTargetList())	\n\
				end\n\
				\n\
				local kGuidStr = kAction:GetParam(9)\n\
				if nil~=kGuidStr and kGuidStr~=\"none\" then\n\
					local kGuid = GUID()\n\
					kGuid:Set(kGuidStr)\n\
					local target = g_pilotMan:FindPilot(kGuid)\n\
") + std::string("					if nil~=target and false == target:IsNil() then\n\
						kArrow:SetTargetGuidFromServer(kGuid)\n\
					end\n\
				end\n\
				\n\
				local kTargetPos = kAction:GetParamAsPoint(9)\n\
				if nil~=kTargetPos and false==kTargetPos:IsZero() then\n\
					kArrow:SetTargetLoc(kTargetPos)\n\
				end\n\
\n\
				local	kEndnode = actor:GetAnimationInfo(\"USE_END_NODE\")	--  ?\n\
				if kEndnode ~= nil then\n\
					local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
					if kTargetNodeID == nil then\n\
						kTargetNodeID = \"p_ef_heart\"\n\
					end\n\
					local weaponrot = actor:GetNodeRotateAxis(kTargetNodeID,2, true)\n\
					if false==weaponrot:IsZero() then\n\
						weaponrot:Multiply(-1)\n\
						local weaponpos = actor:GetNodeWorldPos(kTargetNodeID)\n\
						local weaponendpos = actor:GetNodeWorldPos(kEndnode)\n\
						local dir = Point3(weaponendpos:GetX() - weaponpos:GetX(), weaponendpos:GetY() - weaponpos:GetY(), weaponendpos:GetZ() - weaponpos:GetZ())\n\
						dir:Unitize()\n\
						if( CheckNil(g_world == nil) ) then return false end\n\
						if( CheckNil(g_world:IsNil()) ) then return false end\n\
						local TargetPos = g_world:ThrowRay(weaponpos,dir,500)	--   \n\
						if false==TargetPos:IsZero() then\n\
							kArrow:SetTargetLoc(TargetPos)\n\
						end\n\
					end\n\
				end\n\
				\n\
				-- local fZ = actor:GetAnimationInfo(\"Z_FACTOR\")\n\
				--if nil~=fZ or \"\"~=fZ then\n\
					--fZ = tonumber(fZ)\n\
					-- fZ = 10\n\
					-- kArrow:SetMovingType(1)\n\
					-- kArrow:SetParam_SinCurveLineType(fZ, 0)\n\
				--end\n\
\n\
				kArrow:DelayFire(kDelay*iProjectileIndex)\n\
				kAction:SetParamInt(30+iProjectileIndex, 1)\n\
				\n\
			else\n\
				\n\
				ODS(\"Arrow is nil\\n\")\n\
			\n\
			end\n\
			\n\
			iProjectileIndex=iProjectileIndex+1\n\
		\n\
		end\n\
		\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
\n\
	return	true\n\
end\n\
\n\
function Act_Mon_RangeAttack_OnTargetListModified(actor,action,bIsBefore)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
end") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Skill_Mon_WhirlWind_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Mon_WhirlWind_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	ODS(\"Skill_Mon_WhirlWind_OnEnter ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Skill_Mon_WhirlWind_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			action:SetSlot(1);	\n\
		end\n\
		\n\
		actor:ResetAnimation();\n\
		actor:PlayCurrentSlot();\n\
		\n\
	end\n\
	\n\
	--	 \n\
	if action:GetScriptParam(\"MOVE\")==\"TRUE\" then\n\
	\n\
		local	kTargetPos =  nil;\n\
		\n\
		if IsSingleMode() then\n\
			kTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ODS(\"[SkillError] Skill_Mon_WhirlWind_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
				return	false;\n\
			else\n\
				kTargetPos = Point3(0,0,0);\n\
				kTargetPos:SetX(kPacket:PopFloat());\n\
				kTargetPos:SetY(kPacket:PopFloat());\n\
				kTargetPos:SetZ(kPacket:PopFloat());\n\
			end\n\
			\n\
		end\n\
		\n\
		action:SetParamAsPoint(0,kTargetPos);\n\
		\n\
		local	kMoveDir = kTargetPos:_Subtract(actor:GetPos());\n\
		kMoveDir:SetZ(0);\n\
		kMoveDir:Unitize();\n\
		\n\
		action:SetParamAsPoint(1,kMoveDir);\n\
	\n\
	end	\n\
\n\
	action:SetParamInt(10,0)\n\
\n\
	return true\n\
end\n\
function Skill_Mon_WhirlWind_OnCastingCompleted(actor,action)	\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	ODS(\"Skill_Mon_WhirlWind_OnCastingCompleted\\n\");\n\
\n\
	action:SetSlot(2);\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	\n\
	Skill_Mon_WhirlWind_Fire(actor,action);\n\
	\n\
end\n\
function  Skill_Mon_WhirlWind_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
    ODS(\"Skill_Mon_WhirlWind_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
    end\n\
end\n\
\n\
function Skill_Mon_WhirlWind_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	--	  \n\
	action:SetParamFloat(0,g_world:GetAccumTime())	--	Rotation Start Time\n\
	action:SetParamFloat(1,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(2,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(3,actor:GetLookingDir():GetZ());\n\
	\n\
	action:SetParamInt(4,0);\n\
\n\
	local kRotSpeed	= actor:GetAnimationInfo(\"ROT_SPEED\")	\n\
	if nil==kRotSpeed or \"\"==kRotSpeed then\n\
		kRotSpeed = 3.0\n\
	else\n\
		kRotSpeed = tonumber(kRotSpeed)\n\
	end\n\
\n\
	action:SetParamFloat(6,kRotSpeed)\n\
	\n\
	local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
	if fireStartNode == nil then\n\
		fireStartNode = \"char_root\"\n\
	elseif fireStartNode == \"NONE\" then\n\
		return\n\
	end\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
	if fireEffect == nil then\n\
		fireEffect = \"e_m_Mahalka_skill_01_char_root\" \n\
	elseif fireEffect == \"NONE\" then\n\
		return\n\
	end					\n\
\n\
	actor:AttachParticle(581,fireStartNode,fireEffect);\n\
	\n\
--	ODS(\"Skill_Mon_WhirlWind_Fire OK. NODE : \" .. fireStartNode .. \" EFF : \" .. fireEffect ..  \"\\n\");\n\
end\n\
\n\
function Skill_Mon_WhirlWind_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	\n\
	ODS(\"Skill_Mon_WhirlWind_OnUpdate accumTime:\"..accumTime..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		local	bIsMove = action:GetScriptParam(\"MOVE\") == \"TRUE\";\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
\n\
		if 0 ~= action:GetParamInt(10) then\n\
			local anilen = actor:GetAnimationLength(action:GetSlotAnimName(3))\n\
			if 0 < anilen then	-- 		\n\
				if anilen < accumTime - action:GetParamFloat(11) then\n\
					return false\n\
				end\n\
			else\n\
				return false\n\
			end\n\
			return true\n\
		end\n\
\n\
		if bIsMove == false then\n\
		\n\
			local	fTotalTime = action:GetAbil(AT_MAINTENANCE_TIME)/1000.0;\n\
			\n\
			ODS(\"Skill_Mon_WhirlWind_OnUpdate fTotalTime:\"..fTotalTime..\"\\n\");\n\
			if fElapsedTime > fTotalTime then\n\
				return false\n\
			end\n\
			\n\
		else\n\
		\n\
			local	kMovingDir = action:GetParamAsPoint(1)\n\
			local	kMovingTarget = action:GetParamAsPoint(0)\n\
			local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/10000.0);\n\
			\n\
			kMovingDir:Multiply(fMoveSpeed)\n\
			\n\
			actor:SetMovingDelta(kMovingDir);		\n\
			\n\
			local	kCurrentPos = actor:GetPos()\n\
			local	kCurrentDir = kMovingTarget:_Subtract(kCurrentPos)\n\
			kCurrentDir:Unitize()\n\
			\n\
			local	fDot = kCurrentDir:Dot(kMovingDir)\n\
			if fDot<0 then\n\
					actor:DetachFrom(581)\n\
				if 0 < actor:GetAnimationLength(action:GetSlotAnimName(3)) then\n\
					action:SetParamInt(10,1)\n\
					action:SetParamFloat(11,accumTime)\n\
					action:SetSlot(3)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					return	true\n\
				else\n\
					return false\n\
				end\n\
			end\n\
		end\n\
\n\
		local kRotSpeed = action:GetParamFloat(6)	\n\
		actor:IncRotate(frameTime*kRotSpeed*460.0*3.141592/180.0);\n\
		\n\
		if IsSingleMode() then\n\
		\n\
			if action:GetParamInt(4) == 0 and fElapsedTime>0.5 then\n\
				Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);\n\
				action:SetParamInt(4,1);\n\
			end\n\
			\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if action:GetCurrentSlot() == 0 then\n\
			if actor:IsAnimationDone() then\n\
				action:SetSlot(1)\n\
				actor:ResetAnimation();\n\
				actor:PlayCurrentSlot();				\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Skill_Mon_WhirlWind_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	\n\
	ODS(\"Skill_Mon_WhirlWind_OnUpdate OK\\n\")\n\
	return true\n\
end\n\
\n\
function Skill_Mon_WhirlWind_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	actor:DetachFrom(581)\n\
end\n\
\n\
function Skill_Mon_WhirlWind_OnLeave(actor, action)\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
function Skill_Mon_JumpDownCrash_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_JumpDownCrash_OnEnter ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	actor:FreeMove(true);	\n\
	actor:StopJump();\n\
	actor:SetNoWalkingTarget(false);\n\
	actor:ResetAnimation();\n\
	\n\
	\n\
	--	attack target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Skill_Mon_JumpDownCrash_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
			ptTargetPos = actor:GetPos()\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat()+30);\n\
			ptTargetPos = g_world:ThrowRay(ptTargetPos,Point3(0,0,-1),500)\n\
			ptTargetPos:SetZ(ptTargetPos:GetZ()+25)\n\
			ODS(\"Skill_Mon_JumpDownCrash_OnEnter CurrentPos : \"..actor:GetPos():GetX()..\",\"..actor:GetPos():GetY()..\",\"..actor:GetPos():GetZ()..\"\\n\");\n\
			ODS(\"Skill_Mon_JumpDownCrash_OnEnter  TargetPos : \"..ptTargetPos:GetX()..\",\"..ptTargetPos:GetY()..\",\"..ptTargetPos:GetZ()..\"\\n\");\n\
		end\n\
		\n\
	end\n\
	\n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
\n\
	local kScale = 100.0\n\
	if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
		kScale = kSkillDef:GetAbil(AT_2ND_AREA_PARAM1)*2	--\n\
		if 0==kScale then\n\
			kScale = 100.0\n\
		end\n\
	end\n\
\n\
	kScale = kScale*0.01\n\
\n\
	local Effect = actor:GetAnimationInfoFromAction(\"GROUND_EFFECT\",action)\n\
	if nil==Effect or \"\"==Effect then\n\
		Effect = \"ef_dmg_ground_01\"\n\
	end	\n\
\n\
	if \"NONE\"~=Effect then\n\
		actor:AttachParticleToPointS(81190,ptTargetPos,Effect,kScale)\n\
	end\n\
	\n\
	-- Look at targetpos\n\
	actor:LookAt(ptTargetPos,true,false);\n\
	\n\
	-- Save the targetpos\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
\n\
	action:SetParamInt(0,0)	--	State\n\
	action:SetParamFloat(1,g_world:GetAccumTime());	--	Start Time\n\
	action:SetParamAsPoint(1,actor:GetPos());	--	Start Pos	\n\
	return true\n\
end\n\
\n\
\n\
function Skill_Mon_JumpDownCrash_OnCastingCompleted(actor,action)	\n\
	ODS(\"Skill_Mon_JumpDownCrash_OnCastingCompleted\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(1);\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	\n\
	Skill_Mon_JumpDownCrash_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	-- now, start to fly to the sky!!	\n\
\n\
	actor:SetCanHit(false);\n\
\n\
	local	fFlyHeight = 300\n\
	\n\
	Skill_Mon_JumpDownCrash_SetState(actor,action,3)\n\
\n\
	local	kTargetPos = action:GetParamAsPoint(0)\n\
	local	kMovingVec = Point3(0,0,1)\n\
	local	fMovingDist = fFlyHeight;\n\
	kMovingVec:Multiply(fMovingDist);\n\
	\n\
	local	kNewPos = kTargetPos:_Add(kMovingVec);\n\
	\n\
	actor:SetTranslate(kNewPos);\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_SetState(actor,action,iState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParamInt(0,iState);\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
\n\
	if iState == 4 then\n\
	\n\
		actor:DetachFrom(81190);\n\
		local fireEffect = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT\", action)\n\
		if nil==fireEffect or \"\"==fireEffect then\n\
			fireEffect = \"ef_sambhava_skill_03_char_root\"\n\
		end\n\
		actor:AttachParticleToPoint(28713,actor:GetPos(),fireEffect);\n\
\n\
		QuakeCamera(0.5,5,0,0.1,5);\n\
		actor:SetCanHit(true)\n\
		\n\
		local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
		if nil~=kSoundID and kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end	\n\
\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
	end	\n\
\n\
end\n\
\n\
\n\
function Skill_Mon_JumpDownCrash_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	fTotalFlyToSkyTime = 0.1\n\
	local	iState = action:GetParamInt(0);\n\
	local	fFlyHeight = 300\n\
	local	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
	\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if iState == 3 then -- fly to the ground\n\
		\n\
			local	fRate  = fElapsedTime/fTotalFlyToSkyTime;\n\
			\n\
			if fRate>1.0 then\n\
				fRate = 1.0\n\
			end\n\
			\n\
			local	kStartPos = action:GetParamAsPoint(0)\n\
			local	kMovingVec = Point3(0,0,1)\n\
			local	fMovingDist = (1.0 - fRate)*fFlyHeight;\n\
			kMovingVec:Multiply(fMovingDist);\n\
			\n\
			local	kNewPos = kStartPos:_Add(kMovingVec);\n\
			\n\
			actor:SetTranslate(kNewPos);\n\
			\n\
			if fRate == 1.0 then\n\
				Skill_Mon_JumpDownCrash_SetState(actor,action,4)\n\
			end\n\
		elseif iState == 4 then -- stay with the pose while sometimes\n\
			if fElapsedTime >= 1.0 then\n\
				Skill_Mon_JumpDownCrash_SetState(actor,action,5)\n\
				\n\
				actor:PlayNext();		\n\
			end\n\
		elseif iState == 5 then -- now, get up, and finish the skill\n\
			local	kTargetPos = action:GetParamAsPoint(0)\n\
			actor:SetTranslate(kTargetPos);		\n\
			\n\
			if actor:IsAnimationDone() then\n\
			\n\
				return	false;\n\
			\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then	--	wait for 'fly' text key event\n\
		\n\
		elseif iState == 1 then	--	fly to the sky\n\
		\n\
			local	fRate  = fElapsedTime/fTotalFlyToSkyTime;\n\
			\n\
			if fRate>1.0 then\n\
				fRate = 1.0\n\
			end\n\
			\n\
			local	kStartPos = action:GetParamAsPoint(1)\n\
			local	kMovingVec = Point3(0,0,1)\n\
			local	fMovingDist = fRate*fFlyHeight;\n\
			kMovingVec:Multiply(fMovingDist);\n\
			\n\
			local	kNewPos = kStartPos:_Add(kMovingVec);\n\
			\n\
			actor:SetTranslate(kNewPos);\n\
			\n\
			if fRate == 1.0 then\n\
			\n\
				Skill_Mon_JumpDownCrash_SetState(actor,action,2)\n\
				actor:PlayNext();\n\
			\n\
			end\n\
		\n\
		elseif iState == 2 then -- Wait for the packet from server\n\
		\n\
			if IsSingleMode() then\n\
			\n\
				if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
\n\
					action:SetActionParam(AP_FIRE);\n\
					Skill_Mon_JumpDownCrash_OnCastingCompleted(actor,action)\n\
				\n\
				end\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end	\n\
	return true\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	kAction = actor:GetAction()\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetParamInt(0) <4 then\n\
		local	kTargetPos = kAction:GetParamAsPoint(0)\n\
		actor:SetTranslate(kTargetPos);\n\
	end\n\
	\n\
	actor:DetachFrom(81190);\n\
	actor:SetCanHit(true);\n\
	actor:FreeMove(false);\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_OnLeave(actor, action)\n\
	\n\
	return	true;\n\
	\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_OnEvent(actor, textkey)\n\
		\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_JumpDownCrash_OnEvent textkey:\"..textkey..\"\\n\");\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetParamInt(0) == 0 then\n\
		if textkey == \"fly\" or textkey == \"end\" then\n\
		\n\
			QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
			, g_fMeleeDropQuakeValue[2]\n\
			, g_fMeleeDropQuakeValue[3]\n\
			, g_fMeleeDropQuakeValue[4]\n\
			, g_fMeleeDropQuakeValue[5])	\n\
			\n\
			Skill_Mon_JumpDownCrash_SetState(actor,action,1)\n\
			\n\
		end\n\
	end\n\
	\n\
	return	true;\n\
	\n\
end\n\
\n\
function Act_Mon_JumpDownCrash_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
function Skill_Mon_JumpDownCrash02_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_JumpDownCrash02_OnEnter ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	actor:FreeMove(true);	\n\
	actor:StopJump();\n\
	actor:SetNoWalkingTarget(false);\n\
	actor:ResetAnimation();\n\
	\n\
	\n\
	--	attack target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Skill_Mon_JumpDownCrash02_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
			ptTargetPos = actor:GetPos()\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat()+30);\n\
			ptTargetPos = g_world:ThrowRay(ptTargetPos,Point3(0,0,-1),500)\n\
			ptTargetPos:SetZ(ptTargetPos:GetZ()+25)\n\
			ODS(\"Skill_Mon_JumpDownCrash02_OnEnter CurrentPos : \"..actor:GetPos():GetX()..\",\"..actor:GetPos():GetY()..\",\"..actor:GetPos():GetZ()..\"\\n\");\n\
			ODS(\"Skill_Mon_JumpDownCrash02_OnEnter  TargetPos : \"..ptTargetPos:GetX()..\",\"..ptTargetPos:GetY()..\",\"..ptTargetPos:GetZ()..\"\\n\");\n\
		end\n\
		\n\
	end\n\
	\n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
\n\
	local kScale = 100.0\n\
	if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
		kScale = kSkillDef:GetAbil(AT_2ND_AREA_PARAM1)*2	--\n\
		if 0==kScale then\n\
			kScale = 100.0\n\
		end\n\
	end\n\
\n\
	kScale = kScale*0.01\n\
\n\
	local Effect = actor:GetAnimationInfoFromAction(\"GROUND_EFFECT\",action)\n\
	if nil==Effect or \"\"==Effect then\n\
		Effect = \"ef_Blizzard_mon_01\"\n\
	end	\n\
\n\
	actor:AttachParticleToPointS(81190,ptTargetPos,Effect,kScale)\n\
	\n\
	-- Look at targetpos\n\
	actor:LookAt(ptTargetPos,true,false);\n\
	\n\
	-- Save the targetpos\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
\n\
	action:SetParamInt(0,0)	--	State\n\
	action:SetParamFloat(1,g_world:GetAccumTime());	--	Start Time\n\
	action:SetParamAsPoint(1,actor:GetPos());	--	Start Pos	\n\
	return true\n\
end\n\
\n\
\n\
function Skill_Mon_JumpDownCrash02_OnCastingCompleted(actor,action)	\n\
	ODS(\"Skill_Mon_JumpDownCrash02_OnCastingCompleted\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(1);\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	\n\
	Skill_Mon_JumpDownCrash02_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash02_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	-- now, start to fly to the sky!!	\n\
\n\
	actor:SetCanHit(false);\n\
\n\
	local	fFlyHeight = 300\n\
	\n\
	Skill_Mon_JumpDownCrash02_SetState(actor,action,3)\n\
\n\
	local	kTargetPos = action:GetParamAsPoint(0)\n\
	local	kMovingVec = Point3(0,0,1)\n\
	local	fMovingDist = fFlyHeight;\n\
	kMovingVec:Multiply(fMovingDist);\n\
	\n\
	local	kNewPos = kTargetPos:_Add(kMovingVec);\n\
	\n\
	actor:SetTranslate(kNewPos);\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash02_SetState(actor,action,iState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParamInt(0,iState);\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
\n\
	if iState == 4 then\n\
	\n\
		actor:DetachFrom(81190);\n\
		local fireEffect = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT\", action)\n\
		if nil==fireEffect or \"\"==fireEffect then\n\
			fireEffect = \"ef_monster_die_kung_03_ice\"\n\
		end\n\
		actor:AttachParticleToPoint(28713,actor:GetPos(),fireEffect);\n\
\n\
		QuakeCamera(0.5,5,0,0.1,5);\n\
		actor:SetCanHit(true)\n\
		\n\
		local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
		if nil~=kSoundID and kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end	\n\
\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
	end	\n\
\n\
end\n\
\n\
\n\
function Skill_Mon_JumpDownCrash02_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	fTotalFlyToSkyTime = 0.1\n\
	local	iState = action:GetParamInt(0);\n\
	local	fFlyHeight = 300\n\
	local	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
	\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if iState == 3 then -- fly to the ground\n\
		\n\
			local	fRate  = fElapsedTime/fTotalFlyToSkyTime;\n\
			\n\
			if fRate>1.0 then\n\
				fRate = 1.0\n\
			end\n\
			\n\
			local	kStartPos = action:GetParamAsPoint(0)\n\
			local	kMovingVec = Point3(0,0,1)\n\
			local	fMovingDist = (1.0 - fRate)*fFlyHeight;\n\
			kMovingVec:Multiply(fMovingDist);\n\
			\n\
			local	kNewPos = kStartPos:_Add(kMovingVec);\n\
			\n\
			actor:SetTranslate(kNewPos);\n\
			\n\
			if fRate == 1.0 then\n\
				Skill_Mon_JumpDownCrash02_SetState(actor,action,4)\n\
			end\n\
		elseif iState == 4 then -- stay with the pose while sometimes\n\
			if fElapsedTime >= 1.0 then\n\
				Skill_Mon_JumpDownCrash02_SetState(actor,action,5)\n\
				\n\
				actor:PlayNext();		\n\
			end\n\
		elseif iState == 5 then -- now, get up, and finish the skill\n\
			local	kTargetPos = action:GetParamAsPoint(0)\n\
			actor:SetTranslate(kTargetPos);		\n\
			\n\
			if actor:IsAnimationDone() then\n\
			\n\
				return	false;\n\
			\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then	--	wait for 'fly' text key event\n\
		\n\
		elseif iState == 1 then	--	fly to the sky\n\
		\n\
			local	fRate  = fElapsedTime/fTotalFlyToSkyTime;\n\
			\n\
			if fRate>1.0 then\n\
				fRate = 1.0\n\
			end\n\
			\n\
			local	kStartPos = action:GetParamAsPoint(1)\n\
			local	kMovingVec = Point3(0,0,1)\n\
			local	fMovingDist = fRate*fFlyHeight;\n\
			kMovingVec:Multiply(fMovingDist);\n\
			\n\
			local	kNewPos = kStartPos:_Add(kMovingVec);\n\
			\n\
			actor:SetTranslate(kNewPos);\n\
			\n\
			if fRate == 1.0 then\n\
			\n\
				Skill_Mon_JumpDownCrash02_SetState(actor,action,2)\n\
				actor:PlayNext();\n\
			\n\
			end\n\
		\n\
		elseif iState == 2 then -- Wait for the packet from server\n\
		\n\
			if IsSingleMode() then\n\
			\n\
				if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
\n\
					action:SetActionParam(AP_FIRE);\n\
					Skill_Mon_JumpDownCrash02_OnCastingCompleted(actor,action)\n\
				\n\
				end\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end	\n\
	return true\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash02_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	kAction = actor:GetAction()\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetParamInt(0) <4 then\n\
		local	kTargetPos = kAction:GetParamAsPoint(0)\n\
		actor:SetTranslate(kTargetPos);\n\
	end\n\
	\n\
	actor:DetachFrom(81190);\n\
	actor:SetCanHit(true);\n\
	actor:FreeMove(false);\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash02_OnLeave(actor, action)\n\
	\n\
	return	true;\n\
	\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash02_OnEvent(actor, textkey)\n\
		\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_JumpDownCrash02_OnEvent textkey:\"..textkey..\"\\n\");\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetParamInt(0) == 0 then\n\
		if textkey == \"fly\" or textkey == \"end\" then\n\
		\n\
			QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
			, g_fMeleeDropQuakeValue[2]\n\
			, g_fMeleeDropQuakeValue[3]\n\
			, g_fMeleeDropQuakeValue[4]\n\
			, g_fMeleeDropQuakeValue[5])	\n\
			\n\
			Skill_Mon_JumpDownCrash02_SetState(actor,action,1)\n\
			\n\
		end\n\
	end\n\
	\n\
	return	true;\n\
	\n\
end\n\
\n\
function Act_Mon_JumpDownCrash02_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function FlyHeight(action)	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	return action:GetAbil(AT_JUMP_HEIGHT)\n\
end\n\
\n\
-- skill\n\
function Skill_Mon_JumpDownCrash_Diag_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_JumpDownCrash_Diag_OnEnter ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	actor:FreeMove(true);	\n\
	actor:StopJump();\n\
	actor:SetNoWalkingTarget(false);\n\
	actor:ResetAnimation();\n\
	\n\
	\n\
	--	attack target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Skill_Mon_JumpDownCrash_Diag_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
			ptTargetPos = actor:GetPos()\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat()+30);\n\
			ptTargetPos = g_world:ThrowRay(ptTargetPos,Point3(0,0,-1),500)\n\
			ptTargetPos:SetZ(ptTargetPos:GetZ()+25)\n\
			ODS(\"Skill_Mon_JumpDownCrash_Diag_OnEnter CurrentPos : \"..actor:GetPos():GetX()..\",\"..actor:GetPos():GetY()..\",\"..actor:GetPos():GetZ()..\"\\n\");\n\
			ODS(\"Skill_Mon_JumpDownCrash_Diag_OnEnter  TargetPos : \"..ptTargetPos:GetX()..\",\"..ptTargetPos:GetY()..\",\"..ptTargetPos:GetZ()..\"\\n\");\n\
		end\n\
		\n\
	end\n\
	\n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
\n\
	local kScale = 100.0\n\
	if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
		kScale = kSkillDef:GetAbil(AT_2ND_AREA_PARAM1)*2	--.   \n\
		if 0==kScale then\n\
			kScale = action:GetSkillRange(0, actor)--kSkillDef:GetAbil(AT_2ND_AREA_PARAM1)*2	--. \n\
			if 0==kScale then\n\
				kScale = 100.0\n\
			end\n\
		end\n\
	end\n\
\n\
	kScale = kScale*0.01\n\
\n\
	local Effect = actor:GetAnimationInfoFromAction(\"GROUND_EFFECT\",action)\n\
	if nil==Effect or \"\"==Effect then\n\
		Effect = \"ef_Blizzard_mon_01\"\n\
	end\n\
\n\
	if \"NONE\"~=Effect then\n\
		local EffectScale = actor:GetAnimationInfoFromAction(\"GROUND_EFFECT_SCALE\",action)\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1.0\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
	\n\
		actor:AttachParticleToPointS(81190,ptTargetPos,Effect,kScale*EffectScale)\n\
	end\n\
	\n\
	-- Look at targetpos\n\
	actor:LookAt(ptTargetPos,true,false);\n\
	\n\
	-- Save the targetpos\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
\n\
	if actor:HaveAnimationTextKey(\"fly\",action:GetSlotAnimName(0)) then\n\
		action:SetParamInt(0,0)	--	State\n\
	else\n\
		action:SetParamInt(0,1)	--	State\n\
	end\n\
	\n\
	\n\
	action:SetParamFloat(1,g_world:GetAccumTime());	--	Start Time\n\
	action:SetParamAsPoint(1,actor:GetPos());	--	Start Pos	\n\
\n\
	local ptNow = actor:GetPos()\n\
	ptNow:SetZ(ptNow:GetZ()+FlyHeight(action))\n\
	local Dist = ptTargetPos:Distance(ptNow)\n\
	action:SetParamFloat(3, Dist)\n\
	local Dir = ptTargetPos:_Subtract(ptNow)\n\
	Dir:Unitize()\n\
	action:SetParamAsPoint(3, Dir)	-- \n\
\n\
	local CastTime = actor:GetAnimationInfoFromAction(\"IS_CAST_TIME\",action)\n\
	if nil==CastTime or \"\"==CastTime or \"FALSE\"==CastTime then\n\
		fTotalFlyToSkyTime = actor:GetAnimationLength(action:GetSlotAnimName(0))\n\
	else\n\
		fTotalFlyToSkyTime = action:GetAbil(AT_CAST_TIME) / 1000\n\
	end\n\
	\n\
	action:SetParamFloat(5, fTotalFlyToSkyTime)\n\
	return true\n\
end\n\
\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_OnCastingCompleted(actor,action)	\n\
	ODS(\"Skill_Mon_JumpDownCrash_Diag_OnCastingCompleted\\n\");\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(1);\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	\n\
	action:SetParamFloat(5, 0.1)\n\
\n\
	Skill_Mon_JumpDownCrash_Diag_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	-- now, start to fly to the sky!!	\n\
\n\
	actor:SetCanHit(false);\n\
	\n\
	Skill_Mon_JumpDownCrash_Diag_SetState(actor,action,3)\n\
\n\
	local	kTargetPos = action:GetParamAsPoint(1)\n\
	kTargetPos:SetZ(kTargetPos:GetZ()+FlyHeight(action))\n\
	actor:SetTranslate(kTargetPos);\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_SetState(actor,action,iState)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParamInt(0,iState);\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
\n\
	if iState == 4 then\n\
	\n\
		actor:DetachFrom(81190);\n\
		local fireEffect = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT\", action)\n\
		if nil==fireEffect or \"\"==fireEffect then\n\
			fireEffect = \"ef_Blizzard_mon_02\"\n\
		end\n\
		if \"NONE\"~=fireEffect then\n\
			actor:AttachParticleToPoint(28713,actor:GetPos(),fireEffect);\n\
		end\n\
\n\
		QuakeCamera(0.5,5,0,0.1,5);\n\
		actor:SetCanHit(true)\n\
		\n\
		local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
		if nil~=kSoundID and kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end	\n\
\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
	elseif iState == 5 then\n\
		action:SetSlot(2);\n\
		actor:PlayCurrentSlot();\n\
	end	\n\
\n\
end\n\
\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	fTotalFlyToSkyTime = action:GetParamFloat(5)\n\
	local	iState = action:GetParamInt(0);\n\
	local	fFlyHeight = FlyHeight(action)\n\
	local	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
	\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if iState == 3 then -- fly to the ground\n\
		\n\
			local	fRate  = fElapsedTime/fTotalFlyToSkyTime;\n\
			\n\
			if fRate>1.0 then\n\
				fRate = 1.0\n\
			end\n\
\n\
			local	kStartPos = action:GetParamAsPoint(1)\n\
			kStartPos:SetZ(kStartPos:GetZ()+fFlyHeight)\n\
			local	kMovingVec = action:GetParamAsPoint(3)\n\
			local	fMovingDist = (fRate)*action:GetParamFloat(3);\n\
			kMovingVec:Multiply(fMovingDist);\n\
			\n\
			local	kNewPos = kStartPos:_Add(kMovingVec);\n\
			\n\
			actor:SetTranslate(kNewPos);\n\
			\n\
			if fRate == 1.0 then\n\
				Skill_Mon_JumpDownCrash_Diag_SetState(actor,action,4)\n\
			end\n\
		elseif iState == 4 then -- stay with the pose while sometimes\n\
			local delay_down = actor:GetAnimationInfo(\"DELAY_DOWN\")\n\
			if nil==delay_down then\n\
				delay_down = 0\n\
			else\n\
				delay_down = tonumber(delay_down) / 1000\n\
			end\n\
\n\
			if fElapsedTime >= delay_down then\n\
				Skill_Mon_JumpDownCrash_Diag_SetState(actor,action,5)\n\
			end\n\
		elseif iState == 5 then -- now, get up, and finish the skill\n\
			local	kTargetPos = action:GetParamAsPoint(0)\n\
			actor:SetTranslate(kTargetPos);		\n\
			\n\
			if actor:IsAnimationDone() then\n\
			\n\
				return	false;\n\
			\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then	--	wait for 'fly' text key event\n\
\n\
		elseif iState == 1 then	--	fly to the sky\n\
\n\
			local	fRate  = fElapsedTime/fTotalFlyToSkyTime;\n\
			if fRate > 1.0 then\n\
			\n\
				Skill_Mon_JumpDownCrash_Diag_SetState(actor,action,2)\n\
				actor:PlayNext();\n\
			\n\
			else\n\
			\n\
				local	kStartPos = action:GetParamAsPoint(1)\n\
				local	kMovingVec = Point3(0,0,1)\n\
				local	fMovingDist = fRate*fFlyHeight;\n\
				kMovingVec:Multiply(fMovingDist);\n\
				\n\
				local	kNewPos = kStartPos:_Add(kMovingVec);\n\
				\n\
				actor:SetTranslate(kNewPos);\n\
\n\
			end\n\
		\n\
		elseif iState == 2 then -- Wait for the packet from server\n\
		\n\
			if IsSingleMode() then\n\
			\n\
				if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
\n\
					action:SetActionParam(AP_FIRE);\n\
					Skill_Mon_JumpDownCrash_Diag_OnCastingCompleted(actor,action)\n\
				\n\
				end\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end	\n\
	return true\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	kAction = actor:GetAction()\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetParamInt(0) <4 then\n\
		local	kTargetPos = kAction:GetParamAsPoint(0)\n\
		actor:SetTranslate(kTargetPos);\n\
	end\n\
	\n\
	actor:DetachFrom(81190);\n\
	actor:SetCanHit(true);\n\
	actor:FreeMove(false);\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_OnLeave(actor, action)\n\
	\n\
	return	true;\n\
	\n\
end\n\
\n\
function Skill_Mon_JumpDownCrash_Diag_OnEvent(actor, textkey)\n\
		\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_JumpDownCrash_Diag_OnEvent textkey:\"..textkey..\"\\n\");\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetParamInt(0) == 0 then\n\
		if textkey == \"fly\" then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			action:SetParamFloat(1,g_world:GetAccumTime())\n\
		end\n\
\n\
		if textkey == \"fly\" or textkey == \"end\" then\n\
		\n\
			QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
			, g_fMeleeDropQuakeValue[2]\n\
			, g_fMeleeDropQuakeValue[3]\n\
			, g_fMeleeDropQuakeValue[4]\n\
			, g_fMeleeDropQuakeValue[5])	\n\
			\n\
			Skill_Mon_JumpDownCrash_Diag_SetState(actor,action,1)\n\
			\n\
		end\n\
	end\n\
	\n\
	return	true;\n\
	\n\
end\n\
\n\
function Act_Mon_JumpDownCrash_Diag_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
function Skill_Dash_Attack_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	--ODS(\"actor:GetAction():GetID():\"..actor:GetAction():GetID()..\"\\n\",false, 3851)\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		if kCurAction:GetID() ~= \"a_dash\" then\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then\n\
			return	false;\n\
	end\n\
\n\
	return true;\n\
	\n\
end\n\
\n\
function Skill_Dash_Attack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    --ODS(\"Skill_Dash_Attack_OnEnter\\n\",false, 3851)\n\
    \n\
	action:SetParam(2,\"\");\n\
	\n\
	actor:FindPathNormal()		\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	local	kActorID = actor:GetID();\n\
	if kActorID == \"c_magician_male\" or kActorID == \"c_magician_female\" then\n\
		actor:AttachParticle(10,\"char_root\",\"ef_mag_dash_attk_char_root\");	\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	return	true;\n\
end\n\
function Skill_Dash_Attack_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	--ODS(\"Skill_Dash_Attack_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\",false, 3851)\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
	\n\
	local	kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Dash_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    --ODS(\"Skill_Dash_Attack_OnUpdate\\n\");\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	actor:FindPathNormal()		\n\
	\n\
	local fAccel = -2000 * frameTime;\n\
	local fVelocity = action:GetParamFloat(1);\n\
\n\
	local kNewPos = actor:GetPos();\n\
	local kOldPos = action:GetParamAsPoint(7);\n\
	kOldPos:SetZ(0)\n\
	kNewPos:SetZ(0); --Z  .     \n\
\n\
	local fDistance = kNewPos:Distance(kOldPos);\n\
	local fMaxDistance = action:GetParamFloat(8);\n\
\n\
	--   \n\
	if 0.0 < fDistance then\n\
		--  \n\
		local fDistance2 = fMaxDistance - fDistance;\n\
\n\
		--     \n\
		--       .\n\
		local kDirection = kNewPos:_Subtract(kOldPos);\n\
		kDirection:Unitize();\n\
		kDirection:Multiply(fVelocity * frameTime);\n\
		kDirection:Add(kNewPos);\n\
\n\
		--    \n\
		local fDistance3 = kDirection:Distance(kOldPos);\n\
\n\
		--      \n\
		if fMaxDistance - fDistance3 < 0 then\n\
			--fVelocity   .				\n\
			fVelocity = fDistance2 / frameTime;\n\
		end\n\
	end\n\
	\n\
--	ODS(\"__________Dash Attack Velocity \" .. fVelocity .. \"\\n\")\n\
\n\
	if fVelocity>0 then\n\
	\n\
		local kMovingDir = actor:GetLookingDir()\n\
--		ODS(\"__________Dash Attack Looking Dir : \" .. kMovingDir:GetX() .. \", \" .. kMovingDir:GetY() .. \", \" .. kMovingDir:GetZ() .. \"\\n\")\n\
		kMovingDir:Multiply(fVelocity);\n\
		\n\
		actor:SetMovingDelta(kMovingDir);\n\
		\n\
		fVelocity = fVelocity+fAccel;\n\
		action:SetParamFloat(1,fVelocity);\n\
		\n\
	else \n\
		\n\
		if actor:IsAnimationDone() == true then\n\
			action:SetParam(2,\"end\");\n\
			return	false;					\n\
		end\n\
	\n\
	end\n\
	\n\
\n\
	return	true;\n\
end\n\
function Skill_Dash_Attack_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:EndBodyTrail();\n\
	return	true;\n\
end\n\
\n\
function Skill_Dash_Attack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return	true;\n\
	end\n\
\n\
	if kCurAction:GetParam(2) == \"end\" then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
\n\
	return	false;\n\
end\n\
function Skill_Dash_Attack_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
        if action:GetParam(3) == \"HIT\"  then\n\
            --  hit  \n\
            --    .\n\
           SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Dash_Attack_OnEvent(actor,textKey,seqID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
\n\
		if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then			\n\
			actor:AttachParticle(31,\"char_root\",\"ef_fig_dash_attk_01_char_root\");\n\
		elseif  actor:GetPilot():GetBaseClassID() == CT_THIEF and false == actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") and false == actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
			actor:AttachParticle(31,\"char_root\",\"ef_thi_dash_attk_01_char_root\");\n\
		elseif actor:GetPilot():GetBaseClassID() == CT_ARCHER then\n\
			actor:AttachParticle(31,\"char_root\",\"ef_arc_dash_attk_01_char_root\");	\n\
		elseif actor:GetPilot():GetBaseClassID() == CT_SHAMAN then\n\
			actor:AttachParticle(31,\"char_root\",\"ef_fig_dash_attk_01_char_root\");			\n\
		end		\n\
	\n\
		local	kAction = actor:GetAction();\n\
		\n\
		CheckNil(nil==kAction);\n\
		CheckNil(kAction:IsNil());\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
		        \n\
					Actor_PC_Base_DoDefaultMeleeAttack(actor,actor:GetAction(),g_fDashAttackFreezeTime);\n\
					Skill_Dash_Attack_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
		        	kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		            \n\
				end			\n\
			\n\
			end	\n\
		end\n\
		\n\
		kAction:SetParam(3,\"HIT\");\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Dash_Attack_OnCastingCompleted(actor,action)\n\
end") );
	m_kContLuaText.push_back(std::string("function Skill_Melee_Charge_Attack_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then		--    .\n\
		return	false;\n\
	end\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_Dancer\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Fig\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Mag\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Arc\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Thi\")then\n\
		return false\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_Melee_Charge_Attack_OnCastingCompleted(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1);\n\
	if actor:IsMyActor() == false then\n\
		Skill_Melee_Charge_Attack_Fire(actor,action);\n\
	end\n\
		\n\
end\n\
function Skill_Melee_Charge_Attack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(1,0);\n\
	action:SetParamInt(5,0);\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
		\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_Dancer\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Fig\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Mag\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Arc\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Thi\")then\n\
		return false\n\
	end\n\
	\n\
	if( IsAbleSubPlayerMeleeAttack2(actor) ) then\n\
		TryMustChangeSubPlayerAction( actor, \"a_twin_charge_shot1_s\", action:GetDirection() )\n\
	end\n\
	--actor:StartWeaponTrail();\n\
	\n\
	action:SetAutoBroadCastWhenCastingCompleted(false);\n\
	action:SetParamInt(3,0);\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_fChargeFocusFilterValue[2]\n\
		, g_fChargeFocusFilterValue[3]\n\
		, g_fChargeFocusFilterValue[4]\n\
		,true\n\
		,true)\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
   return true\n\
end\n\
function Skill_Melee_Charge_Attack_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(1,1);\n\
\n\
	local iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
	\n\
	actor:PlayNext();\n\
	\n\
	local	kActorID = actor:GetID();\n\
	\n\
	if iBaseClassID == CT_THIEF then\n\
		actor:AttachParticle(10,\"p_ef_center\",\"ef_thi_charge_01_result\");			\n\
	elseif iBaseClassID == CT_FIGHTER then\n\
		actor:AttachParticle(10,\"p_ef_center\",\"e_fighter_charge_02\");			\n\
	elseif iBaseClassID == CT_DOUBLE_FIGHTER then\n\
		local kSubActor = actor:GetSubPlayer()\n\
		if( false == kSubActor:IsNil() ) then\n\
			local kSubActorAction = kSubActor:GetAction()\n\
			if( false == kSubActorAction:IsNil() ) then \n\
				if( \"a_twin_charge_shot1_s\"== kSubActorAction:GetID() ) then 				\n\
					TryMustChangeSubPlayerAction( actor, \"a_twin_charge_shot2_s\", action:GetDirection() )\n\
				end\n\
			end\n\
		end\n\
	end\n\
		\n\
	if actor:IsMyActor() == true then\n\
		\n\
        action:CreateActionTargetList(actor);\n\
\n\
		action:SetActionInstanceID();\n\
		action:BroadCast(actor:GetPilot());\n\
	\n\
	end\n\
\n\
end\n\
function Skill_Melee_Charge_Attack_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = g_fChargingAttackAngle\n\
	end\n\
	\n\
	\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,g_fChargingAttackAngle,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
		\n\
end\n\
\n\
function Skill_Melee_Charge_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction();\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(3);\n\
	\n\
	local	bKeyCheck =  KeyIsDown( KEY_CHARGING_UKEY )\n\
	\n\
	if actor:IsMyActor() == false then\n\
		bKeyCheck = true;\n\
	end\n\
	local iCheckLog = 0\n\
	if(bKeyCheck) then iCheckLog = 1 end\n\
	\n\
	--ODS(\"iState:\"..iState..\" curSlot:\"..curSlot..\" Key:\"..iCheckLog..\" param:\"..action:GetParamInt(5) ..\"\\n\", false, 912)\n\
	if iState == 0 then\n\
	\n\
		if animDone == true then\n\
		\n\
			if curSlot == 0 then\n\
				actor:PlayNext();\n\
				\n\
				if iBaseClassID == CT_THIEF then\n\
					actor:AttachParticle(10,\"p_wp_l_hand\",\"ef_thi_charge_01_loop_p_wp_l_hand\");\n\
				elseif iBaseClassID == CT_FIGHTER then\n\
					actor:AttachParticle(10,\"p_wp_r_hand\",\"e_fighter_charge_01\");\n\
				--elseif iBaseClassID == CT_DOUBLE_FIGHTER then\n\
				end\n\
			end\n\
			if curSlot == 2 then\n\
				action:SetParamInt(3,1);\n\
				action:SetParamFloat(4,accumTime);\n\
				return true;\n\
			end\n\
		\n\
		end\n\
		\n\
		if bKeyCheck == false then\n\
		\n\
			if curSlot == 0 then\n\
				local iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
				if iBaseClassID == CT_DOUBLE_FIGHTER then\n\
					TryMustChangeSubPlayerAction( actor, \"a_twin_sub_repos\", action:GetDirection() )\n\
				end\n\
				return	false;\n\
			end\n\
			\n\
			if curSlot == 1 and action:GetParamInt(5) == 1 then\n\
			\n\
				Skill_Melee_Charge_Attack_Fire(actor,action);\n\
			else\n\
				return	false;\n\
			\n\
			end	\n\
		end\n\
	else\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(4);\n\
		if fElapsedTime>=g_fChargingFreezeTime then\n\
			action:SetParam(2,\"end\");\n\
			return	false;\n\
		end				\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Melee_Charge_Attack_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(10);\n\
	actor:EndWeaponTrail();\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_world:GetWorldFocusFilterAlpha()\n\
		, 0\n\
		, g_fChargeFilterReturnTime\n\
		,false\n\
		,true);\n\
	end\n\
\n\
	local kPilot = actor:GetPilot()\n\
	if( false == kPilot:IsNil() ) then 		\n\
		local	iBaseActorType = kPilot:GetBaseClassID()\n\
		if(iBaseActorType == CT_DOUBLE_FIGHTER) then\n\
			local kSubActor = actor:GetSubPlayer()\n\
			if( false == kSubActor:IsNil() ) then	\n\
				local kSubActorAction = kSubActor:GetAction()\n\
				if( false == kSubActorAction:IsNil() ) then\n\
					if(kSubActorAction:GetID() ~= \"a_twin_sub_repos\" and kSubActorAction:GetID() ~= \"a_twin_sub_trace_ground\") then\n\
						TryMustChangeActorAction(kSubActor, \"a_twin_sub_trace_ground\")\n\
						return true;\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Melee_Charge_Attack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetID() == \"a_jump\" then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(1) == 1 and curAction:GetParam(2)~=\"end\" then\n\
		return		false;\n\
	end\n\
	\n\
   return true;\n\
   \n\
end\n\
\n\
function Skill_Melee_Charge_Attack_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" and action:GetActionParam() == AP_FIRE then\n\
	\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Magician_Charge_Attack_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_Dancer\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Fig\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Mag\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Arc\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Thi\")then\n\
		return false\n\
	end\n\
	\n\
	return		true;\n\
\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1);\n\
	actor:CutSkillCasting();\n\
	if actor:IsMyActor() == false then\n\
--		Skill_Magician_Charge_Attack_Fire(actor,action);\n\
	end				\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(3,0);\n\
	action:SetParamInt(1,0);\n\
	action:SetParamInt(5,0);\n\
				\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		--    .\n\
		actor:AttachParticle(11,\"p_wp_r_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
		actor:AttachParticle(12,\"p_wp_l_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
		return true;\n\
	end\n\
		\n\
--	action:SetAutoBroadCastWhenCastingCompleted(false);	\n\
	action:SetParamInt(6,0);\n\
	\n\
	--[[if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_fChargeFocusFilterValue[2]\n\
		, g_fChargeFocusFilterValue[3]\n\
		, g_fChargeFocusFilterValue[4]\n\
		,true\n\
		,true)\n\
	end]]--\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
   return true\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(1,1);\n\
	\n\
	actor:PlayNext();\n\
	\n\
	actor:DetachFrom(11);\n\
	actor:DetachFrom(12);\n\
	\n\
\n\
	ODS(\"Skill_Magician_Charge_Attack_Fire ef_mag_charge01_result\\n\");\n\
	action:SetParamInt(3,0);		\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		\n\
--		action:SetActionInstanceID();\n\
--		action:BroadCast(actor:GetPilot());\n\
	end\n\
\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	    GetComboAdvisor():AddNextAction(\"a_jump\");\n\
    end    \n\
    \n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kMovingVec = actor:GetLookingDir();\n\
	local	fDistance = action:GetSkillRange(0,actor);\n\
	kMovingVec:Multiply(fDistance);\n\
	kMovingVec:Add(actor:GetPos());\n\
	kMovingVec:SetZ(kMovingVec:GetZ() - 20)			\n\
	\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 74\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kMovingVec,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction();\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	bKeyCheck = KeyIsDown( KEY_CHARGING_UKEY )\n\
	local	iState = action:GetParamInt(6);\n\
	\n\
	if actor:IsMyActor() == false then\n\
		bKeyCheck = true;\n\
	end\n\
	\n\
	if iState == 0 then\n\
	\n\
		if animDone == true then\n\
			if curSlot == 0 then\n\
				actor:PlayNext();\n\
				local	kMovingVec = actor:GetLookingDir();\n\
				local	fDistance = action:GetSkillRange(0,actor);\n\
				if 0 == fDistance then\n\
					fDistance = 100\n\
				end\n\
				kMovingVec:Multiply(fDistance);\n\
				kMovingVec:Add(actor:GetTranslate());\n\
				kMovingVec:SetZ(kMovingVec:GetZ() - 20)	\n\
				actor:AttachParticleToPoint(9,kMovingVec,\"ef_mag_charge01_loop\");		\n\
				action:SetParamInt(3,1);\n\
				actor:AttachSound(2784, \"PointBust\");\n\
			end\n\
			if curSlot == 2 then\n\
				action:SetParamInt(6,1);\n\
				action:SetParamFloat(7,accumTime);\n\
				return true;\n\
			end\n\
		end\n\
\n\
		--  ,     .\n\
		if curSlot == 1 and action:GetParamInt(5) == 1 then\n\
			Skill_Magician_Charge_Attack_Fire(actor,action);\n\
		end	\n\
		\n\
	else\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(7);\n\
		if fElapsedTime>=g_fChargingFreezeTime then\n\
			action:SetParam(2,\"end\");\n\
			return	false;					\n\
		end		\n\
		\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:DetachFrom(9);\n\
	actor:DetachFrom(11);\n\
	actor:DetachFrom(12);\n\
	\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Magician_Charge_Attack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetID() == \"a_jump\" or \n\
	action:GetID() == \"a_MagicianShot_01\" or \n\
	action:GetID() == \"a_st_combo_a\" or \n\
	action:GetID() == \"a_sp_combo_a\" or\n\
	action:GetID() == \"a_st_combo_a_Doubleshot\" or \n\
	action:GetID() == \"a_st_combo_a_ThreeWay\" then\n\
	\n\
		if actor:GetAction():GetParam(10) == \"HIT\" then\n\
			return true;\n\
		end\n\
	\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
		\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(1) == 1 and curAction:GetParam(2)~=\"end\" then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	\n\
	if action:GetParamInt(1) ~= 1 then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" then\n\
	\n\
		action:SetParam(10,\"HIT\");\n\
	\n\
		local	kMovingVec = actor:GetLookingDir();\n\
		local	fDistance = action:GetSkillRange(0,actor);\n\
		if 0 == fDistance then\n\
			fDistance = 100\n\
		end\n\
		kMovingVec:Multiply(fDistance);\n\
		kMovingVec:Add(actor:GetTranslate());\n\
		kMovingVec:SetZ(kMovingVec:GetZ() - 20)	\n\
		actor:DetachFrom(9);\n\
		actor:AttachParticleToPoint(10, kMovingVec, \"ef_mag_charge01_result\");	\n\
				\n\
		if actor:IsUnderMyControl() then\n\
			action:BroadCastTargetListModify(actor:GetPilot());		\n\
		end\n\
	\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Magician_Charge_Attack_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(1) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Archer_Charge_Attack_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then		--    .\n\
		return	false;\n\
	end	\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Archer_Charge_Attack_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1);	\n\
	if actor:IsMyActor() == false then\n\
		Skill_Archer_Charge_Attack_Fire(actor,action);\n\
	end		\n\
end\n\
function Skill_Archer_Charge_Attack_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_Archer_Charge_Attack_OnEnter\\n\");\n\
	\n\
	action:SetParamInt(3,0);\n\
	action:SetParamInt(1,0);\n\
	action:SetParamInt(5,0);\n\
				\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
		\n\
	else\n\
		if action:GetActionParam() == AP_FIRE then\n\
			Skill_Archer_Charge_Attack_Fire(actor,action);\n\
		end\n\
		\n\
	end\n\
		\n\
	action:SetAutoBroadCastWhenCastingCompleted(false);	\n\
	action:SetParamInt(6,0);\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_fChargeFocusFilterValue[2]\n\
		, g_fChargeFocusFilterValue[3]\n\
		, g_fChargeFocusFilterValue[4]\n\
		,true\n\
		,true)\n\
		\n\
		GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
		\n\
		\n\
	end\n\
\n\
   return true\n\
end\n\
function Skill_Archer_Charge_Attack_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(1,1);\n\
	\n\
	action:SetSlot(2);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	actor:AttachParticle(10,\"char_root\",\"ef_arrow_start01\");\n\
	action:SetParamInt(3,0);		\n\
	\n\
	if actor:IsMyActor() == true then\n\
\n\
        action:CreateActionTargetList(actor);\n\
		action:SetActionInstanceID();\n\
		action:BroadCast(actor:GetPilot());\n\
	\n\
	end\n\
end\n\
\n\
function Skill_Archer_Charge_Attack_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),g_fChargingAttackAngle,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
end\n\
\n\
function Skill_Archer_Charge_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(6);\n\
	\n\
	local	bKeyCheck =  KeyIsDown( KEY_CHARGING_UKEY );\n\
	\n\
	if actor:IsMyActor() == false then\n\
		bKeyCheck = true;\n\
	end\n\
	\n\
	if iState == 0 then\n\
	\n\
		if animDone == true then\n\
		\n\
			if curSlot == 0 then\n\
				actor:PlayNext();\n\
				actor:AttachParticle(10,\"p_ef_center\",\"ef_arc_charge01_loop\");		\n\
				action:SetParamInt(3,1);							\n\
			end\n\
			if curSlot == 2 then\n\
				action:SetParamInt(6,1);\n\
				action:SetParamFloat(7,accumTime);\n\
				return true;\n\
			end\n\
		\n\
		end\n\
		\n\
		if bKeyCheck == false then\n\
			if curSlot == 0 then\n\
				return	false;\n\
			end\n\
			\n\
			if curSlot == 1 and action:GetParamInt(5) == 1 then\n\
			\n\
				Skill_Archer_Charge_Attack_Fire(actor,action);\n\
			else\n\
				return	false;\n\
			\n\
			end	\n\
		end\n\
	else\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(7);\n\
		if fElapsedTime>=g_fChargingFreezeTime then\n\
			action:SetParam(2,\"end\");\n\
			return	false;					\n\
		end		\n\
\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
\n\
function	Skill_Archer_Charge_Attack_LoadArrowToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(\"Projectile_Phoenix\",action,actor:GetPilotGuid());\n\
	kNewArrow:LoadToWeapon(actor);	--	\n\
	return  kNewArrow;\n\
end\n\
function	Skill_Archer_Charge_Attack_FireArrow(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	ODS(\"Skill_Archer_Charge_Attack_Fire\\n\");\n\
	\n\
	local	kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
	local	kArrow = Skill_Archer_Charge_Attack_LoadArrowToWeapon(actor,kAction);\n\
	\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		local	iTargetCount = kAction:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
		local   pt = nil;\n\
		\n\
		if iTargetCount>0 then\n\
				--	  \n\
			local	kTargetGUID = kAction:GetTargetGUID(0);\n\
			iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
			kActionTargetInfo = kAction:GetTargetInfo(0);\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end						\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
		\n\
		if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
		else\n\
			kArrow:SetTargetObjectList(kAction:GetTargetList());	\n\
			\n\
			if pt ~= nil then\n\
			\n\
				local	kTargetPoint = Point3(pt:GetX(),pt:GetY(),arrow_worldpos:GetZ());\n\
				kArrow:SetTargetLoc(kTargetPoint);\n\
			\n\
			end\n\
		end\n\
		\n\
		kArrow:Fire();\n\
\n\
	else\n\
		\n\
		ODS(\"Arrow is nil\\n\");\n\
	\n\
	end\n\
	\n\
	kAction:ClearTargetList();\n\
	actor:ClearIgnoreEffectList();\n\
				\n\
end\n\
\n\
\n\
function Skill_Archer_Charge_Attack_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:GetAction():GetParamInt(3) == 1 then\n\
		actor:DetachFrom(10);\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_world:GetWorldFocusFilterAlpha()\n\
		, 0\n\
		, g_fChargeFilterReturnTime\n\
		,false\n\
		,true);\n\
	end\n\
	\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Skill_Archer_Charge_Attack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetID() == \"a_jump\" then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
		\n\
	local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());	\n\
	\n\
	if curAction:GetParamInt(1) == 1 and curAction:GetParam(2)~=\"end\" then\n\
		return		false;\n\
	end\n\
\n\
\n\
   return true;\n\
   \n\
end\n\
\n\
function Skill_Archer_Charge_Attack_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" and action:GetActionParam() == AP_FIRE then\n\
	\n\
		Skill_Archer_Charge_Attack_FireArrow(actor);\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
use_cam_effect = false;\n\
\n\
function Skill_Fighter_Jump_Attack_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Fighter_Jump_Attack_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if actor:GetJumpAccumHeight() < 50 then\n\
		return	false\n\
	end\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Fighter_Jump_Attack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	actorID = actor:GetID()\n\
--	actionID = action:GetID()\n\
--	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:GetJumpAccumHeight()<50 then	\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;\n\
		end\n\
	end\n\
    \n\
    action:CreatActionTargetList(actor);\n\
\n\
	actor:AttachParticle(10,\"p_ef_center\",\"e_fighter_jump_attack\");\n\
		\n\
	actor:StopJump()\n\
	actor:FreeMove(true)\n\
	actor:StartWeaponTrail()\n\
	return true\n\
end\n\
function Skill_Fighter_Jump_Attack_OnFindTarget(actor,action,kTargets)\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,true);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
end\n\
\n\
function Skill_Fighter_Jump_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local slotNum = action:GetCurrentSlot();\n\
	\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		action:SetParam(1,\"end\");\n\
		return	false;\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Fighter_Jump_Attack_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:FreeMove(false);\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
function Skill_Fighter_Jump_Attack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_right_run\" or actionID == \"a_left_run\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Fighter_Jump_Attack_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
	\n\
		actor:FreeMove(false);\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [EFFECT_ID] :     ID\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
function Skill_Down_Attack_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if false == actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
\n\
function Skill_Down_Attack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iBaseActorType = actor:GetPilot():GetBaseClassID()\n\
\n\
	ODS(\"Skill_Down_Attack_OnEnter actionID: \"..action:GetID()..\"\\n\");\n\
\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	if iBaseActorType == CT_FIGHTER or iBaseActorType == CT_THIEF then\n\
		actor:StartWeaponTrail();\n\
	end\n\
	\n\
	action:SetParamInt(0,0);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());	\n\
	end	\n\
	\n\
	actor:SetComboCount(0);\n\
	return true\n\
end\n\
function Skill_Down_Attack_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	Skill_Down_Attack_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
function Skill_Down_Attack_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kTargetPos = actor:GetLookingDir();\n\
	kTargetPos:Multiply(iAttackRange);\n\
	kTargetPos:Add(actor:GetPos());\n\
	kTargetPos:SetZ(kTargetPos:GetZ()-20);\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = iAttackRange\n\
	end	\n\
			\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_DOWN);\n\
	\n\
	return	action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
function Skill_Down_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
--	local	slotNum = action:GetCurrentSlot();\n\
	\n\
	if animDone == true then\n\
		\n\
		ODS(\"Skill_Down_Attack_OnUpdate animDone Param : \"..action:GetParam(1)..\"\\n\");\n\
		\n\
		actor:SetParam(\"LAST_DOWN_ATTACK_TIME\",\"\"..accumTime);\n\
		\n\
		if action:GetParam(1) == \"GoNext\" then\n\
			action:SetNextActionName(action:GetParam(0));\n\
		end\n\
\n\
		action:SetParam(1,\"end\");\n\
		\n\
		return	false;\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Down_Attack_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:EndWeaponTrail();\n\
	ODS(\"Skill_Down_Attack_OnCleanUp NextAction : \"..action:GetID()..\"\\n\");\n\
	\n\
	return true;\n\
end\n\
function Skill_Down_Attack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	if action:GetEnable() then\n\
		ODS(\"Skill_Down_Attack_OnLeave NextAction : \"..actionID..\"\\n\");\n\
	end\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"HIT\" then\n\
			if action:GetID() == \"a_jump\" then\n\
				return	true\n\
			end\n\
			curAction:SetNextActionName(actionID);\n\
			curAction:SetNextActionInputSlotInfo(action:GetInputSlotInfo());\n\
		end\n\
\n\
		return false;\n\
	elseif curParam == \"end\" and (actionID == \"a_right_run\" or actionID == \"a_left_run\") then\n\
		return true;\n\
	elseif 	actionID == \"a_level_up\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Down_Attack_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(1) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            --if actor:IsMyActor()  then\n\
				--action:GetTargetList():ApplyActionEffects(true,true);\n\
            --else\n\
                SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
            --end\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Down_Attack_OnEvent(actor,textKey,seqID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	ODS(\"Skill_Melee_Knock_Back_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	if textKey == \"hit\" then\n\
		\n\
		local kAction = actor:GetAction();\n\
		\n\
		CheckNil(nil==kAction);\n\
		CheckNil(kAction:IsNil());\n\
	\n\
		local	kActionID = kAction:GetID();\n\
		\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Down_Attack_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end		\n\
			\n\
		end\n\
		kAction:SetParam(1,\"HIT\")\n\
		\n\
		local	iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
		\n\
		\n\
		if kActionID == \"a_down_attack_fly\" then\n\
			actor:AttachParticle(31,\"char_root\",\"edge_swd_01_09\");		\n\
		end\n\
		\n\
		if actor:IsMyActor() and kAction:GetTargetCount()>0 then\n\
		\n\
			if kActionID == \"a_down_attack_fly\" or\n\
				kActionID == \"a_arc_down_attack_fly\" or\n\
				kActionID == \"a_mag_down_attack_fly\" or\n\
				kActionID == \"a_thi_down_attack_fly\" then\n\
\n\
				QuakeCamera(g_fBlowUpQuakeValue[1]\n\
				, g_fBlowUpQuakeValue[2]\n\
				, g_fBlowUpQuakeValue[3]\n\
				, g_fBlowUpQuakeValue[4]\n\
				, g_fBlowUpQuakeValue[5])		\n\
				\n\
			end\n\
		\n\
		end\n\
		\n\
		\n\
		local	kActorID = actor:GetID();\n\
		\n\
		local	fFrontMoveRange = 10;\n\
		local	kTargetPos = actor:GetLookingDir();\n\
		kTargetPos:Multiply(fFrontMoveRange);\n\
		kTargetPos:Add(actor:GetPos());\n\
		kTargetPos:SetZ(kTargetPos:GetZ()-20);\n\
		\n\
		ODS(\"kActorID : \"..kActorID..\"\\n\");\n\
		\n\
		if kActorID == \"c_thief_male\" or kActorID == \"c_thief_female\" then\n\
			actor:AttachParticleToPoint(10,kTargetPos,\"ef_thi_down_attk\");			\n\
		elseif kActorID == \"c_magician_male\" or kActorID == \"c_magician_female\" then\n\
			if \"a_mag_down_attack_fly\" == kAction:GetID() then\n\
				kTargetPos = actor:GetLookingDir();\n\
				kTargetPos:Multiply(kAction:GetSkillRange(0,actor));\n\
				kTargetPos:Add(actor:GetPos());\n\
				actor:AttachParticleToPoint(10,kTargetPos,\"ef_mag_attk_down_fly_01_char_root\");\n\
			end		\n\
		elseif kActorID == \"c_archer_male\" or kActorID == \"c_archer_female\" then\n\
			if \"a_arc_down_attack_fly\" == kAction:GetID() then\n\
				actor:AttachParticle(10, \"char_root\",\"ef_attk_down_fly_01_char_root\");\n\
			end\n\
		end\n\
	\n\
	\n\
	--	if actor:IsMyActor() then\n\
	--		QuakeCamera(g_fDownAttackQuakeValue[1]\n\
	--		, g_fDownAttackQuakeValue[2]\n\
	--		, g_fDownAttackQuakeValue[3]\n\
	--		, g_fDownAttackQuakeValue[4]\n\
	--		, g_fDownAttackQuakeValue[5])\n\
	--	end\n\
\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Down_Attack_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
-- [PIERCING] : \n\
-- [WEAPON_XML] :        XML .\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [SKILL_LEVEL_TO_SIZE] :     \n\
-- [SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE] :         \n\
-- [SKILL_LEVEL_TO_SIZE_DOT_POINT] :     \n\
-- [SKILL_LEVEL_TO_SIZE_LEVEL_POINT] :      \n\
-- [FIRE_CASTER_EFFECT_ID] :    \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :     \n\
-- [DETACH_FIRE_CASTER_EFFECT_AT_HIT] : Hit   .\n\
-- [HIDE_WEAPON] :  \n\
-- [PENETRATION_COUNT] :   \n\
\n\
-- Melee\n\
function Projectile_Default_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Projectile_Default_OnCastingCompleted(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	Projectile_Default_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function	Projectile_Default_LoadToWeapon(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Projectile_Default_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end	\n\
\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
	local kStartSize = 1;\n\
	local kDotPoint = 0;\n\
	local kLevelUpPoint = 0;\n\
	local iSkillLevel = 0;\n\
\n\
	local kUseSkillSize = action:GetScriptParam(\"SKILL_LEVEL_TO_SIZE\");\n\
	if kUseSkillSize == \"TRUE\" then\n\
		kStartSize = tonumber(action:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE\"));\n\
		kDotPoint = tonumber(action:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_DOT_POINT\"));\n\
		kLevelUpPoint =  tonumber(action:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_LEVEL_POINT\"));\n\
\n\
		if kStartSize == nil then\n\
			kStartSize = 1;\n\
		end\n\
\n\
		if kLevelUpPoint == nil then\n\
			kLevelUpPoint = 1;\n\
		end\n\
\n\
		if kDotPoint == nil then\n\
			kDotPoint = 0;\n\
		end\n\
\n\
		iSkillLevel = action:GetAbil(AT_LEVEL);\n\
		if 0 == iSkillLevel then\n\
			iSkillLevel = 1;\n\
		end\n\
		iSkillLevel = iSkillLevel / kLevelUpPoint;\n\
	end\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
			actor:AttachParticleS(7212,kFireEffectTargetNodeID,kFireEffectID, kStartSize + (iSkillLevel * kDotPoint));\n\
        end\n\
    \n\
    end	\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
end\n\
\n\
\n\
function Projectile_Default_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Projectile_Default_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Projectile_Default_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Projectile_Default_OnCleanUp(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
		\n\
	--	 \n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return end\n\
	if( CheckNil(curAction:IsNil()) ) then return end	\n\
\n\
	if curAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if curAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
	\n\
	actor:DetachFrom(7212,true)\n\
\n\
	return true;\n\
end\n\
\n\
function Projectile_Default_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Projectile_Default_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Projectile_Default_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
\n\
		if kAction:GetScriptParam(\"DETACH_FIRE_CASTER_EFFECT_AT_HIT\") == \"TRUE\" then\n\
		    actor:DetachFrom(7212,true)\n\
		end\n\
		\n\
	    local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	        actor:AttachParticle(7213,kHitEffectTargetNodeID,kHitEffectID);\n\
	    end\n\
	    		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,kAction);\n\
\n\
		local kUseSkillSize = kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE\");\n\
			\n\
		if kUseSkillSize == \"TRUE\" then\n\
			local kStartSize = tonumber(kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE\"));\n\
			local kDotPoint = tonumber(kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_DOT_POINT\"));\n\
			local kLevelUpPoint =  tonumber(kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_LEVEL_POINT\"));\n\
\n\
			if kStartSize == nil then\n\
				kStartSize = 1;\n\
			end\n\
\n\
			if kLevelUpPoint == nil then\n\
				kLevelUpPoint = 1;\n\
			end\n\
\n\
			if kDotPoint == nil then\n\
				kDotPoint = 0;\n\
			end\n\
\n\
\n\
			local	iSkillLevel = kAction:GetAbil(AT_LEVEL);\n\
			if 0 == iSkillLevel then\n\
				iSkillLevel = 1;\n\
			end\n\
			iSkillLevel = iSkillLevel / kLevelUpPoint;\n\
			kArrow:SetScale(kStartSize + (iSkillLevel * kDotPoint));\n\
		end\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
		\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			local iPentrationCount = kAction:GetScriptParam(\"PENETRATION_COUNT\");\n\
			if iPentrationCount == nil then\n\
				iPentrationCount = \"0\";\n\
			end\n\
\n\
			kArrow:SetPenetrationCount(tonumber(iPentrationCount))--   \n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
function	Act_Mon_Shot_Around_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
-- [PIERCING] : \n\
-- [WEAPON_XML] :        XML .\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [SKILL_LEVEL_TO_SIZE] :     \n\
-- [SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE] :         \n\
-- [SKILL_LEVEL_TO_SIZE_DOT_POINT] :     \n\
-- [SKILL_LEVEL_TO_SIZE_LEVEL_POINT] :      \n\
-- [USE_MULTI_SHOT] :          .\n\
\n\
-- Melee\n\
function Projectile_HandGrenade_OnCheckCanEnter(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Projectile_HandGrenade_OnCastingCompleted(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end	\n\
\n\
	Projectile_HandGrenade_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Projectile_HandGrenade_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
\n\
end\n\
\n\
function Projectile_HandGrenade_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end	\n\
	\n\
end\n\
\n\
\n\
function Projectile_HandGrenade_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Projectile_HandGrenade_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Projectile_HandGrenade_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Projectile_HandGrenade_OnCleanUp(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if actor:GetAction():GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Projectile_HandGrenade_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Projectile_HandGrenade_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Projectile_HandGrenade_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
	    local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7213,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	    		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
				\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
\n\
		iAttackRange = iAttackRange + actor:GetJumpAccumHeight();\n\
\n\
		\n\
		local kUseMultiShot = kAction:GetScriptParam(\"USE_MULTI_SHOT\");\n\
		local iShotMax = 1;\n\
		if kUseMultiShot == \"TRUE\" then\n\
			iShotMax = kAction:GetAbil(AT_COUNT);\n\
		end\n\
\n\
		local i = 0;\n\
		while i< iShotMax do\n\
			local	kArrow = Projectile_HandGrenade_LoadToWeapon(actor,kAction);\n\
\n\
			local kUseSkillSize = kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE\");\n\
				\n\
			if kUseSkillSize == \"TRUE\" then\n\
				local kStartSize = kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_START_EFFECT_SIZE\");\n\
				local kDotPoint = kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_DOT_POINT\");\n\
				local kLevelUpPoint =  kAction:GetScriptParam(\"SKILL_LEVEL_TO_SIZE_LEVEL_POINT\");\n\
\n\
				local	iSkillLevel = kAction:GetAbil(AT_LEVEL);\n\
				if 0 == iSkillLevel then\n\
					iSkillLevel = 1;\n\
				end\n\
				iSkillLevel = iSkillLevel / kLevelUpPoint;\n\
				kArrow:SetScale(kStartSize + (iSkillLevel * kDotPoint));\n\
			end\n\
			\n\
			local	targetobject = nil;\n\
\n\
			if kArrow:IsNil() == false then\n\
			\n\
				local	kMovingDir = actor:GetLookingDir();	--    \n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
\n\
				kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
				kArrow:SetParamValue(\"GrenadeIndex\", tostring(i));\n\
				kArrow:SetParamValue(\"action\", kAction:GetID());\n\
				kArrow:SetParamValue(\"range\", tostring(kAction:GetSkillRange(0,actor)));\n\
				kArrow:SetParamValue(\"exValue\", tostring(actor:GetJumpAccumHeight()));\n\
			\n\
				if i ~= 0 then --       .\n\
					iAttackRange = iAttackRange + math.random(-30,50);\n\
				end\n\
\n\
				ODS(\"iAttackRange : \"..iAttackRange..\"\\n\")\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kMovingDir:Add(arrow_worldpos);\n\
\n\
				--     .\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				local ptcl = g_world:ThrowRay(kMovingDir, Point3(0,0,-1), 200)\n\
				--ODS(\" : \"..ptcl:GetX()..\" \"..ptcl:GetY()..\" \"..ptcl:GetZ()..\"\\n\")\n\
				if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
					local loc = actor:GetNodeWorldPos(\"char_root\")\n\
					kMovingDir:GetZ(loc:GetZ())\n\
					ptcl:SetX(kMovingDir:GetX());\n\
					ptcl:SetY(kMovingDir:GetY());\n\
					ptcl:SetZ(kMovingDir:GetZ());\n\
				end\n\
\n\
				kArrow:SetTargetLoc(ptcl);\n\
\n\
				if kUseMultiShot == \"TRUE\" then\n\
					kArrow:Fire(true);\n\
				else\n\
					kArrow:Fire();\n\
				end\n\
\n\
			else\n\
				\n\
				ODS(\"Arrow is nil\\n\");\n\
			\n\
			end\n\
\n\
			i=i+1;\n\
		end\n\
		\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
\n\
function Skill_Venom_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Venom_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Venom_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Venom_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
	actor:HideParts(5,true);\n\
	actor:HideParts(6,true);\n\
	\n\
	actor:AttachParticle(7,\"p_wp_l_hand\",\"ef_skill_sterilizer_01_p_wp_l_hand\");\n\
	--actor:AttachParticle(8,\"char_root\",\"ef_Venom_char_root\");		\n\
	--actor:AttachParticle(9,\"char_root\",\"ef_Venom_p_ef_sterilizer\"); --  \n\
	actor:AttachParticle(8,\"char_root\",\"ef_Venom_Dummy01\");\n\
	\n\
	local iInstanceID = GetStatusEffectMan():AddStatusEffectToActor(actor:GetPilotGuid(),\"se_venom_mask\",0,1);\n\
	action:SetParamInt(3,iInstanceID);\n\
	\n\
	actor:StartWeaponTrail();\n\
end\n\
\n\
function Skill_Venom_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end	\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);		\n\
end\n\
\n\
function Skill_Venom_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Venom_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Venom_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Venom_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:HideParts(5,false);\n\
	actor:HideParts(6,false);\n\
	actor:DetachFrom(7);\n\
	\n\
	local	kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	iInstanceID = kAction:GetParamInt(3);\n\
	GetStatusEffectMan():RemoveStatusEffectFromActor2(actor:GetPilotGuid(),iInstanceID);\n\
\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Skill_Venom_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Venom_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
	if kActionResult:GetCritical() then\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	else\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	end	\n\
	\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	\n\
	actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, kActionTargetInfo);\n\
	\n\
end\n\
function Skill_Venom_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action, true);        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
function Skill_Venom_DoDamageToTargetList(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iTargetCount = action:GetTargetCount();\n\
	if iTargetCount>0 then\n\
\n\
		local i = 0;\n\
		while i<iTargetCount do\n\
			\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					Skill_Venom_DoDamage(actor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
				end\n\
			end\n\
			\n\
			i=i+1;\n\
			\n\
		end\n\
	\n\
	end\n\
	\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects();\n\
	end\n\
	action:ClearTargetList();		\n\
end\n\
\n\
function Skill_Venom_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
		actor:AttachSound(9284,\"Venom\");		\n\
		\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Venom_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
			\n\
		end\n\
		kAction:SetParam(2,\"HIT\");\n\
				\n\
		--Skill_Venom_DoDamageToTargetList(actor,kAction);\n\
			\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_BrotherIsReturn_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_BrotherIsReturn_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_BrotherIsReturn_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_BrotherIsReturn_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_BrotherIsReturn_Fire\\n\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
end\n\
\n\
function Skill_BrotherIsReturn_FindGenPoint(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	   .\n\
	local	fDistance = 20;\n\
	local	kTargetPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(fDistance);\n\
	kTargetPos:Add(kMovingDir);\n\
	\n\
	\n\
	return	kTargetPos;\n\
\n\
end\n\
function Skill_BrotherIsReturn_CreateSinghaBro(actor,action,kTargetPos)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900004, 0)\n\
	if pilot:IsNil() == false then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9)\n\
		pilot:GetActor():FreeMove(true)\n\
		ODS(\"Skill_BrotherIsReturn_CreateSinghaBro GUID : \"..guid:GetString()..\"\\n\");\n\
		\n\
		--pilot:GetActor():ToLeft(actor:IsToLeft(),true);\n\
		pilot:GetActor():ReserveTransitAction(\"a_Brother is Return_Play\")\n\
		pilot:GetActor():ClearActionState()\n\
		\n\
		local   kLookTarget = actor:GetLookingDir();\n\
		kLookTarget:Multiply(40);\n\
		kLookTarget:Add(kTargetPos);\n\
		pilot:GetActor():LookAt(kLookTarget,true);\n\
		\n\
		local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		if kAction:IsNil() == false then\n\
		\n\
		    GetActionTargetTransferInfoMan():AddTransferInfo_Actor(\n\
		                    actor:GetPilotGuid(),\n\
		                    action:GetActionNo(),\n\
		                    action:GetActionInstanceID(),\n\
		                    pilot:GetGuid());\n\
		                    \n\
            --SetBreak();\n\
			kAction:SetTargetList(action:GetTargetList());\n\
			kAction:AddNewGUID(actor:GetPilotGuid());\n\
			\n\
			local kLookDir = actor:GetLookingDir();\n\
			\n\
			kAction:SetParamInt(10,action:GetSkillRange(0,actor));\n\
			kAction:SetParamFloat(11,kLookDir:GetX());\n\
			kAction:SetParamFloat(12,kLookDir:GetY());\n\
			kAction:SetParamFloat(13,kLookDir:GetZ());\n\
			if actor:IsMyActor() then\n\
				kAction:SetParamInt(3,1);\n\
			end\n\
\n\
			local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
			if 0 == iSkillLevel then\n\
				iSkillLevel = 1;\n\
			end\n\
\n\
			kAction:SetParamInt(16, iSkillLevel);\n\
			\n\
			ODS(\"Brother is Return Moving Dir : \"..kLookDir:GetX()..\",\"..kLookDir:GetY()..\",\"..kLookDir:GetZ()..\"\\n\");\n\
			\n\
			action:ClearTargetList();\n\
		\n\
		end\n\
	end	\n\
\n\
end\n\
\n\
function Skill_BrotherIsReturn_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
--	local	kDir = actor:GetLookingDir();\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),30,10,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_BrotherIsReturn_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_BrotherIsReturn_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_BrotherIsReturn_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParamInt(2) == 0 then\n\
		local	kTargetPos = Skill_BrotherIsReturn_FindGenPoint(actor,action);\n\
		Skill_BrotherIsReturn_CreateSinghaBro(actor,action,kTargetPos);		\n\
		actor:ClearIgnoreEffectList();\n\
		action:SetParamInt(2,1);\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_BrotherIsReturn_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Skill_BrotherIsReturn_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_BrotherIsReturn_OnEvent(actor,textKey)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [FIRE_SOUND_ID] :     ID\n\
\n\
function Skill_BrotherIsReturn_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
		\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	\n\
	--	State\n\
	action:SetParamInt(4,0)\n\
	\n\
	--	Hit Count\n\
	action:SetParamInt(5,0)\n\
	\n\
	--	Last Hit Time\n\
	action:SetParamFloat(6,0);\n\
\n\
	action:SetParamFloat(7,0);\n\
\n\
	action:SetParamInt(8,0);\n\
	\n\
	local kPos = actor:GetPos();\n\
	kPos:SetZ(kPos:GetZ()-30);\n\
	actor:AttachParticleToPoint(1,kPos,\"ef_bang\");\n\
	\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local actionID = action:GetID();\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local fMoveSpeed  = 2000;\n\
	local fMaxMoveDistance = action:GetParamInt(10)-40;\n\
	local	iState = action:GetParamInt(4);\n\
	\n\
	if iSlotNum == 0 then\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
		if fElapsedTime>=0.6 then\n\
		\n\
			actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,0,0);\n\
			\n\
			action:SetParamFloat(0,accumTime);	--	   \n\
			\n\
			local	kPos = actor:GetPos();\n\
			--   \n\
			action:SetParamFloat(1,kPos:GetX());\n\
			action:SetParamFloat(2,kPos:GetY());\n\
			action:SetParamFloat(3,kPos:GetZ());\n\
		\n\
			actor:PlayNext();\n\
		end\n\
	\n\
	end\n\
	\n\
	if iSlotNum == 1 then\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
		local	fMoveDistance = fElapsedTime * fMoveSpeed;\n\
\n\
		if fMoveDistance>=fMaxMoveDistance then\n\
			if iState ~= 2 then\n\
				if action:GetParamInt(8) == 0 then\n\
					if actor:IsUnderMyControl() then\n\
						kAction:CreateActionTargetList(actor);\n\
						kAction:BroadCastTargetListModify(actor:GetPilot());\n\
					end\n\
				\n\
					Skill_BrotherIsReturn_Play_HitOneTime(actor,action)\n\
					Skill_BrotherIsReturn_Play_HitOneTime(actor,action)\n\
					Skill_BrotherIsReturn_Play_HitOneTime(actor,action)\n\
				end\n\
\n\
				if action:GetParamFloat(7) < fMaxMoveDistance then\n\
					fMoveDistance = fMaxMoveDistance;\n\
					local kMovingDir = Point3(action:GetParamFloat(11),action:GetParamFloat(12),action:GetParamFloat(13));\n\
					kMovingDir:Multiply(fMoveDistance);\n\
					action:SetParamFloat(7,fMaxMoveDistance);\n\
					local kNextPos = Point3(action:GetParamFloat(1),action:GetParamFloat(2),action:GetParamFloat(3));\n\
					kNextPos:Add(kMovingDir);\n\
					actor:SetTranslate(kNextPos);\n\
				end\n\
\n\
				action:SetParamInt(4,2);\n\
			end\n\
			\n\
			actor:EndBodyTrail();\n\
\n\
			actor:PlayNext();\n\
		else\n\
			local kMovingDir = Point3(action:GetParamFloat(11),action:GetParamFloat(12),action:GetParamFloat(13));\n\
			\n\
			--ODS(\"Brother is Return Moving Dir : \"..kMovingDir:GetX()..\",\"..kMovingDir:GetY()..\",\"..kMovingDir:GetZ()..\"\\n\");\n\
			\n\
			kMovingDir:Multiply(fMoveDistance);\n\
			action:SetParamFloat(7,action:GetParamFloat(7)  + fMoveDistance);\n\
			\n\
			local kNextPos = Point3(action:GetParamFloat(1),action:GetParamFloat(2),action:GetParamFloat(3));\n\
			kNextPos:Add(kMovingDir);\n\
			\n\
			actor:SetTranslate(kNextPos);\n\
		\n\
		end\n\
	\n\
	end\n\
	\n\
	if iState == 1 then\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(6);\n\
		if fElapsedTime >= 0.1 then\n\
			action:SetParamInt(8,1);\n\
			if actor:IsUnderMyControl() then\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end\n\
		\n\
			if Skill_BrotherIsReturn_Play_HitOneTime(actor,action) == false then\n\
				return	false;\n\
			end\n\
		end\n\
	\n\
	elseif iState == 2 then\n\
		if animDone and accumTime - action:GetParamFloat(6)>1.0 then\n\
			actor:SetTargetAlpha(actor:GetAlpha(), 0, 0.7);\n\
			action:SetParamInt(4,3);\n\
		end\n\
	elseif iState == 3 then\n\
		if accumTime - action:GetParamFloat(6)>2.0 then\n\
			return false;\n\
			\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
\n\
function Skill_BrotherIsReturn_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:EndBodyTrail();	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo, iHitCount)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	if actor == nil then\n\
		return;\n\
	end\n\
\n\
	if actorTarget == nil then\n\
		return;\n\
	end\n\
\n\
	local kAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local actionID = kAction:GetID();\n\
\n\
	local	iSphereIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex);\n\
	pt:SetX(pt:GetX() + math.random(-5,5))\n\
	pt:SetY(pt:GetY() + math.random(-5,5))\n\
	pt:SetZ(pt:GetZ() + math.random(-5,5))\n\
	\n\
	if kActionResult:GetCritical() then\n\
		actorTarget:AttachParticleToPointS(12 + iHitCount, pt, \"e_dmg_cri\", 0.8)\n\
	else\n\
		actorTarget:AttachParticleToPointS(12 + iHitCount, pt, \"e_dmg\", 0.8)\n\
	end	\n\
	\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime/2);		\n\
	\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(6,g_world:GetAccumTime());\n\
	\n\
	local	iHitCount = action:GetParamInt(5);\n\
	\n\
	ODS(\"Skill_BrotherIsReturn_Play_HitOneTime iHitCount:\"..iHitCount..\"\\n\");\n\
\n\
\n\
	local kOriginalActorGUID = action:GetGUIDInContainer(0);\n\
	local kOriginalActor = nil;\n\
	if kOriginalActorGUID:IsNil() == false then\n\
\n\
		local	kPilot = g_pilotMan:FindPilot(kOriginalActorGUID);\n\
		if kPilot:IsNil() == false then\n\
			kOriginalActor = kPilot:GetActor();\n\
		end\n\
	\n\
	end	\n\
\n\
	--local	iSkillLevel = action:GetParamInt(16);\n\
	local	iTotalHit = 3;\n\
		\n\
	if iHitCount == iTotalHit-1 then\n\
	\n\
		local iTargetCount = action:GetTargetCount();\n\
		local i =0;\n\
		if iTargetCount>0 then\n\
			\n\
			while i<iTargetCount do\n\
			\n\
				local actionResult = action:GetTargetActionResult(i);\n\
				if actionResult:IsNil() == false then\n\
				\n\
					action:SetParamInt(15,actionResult:GetValue()/(iTotalHit));\n\
					local	iOneDmg = action:GetParamInt(15);\n\
				\n\
					actionResult:SetValue(actionResult:GetValue() - iOneDmg*(iTotalHit-1));\n\
						\n\
					local kTargetGUID = action:GetTargetGUID(i);\n\
					local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false then\n\
						\n\
						local actorTarget = kTargetPilot:GetActor();\n\
						\n\
						Skill_BrotherIsReturn_Play_DoDamage(kOriginalActor,actorTarget,actionResult,action:GetTargetInfo(i), iHitCount);\n\
					end\n\
					\n\
				end\n\
				\n\
				i=i+1;\n\
			\n\
			end\n\
		end\n\
				\n\
		action:GetTargetList():ApplyActionEffects();\n\
	\n\
	else\n\
	\n\
		action:GetTargetList():ApplyOnlyDamage(iTotalHit,false, 6);\n\
		\n\
		local iTargetCount = action:GetTargetCount();\n\
		local i =0;\n\
		if iTargetCount>0 then\n\
			\n\
			while i<iTargetCount do\n\
			\n\
				local actionResult = action:GetTargetActionResult(i);\n\
				if actionResult:IsNil() == false then\n\
				\n\
					local kTargetGUID = action:GetTargetGUID(i);\n\
					local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false then\n\
						\n\
						local actorTarget = kTargetPilot:GetActor();\n\
						\n\
						Skill_BrotherIsReturn_Play_DoDamage(kOriginalActor,actorTarget,actionResult,action:GetTargetInfo(i), 1);\n\
					end\n\
				end\n\
				\n\
				i=i+1;\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
	\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	\n\
	if iHitCount == iTotalHit then\n\
		action:SetParamInt(4,2)	--	\n\
		return	true\n\
	end\n\
	\n\
	action:SetParamInt(5,iHitCount);\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iSlotNum = action:GetCurrentSlot();\n\
\n\
	ODS(\"textkey : \".. textKey .. \" \".. iSlotNum..\"\\n\");\n\
\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" then\n\
		action:SetParamInt(4,1)	--	Start Hit\n\
\n\
		Skill_BrotherIsReturn_Play_HitOneTime(actor,action);			\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
    if bIsBefore == false then\n\
\n\
        if kAction:GetParamInt(3) == 1 then -- My actor			\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = action:GetParamInt(16);\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_BrotherIsReturn_Play_HitOneTime(actor,action);        \n\
        end    \n\
    end\n\
end\n\
\n\
function Skill_BrotherIsReturn_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_BrotherIsGone_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_BrotherIsGone_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_BrotherIsGone_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_BrotherIsGone_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_BrotherIsGone_Fire\\n\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
end\n\
\n\
function Skill_BrotherIsGone_FindGenPoint(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	   .\n\
	\n\
	local	iRange = action:GetSkillRange(0,actor);\n\
	ODS(\"Skill_BrotherIsGone_FindGenPoint iRange:\"..iRange..\"\\n\");\n\
	\n\
	local	fDistance = iRange - 70;\n\
	local	kTargetPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(fDistance);\n\
	kTargetPos:Add(kMovingDir);\n\
	\n\
	\n\
	return	kTargetPos;\n\
\n\
end\n\
function Skill_BrotherIsGone_CreateSinghaBro(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900004, 0)\n\
	if pilot:IsNil() == false then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9)\n\
		pilot:GetActor():FreeMove(true)\n\
		pilot:GetActor():ToLeft(actor:IsToLeft());\n\
		pilot:GetActor():ReserveTransitAction(\"a_Brother is Gone_Play\")\n\
		pilot:GetActor():ClearActionState()\n\
		\n\
		local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		if kAction:IsNil() == false then\n\
		\n\
			kAction:SetTargetList(action:GetTargetList());\n\
			kAction:AddNewGUID(actor:GetPilotGuid());\n\
			kAction:SetParamInt(10,action:GetSkillRange(0,actor));\n\
			if actor:IsMyActor() then\n\
				kAction:SetParamInt(3,1);\n\
			end\n\
			\n\
			local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
			if 0 == iSkillLevel then\n\
				iSkillLevel = 1;\n\
			end\n\
\n\
			kAction:SetParamInt(16, iSkillLevel);\n\
\n\
			action:ClearTargetList();\n\
		\n\
		end\n\
	end	\n\
\n\
end\n\
\n\
function Skill_BrotherIsGone_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local	iRange = action:GetSkillRange(0,actor);\n\
	ODS(\"Skill_BrotherIsGone_OnFindTarget iRange:\"..iRange..\"\\n\");\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iRange,40,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_BrotherIsGone_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_BrotherIsGone_OnCastingCompleted(actor,action)\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_BrotherIsGone_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_BrotherIsGone_OnCleanUp(actor,action)\n\
	return true;\n\
end\n\
\n\
function Skill_BrotherIsGone_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_BrotherIsGone_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" then\n\
\n\
		--  \n\
			\n\
		local	kTargetPos = Skill_BrotherIsGone_FindGenPoint(actor,kAction);\n\
		Skill_BrotherIsGone_CreateSinghaBro(actor,kAction,kTargetPos);\n\
		actor:ClearIgnoreEffectList();\n\
			\n\
			\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [FIRE_SOUND_ID] :     ID\n\
\n\
function Skill_BrotherIsGone_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	\n\
	local kPos = actor:GetPos();\n\
	kPos:SetZ(kPos:GetZ()-30);\n\
	actor:AttachParticleToPoint(1,kPos,\"ef_bang\");\n\
	\n\
	action:SetParamInt(2,0);	--	 	\n\
	action:SetParamInt(4,0);\n\
	action:SetParamInt(5,0);\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_BrotherIsGone_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local actionID = action:GetID();\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(4);\n\
	\n\
	if iSlotNum == 0 then\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
		if fElapsedTime>=0.5 then\n\
			actor:PlayNext();\n\
			actor:AttachParticle(127, \"char_root\", \"ef_skill_brother_is_gone\")\n\
		end\n\
	\n\
	end\n\
	\n\
	if iSlotNum == 1 then	\n\
		if animDone == true and iState == 0 then	\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end	\n\
			action:SetParamInt(4,1);\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
		end\n\
	end\n\
\n\
	if iState == 1 then\n\
		if accumTime - action:GetParamFloat(6) > 0.4 then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
			actor:SetTargetAlpha(actor:GetAlpha(), 0, 0.7);\n\
			action:SetParamInt(4,2);\n\
		end\n\
	elseif iState == 2 then\n\
		if accumTime - action:GetParamFloat(6) > 1.0 then\n\
			return false;\n\
		end\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_BrotherIsGone_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_BrotherIsGone_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_BrotherIsGone_Play_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	if actor == nil or actorTarget == nil then\n\
		return;\n\
	end\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	if kActionResult:IsMissed() == true then\n\
		return\n\
	end\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local actionID = kAction:GetID();	\n\
\n\
	local	iSphereIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex);\n\
	pt:SetX(pt:GetX() + math.random(-5,5))\n\
	pt:SetY(pt:GetY() + math.random(-5,5))\n\
	pt:SetZ(pt:GetZ() + math.random(-5,5))\n\
	\n\
	if kActionResult:GetCritical()  then\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	else\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	end	\n\
	\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime/2);		\n\
	\n\
end\n\
function Skill_BrotherIsGone_Play_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	local	iTotalHit = 15\n\
	local	iHitCount = action:GetParamInt(5);\n\
	local	iRealDamage = 0;\n\
	local	iTotalRealHit = 8;\n\
	local	iRealHit = action:GetParamInt(2);\n\
\n\
	iRealDamage = iHitCount % 2;\n\
	ODS(\"iRealDamage : \".. iRealDamage..\"    HitCount : \"..iHitCount ..\"\\n\")\n\
	\n\
	if textKey == \"hit\" then\n\
		--hit  15  .  8     .\n\
		if iHitCount == 0 or iRealDamage == 1 then\n\
			if iRealHit == iTotalRealHit - 1 then\n\
\n\
				local iTargetCount = action:GetTargetCount();\n\
				local i =0;\n\
				if iTargetCount>0 then\n\
					\n\
					while i<iTargetCount do\n\
					\n\
						local actionResult = action:GetTargetActionResult(i);\n\
						if actionResult:IsNil() == false then\n\
						\n\
							action:SetParamInt(15,actionResult:GetValue()/(iTotalRealHit));\n\
							local	iOneDmg = action:GetParamInt(15);\n\
						\n\
							actionResult:SetValue(\n\
								actionResult:GetValue() - iOneDmg*(iTotalRealHit-1));\n\
								\n\
							local kTargetGUID = action:GetTargetGUID(i);\n\
							local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
							if kTargetPilot:IsNil() == false then\n\
								\n\
								local actorTarget = kTargetPilot:GetActor();\n\
								\n\
								Skill_BrotherIsGone_Play_DoDamage(kOriginalActor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
							end\n\
							\n\
						end\n\
						\n\
						i=i+1;\n\
					\n\
					end\n\
				end\n\
						\n\
				action:GetTargetList():ApplyActionEffects();\n\
		\n\
			else\n\
\n\
				action:GetTargetList():ApplyOnlyDamage(iTotalRealHit);\n\
				\n\
				local iTargetCount = action:GetTargetCount();\n\
				local i =0;\n\
				if iTargetCount>0 then\n\
					\n\
					while i<iTargetCount do\n\
					\n\
						local actionResult = action:GetTargetActionResult(i);\n\
						if actionResult:IsNil() == false then\n\
						\n\
							local kTargetGUID = action:GetTargetGUID(i);\n\
							local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
							if kTargetPilot:IsNil() == false then\n\
								\n\
								local actorTarget = kTargetPilot:GetActor();\n\
								\n\
								Skill_BrotherIsGone_Play_DoDamage(kOriginalActor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
							end\n\
						end\n\
						\n\
						i=i+1;\n\
					\n\
					end\n\
				end\n\
			end	\n\
\n\
			action:SetParamInt(2, iRealHit + 1);\n\
		end	\n\
\n\
		iHitCount = iHitCount + 1;		\n\
		action:SetParamInt(5,iHitCount);\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_BrotherIsGone_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	--          \n\
	Skill_BrotherIsReturn_Play_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
\n\
function Skill_BrotherIsGone_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("-- [Skill_Gimilet_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
-- [PIERCING] : \n\
-- [WEAPON_XML] :        XML .\n\
-- Melee\n\
function Skill_Gimilet_OnCheckCanEnter(kActor,kAction)\n\
\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = kActor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Gimilet_OnCastingCompleted(kActor, kAction)\n\
	\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	Skill_Gimilet_Fire(kActor,kAction);\n\
	kAction:SetSlot(kAction:GetCurrentSlot()+1);\n\
	kActor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Skill_Gimilet_LoadToWeapon(kActor,kAction)\n\
\n\
	if( CheckNil(nil==kActor) ) then return nil end\n\
	if( CheckNil(kActor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return nil end\n\
	if( CheckNil(kAction:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = kAction:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = kActor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,kAction,kActor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = kAction:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID);	--	\n\
\n\
	return	kNewArrow;\n\
end\n\
\n\
function Skill_Gimilet_Fire(kActor,kAction)\n\
\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end	\n\
	\n\
	--	  \n\
	if kAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		kActor:ChangeItemModel(ITEM_WEAPON, kAction:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..kAction:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end	\n\
	\n\
end\n\
\n\
function Skill_Gimilet_OnEnter(kActor, kAction)\n\
\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
--	local actorID = kActor:GetID()\n\
--	local actionID = kAction:GetID()\n\
--	local weapontype = kActor:GetEquippedWeaponType();\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	kActor:ResetAnimation();\n\
\n\
	Skill_Gimilet_OnCastingCompleted(kActor,kAction);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Gimilet_OnUpdate(kActor, accumTime, frameTime)\n\
		\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = kActor:GetID()\n\
	local kAction = kActor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	local animDone = kActor:IsAnimationDone()\n\
--	local nextActionName = kAction:GetNextActionName()\n\
--	local actionID = kAction:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = kAction:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			local nextActionName = kAction:GetParam(1);\n\
\n\
			kAction:SetParam(0, \"null\")\n\
			kAction:SetParam(1, \"end\")\n\
			\n\
			kAction:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			kAction:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Gimilet_OnCleanUp(kActor)\n\
	\n\
	\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	--	 \n\
	if kActor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		kActor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Gimilet_OnLeave(kActor, kAction)\n\
\n\
	if( CheckNil(nil==kActor) ) then return true end\n\
	if( CheckNil(kActor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	local curAction = kActor:GetAction();\n\
	if( CheckNil(nil==kAction) ) then return true end\n\
	if( CheckNil(kAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = kAction:GetID()\n\
	\n\
	if kActor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if kAction:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if kAction:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if kAction:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Gimilet_OnEvent(kActor,textKey)\n\
		\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	local kAction = kActor:GetAction();\n\
			\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Skill_Gimilet_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,kActor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_Gimilet_LoadToWeapon(kActor,kAction);\n\
		\n\
--		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = kActor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			-- \n\
			local iPentrationCount = kAction:GetAbil(AT_PENETRATION_COUNT);\n\
			kArrow:SetPenetrationCount(iPentrationCount);--   \n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
		\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			kArrow:Fire();\n\
			--ODS(\":\"..iPentrationCount..\"\\n\", false, 912)\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Claymore_Play_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Claymore_Play_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	if actor:IsUnderMyControl() then\n\
	\n\
		local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	        	\n\
		if fLifeTime == 0 then\n\
			fLifeTime = 8.5;\n\
		end\n\
		actor:SetInstallTimerGauge(fLifeTime);\n\
	end\n\
\n\
end\n\
\n\
function Skill_Claymore_Play_Fire(actor,action)\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    --   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    action:SetParamFloat(2,g_world:GetAccumTime());\n\
    action:SetParamFloat(3,g_world:GetAccumTime());\n\
\n\
\n\
end\n\
\n\
function Skill_Claymore_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actionID = action:GetID()\n\
	action:SetDoNotBroadCast(true);\n\
	\n\
	--ODS(\"Skill_Claymore_Play_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	action:SetParam(0,\"Idle\");  --  State\n\
\n\
	local kCallerPilot = g_pilotMan:FindPilot(actor:GetCallerGuid());\n\
\n\
	if kCallerPilot ~= nil or kCallerPilot:IsNil() == false then\n\
		local kCallerActor = kCallerPilot:GetActor();\n\
\n\
		if kCallerActor ~= nil or kCallerActor:IsNil() == false then\n\
			local bSettingClaymore = false;\n\
			for i=1,8 do\n\
				local kClaymoreGUID = GUID(kCallerActor:GetParam(\"Claymore_GUID_\"..i));\n\
				local kClaymorePilot = g_pilotMan:FindPilot(kClaymoreGUID);\n\
				if kClaymorePilot == nil or kClaymorePilot:IsNil() == true then\n\
					if bSettingClaymore == false then\n\
						kCallerActor:SetParam(\"Claymore_GUID_\"..i, actor:GetPilotGuid():GetString());\n\
						bSettingClaymore = true;\n\
						--WriteToConsole(\"Claymore_GUID_\"..i..\" Setting\\n\");\n\
					end					\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	--actor:SetParam(\"Claymore_GUID_\"..i,kGUID:GetString());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Claymore_Play_OnCastingCompleted(actor,action);\n\
	\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_Claymore_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
		--ODS(\"Skill_Claymore_Play_FindTarget Skill_Claymore_Play_OnTargetListModified\\n\");\n\
    \n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        \n\
        actor:AttachParticle(1,\"Dummy01\",\"ef_Claymore_dummy01\");\n\
        \n\
        --  5  .   .\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        action:SetParamFloat(1,g_world:GetAccumTime());\n\
        action:SetParam(0,\"WaitForDestroying\");\n\
    end\n\
\n\
end\n\
\n\
function Skill_Claymore_Play_FindTarget(actor,action,bForceToBomb)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(4,\"FullSearch\");\n\
	\n\
    action:CreateActionTargetList(actor,true);\n\
    \n\
    if IsSingleMode() or action:GetTargetCount() == 0 then		\n\
        Skill_Claymore_Play_OnTargetListModified(actor,action,false);        \n\
    else\n\
    	--ODS(\"Skill_Claymore_Play_FindTarget BroadCastTargetListModify\\n\");\n\
        action:BroadCastTargetListModify(actor:GetPilot());\n\
        action:ClearTargetList();    \n\
    end    \n\
    \n\
    return true\n\
end\n\
\n\
function Skill_Claymore_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local   kState = action:GetParam(0);\n\
	\n\
	--ODS(\"kState : \"..kState..\"\\n\");\n\
	\n\
	if  kState == \"Idle\" then\n\
        --  10   .\n\
        local   fTotalElapsedTime = accumTime - action:GetParamFloat(2)\n\
        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
    	\n\
        if fLifeTime == 0 then\n\
            fLifeTime = 10.0;\n\
        end\n\
        \n\
        ODS(\"Skill_Claymore_Play_OnUpdate fTotalElapsedTime : \"..fTotalElapsedTime..\"\\n\");\n\
        \n\
        if fTotalElapsedTime > fLifeTime-2 then\n\
            action:SetParam(0,\"WaitForDestroying\");\n\
            Skill_Claymore_Play_FindTarget(actor,action,true)\n\
			actor:AttachSound(2784, \"Claymore1\");\n\
            return true;\n\
        end\n\
	elseif  kState == \"bomb_force\" then --   ( )\n\
        Skill_Claymore_Play_FindTarget(actor,action,true)\n\
        action:SetParam(0,\"WaitForDestroying\");\n\
		actor:AttachSound(2784, \"Claymore1\");\n\
        --   \n\
	elseif kState == \"WaitForDestroying\" then\n\
		local   fTotalElapsedTime = accumTime - action:GetParamFloat(1)\n\
		if fTotalElapsedTime> 1 then\n\
			action:SetParam(0,\"end\");\n\
			return  false;\n\
        end	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Claymore_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local	kFindType = action:GetParam(4)\n\
	\n\
	local	fFindRange = action:GetSkillRange(0,actor);\n\
\n\
    local   kParam = FindTargetParam();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 40\n\
	end	\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(fFindRange,iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
\n\
end\n\
\n\
function Skill_Claymore_Play_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
    if actor:IsUnderMyControl() then\n\
		actor:DestroyInstallTimerGauge();\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Claymore_Play_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Skill_Claymore_Play_OnLeave NextAction : \"..action:GetID()..\"\\n\");\n\
	\n\
	local	kParam = actor:GetAction():GetParam(0)\n\
	\n\
	return (kParam == \"end\");\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
\n\
-- Melee\n\
function HammerCrush_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function HammerCrush_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	HammerCrush_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function HammerCrush_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") == \"\" then\n\
		if iSkillLevel == 5 then\n\
			actor:ChangeItemModel(ITEM_WEAPON, \"Item/Common/12_Weapon/09_special/100t_hammer.xml\");\n\
		elseif iSkillLevel >= 3 then\n\
			actor:ChangeItemModel(ITEM_WEAPON, \"Item/Common/12_Weapon/09_special/50t_hammer.xml\");\n\
		else\n\
			actor:ChangeItemModel(ITEM_WEAPON, \"Item/Common/12_Weapon/09_special/10t_hammer.xml\");\n\
		end\n\
	else\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
	end\n\
\n\
	actor:AttachSound(106,\"HammerCrush_Start\");\n\
	\n\
	actor:StartWeaponTrail();\n\
	actor:ResetAnimation();\n\
end\n\
function HammerCrush_OnFindTarget(actor,action,kTargets)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetParam(0,\"\");\n\
	return	HammerCrush_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function HammerCrush_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 60\n\
	end	\n\
\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(iAttackRange);\n\
	local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
	kTargetPos:Add(kMovingDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,iParam2,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);\n\
	\n\
	return	action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function HammerCrush_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	HammerCrush_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function HammerCrush_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function HammerCrush_OnCleanUp(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	actor:RestoreItemModel(ITEM_WEAPON);\n\
	\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function HammerCrush_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( CheckNil(nil==curAction) ) then return false end\n\
	if( CheckNil(curAction:IsNil()) ) then return false end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
\n\
function HammerCrush_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
				SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end\n\
    \n\
    \n\
end\n\
\n\
function HammerCrush_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" then\n\
	\n\
	    kAction:SetParam(2,\"HIT\");\n\
	\n\
		local	fDistance = kAction:GetSkillRange(0,actor);\n\
	    local	kMovingDir = actor:GetLookingDir();\n\
	    kMovingDir:Multiply(fDistance);\n\
	    local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
	    kTargetPos:Add(kMovingDir);\n\
\n\
		if kAction:GetID() == \"a_Hammer Crush\" then\n\
			actor:AttachParticleToPoint(8,kTargetPos,\"ef_Hammer_Crush_01\");\n\
			actor:AttachSound(106,\"HammerCrush\");\n\
		elseif kAction:GetID() == \"a_Fire Youth\" then\n\
			actor:AttachParticleToPoint(8,kTargetPos,\"ef_Fire_hammer_01\");\n\
			actor:AttachSound(106,\"Fire_Hammer\");\n\
		elseif kAction:GetID() == \"a_Heartless Life\" then\n\
			actor:AttachParticleToPoint(8,kTargetPos,\"ef_Ice_hammer_01\");\n\
			actor:AttachSound(106,\"Ice_Hammer\");\n\
		end\n\
\n\
	    if actor:IsMyActor() then\n\
    	    kAction:CreateActionTargetList(actor);   --   \n\
	    \n\
	        if IsSingleMode() then\n\
	            HammerCrush_OnTargetListModified(actor,kAction,false)\n\
	        else\n\
	            kAction:BroadCastTargetListModify(actor:GetPilot());\n\
	        end\n\
	    \n\
	    end\n\
				\n\
		if actor:IsMyActor() then\n\
			QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
			, g_fMeleeDropQuakeValue[2]\n\
			, g_fMeleeDropQuakeValue[3]\n\
			, g_fMeleeDropQuakeValue[4]\n\
			, g_fMeleeDropQuakeValue[5])\n\
		end		\n\
								\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function ShoulderTackle_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function ShoulderTackle_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ShoulderTackle_Fire(actor,action);\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function ShoulderTackle_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,0,0);\n\
	action:SetParamFloat(2,actor:GetPos():GetX());	--	  \n\
	action:SetParamFloat(3,actor:GetPos():GetY());	--	  \n\
	action:SetParamFloat(4,actor:GetPos():GetZ());	--	  \n\
	action:SetParamFloat(5,g_world:GetAccumTime());	--	  \n\
	action:SetParamInt(6,0)	--	Step	\n\
		\n\
	actor:FreeMove(true);\n\
	actor:StopJump();\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
\n\
	--local	iBaseClassID = actor:GetPilot():GetBaseClassID()\n\
	--if iBaseClassID == CT_MAGICIAN then\n\
		--actor:AttachParticle(494,\"char_root\",\"ef_Lightningamor_01_char_root\");\n\
	--end	\n\
end\n\
function ShoulderTackle_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	return	ShoulderTackle_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function ShoulderTackle_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 50\n\
	end\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local	iFoundTarget = action:FindTargetsEx(iActionNo,TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"ShoulderTackle_FindTargetEx iActionNo:\"..iActionNo..\" iAttackRange:\"..iAttackRange..\" iFoundTarget:\"..iFoundTarget..\"\\n\");\n\
\n\
	\n\
	return	iFoundTarget;\n\
end\n\
\n\
function ShoulderTackle_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	SkillFunc_InitUseDmgEffect(action)\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"ShoulderTackle_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	ShoulderTackle_OnCastingCompleted(actor,action);\n\
\n\
	--   \n\
	action:SetParamAsPoint(7, actor:GetPos());\n\
	\n\
	return true\n\
end\n\
\n\
function ShoulderTackle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local	iStep = action:GetParamInt(6);\n\
\n\
	local curAnimSlot = action:GetCurrentSlot();\n\
\n\
	if curAnimSlot == 0 then\n\
		if animDone == true then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
			local	iBaseClassID = actor:GetPilot():GetBaseClassID()\n\
			if iBaseClassID == CT_FIGHTER then\n\
				actor:AttachParticle(493,\"char_root\",\"ef_fig_tackle_char_root\");\n\
			elseif iBaseClassID == CT_MAGICIAN then\n\
				actor:AttachParticle(494,\"char_root\",\"ef_Lightningamor_01_char_root\");\n\
			end\n\
\n\
			local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
			if kSoundID~=\"\" then\n\
				actor:AttachSound(2783,kSoundID);\n\
			end	\n\
		end	\n\
	else\n\
		if action:GetActionParam() == AP_FIRE then\n\
			local	kStartPos = Point3(action:GetParamFloat(2),action:GetParamFloat(3),action:GetParamFloat(4));\n\
			local	fMoveSpeed = 600;\n\
			   \n\
			local kNewPos = actor:GetPos();\n\
			local kOldPos = action:GetParamAsPoint(7);\n\
			kOldPos:SetZ(0)\n\
			kNewPos:SetZ(0); --Z  .     \n\
\n\
			local fDistance = kNewPos:Distance(kOldPos);\n\
			local fMaxDistance = action:GetSkillRange(0,actor)-30;\n\
\n\
			--   \n\
			if 0.0 < fDistance then\n\
				--  \n\
				local fDistance2 = fMaxDistance - fDistance;\n\
\n\
				--     \n\
				--       .\n\
				local kDirection = kNewPos:_Subtract(kOldPos);\n\
				kDirection:Unitize();\n\
				kDirection:Multiply(fMoveSpeed * frameTime);\n\
				kDirection:Add(kNewPos);\n\
\n\
				--    \n\
				local fDistance3 = kDirection:Distance(kOldPos);\n\
\n\
				--      \n\
				if fMaxDistance - fDistance3 < 0 then\n\
					--fMoveSpeed   .				\n\
					fMoveSpeed = fDistance2 / frameTime;\n\
				end\n\
			end\n\
		\n\
			local kMovingDir = actor:GetLookingDir()\n\
			kMovingDir:Multiply(fMoveSpeed);\n\
			\n\
			actor:SetMovingDelta(kMovingDir);\n\
			\n\
			local	fCurrentDistance = kStartPos:Distance(actor:GetPos());\n\
			local	fElapsedTime = accumTime - action:GetParamFloat(5);\n\
\n\
			ODS(\"fCurrentDistance : \" .. fCurrentDistance .. \" fMaxDistance : \" .. fMaxDistance .. \" fElapsedTime : \" .. fElapsedTime, false, 1509);\n\
			ODS(\"\\n\", false, 1509);\n\
			\n\
			if fCurrentDistance >= fMaxDistance or fElapsedTime > 1 or 1 > fMoveSpeed then\n\
				\n\
				action:SetParamInt(6,1);\n\
				action:SetParamFloat(5,accumTime);\n\
				\n\
				ShoulderTackle_DoDamageToTargets(actor);\n\
				\n\
				actor:DetachFrom(493);\n\
				\n\
				local curActionParam = action:GetParam(0)\n\
				if curActionParam == \"GoNext\" then\n\
					nextActionName = action:GetParam(1);\n\
\n\
					action:SetParam(0, \"null\")\n\
					action:SetParam(1, \"end\")\n\
					\n\
					action:SetNextActionName(nextActionName)\n\
					return false;\n\
				else\n\
				\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end						\n\
			\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function ShoulderTackle_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(493);\n\
	actor:DetachFrom(494);\n\
	actor:EndBodyTrail();\n\
	actor:FreeMove(false);\n\
	\n\
	return true;\n\
end\n\
\n\
function ShoulderTackle_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
--[[\n\
function ShoulderTackle_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
\n\
	local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
		local nUnitSize = actorTarget:GetAbil(AT_UNIT_SIZE);\n\
		local nEffectScale = 1.0;\n\
		if 1 == nUnitSize then --1:Small\n\
			nEffectScale = 1.0;\n\
			ODS(\"Small Monster\\n\");\n\
		elseif 2 == nUnitSize then --2:Middle\n\
			nEffectScale = 1.5;\n\
			ODS(\"Middle Monster\\n\");\n\
		elseif 3 == nUnitSize then --3:Large\n\
			nEffectScale = 2.0;\n\
			ODS(\"Large Monster\\n\");\n\
		end\n\
		\n\
        actorTarget:AttachParticleS(12,kHitTargetEffectTargetNodeID,kHitTargetEffectID, nEffectScale);\n\
	else\n\
		if kActionResult:GetCritical() then\n\
			actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
		else\n\
			actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
		end	\n\
	end\n\
		\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	\n\
	--   \n\
    local actionName = kActionID\n\
	if kActionResult:GetCritical() then\n\
		actionName = \"Critical_dmg\"\n\
	end\n\
	actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, kActionTargetInfo);\n\
end\n\
]]\n\
function ShoulderTackle_DoDamageToTargets(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	ODS(\"ShoulderTackle_DoDamageToTargets\\n\");\n\
	local	kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,kAction, true);\n\
\n\
end\n\
\n\
\n\
function ShoulderTackle_OnEvent(actor,textKey)\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_WEAPON_TRAIL] :    \n\
\n\
-- Melee\n\
function StormBlade_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function StormBlade_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	StormBlade_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function StormBlade_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel StormBlade_Fire\\n\");\n\
	\n\
	if actor:IsMyActor() then\n\
		action:StartTimer(2.4,0.2,0);\n\
	end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
			\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
		\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(3,g_world:GetAccumTime())	--	  \n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	action:SetParamInt(4,1)	--	Start Rotation\n\
	action:SetParamFloat(5,g_world:GetAccumTime())	--	Rotation Start Time\n\
	action:SetParamFloat(6,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(7,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(8,actor:GetLookingDir():GetZ());\n\
	action:SetParamInt(9,0)	--	Hit Count	\n\
	action:SetParamFloat(10,g_world:GetAccumTime());\n\
	action:SetParamFloat(11,actor:GetPos():GetX());\n\
	action:SetParamFloat(12,actor:GetPos():GetY());\n\
	action:SetParamFloat(13,actor:GetPos():GetZ());\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	 local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
	local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
	\n\
	if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
		local	fFireEffectScale = tonumber(action:GetScriptParam(\"FIRE_CASTER_EFFECT_SCALE\"));\n\
		if(0 == fFireEffectScale) then fFireEffectScale = 1 end\n\
		\n\
		if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
			\n\
			local   kDir = actor:GetLookingDir();\n\
			local   fDistance = 30;\n\
			kDir:Multiply(fDistance);\n\
			kDir:Add(actor:GetPos());\n\
			kDir:SetZ(kDir:GetZ()-28);\n\
			\n\
			actor:AttachParticleToPointS(7212,kDir,kFireEffectID, fFireEffectScale);\n\
		elseif kFireEffectTargetNodeID ~= \"\" then\n\
			actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPointS(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID, fFireEffectScale);\n\
		else\n\
			actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion(), fFireEffectScale)\n\
		end\n\
	\n\
	end	\n\
	kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
	kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
	if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then	\n\
		if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then			\n\
			local   kDir = actor:GetLookingDir();\n\
			local   fDistance = 30;\n\
			kDir:Multiply(fDistance);\n\
			kDir:Add(actor:GetPos());\n\
			kDir:SetZ(kDir:GetZ()-28);			\n\
			actor:AttachParticleToPoint(7213,kDir,kFireEffectID);			\n\
		else\n\
			actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
		end	\n\
	end		\n\
\n\
	local iTotalHit = 0;\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
	if kSkillDef:IsNil() == false then\n\
		iTotalHit  = kSkillDef:GetAbil(AT_COUNT);\n\
	end\n\
\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
		if kSkillDef:IsNil() == false then\n\
			iTotalHit = kSkillDef:GetAbil(AT_LEVEL) + 1;\n\
		end		\n\
	end\n\
	\n\
--	action:GetID() == \"a_Sky Pirce01\"\n\
\n\
	action:SetParamInt(30,iTotalHit);\n\
	ODS(\"iTotalHit : \"..iTotalHit..\"\\n\");\n\
	\n\
end\n\
function StormBlade_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
    end\n\
\n\
end\n\
\n\
function StormBlade_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"StormBlade_OnTimer fAccumTime:\"..fAccumTime..\"\\n\",false, 1509);\n\
\n\
	local	iHitCount = action:GetParamInt(9);\n\
	local	iTotalHit = action:GetParamInt(30);	\n\
	if iHitCount == iTotalHit then\n\
		return true\n\
	end\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	if 0 < iTargetCount then\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(10,g_world:GetAccumTime());	\n\
	\n\
	ODS(\"StormBlade_HitOneTime iHitCount:\"..iHitCount..\"\\n\",false, 1509);	\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(9,iHitCount);\n\
		\n\
	return	true	\n\
\n\
end\n\
\n\
function StormBlade_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	return	StormBlade_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function StormBlade_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = Point3(action:GetParamFloat(11),action:GetParamFloat(12),action:GetParamFloat(13) - 30);\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,Point3(0,0,1));\n\
	kParam:SetParam_2(400,iAttackRange*2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
\n\
	local iFound = action:FindTargetsEx(iActionNo,TAT_BAR,kParam,kTargets,kTargets);\n\
	return iFound;\n\
end\n\
\n\
function StormBlade_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
-- 	local actorID = actor:GetID()\n\
-- 	local actionID = action:GetID()\n\
-- 	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	local fRigingMovingDelta = action:GetScriptParamAsFloat(\"RISING_MOVING_DELTA\")\n\
	if(0 == fRigingMovingDelta) then fRigingMovingDelta = 50 end\n\
	action:SetParamFloat(20, fRigingMovingDelta)\n\
	StormBlade_OnCastingCompleted(actor,action);\n\
	\n\
	SkillFunc_InitSpinDegPerSec(action)\n\
	return true\n\
end\n\
\n\
function StormBlade_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	local	iTotalHit = action:GetParamInt(30);\n\
\n\
	local	fElapsedTime = accumTime - action:GetParamFloat(3);\n\
	if fElapsedTime > ((0.2 * iTotalHit) + 0.1) or action:GetParamInt(9) >= iTotalHit then\n\
		ODS(\"\\n EndEndEnd \\n\",false, 1509)\n\
	\n\
		actor:FreeMove(false);\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
			\n\
	end\n\
	if action:GetParamInt(9) < iTotalHit then\n\
		ODS(\"\\n---------- Cur Hit \"..action:GetParamInt(9)..\"     Total \"..iTotalHit..\"    ---------\\n\",false, 1509)\n\
		\n\
		local fSpinDeg = SkillFunc_GetSpinDegPerSec(action)\n\
		if(0 < fSpinDeg) then\n\
			actor:IncRotate(frameTime*fSpinDeg*DEGTORAD);\n\
		end\n\
		local fRigingMovingDelta = action:GetParamFloat(20)\n\
		actor:SetMovingDelta(Point3(0,0,fRigingMovingDelta));\n\
		\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function StormBlade_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	ODS(\"RestoreItemModel StormBlade_ReallyLeave\\n\");\n\
	\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
	actor:DetachFrom(7212, true)\n\
	actor:FreeMove(false);\n\
	actor:StopJump();\n\
	\n\
	if actor:GetAction():GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function StormBlade_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if curParam == \"end\" then \n\
			action:SetSlot(2);\n\
			action:SetDoNotBroadCast(true);\n\
			return true;\n\
		end\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function StormBlade_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
	if kActionResult:GetCritical() then\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	else\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	end	\n\
	\n\
\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	\n\
	--   \n\
	\n\
\n\
end\n\
--[[\n\
function StormBlade_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i = 0;\n\
	if iTargetCount>0 then\n\
		\n\
		ODS(\" \\n\",false, 1509)\n\
		local bWeaponSoundPlayed = false;\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
					if bWeaponSoundPlayed == false then\n\
					    bWeaponSoundPlayed = true;\n\
					    local actionName = action:GetID()\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
						actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
					end\n\
					\n\
					StormBlade_DoDamage(actor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
					\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
			\n\
	action:GetTargetList():ApplyActionEffects();	\n\
end\n\
]]\n\
function StormBlade_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
\n\
-- Melee\n\
function SwordDance_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function SwordDance_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	SwordDance_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	SwordDance_LoadToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
\n\
	local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
		if 0 == iSkillLevel then\n\
		iSkillLevel = 1;\n\
	end\n\
\n\
	kNewArrow:SetParamValue(\"SkillLevel\", \"\"..iSkillLevel);\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function SwordDance_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
function SwordDance_OnFindTarget(actor,action,kTargets)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	     .\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),50,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local iFoundCount = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);		\n\
	\n\
	if iFoundCount == 0 then\n\
		return	iFoundCount;\n\
	end\n\
\n\
	return iFoundCount;\n\
	\n\
	--	     .\n\
--	local	kTargetInfo = kTargets:GetTargetInfo(0);\n\
--	local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());			\n\
	\n\
--	kParam:SetParam_1(kTargetPilot:GetActor():GetPos(),actor:GetLookingDir());\n\
--	kParam:SetParam_2(0,0,50,0);\n\
--	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
--	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);	\n\
	\n\
end\n\
\n\
function SwordDance_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	SwordDance_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function SwordDance_OnUpdate(actor, accumTime, frameTime)\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	--if action:GetParam(1) == \"end\" then\n\
	--	return	false;\n\
	--end\n\
\n\
	if animDone == true then\n\
		return false;\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function SwordDance_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	--if actor:GetAction():GetParamInt(4) == 1 then\n\
		actor:HideParts(6, false)	--	  \n\
	--	actor:GetAction():SetParamInt(4,0);\n\
	--end	\n\
\n\
	return true;\n\
end\n\
\n\
function SwordDance_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
		\n\
	return true;\n\
--[[	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false ]]--\n\
end\n\
\n\
function SwordDance_SwordReturn(actor,iActionInstanceID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(6, false)	--	  \n\
			action:SetParamInt(4,0);\n\
		end\n\
	\n\
		action:SetParam(1,\"end\");\n\
	\n\
	end\n\
\n\
end\n\
\n\
function SwordDance_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"SwordDance_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if (textKey == \"hit\" or textKey == \"fire\") and kAction:GetParamInt(5) == 0 then\n\
	\n\
	    kAction:SetParamInt(5,1);   --    \n\
	    \n\
		actor:AttachSound(3852,\"ShieldBoom\");\n\
\n\
		actor:HideParts(6, true)	--	 \n\
		kAction:SetParamInt(4,1);	--	 \n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = SwordDance_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			local	iTargetCount = kAction:GetTargetCount();\n\
			local	iTargetABVShapeIndex = 0;\n\
			local	kActionTargetInfo = nil\n\
			local	kTargetABVPos = nil;\n\
			if iTargetCount>0 then\n\
					--	  \n\
				local	kTargetGUID = kAction:GetTargetGUID(0);\n\
				iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
				kActionTargetInfo = kAction:GetTargetInfo(0);\n\
				targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
				if targetobject:IsNil() == false then\n\
					kTargetABVPos = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
					actor:LookAt(kTargetABVPos);\n\
				end						\n\
			end\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
				\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kMovingDir:Add(arrow_worldpos);\n\
				kArrow:SetTargetLoc(kMovingDir);	\n\
				\n\
			else\n\
				kArrow:SetTargetObjectList(kAction:GetTargetList());	\n\
				\n\
				if targetobject ~= nil and targetobject:IsNil() == false then\n\
				\n\
					local	kArrowTargetPos = Point3(kTargetABVPos:GetX(),kTargetABVPos:GetY(),arrow_worldpos:GetZ());\n\
					kArrow:SetTargetLoc(kArrowTargetPos);			\n\
				\n\
				end\n\
				\n\
			end\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_COUNT] :   ( 2,3 )\n\
\n\
function MagMultiShot_OnCheckCanEnter(actor,action)\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function MagMultiShot_OnCastingCompleted(actor, action)\n\
	MagMultiShot_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+3);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function MagMultiShot_Fire(actor,action)\n\
	action:SetParamInt(5,3)\n\
\n\
end\n\
\n\
function MagMultiShot_OnEnter(actor, action)\n\
	if actor:IsMyActor() == true then\n\
	\n\
		action:SetParamInt(6,0);	--	   3 .      \n\
	\n\
\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	MagMultiShot_OnCastingCompleted(actor,action);\n\
	\n\
	actor:StopJump();\n\
	\n\
	return true\n\
end\n\
function MagMultiShot_OnFindTarget(actor,action,kTargets)\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 350\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 30;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local	arrow_worldpos = actor:GetPos();--kNewArrow:GetWorldPos();	--	 \n\
	\n\
--  \n\
	local	kRotateAxis = Point3(0,0,1)\n\
	local	fRotateAngle = 30.0*math.pi/180.0;\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);		\n\
\n\
	local	kFireTarget = actor:GetLookingDir()\n\
\n\
    --SetBreak();\n\
	kFireTarget:Rotate(kRotateAxis,fRotateAngle*(-1))\n\
	kParam:SetParam_1(arrow_worldpos,kFireTarget);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	kFireTarget = actor:GetLookingDir()\n\
	kFireTarget:Rotate(kRotateAxis,fRotateAngle*(0));\n\
	kParam:SetParam_1(arrow_worldpos,kFireTarget);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	kFireTarget = actor:GetLookingDir()\n\
	kFireTarget:Rotate(kRotateAxis,fRotateAngle*(1));\n\
	kParam:SetParam_1(arrow_worldpos,kFireTarget);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
end\n\
\n\
function MagMultiShot_FindTargets(actor,action)\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function MagMultiShot_LoadToWeapon(actor,action)\n\
\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	kNewArrow:LoadToWeapon(actor);\n\
	kNewArrow:SetScale(0.7);\n\
	\n\
	return	kNewArrow;\n\
end\n\
function MagMultiShot_LoadToPos(actor,action,pos)\n\
\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	kNewArrow:LoadToPosition(pos);\n\
	kNewArrow:SetScale(0.7);\n\
	\n\
	return	kNewArrow;\n\
end\n\
function MagMultiShot_OnUpdate(actor, accumTime, frameTime)	\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	local	actionID = action:GetID();\n\
	if action:GetParam(300) == \"finish\" then\n\
		return	false;\n\
	end\n\
	if actor:IsMyActor() and action:GetParamInt(6) == 0 then\n\
		if KeyIsDown(action:GetActionKeyNo(0)) == false then\n\
			action:SetParamInt(6,3);\n\
		end\n\
	end\n\
\n\
	if animDone == true then\n\
		\n\
		if actor:IsMyActor() and actor:GetAction():GetParamInt(6) == 0 then	--	   .    \n\
			action:SetNextActionName(\"a_magician_charge_laser\");\n\
		end	\n\
			\n\
		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(3);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(3, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(3, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
\n\
	--  \n\
	local fMovingSpeed = 0;\n\
\n\
	if IsSingleMode() == true then\n\
		fMovingSpeed = 120\n\
	else\n\
	    fMovingSpeed = actor:GetAbil(AT_C_MOVESPEED)\n\
	end	\n\
\n\
	local dir = actor:GetDirection()\n\
	if dir ~= DIR_NONE then\n\
		actor:Walk(dir, fMovingSpeed)\n\
	end\n\
\n\
	return true\n\
end\n\
function MagMultiShot_OnCleanUp(actor)\n\
	return true;\n\
end\n\
function MagMultiShot_OnLeave(actor, action)\n\
	local	curAction = actor:GetAction();\n\
	local	curParam = curAction:GetParam(3)\n\
	local	actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" or curAction:GetParam(300)==\"finish\" then\n\
		return true;\n\
	end	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
\n\
	if actionID == \"a_MagicianShot_01\" then \n\
		return false;\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(3,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function MagMultiShot_Fire3(actor,action)\n\
\n\
	local	kProjectileMan = GetProjectileMan();\n\
	\n\
	--  \n\
	local	kRotateAxis = Point3(0,0,1);\n\
	local fRotateAngle = 30.0*(math.pi/180.0)\n\
	local	i = 0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	while i<3 do\n\
	\n\
		local	kArrow = MagMultiShot_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i-1));\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
		i=i+1;\n\
	end\n\
	\n\
end\n\
\n\
function MagMultiShot_Fire2(actor,action)\n\
\n\
	local	kProjectileMan = GetProjectileMan();\n\
	\n\
	local	kPathNormal = actor:GetLookingDir();\n\
	kPathNormal:Cross(Point3(0,0,1));\n\
	local	kCenterPos = actor:GetPos();\n\
\n\
	local	fDistance = 10.0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 100\n\
	end\n\
	\n\
	local	i=0\n\
	\n\
	while i<2 do\n\
	\n\
		local	kArrowPos = kCenterPos:_Add(kPathNormal:_Multiply(fDistance));\n\
\n\
		local	kArrow = MagMultiShot_LoadToPos(actor,action,kArrowPos);\n\
\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Add(kArrowPos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
		\n\
		i=i+1;\n\
		\n\
		fDistance=fDistance*-1;\n\
\n\
	end\n\
	\n\
end\n\
\n\
function MagMultiShot_OnEvent(actor, textKey)\n\
\n\
	if textKey == \"fire\" or textKey==\"hit\" or textKey == \"end\" then\n\
	\n\
		if actor:GetAction():GetParam(7) == \"FIRED\" then\n\
			return true\n\
		end\n\
	\n\
		local	action = actor:GetAction()\n\
		\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(3784,kSoundID);\n\
		end	\n\
\n\
		actor:AttachParticle(433,\"char_root\",\"shot_rebound_01\");\n\
		\n\
		local	iFireCount = tonumber(action:GetScriptParam(\"FIRE_COUNT\"));\n\
		if iFireCount == nil or iFireCount == 0 then\n\
			iFireCount = 3\n\
		end\n\
		\n\
		if iFireCount == 3 then\n\
			MagMultiShot_Fire3(actor,action);\n\
		elseif iFireCount == 2 then\n\
			MagMultiShot_Fire2(actor,action);\n\
		end\n\
		\n\
		\n\
		actor:GetAction():SetParam(7,\"FIRED\");\n\
\n\
	end\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [UPGRADE_PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
\n\
-- Melee\n\
function Fortress_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Fortress_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    ODS(\"Fortress_OnCastingCompleted\\n\");\n\
    \n\
	Fortress_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Fortress_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
\n\
	local iUpgrade = action:GetParamInt(100);\n\
	if 1 == iUpgrade then\n\
		kProjectileID = action:GetScriptParam(\"UPGRADE_PROJECTILE_ID\");\n\
	end\n\
	\n\
	ODS(\"Fortress_LoadToWeapon kProjectileID:\"..kProjectileID..\"\\n\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	if actor:GetID() == \"sa_auto_shoot_system\" then\n\
    	local   kPos = actor:GetNodeWorldPos(\"Siege_Cannon:0\");\n\
    	kNewArrow:LoadToPosition(kPos);\n\
	else\n\
    	kNewArrow:LoadToHelper(actor,\"Bip01 Head\");	--	\n\
	end\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Fortress_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    ODS(\"Fortress_Fire\\n\");\n\
	\n\
	actor:ResetAnimation();\n\
\n\
	if actor:IsMyActor() == true then\n\
		local iUpgrade = 0\n\
		local iProjectileSpeedRate = 0;\n\
		local	kSkillDef = GetSkillDef(action:GetActionNo());\n\
		if kSkillDef:IsNil() == false then\n\
			iProjectileSpeedRate = kSkillDef:GetAbil(AT_PROJECTILE_SPEED_RATE);\n\
			local iNeedBaseSkill = kSkillDef:GetAbil(AT_CHILD_SKILL_NUM_01);\n\
			local iUpgradeSkill = actor:CheckSkillExist(iNeedBaseSkill);\n\
\n\
			if 0 ~= iUpgradeSkill then\n\
				iUpgrade = 1;\n\
			end\n\
\n\
			iNeedBaseSkill = kSkillDef:GetAbil(AT_CHILD_SKILL_NUM_02);\n\
			iUpgradeSkill = actor:CheckSkillExist(iNeedBaseSkill);\n\
\n\
			if 0 ~= iUpgradeSkill then\n\
				local	kSkillDef2 = GetSkillDef(iUpgradeSkill);\n\
				if kSkillDef2:IsNil() == false then					\n\
					iProjectileSpeedRate = iProjectileSpeedRate + kSkillDef2:GetAbil(AT_PROJECTILE_SPEED_RATE);\n\
				end\n\
			end\n\
		end\n\
\n\
		action:SetParamInt(100,iUpgrade);\n\
		action:SetParamInt(101,iProjectileSpeedRate);\n\
	else\n\
		local kPacket = action:GetParamAsPacket();\n\
		local iValue = kPacket:PopInt();\n\
		action:SetParamInt(100, iValue);\n\
		iValue = kPacket:PopInt();\n\
		action:SetParamInt(101,iValue);\n\
	end	\n\
end\n\
\n\
function Fortress_OnOverridePacket(actor,action,packet)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    if action:GetActionParam() == AP_FIRE then\n\
		local iValue = action:GetParamInt(100);		\n\
		packet:PushInt(iValue);\n\
		iValue = action:GetParamInt(101);\n\
		packet:PushInt(iValue);\n\
    end    \n\
end\n\
\n\
\n\
function Fortress_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	     .\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),50,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local iFoundCount = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);		\n\
	\n\
	if iFoundCount == 0 then\n\
		return	iFoundCount;\n\
	end\n\
	\n\
	--	     .\n\
	local	kTargetInfo = kTargets:GetTargetInfo(0);\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());			\n\
	\n\
	kParam:SetParam_1(kTargetPilot:GetActor():GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,g_fFortress_Blow_Range,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);		\n\
\n\
end\n\
\n\
function Fortress_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Fortress_OnCastingCompleted(actor,action);\n\
\n\
	local iUpgrade = action:GetParamInt(100);		\n\
	local iInstanceID = 0;\n\
	if 1 == iUpgrade then\n\
		iInstanceID = GetStatusEffectMan():AddStatusEffectToActor(actor:GetPilotGuid(),\"se_fortress_head_powerUp\",0,1);	\n\
	else\n\
		iInstanceID = GetStatusEffectMan():AddStatusEffectToActor(actor:GetPilotGuid(),\"se_fortress_head\",0,1);\n\
	end\n\
	\n\
	action:SetParamInt(2,iInstanceID);	\n\
	if(0 == Config_GetValue(HEADKEY_ETC, SUBKEY_DISPLAY_HELMET)) then --    \n\
		if actor:CheckStatusEffectExist(\"se_hide_face\") then	--  \n\
			actor:HideParts(EQUIP_POS_FACE, false);	--    \n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Fortress_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Fortress_OnCleanUp(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kAction = actor:GetAction();\n\
	local	iInstanceID = kAction:GetParamInt(2);\n\
	\n\
	GetStatusEffectMan():RemoveStatusEffectFromActor2(actor:GetPilotGuid(),iInstanceID);\n\
	if(0 == Config_GetValue(HEADKEY_ETC, SUBKEY_DISPLAY_HELMET)) then --    \n\
		if actor:CheckStatusEffectExist(\"se_hide_face\") then	--     \n\
			actor:HideParts(EQUIP_POS_FACE, true);	--  \n\
		end\n\
	end\n\
	return true;\n\
end\n\
\n\
function Fortress_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Fortress_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Fortress_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		ODS(\"Fortress_OnEvent iAttackRange:\"..iAttackRange..\"\\n\");\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		actor:AttachParticle(378,\"char_root\",\"ef_mag_cannon_char_root\");\n\
		actor:AttachParticle(379,\"char_root\",\"ef_mag_cannon_01_char_root\");		\n\
		\n\
		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Fortress_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			ODS(\"kMovingDir:\"..kMovingDir:GetX()..\",\"..kMovingDir:GetY()..\",\"..kMovingDir:GetZ()..\"\\n\");\n\
			\n\
			if kMovingDir:IsZero() then\n\
			    kMovingDir:SetX(1);\n\
			end\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
				\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
				\n\
			\n\
			kArrow:Fire();\n\
			local iSpeedRate = kAction:GetParamInt(101);\n\
			iSpeedRate = iSpeedRate / ABILITY_RATE_VALUE;\n\
			if 0 < iSpeedRate then\n\
				kArrow:SetSpeed(kArrow:GetSpeed() * iSpeedRate);\n\
			end\n\
\n\
			ODS(\"Fire\\n\");\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
\n\
-- Melee\n\
function Archer_Power_Shot_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
    if actor:IsMyActor() == false then\n\
        return true\n\
    end\n\
    \n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then\n\
	    actor:ReserveTransitAction(\"a_archer_shot_01\");\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Archer_Power_Shot_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	Archer_Power_Shot_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Archer_Power_Shot_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
\n\
	return	kNewArrow;\n\
end\n\
\n\
function Archer_Power_Shot_Fire(actor,action)\n\
		\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if actor:IsMyActor() == true then\n\
        action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
end\n\
function Archer_Power_Shot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),30,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);		\n\
end\n\
\n\
function Archer_Power_Shot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	\n\
	ODS(\"Archer_Power_Shot_OnEnter ComboCount : \"..actor:GetComboCount()..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then	\n\
			\n\
			--    \n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		if actor:GetComboCount()<2 then\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end		\n\
	end\n\
	\n\
	actor:SetComboCount(0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Archer_Power_Shot_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Archer_Power_Shot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Archer_Power_Shot_OnCleanUp(actor,action)\n\
	return true;\n\
end\n\
\n\
function Archer_Power_Shot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Archer_Power_Shot_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Archer_Power_Shot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Archer_Power_Shot_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
		local pt = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			local	iTargetCount = kAction:GetTargetCount();\n\
			local	iTargetABVShapeIndex = 0;\n\
			local	kActionTargetInfo = nil\n\
			if iTargetCount>0 then\n\
					--	  \n\
				local	kTargetGUID = kAction:GetTargetGUID(0);\n\
				iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
				kActionTargetInfo = kAction:GetTargetInfo(0);\n\
				targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
				if targetobject:IsNil() == false then\n\
					pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
					actor:LookAt(pt);\n\
				end						\n\
			end\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
				\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kMovingDir:Add(arrow_worldpos);\n\
				kArrow:SetTargetLoc(kMovingDir);	\n\
				\n\
			else\n\
				kArrow:SetTargetObjectList(kAction:GetTargetList());	\n\
				\n\
			    if pt ~= nil then\n\
    			\n\
				    local	kTargetPoint = Point3(pt:GetX(),pt:GetY(),arrow_worldpos:GetZ());\n\
				    kArrow:SetTargetLoc(kTargetPoint);\n\
    			\n\
			    end		\n\
			    				\n\
			end\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function ArcherFloatShot_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function ArcherFloatShot_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") \n\
	or actor:CheckStatusEffectExist(\"se_transform_to_Dancer\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Fig\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Mag\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Arc\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Thi\")then\n\
		return false;\n\
	end\n\
--	local	iFloatShotCount = tonumber(actor:GetParam(\"FLOAT_SHOT_COUNT\"));\n\
--	if iFloatShotCount == nil then\n\
--		 iFloatShotCount = 0\n\
--	end\n\
--	\n\
--	if iFloatShotCount>7 then\n\
--		return	false\n\
--	end\n\
	\n\
	--if actor:GetParam(\"FLOAT_ATTACK_ENABLE\")==\"FALSE\" then\n\
	--	return false;\n\
	--end\n\
\n\
		\n\
	return		true;\n\
	\n\
end\n\
function ArcherFloatShot_FindTarget(kActor,kAction)\n\
	\n\
	if( CheckNil(nil==kActor) ) then return false end\n\
	if( CheckNil(kActor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = ArcherFloatShot_OnFindTarget(kActor,kAction,kTargets);\n\
	\n\
	return	kTargets;\n\
end\n\
function ArcherFloatShot_OnFindTarget(actor,action,kTargets)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	return	ArcherFloatShot_OnFindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
end\n\
\n\
function ArcherFloatShot_OnFindTargetEx(actor,action,iActionID,iAttackRange,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	arrow_worldpos = actor:GetPos();\n\
	\n\
--  \n\
	local	kRotateAxis = actor:GetLookingDir();\n\
	kRotateAxis:Cross(Point3(0,0,1));\n\
	kRotateAxis:Unitize();\n\
	local	fRotateAngle = 60.0*3.141592/180.0;\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);		\n\
\n\
	local	kFireTargetDir = actor:GetLookingDir();\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle);\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir);\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
\n\
\n\
function ArcherFloatShot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"ArcherFloatShot_OnEnter actionID:\"..actionID..\"\\n\");\n\
		\n\
		\n\
	if actor:IsMyActor() == true then\n\
		action:SetParam(4, \"\");\n\
		\n\
		if action:GetID() ~= \"a_ArcherFloatShot_01\" and\n\
		    action:GetID() ~= \"a_ArcherFloatShot_02\" and\n\
		    action:GetID() ~= \"a_ArcherFloatShot_03\" then\n\
		    \n\
			actor:SetComboCount(0);	\n\
			action:ChangeToNextActionOnNextUpdate(true,true);					\n\
			return true;		    \n\
		    \n\
		end\n\
		\n\
--		local	iFloatShotCount = tonumber(actor:GetParam(\"FLOAT_SHOT_COUNT\"));\n\
--		if iFloatShotCount == nil then\n\
--			 iFloatShotCount = 0\n\
--		end\n\
		\n\
--		if iFloatShotCount>7 then\n\
--			action:ChangeToNextActionOnNextUpdate(true,true);					\n\
--			return true;\n\
--		end		\n\
		\n\
--		iFloatShotCount=iFloatShotCount+1;\n\
--		actor:SetParam(\"FLOAT_SHOT_COUNT\",\"\"..iFloatShotCount);\n\
		\n\
	end\n\
			\n\
	ArcherFloatShot_Fire(actor,action);\n\
	\n\
	if action:GetTargetCount() == 0 then\n\
	\n\
	    --     1  JumpShot  .\n\
--	    actor:SetParam(\"Archer_Jump_Shot_Fired\",\"FALSE\");\n\
  --      action:SetNextActionName(\"a_archer_jump_shot\");\n\
    --    action:ChangeToNextActionOnNextUpdate(true,true);	    \n\
      --  return true;\n\
	\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
			\n\
	action:SetParamInt(6,0);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end	\n\
	\n\
	return true\n\
end\n\
function ArcherFloatShot_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iTargetCount = 0;\n\
\n\
	if actor:IsMyActor() == true then\n\
	\n\
		local kTargets = ArcherFloatShot_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);\n\
		\n\
		iTargetCount = kTargets:size();\n\
		\n\
	end\n\
	\n\
	iTargetCount = action:GetTargetCount();\n\
	ODS(\"ArcherFloatShot_Fire iTargetCount : \"..iTargetCount..\"\\n\");	\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(0);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	ArcherFloatShot_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	kAttackNodeName = \"p_ef_heart\";\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
	return kNewArrow;\n\
	\n\
end\n\
\n\
function ArcherFloatShot_Finished(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local	actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	actor:SetNormalAttackEndTime();\n\
			\n\
	if actor:IsMyActor() then\n\
	\n\
		if KeyIsDown(KEY_CHARGE) == true then\n\
			actor:ReserveTransitAction(action:GetID(),DIR_NONE);\n\
			action:SetParam(0,\"null\");\n\
			action:SetParam(1, \"end\")\n\
			return	false;\n\
		end\n\
	end\n\
				\n\
	local curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = action:GetParam(1);\n\
		action:SetNextActionName(nextActionName)\n\
		\n\
		if nextActionName ~= \"a_archer_shot_01\" then\n\
			actor:SetComboCount(0)\n\
			ODS(\"actor:SetComboCount(0) 0\\n\");\n\
			actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
		end\n\
	end\n\
	\n\
	if action:GetParam(2) ~= \"ATTACKED\" then\n\
		actor:SetComboCount(0)\n\
		actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
		\n\
		ODS(\"actor:SetComboCount(0) 1\\n\");\n\
	end\n\
	\n\
	\n\
	action:SetParam(0, \"null\")\n\
	action:SetParam(1, \"end\")\n\
end\n\
\n\
function ArcherFloatShot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if animDone == true then\n\
		return	ArcherFloatShot_Finished(actor,action);\n\
	end\n\
	\n\
	return true\n\
end\n\
function ArcherFloatShot_OnCleanUp(actor,action)\n\
	return true;\n\
end\n\
function ArcherFloatShot_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
		\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"ArcherFloatShot_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if  actionID == \"a_jump\" then \n\
		return  false;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end	\n\
	\n\
	if actionID == \"a_back_step\" then\n\
		return	true\n\
	end\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function ArcherFloatShot_DoEffect(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then	--	 DB  ...\n\
		iAttackRange = 200\n\
	end\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = ArcherFloatShot_LoadToWeapon(actor,action);\n\
	\n\
\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
\n\
		local iPentrationCount = actor:GetAbil(AT_PENETRATION_COUNT);\n\
		kArrow:SetPenetrationCount(iPentrationCount);\n\
		if iPentrationCount ~= 0 then\n\
			kArrow:SetMultipleAttack(true);\n\
		end\n\
\n\
			\n\
--		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
		local	pt = nil;\n\
		if iTargetCount>0 then\n\
				--	  \n\
			kActionTargetInfo = kTargetList:GetTargetInfo(0);\n\
\n\
			local	kTargetGUID = kActionTargetInfo:GetTargetGUID();\n\
			iTargetABVShapeIndex = kActionTargetInfo:GetABVIndex();\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt,true);\n\
			end						\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
	    local	kRotateAxis = actor:GetLookingDir();\n\
	    kRotateAxis:Cross(Point3(0,0,1));\n\
	    kRotateAxis:Unitize();\n\
	    local	fRotateAngle = 30.0*3.141592/180.0;\n\
	    local	kFireTargetDir = actor:GetLookingDir();\n\
	    kFireTargetDir:Rotate(kRotateAxis,fRotateAngle);\n\
	    kArrow:SetVelocity(kFireTargetDir);\n\
	    kArrow:SetMovingType(3)	\n\
	    kArrow:SetParam(500,2000,0);\n\
	    		\n\
		if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
			\n\
			kFireTargetDir:Multiply(iAttackRange-45);\n\
			kFireTargetDir:Add(arrow_worldpos);\n\
			kFireTargetDir:SetZ(kFireTargetDir:GetZ())\n\
			kArrow:SetTargetLoc(kFireTargetDir);	\n\
			\n\
		else\n\
				\n\
			kArrow:SetTargetObjectList(kTargetList);	\n\
			\n\
			if pt~= nil then\n\
			\n\
				local	fVariationAmount = 10.0\n\
				\n\
				pt:Add(Point3(math.random(-fVariationAmount,fVariationAmount),\n\
								math.random(-fVariationAmount,fVariationAmount),\n\
								math.random(-fVariationAmount,fVariationAmount)));\n\
				kArrow:SetTargetLoc(pt);\n\
				\n\
			\n\
			\n\
			end\n\
		\n\
		end\n\
		\n\
		kArrow:Fire();\n\
		ODS(\"MagicianShot Arrow Fire\\n\");\n\
		\n\
		kTargetList:clear();\n\
		actor:ClearIgnoreEffectList();\n\
	\n\
	end\n\
	\n\
	\n\
end\n\
\n\
function ArcherFloatShot_OnEvent(actor, textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"ArcherFloatShot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		\n\
		\n\
		\n\
		ArcherFloatShot_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Archer_Charge_Arrow_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then		--    .\n\
		return	false;\n\
	end	\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Archer_Charge_Arrow_OnCastingCompleted(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1);	\n\
	if actor:IsMyActor() == false then\n\
		Skill_Archer_Charge_Arrow_Fire(actor,action);\n\
	end		\n\
end\n\
function Skill_Archer_Charge_Arrow_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_Archer_Charge_Arrow_OnEnter\\n\");\n\
	\n\
	action:SetParamInt(3,0);\n\
	action:SetParamInt(1,0);\n\
	action:SetParamInt(5,0);\n\
				\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
		\n\
	else\n\
		if action:GetActionParam() == AP_FIRE then\n\
			Skill_Archer_Charge_Arrow_Fire(actor,action);\n\
		end\n\
		\n\
	end\n\
		\n\
	action:SetAutoBroadCastWhenCastingCompleted(false);	\n\
	action:SetParamInt(6,0);\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_fChargeFocusFilterValue[2]\n\
		, g_fChargeFocusFilterValue[3]\n\
		, g_fChargeFocusFilterValue[4]\n\
		,true\n\
		,true)\n\
		\n\
		GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
		\n\
		\n\
	end\n\
\n\
   return true\n\
end\n\
function Skill_Archer_Charge_Arrow_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(1,1);\n\
	\n\
	action:SetSlot(2);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	actor:AttachParticle(10,\"char_root\",\"ef_arrow_start01\");\n\
	action:SetParamInt(3,0);		\n\
	\n\
	if actor:IsMyActor() == true then\n\
	\n\
	    action:CreateActionTargetList(actor);\n\
		action:SetActionInstanceID();\n\
		action:BroadCast(actor:GetPilot());\n\
	\n\
	end\n\
end\n\
\n\
function Skill_Archer_Charge_Arrow_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),g_fChargingAttackAngle,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
end\n\
\n\
function Skill_Archer_Charge_Arrow_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(6);\n\
	local	bKeyCheck = KeyIsDown(action:GetActionKeyNo(0))\n\
	\n\
	if actor:IsMyActor() == false then\n\
		bKeyCheck = true;\n\
	end\n\
	\n\
	if iState == 0 then\n\
	\n\
		if animDone == true then\n\
		\n\
			if curSlot == 0 then\n\
				actor:PlayNext();\n\
				actor:AttachParticle(10,\"p_ef_center\",\"ef_arc_charge01_loop\");		\n\
				action:SetParamInt(3,1);							\n\
			end\n\
			if curSlot == 2 then\n\
				action:SetParamInt(6,1);\n\
				action:SetParamFloat(7,accumTime);\n\
				return true;\n\
			end\n\
		\n\
		end\n\
		\n\
		if bKeyCheck == false then\n\
			if curSlot == 0 then\n\
				return	false;\n\
			end\n\
			\n\
			if curSlot == 1 and action:GetParamInt(5) == 1 then\n\
			\n\
				Skill_Archer_Charge_Arrow_Fire(actor,action);\n\
			else\n\
				return	false;\n\
			\n\
			end	\n\
		end\n\
	else\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(7);\n\
		if fElapsedTime>=g_fChargingFreezeTime then\n\
			action:SetParam(2,\"end\");\n\
			return	false;					\n\
		end		\n\
\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
\n\
function	Skill_Archer_Charge_Arrow_LoadArrowToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(\"Projectile_Phoenix\",action,actor:GetPilotGuid());\n\
	kNewArrow:LoadToWeapon(actor);	--	\n\
	return kNewArrow;\n\
end\n\
function	Skill_Archer_Charge_Arrow_FireArrow(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	ODS(\"Skill_Archer_Charge_Arrow_Fire\\n\");\n\
	\n\
	local	kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	\n\
	local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
	local	kArrow = Skill_Archer_Charge_Arrow_LoadArrowToWeapon(actor,kAction);\n\
	\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		local	iTargetCount = kAction:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
		local   pt = nil;\n\
		\n\
		if iTargetCount>0 then\n\
				--	  \n\
			local	kTargetGUID = kAction:GetTargetGUID(0);\n\
			iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
			kActionTargetInfo = kAction:GetTargetInfo(0);\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end						\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
		\n\
		if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
		else\n\
			kArrow:SetTargetObjectList(kAction:GetTargetList());	\n\
			\n\
			if pt ~= nil then\n\
			\n\
				local	kTargetPoint = Point3(pt:GetX(),pt:GetY(),arrow_worldpos:GetZ());\n\
				kArrow:SetTargetLoc(kTargetPoint);\n\
			\n\
			end\n\
		end\n\
		\n\
		kArrow:Fire();\n\
		\n\
	else\n\
		\n\
		ODS(\"Arrow is nil\\n\");\n\
	\n\
	end\n\
	\n\
	kAction:ClearTargetList();\n\
	actor:ClearIgnoreEffectList();\n\
				\n\
end\n\
\n\
\n\
function Skill_Archer_Charge_Arrow_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	if actor:GetAction():GetParamInt(3) == 1 then\n\
		actor:DetachFrom(10);\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_world:GetWorldFocusFilterAlpha()\n\
		, 0\n\
		, g_fChargeFilterReturnTime\n\
		,false\n\
		,true);\n\
	end\n\
	\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Skill_Archer_Charge_Arrow_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetID() == \"a_jump\" then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
		\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(1) == 1 and curAction:GetParam(2)~=\"end\" then\n\
		return		false;\n\
	end\n\
\n\
\n\
   return true;\n\
   \n\
end\n\
\n\
function Skill_Archer_Charge_Arrow_OnEvent(actor,textKey,seqID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" and action:GetActionParam() == AP_FIRE then\n\
	\n\
		Skill_Archer_Charge_Arrow_FireArrow(actor);\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_Pressure_OnCheckCanEnter(actor,action)\n\
\n\
    CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_Pressure_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	Skill_Pressure_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Pressure_Fire(actor,action)\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Pressure_Fire\\n\");\n\
	\n\
	action:CreateActionTargetList(actor);\n\
end\n\
\n\
function Skill_Pressure_FindGenPoint(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local   fFrontDistance = action:GetSkillRange(0,actor);\n\
	if fFrontDistance == 0 then\n\
	    fFrontDistance = 94\n\
	end\n\
\n\
	ODS(\"fFrontDistance : \"..fFrontDistance..\"\\n\", false, 1509)\n\
	\n\
	local   fHeight = 150;\n\
\n\
    local   kTargetPos = actor:GetLookingDir();\n\
    kTargetPos:Multiply(fFrontDistance);\n\
    kTargetPos:SetZ(kTargetPos:GetZ()+fHeight);\n\
    kTargetPos:Add(actor:GetPos());\n\
	\n\
	return	kTargetPos;\n\
\n\
end\n\
function Skill_Pressure_CreateSkillActor(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	ODS(\"MyPos :\"..actor:GetPos():GetX()..\",\"..actor:GetPos():GetY()..\",\"..actor:GetPos():GetZ()..\"\\n\");\n\
	ODS(\"TargetPos :\"..kTargetPos:GetX()..\",\"..kTargetPos:GetY()..\",\"..kTargetPos:GetZ()..\"\\n\");\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900010, 0)\n\
	if pilot:IsNil() == false then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9)\n\
		pilot:GetActor():FreeMove(true)\n\
		pilot:GetActor():ReserveTransitAction(\"a_Pressure_Play\")\n\
		pilot:GetActor():ClearActionState()\n\
		pilot:GetActor():SeeFront(true,true);\n\
		\n\
		local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		if kAction:IsNil() == false then\n\
		\n\
		    GetActionTargetTransferInfoMan():AddTransferInfo_Actor(\n\
		                    actor:GetPilotGuid(),\n\
		                    action:GetActionNo(),\n\
		                    action:GetActionInstanceID(),\n\
		                    pilot:GetGuid());\n\
		                    \n\
			kAction:SetTargetList(action:GetTargetList());\n\
			kAction:AddNewGUID(actor:GetPilotGuid());\n\
			kAction:SetParamFloat(1,kTargetPos:GetZ());\n\
\n\
			local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
			if 0 == iSkillLevel then\n\
				iSkillLevel = 1;\n\
			end\n\
\n\
			kAction:SetParamInt(16, iSkillLevel);\n\
			\n\
			action:ClearTargetList();\n\
		\n\
		end\n\
	end	\n\
\n\
end\n\
\n\
function Skill_Pressure_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	kPos = Skill_Pressure_FindGenPoint(actor,action);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,Point3(0,0,-1));\n\
	kParam:SetParam_2(0,0,50,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);\n\
	\n\
	return	action:FindTargets(TAT_RAY_DIR_COLL_PATH,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Pressure_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Pressure_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Pressure_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Pressure_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Skill_Pressure_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Pressure_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" then\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end	\n\
\n\
		local	kTargetPos = Skill_Pressure_FindGenPoint(actor,kAction  );\n\
		Skill_Pressure_CreateSkillActor(actor,kAction,kTargetPos);		\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Pressure_Play_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	--	  \n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	\n\
	--  \n\
	action:SetParamFloat(2,actor:GetPos():GetZ());\n\
	\n\
	--	State\n\
	action:SetParamInt(4,0);\n\
	action:SetParamFloat(6,0);\n\
	\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
\n\
	local iSkillLevel = action:GetParamInt(16);\n\
	actor:SetTargetScale(0.5 + (iSkillLevel * 0.2));\n\
	--  \n\
\n\
	return true\n\
end\n\
\n\
function Skill_Pressure_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end \n\
	if( CheckNil(g_world:IsNil()) ) then return false end \n\
	\n\
	local iState = action:GetParamInt(4)\n\
		\n\
	if iState == 0 then\n\
		actor:SetHideShadow(true);\n\
    	\n\
	    --   \n\
	    local   fStartHeight = action:GetParamFloat(1)\n\
    	\n\
	    --   \n\
	    local   fElapsedTime = accumTime - action:GetParamFloat(0);\n\
	    local   fMaxDownTime = 10;\n\
    	\n\
	    if fElapsedTime>fMaxDownTime then\n\
	        fElapsedTime = fMaxDownTime;\n\
	    end\n\
\n\
	    local   fMoveSpeed = -(12000*fElapsedTime);\n\
    	\n\
	    --   \n\
	    local   fNowHeight = fStartHeight +fMoveSpeed*fElapsedTime;\n\
	    ODS(\"fNowHeight : \"..fNowHeight..\"\\n\")\n\
    	\n\
	    --  \n\
	    local   fFloorHeight = action:GetParamFloat(2);\n\
    	\n\
	    if fNowHeight<fFloorHeight then\n\
	        fNowHeight = fFloorHeight\n\
	    end\n\
    	\n\
	    actor:SetTranslate(Point3(actor:GetPos():GetX(),actor:GetPos():GetY(),fNowHeight));\n\
    	\n\
	    if fElapsedTime == fMaxDownTime or fNowHeight<=fFloorHeight then\n\
        	\n\
	        Skill_Pressure_Play_DoDamage(actor,action)\n\
	        action:SetParamInt(4,1)\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
			action:SetSlot(1);\n\
			actor:PlayCurrentSlot();\n\
	    end\n\
	elseif iState == 1 then\n\
		if accumTime - action:GetParamFloat(6) > 0.5 then\n\
			action:SetParamFloat(6,g_world:GetAccumTime());			\n\
			action:SetParamInt(4,2);\n\
		end\n\
	elseif iState == 2 then\n\
		if accumTime - action:GetParamFloat(6) > 1.0 then\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.7);\n\
			action:SetParamInt(4,3);\n\
		end\n\
	elseif iState == 3 then\n\
		if accumTime - action:GetParamFloat(6) > 1.0 then\n\
			return false;\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Pressure_Play_DoDamage(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
\n\
	local kOriginalActorGUID = action:GetGUIDInContainer(0);\n\
	local kOriginalActor = nil;\n\
	if kOriginalActorGUID:IsNil() == false then\n\
\n\
		local	kPilot = g_pilotMan:FindPilot(kOriginalActorGUID);\n\
		if kPilot:IsNil() == false then\n\
			kOriginalActor = kPilot:GetActor();\n\
		end\n\
	\n\
	end	    \n\
\n\
	if kOriginalActor ~= nil then\n\
		if kOriginalActor:IsNil() == false then\n\
			if kOriginalActor:IsMyActor() then\n\
				QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
				, g_fMeleeDropQuakeValue[2]\n\
				, g_fMeleeDropQuakeValue[3]\n\
				, g_fMeleeDropQuakeValue[4]\n\
				, g_fMeleeDropQuakeValue[5])\n\
			end\n\
		end\n\
	end\n\
	\n\
    local	kPos = actor:GetPos();\n\
	local iSkillLevel = action:GetParamInt(16);\n\
    actor:AttachParticleToPointS(12, kPos, \"ef_thi_jump_down_attk\", 0.6 + (iSkillLevel * 0.06))\n\
	\n\
    SkillHelpFunc_DefaultHitOneTime(actor,action, true); \n\
\n\
end\n\
\n\
function Skill_Pressure_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:EndBodyTrail();\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_Pressure_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function PressurePlayInit(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:SetHideShadow(true);\n\
	actor:SetTargetAlpha(0,1, 0.3);\n\
end\n\
\n\
function Skill_Pressure_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("-- [DIRECTION] :     \"LEFT\" or \"RIGHT\"\n\
function Skill_BackStep_Shot_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_BackStep_Shot_OnCheckCanEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction();\n\
	if( false == kCurAction:IsNil() ) then\n\
		local kActionName = kCurAction:GetID();	\n\
		if kActionName ~= \"a_back_step\" then\n\
			return false;\n\
		end\n\
	end\n\
	\n\
    return  true;\n\
    \n\
end\n\
\n\
function Skill_BackStep_Shot_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
    ODS(\"Skill_BackStep_Shot_OnEnter\\n\");\n\
\n\
	if actor:IsMyActor() == false then\n\
		actor:ClearReservedAction()\n\
	end\n\
	\n\
	action:SetParam(2,\"\");\n\
	\n\
	actor:SetComboCount(0);\n\
	actor:StopJump();\n\
	\n\
	if actor:IsMyActor() == false then\n\
		actor:SetTranslate(action:GetActionStartPos());\n\
	end\n\
	\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
			\n\
	return true\n\
end\n\
\n\
function Skill_BackStep_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local fAccel = -100 * frameTime\n\
	local fVelocity = action:GetParamFloat(1)\n\
	\n\
	local kMovingDir = Point3(action:GetParamFloat(6),\n\
	                            action:GetParamFloat(7),\n\
	                            action:GetParamFloat(8));\n\
	                            \n\
	if fVelocity<0 then\n\
		fVelocity = 0\n\
	end\n\
		                            \n\
	kMovingDir:Multiply(-fVelocity)\n\
	actor:SetMovingDelta(kMovingDir);\n\
	\n\
	ODS(\"BackStep_Shot fVelocity :\"..fVelocity..\"\\n\");\n\
\n\
	fVelocity = fVelocity + fAccel\n\
	action:SetParamFloat(1, fVelocity)\n\
\n\
	local fElapsedTime = accumTime - action:GetParamFloat(0);\n\
	if fElapsedTime > 0.5 or fVelocity <= 0 then\n\
		if action:GetParam(3) == \"FIRE\" then\n\
			action:SetParam(2,\"end\");\n\
			return  false;\n\
	    end\n\
	    \n\
	    if fVelocity< 0 then\n\
			fVelocity = 0\n\
			action:SetParam(2,\"end\");\n\
			return  false;\n\
		end\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_BackStep_Shot_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:EndBodyTrail();\n\
    actor:FreeMove(false);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_BackStep_Shot_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());	\n\
	\n\
	local newActionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return  true;\n\
	end\n\
\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		return true;\n\
	end		\n\
		\n\
	if kCurAction:GetParam(2) == \"end\" then\n\
		return	true;\n\
	elseif 	newActionID == \"a_lock_move\" then\n\
		return true;\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_BackStep_Shot_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	ODS(\"Skill_BackStep_Shot_OnEvent : \"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
    	local kAction = actor:GetAction();\n\
		\n\
		CheckNil(nil==kAction);\n\
		CheckNil(kAction:IsNil());\n\
	\n\
    	kAction:SetParam(3,\"FIRE\");\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			kArrow:Fire();\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Moon_Dance_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Moon_Dance_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	Skill_Moon_Dance_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Moon_Dance_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	ODS(\"RestoreItemModel Skill_Moon_Dance_Fire\\n\");\n\
	\n\
	action:SetParamFloat(0,g_world:GetAccumTime()); --    \n\
	action:CreateActionTargetList(actor);\n\
--[[	\n\
	if LOCALE.NC_JAPAN ~= GetLocale() then\n\
	\n\
		--    !\n\
		local   kMan = GetStatusEffectMan();\n\
		\n\
		local	iInstanceID = kMan:AddStatusEffectToActor(actor:GetPilotGuid(),\"se_transform_to_moon_dance\",0,0);\n\
		action:SetParamInt(2,iInstanceID);\n\
	else\n\
		action:SetSlot(2);\n\
		actor:PlayCurrentSlot();\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
]]	\n\
	action:SetSlot(2);\n\
	actor:PlayCurrentSlot();\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
		\n\
	action:SetParamFloat(6,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(7,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(8,actor:GetLookingDir():GetZ());\n\
	\n\
	actor:AttachParticle(59901,\"char_root\",\"ef_Moonwalk_01\");\n\
	actor:StopJump();\n\
\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
		\n\
end\n\
function Skill_Moon_Dance_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	--ODS(\"Skill_WindMill_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Moon_Dance_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_WindMill_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
end\n\
\n\
function Skill_Moon_Dance_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Moon_Dance_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Moon_Dance_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Moon_Dance_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
\n\
    local   fElasepdTime = accumTime - action:GetParamFloat(0);\n\
    if 	fElasepdTime> 2 then\n\
		action:SetParam(1, \"end\")\n\
		return false    \n\
    end\n\
    \n\
	local fVelocity = 50;\n\
	\n\
	local kMovingDir = Point3(action:GetParamFloat(6),\n\
	                            action:GetParamFloat(7),\n\
	                            action:GetParamFloat(8));\n\
	                            \n\
	kMovingDir:Multiply(-fVelocity)\n\
	actor:SetMovingDelta(kMovingDir);    \n\
\n\
	return true\n\
end\n\
\n\
function Skill_Moon_Dance_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    actor:DetachFrom(59901);\n\
\n\
	local	kAction = actor:GetAction();\n\
    \n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
--[[	if LOCALE.NC_JAPAN ~= GetLocale() then\n\
		--   \n\
		local   kMan = GetStatusEffectMan();\n\
\n\
		local	iInstanceID = kAction:GetParamInt(2)\n\
		kMan:RemoveStatusEffectFromActor2(actor:GetPilotGuid(),iInstanceID);	\n\
	else\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
	]]\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	return true;\n\
end\n\
\n\
function Skill_Moon_Dance_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_ChainLightning_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_ChainLightning_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_ChainLightning_Fire(actor,action);\n\
	--action:SetSlot(action:GetCurrentSlot());\n\
	actor:PlayCurrentSlot();\n\
	actor:CutSkillCasting();\n\
\n\
end\n\
\n\
function Skill_ChainLightning_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_ChainLightning_OnTargetListModified\\n\");\n\
    \n\
    --    .\n\
    \n\
    if bIsBefore then\n\
    \n\
        --Skill_ChainLightning_AttachLightningEffect(actor,action,false); --       .\n\
        action:ClearTargetList();\n\
\n\
    else\n\
	    Skill_ChainLightning_CreateLinkedPlane(actor,action);   --  LinkedPlane \n\
	    --Skill_ChainLightning_AttachLightningEffect(actor,action,true);  --       .\n\
	    \n\
	    action:GetTargetList():ApplyActionEffects();\n\
	    \n\
    end\n\
    \n\
end\n\
\n\
\n\
function Skill_ChainLightning_Fire(actor,action)\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"RestoreItemModel Skill_ChainLightning_Fire\\n\");\n\
	\n\
	action:SetParamInt(2,-1)    --   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(3,g_world:GetAccumTime()-1)  --    	\n\
	action:SetParamInt(4,0); --   \n\
end\n\
function Skill_ChainLightning_CreateActionTargetList(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local   kTargetList = action:GetTargetList();\n\
    local   iTargetCount = kTargetList:size();\n\
\n\
	action:SetParamInt(4, iTargetCount); --    \n\
    action:CreateActionTargetList(actor);\n\
\n\
end\n\
\n\
function Skill_ChainLightning_UpdateTarget(actor,action,accumTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsMyActor() == false then\n\
        return\n\
    end\n\
\n\
    --  1      .\n\
    local   fLastUpdateTime = action:GetParamFloat(3);\n\
    if accumTime - fLastUpdateTime <= 0.5 then\n\
        return\n\
    end\n\
    \n\
    --Skill_ChainLightning_AttachLightningEffect(actor,action,false); --       .\n\
    \n\
    action:SetParamFloat(3,accumTime);\n\
\n\
	--   \n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot(), true);\n\
	end\n\
	\n\
	Skill_ChainLightning_CreateLinkedPlane(actor,action);   --  LinkedPlane \n\
	--Skill_ChainLightning_AttachLightningEffect(actor,action,true);  --       .\n\
\n\
end\n\
\n\
function Skill_ChainLightning_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
    local   kMyHandPos = actor:GetNodeWorldPos(\"p_wp_l_hand\");\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	--     .\n\
	kParam:SetParam_1(kMyHandPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,action:GetAbil(AT_1ST_AREA_PARAM2),0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	--    ~\n\
	if iTargets == 0 then\n\
	    return  iTargets;\n\
    end\n\
    \n\
    --        .\n\
    local   kTargetInfo = kTargets:GetTargetInfo(0);\n\
    if kTargetInfo:IsNil() then\n\
        return  0\n\
    end\n\
    \n\
    local   kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
    if kTargetPilot:IsNil() then\n\
        return  0\n\
    end\n\
    \n\
    local   kTargetActor = kTargetPilot:GetActor();\n\
    if kTargetActor:IsNil() then\n\
        return  0\n\
    end    \n\
    \n\
    local   kTargetPos = kTargetActor:GetPos();\n\
\n\
	local kMaxTarget = action:GetAbil(AT_MAX_TARGETNUM);\n\
\n\
	if 0 == kMaxTarget then\n\
		kMaxTarget = action:GetAbil(AT_LEVEL) * 2;\n\
	end\n\
\n\
	kMaxTarget = kMaxTarget - 1;\n\
\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetAbil(AT_2ND_AREA_PARAM1),kMaxTarget);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	iTargets = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"Skill_ChainLightning_OnFindTarget iTargets:\"..iTargets..\"\\n\");\n\
	\n\
	return iTargets;        \n\
    \n\
end\n\
function Skill_ChainLightning_AttachLightningEffect(actor,action,bAttach)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kTargetList = action:GetTargetList();\n\
    local   iTargetCount = kTargetList:size();\n\
    \n\
    if iTargetCount == 0 then\n\
        return\n\
    end    \n\
end\n\
\n\
function Skill_ChainLightning_CreateLinkedPlane(actor,action,path)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kMan = GetLinkedPlaneGroupMan();\n\
       \n\
    local   iGroupNum = action:GetParamInt(2);\n\
    local   kGroup;\n\
    if iGroupNum == -1 then\n\
        --    .\n\
        kGroup = kMan:CreateNewLinkedPlaneGroup();\n\
		if nil==path or \"\"==path then\n\
			path = \"../Data/5_Effect/9_Tex/ef_chainlight_ani_001.dds\"\n\
		end\n\
\n\
        kGroup:SetTexture(path);\n\
        action:SetParamInt(2,kGroup:GetInstanceID());\n\
        \n\
    else\n\
        --      .\n\
        kGroup = kMan:GetLinkedPlaneGroup(iGroupNum);\n\
        kGroup:ReleaseAllPlane();\n\
    end\n\
\n\
    local kPlane = kGroup:AddNewPlane(127);    --   1 .\n\
    kPlane:SetWidth(20);\n\
    \n\
    local   kTargetList = action:GetTargetList();\n\
    local   iTargetCount = kTargetList:size();\n\
    \n\
    local   i=0;\n\
\n\
    while i<iTargetCount-1 do\n\
        local kPlane = kGroup:AddNewPlane(127);\n\
        kPlane:SetWidth(20);\n\
        i=i+1;\n\
    end\n\
\n\
end\n\
function Skill_ChainLightning_UpdatePlanePos(actor,action,node,end_node)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kMan = GetLinkedPlaneGroupMan();\n\
    \n\
    local   iGroupNum = action:GetParamInt(2);\n\
\n\
    local kGroup = kMan:GetLinkedPlaneGroup(iGroupNum);\n\
    \n\
    local   kTargetList = action:GetTargetList();\n\
    local   iTargetCount = kTargetList:size();\n\
    \n\
    local   i=0;\n\
    \n\
    local   kPlane = kGroup:GetPlane(i);\n\
\n\
    --    StartPos   .\n\
	if nil==node or \"\"==node then node = \"p_wp_l_hand\" end\n\
    local   kMyHandPos = actor:GetNodeWorldPos(node);\n\
    kPlane:SetStartPos(kMyHandPos);\n\
	\n\
    if iTargetCount == 0 then\n\
    \n\
        --     AttackRange      .\n\
        local kLookDir = actor:GetLookingDir();\n\
	    local  iAttackRange = action:GetSkillRange(0,actor);\n\
	    if iAttackRange == 0 then\n\
	        iAttackRange = 100\n\
	    end\n\
        kLookDir:Multiply(iAttackRange);\n\
        kLookDir:Add(kMyHandPos);\n\
        \n\
        kPlane:SetEndPos(kLookDir);\n\
    \n\
        return\n\
    end    \n\
    \n\
    local   kFirstPos;\n\
    \n\
    while i<iTargetCount do\n\
    \n\
        local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
        local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
        local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
        local   bActorInvalid = true;\n\
        \n\
        if kTargetPilot:IsNil() == false then\n\
        \n\
            local   kTargetActor = kTargetPilot:GetActor();\n\
            if kTargetActor:IsNil() == false then\n\
				local kTargetPos = nil\n\
				if nil==end_node then\n\
					kTargetPos = kTargetActor:GetPos();\n\
				else\n\
					kTargetPos = kTargetActor:GetNodeWorldPos(end_node);\n\
				end\n\
                kPlane:SetEndPos(kTargetPos);\n\
                kPlane:SetEnable(true);\n\
                bActorInvalid = false;\n\
                \n\
                if kFirstPos == nil then\n\
                    kFirstPos = kTargetPos\n\
                end\n\
                \n\
            end\n\
        \n\
        end\n\
        \n\
        kPlane:SetEnable(bActorInvalid == false);   --      .\n\
                \n\
        i=i+1;\n\
        \n\
        kPlane = kGroup:GetPlane(i);\n\
   \n\
        if kPlane:IsNil() then\n\
            break;\n\
        end\n\
\n\
        if kFirstPos ~= nil then\n\
            kPlane:SetStartPos(kFirstPos);\n\
        else\n\
            kPlane:SetStartPos(kMyHandPos);\n\
        end\n\
        \n\
    end\n\
\n\
end\n\
\n\
function Skill_ChainLightning_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_ChainLightning_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_ChainLightning_OnCastingCompleted(actor,action);\n\
	actor:SetParam(\"shot\", \"false\");\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_ChainLightning_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
\n\
	if animDone == true then\n\
		action:SetSlot(action:GetCurrentSlot()+1);\n\
		actor:PlayCurrentSlot();\n\
		actor:SetParam(\"shot\", \"true\");\n\
		actor:AttachParticle(9221,\"char_root\",\"ef_Chainlightning_01_char_root\");\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		Skill_ChainLightning_UpdateTarget(actor,action,g_world:GetAccumTime());\n\
\n\
		Skill_ChainLightning_CreateLinkedPlane(actor,action);\n\
		--Skill_ChainLightning_AttachLightningEffect(actor,action,true);\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end	\n\
	end\n\
	\n\
	if iCurrentSlot == 1 then\n\
		if action:GetActionParam() == AP_FIRE and actor:GetParam(\"shot\") == \"true\" then\n\
		\n\
			Skill_ChainLightning_UpdateTarget(actor,action,accumTime);\n\
			Skill_ChainLightning_UpdatePlanePos(actor,action);\n\
\n\
			--if action:GetTargetCount() == 0 then\n\
			--	Skill_ChainLightning_AttachLightningEffect(actor,action,false);\n\
			--end\n\
\n\
			if Skill_ChainIsEffect(actor,action) == false then\n\
				return false;\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_ChainLightning_OnCleanUp(actor)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    --   .\n\
    local   iGroupNum = actor:GetAction():GetParamInt(2);\n\
    if iGroupNum ~= -1 then\n\
        local   kMan = GetLinkedPlaneGroupMan();\n\
        kMan:ReleaseLinkedPlaneGroup(iGroupNum);\n\
        actor:GetAction():SetParamInt(2,-1);\n\
    end\n\
    \n\
    Skill_ChainLightning_AttachLightningEffect(actor,actor:GetAction(),false);  --     \n\
    \n\
    actor:DetachFrom(9221);\n\
    \n\
	return true;\n\
end\n\
\n\
function Skill_ChainLightning_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() then\n\
	\n\
	    if actionID == \"a_run\" then\n\
	        return  true;\n\
	    end\n\
	\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_ChainIsEffect(actor, action) --   ?\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == false then\n\
        return true;\n\
    end\n\
\n\
	local kPilot = actor:GetPilot();\n\
	if kPilot:IsNil() == false then\n\
		local kUnit = kPilot:GetUnit();\n\
		if kUnit:IsNil() == false then\n\
			local kSkillDef = GetSkillDef(action:GetActionNo());\n\
			if kSkillDef:IsNil() == false then\n\
				local kEffect = kUnit:GetEffect(kSkillDef:GetEffectNo(), true)\n\
		 		if kEffect:IsNil() == false then\n\
					return true;\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1,\"end\")\n\
	return false;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_ShadowLeap_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_ShadowLeap_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_ShadowLeap_Fire(actor,action);\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_ShadowLeap_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	--   \n\
	actor:AttachParticleToPoint(8776,actor:GetNodeWorldPos(\"char_root\"),\"ef_Shadowleap_01_01_char_root\");\n\
	\n\
	--  .\n\
	actor:HideNode(\"Scene Root\",true);\n\
	\n\
	--   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(4,g_world:GetAccumTime());\n\
	\n\
	--  State\n\
	action:SetParamInt(3,0);\n\
\n\
	actor:AttachSound(106,\"Shadow\");\n\
	\n\
\n\
end\n\
function Skill_ShadowLeap_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 200\n\
	end\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = iAttackRange\n\
	end	\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,iAttackRange,0,0);\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"Skill_ShadowLeap_OnFindTarget iTargets:\"..iTargets..\"\\n\");\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_ShadowLeap_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_ShadowLeap_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	action:SetParamInt(100,30) --     \n\
	\n\
	Skill_ShadowLeap_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_ShadowLeap_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local   iState =action:GetParamInt(3);\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
	\n\
	if iState == 0 then\n\
	    local   fHideTime = action:GetParamFloat(4);\n\
	    if accumTime - fHideTime > 0.4 then\n\
    	\n\
	        actor:HideNode(\"Scene Root\",false);\n\
    	    \n\
	        --      .\n\
	        local   kTargetList = action:GetTargetList();\n\
	        local   iTargetCount = kTargetList:size();\n\
	        if iTargetCount>0 then\n\
        	\n\
	            local   kTargetInfo = kTargetList:GetTargetInfo(0);\n\
	            local   kTargetGuid = kTargetInfo:GetTargetGUID();\n\
	            local   kTargetPilot = g_pilotMan:FindPilot(kTargetGuid);\n\
	            if kTargetPilot:IsNil() == false then\n\
\n\
                    local   kTargetActor = kTargetPilot:GetActor();\n\
                    if kTargetActor:IsNil() == false then\n\
					\n\
					local   kTargetPos = kTargetActor:GetPos();\n\
					\n\
                        local kMyPos = actor:GetPos();\n\
						local iMoveDist = action:GetParamInt(100)\n\
                        local kDir = kTargetPos:_Subtract(kMyPos);\n\
						kDir:Unitize();\n\
						\n\
						if actor:IsToLeft() == kTargetActor:IsToLeft() then\n\
							kDir:Multiply(-iMoveDist);\n\
						elseif actor:IsToLeft() ~= kTargetActor:IsToLeft() then\n\
							kDir:Multiply(iMoveDist);\n\
						end\n\
					\n\
						actor:ToLeft(kTargetActor:IsToLeft())\n\
					\n\
                        local   kNewPos = kTargetPos:_Add(kDir);\n\
                        kNewPos = g_world:FindActorFloorPos(kNewPos);\n\
						\n\
						local fDistToMovePos = kNewPos:_Subtract(kMyPos)\n\
						fDistToMovePos = fDistToMovePos:Length()\n\
						\n\
						local bUseNewPos = true\n\
						kDir = kTargetPos:_Subtract(kMyPos);\n\
						kDir:Unitize();\n\
						--[[\n\
						local kThrowRayPos = actor:GetLookingDir()\n\
						kThrowRayPos:Multiply(10)\n\
						kThrowRayPos:Add(kMyPos)\n\
						]]\n\
						\n\
						local ptcl = g_world:ThrowRay(kMyPos, kDir, fDistToMovePos,1) -- 						\n\
						if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then --   							\n\
							ptcl = g_world:ThrowRay(kNewPos, Point3(0,0,-1), 500,3)			--   \n\
							if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
								ptcl = g_world:ThrowRay(kNewPos, Point3(0,0,1),iMoveDist,3); 				--  \n\
								if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ()== -1 then --   \n\
									bUseNewPos = false 							--  ,   \n\
									--ODS(\"  \\n\", false, 912)\n\
								else\n\
									--ODS(\" \\n\", false, 912)\n\
								end\n\
							else\n\
								--ODS(\" \\n\", false, 912)\n\
							end\n\
							\n\
						else\n\
							--ODS(\"  \\n\", false, 912)\n\
							bUseNewPos = false\n\
						end\n\
						\n\
						if(bUseNewPos) then\n\
							actor:SetTranslate(kNewPos);\n\
						else\n\
							actor:SetTranslate(kTargetPos);\n\
						end\n\
                        \n\
	                    actor:AttachParticle(8777,\"char_root\",\"ef_Shadowleap_01_02_char_root\");\n\
						action:SetSlot(action:GetCurrentSlot()+1);\n\
						actor:PlayCurrentSlot();\n\
                    end\n\
	            end\n\
			else\n\
				action:SetParamInt(3,1);\n\
				action:SetParam(1, \"end\")\n\
				return false;\n\
			end\n\
\n\
            action:SetParamInt(3,1);\n\
	    end	\n\
	else\n\
		if iCurrentSlot == 1 then\n\
			if animDone == true then\n\
				action:SetParam(1, \"end\");\n\
				return false\n\
			end\n\
		else		\n\
			local   fHideTime = action:GetParamFloat(4);\n\
			if accumTime - fHideTime > 0.4 then\n\
				action:SetParam(1, \"end\")\n\
			end\n\
		end\n\
\n\
	    --if animDone == true then\n\
			\n\
		   -- action:SetParam(1, \"end\")\n\
		    --return false\n\
	    --end\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_ShadowLeap_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:HideNode(\"Scene Root\",false);\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_ShadowLeap_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
\n\
function Skill_ShadowLeap_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		SkillHelpFunc_DefaultHitOneTime(actor,kAction, true);\n\
	end\n\
\n\
	return	true;\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_WheelWind_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());	\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_WheelWind_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_WheelWind_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	action:SetParamAsPoint( 100, actor:GetLookingDir() )  --        \n\
end\n\
\n\
\n\
function Skill_WheelWind_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	ODS(\"RestoreItemModel Skill_WheelWind_Fire\\n\");\n\
	\n\
	action:SetParamFloat(2,g_world:GetAccumTime()); --   \n\
	action:SetParamFloat(3,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(4,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(5,actor:GetLookingDir():GetZ());	\n\
	\n\
	action:SetParamFloat(6,0);\n\
	\n\
	actor:AttachParticle(29912,\"char_root\",\"ef_Wheelwind_01_char_root\");\n\
	actor:AttachSound(2000, \"WheelWind\");\n\
\n\
end\n\
function Skill_WheelWind_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	ODS(\"Skill_WheelWind_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_WheelWind_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_WheelWind_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_WheelWind_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_WheelWind_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_WheelWind_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
end\n\
\n\
function Skill_WheelWind_UpdateTarget(actor,action,accumTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsMyActor() == false then\n\
        return\n\
    end\n\
    \n\
    --  1    .\n\
    local   fLastUpdateTime = action:GetParamFloat(6);\n\
    if accumTime - fLastUpdateTime <0.5 then\n\
        return\n\
    end\n\
    \n\
    action:SetParamFloat(6,accumTime);\n\
\n\
    --    .        \n\
    action:CreateActionTargetList(actor);\n\
    \n\
	--   \n\
	if action:GetTargetCount() > 0 then\n\
	    action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
	\n\
	action:ClearTargetList();\n\
	\n\
	ODS(\"Skill_WheelWind_UpdateTarget\\n\");\n\
	    \n\
end\n\
\n\
function Skill_WheelWind_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actionID = action:GetID();\n\
	local movingSpeed = 0\n\
	\n\
	if IsSingleMode() == true then\n\
		movingSpeed = 50 \n\
	else\n\
		movingSpeed = actor:GetAbil(AT_C_MOVESPEED)\n\
	end\n\
	\n\
	Skill_WheelWind_UpdateTarget(actor,action,accumTime);\n\
\n\
    --    \n\
	local	fRotateTime = accumTime - action:GetParamFloat(2);\n\
	\n\
	if fRotateTime>2 then\n\
	    action:SetParam(1,\"end\");\n\
	    return  false\n\
	end\n\
	\n\
	actor:IncRotate(frameTime*6*460.0*3.141592/180.0);\n\
	\n\
	local kMovingDir = Point3(action:GetParamFloat(3),action:GetParamFloat(4),action:GetParamFloat(5));\n\
	kMovingDir:Multiply(movingSpeed*0.8);\n\
	\n\
	actor:SetMovingDelta(kMovingDir);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_WheelWind_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
	actor:DetachFrom(29912);\n\
	local kCurAction = actor:GetAction()\n\
	if(nil ~= kCurAction and false == kCurAction:IsNil()) then	\n\
		local kLookingDir = kCurAction:GetParamAsPoint(100)\n\
		local kLookAtPos = actor:GetPos()\n\
		kLookAtPos:Add(kLookingDir)\n\
		actor:LookAt(kLookAtPos)\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_WheelWind_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_HeadSpin_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
		\n\
	if(true == actor:IsInCoolTime(action:GetActionNo(), false) ) then\n\
		return false\n\
	end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( false == curAction:IsNil() ) then\n\
		local kActionName = curAction:GetID();		\n\
	--	ODS(\"Skill_HeadSpin_OnCheckCanEnter  ActionName : \"..kActionName..\"\\n\");\n\
		if(\"a_Windmill\" == kActionName or \"a_Nineteen Ninety\" == kActionName) then		\n\
			curAction:SetNextActionName(\"a_head_spin\");\n\
			curAction:ChangeToNextActionOnNextUpdate(true, true);\n\
		end\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_HeadSpin_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_HeadSpin_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();		\n\
end\n\
\n\
function Skill_HeadSpin_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
	\n\
	SkillHelpFunc_AttachParticleToNode(19002, \"FIRE_CASTER_EFFECT_ID\", \"FIRE_CASTER_EFFECT_TARGET_NODE\", 1, actor, action)\n\
	SkillHelpFunc_AttachParticleToNode(19003, \"FIRE_CASTER_EFFECT_ID2\", \"FIRE_CASTER_EFFECT_TARGET_NODE2\", 1, actor, action)\n\
		\n\
end\n\
\n\
function Skill_HeadSpin_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	--ODS(\"Skill_HeadSpin_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_HeadSpin_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_HeadSpin_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(30, g_world:GetAccumTime())\n\
	Skill_HeadSpin_OnCastingCompleted(actor,action);\n\
	\n\
	local fTimerTotalTime = action:GetScriptParamAsFloat(\"ENTER_TIMER_TIME\")\n\
	if(0 == fTimerTotalTime) then\n\
		fTimerTotalTime = 2\n\
	end\n\
	\n\
	local fTimeTick = action:GetScriptParamAsFloat(\"ENTER_TIMER_TICK\")\n\
	action:StartTimer(fTimerTotalTime, fTimeTick, 0)\n\
	\n\
	return true\n\
end\n\
function Skill_HeadSpin_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_HeadSpin_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
end\n\
\n\
function Skill_HeadSpin_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
--	local actionID = action:GetID();\n\
	local bAnimDone = actor:IsAnimationDone();\n\
	local iSlot = action:GetCurrentSlot();\n\
	local nextActionName = action:GetNextActionName();\n\
	local iSkillLevel = action:GetAbil(AT_LEVEL);\n\
\n\
	if actor:IsMyActor() and 2 < iSkillLevel then\n\
		local	bKeyUp = KeyIsDown(KEY_UP);\n\
		local	bKeyDown = KeyIsDown(KEY_DOWN);\n\
		local	bKeyLeft = KeyIsDown(KEY_LEFT);\n\
		local	bKeyRight = KeyIsDown(KEY_RIGHT);\n\
		\n\
		local	iDir = 0\n\
		if bKeyUp then \n\
			iDir = iDir + DIR_UP\n\
		end\n\
		if bKeyDown then\n\
			iDir = iDir + DIR_DOWN\n\
		end\n\
		if bKeyLeft then\n\
			iDir = iDir + DIR_LEFT\n\
		end\n\
		if bKeyRight then\n\
			iDir = iDir + DIR_RIGHT\n\
		end\n\
\n\
		if iDir ~= 0 then\n\
			local iMoveSpeed = actor:GetAbil(AT_C_MOVESPEED) * 0.5\n\
			local kDirection = actor:GetDirectionVector(iDir);\n\
\n\
			kDirection:Multiply(iMoveSpeed);\n\
			actor:SetMovingDelta(kDirection);\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local fTimeDelta = g_world:GetAccumTime() - action:GetParamFloat(30)\n\
			if(fTimeDelta > 0.02) then --       \n\
				g_pilotMan:BroadcastDirection(actor:GetPilot(), iDir)\n\
				action:SetParamFloat(30, g_world:GetAccumTime())\n\
			end\n\
		end\n\
	end	\n\
		\n\
	\n\
	if bAnimDone == true then\n\
		if(false == actor:PlayNext()) then	--   \n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				return false;\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end		\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_HeadSpin_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(19002);\n\
	actor:DetachFrom(19003);\n\
	\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	return true;\n\
end\n\
\n\
function Skill_HeadSpin_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
\n\
function Skill_HeadSpin_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	ODS(\"Skill_HeadSpin_OnTimer\", false, 912)\n\
	if 0 == iTimerID or 1 == iTimerID then\n\
\n\
		action:CreateActionTargetList(actor)\n\
		\n\
		if IsSingleMode() or action:GetTargetCount() == 0 then	    \n\
			Skill_HeadSpin_OnTargetListModified(actor,action,false)\n\
		elseif actor:IsUnderMyControl() then\n\
			action:BroadCastTargetListModify(actor:GetPilot())\n\
			action:ClearTargetList()\n\
		end\n\
	end	\n\
	return true\n\
end") );
	m_kContLuaText.push_back(std::string("function Skill_MegaDrill_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_MegaDrill_OnCastingCompleted(actor, action)\n\
	\n\
end  \n\
\n\
function Skill_MegaDrill_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(5,g_world:GetAccumTime());\n\
	action:SetParamFloat(6,g_world:GetAccumTime());	\n\
	action:SetParamInt(8,0);	\n\
		\n\
	actor:AttachParticle(7210,\"char_root\",\"ef_skill_Headspin_01_char_root\"); --   \n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_MegaDrill_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
\n\
function Skill_MegaDrill_OnTimer(actor,fAccumTime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	action:CreateActionTargetList(actor)\n\
		    \n\
	if IsSingleMode() or action:GetTargetCount() == 0 then\n\
	\n\
		Skill_MegaDrill_OnTargetListModified(actor,action,false);\n\
	else\n\
		if actor:IsMyActor() then\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:ClearTargetList();\n\
		end\n\
	end\n\
			\n\
	return	true\n\
end\n\
\n\
function Skill_MegaDrill_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
    local   kParam = FindTargetParam();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 40\n\
	end\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_MegaDrill_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_MegaDrill_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(3);\n\
	\n\
	local   kMoveDir = actor:GetLookingDir();\n\
\n\
	if  iCurrentSlot == 0 then\n\
		if animDone == true then\n\
			action:SetSlot(1);\n\
			actor:PlayCurrentSlot();\n\
			actor:DetachFrom(7210,true)\n\
			actor:AttachParticle(7210,\"char_root\",\"ef_skill_Headspin_02_char_root\");\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			action:SetParamFloat(5,g_world:GetAccumTime());\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
		end\n\
	elseif  iCurrentSlot == 1 then	\n\
		kMoveDir:Multiply(600);\n\
		actor:SetMovingDelta(kMoveDir);\n\
		local   fElapsedTIme = accumTime - action:GetParamFloat(5);\n\
		if fElapsedTIme > 0.05 and action:GetParamInt(8) == 0 then\n\
			\n\
			action:SetParamFloat(5,accumTime)\n\
			--        \n\
			action:CreateActionTargetList(actor)		    \n\
			if IsSingleMode() or action:GetTargetCount() == 0 then\n\
				Skill_MegaDrill_OnTargetListModified(actor,action,false);\n\
		    else\n\
				if actor:IsMyActor() then\n\
		    		action:BroadCastTargetListModify(actor:GetPilot());\n\
					action:ClearTargetList();\n\
				end\n\
		    end	\n\
			action:SetParamInt(8,1)\n\
			\n\
			--         (   )\n\
			action:StartTimer(1.0,0.1,0)\n\
		end\n\
\n\
		local   fTotalElapsedTime = accumTime - action:GetParamFloat(6);\n\
		if  fTotalElapsedTime > 0.2 then\n\
			action:SetSlot(2);\n\
			actor:PlayCurrentSlot();			\n\
			action:SetParamInt(7, 500)\n\
		end\n\
	elseif   iCurrentSlot == 2 then\n\
		local iCurSpeed = action:GetParamInt(7);\n\
		kMoveDir:Multiply(iCurSpeed);\n\
		actor:SetMovingDelta(kMoveDir);\n\
\n\
		iCurSpeed = iCurSpeed - iCurSpeed * 0.13;\n\
		if iCurSpeed < 0 then\n\
			iCurSpeed = 0;\n\
		end		\n\
		action:SetParamInt(7, iCurSpeed);\n\
		if animDone == true then\n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				actor:DetachFrom(7210,true)\n\
				nextActionName = action:GetParam(1);\n\
\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				\n\
				action:SetNextActionName(nextActionName)\n\
			   \n\
				return false;				\n\
			else\n\
			\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_MegaDrill_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:DetachFrom(7210,true)\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	return true;\n\
end\n\
\n\
function Skill_MegaDrill_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	actor:EndBodyTrail();\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return \n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function	Skill_AutoShootSystem_Fire_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_FindTarget(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	local	kTargets = CreateActionTargetList(actor:GetPilotGuid(),action:GetActionInstanceID(),action:GetActionNo());\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	\n\
    kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
    kParam:SetParam_3(true,FTO_NORMAL);            	\n\
    \n\
    local iFoundNum = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
    \n\
    if iFoundNum == 0 then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetInfo = kTargets:GetTargetInfo(0);\n\
	if kTargetInfo:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetGUID = kTargetInfo:GetTargetGUID();\n\
	if kTargetGUID:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
	if kTargetPilot:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	local	kTargetActor = kTargetPilot:GetActor();\n\
	if kTargetActor:IsNil() then\n\
		return	nil\n\
	end\n\
    \n\
    DeleteActionTargetList(kTargets);\n\
    \n\
    return  kTargetActor;\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	actor:LockBidirection(false);\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	actor:AttachSound(120,\"AutoShootSystem1\");\n\
	\n\
	action:SetParamInt(2,4)\n\
	\n\
	-- Looking Dir\n\
--	local kLookDir = actor:GetLookingDir();\n\
--	action:SetParamFloat( 4, kLookDir:GetX() );\n\
--	action:SetParamFloat( 5, kLookDir:GetY() );\n\
--	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kEffectDef = GetEffectDef(action:GetActionNo());\n\
	local fDurationTime = kEffectDef:GetDurationTime()/1000.0;\n\
	action:SetParamFloat(4, fDurationTime); --   \n\
	action:SetParamFloat(5, g_world:GetAccumTime()); --  \n\
	action:SetParamInt(10, 0);\n\
	actor:SetParam(\"End\",\"FALSE\"); --     \n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_GetAimingTarget(actor,action)\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetTotalGUIDInContainer() == 0 then\n\
		return nil;\n\
	end\n\
	\n\
	local	kTargetGUID = action:GetGUIDInContainer(0);\n\
	if kTargetGUID:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
	if kTargetPilot:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	local	kTargetActor = kTargetPilot:GetActor();\n\
	if kTargetActor:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	return	kTargetActor;\n\
\n\
end\n\
function Skill_AutoShootSystem_Fire_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if bIsBefore == false then\n\
		ODS(\"Skill_AutoShootSystem_Fire_OnTargetListModified\\n\");\n\
		Skill_AutoShootSystem_Fire_FireToTarget(actor,action);\n\
	end\n\
\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_FireToTarget(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	actor:ResetAnimation();\n\
	action:SetParamInt(2,2)\n\
	action:SetSlot(1)\n\
	actor:PlayCurrentSlot();\n\
\n\
	local   kPacket = action:GetParamAsPacket();\n\
	\n\
	if kPacket ~= nil and kPacket:IsNil() == false then\n\
		action:SetParamFloat(7,kPacket:PopFloat());\n\
		action:SetParamFloat(8,kPacket:PopFloat());\n\
		action:SetParamFloat(9,kPacket:PopFloat());\n\
	end\n\
	\n\
	actor:LookAt(Point3(action:GetParamFloat(7),action:GetParamFloat(8),action:GetParamFloat(9)),true,false,true);\n\
	\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_BroadCastFire(actor,action,kTargetPos)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetParamInt(2,1)\n\
	\n\
	action:SetParamFloat(7,kTargetPos:GetX());\n\
	action:SetParamFloat(8,kTargetPos:GetY());\n\
	action:SetParamFloat(9,kTargetPos:GetZ());\n\
	\n\
	if IsSingleMode() then\n\
	\n\
		Skill_AutoShootSystem_Fire_OnTargetListModified(actor,action,false)\n\
		\n\
	else	\n\
		action:BroadCastTargetListModify(actor:GetPilot(),true);		\n\
	end\n\
\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnOverridePacket(actor,action,packet)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    if action:GetParamInt(2) == 1 then\n\
		packet:PushFloat(action:GetParamFloat(7));\n\
		packet:PushFloat(action:GetParamFloat(8));\n\
		packet:PushFloat(action:GetParamFloat(9));\n\
    end\n\
    \n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(2);	\n\
	\n\
	if accumTime - action:GetParamFloat(5) >  action:GetParamFloat(4) then\n\
		actor:SetParam(\"End\",\"TRUE\");\n\
		return false;\n\
	end\n\
\n\
	if accumTime - action:GetParamFloat(5) > action:GetParamFloat(4) - 1 then\n\
		if 0 == action:GetParamInt(10) then\n\
			actor:SetTargetAlpha(actor:GetAlpha(), 0, 0.5);\n\
			action:SetParamInt(10,1);\n\
		end\n\
	end\n\
\n\
	ODS(\"Skill_AutoShootSystem_Fire_OnUpdate iState:\"..iState..\"\\n\");\n\
	\n\
	if iState == 0 then	--	Idle State\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			--	0.5     \n\
			local	fLastTime = action:GetParamFloat(3)\n\
			local	fElapsedTime = accumTime - fLastTime;\n\
			\n\
			if fElapsedTime > 0.5 then\n\
				action:SetParamFloat(3,accumTime);\n\
			\n\
				local	kTargetActor = Skill_AutoShootSystem_Fire_FindTarget(actor,action)\n\
				if kTargetActor ~= nil then					\n\
					kTargetActor:AttachParticle(7215, \"p_ef_heart\", \"ef_select_01\");\n\
				\n\
					Skill_AutoShootSystem_Fire_BroadCastFire(actor,action,kTargetActor:GetPos());\n\
					return	true;\n\
				\n\
				end\n\
			\n\
			end\n\
			\n\
		end\n\
	\n\
	elseif iState == 1 then	-- Waiting State\n\
	elseif iState == 2 then -- Firing State\n\
	\n\
		if actor:IsAnimationDone() then\n\
			--	To Idle State\n\
			action:SetParamInt(2,0);\n\
			action:SetSlot(0);\n\
			actor:PlayCurrentSlot();\n\
			return	true;\n\
		end		\n\
		\n\
	elseif iState == 4 then\n\
		\n\
		if accumTime - action:GetActionEnterTime() >1 then\n\
			action:SetParamInt(2,0)\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnCleanUp(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if actor:GetParam(\"End\") == \"TRUE\" then\n\
		return true;\n\
	end\n\
\n\
	return false;\n\
end\n\
\n\
function Skill_AutoShootSystem_Fire_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
\n\
	ODS(\"Skill_AutoShootSystem_Fire_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_AutoShootSystem_Fire_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			ODS(\"kMovingDir :\"..kMovingDir:GetX()..\",\"..kMovingDir:GetY()..\",\"..kMovingDir:GetZ()..\"\\n\");\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_InstallDefault_StartTimer(actor, action)\n\
    \n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsUnderMyControl() then\n\
        \n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        local	fCreateTime = tonumber(actor:GetParam(\"Entity_Create_Time\"));\n\
        local	fElapsedTime = g_world:GetAccumTime() - fCreateTime;\n\
        \n\
        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
    	\n\
        if fLifeTime == 0 then\n\
            fLifeTime = 10.0;\n\
        end\n\
            \n\
        --   \n\
        action:StartTimer(fLifeTime-fElapsedTime,0.5,0)\n\
    \n\
    end\n\
    \n\
end\n\
\n\
function Skill_AutoShootSystem_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_AutoShootSystem_Play_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
		actor:AttachSound(120,\"AutoShootSystem\");\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_AutoShootSystem_Play_OnTimer(actor, accumTime, action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	if action:GetTargetList()>0 then	--	   .\n\
	\n\
		actor:ReserveTransitAction(\"a_AutoShootSystem_Fire\");\n\
	\n\
	end\n\
    \n\
    return true;\n\
\n\
end\n\
\n\
function Skill_AutoShootSystem_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local   kState = action:GetParam(0);\n\
	\n\
	if action:GetParamFloat(3) >0 and (accumTime - action:GetParamFloat(3)> 1) then\n\
		Skill_InstallDefault_StartTimer(actor,action)\n\
		action:SetParamFloat(3,0);\n\
	end\n\
	\n\
\n\
    if actor:IsUnderMyControl() then\n\
    \n\
        --  10   .\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        local	fCreateTime = tonumber(actor:GetParam(\"Entity_Create_Time\"));\n\
        local	fElapsedTime = g_world:GetAccumTime() - fCreateTime;\n\
        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
    	\n\
        if fLifeTime == 0 then\n\
            fLifeTime = 10.0;\n\
        end\n\
        \n\
        ODS(\"Skill_AutoShootSystem_Play_OnUpdate fTotalElapsedTime : \"..fElapsedTime..\"\\n\");\n\
        \n\
        if fElapsedTime > fLifeTime then\n\
			action:SetParam(0,\"end\");\n\
            return  false;\n\
        end\n\
    \n\
    end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_AutoShootSystem_Play_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
    \n\
	return true;\n\
end\n\
\n\
function Skill_AutoShootSystem_Play_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kParam = actor:GetAction():GetParam(0)\n\
	\n\
	if action:GetID() == \"a_AutoShootSystem_Fire\" then\n\
		return	true\n\
	end\n\
	\n\
	return (kParam == \"end\");\n\
end\n\
\n\
function Skill_AutoShootSystem_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_WindMill_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if(true == actor:IsInCoolTime(action:GetActionNo(), false) ) then\n\
		return false\n\
	end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( false == curAction:IsNil() ) then\n\
		local kActionName = curAction:GetID();		\n\
		if(\"a_head_spin\" == kActionName or \"a_Nineteen Ninety\" == kActionName) then\n\
			curAction:SetNextActionName(\"a_Windmill\");\n\
			curAction:ChangeToNextActionOnNextUpdate(true, true);\n\
		end\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Skill_WindMill_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_WindMill_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_WindMill_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParamFloat(2,g_world:GetAccumTime()); --   \n\
	action:SetParamFloat(6,0);\n\
\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	\n\
	actor:AttachParticle(19002,\"char_root\",\"ef_Windmill_01_char_root\");\n\
	actor:AttachParticleWithRotate(19003,\"p_ef_heart\",\"ef_Windmill_01_p_ef_heart\", 1.0, true);\n\
\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
end\n\
\n\
function Skill_WindMill_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	--ODS(\"Skill_WindMill_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_WindMill_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_WindMill_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	action:SetParamFloat(30, g_world:GetAccumTime())\n\
	Skill_WindMill_OnCastingCompleted(actor,action);\n\
\n\
	return true\n\
end\n\
function Skill_WindMill_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_WindMill_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
end\n\
\n\
function Skill_WindMill_UpdateTarget(actor,action,accumTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsMyActor() == false then\n\
        return\n\
    end\n\
    \n\
	local iSlot = action:GetCurrentSlot();\n\
\n\
	if iSlot == 3 then\n\
		local   fLastUpdateTime = action:GetParamFloat(6);\n\
		if accumTime - fLastUpdateTime <0.3 then\n\
			return\n\
		end\n\
	else\n\
		local   fLastUpdateTime = action:GetParamFloat(6);\n\
		if accumTime - fLastUpdateTime <0.4 then\n\
			return\n\
		end\n\
	end\n\
\n\
    action:SetParamFloat(6,accumTime);\n\
\n\
    --    .        \n\
    action:CreateActionTargetList(actor);\n\
    \n\
	--   \n\
	if action:GetTargetCount()>0 then\n\
	    action:BroadCastTargetListModify(actor:GetPilot());\n\
		local iSlot = action:GetCurrentSlot();\n\
		if iSlot ~= 3 then\n\
			actor:AttachParticleWithRotate(500,\"p_ef_heart\",\"ef_Windmill_02_p_ef_heart\", 1.0, true);\n\
		end\n\
	end\n\
	\n\
	action:ClearTargetList();\n\
	\n\
	ODS(\"Skill_WindMill_UpdateTarget\\n\");\n\
	    \n\
end\n\
\n\
function Skill_WindMill_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actionID = action:GetID();\n\
--	local movingSpeed = 0\n\
	local bAnimDone = actor:IsAnimationDone();\n\
	local iSlot = action:GetCurrentSlot();\n\
	local nextActionName = action:GetNextActionName();\n\
\n\
	--ODS(\"Skill_WindMill_OnUpdate NextActionName : \"..nextActionName..\"\\n\");\n\
	if nextActionName == \"a_Head Spin\" then\n\
		action:SetNextActionName(\"a_idle\");\n\
	end\n\
\n\
	local iSkillLevel = action:GetAbil(AT_LEVEL);\n\
\n\
	--     3  \n\
	if actor:IsMyActor() then\n\
		if iSkillLevel > 2 then\n\
			local	bKeyUp = KeyIsDown(KEY_UP);\n\
			local	bKeyDown = KeyIsDown(KEY_DOWN);\n\
			local	bKeyLeft = KeyIsDown(KEY_LEFT);\n\
			local	bKeyRight = KeyIsDown(KEY_RIGHT);\n\
			\n\
			local	iDir = 0\n\
			if bKeyUp then \n\
				iDir = iDir + DIR_UP\n\
			end\n\
			if bKeyDown then\n\
				iDir = iDir + DIR_DOWN\n\
			end\n\
			if bKeyLeft then\n\
				iDir = iDir + DIR_LEFT\n\
			end\n\
			if bKeyRight then\n\
				iDir = iDir + DIR_RIGHT\n\
			end\n\
\n\
			if iDir ~= 0 then\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				local iMoveSpeed = actor:GetAbil(AT_C_MOVESPEED) * 0.5\n\
				local kDirection = actor:GetDirectionVector(iDir);\n\
\n\
				kDirection:Multiply(iMoveSpeed);\n\
				actor:SetMovingDelta(kDirection);\n\
				local fTimeDelta = g_world:GetAccumTime() - action:GetParamFloat(30)\n\
				if(fTimeDelta > 0.02) then --       \n\
					g_pilotMan:BroadcastDirection(actor:GetPilot(), iDir)\n\
					action:SetParamFloat(30, g_world:GetAccumTime())\n\
				end\n\
			end\n\
		end\n\
	end	\n\
\n\
    if iSlot == 1 then\n\
\n\
	    if bAnimDone then\n\
	        actor:PlayNext();\n\
	        action:SetParamFloat(2,accumTime);\n\
	    end    \n\
    elseif iSlot == 2 then	\n\
	\n\
    	Skill_WindMill_UpdateTarget(actor,action,accumTime);\n\
    	\n\
    	local   fElapsedTime = accumTime - action:GetParamFloat(2);\n\
    	if fElapsedTime > 2.3 then \n\
    	    actor:PlayNext();\n\
			actor:DetachFrom(19003,true);\n\
			actor:AttachParticle(19003,\"char_root\",\"ef_Windmill_02_char_root\");\n\
    	end    	\n\
    else\n\
		Skill_WindMill_UpdateTarget(actor,action,accumTime);\n\
\n\
        if bAnimDone then        \n\
            action:SetParam(1,\"end\");\n\
            return false;        \n\
        end    \n\
    end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_WindMill_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(19002);\n\
	actor:DetachFrom(19003);\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	return true;\n\
end\n\
\n\
function Skill_WindMill_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_Meteor_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Meteor_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Meteor_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function	Skill_Meteor_LoadArrowToWeapon(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	local	iRandom = math.random(-20,20);\n\
	if iRandom == 0 then\n\
		iRandom = 1;\n\
	end\n\
\n\
	kMovingDir:Multiply(iAttackRange/3+iRandom);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ()+150);\n\
	\n\
	kNewArrow:SetWorldPos(kPos);\n\
	\n\
	return  kNewArrow;\n\
end\n\
\n\
function Skill_Meteor_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
        --     .\n\
\n\
	    local	iAttackRange = action:GetSkillRange(0,actor)\n\
	    local	kArrow = Skill_Meteor_LoadArrowToWeapon(actor,action);\n\
    	\n\
	    local	targetobject = nil;\n\
\n\
	    if kArrow:IsNil() == false then\n\
    	\n\
		    local	kPos = actor:GetPos();\n\
		    local	kMovingDir = actor:GetLookingDir();\n\
			--    			\n\
			local iStartDistance = -action:GetAbil(AT_SKILL_BACK_DISTANCE) + iAttackRange/2\n\
			local iRandDist = iStartDistance + math.random(-iAttackRange/3, iAttackRange/3)\n\
		    kMovingDir:Multiply(iRandDist);\n\
			\n\
		    kPos:Add(kMovingDir);\n\
		    kPos:SetZ(kPos:GetZ()-20);\n\
			 \n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
		    local	kPos2 = g_world:ThrowRay(kPos,Point3(0,0,-1),500);	--	  \n\
		    local	iTargetCount = action:GetTargetCount();\n\
    		\n\
		    actor:LookAt(kPos);\n\
    	\n\
		    kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
    		\n\
		    if iTargetCount>0 then\n\
			    kArrow:SetTargetObjectList(action:GetTargetList());	\n\
		    end\n\
\n\
		    if kPos2:GetX() == -1 and \n\
			    kPos2:GetY() == -1 and\n\
			    kPos2:GetZ() == -1 then\n\
			    --kPos2 = g_world:ThrowRay(actor:GetPos(), Point3(0,0,-1), 500)\n\
				kPos2 = kPos\n\
		    end\n\
\n\
		    kArrow:SetTargetLoc(kPos2);\n\
		    kArrow:Fire();\n\
			local ptcl = kArrow:GetTargetLoc();\n\
			ptcl:SetZ(ptcl:GetZ()+5)\n\
			kArrow:SetParamValue(\"Scale\", \"\".. 4);\n\
			kArrow:SetScale(tonumber(kArrow:GetParamValue(\"Scale\")));\n\
			--actor:AttachParticleToPointS(1509, ptcl, \"ef_Meteorstrike_01_char_root\" , tonumber(kArrow:GetParamValue(\"Scale\")));\n\
    	\n\
	    end\n\
	    action:ClearTargetList();        \n\
	    action:SetParam(1,\"fire\");\n\
    \n\
    end\n\
\n\
end\n\
\n\
\n\
function Skill_Meteor_Fire(actor,action)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(2,0);    --  State   	\n\
	local iMaxFireCnt = action:GetAbil(AT_COUNT)\n\
	if(0 == iMaxFireCnt) then\n\
		iMaxFireCnt = 1\n\
	end\n\
	action:SetParamInt(3, iMaxFireCnt);\n\
	action:SetParamInt(4,0);	\n\
end\n\
--[[\n\
function Skill_Meteor_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
    end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iAttackRange,0);	\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)\n\
end\n\
]]\n\
function Skill_Meteor_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	--ODS(\"Skill_Meteor_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local	kPos = actor:GetPos();\n\
    local	kMovingDir = actor:GetLookingDir();\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local iStartDistance = -action:GetAbil(AT_SKILL_BACK_DISTANCE) + iAttackRange/2 --     \n\
    kMovingDir:Multiply(iStartDistance);\n\
	kPos:Add(kMovingDir);\n\
	\n\
	ODS(\"iStartDistance:\"..iStartDistance..\"\\n\", false, 912)\n\
	\n\
	local fScale = iAttackRange/19.2\n\
	actor:AttachParticleToPointS(1509, kPos, \"ef_Meteorstrike_01_char_root\" , fScale);\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Meteor_OnCastingCompleted(actor,action);	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Meteor_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local   bAnimDone = actor:IsAnimationDone();\n\
	local   iState =action:GetParamInt(2);\n\
	local iMaxFireCnt = action:GetParamInt(3);\n\
	--ODS(\"iMaxFireCnt\"..iMaxFireCnt..\"\\n\", false, 912)\n\
	local iCurFireCnt = action:GetParamInt(4);\n\
	if iState == 0 then\n\
	\n\
	    if bAnimDone then\n\
	    \n\
            action:CreateActionTargetList(actor);   --    \n\
            \n\
            if IsSingleMode() == false and action:GetTargetCount()>0 then\n\
                action:BroadCastTargetListModify(actor:GetPilot());    --  \n\
                action:ClearTargetList();\n\
            else\n\
                Skill_Meteor_OnTargetListModified(actor,action,false);\n\
                \n\
            end\n\
			iCurFireCnt = iCurFireCnt+1\n\
			if(iCurFireCnt == iMaxFireCnt) then\n\
				actor:PlayNext();\n\
				action:SetParamInt(2,1);\n\
			else\n\
				actor:PlayCurrentSlot();\n\
				action:SetParamInt(4, iCurFireCnt)\n\
			end\n\
\n\
			-- \n\
			if 1 == actor:GetAbil(AT_GENDER) then\n\
				actor:AttachSound(2785,\"Male_Strike\");\n\
			-- \n\
			else\n\
				actor:AttachSound(2785,\"Female_Strike\");\n\
			end\n\
			\n\
	    \n\
	    end\n\
	\n\
	elseif iState == 1 then\n\
	\n\
        if action:GetParam(1) == \"fire\" and bAnimDone then\n\
            action:SetParam(1,\"end\");\n\
            return  false\n\
        end	\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Meteor_OnCleanUp(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local   kCurAction = actor:GetAction();\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	actor:DetachFrom(1509);	\n\
	return true;\n\
end\n\
\n\
function Skill_Meteor_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" or \"a_run\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_Meteor_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
        \n\
        if actor:IsMyActor() then \n\
\n\
        end\n\
        \n\
	end\n\
\n\
	return	true;\n\
end") );
	m_kContLuaText.push_back(std::string("-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
\n\
\n\
-- Melee\n\
function Skill_OctopusInk_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_OctopusInk_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_OctopusInk_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_OctopusInk_Fire(actor,action)\n\
end\n\
\n\
function Skill_OctopusInk_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
        --   \n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);        \n\
        action:SetParam(1,\"fire\");\n\
        \n\
    end\n\
\n\
end\n\
\n\
function Skill_OctopusInk_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end	\n\
	\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_OctopusInk_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_OctopusInk_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_OctopusInk_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_OctopusInk_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if action:GetParam(1) == \"wait\" and animDone then\n\
	\n\
	    action:SetParam(1,\"end\");\n\
	    return  false\n\
	end\n\
	if action:GetParam(1) == \"fire\" and accumTime - action:GetParamFloat(3)>2 then\n\
	\n\
	    action:SetParam(1,\"wait\");\n\
	    actor:PlayNext();\n\
	    \n\
	    return  true;\n\
	end\n\
	\n\
	\n\
	if actor:IsMyActor() then\n\
	\n\
	    if action:GetParamFloat(2)>0 then\n\
    	\n\
	        local   fElapsedTime = accumTime - action:GetParamFloat(2);\n\
	        if fElapsedTime>0.5 then\n\
    	    \n\
    	        action:CreateActionTargetList(actor);\n\
                \n\
                if IsSingleMode() == false and action:GetTargetCount()>0 then\n\
                    action:BroadCastTargetListModify(actor:GetPilot());    --  \n\
                    action:ClearTargetList();\n\
                else\n\
                    Skill_OctopusInk_OnTargetListModified(actor,action,false);\n\
                end    	 \n\
                \n\
                action:SetParamFloat(2,0);   \n\
                \n\
	        end\n\
    	\n\
	    end\n\
	\n\
	end\n\
	\n\
	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_OctopusInk_OnCleanUp(actor)\n\
    \n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    actor:DetachFrom(7213);\n\
	return true;\n\
end\n\
\n\
function Skill_OctopusInk_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_OctopusInk_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	    \n\
	    local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	        --actor:AttachParticle(7213,kHitEffectTargetNodeID,kHitEffectID);			\n\
			actor:AttachParticleToPointWithRotate(7213,actor:GetNodeWorldPos(\"char_root\"), kHitEffectID, actor:GetRotateQuaternion());	\n\
	    end\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
	    \n\
	    kAction:SetParamFloat(2,g_world:GetAccumTime());\n\
        kAction:SetParamFloat(3,g_world:GetAccumTime());\n\
	    \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_GroundMine_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_GroundMine_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_GroundMine_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_GroundMine_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    action:SetParamFloat(6,-actor:GetLookingDir():GetX());\n\
    action:SetParamFloat(7,-actor:GetLookingDir():GetY());\n\
    action:SetParamFloat(8,-actor:GetLookingDir():GetZ());\n\
\n\
end\n\
\n\
function Skill_GroundMine_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = Point3(action:GetParamFloat(2),action:GetParamFloat(3),action:GetParamFloat(4));\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,50,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_GroundMine_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_GroundMine_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_GroundMine_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
function Skill_GroundMine_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
        --       .\n\
        actor:DetachFrom(378001);        \n\
    \n\
    	local	kPos = Point3(action:GetParamFloat(2),action:GetParamFloat(3),action:GetParamFloat(4));\n\
    	\n\
    	actor:AttachParticleToPoint(378002,kPos,\"ef_Magnumbreak_01_char_root\");\n\
    	action:GetTargetList():ApplyActionEffects();\n\
    	\n\
    	action:SetParam(1,\"fire\");\n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_GroundMine_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local iSlotNum = action:GetCurrentSlot();\n\
\n\
    if 	iSlotNum == 1 then\n\
    \n\
        if animDone then\n\
        \n\
            if actor:IsMyActor() then\n\
            \n\
                --     .\n\
                action:CreateActionTargetList(actor);\n\
                \n\
                if IsSingleMode() or action:GetTargetCount() == 0 then\n\
                   Skill_GroundMine_OnTargetListModified(actor,action,false);\n\
                else\n\
                    action:BroadCastTargetListModify(actor:GetPilot());\n\
                    action:ClearTargetList();\n\
                end\n\
                \n\
            \n\
            end\n\
            \n\
            --   .\n\
            actor:PlayNext();\n\
        \n\
        end\n\
        \n\
    elseif iSlotNum == 2 then\n\
    \n\
        if animDone and action:GetParam(1) == \"fire\" then\n\
        \n\
            action:SetParam(1,\"end\");\n\
            return  false;\n\
            \n\
        end\n\
    \n\
        \n\
        if animDone == false then\n\
            \n\
	        local movingSpeed = 0\n\
\n\
	        if IsSingleMode() == true then\n\
		        movingSpeed = 120 \n\
	        else\n\
		        movingSpeed = actor:GetAbil(AT_C_MOVESPEED)\n\
	        end        \n\
    	    \n\
	        local   kMovingDir = Point3(action:GetParamFloat(6),action:GetParamFloat(7),action:GetParamFloat(8));\n\
	        kMovingDir:Multiply(movingSpeed*0.6);\n\
    	    \n\
	        actor:SetMovingDelta(kMovingDir);\n\
	    \n\
	    end\n\
    \n\
    end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_GroundMine_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    actor:DetachFrom(378001);\n\
    \n\
	return true;\n\
end\n\
\n\
function Skill_GroundMine_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_GroundMine_CreateMine(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
    local   iAttackRange = action:GetSkillRange(0,actor);\n\
    if iAttackRange == 0 then\n\
        iAttackRange = 50\n\
    end\n\
    \n\
    local   kPos = actor:GetPos();\n\
    local   kLookDir =actor:GetLookingDir();\n\
    kLookDir:Multiply(iAttackRange);\n\
    kPos:Add(kLookDir);\n\
    \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    kPos = g_world:FindActorFloorPos(kPos);\n\
    \n\
    kPos:SetZ(kPos:GetZ()-25);\n\
    \n\
    action:SetParamFloat(2,kPos:GetX());\n\
    action:SetParamFloat(3,kPos:GetY());\n\
    action:SetParamFloat(4,kPos:GetZ());\n\
    \n\
    actor:AttachParticleToPoint(378001,kPos,\"ef_Ground_mine\");\n\
\n\
end\n\
\n\
\n\
function Skill_GroundMine_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
	    --  Mine \n\
	    Skill_GroundMine_CreateMine(actor,kAction);\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_MagnumBreak_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_MagnumBreak_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_MagnumBreak_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_MagnumBreak_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:StartWeaponTrail();\n\
	actor:AttachSound(105,\"BrokenMagnum_Start\");\n\
end\n\
function Skill_MagnumBreak_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	return	Skill_MagnumBreak_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function Skill_MagnumBreak_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	fEffectRange = 60;\n\
\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
	kTargetPos:Add(kMovingDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,fEffectRange,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);\n\
	\n\
	return	action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_MagnumBreak_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_MagnumBreak_OnCastingCompleted(actor,action);	\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_MagnumBreak_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_MagnumBreak_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:RestoreItemModel(ITEM_WEAPON);\n\
	\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Skill_MagnumBreak_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());	\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
\n\
function Skill_MagnumBreak_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
                SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end\n\
    \n\
    \n\
end\n\
\n\
function Skill_MagnumBreak_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
		--   \n\
		local	fDistance = kAction:GetSkillRange(0,actor);		\n\
		\n\
	if textKey == \"start\" then		\n\
		local	kMovingDir = actor:GetLookingDir();\n\
		kMovingDir:Multiply(fDistance);\n\
		local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
		kTargetPos:Add(kMovingDir);\n\
		actor:AttachParticleToPointWithRotate(8,kTargetPos,\"ef_Magnumbreak_03_char_root\", actor:GetRotateQuaternion());\n\
\n\
	end\n\
	if textKey == \"hit\" then\n\
	\n\
	    kAction:SetParam(2,\"HIT\");\n\
	\n\
		actor:AttachSound(105,\"BrokenMagnum\");\n\
\n\
		local	kMovingDir = actor:GetLookingDir();\n\
		kMovingDir:Multiply(fDistance);\n\
		local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
		kTargetPos:Add(kMovingDir);\n\
		actor:AttachParticleToPointWithRotate(9,kTargetPos,\"ef_Magnumbreak_02_char_root\", actor:GetRotateQuaternion());\n\
\n\
		actor:DetachFrom(8);\n\
\n\
	    if actor:IsMyActor() then\n\
    	    kAction:CreateActionTargetList(actor);   --   \n\
	    \n\
	        if IsSingleMode() then\n\
	            Skill_MagnumBreak_OnTargetListModified(actor,kAction,false)\n\
	        else\n\
	            kAction:BroadCastTargetListModify(actor:GetPilot());\n\
	        end\n\
	    \n\
	    end\n\
				\n\
		if actor:IsMyActor() then\n\
			QuakeCamera(0.2, 3, 1, 1, 1);\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Mana_Shield_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local myWeaponType = actor:GetEquippedWeaponType();\n\
\n\
--	if myWeaponType ~= 9 then\n\
--		return false\n\
--	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Mana_Shield_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Mana_Shield_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
function Skill_Mana_Shield_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:DetachFrom(126)\n\
	actor:AttachParticle(127, \"p_wp_l_hand\", \"ef_mag_spell_finish\")\n\
	\n\
\n\
	if actor:IsMyActor() == true then\n\
\n\
		local kTarget = CreateActionTargetList(actor:GetPilotGuid(), action:GetActionInstanceID(),action:GetActionNo())\n\
		local iFound = Skill_Mana_Shield_OnFindTarget(actor,action,kTarget);\n\
\n\
		if iFound > 0 then\n\
			local kTargetInfo = kTarget:GetTargetInfo(0)\n\
			local kTargetGUID = kTargetInfo:GetTargetGUID()\n\
			local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
			if kTargetPilot:IsNil() then\n\
				return true\n\
			end\n\
	\n\
			local kTargetActor = kTargetPilot:GetActor()\n\
			if kTargetActor:IsNil() then\n\
				return true\n\
			end\n\
	\n\
			local kUnitArray = NewUNIT_PTR_ARRAY()\n\
			kUnitArray:AddUnit(kTargetPilot:GetUnit())\n\
			local kActionResult = NewActionResultVector()\n\
	\n\
			-- Action Result \n\
			action:Call_Skill_Result_Func(actor:GetPilot(), kUnitArray, kActionResult)\n\
			local kResult = kActionResult:GetResult(kTargetGUID, false)\n\
			if kResult:IsNil() == false and kResult:GetInvalid() == false then\n\
				action:AddTarget(kTargetGUID, kTargetActor:GetHitObjectABVIndex(), kResult)\n\
			end\n\
	\n\
			DeleteActionResultVector(kActionResult)\n\
			DeleteUNIT_PTR_ARRAY(kUnitArray)\n\
		end\n\
\n\
		DeleteActionTargetList(kTarget)\n\
	else\n\
		GetActionResultCS(action, actor)\n\
	end	\n\
	\n\
		\n\
end\n\
\n\
function Skill_Mana_Shield_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kPrevAction = actor:GetAction();\n\
	if( false == kPrevAction:IsNil() ) then\n\
		local prevActionID = kPrevAction:GetID()\n\
		if prevActionID == \"a_Mana Shield\" then\n\
			action:SetParam(911, \"end\")\n\
			action:SetDoNotBroadCast(true)\n\
			return true \n\
		end\n\
	end\n\
	\n\
	actor:Stop()\n\
	\n\
	actor:AttachParticle(126, \"p_wp_l_hand\", \"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\")\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Mana_Shield_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Mana_Shield_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kParam = FindTargetParam()\n\
	kParam:SetParam_1(actor:GetTranslate(), actor:GetLookingDir())\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor), 30, 0, 0)\n\
	kParam:SetParam_3(true, FTO_NORMAL)\n\
\n\
	return	action:FindTargets(TAT_RAY_DIR, kParam, kTargets, kTargets);\n\
end\n\
\n\
function Skill_Mana_Shield_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local bIsAnimDone = actor:IsAnimationDone()\n\
	local nextActionID = action:GetNextActionName()\n\
	local endParam = action:GetParam(911)\n\
	local iSlot = action:GetCurrentSlot()\n\
\n\
	if endParam == \"end\" then\n\
		return false\n\
	end\n\
\n\
	if bIsAnimDone == true then\n\
		if iSlot == 1 then\n\
			if nextActionID == \"a_idle\" then\n\
				nextActionID = \"a_battle_idle\"\n\
			end\n\
			action:SetParam(911, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Mana_Shield_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local endParam = curAction:GetParam(911)\n\
\n\
	if endParam ~= \"end\" then\n\
		actor:DetachFrom(126,true)\n\
	end\n\
	\n\
end\n\
\n\
function Skill_Mana_Shield_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local nextActionID = action:GetID()\n\
	local endParam = curAction:GetParam(911)\n\
\n\
	if endParam == \"end\" then\n\
		return true\n\
	end\n\
\n\
	return false	\n\
end\n\
\n\
function Skill_Mana_Shield_OnEvent(actor, textKey)\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		Skill_Mana_Shield_DoEffect(actor)\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Mana_Shield_DoEffect(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local kGuid = actor:GetPilotGuid()\n\
\n\
--	local kHelperPos = actor:GetNodeWorldPos(\"char_root\")\n\
	local iTargetCount = action:GetTargetCount()\n\
	\n\
	actor:AttachSound(7283,\"ManaShield\");\n\
\n\
	-- TargetCount  .\n\
	if iTargetCount > 0 then\n\
\n\
--		local kActionResult = action:GetTargetActionResult(0)\n\
--		local pt = actor:GetABVShapeWorldPos(action:GetTargetABVShapeIndex(0))\n\
\n\
		-- Heal  \n\
		\n\
		action:GetTargetList():ApplyActionEffects();		\n\
\n\
		-- Heal Effect\n\
		action:ClearTargetList()\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_Detonator_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_Detonator_OnCastingCompleted(actor, action)\n\
\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_Detonator_OnEnter(actor, action)\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Detonator_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Detonator_OnCastingCompleted(actor,action);\n\
	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Detonator_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local actionID = action:GetID();\n\
\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Detonator_OnCleanUp(actor)\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Detonator_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Detonator_OnEvent(actor,textKey)\n\
\n\
	local action = actor:GetAction();\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		actor:AttachSound(2000,\"Claymore3\");\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        \n\
		for i=1,8 do\n\
			local   kClaymoreGUID = actor:GetParam(\"Claymore_GUID_\"..i);\n\
			actor:SetParam(\"Claymore_GUID_\"..i, \"\");\n\
			if kClaymoreGUID ~= nil and kClaymoreGUID ~= \"\" then\n\
				--WriteToConsole(\"Claymore_GUID_\"..i..\"   bome_force\\n\");\n\
				actor:SetParam(\"Claymore_GUID_\"..i, \"\");\n\
				kClaymoreGUID = GUID(kClaymoreGUID)\n\
				local   kClaymore = g_world:FindActor(kClaymoreGUID)\n\
				if kClaymore:IsNil() == false then\n\
                \n\
					local   kAction = kClaymore:GetAction();\n\
					if kAction:IsNil() then \n\
						kAction = kClaymore:GetReservedTransitAction();\n\
					end\n\
                    \n\
					if kAction:IsNil() then\n\
						return\n\
					end\n\
                    \n\
					if kAction:GetParam(0) == \"Idle\" then\n\
						kAction:SetParam(0,\"bomb_force\")\n\
					end                \n\
				end            \n\
			end				\n\
		end\n\
    end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_Haphazard_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Haphazard_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Haphazard_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Haphazard_OnCastingCompleted(actor,action);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Haphazard_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Haphazard_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	actor:AttachParticle(7215,\"p_ef_heart\",\"ef_JudgeDread_01_p_ef_heart\");\n\
\n\
end\n\
function Skill_Haphazard_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Haphazard_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end    \n\
    end	\n\
end\n\
\n\
function Skill_Haphazard_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_Haphazard_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	if IsSingleMode() then\n\
    \n\
		Skill_Haphazard_HitOneTime(actor,action)\n\
		Skill_Haphazard_OnTargetListModified(actor,action,false)\n\
        \n\
		return true;\n\
	else\n\
    \n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
        \n\
	end			\n\
	\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
\n\
function Skill_Haphazard_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_Haphazard_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_Haphazard_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
   	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
   	kParam:SetParam_2(0,iAttackRange,iAttackRange,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Haphazard_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID();\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil())\n\
	\n\
	local animDone = actor:IsAnimationDone();\n\
	local nextActionName = action:GetNextActionName();\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	local iSlot = action:GetCurrentSlot();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if 1 == iSlot then\n\
		if true == animDone then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
			actor:AttachParticle(7216,\"p_ef_heart\",\"ef_JudgeDread_02_p_ef_heart\");\n\
			action:SetParamFloat(4,accumTime);\n\
		end\n\
	elseif 2 == iSlot then\n\
		local   fElapsedTIme = accumTime - action:GetParamFloat(4);\n\
		if fElapsedTIme > 2.8 then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
			actor:DetachFrom(7215,true);\n\
			actor:DetachFrom(7216,true);\n\
		end\n\
\n\
	elseif 3 == iSlot then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Haphazard_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());	\n\
    \n\
	actor:DetachFrom(7215,true);\n\
	actor:DetachFrom(7216,true);\n\
        \n\
	ODS(\"RestoreItemModel Skill_Haphazard_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
	    actor:DetachFrom(7212)\n\
	    actor:DetachFrom(7213)\n\
	\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_Haphazard_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		curAction:SetParam(1,\"end\")\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_run\" then \n\
		curAction:SetParam(1,\"end\")\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	elseif curParam == \"end\" and (actionID == \"a_run\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Haphazard_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);	\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_Haphazard_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7213,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Haphazard_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Haphazard_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    end\n\
end\n\
\n\
function Skill_Haphazard_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		kAction:CreateActionTargetList(actor);\n\
\n\
		if actor:IsUnderMyControl() then\n\
			kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function ThiefFloatAttack_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function ThiefFloatAttack_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if (actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\")) then\n\
		return false;\n\
	end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == true then\n\
			return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function ThiefFloatAttack_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
	\n\
	local iTargetCount = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"Skill_ThiefFloatMelee_OnFindTarget iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	return	iTargetCount;\n\
end\n\
\n\
function ThiefFloatAttack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"ThiefFloatAttack_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(2,g_world:GetAccumTime());\n\
	\n\
	--	  \n\
	action:SetParamFloat(3,g_world:GetAccumTime());\n\
	\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	actor:AttachParticle(9182,\"char_root\",\"ef_jump_attk_01_char_root\");\n\
	\n\
	if actor:IsMyActor() then\n\
	\n\
		GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
		GetComboAdvisor():AddNextAction(\"a_thi_melee_drop\");\n\
    \n\
    end\n\
	\n\
	return true\n\
end\n\
\n\
function ThiefFloatAttack_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	fMaxTime = 2;	--	    \n\
	local	fMaxTimeFromRecentAttack = 0.5;	--	    0.5 .\n\
	local	fAutoFireDelay = 0.1;\n\
	\n\
	if action:GetParamInt(5) == 0 then\n\
		ThiefFloatAttack_AttackKeyInput(actor,action)\n\
		action:SetParamInt(5,1)\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(2)\n\
		--ODS(\"ThiefFloatAttack_OnUpdate fElapsedTime :\"..fElapsedTime..\"\\n\");\n\
		\n\
		if 	fElapsedTime>fMaxTime then\n\
			action:SetParam(1,\"end\");\n\
			return	false\n\
		end\n\
		\n\
		fElapsedTime = accumTime - action:GetParamFloat(3)\n\
		if fElapsedTime>fMaxTimeFromRecentAttack then\n\
			action:SetParam(1,\"end\");\n\
			return	false\n\
		end\n\
		\n\
		if fElapsedTime>fAutoFireDelay and KeyIsDown(KEY_FIRE) then\n\
			actor:ReserveTransitAction(actor:GetNormalAttackActionID(),DIR_NONE);\n\
		end\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function ThiefFloatAttack_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	end\n\
\n\
end\n\
\n\
function ThiefFloatAttack_AttackKeyInput(actor,CurAction,kNewAction)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==CurAction);\n\
	CheckNil(CurAction:IsNil());\n\
	\n\
	if Act_Melee_IsToDownAttack(actor,kNewAction) then\n\
		return	true\n\
	end\n\
\n\
	local	iMaxHit = 15;	--	   \n\
	local	iCurrentHit = CurAction:GetParamInt(4);\n\
	if iCurrentHit>=iMaxHit then\n\
		return\n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
		GetComboAdvisor():OnNewActionEnter(CurAction:GetID());\n\
		GetComboAdvisor():AddNextAction(\"a_thi_melee_drop\");\n\
    end\n\
	\n\
	iCurrentHit = iCurrentHit+1;\n\
	CurAction:SetParamInt(4,iCurrentHit);\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	CurAction:SetParamFloat(3,g_world:GetAccumTime());\n\
	CurAction:CreateActionTargetList(actor);\n\
	\n\
	if CurAction:GetTargetCount()>0 then\n\
		if actor:IsMyActor() then\n\
			QuakeCamera(0.1,1,0,0.01,10);\n\
		end	\n\
	end\n\
	\n\
	if IsSingleMode() or CurAction:GetTargetCount() == 0 then\n\
	\n\
		ThiefFloatAttack_OnTargetListModified(actor,CurAction,false);\n\
	\n\
	else\n\
        CurAction:BroadCastTargetListModify(actor:GetPilot());\n\
        CurAction:ClearTargetList();	\n\
	end\n\
	\n\
	\n\
	return	false;\n\
\n\
end\n\
\n\
function ThiefFloatAttack_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
	actor:SetParam(\"FLOAT_ATTACK_ENABLE\",\"FALSE\");\n\
	actor:DetachFrom(9182);\n\
\n\
	return true;\n\
end\n\
\n\
function ThiefFloatAttack_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	if actionID == \"a_jump\" then \n\
		if curParam == \"end\" or actor:IsMyActor() == false then\n\
			action:SetSlot(2)	\n\
			return	true;\n\
		end\n\
		return false;\n\
	end\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
		\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
		if string.sub(action:GetID(),1,11) == \"a_thi_melee\" then\n\
			return ThiefFloatAttack_AttackKeyInput(actor,curAction,action);\n\
		end\n\
\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_BoobyTrap_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_BoobyTrap_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	Skill_BoobyTrap_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_BoobyTrap_CreateActionTargetList(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsMyActor() == false then\n\
        return\n\
    end\n\
	\n\
	local	kTargets = CreateActionTargetList(actor:GetPilotGuid(),action:GetActionInstanceID(),action:GetActionNo());\n\
	local	iFound = Skill_BoobyTrap_OnFindTarget(actor,action,kTargetPos,kTargets);\n\
	\n\
	if iFound > 0 then\n\
		--  ,   \n\
		local i =0 ;\n\
		\n\
		while i<iFound do\n\
		\n\
			local	kTargetInfo = kTargets:GetTargetInfo(i);\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());		\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
			\n\
				local kUnitArray = NewUNIT_PTR_ARRAY()\n\
				kUnitArray:AddUnit(kTargetPilot:GetUnit())\n\
				local kActionResult = NewActionResultVector()\n\
				\n\
				action:Call_Skill_Result_Func(actor:GetPilot(), kUnitArray, kActionResult);\n\
				local kAResult = kActionResult:GetResult(kTargetInfo:GetTargetGUID(), false)\n\
				if kAResult:IsNil() == false and kAResult:GetInvalid() == false then\n\
					action:AddTarget(kTargetActor:GetPilotGuid(),kTargetActor:GetHitObjectABVIndex(), kAResult)\n\
				end\n\
				DeleteActionResultVector(kActionResult)\n\
				DeleteUNIT_PTR_ARRAY(kUnitArray)\n\
			end\n\
			i=i+1;\n\
		end\n\
	end\n\
	DeleteActionTargetList(kTargets);\n\
end\n\
\n\
function Skill_BoobyTrap_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
    --        ,  .\n\
    \n\
    local   fDistance = { 5,35,65 }\n\
    local   kTargetPoint;\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    local   i=0;\n\
    while i<3 do\n\
            \n\
        local   kStartPos = actor:GetPos();\n\
        local   kLookDir = actor:GetLookingDir();\n\
        \n\
        kLookDir:Multiply(fDistance[i+1]);\n\
        kStartPos:Add(kLookDir);\n\
        \n\
        kTargetPoint = g_world:FindActorFloorPos(kStartPos);\n\
        \n\
        --   .\n\
        local   kGenPoint = actor:GetPos();\n\
        \n\
	    local guid = GUID(\"123\")\n\
	    guid:Generate()\n\
\n\
	    action:AddNewGUID(guid);\n\
    	\n\
	    local pilot = g_pilotMan:NewPilot(guid, 900012, 0)\n\
	    if pilot:IsNil() == false then\n\
		    g_world:AddActor(guid, pilot:GetActor(), kGenPoint, 6)\n\
			pilot:GetActor():FreeMove(true)\n\
		    pilot:GetActor():ReserveTransitAction(\"a_Booby Trap_Play\")\n\
		    \n\
		    local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		    if kAction:IsNil() == false then\n\
				kAction:SetDoNotBroadCast(true)\n\
    		\n\
		        kAction:SetParamFloat(0,kTargetPoint:GetX());\n\
		        kAction:SetParamFloat(1,kTargetPoint:GetY());\n\
		        kAction:SetParamFloat(2,kTargetPoint:GetZ());\n\
		        \n\
		    end\n\
	    end	        \n\
        i=i+1;\n\
    end\n\
    \n\
    \n\
    action:SetParamFloat(6,-actor:GetLookingDir():GetX());\n\
    action:SetParamFloat(7,-actor:GetLookingDir():GetY());\n\
    action:SetParamFloat(8,-actor:GetLookingDir():GetZ());\n\
\n\
end\n\
\n\
function Skill_BoobyTrap_OnFindTarget(actor,action,kTargetPos,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,50,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_BoobyTrap_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_BoobyTrap_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_BoobyTrap_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_BoobyTrap_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
        local   iBarrelIndex = action:GetParamInt(5);\n\
        \n\
	    local   kGuid = action:GetGUIDInContainer(iBarrelIndex);\n\
	    local   kPilot = g_pilotMan:FindPilot(kGuid);\n\
	    local   kActor = kPilot:GetActor();\n\
	    \n\
	    local   kAction = kActor:GetAction();    \n\
\n\
	    action:GetTargetList():ApplyActionEffects();\n\
	    \n\
	    kAction:SetParam(4,\"BLOW\");\n\
	    ODS(\"Barrel \"..iBarrelIndex..\" To BLOW\\n\");\n\
	    \n\
	    action:SetParamInt(5,iBarrelIndex+1);\n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_BoobyTrap_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	local   iTotalBarrel = action:GetTotalGUIDInContainer();\n\
	local   i=0;\n\
	\n\
	\n\
	if animDone == false then\n\
        local movingSpeed = 0\n\
\n\
        if IsSingleMode() == true then\n\
	        movingSpeed = 120 \n\
        else\n\
	        movingSpeed = actor:GetAbil(AT_C_MOVESPEED)\n\
        end        \n\
	    \n\
        local   kMovingDir = Point3(action:GetParamFloat(6),action:GetParamFloat(7),action:GetParamFloat(8));\n\
        kMovingDir:Multiply(movingSpeed*0.6);\n\
	    \n\
        actor:SetMovingDelta(kMovingDir);	\n\
	\n\
	end\n\
\n\
	if iTotalBarrel == 0 and animDone then\n\
	    action:SetParam(1,\"end\");\n\
	    return  false;\n\
    end\n\
    \n\
    if animDone and action:GetParamInt(5) == 3 then\n\
    \n\
        action:SetParam(1,\"end\");\n\
        return  false;\n\
    \n\
    end\n\
	\n\
	while i<iTotalBarrel do\n\
	\n\
	    local   kGuid = action:GetGUIDInContainer(i);\n\
	    local   kPilot = g_pilotMan:FindPilot(kGuid);\n\
	    local   kActor = kPilot:GetActor();\n\
	    \n\
	    if kActor:IsNil() == false then\n\
	    \n\
	        local   kAction = kActor:GetAction();\n\
	        if kAction:IsNil() == false  then\n\
\n\
                if kAction:GetParam(4) == \"MOVING\" then \n\
                    break\n\
                end\n\
                \n\
                if kAction:GetParam(4) == \"ARRIVED\" then\n\
                    \n\
                    kAction:SetParam(4,\"WAIT\"); \n\
                    ODS(\"Barrel \"..i..\" To WAIT\\n\");\n\
                    \n\
                    --     .\n\
                    --     .\n\
                    Skill_BoobyTrap_CreateActionTargetList(actor,action,kActor:GetPos());\n\
                    if IsSingleMode() or action:GetTargetCount()==0 then\n\
                        Skill_BoobyTrap_OnTargetListModified(actor,action,false);\n\
                    else\n\
                        action:BroadCastTargetListModify(actor,action,false);\n\
                        action:ClearTargetList();\n\
                    end\n\
                \n\
                end\n\
                \n\
	        end\n\
	    \n\
	    end\n\
	\n\
	    i=i+1;\n\
	\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_BoobyTrap_OnCleanUp(actor)\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_BoobyTrap_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_BoobyTrap_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
	\n\
	action:SetParam(4,\"MOVING\");\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(5,g_world:GetAccumTime());\n\
	\n\
	action:SetParamFloat(6,actor:GetPos():GetX());\n\
	action:SetParamFloat(7,actor:GetPos():GetY());\n\
	action:SetParamFloat(8,actor:GetPos():GetZ()+30);\n\
	\n\
	action:SetParamFloat(9,0.7);  --  Total Move Time\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_BoobyTrap_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if  action:GetParam(4) == \"MOVING\" then\n\
        \n\
        --      \n\
        --     .\n\
        local   kTargetPos = Point3(action:GetParamFloat(0),action:GetParamFloat(1),action:GetParamFloat(2));\n\
        local   kStartPos = Point3(action:GetParamFloat(6),action:GetParamFloat(7),action:GetParamFloat(8));\n\
        \n\
        local   fElapsedTime = accumTime - action:GetParamFloat(5);\n\
        local   fMaxTime = action:GetParamFloat(9);\n\
        local   fRate = fElapsedTime/fMaxTime;\n\
        \n\
        local   kCenterPos1 = kTargetPos:_Subtract(kStartPos);\n\
        kCenterPos1:Multiply(0.3);\n\
        kCenterPos1:Add(kStartPos);\n\
        \n\
        kCenterPos1:SetZ(kStartPos:GetZ()+50);\n\
        \n\
        local   kCenterPos2 = kTargetPos:_Subtract(kStartPos);\n\
        kCenterPos2:Multiply(0.6);\n\
        kCenterPos2:Add(kStartPos);\n\
        kCenterPos2:SetZ(kTargetPos:GetZ()+50);\n\
        \n\
\n\
        if fElapsedTime>fMaxTime then\n\
            fRate = 1\n\
        end\n\
        \n\
        \n\
        local   kNextPos = Bezier4(kStartPos,kCenterPos1,kCenterPos2,kTargetPos,fRate);\n\
        actor:SetTranslate(kNextPos);\n\
            \n\
            \n\
        if fRate == 1 then\n\
            --    \n\
            action:SetParam(4,\"ARRIVED\");\n\
        end\n\
    \n\
    end\n\
    \n\
    if action:GetParam(4) == \"BLOW\" then\n\
        local   kTargetPos = Point3(action:GetParamFloat(0),action:GetParamFloat(1),action:GetParamFloat(2));\n\
    \n\
        actor:AttachParticleToPoint(1,kTargetPos,\"ef_Magnumbreak_01_char_root\");\n\
        action:SetParamFloat(5,accumTime);\n\
        action:SetParam(4,\"BLOWING\");\n\
        \n\
        actor:HideNode(\"Scene Root\",true);\n\
    \n\
    end\n\
    \n\
    if action:GetParam(4) == \"BLOWING\" then\n\
    \n\
        local   fElapsedTime = accumTime - action:GetParamFloat(5);\n\
        if fElapsedTime > 3 then\n\
        \n\
            return  false;\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
    \n\
	return true\n\
end\n\
\n\
\n\
function Skill_BoobyTrap_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_BoobyTrap_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_BoobyTrap_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [WEAPON_HIDE] :    \n\
\n\
-- Melee\n\
function Act_Melee_Use_TargetListModified_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then\n\
			return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Melee_Use_TargetListModified_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Act_Melee_Use_TargetListModified_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Act_Melee_Use_TargetListModified_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Act_Melee_Use_TargetListModified_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
\n\
	--   \n\
	if action:GetScriptParam(\"WEAPON_HIDE\") == \"TRUE\" then\n\
		actor:HideParts(6,true); -- 6 \n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end    \n\
end\n\
function Act_Melee_Use_TargetListModified_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Act_Melee_Use_TargetListModified_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
\n\
function    Act_Melee_Use_TargetListModified_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Act_Melee_Use_TargetListModified_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then	\n\
			\n\
			--    \n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Act_Melee_Use_TargetListModified_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    local   kCurAction = actor:GetAction();\n\
    \n\
	ODS(\"RestoreItemModel Act_Melee_Use_TargetListModified_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	--    \n\
	if kCurAction:GetScriptParam(\"WEAPON_HIDE\") == \"TRUE\" then\n\
		actor:HideParts(6,false); -- 6 \n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
	\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)	\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
				--Act_Melee_Use_TargetListModified_HitOneTime(actor,action);				\n\
            else\n\
                Act_Melee_Use_TargetListModified_HitOneTime(actor,action);\n\
            end        \n\
        end\n\
    end\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);	\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
		\n\
	if iHitCount == iTotalHit-1 then\n\
	\n\
		local iTargetCount = action:GetTargetCount();\n\
		local i =0;\n\
		if iTargetCount>0 then\n\
			\n\
			local bWeaponSoundPlayed = false;\n\
			\n\
			while i<iTargetCount do\n\
			\n\
				local actionResult = action:GetTargetActionResult(i);\n\
				if actionResult:IsNil() == false then\n\
				\n\
					action:SetParamInt(3,actionResult:GetValue()/(iTotalHit));\n\
					local	iOneDmg = action:GetParamInt(3);\n\
				\n\
					actionResult:SetValue(\n\
						actionResult:GetValue() - iOneDmg*(iTotalHit-1));\n\
						\n\
					local kTargetGUID = action:GetTargetGUID(i);\n\
					local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
						\n\
						local actorTarget = kTargetPilot:GetActor();\n\
						\n\
	                    if bWeaponSoundPlayed == false then\n\
	                        bWeaponSoundPlayed = true;\n\
                            --   \n\
                            local actionName = action:GetID()\n\
							if actionResult:GetCritical() then\n\
								actionName = \"Critical_dmg\"\n\
") + std::string("							end\n\
							actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                        end\n\
\n\
						Act_Melee_Use_TargetListModified_DoDamage(actor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
\n\
						local iHoldingTime = g_fAttackHitHoldingTime * 1000;\n\
						local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
						\n\
						--   \n\
						if bNoHold == false then\n\
							actor:SetAnimSpeedInPeriod(0.00001,iHoldingTime);\n\
						end\n\
						\n\
						actor:SetShakeInPeriod(5,iShakeTime/2);\n\
						actorTarget:SetShakeInPeriod(5,iShakeTime);\n\
					end\n\
					\n\
				end\n\
				\n\
				i=i+1;\n\
			\n\
			end\n\
		end\n\
\n\
		action:GetTargetList():ApplyActionEffects();\n\
		actor:ClearIgnoreEffectList();\n\
	\n\
	else\n\
		local kRandomPos = action:GetScriptParam(\"MULTI_HIT_RANDOM_OFFSET\");\n\
\n\
		if kRandomPos == nil then\n\
			kRandomPos = 0;\n\
		end\n\
\n\
		action:GetTargetList():ApplyOnlyDamage(iTotalHit,true, kRandomPos);\n\
		\n\
		local iTargetCount = action:GetTargetCount();\n\
		local i =0;\n\
		if iTargetCount>0 then\n\
			\n\
			local bWeaponSoundPlayed = false;\n\
			while i<iTargetCount do\n\
			\n\
				local actionResult = action:GetTargetActionResult(i);\n\
				if actionResult:IsNil() == false then\n\
				\n\
					local kTargetGUID = action:GetTargetGUID(i);\n\
					local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
						\n\
						local actorTarget = kTargetPilot:GetActor();\n\
						\n\
	                    if bWeaponSoundPlayed == false then\n\
	                        bWeaponSoundPlayed = true;\n\
                            --   \n\
                            local actionName = action:GetID()\n\
							if actionResult:GetCritical() then\n\
								actionName = \"Critical_dmg\"\n\
							end\n\
							actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                        end							\n\
						\n\
						Act_Melee_Use_TargetListModified_DoDamage(actor,actorTarget,actionResult,action:GetTargetInfo(i));\n\
					end\n\
				end\n\
				\n\
				i=i+1;\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
		\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
\n\
function Act_Melee_Use_TargetListModified_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
	    kAction:SetParam(2,\"HIT\");\n\
	\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(106,kSoundID);\n\
		end	\n\
\n\
	    if actor:IsMyActor() then\n\
    	    kAction:CreateActionTargetList(actor);   --   \n\
	    \n\
	        if IsSingleMode() then\n\
	            Act_Melee_Use_TargetListModified_OnTargetListModified(actor,kAction,false)\n\
	        else\n\
	            kAction:BroadCastTargetListModify(actor:GetPilot());\n\
	        end	    \n\
	    end\n\
			\n\
		Act_Melee_Use_TargetListModified_HitOneTime(actor,kAction);\n\
	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [DEATH_BOUND] : \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function EarthQuake_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function EarthQuake_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	EarthQuake_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
	kTargetPos:Add(kMovingDir);\n\
\n\
	if action:GetScriptParam(\"DEATH_BOUND\") ~= \"TRUE\" then\n\
		actor:AttachParticleToPointWithRotate(8,kTargetPos,\"ef_Earthquake_02_char_root\", actor:GetRotateQuaternion())\n\
	else		\n\
		actor:AttachParticle(7215, \"p_ef_heart\", \"ef_Deathbound_01_p_ef_heart\");	\n\
	end\n\
end\n\
function EarthQuake_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
	end\n\
\n\
	if action:GetScriptParam(\"DEATH_BOUND\") ~= \"TRUE\" then\n\
		local   kFireEffectID = \"ef_Earthquake_01_p_wp_r_hand01\";\n\
		local   kFireEffectTargetNodeID = \"p_wp_r_hand\";\n\
\n\
		actor:AttachSound(105,\"LandAnger_Start\");\n\
    \n\
		if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
	    \n\
			if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
	            \n\
				local   kDir = actor:GetLookingDir();\n\
				local   fDistance = 30;\n\
				kDir:Multiply(fDistance);\n\
				kDir:Add(actor:GetPos());\n\
				kDir:SetZ(kDir:GetZ()-28);\n\
	            \n\
				actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
	            \n\
			else\n\
				actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
			end\n\
		end	\n\
	else\n\
		actor:AttachSound(105,\"DeathBound_Start\");\n\
	end\n\
\n\
end\n\
\n\
function EarthQuake_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	return	EarthQuake_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function EarthQuake_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	kMovingDir = actor:GetLookingDir();\n\
\n\
	if action:GetScriptParam(\"DEATH_BOUND\") ~= \"TRUE\" then\n\
		kMovingDir:Multiply(iAttackRange);\n\
	end\n\
\n\
	local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
	kTargetPos:Add(kMovingDir);\n\
	\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = iAttackRange\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);\n\
	\n\
	return	action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function EarthQuake_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	EarthQuake_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function EarthQuake_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function EarthQuake_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if action:GetParam(1) ~= \"end\" then\n\
		actor:DetachFrom(7215,true);	\n\
		actor:DetachFrom(7212,true);\n\
	end\n\
\n\
	actor:DetachFrom(8);\n\
	actor:DetachFrom(7212);	\n\
\n\
	return true;\n\
end\n\
\n\
function EarthQuake_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
\n\
function EarthQuake_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
        end        \n\
    \n\
    end\n\
    \n\
    \n\
end\n\
\n\
function EarthQuake_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end	\n\
	\n\
	if textKey == \"hit\" then\n\
		\n\
	    kAction:SetParam(2,\"HIT\");\n\
	\n\
		if kAction:GetScriptParam(\"DEATH_BOUND\") == \"TRUE\" then\n\
--			local	fDistance = kAction:GetSkillRange(0,actor);\n\
			local	kMovingDir = actor:GetLookingDir();\n\
			local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
			kTargetPos:Add(kMovingDir);\n\
			actor:AttachParticleToPointWithRotate(7214,kTargetPos,\"ef_Deathbound_01_char_root\", actor:GetRotateQuaternion());\n\
			actor:AttachSound(106,\"DeathBound\");\n\
		else\n\
			actor:AttachSound(106,\"LandAnger\");\n\
		end\n\
\n\
	    if actor:IsMyActor() then\n\
    	    kAction:CreateActionTargetList(actor);   --   \n\
	    \n\
	        if IsSingleMode() then\n\
	            EarthQuake_OnTargetListModified(actor,kAction,false)\n\
	        else\n\
	            kAction:BroadCastTargetListModify(actor:GetPilot());\n\
	        end\n\
	    \n\
	    end\n\
				\n\
		if actor:IsMyActor() then\n\
			if kAction:GetScriptParam(\"DEATH_BOUND\") ~= \"TRUE\" then\n\
				QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
				, g_fMeleeDropQuakeValue[2]\n\
				, g_fMeleeDropQuakeValue[3]\n\
				, g_fMeleeDropQuakeValue[4]\n\
				, g_fMeleeDropQuakeValue[5])\n\
			else\n\
				QuakeCamera(0.5, 1.5, 1, 1, 1)\n\
			end\n\
		end		\n\
		\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
function Skill_Sliding_Tackle_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_Sliding_Tackle_OnEnter\\n\");\n\
    \n\
    --	  \n\
    action:SetParamAsPoint(0,actor:GetPos());\n\
    \n\
    if actor:IsMyActor() then\n\
    \n\
		action:StartTimer(10.0,0.1,0);\n\
    \n\
    end\n\
    \n\
	actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,0,0);\n\
    \n\
    action:SetParamInt(3,0) -- State\n\
	return	true;\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnTimer(actor,fAccumTime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsUnderMyControl() then\n\
		ODS(\"Skill_Sliding_Tackle_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
		\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());        \n\
	end\n\
			\n\
	return	true;\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	ODS(\"Skill_Sliding_Tackle_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 30\n\
	end\n\
	\n\
	local	kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	\n\
	local iFound=action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
\n\
	kTargets:DeleteInActionGUIDCont(action);\n\
	kTargets:AddToActionGUIDCont(action);\n\
	\n\
	return	iFound;\n\
	\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	local iState = action:GetParamInt(3)\n\
	\n\
	if iState == 0 then\n\
	\n\
\n\
		local	kStartPos = action:GetParamAsPoint(0)\n\
		local	kCurrentPos = actor:GetPos()\n\
		local	fDistance = kCurrentPos:Distance(kStartPos)\n\
		local	fMaxDistance = action:GetSkillRange(0,actor);\n\
		if fMaxDistance == 0 then\n\
			fMaxDistance = 2000\n\
		end\n\
		\n\
		if fDistance>fMaxDistance then\n\
			action:DeleteTimer(0);\n\
			action:SetParamInt(3,1);\n\
			actor:PlayNext();\n\
			return	true;\n\
		end\n\
		\n\
		local fAccel = -800 * frameTime;\n\
		local fVelocity = action:GetParamFloat(1);\n\
		\n\
		if fVelocity>0 then\n\
		\n\
			local kMovingDir = actor:GetLookingDir()\n\
			kMovingDir:Multiply(fVelocity);\n\
			\n\
			actor:SetMovingDelta(kMovingDir);\n\
			\n\
			fVelocity = fVelocity+fAccel;\n\
			action:SetParamFloat(1,fVelocity);\n\
			\n\
		else \n\
			\n\
			action:DeleteTimer(0);\n\
			action:SetParamInt(3,1);\n\
			actor:PlayNext();\n\
			return	true;\n\
		\n\
		end\n\
		\n\
	elseif iState == 1 then\n\
	\n\
		if actor:IsAnimationDone() then\n\
		\n\
			action:SetParam(2,\"end\");\n\
			return	false;\n\
		\n\
		end\n\
\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:EndBodyTrail();\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return	true;\n\
	end\n\
\n\
	if kCurAction:GetParam(2) == \"end\" then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
\n\
	return	false;\n\
end\n\
\n\
function Skill_Sliding_Tackle_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    \n\
    end\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [ACTOR_CLASS_NO] :    \n\
-- Melee\n\
function Skill_Iceberg_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Iceberg_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Iceberg_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Iceberg_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Iceberg_Fire\\n\");\n\
    action:SetParamInt(2,0) --  State\n\
	\n\
end\n\
function Skill_Iceberg_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
    local   kTargetPos = actor:GetPos();\n\
    local   kLookDir = actor:GetLookingDir();\n\
    kLookDir:Multiply(iAttackRange);\n\
    kTargetPos:Add(kLookDir);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    kTargetPos = g_world:FindActorFloorPos(kTargetPos);\n\
\n\
	local kParam = FindTargetParam();\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(kTargetPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,47,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Iceberg_CreateSkillActor(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_Iceberg_CreateSkillActor\\n\");\n\
    \n\
    --   \n\
    local   iAttackRange = action:GetSkillRange(0,actor);\n\
    if iAttackRange == 0 then   \n\
        iAttackRange = 100\n\
    end\n\
    \n\
    local   kTargetPos = actor:GetPos();\n\
    local   kLookDir = actor:GetLookingDir();\n\
    kLookDir:Multiply(iAttackRange);\n\
    kTargetPos:Add(kLookDir);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    kTargetPos = g_world:FindActorFloorPos(kTargetPos);\n\
    \n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	action:AddNewGUID(guid);\n\
	\n\
	local   iClassNo = tonumber(action:GetScriptParam(\"ACTOR_CLASS_NO\"));\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, iClassNo, 0)\n\
	if pilot:IsNil() == false then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 6)\n\
		local kAction = pilot:GetActor():ReserveTransitAction(\"a_Iceberg_Play\")\n\
		kAction:AddNewGUID(actor:GetPilotGuid());\n\
	end	 \n\
	\n\
end\n\
\n\
function Skill_Iceberg_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Iceberg_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Iceberg_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
function Skill_Iceberg_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
    if bIsBefore == false then\n\
    \n\
        local   kIceBerg = Skill_Iceberg_GetSkillActor(actor,action)\n\
        if kIceBerg == nil then\n\
            actor:PlayNext();        \n\
            action:SetParamInt(2,2);\n\
            return false;\n\
        end\n\
        \n\
        --    .\n\
        local   kIceBergAction = kIceBerg:GetAction()    \n\
        if kIceBergAction:IsNil() == false then\n\
        \n\
        \n\
            kIceBergAction:SetTargetList(action:GetTargetList());\n\
            action:ClearTargetList();\n\
            \n\
            kIceBergAction:SetParam(2,\"CRASH\");\n\
        \n\
        end\n\
        \n\
        --    \n\
        actor:PlayNext();\n\
        action:SetParamInt(2,2);\n\
        \n\
    end    \n\
\n\
end\n\
\n\
function Skill_Iceberg_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
    local   iState = action:GetParamInt(2);\n\
    \n\
    ODS(\"Skill_Iceberg_OnUpdate iState : \"..iState..\"\\n\");\n\
\n\
	\n\
	if animDone == true then\n\
	\n\
	    if iState == 0 then\n\
	    \n\
	        --  IceBerg \n\
	        Skill_Iceberg_CreateSkillActor(actor,action)\n\
	        action:SetParamInt(2,1);\n\
	        \n\
	    elseif iState == 1 then\n\
	    \n\
	        if actor:IsMyActor() then\n\
	            --   ,    .\n\
	            local   kIceBerg = Skill_Iceberg_GetSkillActor(actor,action)\n\
	            if kIceBerg == nil then\n\
	                return true;\n\
                end\n\
                \n\
                \n\
                local   kIceBergAction = kIceBerg:GetAction()\n\
                if kIceBergAction:IsNil() == false and kIceBergAction:GetParam(2) == \"CREATED\" then\n\
                \n\
                    action:CreateActionTargetList(actor);\n\
                    \n\
                    if IsSingleMode() or action:GetTargetCount() == 0 then\n\
                        Skill_Iceberg_OnTargetListModified(actor,action,false)            \n\
                    else    \n\
                    \n\
                        action:BroadCastTargetListModify(actor:GetPilot());\n\
                        action:ClearTargetList();\n\
                    end\n\
                \n\
                end\n\
	            \n\
	        \n\
	        end\n\
	        \n\
	    elseif iState == 2 then\n\
	        \n\
	        action:SetParam(1,\"end\");\n\
	        return false;\n\
	    \n\
	    end\n\
\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Iceberg_GetSkillActor(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_Iceberg_GetSkillActor [\"..action:GetTotalGUIDInContainer()..\"]\\n\");\n\
    if action:GetTotalGUIDInContainer() > 0 then\n\
    \n\
        local   kGUID = action:GetGUIDInContainer(0);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        local   kActor = g_world:FindActor(kGUID);\n\
        if kActor:IsNil() == false then\n\
            ODS(\"Skill_Iceberg_GetSkillActor kActor:IsNil() Passed\\n\");\n\
        \n\
            return  kActor;\n\
        \n\
        end\n\
    end\n\
    \n\
    return  nil;\n\
\n\
end\n\
\n\
function Skill_Iceberg_OnCleanUp(actor)\n\
    	\n\
    --   IceBerg   .\n\
  \n\
	return true;\n\
end\n\
\n\
function Skill_Iceberg_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
    ") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Iceberg_Play_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	\n\
	action:SetParam(2,\"CREATING\");\n\
	return true\n\
end\n\
\n\
function Skill_Iceberg_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   bAnimDone = actor:IsAnimationDone()\n\
    \n\
    ODS(\"Skill_Iceberg_Play_OnUpdate \"..action:GetParam(2)..\"\\n\");\n\
    \n\
    \n\
    if action:GetParam(2) == \"CREATING\" then\n\
    \n\
        if bAnimDone then\n\
            action:SetParam(2,\"CREATED\");\n\
            actor:PlayNext();\n\
        end\n\
    \n\
    end\n\
    \n\
    if action:GetParam(2) == \"CRASH\" then\n\
    \n\
        actor:PlayNext();\n\
        action:SetParam(2,\"CRASHING\");\n\
    \n\
    end\n\
    \n\
    if action:GetParam(2) == \"CRASHING\" then\n\
    \n\
        if bAnimDone then\n\
            return false;    \n\
        end\n\
    \n\
    end\n\
    \n\
	return true\n\
end\n\
\n\
function Skill_Iceberg_Play_GetParentActor(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kAction = actor:GetAction();\n\
    if kAction:GetTotalGUIDInContainer() > 0 then\n\
    \n\
        local   kGUID = kAction:GetGUIDInContainer(0);\n\
        local   kPilot = g_pilotMan:FindPilot(kGUID);\n\
        if kPilot:IsNil() == false then\n\
        \n\
            local   kActor = kPilot:GetActor();\n\
            if kActor:IsNil() == false then\n\
            \n\
                return  kActor;\n\
            \n\
            end\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
    return  nil;\n\
\n\
end\n\
\n\
function Skill_Iceberg_Play_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_Iceberg_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Iceberg_Play_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    ODS(\"Skill_Iceberg_Play_OnEvent textKey:\"..textKey..\"\\n\");\n\
    \n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
    \n\
        local   kParentActor = Skill_Iceberg_Play_GetParentActor(actor,actor:GetAction());\n\
        \n\
        if kParentActor:IsNil() == false then\n\
            --   \n\
           SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        end        \n\
        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Iceberg_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_DashDownBlow_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_DashDownBlow_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	if actor:GetFloatHeight(70)<70 then\n\
		return	false;	\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Skill_DashDownBlow_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	action:SetParamFloat(2,500);	-- Drop Speed!\n\
	actor:StartWeaponTrail();\n\
\n\
	local iBaseClassID = actor:GetPilot():GetBaseClassID();\n\
	if iBaseClassID == CT_FIGHTER then\n\
		actor:AttachParticle(13, \"char_root\", \"ef_jump_dash_attk_02_char_root\");\n\
	end\n\
	\n\
	return true\n\
end\n\
function Skill_DashDownBlow_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 70\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetPos(),Point3(0,0,-1));\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_DashDownBlow_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	slotNum = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(0)\n\
\n\
	if iState == 0 then\n\
		\n\
		local	kLookingDir = actor:GetLookingDir();\n\
		local	kRotateAxis = actor:GetLookingDir();\n\
		kRotateAxis:Cross(Point3(0,0,1));\n\
		kRotateAxis:Unitize();\n\
		local	fRotateAngle = -40.0*3.141592/180.0;\n\
		\n\
		local	fVel = action:GetParamFloat(2)\n\
		local	kMovingDelta = kLookingDir:_Multiply(fVel);\n\
		kMovingDelta:Rotate(kRotateAxis,fRotateAngle);\n\
		\n\
		ODS(\"fVel : \"..fVel..\" kLookingDir:\"..kLookingDir:GetX()..\",\"..kLookingDir:GetY()..\",\"..kLookingDir:GetZ()..\"\\n\");\n\
		\n\
		actor:SetMovingDelta(kMovingDelta)\n\
\n\
		action:SetParamFloat(2, fVel+fVel*0.5*frameTime)\n\
		\n\
		if actor:IsMeetFloor() == true then\n\
			Skill_DashDownBlow_OnMeetFloor(actor,action,accumTime);\n\
		end\n\
\n\
	elseif iState == 1 then	\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(5)\n\
		if fElapsedTime>0.05 then\n\
		\n\
			actor:PlayNext();\n\
			action:SetParamInt(0,2)\n\
			return	true;\n\
		\n\
		end\n\
	\n\
	elseif iState == 2 then\n\
		if animDone == true then\n\
		\n\
			if slotNum == 1 then\n\
				local	curActionParam = action:GetParam(3)	\n\
				if curActionParam == \"GoNext\" then\n\
					nextActionName = action:GetParam(1);\n\
\n\
					action:SetParam(3, \"null\")\n\
					action:SetParam(1, \"end\")\n\
					if nextActionName~=\"\" then\n\
						action:SetNextActionName(nextActionName)\n\
					end\n\
					\n\
					return false;\n\
				else\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			end\n\
		\n\
		end\n\
	\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Skill_DashDownBlow_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
	actor:EndWeaponTrail();\n\
\n\
	return true;\n\
end\n\
function Skill_DashDownBlow_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_DashDownBlow_OnLeave actionID:\"..actionID..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end	\n\
\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(1,\"\");\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
		\n\
		if actionID == \"a_run\" or \n\
			string.sub(actionID,1,7) == \"a_melee\" or \n\
			string.sub(actionID,1,11) == \"a_thi_melee\" then\n\
	\n\
			curAction:SetParam(3,\"GoNext\");\n\
			curAction:SetParam(1,actionID);	\n\
			\n\
		elseif actionID == \"a_telejump\" then\n\
			actor:DetachFrom(32)\n\
			return true\n\
		end\n\
	\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_DashDownBlow_DoDamage(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	iTargetCount = action:GetTargetCount();\n\
	action:SetSlot(1);	\n\
	\n\
	if 	iTargetCount == 0 then\n\
		return true;\n\
	end\n\
\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	actor:ClearIgnoreEffectList();\n\
end\n\
\n\
function Skill_DashDownBlow_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
        if action:GetParam(6) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
\n\
            Skill_DashDownBlow_DoDamage(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_DashDownBlow_OnMeetFloor(actor,action,accumTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(6,\"HIT\");\n\
	action:SetParamInt(0,1);	--	 Stop Drop!\n\
	actor:FindPathNormal();\n\
	action:SetParamFloat(5,accumTime);		\n\
\n\
	actor:FreeMove(false);\n\
	\n\
	if actor:IsMyActor() then\n\
		QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
		, g_fMeleeDropQuakeValue[2]\n\
		, g_fMeleeDropQuakeValue[3]\n\
		, g_fMeleeDropQuakeValue[4]\n\
		, g_fMeleeDropQuakeValue[5])\n\
	end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	\n\
	if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
		\n\
		kPos = actor:GetLookingDir();\n\
		local	fDistance = 50;\n\
		kPos:Multiply(fDistance);\n\
		kPos:Add(actor:GetPos());\n\
		\n\
	end\n\
\n\
	actor:AttachParticleToPoint(12, kPos, \"ef_thi_jump_down_attk\")\n\
	\n\
	if actor:IsUnderMyControl() then\n\
	\n\
		action:CreateActionTargetList(actor);\n\
		if IsSingleMode() then\n\
			Act_Melee_OnTargetListModified(actor,action,false)\n\
		else\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
		end			\n\
	\n\
	end\n\
	\n\
	\n\
	Skill_DashDownBlow_DoDamage(actor,action);\n\
	\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_FloatDownBlow_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_FloatDownBlow_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	ODS(\"Skill_FloatDownBlow_OnCheckCanEnter\\n\");\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	if actor:GetFloatHeight(30)<40 then\n\
		ODS(\"Skill_FloatDownBlow_OnCheckCanEnter actor:GetFloatHeight(30):\"..actor:GetFloatHeight(30)..\"\\n\");\n\
		return	false;	\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_FloatDownBlow_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	ODS(\"Skill_FloatDownBlow_OnEnter action : ..\"..action:GetID()..\"\\n\");\n\
\n\
	if actor:IsMyActor() == true then\n\
		action:SetParam(4, \"\");\n\
		action:SetParam(0,\"\");\n\
	end\n\
	\n\
	actor:FreeMove(true);	\n\
	actor:StopJump();\n\
	\n\
	actor:ChangeItemModel(ITEM_WEAPON, \"Item/Common/12_Weapon/09_special/bonghammer.xml\");	\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_FloatDownBlow_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
--	local	kDir = actor:GetLookingDir();\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
	\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
	\n\
	local iTargetCount = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"Skill_FloatDownBlow_OnFindTarget iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	return	iTargetCount;\n\
	\n\
end\n\
\n\
function Skill_FloatDownBlow_Finished(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	actor:SetNormalAttackEndTime();\n\
			\n\
	local curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = action:GetParam(1);\n\
		action:SetNextActionName(nextActionName)\n\
	end\n\
\n\
	actor:FreeMove(false);\n\
	\n\
	action:SetParam(0, \"null\")\n\
	action:SetParam(1, \"end\")\n\
\n\
	actor:RestoreItemModel(ITEM_WEAPON);\n\
\n\
	return false\n\
end\n\
\n\
function Skill_FloatDownBlow_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
		return Skill_FloatDownBlow_Finished(actor,action);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_FloatDownBlow_OnCleanUp(actor, action)\n\
	actor:FreeMove(false);\n\
	actor:EndWeaponTrail();\n\
\n\
	if action:GetID() == \"a_jump\" then\n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
	end\n\
	\n\
	actor:RestoreItemModel(ITEM_WEAPON);\n\
	\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_FloatDownBlow_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		actor:SetComboCount(0);	\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
		local	bCorrect = false;\n\
		\n\
		if 	actionID == \"a_run\" then\n\
			\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_FloatDownBlow_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return\n\
		end\n\
\n\
        if action:GetParam(2) == \"ATTACKED\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_FloatDownBlow_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
\n\
	if  textKey == \"hit\" and kAction:GetParamInt(20) == 0 then\n\
\n\
		if actor:GetPilot():GetBaseClassID() == CT_FIGHTER then\n\
			\n\
			actor:AttachParticle(31,\"char_root\",\"ef_fig_jump_attk_01_char_root\");\n\
		\n\
		end\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			kAction:CreateActionTargetList(actor);\n\
			if IsSingleMode() then\n\
				Skill_FloatDownBlow_OnTargetListModified(actor,kAction,false)\n\
			else\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end			\n\
		end\n\
	\n\
	\n\
		kAction:SetParam(2,\"ATTACKED\");		\n\
		\n\
		kAction:SetParamInt(20,1);	--	hit   !! ,    .\n\
			\n\
	end\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
function Skill_FloatDownShot_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_FloatDownShot_OnCheckCanEnter(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	if weapontype == 0 then\n\
		return false\n\
	end\n\
	\n\
	if actor:IsMeetFloor()  then\n\
	    return  false\n\
    end\n\
\n\
	if actor:GetPilot():IsCorrectClass(CT_RANGER) then\n\
		local	iShotCount = tonumber(actor:GetParam(\"RANGER_FLOATDOWNSHOT_COUNT\"));\n\
		if iShotCount==nil then\n\
			iShotCount = 0\n\
		end\n\
\n\
		local iMaxShotCount = 1;\n\
\n\
		local kSkillDef = GetSkillDef(action:GetActionNo());\n\
		if kSkillDef:IsNil() == false then\n\
			local iMaxCount = kSkillDef:GetAbil(AT_COUNT);\n\
			if iMaxCount > 0 then\n\
				iMaxShotCount = iMaxCount;\n\
			end\n\
		end\n\
\n\
		if iShotCount >= iMaxShotCount then\n\
			return false;\n\
		end	\n\
	end\n\
\n\
	return true\n\
	\n\
end\n\
function Skill_FloatDownShot_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_FloatDownShot_OnEnter\\n\");\n\
\n\
	if actor:IsMyActor() == true then\n\
		if actor:GetFloatHeight(40)<50 then\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		local	iShotCount = tonumber(actor:GetParam(\"RANGER_FLOATDOWNSHOT_COUNT\"));\n\
		if iShotCount==nil then\n\
			iShotCount = 0\n\
		end\n\
		\n\
		ODS(\"Skill_FloatDownShot_OnEnter iShotCount:\"..iShotCount..\"\\n\");\n\
		\n\
		actor:SetParam(\"RANGER_FLOATDOWNSHOT_COUNT\",\"\"..(iShotCount+1))\n\
		\n\
	end\n\
\n\
	\n\
	actor:ResetAnimation();\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	return true\n\
end\n\
\n\
\n\
function Skill_FloatDownShot_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	kAttackNodeName = \"p_ef_heart\";\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_FloatDownShot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
\n\
	if animDone == true or actor:IsMeetFloor() then\n\
	\n\
--		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(1, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_FloatDownShot_OnCleanUp(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	actor:FreeMove(false);\n\
	\n\
	return true;\n\
end\n\
function Skill_FloatDownShot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_FloatDownShot_OnLeave actionID:\"..actionID..\"\\n\");\n\
	\n\
	if actor:IsMyActor() == false then\n\
	\n\
		if actionID == \"a_jump\" then\n\
			action:SetSlot(2)\n\
		end\n\
	\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		return true;\n\
	end	\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		return  true;\n\
	end\n\
\n\
	if action:GetEnable() == false then\n\
		\n\
		if curAction:GetParam(1)==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		if actionID == \"a_archer_shot_01\" then\n\
		    return  false\n\
        end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_FloatDownShot_OnEvent(actor, textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		local	action = actor:GetAction()\n\
		\n\
		if( CheckNil(nil==action) ) then return end\n\
		if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
		local	iAttackRange = action:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200\n\
		end\n\
		\n\
		ODS(\"Skill_FloatDownShot_OnEvent iAttackRange : \"..iAttackRange..\"\\n\");\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		\n\
--		local	iTargetCount = action:GetTargetCount();\n\
--		local	iTargetABVShapeIndex = 0;\n\
\n\
		--  \n\
		local	kRotateAxis = actor:GetLookingDir();\n\
		kRotateAxis:Cross(Point3(0,0,1));\n\
		kRotateAxis:Unitize();\n\
		fRotateAngle = -40*3.141592/180.0;			\n\
		\n\
		local	kArrow = Skill_FloatDownShot_LoadToWeapon(actor,action);\n\
		if(nil == kArrow ) then return end\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir();\n\
		kFireTarget:Multiply(iAttackRange);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle);\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
function Skill_SideDashAttack_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_SideDashAttack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsMyActor() then\n\
		action:StartTimer(10.0,0.1,0);\n\
    end\n\
    \n\
	action:SetParamFloat(1, g_fDashSpeed);	-- Start Velocity\n\
	return	true;\n\
end\n\
\n\
function Skill_SideDashAttack_OnTimer(actor,fAccumTime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsUnderMyControl() then\n\
		ODS(\"Skill_SideDashAttack_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
		\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
	\n\
		\n\
	return	true;\n\
end\n\
\n\
\n\
function Skill_SideDashAttack_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	ODS(\"Skill_Sliding_Tackle_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 30\n\
	end\n\
	\n\
	local	kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	\n\
	local iFound=action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
\n\
	kTargets:DeleteInActionGUIDCont(action);\n\
	kTargets:AddToActionGUIDCont(action);\n\
	\n\
	return	iFound;\n\
	\n\
end\n\
\n\
function Skill_SideDashAttack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
    --ODS(\"Skill_SideDashAttack_OnUpdate\\n\");\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	\n\
	if action:GetParam(2) == \"\" and \n\
		action:GetNextActionName() == \"a_dash_attack\" then\n\
		\n\
	    action:SetNextActionName(\"a_idle\");\n\
	    \n\
	end\n\
	\n\
	if action:GetParam(2) == \"ToDashAttack!\" then\n\
	    action:SetParam(2,\"\");\n\
		return false\n\
	end		\n\
	\n\
	if action:GetParam(3) == \"EndNow\" then\n\
		action:DeleteTimer(0);\n\
		return false\n\
	end\n\
			\n\
	actor:FindPathNormal()		\n\
	\n\
	local fAccel = -2000 * frameTime;\n\
	local fVelocity = action:GetParamFloat(1);\n\
	\n\
	ODS(\"__________Dash Attack Velocity \" .. fVelocity .. \" fAccel:\"..fAccel..\"\\n\")\n\
\n\
	if fVelocity>0 then\n\
	\n\
		local dir = action:GetDirection()\n\
		actor:Walk(dir, fVelocity)\n\
\n\
		\n\
		fVelocity = fVelocity+fAccel;\n\
		action:SetParamFloat(1,fVelocity);\n\
		\n\
	else \n\
		\n\
		action:DeleteTimer(0);\n\
		action:SetParam(2,\"end\");\n\
		return	false;\n\
		\n\
	end\n\
	\n\
\n\
	\n\
	return	true;\n\
end\n\
function Skill_SideDashAttack_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:EndBodyTrail();\n\
	actor:EndWeaponTrail();\n\
	return	true;\n\
end\n\
\n\
function Skill_SideDashAttack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	Act_Dash_OnLeave(actor,action);\n\
	\n\
end\n\
\n\
function Skill_SideDashAttack_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    \n\
    end\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
-- [PIERCING] : \n\
-- [WEAPON_XML] :        XML .\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [FIRE_CASTER_EFFECT_ID] : HIT     ID\n\
-- [WEAPON_HIDE] :    \n\
\n\
-- Melee\n\
function Skill_HommingMissile_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_HommingMissile_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	Skill_HommingMissile_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Skill_HommingMissile_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Skill_HommingMissile_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:CreateActionTargetList(actor,true);\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
\n\
	--   \n\
	if action:GetScriptParam(\"WEAPON_HIDE\") == \"TRUE\" then\n\
		actor:HideParts(6,true); -- 6 \n\
	end\n\
\n\
	local	iTargetCount = 0;\n\
\n\
	iTargetCount = action:GetTargetCount();\n\
	ODS(\"Skill_HommingMissile_Fire iTargetCount : \"..iTargetCount..\"\\n\");	\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(0);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
	\n\
end\n\
function Skill_HommingMissile_OnFindTarget(actor,action,kTargets)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	local kParam = FindTargetParam();\n\
	--  \n\
	local	kRotateAxis = actor:GetLookingDir();\n\
	kRotateAxis:Cross(Point3(0,0,1));\n\
	kRotateAxis:Unitize();\n\
	local	fRotateAngle = 60.0 * math.pi / 180.0;\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
	\n\
    --     .\n\
    kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);	\n\
	local	kFireTargetDir = actor:GetLookingDir();\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle);\n\
	kParam:SetParam_1(kPos,kFireTargetDir);\n\
\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	return	kTargets:size();\n\
	\n\
end\n\
\n\
function Skill_HommingMissile_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Skill_HommingMissile_OnCastingCompleted(actor,action);\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_HommingMissile_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
			\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_HommingMissile_OnCleanUp(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local   kCurAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kCurAction) ) then return false end\n\
	if( CheckNil(kCurAction:IsNil()) ) then return false end\n\
	\n\
\n\
	actor:DetachFrom(7212,true);\n\
\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	--    \n\
	if kCurAction:GetScriptParam(\"WEAPON_HIDE\") == \"TRUE\" then\n\
		actor:HideParts(6,false); -- 6 \n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_HommingMissile_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
    return false \n\
end\n\
\n\
function Skill_HommingMissile_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Skill_HommingMissile_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
	    local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7213,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	    		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_HommingMissile_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			local	iTargetCount = kAction:GetTargetCount();\n\
			local	iTargetABVShapeIndex = 0;\n\
			local	kActionTargetInfo = nil\n\
			\n\
			local pt = nil;\n\
			\n\
			if iTargetCount>0 then\n\
					--	  \n\
				local	kTargetGUID = kAction:GetTargetGUID(0);\n\
				iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
				kActionTargetInfo = kAction:GetTargetInfo(0);\n\
				targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
				if targetobject:IsNil() == false then\n\
					pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
					actor:LookAt(pt);\n\
				end						\n\
			end\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			local	kRotateAxis = actor:GetLookingDir();\n\
			kRotateAxis:Cross(Point3(0,0,1));\n\
			kRotateAxis:Unitize();\n\
			local	fRotateAngle = 30.0*3.141592/180.0;\n\
			local	kFireTargetDir = actor:GetLookingDir();\n\
			kFireTargetDir:Rotate(kRotateAxis,fRotateAngle);\n\
			kArrow:SetVelocity(kFireTargetDir);\n\
			kArrow:SetMovingType(3)	\n\
			kArrow:SetParam(500,2000,0);\n\
	    \n\
			if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
				\n\
				kFireTargetDir:Multiply(iAttackRange-45);\n\
				kFireTargetDir:Add(arrow_worldpos);\n\
				kFireTargetDir:SetZ(kFireTargetDir:GetZ())\n\
				kArrow:SetTargetLoc(kFireTargetDir);		\n\
				\n\
			else\n\
				kArrow:SetTargetObjectList(kAction:GetTargetList());	\n\
				\n\
			    if pt~= nil then\n\
			\n\
				local	fVariationAmount = 10.0\n\
				\n\
				pt:Add(Point3(math.random(-fVariationAmount,fVariationAmount),\n\
								math.random(-fVariationAmount,fVariationAmount),\n\
								math.random(-fVariationAmount,fVariationAmount)));\n\
				kArrow:SetTargetLoc(pt);\n\
				end		\n\
			end\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_Roulette_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_Roulette_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Roulette_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	\n\
end\n\
function Skill_Roulette_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"RestoreItemModel Skill_Roulette_Fire\\n\");\n\
\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		--ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end   \n\
			\n\
	actor:StartWeaponTrail();	\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    action:SetParamFloat(4,g_world:GetAccumTime());\n\
	\n\
end\n\
function Skill_Roulette_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_Roulette_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_Roulette_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Roulette_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
		actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
    end	\n\
	\n\
	--ODS(\"Skill_Roulette_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	action:SetParamInt(2,0);\n\
	action:SetParamFloat(4,-1);\n\
		\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Roulette_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Roulette_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Roulette_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    actor:DetachFrom(2889);\n\
\n\
	--ODS(\"RestoreItemModel Skill_Roulette_ReallyLeave\\n\");\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Skill_Roulette_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Roulette_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	    end	\n\
    	    \n\
	    --   \n\
	    local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	    actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	    actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	    actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	\n\
	end\n\
	\n\
    --   \n\
	local actionName = kActionID\n\
	if kActionResult:GetCritical() then\n\
		actionName = \"Critical_dmg\"\n\
	end\n\
	actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, kActionTargetInfo);\n\
end\n\
\n\
function Skill_Roulette_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	        actor:AttachParticle(7213,kHitEffectTargetNodeID,kHitEffectID);\n\
	    end\n\
	end\n\
\n\
	local iDiceValue = -1;\n\
	local iTargetCount = action:GetTargetCount();\n\
	if iTargetCount>0 then\n\
		local actionResult = action:GetTargetActionResult(0);	\n\
		if actionResult:IsNil() == false then\n\
		    iDiceValue = actionResult:GetAbil(AT_DICE_VALUE);\n\
		end\n\
    end\n\
\n\
	--ODS(\"AT_DICE_VALUE : \"..iDiceValue..\"\\n\");\n\
\n\
	if iDiceValue == 0 then\n\
		actor:AttachParticleS(7214,\"p_ef_star\",\"ef_gamble_002_1_p_ef_star\",2.0);\n\
	elseif iDiceValue == 1 then\n\
		actor:AttachParticleS(7214,\"p_ef_star\",\"ef_gamble_002_2_p_ef_star\",2.0);\n\
	elseif iDiceValue == 2 then\n\
		actor:AttachParticleS(7214,\"p_ef_star\",\"ef_gamble_002_3_p_ef_star\",2.0);\n\
	elseif iDiceValue == 3 then\n\
		actor:AttachParticleS(7214,\"p_ef_star\",\"ef_gamble_002_4_p_ef_star\",2.0);\n\
	elseif iDiceValue == 4 then\n\
		actor:AttachParticleS(7214,\"p_ef_star\",\"ef_gamble_002_5_p_ef_star\",2.0);\n\
	elseif iDiceValue == 5 then\n\
		actor:AttachParticleS(7214,\"p_ef_star\",\"ef_gamble_002_6_p_ef_star\",2.0);\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Roulette_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        if action:GetParamInt(2) >0 then        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
                Skill_Roulette_HitOneTime(actor,action);\n\
            end        \n\
        end    \n\
    end\n\
end\n\
function Skill_Roulette_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		actor:DetachFrom(7212,true);\n\
		actor:AttachParticle(7210, \"p_ef_star\", \"ef_gamble_003_p_ef_star\");\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Roulette_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
			\n\
		end\n\
		\n\
        Skill_Roulette_HitOneTime(actor,kAction)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [DETACH_HIT_CASTER_EFFECT_AT_FINISH] :   CASTING_CASTER_EFFECT   \n\
-- [INSTALL_EFFECT_TARGET_NODE] : Install Target  ,  \n\
-- [INSTALL_EFFECT_ID] : Install Target   ID\n\
-- [USE_SKILL_RANGE] : DB  SkillDef  Range   \n\
-- [INTSALL_DELAY] :     \n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] : FIRE     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [BROADCAST_TARGETLIST] :      ?\n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_TARGET_NODE1] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID1] :     ID\n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   CASTING_CASTER_EFFECT   \n\
\n\
function Skill_InstallDefault_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_InstallDefault_OnCastingCompleted(kActor, kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	Skill_InstallDefault_Fire(kActor,kAction);\n\
\n\
	local   kFireEffectID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
	if kActor:IsMeetFloor() == true then\n\
		kAction:SetSlot(kAction:GetCurrentSlot()+1);\n\
	else\n\
		kAction:SetSlot(kAction:GetCurrentSlot()+2);\n\
\n\
		kFireEffectID = \"ef_skill_JumpTrrap_01_char_root\";\n\
		kFireEffectTargetNodeIDToPosWithRotate = \"char_root\";\n\
	end\n\
	\n\
	if(1 < kAction:GetSlotCount() ) then \n\
		kActor:PlayCurrentSlot();\n\
	end \n\
\n\
	local fSize = 1.0\n\
	local kFactorParam = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_SIZE_TO_SKILLRANGE_FACTOR\")\n\
	if \"\" ~= kFactorParam then		\n\
		local fFactor = 100		\n\
		fFactor = tonumber(kFactorParam)\n\
		fSize = fSize * (kAction:GetSkillRange(0,kActor) / fFactor)\n\
	end\n\
		\n\
	if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            kActor:AttachParticleToPoint(7212,kDir,kFireEffectID)            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            kActor:AttachParticleS(7212, kFireEffectTargetNodeID, kFireEffectID, fSize)\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			kActor:AttachParticleToPoint(7212,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID)			\n\
		else\n\
		    kActor:AttachParticleToPointWithRotate(7212,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, kActor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\")\n\
    kFireEffectTargetNodeID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\")\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            kActor:AttachParticleToPoint(7213,kDir,kFireEffectID)\n\
            \n\
        else\n\
            kActor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID)\n\
        end    \n\
    end\n\
end\n\
\n\
--[[\n\
function Skill_InstallDefault_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kTargetPos;\n\
    if actor:IsMyActor() then\n\
    \n\
        --    GUID  .\n\
	    local guid = GUID(\"123\")\n\
	    guid:Generate()\n\
	    action:AddNewGUID(guid);\n\
	    \n\
	    kTargetPos = Skill_InstallDefault_FindSkillActorGenPoint(actor,action)\n\
	    \n\
        action:SetParamFloat(7,kTargetPos:GetX());\n\
        action:SetParamFloat(8,kTargetPos:GetY());\n\
        action:SetParamFloat(9,kTargetPos:GetZ());	    \n\
   	\n\
	else\n\
	\n\
	    --       GUID  .\n\
	    \n\
	    local   kPacket = action:GetParamAsPacket();\n\
	    local   kGUID = kPacket:PopGuid();\n\
	    action:AddNewGUID(kGUID);\n\
	    \n\
	    ODS(\"Skill_InstallDefault_Fire kGUID:\"..kGUID:GetString()..\"\\n\");\n\
	    \n\
	    kTargetPos = Point3(0,0,0);\n\
	    kTargetPos:SetX(kPacket:PopFloat());\n\
	    kTargetPos:SetY(kPacket:PopFloat());\n\
	    kTargetPos:SetZ(kPacket:PopFloat());\n\
	\n\
	end\n\
	\n\
	--   ,   .\n\
	Skill_InstallDefault_CreateSkillActor(actor,action,kTargetPos);\n\
\n\
	action:SetParamInt(39, 0);\n\
	action:SetParamFloat(40, 0);\n\
	action:SetParamFloat(41, g_world:GetAccumTime()); --   \n\
	local iInstallDelay = tonumber(action:GetScriptParam(\"INTSALL_DELAY\"));\n\
	if iInstallDelay ~= nil then\n\
		action:SetParamFloat(40, iInstallDelay);\n\
		action:SetParamInt(39, 1);\n\
	end		\n\
end\n\
]]--\n\
\n\
function Skill_InstallDefault_OnOverridePacket(actor,action,packet)\n\
	--[[\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetActionParam() == AP_FIRE then	\n\
        local   kGUID   =   action:GetGUIDInContainer(0);\n\
        packet:PushGuid(kGUID);\n\
        packet:PushFloat(action:GetParamFloat(7));\n\
        packet:PushFloat(action:GetParamFloat(8));\n\
        packet:PushFloat(action:GetParamFloat(9));\n\
    end\n\
	]]--\n\
    \n\
end\n\
\n\
function Skill_InstallDefault_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_InstallDefault_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	local   kFireEffectID1 = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID1\");\n\
    local   kFireEffectTargetNodeID1 = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE1\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" \n\
	   or (kFireEffectID1 ~= \"\" and  kFireEffectTargetNodeID1 ~=\"\")\n\
	   then    \n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
		\n\
		if kFireEffectTargetNodeID1 ~= \"\" then \n\
			actor:AttachParticle(7216,kFireEffectTargetNodeID1,kFireEffectID1)\n\
		end\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end\n\
\n\
	local actionID = action:GetID()\n\
	if actionID == \"a_LightningMargnet\" or actionID == \"a_crossblade\" then\n\
		if actor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_InstallDefault_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMeetFloor() == false then\n\
		actor:StopJump();\n\
		actor:FreeMove(true);\n\
		local fNowTime = timeGetTime();\n\
		action:SetParamInt(20, fNowTime);\n\
		action:SetParamInt(21, 1);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_InstallDefault_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
\n\
	--     \n\
	--[[\n\
	if 1 == action:GetParamInt(39) then		\n\
		if 0 ~= action:GetParamFloat(40) then			\n\
			local   fElapsedTIme = accumTime - action:GetParamFloat(41);\n\
			ODS(\"Skill_InstallDefault_OnUpdate  fElapsedTIme : \"..fElapsedTIme..\"\\n\")\n\
			ODS(\"Skill_InstallDefault_OnUpdate  Install Time : \"..action:GetParamFloat(40)..\"\\n\")\n\
			if fElapsedTIme > action:GetParamFloat(40) then\n\
				local   kActor = Skill_InstallDefault_GetSkillActor(actor,action)\n\
				if kActor ~= nil then\n\
		   			kActor:SetHide(false);\n\
					kActor:SetHideShadow(false);					\n\
				else\n\
					ODS(\"Skill_InstallDefault_OnUpdate Skill_InstallDefault_GetSkillActor if Failed\\n\");\n\
				end\n\
				action:SetParamInt(39, 2);\n\
			end\n\
		end\n\
	end\n\
	]]--\n\
\n\
	if action:GetParam(1) == \"end\" then	\n\
		return	false;\n\
	end\n\
	\n\
	if 1 == action:GetParamFloat(21) then\n\
		local fStartTime = action:GetParamInt(20);\n\
		local fNowTime = timeGetTime();\n\
\n\
		--    0.15   .\n\
		if (fNowTime - fStartTime) > 150 then\n\
			actor:FreeMove(false);\n\
			action:SetParamFloat(21,2)\n\
		end\n\
	end\n\
	\n\
	if animDone == true then			\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			if actor:IsMeetFloor() == false then\n\
				action:SetNextActionName(\"a_jump\")\n\
				actor:FreeMove(false);\n\
			end	\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_InstallDefault_OnCleanUp(kActor)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
		\n\
	local   kCurAction = kActor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
\n\
	kActor:FreeMove(false);\n\
\n\
	local actionID = kCurAction:GetID();\n\
	if actionID == \"a_LightningMargnet\"  or actionID == \"a_crossblade\" then\n\
		if kActor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
		end	\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	    kActor:DetachFrom(7215);\n\
		kActor:DetachFrom(7216);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"DETACH_HIT_CASTER_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	    kActor:DetachFrom(7214);\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false\n\
		local DefaultDetaChID2 = false\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true\n\
		end		\n\
\n\
	    kActor:DetachFrom(7212,DefaultDetaChID)\n\
	    kActor:DetachFrom(7213,DefaultDetaChID2)\n\
		kActor:DetachFrom(7214)\n\
		kActor:DetachFrom(7217, true) --  \n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
		kActor:DetachFrom(7215,DefaultDetaChID)\n\
		kActor:DetachFrom(7216,DefaultDetaChID);\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_InstallDefault_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());	\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		actor:FreeMove(false);\n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
--[[\n\
function Skill_InstallDefault_FindSkillActorGenPoint(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   iDistance = action:GetAbil(AT_DISTANCE);\n\
 \n\
    if iDistance == 0 then\n\
        iDistance = 50\n\
    end\n\
\n\
	if \"TRUE\" == action:GetScriptParam(\"USE_SKILL_RANGE\") then\n\
		iDistance = action:GetSkillRange(0,actor);\n\
	end\n\
\n\
	if action:GetID() == \"a_Snow Blues\" then\n\
		iDistance = -iDistance;\n\
	end\n\
\n\
	if action:GetID() == \"a_Energy Ball\" then\n\
		iDistance = -17;\n\
	end\n\
\n\
	ODS(\"Skill_InstallDefault_FindSkillActorGenPoint iDistance : \"..iDistance..\"\\n\")\n\
    \n\
    local   kTargetPos = actor:GetPos();\n\
    local   kLookDir = actor:GetLookingDir();\n\
    kLookDir:Multiply(iDistance);\n\
    kTargetPos:Add(kLookDir);\n\
    \n\
    kTargetPos = g_world:FindActorFloorPos(kTargetPos);\n\
    \n\
    return kTargetPos;\n\
    \n\
end\n\
]]--\n\
\n\
--[[\n\
function Skill_InstallDefault_GetSkillActor(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetTotalGUIDInContainer() == 0 then\n\
		ODS(\"Skill_InstallDefault_GetSkillActor action:GetTotalGUIDInContainer() == 0\\n\");\n\
        return nil;\n\
    end    \n\
    \n\
   \n\
    local   kGUID = action:GetGUIDInContainer(0);\n\
    \n\
    local   kActor = g_world:FindActor(kGUID);\n\
    if kActor:IsNil() == false then \n\
		local   kHitEffectID = action:GetScriptParam(\"INSTALL_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"INSTALL_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
			local kPos = kActor:GetNodeTranslate(kHitEffectTargetNodeID);\n\
			actor:AttachParticleToPointWithRotate(7214,kPos,kHitEffectID,actor:GetRotateQuaternion());\n\
	    end\n\
\n\
        return  kActor\n\
    end\n\
    \n\
	ODS(\"Skill_InstallDefault_GetSkillActor g_world:FindActor Failed kGUID:\"..kGUID:GetString()..\"\\n\");\n\
    return  nil;\n\
end\n\
]]--\n\
\n\
function Skill_InstallDefault_CreateSkillActor(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
") + std::string("	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetTotalGUIDInContainer() == 0 then\n\
        return\n\
    end\n\
    \n\
    local kGUID = action:GetGUIDInContainer(0);\n\
    local iClass = action:GetAbil(AT_CLASS);\n\
    local iLevel = action:GetAbil(AT_LEVEL);\n\
    \n\
    ODS(\"Skill_InstallDefault_CreateSkillActor Action:\"..action:GetID()..\" iClass:\"..iClass..\" iLevel:\"..iLevel..\"\\n\");\n\
	\n\
	local pilot = g_pilotMan:NewPilot(kGUID, iClass, 0)\n\
	if pilot:IsNil() == false then\n\
	\n\
	    pilot:SetUnit(kGUID,UT_ENTITY,iClass,iLevel,0);\n\
	\n\
	    local   kActor = pilot:GetActor();\n\
		kActor:FreeMove(true)\n\
	    kActor:SetHide(true);\n\
	    kActor:SetHideShadow(true);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
	    kActor:SetParam(\"Entity_Create_Time\",\"\"..g_world:GetAccumTime());\n\
	\n\
		g_world:AddActor(kGUID, kActor, kTargetPos, 9)\n\
	    if actor:IsMyActor() then\n\
	        kActor:SetUnderMyControl(true);\n\
	    end\n\
\n\
		local kUnit = pilot:GetUnit();\n\
\n\
		if kUnit ~= nil then\n\
			kUnit:SetCaller(actor:GetPilotGuid());\n\
		end\n\
\n\
	    g_pilotMan:InsertPilot(kGUID,pilot);\n\
		local   iActionNo = kActor:GetAbil(AT_MON_SKILL_01)\n\
		\n\
		ODS(\"AT_MON_SKILL_01 : \".. iActionNo..\"\\n\");\n\
		\n\
		local kAction = kActor:ReserveTransitActionByActionNo(iActionNo);\n\
		if kAction:IsNil() == false then\n\
			kAction:SetDoNotBroadCast(true)\n\
		\n\
			kAction:SetParamFloat(4,actor:GetLookingDir():GetX());\n\
			kAction:SetParamFloat(5,actor:GetLookingDir():GetY());\n\
			kAction:SetParamFloat(6,actor:GetLookingDir():GetZ());\n\
    		\n\
			if actor:IsMyActor() then\n\
				Net_C_M_REQ_CREATE_ENTITY(kGUID,iClass,iLevel,kTargetPos);\n\
			end\n\
		else\n\
			ODS(\"Mon Action Creation Failed.\\n\");\n\
		end\n\
	\n\
	end	    \n\
\n\
end\n\
\n\
\n\
function Skill_InstallDefault_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
			local kPos = actor:GetNodeTranslate(kHitEffectTargetNodeID)\n\
			actor:AttachParticleToPointWithRotate(7214,kPos,kHitEffectID,actor:GetRotateQuaternion());\n\
	    end\n\
\n\
        actor:ClearIgnoreEffectList();\n\
		local	kSoundID = nil\n\
		if(\"hit\" == textKey) then\n\
			kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		elseif(\"fire\" == textKey) then\n\
			kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\");\n\
		end\n\
		\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
\n\
		--     \n\
		--[[\n\
		if 0 == kAction:GetParamInt(39) then\n\
			local   kActor = Skill_InstallDefault_GetSkillActor(actor,kAction)\n\
			if kActor ~= nil then\n\
	        \n\
				kActor:SetHide(false);\n\
				kActor:SetHideShadow(false);\n\
			else\n\
				ODS(\"Skill_InstallDefault_OnEvent kActor is nil\\n\");\n\
	        end\n\
		end\n\
		]]--\n\
\n\
		if \"TRUE\" == kAction:GetScriptParam(\"BROADCAST_TARGETLIST\") then\n\
			if actor:IsUnderMyControl() then\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_InstallDefault_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
	end\n\
end\n\
\n\
function Skill_InstallDefault_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_InstallDefault_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_InstallDefault_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [TYPE] : \"BOMB\" : (    )\n\
-- [BOMB_EFFECT_ID] :   ID\n\
-- [BOMB_AFTER_LIFETIME] : LIFE    .\n\
-- [BOME_AFTER_EFFECT_ID] :     ID\n\
-- [BOME_AFTER_EFFECT_SCALE] :     \n\
-- [HIT_SOUND_ID] :   \n\
-- [BOME_AFTER_SOUND_ID] :    \n\
-- [INSTALL_EFFECT_TARGET_NODE] :    ,  \n\
-- [INSTALL_EFFECT_ID] :     ID\n\
-- [INSTALL_EFFECT_TARGET_NODE2] :    ,  \n\
-- [INSTALL_EFFECT_ID2] :     ID\n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
\n\
function Skill_InstallDefault_Play_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_InstallDefault_Play_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
	if actor:IsUnderMyControl() then\n\
		local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	        	\n\
		if fLifeTime == 0 then\n\
			fLifeTime = 9.0;	\n\
		end\n\
		actor:SetInstallTimerGauge(fLifeTime);\n\
	end\n\
\n\
end\n\
\n\
function Skill_InstallDefault_Play_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    --   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    action:SetParamFloat(2,g_world:GetAccumTime());\n\
    action:SetParamFloat(3,g_world:GetAccumTime());\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"INSTALL_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"INSTALL_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end    \n\
    end	\n\
\n\
	local   kFireEffectID2 = action:GetScriptParam(\"INSTALL_EFFECT_ID2\");\n\
    local   kFireEffectTargetNodeID2 = action:GetScriptParam(\"INSTALL_EFFECT_TARGET_NODE2\");\n\
    \n\
    if kFireEffectID2 ~= \"\" and kFireEffectTargetNodeID2 ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID2 == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID2);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID2,kFireEffectID2);\n\
        end\n\
    \n\
    end	\n\
\n\
\n\
end\n\
function Skill_InstallDefault_StartTimer(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if actor:IsUnderMyControl() then\n\
        \n\
        if action:GetScriptParam(\"BOMB_AFTER_LIFETIME\") ~= \"TRUE\" then\n\
        	        \n\
	        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
        	\n\
	        if fLifeTime == 0 then\n\
	            fLifeTime = 10.0;\n\
            end\n\
                \n\
            local   fAttackDelay = 0;\n\
            \n\
            fAttackDelay = action:GetAbil(AT_ATT_DELAY)/1000.0;\n\
            --ODS(\"Action :\"..action:GetID()..\" AttackDelay : \"..fAttackDelay..\" fLifeTime:\"..fLifeTime..\"\\n\");\n\
            if fAttackDelay < 0.05 then\n\
                fAttackDelay = 0.05\n\
            end\n\
            \n\
            --   \n\
            action:StartTimer(fLifeTime,fAttackDelay,0)\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
end\n\
\n\
function Skill_InstallDefault_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actionID = action:GetID()\n\
	\n\
	--ODS(\"Skill_InstallDefault_Play_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	action:SetParam(0,\"Idle\");  --  State\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_InstallDefault_Play_OnCastingCompleted(actor,action);\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_InstallDefault_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
    \n\
		--ODS(\"Skill_InstallDefault_Play_FindTarget Skill_InstallDefault_Play_OnTargetListModified\\n\");\n\
    \n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        \n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        if action:GetScriptParam(\"TYPE\") == \"BOMB\" and action:GetID() ~= \"a_Caltrap Set\" then \n\
            --   \n\
            --    .\n\
            local   kBombEffectID = action:GetScriptParam(\"BOMB_EFFECT_ID\");\n\
            if kBombEffectID == \"\" then\n\
                kBombEffectID = \"ef_Magnumbreak_01_char_root\"\n\
            end\n\
            GetMyActor():AttachParticleToPoint(1,actor:GetPos(),kBombEffectID);\n\
            --    .\n\
            actor:HideNode(\"Scene Root\",true)\n\
            actor:SetHideShadow(true);\n\
            --  5  .   .\n\
            action:SetParamFloat(1,g_world:GetAccumTime());\n\
            action:SetParam(0,\"WaitForDestroying\");\n\
\n\
			local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
			if kSoundID~=\"\" then\n\
				local actionID = action:GetID()\n\
				if(actionID == \"a_Splash Trap_Explosion\" or actionID == \"a_Freezing Trap Active\" or actionID == \"a_Silence Trap Active\" or actionID == \"a_MP-Zero Trap Active\") then\n\
					GetMyActor():AttachSound(20104026, kSoundID);\n\
				else			\n\
					g_world:AttachSound(kSoundID, actor:GetPos());\n\
				end\n\
			end\n\
		elseif action:GetID() == \"a_Caltrap Set\" then\n\
			--    .\n\
            actor:HideNode(\"Scene Root\",true)\n\
            actor:SetHideShadow(true);\n\
            --  5  .   .\n\
            action:SetParamFloat(1,g_world:GetAccumTime());\n\
            action:SetParam(0,\"WaitForDestroying\");\n\
		end\n\
    end\n\
\n\
end\n\
\n\
function Skill_InstallDefault_Play_FindTarget(actor,action,bForceToBomb)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	bIsBombType = (action:GetScriptParam(\"TYPE\") == \"BOMB\");\n\
\n\
	if action:GetScriptParam(\"SERACH_TYPE\") == \"FULLSEARCH\" then\n\
		action:SetParam(4,\"FullSearch\");\n\
	else\n\
		action:SetParam(4,\"OnlyCollided\");\n\
	end\n\
\n\
	if bForceToBomb then\n\
		action:SetParam(4,\"FullSearch\");\n\
	end\n\
	\n\
    action:CreateActionTargetList(actor,true);\n\
    \n\
    if action:GetTargetCount() > 0 or bForceToBomb then\n\
    \n\
		if bIsBombType and bForceToBomb == false then\n\
			action:SetParam(4,\"FullSearch\");\n\
			action:CreateActionTargetList(actor,true);\n\
		end\n\
    \n\
        if IsSingleMode() or action:GetTargetCount() == 0 then\n\
			\n\
            Skill_InstallDefault_Play_OnTargetListModified(actor,action,false);    \n\
        \n\
        else\n\
        \n\
			--ODS(\"Skill_InstallDefault_Play_FindTarget BroadCastTargetListModify\\n\");\n\
            action:BroadCastTargetListModify(actor:GetPilot());\n\
            action:ClearTargetList();\n\
        \n\
        end    \n\
        \n\
        return true;\n\
        \n\
    end\n\
    \n\
    return false\n\
end\n\
\n\
\n\
function Skill_InstallDefault_Play_OnTimer(actor, accumTime, action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    --ODS(\"Skill_InstallDefault_Play_OnTimer accumTime:\"..accumTime..\"\\n\");\n\
        \n\
	--  1     .\n\
	if Skill_InstallDefault_Play_FindTarget(actor,action) then\n\
		if action:GetScriptParam(\"TYPE\") == \"BOMB\" then --    ,  . \n\
			return false;\n\
		end\n\
	end\n\
    \n\
    return true;\n\
\n\
end\n\
\n\
function Skill_InstallDefault_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local   kState = action:GetParam(0);\n\
	\n\
	--ODS(\"kState : \"..kState..\"\\n\");\n\
	\n\
	if action:GetParamFloat(3) >0 and (accumTime - action:GetParamFloat(3)> 1) then\n\
		Skill_InstallDefault_StartTimer(actor,action)\n\
		action:SetParamFloat(3,0);\n\
	end\n\
	\n\
	if  kState == \"Idle\" then\n\
	\n\
        --  10   .\n\
        local   fTotalElapsedTime = accumTime - action:GetParamFloat(2)\n\
        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
    	\n\
        if fLifeTime == 0 then\n\
            fLifeTime = 10.0;\n\
        end\n\
        \n\
        --ODS(\"Skill_InstallDefault_Play_OnUpdate fTotalElapsedTime : \"..fTotalElapsedTime..\"\\n\");\n\
        \n\
        if fTotalElapsedTime > fLifeTime-1 then\n\
	    \n\
            if action:GetScriptParam(\"BOMB_AFTER_LIFETIME\") == \"TRUE\" then\n\
				if actor:IsUnderMyControl() then      \n\
					Skill_InstallDefault_Play_FindTarget(actor,action,true)\n\
				end\n\
                action:SetParam(0,\"Destroyed\");\n\
	            return true;\n\
            end\n\
			\n\
			action:SetParam(0,\"end\");\n\
			action:SetParam(1,\"AutoDestroyed\");\n\
        end\n\
\n\
	elseif  kState == \"bomb_force\" then --   ( )\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			Skill_InstallDefault_Play_FindTarget(actor,action,true)\n\
		end\n\
		action:SetParam(0,\"Destroyed\");\n\
		--   \n\
		action:DeleteTimer(0);\n\
	\n\
	elseif kState == \"WaitForDestroying\" then\n\
		action:SetParam(0,\"end\");		\n\
\n\
	elseif kState == \"end\" then\n\
		if action:GetParam(1) == \"AutoDestroyed\" then\n\
			local   kBombAfterEffectID = action:GetScriptParam(\"BOME_AFTER_EFFECT_ID\");\n\
\n\
			if kBombAfterEffectID ~= nil then\n\
				local kBombAfterEffectSize = tonumber(action:GetScriptParam(\"BOME_AFTER_EFFECT_SCALE\"));\n\
				\n\
				if kBombAfterEffectSize ~= nil then\n\
					GetMyActor():AttachParticleToPointS(30,actor:GetPos(), kBombAfterEffectID, kBombAfterEffectSize);\n\
				end\n\
\n\
				local	kSoundID = action:GetScriptParam(\"BOME_AFTER_SOUND_ID\");\n\
				if kSoundID ~= \"\" then\n\
					if( CheckNil(g_world == nil) ) then return false end\n\
					if( CheckNil(g_world:IsNil()) ) then return false end\n\
					g_world:AttachSound(kSoundID, actor:GetPos());\n\
				end\n\
			end\n\
		end\n\
\n\
		return false;\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_InstallDefault_Play_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kFindType = action:GetParam(4)\n\
	\n\
	local	fFindRange = 50;\n\
	local	iMaxTargetCount = 0;\n\
	\n\
	if kFindType == \"OnlyCollided\" then\n\
		fFindRange = 10\n\
		iMaxTargetCount = 1\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
\n\
	local iAttackRange = action:GetSkillRange(0,actor);\n\
\n\
	local kParam = FindTargetParam();\n\
\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(kPos,kDir);\n\
	kParam:SetParam_2(0,0,fFindRange,iMaxTargetCount);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	local strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
\n\
	--ODS(\"strFindTargetType : \"..strFindTargetType..\"\\n\", false, 1509)\n\
\n\
	local iFindTargetType = TAT_SPHERE;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(iAttackRange,30,fFindRange,iMaxTargetCount);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(iAttackRange,60,fFindRange,iMaxTargetCount);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(0,30,iAttackRange,iMaxTargetCount);\n\
	\n\
	end\n\
	\n\
	return action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
\n\
end\n\
\n\
function Skill_InstallDefault_Play_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
	if actor:IsUnderMyControl() then\n\
		actor:DestroyInstallTimerGauge();\n\
	end\n\
\n\
	actor:DetachFrom(7212);\n\
	actor:DetachFrom(7213);\n\
    \n\
	return true;\n\
end\n\
\n\
function Skill_InstallDefault_Play_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Skill_InstallDefault_Play_OnLeave NextAction : \"..action:GetID()..\"\\n\");\n\
	\n\
	local	kParam = actor:GetAction():GetParam(0)\n\
	\n\
	return (kParam == \"end\");\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_Bomb_Explosion_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Bomb_Explosion_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Bomb_Explosion_OnUpdate(actor, accumTime, frameTime)\n\
	return false\n\
end\n\
\n\
function Skill_Bomb_Explosion_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Skill_Bomb_Explosion_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Resurrecton01_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Resurrecton01_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	Resurrecton01_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Resurrecton01_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Resurrecton01_Fire\\n\");\n\
\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Resurrecton01_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Resurrecton01_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Resurrecton01_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Resurrecton01_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if actor:IsMyActor() then --    \n\
		CloseUI(\"DeadDlg\");\n\
		CloseUI(\"FRM_DEAD_MISSION\");\n\
	end\n\
	local kPilot = actor:GetPilot()\n\
	if( false == kPilot:IsNil() ) then 		\n\
		local	iBaseActorType = kPilot:GetBaseClassID()\n\
		if(iBaseActorType == CT_DOUBLE_FIGHTER) then\n\
			local kSubActor = actor:GetSubPlayer()\n\
			if( false == kSubActor:IsNil() ) then	\n\
				if( actor:IsMyActor() ) then\n\
					local kSubActorAction = kSubActor:GetAction()\n\
					if( false == kSubActorAction:IsNil() ) then\n\
						if(kSubActorAction:GetID() ~= \"a_twin_sub_repos\") then\n\
							TryMustChangeActorAction(kSubActor, \"a_twin_sub_repos\")\n\
						end\n\
					end	\n\
				end\n\
				kSubActor:SetCanHit(true);\n\
			end\n\
		end\n\
	end\n\
		\n\
	ODS(\"Resurrecton01_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
    actor:AttachParticle(7215,\"p_ef_heart\",\"ef_Resurrection_03_01_p_ef_heart\");\n\
	actor:AttachParticle(7216,\"char_root\",\"ef_Resurrection_03_02_char_root\");\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Resurrecton01_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Resurrecton01_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Resurrecton01_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
    \n\
	ODS(\"RestoreItemModel Resurrecton01_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
	    actor:DetachFrom(7212)\n\
	    actor:DetachFrom(7213)\n\
		actor:DetachFrom(7214)	\n\
	end\n\
	\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Resurrecton01_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	actor:SetCanHit(true)\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Resurrecton01_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
		\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Resurrecton01_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Resurrecton01_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Resurrecton01_HitOneTime(actor,action);\n\
\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Resurrecton01_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());	\n\
			\n\
			end	\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_ResurrectCast_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_ResurrectCast_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_ResurrectCast_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
end\n\
function Skill_ResurrectCast_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_ResurrectCast_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_ResurrectCast_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_ResurrectCast_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_ResurrectCast_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_ResurrectCast_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_ResurrectCast_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local iAttackRange = action:GetSkillRange(0,actor);\n\
	local fScale = iAttackRange/70\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID, fScale);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_ResurrectCast_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_ResurrectCast_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_ResurrectCast_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
    \n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_ResurrectCast_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)		\n\
	end\n\
	\n\
	actor:DetachFrom(7215)\n\
\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_ResurrectCast_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_ResurrectCast_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_ResurrectCast_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_ResurrectCast_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    if bIsBefore == false then\n\
        Skill_ResurrectCast_HitOneTime(actor,action);\n\
    end\n\
\n\
end\n\
\n\
function Skill_ResurrectCast_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			kAction:CreateActionTargetList(actor);\n\
") + std::string("			kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_SomersaultKick_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_SomersaultKick_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_SomersaultKick_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_SomersaultKick_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_SomersaultKick_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_SomersaultKick_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_SomersaultKick_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_SomersaultKick_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end	\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_SomersaultKick_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_SomersaultKick_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_SomersaultKick_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_SomersaultKick_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_SomersaultKick_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    local   kCurAction = actor:GetAction();\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());	\n\
    \n\
	ODS(\"RestoreItemModel Skill_SomersaultKick_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
		actor:DetachFrom(7215, DefaultDetaChID)\n\
	end\n\
	\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_SomersaultKick_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_SomersaultKick_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_SomersaultKick_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_SomersaultKick_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_SomersaultKick_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_SomersaultKick_OnEvent(actor,textKey)\n\
") + std::string("\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end	\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_FinalDecision_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_FinalDecision_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_FinalDecision_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_FinalDecision_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_FinalDecision_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	if actor:IsMyActor() then\n\
		action:StartTimer(1.1,0.1,0);\n\
	end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end    \n\
    end	\n\
end\n\
\n\
function Skill_FinalDecision_OnTimer(actor,fAccumTime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_FinalDecision_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	if IsSingleMode() then\n\
    \n\
		Skill_Gatling_Rush_HitOneTime(actor,action)\n\
		Skill_FinalDecision_OnTargetListModified(actor,action,false)\n\
        \n\
		return true;\n\
	else\n\
    \n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
        \n\
	end			\n\
	\n\
	if actor:IsMyActor() then\n\
		Skill_Gatling_Rush_HitOneTime(actor,action)\n\
	end\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
\n\
function Skill_FinalDecision_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_FinalDecision_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_FinalDecision_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end\n\
	    iFindTargetType = TAT_SPHERE\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_FinalDecision_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_FinalDecision_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_FinalDecision_OnCastingCompleted(actor,action);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_FinalDecision_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
\n\
	if iTotalHit <= iHitCount then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end \n\
\n\
	return true\n\
end\n\
\n\
function Skill_FinalDecision_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());	\n\
    \n\
	actor:HideParts(5,false);\n\
	actor:HideParts(6,false);\n\
	actor:DetachFrom(7);\n\
	   \n\
	ODS(\"RestoreItemModel Skill_FinalDecision_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
	    actor:DetachFrom(7212)\n\
	    actor:DetachFrom(7213)\n\
	\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_FinalDecision_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_FinalDecision_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_FinalDecision_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Gatling_Rush_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
function Skill_FinalDecision_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());	\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_ScrewUpper_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_ScrewUpper_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_ScrewUpper_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
	local	kTargetPos = actor:GetNodeWorldPos(\"char_root\");\n\
	actor:AttachParticleToPointWithRotate(8,kTargetPos,\"ef_ScrewUpper_01_char_root\", actor:GetRotateQuaternion())\n\
\n\
end\n\
\n\
\n\
function Skill_ScrewUpper_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_ScrewUpper_Fire\\n\");\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(2,g_world:GetAccumTime()); --   \n\
	action:SetParamFloat(6,0);\n\
	action:SetParamInt(9,0)	--	Hit Count\n\
\n\
	actor:FreeMove(true);\n\
\n\
end\n\
function Skill_ScrewUpper_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);	\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	ODS(\"Skill_ScrewUpper_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
    local iFindTargetType = TAT_SPHERE;\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	\n\
	kParam:SetParam_3(true,action:GetAbil(AT_ATTACK_UNIT_POS));\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_ScrewUpper_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	SkillFunc_InitUseDmgEffect(action);\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_ScrewUpper_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_ScrewUpper_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
function Skill_ScrewUpper_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then	\n\
        Skill_ScrewUpper_HitOneTime(actor,action);    \n\
    end\n\
\n\
end\n\
\n\
function Skill_ScrewUpper_OnTimer(actor,fAccumTime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_ScrewUpper_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	action:CreateActionTargetList(actor);\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(10,g_world:GetAccumTime());\n\
		local	iHitCount = action:GetParamInt(9);\n\
		\n\
		ODS(\"Skill_ScrewUpper_HitOneTime iHitCount:\"..iHitCount..\"\\n\");\n\
		\n\
		--local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
		--	if 0 == iSkillLevel then\n\
		--	iSkillLevel = 1;\n\
		--end\n\
\n\
		local	iTotalHit = 5;\n\
		\n\
		if iHitCount == iTotalHit then\n\
			return true\n\
		end		\n\
		iHitCount = iHitCount + 1;\n\
		action:SetParamInt(9,iHitCount);\n\
	\n\
	end\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
function Skill_ScrewUpper_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actionID = action:GetID();\n\
	local movingSpeed = 0\n\
	local bAnimDone = actor:IsAnimationDone();\n\
	local iSlot = action:GetCurrentSlot();\n\
\n\
    if iSlot == 1 then\n\
\n\
	    if bAnimDone then\n\
	        actor:PlayNext();\n\
	        action:SetParamFloat(2,accumTime);\n\
\n\
			if actor:IsMyActor() then\n\
				action:StartTimer(1.0,0.15,0);\n\
			end\n\
	    end\n\
    \n\
    elseif iSlot == 2 then\n\
		\n\
		--local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
		--	if 0 == iSkillLevel then\n\
		--	iSkillLevel = 1;\n\
		--end\n\
\n\
		local	iTotalHit = 5;\n\
\n\
		if action:GetParamInt(9) < iTotalHit then\n\
			ODS(\"\\n---------- Cur Hit \"..action:GetParamInt(9)..\"     Total \"..iTotalHit..\"    ---------\\n\")\n\
		\n\
			actor:IncRotate(frameTime*8*360.0*3.141592/180.0);\n\
			actor:SetMovingDelta(Point3(0,0,80));\n\
		else\n\
			action:SetParam(1,\"end\");\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_ScrewUpper_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(19002);\n\
	actor:FreeMove(false);\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_ScrewUpper_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if curParam == \"end\" then \n\
			action:SetSlot(2);\n\
			action:SetDoNotBroadCast(true);\n\
			return true;\n\
		end\n\
		return	false;\n\
	end\n\
	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_ScrewUpper_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_ScrewUpper_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
		\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
		\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_JudgeDread_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_JudgeDread_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_JudgeDread_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_JudgeDread_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	ODS(\"RestoreItemModel Skill_JudgeDread_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_JudgeDread_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 144\n\
	end\n\
	\n\
	return  Skill_JudgeDread_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_JudgeDread_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
	local iTargets = action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_JudgeDread_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
--	if actor:IsMeetFloor() == true then --  \n\
--			return	false;\n\
--	end\n\
\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	ODS(\"Skill_JudgeDread_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_JudgeDread_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_JudgeDread_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_JudgeDread_OnCleanUp(actor)\n\
			\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
    \n\
	ODS(\"RestoreItemModel Skill_JudgeDread_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_JudgeDread_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"3333333333333333333\\n\")\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		ODS(\"1111111111\\n\")\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
\n\
	if curParam == \"end\" then \n\
		ODS(\"2222222222222222222222222222222222\\n\")\n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		ODS(\"2222222222222\\n\")\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_JudgeDread_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_JudgeDread_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_JudgeDread_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_JudgeDread_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_JudgeDread_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
		        \n\
					Skill_JudgeDread_HitOneTime(actor,kAction)\n\
					Skill_JudgeDread_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
		        \n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		            \n\
				end			\n\
			\n\
			end	\n\
		end\n\
	       \n\
") + std::string("	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Swiftattack_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 1 then\n\
		return	false;\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Swiftattack_FindTarget(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor);	\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());	\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Skill_Swiftattack_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
	ODS(\"  : \" .. iFound .. \"\\n\")\n\
	\n\
	return	kTargets;\n\
end\n\
function Skill_Swiftattack_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local range1 = action:GetSkillRange(0,actor)\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,range1,0);	--    \n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	return	action:FindTargetsEx(action:GetActionNo(),TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Swiftattack_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Swiftattack_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	actor:AttachSound(106,\"SwiftAttack\");\n\
	actor:HideNode(\"Scene Root\",true);\n\
	action:SetParamInt(10, 0);\n\
	action:SetParamInt(13, 0);\n\
end\n\
\n\
function Skill_Swiftattack_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(101,\"\");	\n\
		\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Swiftattack_OnCastingCompleted(actor,action);	\n\
		\n\
	return true\n\
end\n\
function Skill_Swiftattack_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Swiftattack_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);	\n\
	end\n\
\n\
	actor:AttachParticleToPoint(8776,actor:GetNodeWorldPos(\"char_root\"),\"ef_Shadowleap_01_01_char_root\");\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
	ODS(\"Skill_Swiftattack_Fire iTargetCount : \"..iTargetCount..\"\\n\");\n\
\n\
	local dis = 0\n\
	local lookNum = 0\n\
\n\
	for i = 0, iTargetCount - 1 do\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			pt:Subtract(actor:GetTranslate())\n\
			if dis < pt:Length() then\n\
				dis = pt:Length()\n\
				lookNum = i\n\
			end\n\
		end\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	Skill_Swiftattack_LoadArrowToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	kNewArrow:LoadToWeapon(actor);	--	\n\
	kNewArrow:SetParamValue(\"Target\", \"0\")\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Swiftattack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	if action:GetParamInt(10) == 2 then\n\
		action:SetParam(1, \"end\");\n\
    	    \n\
		local   kMyPos = actor:GetPos();\n\
		local   kTargetPos = action:GetParamAsPoint(0);\n\
		local   kDir = kTargetPos:_Subtract(kMyPos);\n\
		kDir:Unitize();\n\
        \n\
		if actor:IsToLeft() == action:GetParamInt(11) then\n\
			kDir:Multiply(-30);							\n\
		elseif actor:IsToLeft() ~= action:GetParamInt(11) then\n\
			kDir:Multiply(30);\n\
		end\n\
\n\
		local   kNewPos = kTargetPos:_Add(kDir);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		kNewPos = g_world:FindActorFloorPos(kNewPos);\n\
        \n\
		--actor:AttachParticle(8777,\"char_root\",\"ef_Shadowleap_01_02_char_root\");\n\
\n\
		return false;\n\
	end\n\
\n\
	if action:GetParam(101) ==\"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		action:SetParam(1, \"end\")\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Swiftattack_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:HideNode(\"Scene Root\",false);\n\
	return true;\n\
end\n\
function Skill_Swiftattack_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
		\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
--	ODS(\"Skill_Swiftattack_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
\n\
	if actor:IsMyActor() == false or curAction:GetParam(101)==\"end\" then\n\
		return true;\n\
	end\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetActionType()==\"EFFECT\"then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Swiftattack_DoEffect(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:SetNormalAttackEndTime();\n\
\n\
	local	action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
\n\
	action:SetParam(4,\"HIT\");\n\
\n\
	local	iTargetCount = action:GetTargetCount();\n\
	if iTargetCount > 0 then\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_Swiftattack_LoadArrowToWeapon(actor,action);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			kArrow:SetParamValue(\"DMG_SOUND\",\"CushionShot\");\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			local	iTargetABVShapeIndex = 0;\n\
			local	kActionTargetInfo = nil\n\
		\n\
			--	  \n\
			local	kTargetGUID = action:GetTargetGUID(0);\n\
			iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
			kActionTargetInfo = action:GetTargetInfo(0);\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end						\n\
		\n\
			kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
			\n\
			if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kMovingDir:Add(arrow_worldpos);\n\
				kArrow:SetTargetLoc(kMovingDir);		\n\
			else\n\
				kArrow:SetTargetObjectList(action:GetTargetList());	\n\
			end\n\
			\n\
			kArrow:Fire();\n\
		end\n\
	else\n\
		action:SetParamInt(10,2);\n\
		action:SetParam(1, \"end\");\n\
	end\n\
\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Skill_Swiftattack_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	ODS(\"Skill_Swiftattack_OnEvent key : \"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\" then		\n\
		Skill_Swiftattack_DoEffect(actor);\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
-- Melee\n\
function Skill_Bugs_Life_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() then\n\
		local iNowHP = actor:GetAbil(AT_HP);\n\
		if iNowHP > actor:GetAbil(AT_C_MAX_HP) * (action:GetAbil(AT_R_MAX_HP) / ABILITY_RATE_VALUE) then\n\
			local iPercentage = action:GetAbil(AT_R_MAX_HP)/100\n\
			local kStr = WideString(string.format(GetTextW(41002):GetStr(), iPercentage))\n\
			AddWarnDataStr(kStr,2);\n\
			return false;\n\
		end\n\
\n\
			ODS(\" now HP : \"..iNowHP..\" MaxHP : \"..actor:GetAbil(AT_C_MAX_HP)..\" Per : \"..action:GetAbil(AT_R_MAX_HP)..\"\\n\");\n\
	end\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Bugs_Life_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	Skill_Bugs_Life_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
function Skill_Bugs_Life_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Bugs_Life_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
		action:CreateActionTargetList(actor);\n\
		if action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
			local iTargetCount = action:GetTargetCount();\n\
			if iTargetCount == tonumber(action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
				AddWarnDataStr(GetTextW(tonumber(action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2);		\n\
			end\n\
		end\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_Bugs_Life_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_Bugs_Life_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_Bugs_Life_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Bugs_Life_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Bugs_Life_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
		else\n\
			actor:AttachParticleToPoint(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Bugs_Life_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Bugs_Life_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Bugs_Life_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());	\n\
	\n\
	ODS(\"RestoreItemModel Skill_Bugs_Life_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
	end\n\
	\n\
	--   (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
	return true;\n\
end\n\
\n\
function Skill_Bugs_Life_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
") + std::string("	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Bugs_Life_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
\n\
function Skill_Bugs_Life_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Bugs_Life_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Bugs_Life_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Bugs_Life_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		--  \n\
		if kAction:GetID() == \"a_Don't touch me!\" then\n\
			if actor:IsMyActor() then\n\
				actor:AttachParticle(7217,\"p_ef_star\",\"ef_Dont_timer_02_center\");\n\
			end\n\
		end\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
					local iTargetCount = kAction:GetTargetCount();\n\
					if iTargetCount == tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
						AddWarnDataStr(GetTextW(tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2);		\n\
					end\n\
				end\n\
\n\
				if IsSingleMode() then\n\
		        \n\
					Skill_Bugs_Life_HitOneTime(actor,kAction)\n\
					Skill_Bugs_Life_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
		        \n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		            \n\
				end			\n\
			\n\
			end	\n\
		end\n\
	\n\
        Skill_Bugs_Life_HitOneTime(actor,kAction)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_Seven_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if(true == actor:IsInCoolTime(action:GetActionNo(), false) ) then\n\
		return false\n\
	end\n\
		\n\
	local curAction = actor:GetAction();	\n\
	if( false == curAction:IsNil() ) then\n\
		curAction:SetNextActionName(\"a_Seven\");\n\
		curAction:ChangeToNextActionOnNextUpdate(true, true);\n\
	end\n\
		\n\
	return true;\n\
end\n\
\n\
function Skill_Seven_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Seven_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Seven_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Seven_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_Seven_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_Seven_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_Seven_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Seven_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Seven_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Seven_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Seven_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Seven_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
    \n\
	ODS(\"RestoreItemModel Skill_Seven_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
		actor:DetachFrom(7215)\n\
	end\n\
	\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_Seven_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Seven_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	--   \n\
	if (0 < actor:GetAbil(AT_SKILL_LINKAGE_POINT)) then\n\
		actor:AttachParticleS(7215,\"char_root\",\"ef_base_dmg_ma_01\",2);\n\
	end\n\
\n\
\n\
end\n\
\n\
function Skill_Seven_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Seven_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Seven_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Seven_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			\n\
			end	\n\
		end\n\
	        \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_RollingLog_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
\n\
	local iSkillLevel = actor:GetAbil(AT_LEVEL);\n\
	actor:SetTargetScale(0.3 + (iSkillLevel * 0.07));\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_RollingLog_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP);\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_RollingLog_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_RollingLog_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
			\n\
	local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
	local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
	if fMoveSpeed == 0 then\n\
	    fMoveSpeed = 50\n\
    end\n\
	\n\
	kMoveDir:Multiply(fMoveSpeed);\n\
	\n\
	actor:SetMovingDelta(kMoveDir);\n\
	\n\
	local   fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
	if fElapsedTIme>0.3 then\n\
	\n\
	    action:SetParamFloat(1,accumTime);\n\
	    action:CreateActionTargetList(actor);\n\
	    \n\
	    if IsSingleMode() or action:GetTargetCount() == 0 then\n\
	    \n\
	        Skill_RollingLog_Play_OnTargetListModified(actor,action,false);\n\
	    \n\
	    elseif actor:IsUnderMyControl() then\n\
	    \n\
	        action:BroadCastTargetListModify(actor:GetPilot());\n\
	        action:ClearTargetList();\n\
	    \n\
	    end\n\
	    \n\
	end\n\
\n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
    \n\
    local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
    if fTotalElapsedTime > fLifeTime then\n\
        return  false\n\
    end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_RollingLog_Play_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_RollingLog_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_RollingLog_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("function Skill_InstallSelf_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
			\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_InstallSelf_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_InstallSelf_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_InstallSelf_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kTargetPos;\n\
    --if actor:IsMyActor() then\n\
    \n\
        --    GUID  .\n\
	    local guid = GUID(\"123\")\n\
	    guid:Generate()\n\
	    action:AddNewGUID(guid);\n\
	    \n\
	    kTargetPos = Skill_InstallSelf_FindSkillActorGenPoint(actor,action)\n\
	    \n\
--        action:SetParamFloat(7,kTargetPos:GetX());\n\
--        action:SetParamFloat(8,kTargetPos:GetY());\n\
--        action:SetParamFloat(9,kTargetPos:GetZ());	    \n\
   	\n\
--	else\n\
	\n\
	    --       GUID  .\n\
	    \n\
--[[	    local   kPacket = action:GetParamAsPacket();\n\
	    local   kGUID = kPacket:PopGuid();\n\
	    action:AddNewGUID(kGUID);\n\
	    \n\
	    ODS(\"Skill_InstallSelf_Fire kGUID:\"..kGUID:GetString()..\"\\n\");\n\
	    \n\
	    kTargetPos = Point3(0,0,0);\n\
	    kTargetPos:SetX(kPacket:PopFloat());\n\
	    kTargetPos:SetY(kPacket:PopFloat());\n\
	    kTargetPos:SetZ(kPacket:PopFloat());\n\
	\n\
	end\n\
]]--\n\
	--   ,   .\n\
	Skill_InstallSelf_CreateSkillActor(actor,action,kTargetPos)\n\
	\n\
	\n\
end\n\
\n\
function Skill_InstallSelf_OnOverridePacket(actor,action,packet)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetActionParam() == AP_FIRE then\n\
        local   kGUID   =   action:GetGUIDInContainer(0);\n\
        packet:PushGuid(kGUID);\n\
        packet:PushFloat(action:GetParamFloat(7));\n\
        packet:PushFloat(action:GetParamFloat(8));\n\
        packet:PushFloat(action:GetParamFloat(9));\n\
    end\n\
    \n\
end\n\
\n\
function Skill_InstallSelf_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_InstallSelf_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_InstallSelf_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_InstallSelf_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_InstallSelf_OnCleanUp(actor)\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_InstallSelf_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_InstallSelf_FindSkillActorGenPoint(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   iDistance = action:GetAbil(AT_DISTANCE);\n\
    \n\
    if iDistance == 0 then\n\
        iDistance = 50\n\
    end\n\
    \n\
    local   kTargetPos = actor:GetPos();\n\
    local   kLookDir = actor:GetLookingDir();\n\
    kLookDir:Multiply(iDistance);\n\
    kTargetPos:Add(kLookDir);\n\
    \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    kTargetPos = g_world:FindActorFloorPos(kTargetPos);\n\
    \n\
    return kTargetPos;\n\
    \n\
end\n\
\n\
function Skill_InstallSelf_GetSkillActor(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetTotalGUIDInContainer() == 0 then\n\
		ODS(\"Skill_InstallSelf_GetSkillActor action:GetTotalGUIDInContainer() == 0\\n\");\n\
        return nil;\n\
    end    \n\
    \n\
   \n\
    local   kGUID = action:GetGUIDInContainer(0);\n\
    \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    local   kActor = g_world:FindActor(kGUID);\n\
    if kActor:IsNil() == false then \n\
        return  kActor\n\
    end\n\
    \n\
	ODS(\"Skill_InstallSelf_GetSkillActor g_world:FindActor Failed kGUID:\"..kGUID:GetString()..\"\\n\");\n\
    return  nil;\n\
\n\
end\n\
\n\
function Skill_InstallSelf_CreateSkillActor(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetTotalGUIDInContainer() == 0 then\n\
        return\n\
    end\n\
    \n\
    local   kGUID = action:GetGUIDInContainer(0);\n\
   \n\
    local   iClass = actor:GetAbil(AT_CLASS);\n\
    local   iLevel = actor:GetAbil(AT_LEVEL);\n\
	local	iGender = actor:GetAbil(AT_GENDER);\n\
    \n\
    ODS(\"Skill_InstallSelf_CreateSkillActor Action:\"..actor:GetID()..\" iClass:\"..iClass..\" iLevel:\"..iLevel..\"\\n\");\n\
	\n\
	local pilot = g_pilotMan:NewPilot(kGUID, iClass, iGender)\n\
	if pilot:IsNil() == false then\n\
	\n\
	    pilot:SetUnit(kGUID,UT_PLAYER,iClass,1,iGender);\n\
		local   kActor = pilot:GetActor();\n\
		kActor:FreeMove(true)\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(kGUID, kActor, kTargetPos, 9);\n\
		kActor:ClearActionState();\n\
		kActor:LockBidirection(false);\n\
			    \n\
	    g_pilotMan:InsertPilot(kGUID,pilot);\n\
		kActor:CopyEquipItem(actor);\n\
		local kAction = kActor:UntransitAction(\"a_idle\");\n\
				\n\
        kActor:SetUnderMyControl(true);\n\
		kActor:SetTargetAlpha(0, 0.5,0.2);\n\
\n\
		kActor:SetAbil(AT_C_MOVESPEED, actor:GetAbil(AT_C_MOVESPEED));\n\
		kActor:FollowActor(actor);\n\
\n\
		kActor:SetAutoDeleteActorTimer(60);\n\
\n\
		actor:SetParam(\"ShadowCopyGuid\", kGUID:GetString());		\n\
	end	    \n\
\n\
end\n\
\n\
\n\
function Skill_InstallSelf_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
        actor:ClearIgnoreEffectList();\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
\n\
        local   kActor = Skill_InstallSelf_GetSkillActor(actor,kAction)\n\
        if kActor ~= nil then\n\
        \n\
	        kActor:SetHide(false);\n\
	        kActor:SetHideShadow(false);            \n\
		else\n\
			ODS(\"Skill_InstallSelf_OnEvent kActor is nil\\n\");        \n\
        end        \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_Lightning_Slash_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Lightning_Slash_OnCastingCompleted(actor, action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Lightning_Slash_Fire(actor,action);\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	actor:SetParam(\"StartTime\",\"\"..g_world:GetAccumTime());\n\
	actor:SetParam(\"MoveSpeed\",\"\"..2000);\n\
\n\
end\n\
function Skill_Lightning_Slash_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Lightning_Slash_Fire\\n\");\n\
	\n\
	action:SetParamInt(10, 0);	\n\
\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
	actor:AttachParticleToPointWithRotate(7220,actor:GetNodeWorldPos(\"char_root\"),\"ef_LightningSlash_01_char_root\", Quaternion(90, Point3(0,0,1)));\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
\n\
	actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,0,0);\n\
\n\
	local   kShadowCopyGUID = actor:GetParam(\"ShadowCopyGuid\");\n\
	if kShadowCopyGUID ~= nil then\n\
		local kShadowGUID =  GUID(kShadowCopyGUID);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local kShadowActotr = g_world:FindActor(kShadowGUID);\n\
\n\
		if kShadowActotr:IsNil() == false then\n\
			kShadowActotr:ReserveTransitAction(\"a_Lightning Slash\");\n\
		end\n\
	end\n\
\n\
end\n\
function Skill_Lightning_Slash_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_Lightning_Slash_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_Lightning_Slash_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = -80;\n\
	kDir:Multiply(fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end	\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Lightning_Slash_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Lightning_Slash_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.1,true,true);\n\
		--g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
		return true\n\
	end\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Lightning_Slash_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Lightning_Slash_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	local iSlot = action:GetCurrentSlot();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	local kLookingDir = actor:GetLookingDir();\n\
\n\
	if 0 == iSlot then\n\
		local fStartTime = tonumber(actor:GetParam(\"StartTime\"));\n\
		\n\
		if true == animDone then\n\
			action:SetSlot(1);\n\
			actor:PlayCurrentSlot();\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			actor:SetParam(\"StartTime\",\"\"..g_world:GetAccumTime());\n\
			actor:AttachParticle(7220,\"char_root\",\"ef_LightningSlash_02_char_root\");\n\
		end\n\
	else\n\
		local fStartTime = tonumber(actor:GetParam(\"StartTime\"));\n\
		kLookingDir:Multiply(2000);\n\
		actor:SetMovingDelta(kLookingDir);\n\
\n\
		if accumTime - fStartTime > 0.05 and 0 == action:GetParamInt(10) then\n\
			if actor:IsUnderMyControl() then\n\
				action:CreateActionTargetList(actor);\n\
\n\
				if IsSingleMode() then\n\
					Skill_Lightning_Slash_HitOneTime(actor,action);\n\
					Skill_Lightning_Slash_OnTargetListModified(actor,action,false);\n\
					return;\n\
				else\n\
					action:BroadCastTargetListModify(actor:GetPilot());	            \n\
				end\n\
\n\
				action:SetParamInt(10,1);\n\
			end\n\
			SkillHelpFunc_PlayHitSound(actor, action);\n\
		end\n\
		\n\
		if accumTime - fStartTime > 0.10 then\n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				nextActionName = action:GetParam(1);\n\
\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				\n\
				action:SetNextActionName(nextActionName)\n\
				return false;				\n\
			else\n\
			\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Lightning_Slash_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	kCurAction:SetParamInt(10,0);\n\
    \n\
	ODS(\"RestoreItemModel Skill_Lightning_Slash_ReallyLeave\\n\");\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 2, false,true);\n\
		g_world:ClearDrawActorFilter()\n\
	end\n\
	\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_Lightning_Slash_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	actor:EndBodyTrail();\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Lightning_Slash_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
") + std::string("			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
		actorTarget:AttachParticleToPointWithRotate(12 + iHitCount, pt,\"ef_LightningSlash_03_char_root\", Quaternion(90, Point3(0,0,1)));\n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_Lightning_Slash_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Lightning_Slash_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Lightning_Slash_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Lightning_Slash_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_CarpetBombing_OnCheckCanEnter(actor,action)\n\
    	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_CarpetBombing_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10, 0)\n\
	\n\
--	Skill_CarpetBombing_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	--actor:IncRotate(fRotationRadian);\n\
end\n\
\n\
--[[\n\
function Skill_CarpetBombing_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_CarpetBombing_Fire\\n\")\n\
	local  kTargetPos;\n\
	local  kTargetPos2;\n\
	local kCarpetNum = 1;\n\
    if actor:IsMyActor() then\n\
\n\
		local	kSkillDef = GetSkillDef(action:GetActionNo());\n\
		if kSkillDef:IsNil() == false then\n\
			local iNeedBaseSkill = kSkillDef:GetAbil(AT_CHILD_SKILL_NUM_01);\n\
			local iUpgradeSkill = actor:CheckSkillExist(iNeedBaseSkill);\n\
\n\
			if 0 ~= iUpgradeSkill then\n\
				kCarpetNum = 2;\n\
			end\n\
		end\n\
    \n\
        --    GUID  .\n\
	    local guid = GUID(\"123\")\n\
	    guid:Generate();\n\
	    action:AddNewGUID(guid);\n\
\n\
		if 2 == kCarpetNum then\n\
			local guid = GUID(\"456\")\n\
			guid:Generate();\n\
			action:AddNewGUID(guid);\n\
		end\n\
	    \n\
	    kTargetPos = Skill_CarpetBombing_FindGenPoint(actor,action)\n\
	    \n\
		action:SetParamInt(6, kCarpetNum); -- \n\
\n\
		if 1 == kCarpetNum then\n\
		    action:SetParamFloat(7,kTargetPos:GetX());\n\
	        action:SetParamFloat(8,kTargetPos:GetY());\n\
			action:SetParamFloat(9,kTargetPos:GetZ());\n\
		elseif 2 == kCarpetNum then\n\
			local	kMovingDir = actor:GetLookingDir();\n\
			local	kMovingDir2 = actor:GetLookingDir();\n\
\n\
			kTargetPos2 = Point3(kTargetPos:GetX(), kTargetPos:GetY(), kTargetPos:GetZ());\n\
			\n\
			kMovingDir:Cross(Point3(0,0,1));\n\
\n\
			kMovingDir:Multiply(70);\n\
			kTargetPos:Add(kMovingDir);\n\
			\n\
			action:SetParamFloat(7,kTargetPos:GetX());\n\
	        action:SetParamFloat(8,kTargetPos:GetY());\n\
			action:SetParamFloat(9,kTargetPos:GetZ());\n\
		\n\
\n\
			kMovingDir2:Cross(Point3(0,0,-1));\n\
			kMovingDir2:Multiply(70);\n\
			kTargetPos2:Add(kMovingDir2);\n\
\n\
			action:SetParamFloat(15,kTargetPos2:GetX());\n\
	        action:SetParamFloat(16,kTargetPos2:GetY());\n\
			action:SetParamFloat(17,kTargetPos2:GetZ());	\n\
			\n\
		end\n\
   	\n\
	else\n\
	\n\
	    --       GUID  .\n\
	    \n\
	    local   kPacket = action:GetParamAsPacket();\n\
		kCarpetNum = kPacket:PopInt();\n\
		action:SetParamInt(6, kCarpetNum); -- \n\
\n\
		local   kGUID = kPacket:PopGuid();\n\
	    action:AddNewGUID(kGUID);\n\
\n\
		if kCarpetNum == 2 then\n\
			local   kGUID = kPacket:PopGuid();\n\
			action:AddNewGUID(kGUID);\n\
		end\n\
	    \n\
	    kTargetPos = Point3(0,0,0);\n\
	    kTargetPos:SetX(kPacket:PopFloat());\n\
	    kTargetPos:SetY(kPacket:PopFloat());\n\
	    kTargetPos:SetZ(kPacket:PopFloat());\n\
\n\
		kTargetPos2 = Point3(0,0,0);\n\
		if kCarpetNum == 2 then\n\
			kTargetPos2:SetX(kPacket:PopFloat());\n\
			kTargetPos2:SetY(kPacket:PopFloat());\n\
			kTargetPos2:SetZ(kPacket:PopFloat());\n\
		end	\n\
	end\n\
	\n\
	--   ,   .\n\
	if kCarpetNum == 1 then\n\
		Skill_CarpetBombing_Create(actor,action,kTargetPos)\n\
	elseif kCarpetNum == 2 then\n\
		Skill_CarpetBombing_Create(actor,action,kTargetPos);\n\
		Skill_CarpetBombing_Create2(actor,action,kTargetPos2);\n\
	end\n\
end\n\
]]--\n\
\n\
function Skill_CarpetBombing_OnOverridePacket(actor,action,packet)\n\
	\n\
--[[	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetActionParam() == AP_FIRE then\n\
		local kCarpetNum = action:GetParamInt(6);\n\
\n\
		local   kGUID2   =  action:GetGUIDInContainer(1);\n\
		packet:PushInt(kCarpetNum);\n\
		local   kGUID   =   action:GetGUIDInContainer(0);\n\
        packet:PushGuid(kGUID);\n\
\n\
		if kCarpetNum == 2 then\n\
			packet:PushGuid(kGUID2);\n\
		end\n\
\n\
        packet:PushFloat(action:GetParamFloat(7));\n\
        packet:PushFloat(action:GetParamFloat(8));\n\
        packet:PushFloat(action:GetParamFloat(9));\n\
\n\
		if kCarpetNum == 2 then\n\
			packet:PushFloat(action:GetParamFloat(15));\n\
	        packet:PushFloat(action:GetParamFloat(16));\n\
		    packet:PushFloat(action:GetParamFloat(17));\n\
		end\n\
		\n\
    end]]--\n\
    \n\
end\n\
\n\
function Skill_CarpetBombing_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	actor:AttachParticle(100,\"p_wp_l_hand\",\"Carpet_Bombing\");\n\
\n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local iInstanceID = GetStatusEffectMan():AddStatusEffectToActor(actor:GetPilotGuid(),\"se_CarpetBombing_Male\",0,1);\n\
		action:SetParamInt(3,iInstanceID);\n\
	else\n\
		local iInstanceID = GetStatusEffectMan():AddStatusEffectToActor(actor:GetPilotGuid(),\"se_CarpetBombing_Female\",0,1);\n\
		action:SetParamInt(3,iInstanceID);\n\
	end\n\
\n\
	if(0 == Config_GetValue(HEADKEY_ETC, SUBKEY_DISPLAY_HELMET)) then --    \n\
		if actor:CheckStatusEffectExist(\"se_hide_face\") then	--  \n\
			actor:HideParts(EQUIP_POS_FACE, false);	--    \n\
		end\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
		\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_CarpetBombing_OnCastingCompleted(actor,action);	\n\
			  	\n\
	return true\n\
end\n\
\n\
function Skill_CarpetBombing_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if 0 == action:GetParamInt(10)  and  action:GetActionParam() ~= AP_CASTING then\n\
		actor:LockBidirection(false);\n\
		actor:SeeFront(true);\n\
\n\
		--     .\n\
		local fRotationRadian = 0;\n\
		local kLastDirection = actor:GetLastDirection();\n\
		if  kLastDirection== DIR_LEFT then\n\
			fRotationRadian = math.pi / 180 * 90;\n\
		elseif kLastDirection == DIR_RIGHT then\n\
			fRotationRadian = math.pi / 180 * -90;\n\
		elseif kLastDirection == DIR_UP then\n\
			fRotationRadian = math.pi / 180 * 180;\n\
		end\n\
\n\
		action:SetParamInt(10, 1);\n\
	end\n\
	\n\
	if animDone == true then	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)			\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_CarpetBombing_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	actor:DetachFrom(100,true);\n\
\n\
	local	kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	iInstanceID = kAction:GetParamInt(3);\n\
	--(  curAction    !!!)\n\
	GetStatusEffectMan():RemoveStatusEffectFromActor2(actor:GetPilotGuid(),iInstanceID);\n\
\n\
	if(0 == Config_GetValue(HEADKEY_ETC, SUBKEY_DISPLAY_HELMET)) then --    \n\
		if actor:CheckStatusEffectExist(\"se_hide_face\") then	--     \n\
			actor:HideParts(EQUIP_POS_FACE, true);	--  \n\
		end\n\
	end\n\
	actor:RestoreLockBidirection();\n\
	return true;\n\
end\n\
\n\
function Skill_CarpetBombing_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return true \n\
end\n\
\n\
function Skill_CarpetBombing_FindGenPoint(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	fDistance = -196;\n\
	local	kTargetPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(fDistance);\n\
	kTargetPos:Add(kMovingDir);\n\
		\n\
	return	kTargetPos;\n\
end\n\
\n\
function Skill_CarpetBombing_GetSkillActor(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetTotalGUIDInContainer() == 0 then\n\
		ODS(\"Skill_CarpetBombing_GetSkillActor action:GetTotalGUIDInContainer() == 0\\n\");\n\
        return nil;\n\
    end    \n\
    \n\
   \n\
    local   kGUID = action:GetGUIDInContainer(0);\n\
    \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    local   kActor = g_world:FindActor(kGUID);\n\
    if kActor:IsNil() == false then \n\
        return  kActor\n\
    end\n\
    \n\
	ODS(\"Skill_CarpetBombing_GetSkillActor g_world:FindActor Failed kGUID:\"..kGUID:GetString()..\"\\n\");\n\
    return  nil;\n\
end\n\
\n\
function Skill_CarpetBombing_GetSkillActor2(actor,action)\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetTotalGUIDInContainer() == 0 then\n\
		ODS(\"Skill_CarpetBombing_GetSkillActor action:GetTotalGUIDInContainer() == 0\\n\");\n\
        return nil;\n\
    end    \n\
    \n\
   \n\
    local   kGUID = action:GetGUIDInContainer(1);\n\
    \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    local   kActor = g_world:FindActor(kGUID);\n\
    if kActor:IsNil() == false then \n\
        return  kActor\n\
    end\n\
    \n\
	ODS(\"Skill_CarpetBombing_GetSkillActor g_world:FindActor Failed kGUID:\"..kGUID:GetString()..\"\\n\");\n\
    return  nil;\n\
end\n\
\n\
--[[\n\
function Skill_CarpetBombing_Create(actor,action,kTargetPos)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetTotalGUIDInContainer() == 0 then\n\
        return\n\
    end\n\
    \n\
    local   kGUID = action:GetGUIDInContainer(0);\n\
\n\
	local   iClass = action:GetAbil(AT_CLASS);\n\
    local   iLevel = action:GetAbil(AT_LEVEL);\n\
    \n\
    ODS(\"\\nSkill_CarpetBombing_Create Action:\"..action:GetID()..\" iClass:\"..iClass..\" iLevel:\"..iLevel..\"\\n\");\n\
	\n\
	local pilot = g_pilotMan:NewPilot(kGUID, iClass, 0)\n\
	if pilot:IsNil() == false then\n\
\n\
		pilot:SetUnit(kGUID,UT_ENTITY,iClass,iLevel,0);\n\
	\n\
		local   kActor = pilot:GetActor();\n\
	    kActor:SetParam(\"Entity_Create_Time\",\"\"..g_world:GetAccumTime());\n\
	\n\
		g_world:AddActor(kGUID, kActor, kTargetPos, 9)\n\
	    if actor:IsMyActor() then\n\
	        kActor:SetUnderMyControl(true);\n\
	    end\n\
\n\
		local   kLookTarget = actor:GetLookingDir();\n\
		kLookTarget:Multiply(40);\n\
		kLookTarget:Add(kTargetPos);\n\
		pilot:GetActor():LookAt(kLookTarget,true);\n\
		ODS(\"\\nPos1 : \"..kLookTarget:GetX() ..\" \".. kLookTarget:GetY()..\" \".. kLookTarget:GetZ()..\"\\n\");\n\
		\n\
		kActor:SetHide(true);	    \n\
\n\
	    g_pilotMan:InsertPilot(kGUID,pilot);\n\
		local   iActionNo = kActor:GetAbil(AT_MON_SKILL_01)\n\
		\n\
		ODS(\"AT_MON_SKILL_01 : \".. iActionNo..\"\\n\");\n\
		\n\
		local kAction = kActor:ReserveTransitActionByActionNo(iActionNo);\n\
		if kAction:IsNil() == false then\n\
			kAction:SetDoNotBroadCast(true);\n\
		\n\
			local kLookDir = actor:GetLookingDir();\n\
			\n\
			kAction:SetParamFloat(11,kLookDir:GetX());\n\
			kAction:SetParamFloat(12,kLookDir:GetY());\n\
			kAction:SetParamFloat(13,kLookDir:GetZ());\n\
    		\n\
			if actor:IsMyActor() then\n\
				Net_C_M_REQ_CREATE_ENTITY(kGUID,iClass,iLevel,kTargetPos);\n\
			end\n\
		else\n\
			ODS(\"Mon Action Creation Failed.\\n\");\n\
		end\n\
	end	\n\
end\n\
\n\
function Skill_CarpetBombing_Create2(actor,action,kTargetPos)	\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetTotalGUIDInContainer() == 0 then\n\
        return\n\
    end\n\
    \n\
    local   kGUID = action:GetGUIDInContainer(1);\n\
\n\
	local   iClass = action:GetAbil(AT_CLASS);\n\
    local   iLevel = action:GetAbil(AT_LEVEL);\n\
    \n\
    ODS(\"\\nSkill_CarpetBombing_Create2 Action:\"..action:GetID()..\" iClass:\"..iClass..\" iLevel:\"..iLevel..\"\\n\");\n\
	\n\
	local pilot = g_pilotMan:NewPilot(kGUID, iClass, 0)\n\
	if pilot:IsNil() == false then\n\
\n\
		pilot:SetUnit(kGUID,UT_ENTITY,iClass,iLevel,0);\n\
	\n\
		local   kActor = pilot:GetActor();\n\
	    kActor:SetParam(\"Entity_Create_Time\",\"\"..g_world:GetAccumTime());\n\
	\n\
		g_world:AddActor(kGUID, kActor, kTargetPos, 9)\n\
	    if actor:IsMyActor() then\n\
	        kActor:SetUnderMyControl(true);\n\
	    end\n\
\n\
		local   kLookTarget = actor:GetLookingDir();\n\
		kLookTarget:Multiply(40);\n\
		kLookTarget:Add(kTargetPos);\n\
		pilot:GetActor():LookAt(kLookTarget,true);\n\
		ODS(\"\\nPos2 : \"..kLookTarget:GetX() ..\" \".. kLookTarget:GetY()..\" \".. kLookTarget:GetZ()..\"\\n\");\n\
		\n\
		kActor:SetHide(true);	    \n\
\n\
	    g_pilotMan:InsertPilot(kGUID,pilot);\n\
		local   iActionNo = kActor:GetAbil(AT_MON_SKILL_01)\n\
		\n\
		ODS(\"AT_MON_SKILL_01 : \".. iActionNo..\"\\n\");\n\
		\n\
		local kAction = kActor:ReserveTransitActionByActionNo(iActionNo);\n\
		if kAction:IsNil() == false then\n\
			kAction:SetDoNotBroadCast(true);\n\
		\n\
			local kLookDir = actor:GetLookingDir();\n\
			\n\
			kAction:SetParamFloat(11,kLookDir:GetX());\n\
			kAction:SetParamFloat(12,kLookDir:GetY());\n\
			kAction:SetParamFloat(13,kLookDir:GetZ());\n\
    		\n\
			if actor:IsMyActor() then\n\
				Net_C_M_REQ_CREATE_ENTITY(kGUID,iClass,iLevel,kTargetPos);\n\
			end\n\
		else\n\
			ODS(\"Mon Action Creation Failed.\\n\");\n\
		end\n\
	end	\n\
end\n\
]]--\n\
\n\
function Skill_CarpetBombing_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
        actor:ClearIgnoreEffectList();\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
\n\
        local   kActor = Skill_CarpetBombing_GetSkillActor(actor,kAction)\n\
        if kActor ~= nil then\n\
        \n\
	        kActor:SetHide(false);\n\
			ODS(\"Skill_CarpetBombing_OnEvent add\\n\");\n\
		else\n\
			ODS(\"Skill_CarpetBombing_OnEvent kActor is nil\\n\");        \n\
        end\n\
\n\
		local kCarpetNum = kAction:GetParamInt(6);\n\
\n\
		if kCarpetNum == 2 then\n\
			local   kActor = Skill_CarpetBombing_GetSkillActor2(actor,kAction)\n\
			if kActor ~= nil then\n\
	        \n\
				kActor:SetHide(false);\n\
				ODS(\"Skill_CarpetBombing_OnEvent add2\\n\");\n\
			else\n\
				ODS(\"Skill_CarpetBombing_OnEvent kActor2 is nil\\n\");        \n\
	        end\n\
		end\n\
        \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_CarpetBombing_Play_OnCastingCompleted(actor, action)\n\
\n\
	Skill_CarpetBombing_Play_Fire(actor,action);\n\
\n\
end\n\
\n\
function Skill_CarpetBombing_Play_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	--ODS(\"Skill_CarpetBombing_Play_Fire\\n\");\n\
    --   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    action:SetParamFloat(2,g_world:GetAccumTime());\n\
    action:SetParamFloat(3,g_world:GetAccumTime());\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"INSTALL_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"INSTALL_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
end\n\
\n\
function Skill_CarpetBombing_Play_StartTimer(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Skill_CarpetBombing_Play_StartTimer\\n\");\n\
    \n\
    if actor:IsUnderMyControl() then\n\
        \n\
        if action:GetScriptParam(\"BOMB_AFTER_LIFETIME\") ~= \"TRUE\" then\n\
        	        \n\
	        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
        	\n\
	        if fLifeTime == 0 then\n\
	            fLifeTime = 10.0;\n\
            end\n\
                \n\
            local   fAttackDelay = 0;\n\
            \n\
            fAttackDelay = action:GetAbil(AT_ATT_DELAY)/1000.0;\n\
            --ODS(\"Action :\"..action:GetID()..\" AttackDelay : \"..fAttackDelay..\" fLifeTime:\"..fLifeTime..\"\\n\");\n\
            if fAttackDelay < 0.05 then\n\
                fAttackDelay = 0.05\n\
            end\n\
            \n\
            --   \n\
            action:StartTimer(fLifeTime,0.3,0)\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
end\n\
\n\
\n\
function Skill_CarpetBombing_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Skill_CarpetBombing_Play_OnEnter\\n\");\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	\n\
	--	State\n\
	action:SetParamInt(4,0)\n\
	\n\
	--	Hit Count\n\
	action:SetParamInt(5,0)\n\
	\n\
	--	Last Hit Time\n\
	action:SetParamFloat(6,0);\n\
	action:SetParamFloat(7,g_world:GetAccumTime() + 0.3);\n\
	action:SetParamInt(8,0);\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 11, kLookDir:GetX() );\n\
	action:SetParamFloat( 12, kLookDir:GetY() );\n\
	action:SetParamFloat( 13, kLookDir:GetZ() );\n\
	\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
\n\
	local kPos = actor:GetPos();\n\
	kPos:SetZ(kPos:GetZ());\n\
	actor:SetTranslate(kPos);\n\
\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	actor:SetTargetScale(0.0001, 0);\n\
	actor:SetHideShadow(true);\n\
	action:SetParamInt(10,action:GetAbil(AT_SKILL_CUSTOM_DATA_01));\n\
\n\
	Skill_CarpetBombing_Play_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_CarpetBombing_Play_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	--ODS(\"Skill_CarpetBombing_Play_OnTargetListModified\\n\");\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
end\n\
\n\
function Skill_CarpetBombing_Play_FindTarget(actor,action,bForceToBomb)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	--ODS(\"Skill_CarpetBombing_Play_FindTarget\\n\");\n\
    action:CreateActionTargetList(actor);\n\
    \n\
    if action:GetTargetCount() > 0 then\n\
    \n\
        if IsSingleMode() or action:GetTargetCount() == 0 then\n\
			\n\
            Skill_CarpetBombing_Play_OnTargetListModified(actor,action,false);    \n\
        \n\
        else\n\
        \n\
            action:BroadCastTargetListModify(actor:GetPilot());\n\
            action:ClearTargetList();\n\
        \n\
        end    \n\
        \n\
        return true;\n\
        \n\
    end\n\
    \n\
    return false\n\
end\n\
\n\
function Skill_CarpetBombing_Play_OnTimer(actor, accumTime, action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	--ODS(\"Skill_CarpetBombing_Play_OnTimer\\n\");\n\
	Skill_CarpetBombing_Play_FindTarget(actor,action);\n\
    \n\
    return true;\n\
\n\
end\n\
\n\
\n\
\n\
function Skill_CarpetBombing_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
	local actionID = action:GetID();\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local fMoveSpeed  = 300;\n\
	local fMaxMoveDistance = action:GetParamInt(10)+10;\n\
	local	iState = action:GetParamInt(4);\n\
	\n\
	if iSlotNum == 0 then		\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
		if fElapsedTime>=0.3 then\n\
			action:SetParamFloat(0,accumTime);	--	   \n\
			\n\
			local	kPos = actor:GetPos();\n\
			--   \n\
			action:SetParamFloat(1,kPos:GetX());\n\
			action:SetParamFloat(2,kPos:GetY());\n\
			action:SetParamFloat(3,kPos:GetZ());\n\
			actor:PlayNext();\n\
			Skill_CarpetBombing_Play_StartTimer(actor,action);\n\
			\n\
		end	\n\
	end\n\
	\n\
	if iSlotNum == 1 then\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
		local	fMoveDistance = fElapsedTime * fMoveSpeed;\n\
		\n\
		if fMoveDistance>=fMaxMoveDistance then\n\
			actor:PlayNext();\n\
		else\n\
		\n\
			local kMovingDir = Point3(action:GetParamFloat(11),action:GetParamFloat(12),action:GetParamFloat(13));\n\
			\n\
			kMovingDir:Multiply(fMoveDistance);\n\
			\n\
			local kNextPos = Point3(action:GetParamFloat(1),action:GetParamFloat(2),action:GetParamFloat(3));\n\
			kNextPos:Add(kMovingDir);\n\
			\n\
			actor:SetTranslate(kNextPos);\n\
		end\n\
	\n\
	end\n\
	\n\
	--    \n\
	local fBoomElapsedTime = accumTime - action:GetParamFloat(7);\n\
	if fBoomElapsedTime >= 0.2 and action:GetParamInt(8) < 6 then		\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local kPos = actor:GetPos();\n\
		kPos:SetZ(kPos:GetZ() + 200);\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			--  .\n\
			ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				return false;\n\
			end			\n\
		end\n\
		actor:AttachSound(200 + action:GetParamInt(8),\"CarpetBombing_Bomb\");\n\
		ptcl:SetY(ptcl:GetY() + math.random(-30,30));\n\
		actor:AttachParticleToPoint(100 + action:GetParamInt(8), ptcl, \"ef_boom_01\");\n\
		action:SetParamFloat(7,g_world:GetAccumTime());\n\
		action:SetParamInt(8,action:GetParamInt(8) + 1);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_CarpetBombing_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Skill_CarpetBombing_Play_OnFindTarget\\n\");\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,80,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_CarpetBombing_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	ODS(\"Skill_CarpetBombing_Play_OnCleanUp\\n\");\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
end\n\
\n\
function Skill_CarpetBombing_Play_OnLeave(actor, action)\n\
	ODS(\"Skill_CarpetBombing_Play_OnLeave\\n\");\n\
	return true;\n\
end\n\
\n\
--         \n\
function CarpetBombingPlayInit(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:SetHideShadow(true);	\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_Gatling_Rush_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Gatling_Rush_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Gatling_Rush_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Gatling_Rush_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	actor:HideParts(5,true);\n\
	actor:HideParts(6,true);\n\
	actor:AttachParticle(7,\"p_wp_l_hand\",\"Gatling_Rush\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_Gatling_Rush_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_Gatling_Rush_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_Gatling_Rush_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 60\n\
		end\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_Gatling_Rush_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Gatling_Rush_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	action:SetParamInt(20, 0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Gatling_Rush_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Gatling_Rush_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if action:GetParamInt(20) > 10 then\n\
		action:SetParam(1, \"end\")\n\
		return false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Gatling_Rush_OnCleanUp(actor)\n\
			\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
    \n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	actor:DetachFrom(7,true);\n\
	actor:HideParts(5,false);\n\
	actor:HideParts(6,false);	\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_Gatling_Rush_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Gatling_Rush_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
		\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
		\n\
--	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_Gatling_Rush_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
			\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Gatling_Rush_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Gatling_Rush_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Gatling_Rush_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local iHitCount = kAction:GetParamInt(20);\n\
		kAction:SetParamInt(20, iHitCount + 1); --   .\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
") + std::string("				if IsSingleMode() then		        \n\
					Skill_Gatling_Rush_HitOneTime(actor,kAction)\n\
					Skill_Gatling_Rush_OnTargetListModified(actor,kAction,false)		            \n\
					return;\n\
				else\n\
					local	kTargetList = kAction:GetTargetList();\n\
					local	iTargetCount = kTargetList:size();\n\
\n\
					if 0 < iTargetCount then\n\
						kAction:BroadCastTargetListModify(actor:GetPilot());\n\
					end\n\
				end			\n\
			\n\
			end	\n\
		end\n\
	\n\
        Skill_Gatling_Rush_HitOneTime(actor,kAction)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Weapon_Break_Fire_OnCastingCompleted(actor, action)\n\
\n\
end\n\
\n\
function Skill_Weapon_Break_Fire_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
\n\
	--action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(9,0);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Weapon_Break_Fire_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Weapon_Break_Fire_OnTargetListModified(actor,action,bIsBefore)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_Weapon_Break_Fire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	local iActionState = action:GetParamInt(9);\n\
\n\
	if 0 == iActionState then\n\
		local   fNextAniPlayTIme = accumTime - action:GetParamFloat(0);\n\
		if fNextAniPlayTIme > 0.5 then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
			action:SetParamInt(9,1);\n\
			action:SetParamFloat(0,accumTime);\n\
		end\n\
	elseif 1 == iActionState then	\n\
		local   fNextAniPlayTIme = accumTime - action:GetParamFloat(0);\n\
		if fNextAniPlayTIme > 4 then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
			action:SetParamInt(9,2);\n\
			action:SetParamFloat(0,accumTime);\n\
			actor:AttachParticle(100,\"p_ef_star\",\"ef_stun_p_ef_star\");\n\
		end\n\
\n\
		local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
		local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
		if fMoveSpeed == 0 then\n\
			fMoveSpeed = 50\n\
		end\n\
		\n\
		kMoveDir:Multiply(fMoveSpeed);\n\
		\n\
		actor:SetMovingDelta(kMoveDir);\n\
		\n\
		local   fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
		if fElapsedTIme>0.3 then\n\
		\n\
			action:SetParamFloat(1,accumTime);\n\
			action:CreateActionTargetList(actor);\n\
		    \n\
			if IsSingleMode() or action:GetTargetCount() == 0 then	    \n\
				Skill_Weapon_Break_Fire_OnTargetListModified(actor,action,false);	    \n\
			else	    \n\
				action:BroadCastTargetListModify(actor:GetPilot());\n\
				action:ClearTargetList();	    \n\
			end	    \n\
		end		\n\
	elseif 2 == iActionState then\n\
		local   fElapsedTIme = accumTime - action:GetParamFloat(0);\n\
		if fElapsedTIme > 1.5 then\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.3);\n\
			action:SetParamInt(9,3);\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Weapon_Break_Fire_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_Weapon_Break_Fire_OnLeave(actor, action)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_NineteenNinety_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
		\n\
	if(true == actor:IsInCoolTime(action:GetActionNo(), false) ) then\n\
		return false\n\
	end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( false == curAction:IsNil() ) then\n\
		local kActionName = curAction:GetID();\n\
		if(\"a_head_spin\" == kActionName or \"a_Windmill\" == kActionName) then\n\
			curAction:SetNextActionName(\"a_Nineteen Ninety\");\n\
			curAction:ChangeToNextActionOnNextUpdate(true, true);\n\
		end\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_NineteenNinety_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	Skill_NineteenNinety_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_NineteenNinety_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParamFloat(3,g_world:GetAccumTime()); --   \n\
	action:SetParamFloat(6,0);\n\
	action:SetParamInt(7,0)	--	Hit Count\n\
	action:SetParamInt(8,2)	--	Max Count\n\
\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	\n\
	if false == actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
		actor:AttachParticle(19002,\"char_root\",\"ef_NineteenNine_01_char_root\");\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
end\n\
\n\
function Skill_NineteenNinety_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	--ODS(\"Skill_NineteenNinety_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\");\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_NineteenNinety_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	--ODS(\"Skill_NineteenNinety_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_NineteenNinety_OnCastingCompleted(actor,action);\n\
\n\
	return true\n\
end\n\
function Skill_NineteenNinety_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = action:GetParamInt(8);\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(7) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        end        \n\
    \n\
    end\n\
end\n\
\n\
function Skill_NineteenNinety_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actionID = action:GetID();\n\
--	local movingSpeed = 0\n\
	local bAnimDone = actor:IsAnimationDone();\n\
	local iSlot = action:GetCurrentSlot();\n\
	local nextActionName = action:GetNextActionName();\n\
\n\
	--ODS(\"Skill_NineteenNinety_OnUpdate NextActionName : \"..nextActionName..\" slot :\" ..iSlot .. \"\\n\");\n\
\n\
	if iSlot == 1 then\n\
	    if bAnimDone then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
	        actor:PlayCurrentSlot();\n\
	        action:SetParamFloat(3,accumTime);\n\
	    end    \n\
    elseif iSlot == 2 then	\n\
		local   fElapsedTime = accumTime - action:GetParamFloat(3);\n\
		--ODS(\"fElapsedTime = \"..fElapsedTime..\"\\n\");\n\
    	if bAnimDone or fElapsedTime > 0.533 then \n\
    	\n\
    	    action:SetSlot(action:GetCurrentSlot()+1);\n\
	        actor:PlayCurrentSlot();\n\
			if false == actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
				actor:DetachFrom(19002,true);\n\
			end\n\
    	end\n\
    else\n\
        if bAnimDone then        \n\
            action:SetParam(1,\"end\");\n\
            return false;        \n\
        end    \n\
    end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_NineteenNinety_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if false == actor:CheckStatusEffectExist(\"se_transform_to_Dancer\") then\n\
		actor:DetachFrom(19002);\n\
	end\n\
	--actor:DetachFrom(19003);\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	return true;\n\
end\n\
\n\
function Skill_NineteenNinety_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_NineteenNinety_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	--          .\n\
	if kAction:GetParamInt(7) >= kAction:GetParamInt(8) then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end	\n\
		end\n\
	\n\
		kAction:SetParamInt(7, kAction:GetParamInt(7) + 1)	--	Hit Count\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_ChainHurricaneKick_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
			\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	actor:AttachParticle(7210,\"p_pt_ride\",\"ef_ChainHurricaneKick_01_p_pt_ride\");\n\
	actor:AttachParticle(7211,\"char_root\",\"ef_ChainHurricaneKick_01_char_root\");\n\
\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(3,g_world:GetAccumTime());\n\
	action:SetParamFloat(4,g_world:GetAccumTime());\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_ChainHurricaneKick_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,50,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
\n\
	local   kMoveDir = actor:GetLookingDir();\n\
	local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
\n\
	fMoveSpeed = fMoveSpeed * 0.7;\n\
	\n\
	kMoveDir:Multiply(fMoveSpeed);	\n\
	actor:SetMovingDelta(kMoveDir);\n\
\n\
	local   fElapsedTIme = accumTime - action:GetParamFloat(4);\n\
	if fElapsedTIme > 0.25 then\n\
\n\
		action:SetParamFloat(4,accumTime);\n\
		action:CreateActionTargetList(actor);\n\
	    \n\
		if IsSingleMode() or action:GetTargetCount() == 0 then\n\
	    \n\
			Skill_ChainHurricaneKick_OnTargetListModified(actor,action,false);\n\
	    \n\
		else\n\
	    \n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:ClearTargetList();\n\
	    \n\
		end\n\
	end\n\
\n\
	local fElapsedTIme2 = accumTime - action:GetParamFloat(3);\n\
	if fElapsedTIme2 > 1.5 then\n\
		actor:DetachFrom(7210,true)\n\
		actor:DetachFrom(7211,true)\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
		   \n\
			return false;				\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:DetachFrom(7210,true)\n\
	actor:DetachFrom(7211,true)\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_ChainHurricaneKick_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	actor:EndBodyTrail();\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return \n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_SpiralCannon_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_SpiralCannon_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_SpiralCannon_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_SpiralCannon_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_SpiralCannon_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Skill_SpiralCannon_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Skill_SpiralCannon_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Skill_SpiralCannon_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Skill_SpiralCannon_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_SpiralCannon_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_SpiralCannon_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_SpiralCannon_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
\n\
	if  iCurrentSlot == 1 then\n\
		if animDone == true then\n\
			action:SetSlot(action:GetCurrentSlot() + 1);\n\
			actor:PlayCurrentSlot();\n\
		end\n\
	else\n\
		if animDone == true then	\n\
		\n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				nextActionName = action:GetParam(1);\n\
\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				\n\
				action:SetNextActionName(nextActionName)\n\
				return false;\n\
			else\n\
			\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_SpiralCannon_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());	\n\
    \n\
	ODS(\"RestoreItemModel Skill_SpiralCannon_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
	    actor:DetachFrom(7212)\n\
	    actor:DetachFrom(7213)\n\
		actor:DetachFrom(7214)	\n\
	end\n\
	\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Skill_SpiralCannon_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_SpiralCannon_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
    	    \n\
	    end\n\
    	\n\
	end\n\
	\n\
\n\
\n\
end\n\
\n\
function Skill_SpiralCannon_HitOneTime(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
	    \n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
	    \n\
	        actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
	    \n\
	    end\n\
	\n\
	\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_SpiralCannon_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_SpiralCannon_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_SpiralCannon_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local iCurrentSlot = kAction:GetCurrentSlot();\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" and iCurrentSlot == 2 then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
				kAction:CreateActionTargetList(actor);						        \n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end	\n\
		end	        \n\
	end\n\
") + std::string("\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Santuary_Play_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());	\n\
	action:SetParamFloat(2,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
	\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(3, 0);\n\
	action:SetParamFloat(8, 70);\n\
	\n\
	Skill_Santuary_Play_OnCastingCompleted(actor, action)\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_Santuary_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,50,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Santuary_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_Santuary_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(3);\n\
	\n\
	local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
	local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
	if fMoveSpeed == 0 then\n\
	    fMoveSpeed = action:GetParamFloat(8);\n\
	end\n\
	\n\
	if iState == 0 and iCurrentSlot == 0 then\n\
		if animDone == true then\n\
			action:SetSlot(1);\n\
			actor:PlayCurrentSlot();\n\
		end\n\
	end\n\
\n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 2.0;\n\
    end	\n\
\n\
    local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
	if iState == 0 and iCurrentSlot == 1 then --    \n\
		local DieAnimTime = actor:GetAnimationLength(action:GetSlotAnimName(2))\n\
		if 0 ~= DieAnimTime and fLifeTime - fTotalElapsedTime < DieAnimTime then--    \n\
			action:SetSlot(2);\n\
			actor:PlayCurrentSlot();\n\
			action:SetParamInt(3, 1);\n\
		elseif fLifeTime - fTotalElapsedTime < 1.0 then\n\
			action:SetParamInt(3, 1);\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.5);\n\
			actor:SetHideShadow(true);\n\
		end\n\
	end\n\
 \n\
	if animDone == true \n\
		and 2 == iCurrentSlot\n\
		and actor:GetAnimationLength(action:GetSlotAnimName(2)) ~= 0 then\n\
		return  false\n\
	end\n\
	if fTotalElapsedTime > fLifeTime then\n\
		return  false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Santuary_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	\n\
	local	kSoundID = nil\n\
	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		StopSoundByID(kSoundID)\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_Santuary_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Santuary_Play_OnCastingCompleted(actor, action)\n\
	local	kSoundID = nil\n\
	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784, kSoundID);\n\
	end\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [CALL_UI_NAME] :  UI \n\
\n\
-- Melee\n\
function Act_Use_UICall_OnCheckCanEnter(actor,action)\n\
	return		true;\n\
end\n\
\n\
function Act_Use_UICall_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Act_Use_UICall_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Act_Use_UICall_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Act_Use_UICall_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
	\n\
end\n\
function Act_Use_UICall_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Act_Use_UICall_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Act_Use_UICall_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,60,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
    	kParam:SetParam_2(0,30,iAttackRange,0);\n\
	\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end\n\
\n\
function Act_Use_UICall_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	local kUIName = action:GetScriptParam(\"CALL_UI_NAME\");\n\
\n\
	if actor:IsMyActor() then\n\
		CallUI(kUIName);\n\
	end\n\
	\n\
	ODS(\"Act_Use_UICall_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Act_Use_UICall_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Use_UICall_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Use_UICall_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
    \n\
	ODS(\"RestoreItemModel Act_Use_UICall_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end\n\
    	\n\
	return true;\n\
end\n\
\n\
function Act_Use_UICall_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Use_UICall_OnTargetListModified(actor,action,bIsBefore)\n\
    \n\
end\n\
\n\
function Act_Use_UICall_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		end	\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_WEAPON_TRAIL] :    \n\
\n\
-- Melee\n\
function WyvernBlade_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function WyvernBlade_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	WyvernBlade_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function WyvernBlade_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	ODS(\"RestoreItemModel WyvernBlade_Fire\\n\");\n\
	\n\
	if actor:IsMyActor() then\n\
		action:StartTimer(3,0.3,0);\n\
	end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
			\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
		\n\
	action:SetParamFloat(3,g_world:GetAccumTime())	--	  \n\
	\n\
	action:SetParamInt(4,1)	--	Start Rotation\n\
	action:SetParamFloat(5,g_world:GetAccumTime())	--	Rotation Start Time\n\
	action:SetParamFloat(6,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(7,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(8,actor:GetLookingDir():GetZ());\n\
	action:SetParamInt(9,0)	--	Hit Count	\n\
	action:SetParamFloat(10,g_world:GetAccumTime());\n\
	action:SetParamFloat(11,actor:GetPos():GetX());\n\
	action:SetParamFloat(12,actor:GetPos():GetY());\n\
	action:SetParamFloat(13,actor:GetPos():GetZ());\n\
\n\
	local iTotalHit = 0;\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
	if kSkillDef:IsNil() == false then\n\
		iTotalHit  = kSkillDef:GetAbil(AT_COUNT);\n\
	end\n\
	action:SetParamInt(30,iTotalHit);\n\
	\n\
	actor:AttachParticle(581,\"char_root\",\"ef_wybernblade_01_char_root\");\n\
	\n\
	actor:AttachSound(2784,\"Wybern_Blade\");\n\
	\n\
end\n\
function WyvernBlade_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
		\n\
        WyvernBlade_HitOneTime(actor,action);\n\
    \n\
    end\n\
\n\
end\n\
\n\
function WyvernBlade_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"WyvernBlade_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	if IsSingleMode() then\n\
    \n\
		WyvernBlade_HitOneTime(actor,action)\n\
		WyvernBlade_OnTargetListModified(actor,action,false)\n\
        \n\
		return true;\n\
	else\n\
    \n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
        \n\
	end			\n\
	\n\
	if actor:IsMyActor() then\n\
		WyvernBlade_HitOneTime(actor,action)\n\
	end\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
function WyvernBlade_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	return	WyvernBlade_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function WyvernBlade_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = Point3(action:GetParamFloat(11),action:GetParamFloat(12),action:GetParamFloat(13) - 20);\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,Point3(0,0,1));\n\
	kParam:SetParam_2(400,iAttackRange*2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
\n\
	local iSkillLevel = action:GetAbil(AT_LEVEL);\n\
	if iSkillLevel <= 4 then\n\
		kParam:SetParam_3(true, FTO_NORMAL + FTO_DOWN + FTO_BLOWUP);\n\
	elseif iSkillLevel <= 2 then\n\
		kParam:SetParam_3(true, FTO_NORMAL + FTO_BLOWUP);\n\
	else\n\
		kParam:SetParam_3(true, FTO_BLOWUP);\n\
	end\n\
	\n\
	local iFound = action:FindTargetsEx(iActionNo,TAT_BAR,kParam,kTargets,kTargets);\n\
	return iFound;\n\
end\n\
\n\
function WyvernBlade_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	action:SetParamFloat(30, g_world:GetAccumTime())\n\
	WyvernBlade_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function WyvernBlade_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	local iTotalHit = action:GetParamInt(30);\n\
\n\
	if actor:IsMyActor() then\n\
		local	bKeyUp = KeyIsDown(KEY_UP);\n\
		local	bKeyDown = KeyIsDown(KEY_DOWN);\n\
		local	bKeyLeft = KeyIsDown(KEY_LEFT);\n\
		local	bKeyRight = KeyIsDown(KEY_RIGHT);\n\
		\n\
		local	iDir = 0\n\
		if bKeyUp then \n\
			iDir = iDir + DIR_UP\n\
		end\n\
		if bKeyDown then\n\
			iDir = iDir + DIR_DOWN\n\
		end\n\
		if bKeyLeft then\n\
			iDir = iDir + DIR_LEFT\n\
		end\n\
		if bKeyRight then\n\
			iDir = iDir + DIR_RIGHT\n\
		end\n\
\n\
		if iDir ~= 0 then\n\
			local iMoveSpeed = actor:GetAbil(AT_C_MOVESPEED) * 0.5\n\
			local kDirection = actor:GetDirectionVector(iDir);\n\
\n\
			kDirection:Multiply(iMoveSpeed);\n\
			actor:SetMovingDelta(kDirection);\n\
			local fTimeDelta = g_world:GetAccumTime() - action:GetParamFloat(30)\n\
			if(fTimeDelta > 0.02) then --       \n\
				g_pilotMan:BroadcastDirection(actor:GetPilot(), iDir)\n\
				action:SetParamFloat(30, g_world:GetAccumTime())\n\
			end\n\
		end\n\
	end	\n\
\n\
	local	fElapsedTime = accumTime - action:GetParamFloat(3);\n\
	if fElapsedTime > 2 or action:GetParamInt(9) >= iTotalHit then\n\
		ODS(\"\\n EndEndEnd \\n\")\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
			\n\
	end\n\
	if action:GetParamInt(9) < iTotalHit then\n\
		--ODS(\"\\n---------- Cur Hit \"..action:GetParamInt(9)..\"     Total \"..iTotalHit..\"    ---------\\n\")\n\
	\n\
		actor:IncRotate(frameTime*5*460.0*3.141592/180.0);\n\
		\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function WyvernBlade_OnCleanUp(actor)\n\
\n\
	ODS(\"RestoreItemModel WyvernBlade_ReallyLeave\\n\");\n\
\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if actor:GetAction():GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function WyvernBlade_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if curParam == \"end\" then \n\
			action:SetSlot(2);\n\
			action:SetDoNotBroadCast(true);\n\
			return true;\n\
		end\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function WyvernBlade_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
	if kActionResult:GetCritical() then\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	else\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	end	\n\
	\n\
\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	\n\
	--   \n\
	\n\
\n\
end\n\
function WyvernBlade_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
\n\
	action:SetParamFloat(10,g_world:GetAccumTime());\n\
	local	iHitCount = action:GetParamInt(9);\n\
	\n\
	ODS(\"WyvernBlade_HitOneTime iHitCount:\"..iHitCount..\"\\n\");\n\
	\n\
	local	iTotalHit = 5;\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(9,iHitCount);\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return	true\n\
	end\n\
end\n\
\n\
function WyvernBlade_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function	Skill_Bro_Adogen_Fire_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_FindTarget(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	local	kTargets = CreateActionTargetList(actor:GetPilotGuid(),action:GetActionInstanceID(),action:GetActionNo());\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	\n\
    kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    kParam:SetParam_2(action:GetSkillRange(0,actor),60,0,0);\n\
    kParam:SetParam_3(true,FTO_NORMAL);\n\
    \n\
    local iFoundNum = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
    \n\
    if iFoundNum == 0 then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetInfo = kTargets:GetTargetInfo(0);\n\
	if kTargetInfo:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetGUID = kTargetInfo:GetTargetGUID();\n\
	if kTargetGUID:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
	if kTargetPilot:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	local	kTargetActor = kTargetPilot:GetActor();\n\
	if kTargetActor:IsNil() then\n\
		return	nil\n\
	end\n\
    \n\
    DeleteActionTargetList(kTargets);\n\
    \n\
    return  kTargetActor;\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	actor:LockBidirection(false);\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );	\n\
	action:SetParamInt(2,1)\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(9, g_world:GetAccumTime()); --  \n\
	action:SetParamInt(10, 1);\n\
	actor:SetParam(\"End\",\"TRUE\"); --     \n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_GetAimingTarget(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetTotalGUIDInContainer() == 0 then\n\
		return nil;\n\
	end\n\
	\n\
	local	kTargetGUID = action:GetGUIDInContainer(0);\n\
	if kTargetGUID:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
	if kTargetPilot:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	local	kTargetActor = kTargetPilot:GetActor();\n\
	if kTargetActor:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	return	kTargetActor;\n\
\n\
end\n\
function Skill_Bro_Adogen_Fire_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if bIsBefore == false then\n\
		ODS(\"Skill_Bro_Adogen_Fire_OnTargetListModified\\n\");\n\
--		Skill_Bro_Adogen_Fire_FireToTarget(actor,action);\n\
	end\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_FireToTarget(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	actor:ResetAnimation();\n\
	action:SetSlot(1)\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_BroadCastFire(actor,action,kTargetPos)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetParamInt(2,1)\n\
	\n\
	if IsSingleMode() then\n\
		Skill_Bro_Adogen_Fire_OnTargetListModified(actor,action,false)\n\
	else\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	\n\
	local   fElapsedTime = accumTime - action:GetParamFloat(9);\n\
	local iState = action:GetParamInt(10);	\n\
	if true == animDone then\n\
		if( iState == 1) then \n\
			actor:SetTargetAlpha(actor:GetAlpha(), 0, 0.2);\n\
			action:SetParamInt(10,2);\n\
			return true;\n\
		elseif iState == 2 then\n\
			if( true == actor:IsAlphaTransitDone()) then\n\
				return false\n\
			end			\n\
		end\n\
	end\n\
	--ODS(\"Skill_Bro_Adogen_Fire_OnUpdate iState:\"..iState..\"\\n\");\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_OnCleanUp(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
		\n\
	if actor:GetParam(\"End\") == \"TRUE\" then		\n\
		return true;\n\
	end\n\
\n\
	return false;\n\
end\n\
\n\
function Skill_Bro_Adogen_Fire_OnEvent(actor,textKey)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
\n\
	--ODS(\"Skill_Bro_Adogen_Fire_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then		\n\
--[[		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end	\n\
]]\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
\n\
		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_Bro_Adogen_Fire_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
\n\
			kAction:BroadCastTargetListModify(actor:GetPilot(),true);\n\
		\n\
			local	kMovingDir = Point3(0,0,0)\n\
			kMovingDir:SetX(kAction:GetParamFloat(4));\n\
			kMovingDir:SetY(kAction:GetParamFloat(5));\n\
			kMovingDir:SetZ(kAction:GetParamFloat(6));\n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			ODS(\"kMovingDir :\"..kMovingDir:GetX()..\",\"..kMovingDir:GetY()..\",\"..kMovingDir:GetZ()..\"\\n\");\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			kArrow:Fire();\n\
		else\n\
			ODS(\"Arrow is nil\\n\");\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
		actor:ClearIgnoreEffectList();					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param Definition\n\
-- 0[int] : Action State (See Action State Definition)\n\
-- 1[int] : Is the weapon hidden currently? ( 0 : Not Hidden 1 : Hidden)\n\
-- 2[int] : Target Actor Count\n\
-- 3[string] : Target Actor GUID\n\
-- 4[float] : Fly Angle\n\
-- 5[int] : Hand Class No\n\
-- 6[int] : Hand Count\n\
-- 7[float] : Hand Gap Angle\n\
-- 8[int] : Hide Hand During Creation Animation ( 0 : Not Hide 1 : Hide)\n\
-- 9[int] : use weapon hide or not\n\
-- 10[int] : Num of Hand Skill Actor Guid \n\
-- 11 ~ 11+HandCount [int] : Hand Skill Actor Guid\n\
\n\
-- Point Param Definition\n\
\n\
-- GUID Container : Target Actor's GUID\n\
\n\
-- Action State\n\
DEATHSNATCH_ACTIONSTATE_WAIT_FIRE_TEXTKEY = 0;\n\
DEATHSNATCH_ACTIONSTATE_WAIT_HAND_REACH_TARGET = 1;\n\
DEATHSNATCH_ACTIONSTATE_WAIT_TARGETLISTMODIFY_PACKET = 2;\n\
DEATHSNATCH_ACTIONSTATE_WAIT_DRAW_ANIM_DONE = 3;\n\
DEATHSNATCH_ACTIONSTATE_FINISHED = 4;\n\
\n\
-- Script Param\n\
-- \"FLY_ANGLE\" : Angle which the hand fly. In Degree (Default : 45)\n\
-- \"HAND_CLASS_NO\" : class no of the hand skill actor\n\
-- \"HAND_COUNT\" : How many hands are going to be fired?(Default : 1)\n\
-- \"HAND_GAP_ANGLE\" : Angle of gap between each hands(Default : 30 degree)\n\
-- \"HIDE_HAND_CREATION_ANIMATION\" : \"TRUE\" or \"FALSE\", do not show hand during creation animation is on going(Default : FALSE)\n\
-- \"HIDE_WEAPON\" : \"TRUE\" or \"FALSE\", hide weapon or not\n\
\n\
------------------------------------------------\n\
-- Event Handling Functions\n\
------------------------------------------------\n\
function Skill_DeathSnatch_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_DeathSnatch_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_DeathSnatch_HideWeapon(actor,action,true);\n\
	Skill_DeathSnatch_CreateAllSkillActor(actor,action);\n\
	Skill_DeathSnatch_InitAllSkillActorAction(actor,action);\n\
	Skill_DeathSnatch_Fire(actor,action);\n\
	\n\
\n\
end\n\
\n\
function Skill_DeathSnatch_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNumSkillActor = Skill_DeathSnatch_GetNumSkillActorGuid(action);\n\
	local	i =0;\n\
	\n\
	while i<iNumSkillActor do\n\
	\n\
		Skill_DeathSnatch_FindTargetAtSkillActor(actor,action,kTargets,i);\n\
		\n\
		i=i+1;\n\
	\n\
	end\n\
\n\
	\n\
	return	kTargets:size();\n\
\n\
end\n\
\n\
function Skill_DeathSnatch_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	Skill_DeathSnatch_LoadScriptParams(actor,action);\n\
	Skill_DeathSnatch_SetActionState(action,DEATHSNATCH_ACTIONSTATE_WAIT_FIRE_TEXTKEY);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_DeathSnatch_OnCastingCompleted(actor,action);\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_DeathSnatch_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local iActionState = Skill_DeathSnatch_GetActionState(action);\n\
	\n\
	if iActionState == DEATHSNATCH_ACTIONSTATE_WAIT_FIRE_TEXTKEY then\n\
		\n\
		--	Nothing to do. Just wait the Fire Text Key event to occur.\n\
	\n\
	elseif iActionState == DEATHSNATCH_ACTIONSTATE_WAIT_HAND_REACH_TARGET then\n\
	\n\
		Skill_DeathSnatch_Update_WaitHandReachTargetActionState(actor,action,accumTime,frameTime);\n\
		\n\
	elseif iActionState == DEATHSNATCH_ACTIONSTATE_WAIT_TARGETLISTMODIFY_PACKET then\n\
		--	Nothing to do. Just wait for the TargetListModify Packet.\n\
		local kWnd = GetUIWnd(\"FRM_CASH_SHOP\")	--  ,     .\n\
		local bEndAction = not kWnd:IsNil()\n\
		if(not bEndAction) then\n\
			kWnd = GetUIWnd(\"FRM_AUCTION_MAIN\")\n\
			bEndAction = not kWnd:IsNil()\n\
		end\n\
		if(bEndAction) then\n\
			actor:PlayNext();\n\
			Skill_DeathSnatch_SetActionState(action,DEATHSNATCH_ACTIONSTATE_WAIT_DRAW_ANIM_DONE);\n\
		end\n\
		\n\
	elseif iActionState == DEATHSNATCH_ACTIONSTATE_WAIT_DRAW_ANIM_DONE then\n\
	\n\
		if false == Skill_DeathSnatch_Update_WaitDrawAnimDoneActionState(actor,action,accumTime,frameTime) then\n\
			return	false\n\
		end\n\
\n\
	elseif iActionState == DEATHSNATCH_ACTIONSTATE_FINISHED then\n\
		return	false;\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DeathSnatch_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_DeathSnatch_DeleteAllSkillActor(actor,actor:GetAction());\n\
	Skill_DeathSnatch_HideWeapon(actor,actor:GetAction(),false);\n\
\n\
	local kTexture = action:GetScriptParam(\"TRAIL_TEXTURE\");\n\
	if nil ~= kTexture and \"\" ~= kTexture then\n\
		actor:EndBodyTrail();\n\
	end\n\
	\n\
	local   kCurAction = actor:GetAction();\n\
	\n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
	\n\
	--   (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        end\n\
    end\n\
	return true;\n\
end\n\
\n\
function Skill_DeathSnatch_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local	iActionState = Skill_DeathSnatch_GetActionState(curAction);\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if iActionState == DEATHSNATCH_ACTIONSTATE_FINISHED then \n\
		return true;\n\
	end\n\
	\n\
\n\
	return false \n\
end\n\
\n\
function Skill_DeathSnatch_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		\n\
		Skill_DeathSnatch_SetAllSkillActorFlyingToStart(actor,action);\n\
		\n\
		actor:PlayNext();\n\
		Skill_DeathSnatch_SetActionState(action,DEATHSNATCH_ACTIONSTATE_WAIT_DRAW_ANIM_DONE);\n\
\n\
		action:GetTargetList():ApplyActionEffects();\n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_DeathSnatch_OnEvent(actor, textKey)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());	\n\
\n\
	if textKey == \"fire\" then\n\
		\n\
		Skill_DeathSnatch_ProcessTextKeyEvent_Fire(actor,actor:GetAction());\n\
	\n\
	elseif textKey == \"hit\" then\n\
	\n\
		Skill_DeathSnatch_ProcessTextKeyEvent_Hit(actor,actor:GetAction());\n\
		\n\
	elseif textKey == \"end\" then\n\
	\n\
		Skill_DeathSnatch_ProcessTextKeyEvent_End(actor,actor:GetAction());\n\
	\n\
	end\n\
\n\
end") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Event Handling Functions\n\
------------------------------------------------\n\
function Skill_DeathSnatchFinish_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnCheckCanEnter(actor,action)\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return 0 end\n\
	if( CheckNil(actor:IsNil()) ) then return 0 end\n\
	\n\
	if( CheckNil(nil==action) ) then return 0 end\n\
	if( CheckNil(action:IsNil()) ) then return 0 end\n\
	\n\
	ODS(\"Skill_DeathSnatchFinish_OnFindTarget\\n\");\n\
	\n\
	kTargets:CopyFromActionGUIDCont(action);\n\
	\n\
	return	kTargets:size();\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_DeathSnatchFinish_OnEnter\\n\");\n\
\n\
	\n\
	if actor:IsMyActor() then\n\
	\n\
		Skill_DeathSnatchFinish_SetTargetsFromDeathSnatch(actor,action,actor:GetAction());\n\
		action:CreateActionTargetList(actor);\n\
		\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	local iState = action:GetParamInt(2);\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	return	false;\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnCleanUp(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnLeave(actor, action)\n\
\n\
	ODS(\"Skill_DeathSnatchFinish_OnLeave\\n\");\n\
\n\
	-- if( CheckNil(nil==actor) ) then return true end\n\
	-- if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	-- if( CheckNil(nil==action) ) then return true end\n\
	-- if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_DeathSnatchFinish_OnEvent(actor,textKey)\n\
\n\
	return	true;\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("\n\
------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Params Definition\n\
-- 0[int] : Current Action State\n\
-- 1[int] : Next Action State\n\
-- 2[float] Fly Start Time\n\
-- 3[int] : Target Count\n\
-- 4[string] : First Target Guid\n\
-- 5[int] : Skill Range\n\
-- 6[int] : Shake Camera When Hand Reach Ground [ 0 : No 1 : Yes]\n\
-- 7[string] : Parent Actor Guid\n\
-- 8[int] : Hide Creation Animation [ 0 : Not Hide 1 : Hide ]\n\
\n\
-- Point Params Definition\n\
-- 0 : Fly Direction\n\
-- 1 : Fly Start Pos\n\
-- 2 : Fly Target Pos\n\
-- 3 : Prev Actor Pos\n\
\n\
-- Action State Definition\n\
-- 0 : Loading\n\
DEATHSNATCHHANDMOVE_ACTIONSTATE_LOADING = 0;\n\
-- 1 : Flying to the Target\n\
DEATHSNATCHHANDMOVE_ACTIONSTATE_FLYING_TO_TARGET = 1;\n\
-- 2 : Attached To The Target\n\
DEATHSNATCHHANDMOVE_ACTIONSTATE_ATTACHED_TO_TARGET = 2;\n\
-- 3 : Flying back to Start Pos\n\
DEATHSNATCHHANDMOVE_ACTIONSTATE_FLYING_TO_START = 3;\n\
-- 4 : Wait\n\
DEATHSNATCHHANDMOVE_ACTIONSTATE_WAIT = 4;\n\
-- 5 : Finished\n\
DEATHSNATCHHANDMOVE_ACTIONSTATE_FINISHED = 5;\n\
\n\
\n\
------------------------------------------------\n\
-- Event Handling Functions\n\
------------------------------------------------\n\
function Skill_DeathSnatchHandMove_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:FreeMove(true);\n\
\n\
	Skill_DeathSnatchHandMove_StartLoadingState(actor,action);	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DeathSnatchHandMove_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if false == Skill_DeathSnatchHandMove_UpdateCurrentState(actor,action,accumTime) then\n\
		return	false\n\
	end\n\
	\n\
	Skill_DeathSnatchHandMove_UpdateNextState(actor,action,accumTime);\n\
		\n\
	return true\n\
end\n\
\n\
function Skill_DeathSnatchHandMove_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
	actor:EndBodyTrail();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_DeathSnatchHandMove_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local actionID = action:GetID()\n\
	local	iCurrentActionState = Skill_DeathSnatchHandMove_GetCurrentActionState(curAction);\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if iCurrentActionState ==  DEATHSNATCHHANDMOVE_ACTIONSTATE_FINISHED then \n\
		return true;\n\
	end\n\
	\n\
\n\
	return false \n\
end\n\
\n\
function Skill_DeathSnatchHandMove_OnCastingCompleted(actor,action)\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_RollingGround_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return true;	\n\
end\n\
\n\
function Skill_RollingGround_OnCastingCompleted(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	Skill_RollingGround_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_RollingGround_Fire(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(2, g_world:GetAccumTime()); --   \n\
	action:SetParamFloat(6,0);	--   \n\
	action:SetParamInt(9,0);	--	Hit Count\n\
	action:SetParamInt(30, action:GetAbil(AT_COUNT))	--	Max Count\n\
	action:SetParamAsPoint(11, actor:GetLookingDir()); --  \n\
	action:SetParamAsPoint(12, actor:GetPos()); --   \n\
	actor:AttachSound(99, \"RollingGround\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
		--actor:AttachParticle(29913, \"char_root\", \"ef_skill_rollingground_02_char_root\");\n\
	end\n\
end\n\
\n\
function Skill_RollingGround_OnEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
	--	\n\
		return	true;\n\
	end\n\
\n\
	Skill_RollingGround_OnCastingCompleted(actor,action);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_RollingGround_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local bAnimDone = actor:IsAnimationDone();\n\
	local iSlot = action:GetCurrentSlot();\n\
	local nextActionName = action:GetNextActionName();\n\
\n\
	--ODS(\"Skill_NineteenNinety_OnUpdate NextActionName : \"..nextActionName..\" slot :\" ..iSlot .. \"\\n\");\n\
\n\
	if iSlot == 1 then\n\
	    if bAnimDone then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
	        actor:PlayCurrentSlot();\n\
			if actor:IsMyActor() then\n\
				--   .     .\n\
				local fLimitDist = action:GetAbil(AT_MOVE_RANGE);\n\
				local fSpeed = action:GetAbil(AT_MOVESPEED);\n\
				local fMoveTime = fLimitDist / fSpeed;\n\
				action:StartTimer(fMoveTime,fMoveTime / action:GetParamInt(30),0);\n\
			end\n\
	    end    \n\
    elseif iSlot == 2 then	\n\
		actor:AttachParticle(29912, \"char_root\", \"ef_skill_rollingground_01_char_root\");\n\
		--actor:AttachParticle(29914, \"char_root\", \"ef_skill_rollingground_03_char_root\");\n\
		actor:AttachParticleToPointWithRotate(29914, actor:GetNodeWorldPos(\"char_root\"), \"ef_skill_rollingground_03_char_root\", actor:GetRotateQuaternion());\n\
		local StartPos = action:GetParamAsPoint(12);\n\
		local NowPos = actor:GetPos();\n\
		StartPos:SetZ(0);\n\
		NowPos:SetZ(0);\n\
		\n\
		--    \n\
		local fNowDist = NowPos:Distance(StartPos);\n\
		local fElapsedTime = accumTime - action:GetParamFloat(2);\n\
		\n\
		--  , ,   .\n\
		local fLimitDist = action:GetAbil(AT_MOVE_RANGE);\n\
		local fSpeed = action:GetAbil(AT_MOVESPEED);\n\
		local fMoveTime = fLimitDist / fSpeed;\n\
\n\
		--    .\n\
		if ( fNowDist < fLimitDist ) then\n\
			--    \n\
			local fMoveDist = fLimitDist / fMoveTime * fElapsedTime;\n\
			if fMoveDist > fLimitDist then\n\
				fMoveDist = fLimitDist - fNowDist --      .\n\
			else\n\
				fMoveDist = fMoveDist - fNowDist --     .\n\
			end\n\
			local kMovingDir = action:GetParamAsPoint(11)\n\
			kMovingDir:Multiply(fMoveDist);\n\
			actor:SetMovingDelta(kMovingDir);\n\
		end\n\
		\n\
		--  .   .\n\
		if fElapsedTime > fMoveTime then\n\
			actor:DetachFrom(29912);\n\
			actor:DetachFrom(29914);\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
		end\n\
    else\n\
        if bAnimDone then        \n\
            action:SetParam(1,\"end\");\n\
            return false;        \n\
        end    \n\
    end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_RollingGround_OnCleanUp(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:DetachFrom(29912);\n\
	actor:DetachFrom(29914);\n\
	--actor:DetachFrom(29913);\n\
	return true;\n\
end\n\
\n\
function Skill_RollingGround_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_RollingGround_OnEvent(actor,textKey)\n\
	return true;\n\
end\n\
\n\
function Skill_RollingGround_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        --  .\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
    end\n\
end\n\
\n\
\n\
function Skill_RollingGround_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Skill_RollingGround fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	local	iHitCount = action:GetParamInt(9);\n\
	local	iTotalHit = action:GetParamInt(30);	\n\
	if iHitCount == iTotalHit then\n\
		return true\n\
	end\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	if 0 < iTargetCount then\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(9,iHitCount);\n\
	\n\
	return	true	\n\
end") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param Definition\n\
-- 0[int] : Action State (See Action State Definition)\n\
\n\
-- Action State\n\
TIMEFREEZE_ACTIONSTATE_PLAYING=0\n\
TIMEFREEZE_ACTIONSTATE_DONE=1\n\
\n\
\n\
------------------------------------------------\n\
-- Event Handling Functions\n\
------------------------------------------------\n\
function Skill_TimeFreeze_OnCheckCanEnter(actor,action)\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_TimeFreeze_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_TimeFreeze_Fire(actor,action);\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iSkillRange = Skill_TimeFreeze_GetSkillRange(actor,action);\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetPos(),Point3(0,0,0));\n\
	kParam:SetParam_2(0,0,iSkillRange,0);\n\
	kParam:SetParam_3(true,0);		\n\
\n\
	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	Skill_TimeFreeze_SetActionState(action,TIMEFREEZE_ACTIONSTATE_PLAYING);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_TimeFreeze_OnCastingCompleted(actor,action);\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_TimeFreeze_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	local	bAnimDone = actor:IsAnimationDone();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local iActionState = Skill_TimeFreeze_GetActionState(action);\n\
	\n\
	if iActionState == TIMEFREEZE_ACTIONSTATE_PLAYING then\n\
	\n\
		if bAnimDone then\n\
			Skill_TimeFreeze_SetActionState(action,TIMEFREEZE_ACTIONSTATE_DONE);\n\
		end\n\
			\n\
	\n\
	elseif iActionState == TIMEFREEZE_ACTIONSTATE_DONE then\n\
	\n\
		return	false;\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_TimeFreeze_OnCleanUp(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	Skill_TimeFreeze_DetachCircleEffects(actor,actor:GetAction());\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_TimeFreeze_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local	iActionState = Skill_TimeFreeze_GetActionState(curAction);\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if iActionState == TIMEFREEZE_ACTIONSTATE_DONE then \n\
		return true;\n\
	end\n\
	\n\
\n\
	return false \n\
end\n\
\n\
function Skill_TimeFreeze_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		\n\
		action:GetTargetList():ApplyActionEffects();\n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_OnEvent(actor, textKey)\n\
\n\
	if textKey == \"fire\" then\n\
		\n\
		Skill_TimeFreeze_ProcessTextKeyEvent_Fire(actor,actor:GetAction());\n\
	\n\
	elseif textKey == \"hit\" then\n\
	\n\
		Skill_TimeFreeze_ProcessTextKeyEvent_Hit(actor,actor:GetAction());\n\
		\n\
	end\n\
\n\
end\n\
\n\
------------------------------------------------\n\
-- Implementation Functions\n\
------------------------------------------------\n\
function Skill_TimeFreeze_ProcessTextKeyEvent_Hit(actor,action)\n\
\n\
	Skill_TimeFreeze_ProcessTextKeyEvent_Fire(actor,action);\n\
\n\
end\n\
function Skill_TimeFreeze_ProcessTextKeyEvent_Fire(actor,action)\n\
\n\
	Skill_TimeFreeze_CreateActionTargetList(actor,action);\n\
	Skill_TimeFreeze_RequestTargetListModify(actor,action);\n\
	Skill_TimeFreeze_AttachFireEffects(actor,action)\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_CreateActionTargetList(actor,action)\n\
\n\
	if actor:IsMyActor() == false then\n\
		return\n\
	end\n\
\n\
	action:CreateActionTargetList(actor);\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_RequestTargetListModify(actor,action)\n\
\n\
	if actor:IsMyActor() == false then\n\
		return\n\
	end\n\
\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	action:ClearTargetList();\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_AttachFireEffects(actor,action)\n\
\n\
	actor:AttachParticle(71022,\"char_root\",\"ef_skill_timefreeze_01_char_root\");\n\
	\n\
	if actor:IsMyActor() then\n\
		actor:AttachParticle(71024,\"char_root\",\"ef_flash_01\");\n\
		actor:SetParticleAlphaGroup(71024,-8);\n\
	end\n\
\n\
end\n\
function Skill_TimeFreeze_AttachCircleEffects(actor,action)\n\
\n\
	actor:AttachParticle(71023,\"char_root\",\"ef_skill_timefreeze_02_char_root\");\n\
\n\
end\n\
function Skill_TimeFreeze_DetachCircleEffects(actor,action)\n\
\n\
	actor:DetachFrom(71023);\n\
\n\
end\n\
\n\
function Skill_TimeFreeze_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_TimeFreeze_AttachCircleEffects(actor,action);\n\
\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
\n\
function Skill_TimeFreeze_GetSkillRange(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	return	iAttackRange;\n\
end\n\
\n\
------------------------------------------------\n\
-- Parameter Set/Get Functions\n\
------------------------------------------------\n\
\n\
function Skill_TimeFreeze_SetActionState(action,iState)\n\
\n\
	action:SetParamInt(0,iState);\n\
\n\
end\n\
function Skill_TimeFreeze_GetActionState(action)\n\
\n\
	return	action:GetParamInt(0);\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Knight_Bro_Spin_Fire_OnCastingCompleted(actor, action)\n\
\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
\n\
	if actor:IsUnderMyControl() then\n\
		action:StartTimer(1.5,0.3,0);\n\
	end\n\
	\n\
	action:SetParamInt(10,0); -- count\n\
	action:SetParamInt(11, action:GetAbil(AT_COUNT)); -- MaxCount\n\
		\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	action:SetParamFloat(13,actor:GetPos():GetX());\n\
	action:SetParamFloat(14,actor:GetPos():GetY());\n\
	action:SetParamFloat(15,actor:GetPos():GetZ());\n\
	\n\
	--action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(9,0);\n\
	\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	local	pt = actor:GetNodeTranslate(\"char_root\");\n\
	actor:AttachParticleToPoint(581,pt,\"ef_Bro_Spin_char_root\");\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_Knight_Bro_Spin_Fire_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	local	iHitCount = action:GetParamInt(10);\n\
	local	iTotalHit = action:GetParamInt(11);\n\
	ODS(\"hit:\".. iHitCount..\"\\n\");\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
\n\
	action:CreateActionTargetList(actor);\n\
		\n\
	ODS(\" :\".. action:GetTargetCount()..\"\\n\");\n\
		\n\
	if IsSingleMode() then\n\
    	Skill_Knight_Bro_Spin_Fire_OnTargetListModified(actor,action,false)\n\
    	return true;\n\
	else\n\
		\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
\n\
		if 0 < iTargetCount then\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:ClearTargetList();\n\
		end\n\
	end	\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(10,iHitCount);\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return	true\n\
	end	\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	Skill_Knight_Bro_Spin_Fire_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = Point3(action:GetParamFloat(13),action:GetParamFloat(14),action:GetParamFloat(15) - 30);\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,Point3(0,0,1));\n\
	kParam:SetParam_2(400,iAttackRange*2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP + FTO_NORMAL);\n\
\n\
	local iFound = action:FindTargetsEx(iActionNo,TAT_BAR,kParam,kTargets,kTargets);\n\
	return iFound;\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnTargetListModified(actor,action,bIsBefore)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	local iActionState = action:GetParamInt(9);\n\
	--  \n\
	actor:SetMovingDelta(Point3(0,0,12));\n\
	--\n\
	local DegToRadUnit = 3.141592/180.0;\n\
	local SpinScalar = 4*360\n\
			\n\
	local   fElapsedTime = accumTime - action:GetParamFloat(0);\n\
	\n\
	actor:IncRotate(frameTime*SpinScalar*DegToRadUnit);\n\
\n\
	if fElapsedTime> 1.0 then\n\
		if( iActionState == 0) then\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.7);\n\
			action:SetParamInt(9,1);\n\
			actor:DetachFrom(581)\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_Knight_Bro_Spin_Fire_OnLeave(actor, action)\n\
	actor:FreeMove(false);\n\
	actor:StopJump();\n\
	actor:DetachFrom(581)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Bro_Spin_Fire_OnCastingCompleted(actor, action)\n\
\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
\n\
	if actor:IsUnderMyControl() then\n\
		action:StartTimer(1.5,0.3,0);\n\
	end\n\
	\n\
	action:SetParamInt(10,0); -- count\n\
	local iMaxHit = action:GetAbil(AT_COUNT)\n\
	if(0 == iMaxHit) then\n\
		iMaxHit = 4\n\
	end\n\
	action:SetParamInt(11, iMaxHit); -- MaxCount\n\
		\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	action:SetParamFloat(13,actor:GetPos():GetX());\n\
	action:SetParamFloat(14,actor:GetPos():GetY());\n\
	action:SetParamFloat(15,actor:GetPos():GetZ());\n\
	\n\
	--action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(9,0);\n\
	\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	\n\
	local	pt = actor:GetNodeTranslate(\"char_root\");\n\
	actor:AttachParticleToPoint(581,pt,\"ef_Bro_Spin_char_root\");\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_Bro_Spin_Fire_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
\n\
	local	iHitCount = action:GetParamInt(10);\n\
	local	iTotalHit = action:GetParamInt(11);\n\
	ODS(\"hit:\".. iHitCount..\"\\n\");\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
\n\
	action:CreateActionTargetList(actor);\n\
		\n\
	ODS(\" :\".. action:GetTargetCount()..\"\\n\");\n\
		\n\
	if IsSingleMode() then\n\
    	Skill_Bro_Spin_Fire_OnTargetListModified(actor,action,false)\n\
    	return true;\n\
	else\n\
		\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
\n\
		if 0 < iTargetCount then\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:ClearTargetList();\n\
		end\n\
	end	\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(10,iHitCount);\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return	true\n\
	end	\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	Skill_Bro_Spin_Fire_FindTargetEx(actor,action,action:GetActionNo(),action:GetSkillRange(0,actor),kTargets);\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = Point3(action:GetParamFloat(13),action:GetParamFloat(14),action:GetParamFloat(15) - 30);\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,Point3(0,0,1));\n\
	kParam:SetParam_2(400,iAttackRange*2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP + FTO_NORMAL);\n\
\n\
	local iFound = action:FindTargetsEx(iActionNo,TAT_BAR,kParam,kTargets,kTargets);\n\
	return iFound;\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnTargetListModified(actor,action,bIsBefore)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	if bIsBefore == false then\n\
        Actor_PC_Base_DoDefaultMeleeAttack(actor,action,0,false);\n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	local iActionState = action:GetParamInt(9);\n\
	--  \n\
	actor:SetMovingDelta(Point3(0,0,12));\n\
	--\n\
	local DegToRadUnit = 3.141592/180.0;\n\
	local SpinScalar = 4*360\n\
			\n\
	local   fElapsedTime = accumTime - action:GetParamFloat(0);\n\
	\n\
	actor:IncRotate(frameTime*SpinScalar*DegToRadUnit);\n\
\n\
	if fElapsedTime> 1.0 then\n\
		if( iActionState == 0) then\n\
			actor:SetTargetAlpha(0, 0.7);\n\
			action:SetParamInt(9,1);\n\
			actor:DetachFrom(581)\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_Bro_Spin_Fire_OnLeave(actor, action)\n\
	actor:FreeMove(false);\n\
	actor:StopJump();\n\
	actor:DetachFrom(581)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Blink_OnCheckCanEnter(kActor,kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
\n\
	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
\n\
	return		true\n\
	\n\
end\n\
\n\
function Skill_Blink_OnCastingCompleted(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	Skill_Blink_Fire(kActor,kAction)\n\
end\n\
\n\
function Skill_Blink_Fire(kActor,kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	ODS(\"RestoreItemModel Skill_Blink_Fire\\n\")\n\
\n\
	kAction:CreateActionTargetList(kActor)\n\
\n\
	kAction:SetParamAsPoint(6, kActor:GetLookingDir())\n\
	\n\
	kActor:StopJump()	\n\
	local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2784,kSoundID)\n\
	end\n\
	--kActor:AttachParticleToPointWithRotate(7212,kActor:GetNodeWorldPos(\"p_ef_heart\"), \"ef_show_01_p_ef_heart\", kActor:GetRotateQuaternion())\n\
end\n\
\n\
function Skill_Blink_OnFindTarget(kActor,kAction,kTargets)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local  iAttackRange = kAction:GetSkillRange(0,kActor)\n\
	\n\
	--ODS(\"Skill_WindMill_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\")\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = kActor:GetPos()\n\
	local	kDir = kActor:GetLookingDir()\n\
	local	fBackDistance = 10\n\
	kDir:Multiply(-fBackDistance)\n\
	kPos:Add(kDir)\n\
\n\
	local kParam = FindTargetParam()\n\
	\n\
    local iFindTargetType = TAT_SPHERE\n\
	kParam:SetParam_1(kActor:GetPos(),kActor:GetLookingDir())\n\
	kParam:SetParam_2(0,0,iAttackRange,0)\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL)\n\
	local iTargets = kAction:FindTargets(iFindTargetType,kParam,kTargets,kTargets)\n\
	\n\
	return iTargets\n\
end\n\
\n\
function Skill_Blink_OnTargetListModified(kActor,kAction,bIsBefore)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    ODS(\"Skill_WindMill_OnTargetListModified\\n\")\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        SkillHelpFunc_DefaultHitOneTime(kActor,kAction, true);\n\
    end\n\
end\n\
\n\
function Skill_Blink_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
--	local actorID = kActor:GetID()\n\
	local actionID = kAction:GetID()\n\
--	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
	ODS(\"Skill_Blink_OnEnter actionID:\"..actionID..\" GetActionParam:\"..kAction:GetActionParam()..\"\\n\")	\n\
	kAction:SetParamInt(0, 0)\n\
	kAction:SetParamAsPoint(100, kActor:GetPos())\n\
	\n\
	local fMaxMoveDist = kAction:GetAbil(AT_C_MOVESPEED)\n\
	if(0 == fMaxMoveDist) then \n\
		fMaxMoveDist = 100\n\
	end\n\
	kAction:SetParamFloat(101, fMaxMoveDist)\n\
	\n\
	local fSpeed = kAction:GetAbil(AT_SKILL_MAXIMUM_SPEED)\n\
	if(0 == fSpeed) then \n\
		fSpeed = 500\n\
	end\n\
	kAction:SetParamFloat(300, fSpeed)\n\
	local fHeightLimit = jumpForce * 0.7\n\
	kAction:SetParamFloat(301, fHeightLimit) --   \n\
	\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
	kActor:PlayCurrentSlot()\n\
	\n\
	return true\n\
end\n\
\n\
--[[\n\
function Skill_Blink_CalcResultPos(kActor, kBeginPos, kMoveDir, fDist)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())	\n\
	local kAction = kActor:GetAction()	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	kMoveDir:Multiply(fDist)\n\
	kMoveDir:Add(kBeginPos)	\n\
	local kResult = kMoveDir\n\
	\n\
	return kResult\n\
end\n\
]]\n\
\n\
function Skill_Blink_OnUpdate(kActor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
--	local actorID = kActor:GetID()\n\
	local kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
--	ODS(\":\"..kAction:GetParamInt(0)..\"\\n\", false, 912)\n\
	\n\
--	local animDone = kActor:IsAnimationDone()\n\
	local fSpeed = kAction:GetParamFloat(300)\n\
	--if(animDone == true) then\n\
		if(kAction:GetParamInt(0) == 1) then\n\
			Skill_Blink_OnCastingCompleted(kActor,kAction)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			kAction:SetParamFloat(200, g_world:GetAccumTime()) --    \n\
			kAction:SetParamInt(0,2)\n\
			kActor:SetHide(true)\n\
		elseif(kAction:GetParamInt(0) == 2) then \n\
			local kBeginPos = kAction:GetParamAsPoint(100)\n\
			\n\
			local kNewPos = kActor:GetPos()\n\
			local fDistance = kNewPos:Distance(kBeginPos)\n\
			local fMaxMoveDist = kAction:GetParamFloat(101)\n\
			local kMoveDir = kAction:GetParamAsPoint(6)\n\
			kMoveDir:Multiply(-1)\n\
			\n\
			if(0 < fDistance) then	-- fSpeed \n\
				local fRemainDistance = fMaxMoveDist - fDistance\n\
				fSpeed = fRemainDistance/frameTime --  = /\n\
			end\n\
\n\
			local fDist = kNewPos:Distance(kBeginPos)			\n\
			ODS(\"dist:\"..fDist..\" MaxDist:\"..fMaxMoveDist..\"\\n\",false, 912)\n\
						\n\
			local   fElasepdTime = accumTime - kAction:GetParamFloat(200)\n\
			if(fDist >= fMaxMoveDist or fElasepdTime >= 0.2) then --    0.1   0.2 \n\
				ODS(\"\"..fElasepdTime..\"\\n\",false, 912)\n\
				kAction:SetParam(1, \"end\")\n\
				kActor:AttachParticleToPointWithRotate(7213,kActor:GetNodeWorldPos(\"p_ef_heart\"), \"ef_show_01_p_ef_heart\", kActor:GetRotateQuaternion())\n\
				return false\n\
			end\n\
			\n\
			kMoveDir:Multiply(fSpeed)\n\
			kActor:SetMovingDelta(kMoveDir)\n\
			\n\
		elseif(kAction:GetParamInt(0) == 3) then\n\
			ODS(\"~!!!\\n\", false, 912)\n\
			--   \n\
			local kTargetPos = kAction:GetParamAsPoint(7)\n\
			kActor:SetTranslate(kTargetPos, false)\n\
			kAction:SetParam(1, \"end\")\n\
			kActor:AttachParticleToPointWithRotate(7213,kTargetPos, \"ef_show_01_p_ef_heart\", kActor:GetRotateQuaternion())\n\
			return false			\n\
		end	\n\
	--end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Blink_OnCleanUp(kActor)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
\n\
	local	kAction = kActor:GetAction()	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
--	kActor:DetachFrom(7212)\n\
--	kActor:DetachFrom(7213)\n\
	kActor:SetHide(false)\n\
	return true\n\
end\n\
\n\
function Skill_Blink_OnLeave(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local curAction = kActor:GetAction()\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = kAction:GetID()\n\
	\n\
	if kActor:IsMyActor() == false then\n\
		return true\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false\n\
	end\n\
	\n\
	if kAction:GetActionType()==\"EFFECT\" then\n\
		return true\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_Blink_OnEvent(kActor,textKey)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
	local kAction = kActor:GetAction()\n\
		\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	local fHeightLimit = kAction:GetParamFloat(301) --   \n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		kActor:AttachParticleToPointWithRotate(7212,kActor:GetNodeWorldPos(\"p_ef_heart\"), \"ef_show_01_p_ef_heart\", kActor:GetRotateQuaternion())\n\
		local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2783,kSoundID);\n\
		end	\n\
	\n\
		--     \n\
		local fMaxMoveDist = kAction:GetParamFloat(101)	-- \n\
		local kReverseDir = kActor:GetLookingDir()	kReverseDir:Multiply(-1)	--  \n\
		local kPos = kActor:GetPos()\n\
		kPos:SetZ(kPos:GetZ()+fHeightLimit)\n\
		\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, kReverseDir, fMaxMoveDist,3) --   \n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then	--  			\n\
			local kTemp = kReverseDir\n\
			kTemp:Multiply(fMaxMoveDist)\n\
			kTemp:Add(kActor:GetPos())		 --   \n\
			kTemp:SetZ(kTemp:GetZ()+fHeightLimit) --   			\n\
			ptcl = g_world:ThrowRay(kTemp, Point3(0,0,-1), 500,3)	--   \n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				--   \n\
				ptcl = g_world:ThrowRay(kTemp, Point3(0,0,1),500,3);\n\
				if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				--   MoveDelta \n\
					kAction:SetParamInt(0, 1)\n\
					return true\n\
				end\n\
			end\n\
			-- \n\
			ptcl:SetZ(ptcl:GetZ()+30) --   \n\
			kAction:SetParamAsPoint(7, ptcl) -- \n\
			kAction:SetParamInt(0, 3) --   \n\
		else\n\
			--   fMaxMoveDist     MoveDelta \n\
			kAction:SetParamInt(0, 1)\n\
			return true\n\
		end\n\
	end\n\
	\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_COUNT] :   ( 2,3 )\n\
\n\
function TwoActionFire_OnCheckCanEnter(actor,action)\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function TwoActionFire_OnCastingCompleted(actor, action)\n\
	TwoActionFire_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+3);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function TwoActionFire_Fire(actor,action)\n\
	action:SetParamInt(5,3)\n\
\n\
end\n\
\n\
function TwoActionFire_OnEnter(actor, action)\n\
	if actor:IsMyActor() == true then\n\
	\n\
		action:SetParamInt(6,0);	--	   3 .      \n\
	\n\
\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	TwoActionFire_OnCastingCompleted(actor,action);\n\
	\n\
	actor:StopJump();\n\
	\n\
	return true\n\
end\n\
function TwoActionFire_OnFindTarget(actor,action,kTargets)\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 350\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 30;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local	arrow_worldpos = actor:GetPos();--kNewArrow:GetWorldPos();	--	 \n\
	\n\
--  \n\
	local	kRotateAxis = Point3(0,0,1)\n\
	local	fRotateAngle = 30.0*math.pi/180.0;\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,30,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);		\n\
\n\
	local	kFireTarget = actor:GetLookingDir()\n\
\n\
    --SetBreak();\n\
	kFireTarget:Rotate(kRotateAxis,fRotateAngle*(-1))\n\
	kParam:SetParam_1(arrow_worldpos,kFireTarget);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	kFireTarget = actor:GetLookingDir()\n\
	kFireTarget:Rotate(kRotateAxis,fRotateAngle*(0));\n\
	kParam:SetParam_1(arrow_worldpos,kFireTarget);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	kFireTarget = actor:GetLookingDir()\n\
	kFireTarget:Rotate(kRotateAxis,fRotateAngle*(1));\n\
	kParam:SetParam_1(arrow_worldpos,kFireTarget);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
end\n\
\n\
function TwoActionFire_FindTargets(actor,action)\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function TwoActionFire_LoadToPos(actor,action,pos)\n\
\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	kNewArrow:LoadToPosition(pos);\n\
	kNewArrow:SetScale(0.7);\n\
	\n\
	return	kNewArrow;\n\
end\n\
\n\
function TwoActionFire_OnUpdate(actor, accumTime, frameTime)	\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	local	actionID = action:GetID();\n\
	if action:GetParam(300) == \"finish\" then\n\
		return	false;\n\
	end\n\
	if actor:IsMyActor() and action:GetParamInt(6) == 0 then\n\
		if KeyIsDown(action:GetActionKeyNo(0)) == false then\n\
			action:SetParamInt(6,3);\n\
		end\n\
	end\n\
\n\
	if animDone == true then\n\
		\n\
		if actor:IsMyActor() and actor:GetAction():GetParamInt(6) == 0 then	--	   .    \n\
			action:SetNextActionName(\"a_magician_charge_laser\");\n\
		end	\n\
			\n\
		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(3);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(3, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(3, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function TwoActionFire_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function TwoActionFire_OnLeave(actor, action)\n\
	local	curAction = actor:GetAction();\n\
	local	curParam = curAction:GetParam(3)\n\
	local	actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" or curAction:GetParam(300)==\"finish\" then\n\
		return true;\n\
	end	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(3,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
---------------------------------------------------------------\n\
\n\
function TwoActionFire_DoEffect(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    actor:FreeMove(false);\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then	--	 DB  ...\n\
		iAttackRange = 200\n\
	end\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = TwoActionFire_LoadArrowToWeapon(actor,action);\n\
					\n\
\n\
--	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
			\n\
		local iPentrationCount = actor:GetAbil(AT_PENETRATION_COUNT);\n\
		kArrow:SetPenetrationCount(iPentrationCount);--   \n\
		if iPentrationCount ~= 0 then\n\
			kArrow:SetMultipleAttack(true);\n\
		end\n\
			\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local kAEffect = actor:GetAttackEffect(action:GetID())\n\
		if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
			actor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
			\n\
		kMovingDir:Multiply(iAttackRange-45);\n\
		kMovingDir:Add(arrow_worldpos);\n\
		kArrow:SetTargetLoc(kMovingDir);	\n\
		\n\
--		kArrow:SetMovingType(1)\n\
--		kArrow:SetParam_SinCurveLineType(10, 10* DEGTORAD)\n\
		\n\
		kArrow:Fire(true);\n\
		actor:ClearIgnoreEffectList();\n\
	\n\
	end	\n\
end\n\
\n\
function TwoActionFire_OnEvent(actor, textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"TwoActionFire_OnEvent textKey:\"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\" or textKey == \"end\" then\n\
	\n\
		if action:GetParamInt(7) == 0 then\n\
		\n\
			action:SetParamInt(7,1);\n\
			TwoActionFire_DoEffect(actor);	\n\
	\n\
		end\n\
\n\
	end\n\
end\n\
\n\
function	TwoActionFire_LoadArrowToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	\n\
	local	kPosition = actor:GetNodeWorldPos(\"p_ef_heart\");\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fMoveDistance = 30.0;\n\
	\n\
	kDir:Multiply(fMoveDistance);\n\
	kPosition:Add(kDir);\n\
	\n\
	kNewArrow:SetWorldPos(kPosition);\n\
	\n\
	return	kNewArrow;\n\
	\n\
end") );
	m_kContLuaText.push_back(std::string("-- [TYPE] : \"BOMB\" : (    )\n\
-- [BOMB_EFFECT_ID] :   ID\n\
-- [BOMB_AFTER_LIFETIME] : LIFE    .\n\
-- [BOME_AFTER_EFFECT_ID] :     ID\n\
-- [BOME_AFTER_EFFECT_SCALE] :     \n\
-- [HIT_SOUND_ID] :   \n\
-- [BOME_AFTER_SOUND_ID] :    \n\
-- [INSTALL_EFFECT_TARGET_NODE] :    ,  \n\
-- [INSTALL_EFFECT_ID] :     ID\n\
-- [INSTALL_EFFECT_TARGET_NODE2] :    ,  \n\
-- [INSTALL_EFFECT_ID2] :     ID\n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
\n\
-- [TRANSFORM_EFFECT_ID]				:     \n\
-- [TRANSFORM_EFFECT_TARGET_NODE_POS]	:     \n\
-- [TRANSFORM_SOUND_ID]					:    \n\
	   \n\
function Trap_Play_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	Trap_Play_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+1)\n\
	actor:PlayCurrentSlot()\n\
\n\
	if actor:IsUnderMyControl() then\n\
		local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0\n\
	        	\n\
		if fLifeTime == 0 then\n\
			fLifeTime = 9.0	\n\
		end\n\
		actor:SetInstallTimerGauge(fLifeTime)\n\
	end\n\
\n\
end\n\
\n\
function Trap_Play_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    --   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    action:SetParamFloat(2,g_world:GetAccumTime())\n\
    action:SetParamFloat(3,g_world:GetAccumTime())\n\
\n\
	if(true == actor:IsUnderMyControl()) then\n\
		SkillHelpFunc_AttachParticleToNodePos(7215,\"IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_ID\", \"IF_MY_UNDERCONTROL_THEN_INSTALL_EFFECT_TARGET_NODE_POS\", 1.5, actor, action)\n\
	end\n\
	\n\
	SkillHelpFunc_AttachParticleToNode(7212, \"INSTALL_EFFECT_ID\", \"INSTALL_EFFECT_TARGET_NODE\", 1, actor, action)\n\
	if(false == SkillHelpFunc_AttachParticleToNode(7213, \"INSTALL_EFFECT_ID2\", \"INSTALL_EFFECT_TARGET_NODE2\", 1, actor, action)) then\n\
		SkillHelpFunc_AttachParticleToNodePos(7213, \"INSTALL_EFFECT_ID2\", \"INSTALL_EFFECT_TARGET_NODE_POS2\", 1, actor, action)	\n\
	end\n\
end\n\
\n\
function Trap_Play_OnOverridePacket(actor, action, packet)\n\
--[[	ODS(\"Trap_Play_OnOverridePacket\\n\", false,912)\n\
	if(true == actor:IsUnderMyControl()) then 		\n\
		local	kSkillTree = GetSkillTree()\n\
		local   bLearned = kSkillTree:IsLearnedSkill(INVISIBLE_TRAP_SKILL_NO)\n\
		if(bLearned) then\n\
			packet:PushInt(1)\n\
			action:SetParamInt(99, 1)\n\
			ODS(\"\\n\", false, 912)\n\
		else\n\
			packet:PushInt(0)\n\
			action:SetParamInt(99, 0)\n\
			ODS(\"\\n\", false, 912)\n\
		end			\n\
	end	\n\
]]\n\
end\n\
\n\
function Trap_Play_StartTimer(actor, action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    if actor:IsUnderMyControl() then\n\
        \n\
        if action:GetScriptParam(\"BOMB_AFTER_LIFETIME\") ~= \"TRUE\" then\n\
        	        \n\
	        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0\n\
        	\n\
	        if fLifeTime == 0 then\n\
	            fLifeTime = 10.0\n\
            end\n\
                \n\
            local   fAttackDelay = 0\n\
            \n\
            fAttackDelay = action:GetAbil(AT_ATT_DELAY)/1000.0\n\
            --ODS(\"Action :\"..action:GetID()..\" AttackDelay : \"..fAttackDelay..\" fLifeTime:\"..fLifeTime..\"\\n\")\n\
            if fAttackDelay < 0.05 then\n\
                fAttackDelay = 0.05\n\
            end\n\
            \n\
            --   \n\
            action:StartTimer(fLifeTime,fAttackDelay,0)\n\
        \n\
        end\n\
    \n\
    end\n\
    \n\
end\n\
\n\
function Trap_Play_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local actionID = action:GetID()\n\
	\n\
	--ODS(\"Trap_Play_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\")\n\
	\n\
	action:SetParam(0,\"Idle\")  --  State\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	Trap_Play_OnCastingCompleted(actor,action)\n\
	\n\
	--    SKILL_CUSTOM_VALUE  (      )\n\
	if(1 == actor:GetAbil(AT_SKILL_CUSTOM_VALUE_STORAGE)) then\n\
		action:SetParamInt(99, 1)\n\
	else\n\
		action:SetParamInt(99, 0)\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParam(100,\"hide\")			\n\
	action:SetParamInt(101, 0)\n\
	action:SetParamFloat(103,1)	-- 0    \n\
	action:SetParamFloat(102,g_world:GetAccumTime()+action:GetParamFloat(103))\n\
	action:SetParamInt(104, 0)\n\
	action:SetParamFloat(105,g_world:GetAccumTime())\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Trap_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    if bIsBefore == false then\n\
    \n\
		--ODS(\"Trap_Play_FindTarget Trap_Play_OnTargetListModified\\n\")\n\
    \n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
        \n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
        if action:GetScriptParam(\"TYPE\") == \"BOMB\" and action:GetID() ~= \"a_Caltrap Set\" then \n\
            --   \n\
            --    .\n\
            local   kBombEffectID = action:GetScriptParam(\"BOMB_EFFECT_ID\")\n\
            if kBombEffectID == \"\" then\n\
                kBombEffectID = \"ef_Magnumbreak_01_char_root\"\n\
            end\n\
            GetMyActor():AttachParticleToPoint(1,actor:GetPos(),kBombEffectID)\n\
            --    .\n\
            actor:HideNode(\"Scene Root\",true)\n\
            actor:SetHideShadow(true)\n\
            --  5  .   .\n\
            action:SetParamFloat(1,g_world:GetAccumTime())\n\
            action:SetParam(0,\"WaitForDestroying\")\n\
\n\
			local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\")\n\
			if kSoundID~=\"\" then\n\
				local actionID = action:GetID()\n\
				if(actionID == \"a_Splash Trap_Explosion\" or actionID == \"a_Freezing Trap Active\" or actionID == \"a_Silence Trap Active\" or actionID == \"a_MP-Zero Trap Active\") then\n\
					GetMyActor():AttachSound(20100426, kSoundID)\n\
				else			\n\
					g_world:AttachSound(kSoundID, actor:GetPos())\n\
				end\n\
			end\n\
		elseif action:GetID() == \"a_Caltrap Set\" then\n\
			--    .\n\
            actor:HideNode(\"Scene Root\",true)\n\
            actor:SetHideShadow(true)\n\
            --  5  .   .\n\
            action:SetParamFloat(1,g_world:GetAccumTime())\n\
            action:SetParam(0,\"WaitForDestroying\")\n\
		end\n\
    end\n\
\n\
end\n\
\n\
function Trap_Play_FindTarget(actor,action,bForceToBomb)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	bIsBombType = (action:GetScriptParam(\"TYPE\") == \"BOMB\")\n\
\n\
	if action:GetScriptParam(\"SERACH_TYPE\") == \"FULLSEARCH\" then\n\
		action:SetParam(4,\"FullSearch\")\n\
	else\n\
		action:SetParam(4,\"OnlyCollided\")\n\
	end\n\
\n\
	if bForceToBomb then\n\
		action:SetParam(4,\"FullSearch\")\n\
	end\n\
	\n\
    action:CreateActionTargetList(actor,true)\n\
    \n\
    if action:GetTargetCount() > 0 or bForceToBomb then\n\
    \n\
		if bIsBombType and bForceToBomb == false then\n\
			action:SetParam(4,\"FullSearch\")\n\
			action:CreateActionTargetList(actor,true)\n\
		end\n\
    \n\
        if IsSingleMode() or action:GetTargetCount() == 0 then\n\
			\n\
            Trap_Play_OnTargetListModified(actor,action,false)    \n\
        \n\
        else\n\
        \n\
			--ODS(\"Trap_Play_FindTarget BroadCastTargetListModify\\n\")\n\
            action:BroadCastTargetListModify(actor:GetPilot())\n\
            action:ClearTargetList()\n\
        \n\
        end    \n\
        \n\
        return true\n\
        \n\
    end\n\
    \n\
    return false\n\
end\n\
\n\
function Trap_Play_OnTimer(actor, accumTime, action,iTimerID)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    --ODS(\"Trap_Play_OnTimer accumTime:\"..accumTime..\"\\n\")\n\
        \n\
	--  1     .\n\
	if Trap_Play_FindTarget(actor,action) then\n\
		if action:GetScriptParam(\"TYPE\") == \"BOMB\" then --    ,  . \n\
			return false\n\
		end\n\
	end\n\
    \n\
    return true\n\
\n\
end\n\
\n\
function Trap_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if(1 == action:GetParamInt(99)) then	--     \n\
		if(0 == action:GetParamInt(101) and accumTime > action:GetParamFloat(102)) then\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0,1)	\n\
			action:SetParamInt(101, 1)\n\
			SkillHelpFunc_AttachParticleToNodePos(7214,\"TRANSFORM_EFFECT_ID\", \"TRANSFORM_EFFECT_TARGET_NODE_POS\", 2, actor, action)\n\
			\n\
			local actionID = action:GetID()\n\
			if(actionID == \"a_Splash Trap_Explosion\" or actionID == \"a_Freezing Trap Active\" or actionID == \"a_Silence Trap Active\" or actionID == \"a_MP-Zero Trap Active\") then\n\
			local kSoundID = action:GetScriptParam(\"TRANSFORM_SOUND_ID\")\n\
				if kSoundID~=\"\" then\n\
					GetMyActor():AttachSound(20100426, kSoundID);\n\
				end		\n\
			else\n\
				SkillHelpFunc_AttachSoundToActorPos(\"TRANSFORM_SOUND_ID\", actor, action)\n\
			end\n\
			\n\
			--if(false == actor:IsUnderMyControl()) then\n\
				local fTargetScale = tonumber(action:GetScriptParam(\"TARGET_SCALE\"))\n\
				local fTargetScaleTime = tonumber(action:GetScriptParam(\"TARGET_SCALE_TIME\")) 			\n\
				if(\"\" ~= fTargetScale and \"\" ~= fTargetScaleTime) then\n\
					actor:SetTargetScale(fTargetScale, fTargetScaleTime) --    \n\
				end\n\
			--end		\n\
		end	\n\
		\n\
		--  \n\
		if(true == actor:IsAlphaTransitDone()) then\n\
			if(\"hide\" == action:GetParam(100)) then \n\
				if(1 == action:GetParamInt(104)) then \n\
					if(action:GetParamFloat(105) < accumTime) then\n\
						actor:SetTargetAlpha(0,1,1)\n\
						action:SetParam(100,\"show\")\n\
						action:SetParamInt(104, 0)\n\
					end\n\
				else\n\
					action:SetParamInt(104, 1)\n\
					action:SetParamFloat(105, accumTime+2)\n\
				end\n\
			else\n\
				action:SetParam(100,\"hide\")\n\
				actor:SetTargetAlpha(actor:GetAlpha(),0,1)\n\
			end\n\
		end\n\
	end\n\
	\n\
		\n\
	local   kState = action:GetParam(0)\n\
	\n\
	--ODS(\"kState : \"..kState..\"\\n\")\n\
	\n\
	if action:GetParamFloat(3) >0 and (accumTime - action:GetParamFloat(3)> 1) then\n\
		Trap_Play_StartTimer(actor,action)\n\
		action:SetParamFloat(3,0)\n\
	end\n\
	\n\
	if  kState == \"Idle\" then\n\
	\n\
        --  10   .\n\
        local   fTotalElapsedTime = accumTime - action:GetParamFloat(2)\n\
        local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0\n\
    	\n\
        if fLifeTime == 0 then\n\
            fLifeTime = 10.0\n\
        end\n\
        \n\
        --ODS(\"Trap_Play_OnUpdate fTotalElapsedTime : \"..fTotalElapsedTime..\"\\n\")\n\
        \n\
        if fTotalElapsedTime > fLifeTime-1 then\n\
	    \n\
            if action:GetScriptParam(\"BOMB_AFTER_LIFETIME\") == \"TRUE\" then\n\
				if actor:IsUnderMyControl() then      \n\
					Trap_Play_FindTarget(actor,action,true)\n\
				end\n\
                action:SetParam(0,\"Destroyed\")\n\
	            return true\n\
            end\n\
			\n\
			action:SetParam(0,\"end\")\n\
			action:SetParam(1,\"AutoDestroyed\")\n\
        end\n\
\n\
	elseif  kState == \"bomb_force\" then --   ( )\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			Trap_Play_FindTarget(actor,action,true)\n\
		end\n\
		action:SetParam(0,\"Destroyed\")\n\
		--   \n\
		action:DeleteTimer(0)\n\
	\n\
	elseif kState == \"WaitForDestroying\" then\n\
		action:SetParam(0,\"end\")		\n\
\n\
	elseif kState == \"end\" then\n\
		if action:GetParam(1) == \"AutoDestroyed\" then\n\
			local   kBombAfterEffectID = action:GetScriptParam(\"BOME_AFTER_EFFECT_ID\")\n\
\n\
			if kBombAfterEffectID ~= nil then\n\
				local kBombAfterEffectSize = tonumber(action:GetScriptParam(\"BOME_AFTER_EFFECT_SCALE\"))\n\
				\n\
				if kBombAfterEffectSize ~= nil then\n\
					GetMyActor():AttachParticleToPointS(30,actor:GetPos(), kBombAfterEffectID, kBombAfterEffectSize)\n\
				end				\n\
				\n\
				local actionID = action:GetID()\n\
				if(actionID == \"a_Splash Trap_Explosion\" or actionID == \"a_Freezing Trap Active\" or actionID == \"a_Silence Trap Active\" or actionID == \"a_MP-Zero Trap Active\") then\n\
				local kSoundID = action:GetScriptParam(\"BOME_AFTER_SOUND_ID\")\n\
					if kSoundID~=\"\" then\n\
						GetMyActor():AttachSound(20100426, kSoundID);\n\
					end		\n\
				else\n\
					SkillHelpFunc_AttachSoundToActorPos(\"BOME_AFTER_SOUND_ID\", actor, action)\n\
				end				\n\
			end\n\
		end\n\
\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Trap_Play_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	kFindType = action:GetParam(4)\n\
	\n\
	local	fFindRange = 50\n\
	local	iMaxTargetCount = 0\n\
	\n\
	if kFindType == \"OnlyCollided\" then\n\
		fFindRange = 10\n\
		iMaxTargetCount = 1\n\
	end\n\
\n\
	local	kPos = actor:GetPos()\n\
	local	kDir = actor:GetLookingDir()\n\
	local	fBackDistance = 10\n\
\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local kParam = FindTargetParam()\n\
\n\
    local   kParam = FindTargetParam()\n\
\n\
	kParam:SetParam_1(kPos,kDir)\n\
	kParam:SetParam_2(0,0,fFindRange,iMaxTargetCount)\n\
	kParam:SetParam_3(true,FTO_NORMAL)\n\
\n\
	local strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\")\n\
\n\
	--ODS(\"strFindTargetType : \"..strFindTargetType..\"\\n\", false, 1509)\n\
\n\
	local iFindTargetType = TAT_SPHERE\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		kDir:Multiply(-fBackDistance)\n\
		kPos:Add(kDir)\n\
	    iFindTargetType = TAT_RAY_DIR\n\
    	kParam:SetParam_1(kPos,kDir)\n\
    	kParam:SetParam_2(iAttackRange,30,fFindRange,iMaxTargetCount)\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		kDir:Multiply(-fBackDistance)\n\
		kPos:Add(kDir)\n\
	    iFindTargetType = TAT_BAR\n\
    	kParam:SetParam_1(kPos,kDir)\n\
    	kParam:SetParam_2(iAttackRange,60,fFindRange,iMaxTargetCount)\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE\n\
    	kParam:SetParam_1(kPos,kDir)\n\
    	kParam:SetParam_2(0,30,iAttackRange,iMaxTargetCount)\n\
	\n\
	end\n\
	\n\
	return action:FindTargets(iFindTargetType,kParam,kTargets,kTargets)\n\
\n\
end\n\
\n\
function Trap_Play_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
\n\
	if actor:IsUnderMyControl() then\n\
		actor:DestroyInstallTimerGauge()\n\
	end\n\
\n\
	actor:DetachFrom(7212)\n\
	actor:DetachFrom(7213)\n\
	actor:DetachFrom(7214)\n\
	actor:DetachFrom(7215)\n\
\n\
	return true\n\
end\n\
\n\
function Trap_Play_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	--ODS(\"Trap_Play_OnLeave NextAction : \"..action:GetID()..\"\\n\")\n\
	\n\
	local	kParam = actor:GetAction():GetParam(0)\n\
	\n\
	return (kParam == \"end\")\n\
end") );
	m_kContLuaText.push_back(std::string("--  ,  ,  \n\
function Act_Mon_Shot_S_Curve_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	return		true;\n\
	\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_SetState(actor,action,kState)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(3)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_Shot_S_Curve_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_S_Curve_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_S_Curve_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_S_Curve_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	--ODS(\"Act_Mon_Shot_S_Curve_LoadToWeapon CurrentSlot:\"..action:GetCurrentSlot()..\"\\n\")\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_S_Curve\"\n\
	end\n\
\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_Fire(actor,action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_OnEnter(actor, action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_Shot_S_Curve_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )	\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_S_Curve_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Shot_S_Curve_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Shot_S_Curve_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Shot_S_Curve_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_Shot_S_Curve_OnEnter Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local	iState = action:GetParamInt(0)\n\
		\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if animDone == true then\n\
			if iState == 2 then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(3)) == 0 then\n\
					return false\n\
				else\n\
					Act_Mon_Shot_S_Curve_SetState(actor,action,\"RETURN\")\n\
				end\n\
			end\n\
			\n\
			if iState == 3 then\n\
				return false\n\
			end\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Shot_S_Curve_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Shot_S_Curve_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Shot_S_Curve_OnLeave\\n\")\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_SetProjectileDirection(kProjectile, fDelayFire)\n\
	if nil==kProjectile then\n\
		return false\n\
	end\n\
\n\
	local iSkillRange = tonumber(kProjectile:GetParamValue(\"iSkillRange\"))\n\
	local iSectionRange = tonumber(kProjectile:GetParamValue(\"iSectionRange\"))\n\
	local iCurve = tonumber(kProjectile:GetParamValue(\"iCurve\"))\n\
	local kLookingDir = Point3(tonumber(kProjectile:GetParamValue(\"kLookingDir.x\")), tonumber(kProjectile:GetParamValue(\"kLookingDir.y\")), tonumber(kProjectile:GetParamValue(\"kLookingDir.z\")))\n\
	--ODS(\"kLookingDir x:\"..kLookingDir:GetX()..\", y:\"..kLookingDir:GetY()..\", z:\"..kLookingDir:GetZ()..\"\\n\")\n\
	\n\
	if iSkillRange < 0 then\n\
		return false\n\
	end\n\
\n\
	local arrow_worldpos1 = kProjectile:GetWorldPos()\n\
	--ODS(\"arrow_worldpos1 x:\"..arrow_worldpos1:GetX()..\", y:\"..arrow_worldpos1:GetY()..\", z:\"..arrow_worldpos1:GetZ()..\"\\n\")\n\
	local kTargetDir = Point3(kLookingDir:GetX(),kLookingDir:GetY(),kLookingDir:GetZ())\n\
	local kCrossDir = Point3(kLookingDir:GetX(),kLookingDir:GetY(),kLookingDir:GetZ())\n\
	kCrossDir:Cross(Point3(0,0,1))\n\
			\n\
	local kOneThird = iSectionRange/3\n\
	local kLength1 = kOneThird + math.random(-kOneThird/2,kOneThird/2)\n\
	local kLength2 = kOneThird + math.random(-kOneThird/2,kOneThird/2)\n\
	local kPos1 = Point3(kCrossDir:GetX(),kCrossDir:GetY(),kCrossDir:GetZ())\n\
	kPos1:Multiply(iCurve+math.random(-iCurve/2,iCurve/2))\n\
	local kPos2 = Point3(kCrossDir:GetX(),kCrossDir:GetY(),kCrossDir:GetZ())\n\
	kPos2:Multiply(-(iCurve+math.random(-iCurve/2,iCurve/2)))\n\
\n\
	--ODS(\"1 X:\"..kPos1:GetX()..\" Y : \"..kPos1:GetY()..\" Z : \"..kPos1:GetZ()..\"\\n\",false,987)\n\
	--ODS(\"2 X:\"..kPos2:GetX()..\" Y : \"..kPos2:GetY()..\" Z : \"..kPos2:GetZ()..\"\\n\",false,987)\n\
\n\
	local kArrow1Pos1 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
	kArrow1Pos1:Multiply(kLength1)\n\
	kArrow1Pos1:Add(arrow_worldpos1)\n\
	kArrow1Pos1:Add(kPos1)\n\
	local kArrow1Pos2 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
	kArrow1Pos2:Multiply(kLength1+kLength2)\n\
	kArrow1Pos2:Add(arrow_worldpos1)\n\
	kArrow1Pos2:Add(kPos2)\n\
	\n\
	--ODS(\"1 X:\"..kArrow1Pos1:GetX()..\" Y : \"..kArrow1Pos1:GetY()..\" Z : \"..kArrow1Pos1:GetZ()..\"\\n\",false,987)\n\
	--ODS(\"2 X:\"..kArrow1Pos2:GetX()..\" Y : \"..kArrow1Pos2:GetY()..\" Z : \"..kArrow1Pos2:GetZ()..\"\\n\",false,987)\n\
	\n\
	local kFireTarget = kLookingDir\n\
	kFireTarget:Unitize()\n\
	kFireTarget:Multiply(iSectionRange)\n\
	kFireTarget:Add(arrow_worldpos1)\n\
	\n\
	kProjectile:SetMovingType(2)\n\
	kProjectile:SetParam_Bezier4SplineType(arrow_worldpos1, kArrow1Pos1, kArrow1Pos2, kFireTarget)\n\
	kProjectile:SetTargetLoc(kFireTarget)\n\
	if fDelayFire then\n\
		kProjectile:DelayFire(fDelayFire)\n\
	else\n\
		kProjectile:Fire()\n\
	end\n\
\n\
	--\n\
	kProjectile:SetParamValue(\"iSkillRange\", iSkillRange-iSectionRange)\n\
	kProjectile:SetParamValue(\"iSectionRange\", iSectionRange)\n\
	kProjectile:SetParamValue(\"iCurve\", iCurve)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_S_Curve_OnEvent(actor,textKey)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction()\n\
		\n\
	CheckNil(kAction==nil);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	--ODS(\"Act_Mon_Shot_S_Curve_OnEvent textKey:\"..textKey..\", CurrentSlot:\"..kAction:GetCurrentSlot().. \"\\n\")\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end\n\
		\n\
		local	iSkillRange = kAction:GetSkillRange(0,actor)\n\
		\n\
		if iSkillRange == 0 then\n\
			iSkillRange = 250 \n\
		end\n\
		--ODS(\"iSkillRange: \"..iSkillRange..\"\\n\")\n\
\n\
		local	iSectionRange = actor:GetAnimationInfo(\"SECTION_RANGE\")\n\
		if nil == iSectionRange or \"\" == iSectionRange then\n\
			iSectionRange = iSkillRange\n\
		else\n\
			iSectionRange = tonumber(iSectionRange)\n\
		end\n\
		\n\
		local	iCurve = actor:GetAnimationInfo(\"CURVE_VALUE\")\n\
		if nil == iCurve or \"\" == iCurve then\n\
			iCurve = 100\n\
		else\n\
			iCurve = tonumber(iCurve)\n\
		end\n\
		\n\
		local fire_delay = actor:GetAnimationInfo(\"FIRE_DELAY\")\n\
		if nil == fire_delay or \"\" == fire_delay then\n\
			fire_delay = 0 --   \n\
		else\n\
			fire_delay = tonumber(fire_delay)\n\
		end\n\
\n\
		local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
			Projectile_cnt = 1\n\
		else\n\
			Projectile_cnt = tonumber(Projectile_cnt)\n\
		end\n\
\n\
		local   iArrowCount = 0\n\
		while   iArrowCount<Projectile_cnt do\n\
		\n\
			local kArrow1 = Act_Mon_Shot_S_Curve_LoadToWeapon(actor, kAction, 0)\n\
			local kTargetDir = actor:GetLookingDir()\n\
			kTargetDir:Unitize()\n\
			--ODS(\"kTargetDir x:\"..kTargetDir:GetX()..\", y:\"..kTargetDir:GetY()..\", z:\"..kTargetDir:GetZ()..\"\\n\")\n\
			kArrow1:SetParamValue(\"kLookingDir.x\", kTargetDir:GetX())\n\
			kArrow1:SetParamValue(\"kLookingDir.y\", kTargetDir:GetY())\n\
			kArrow1:SetParamValue(\"kLookingDir.z\", kTargetDir:GetZ())\n\
			kArrow1:SetParamValue(\"iSkillRange\", iSkillRange)\n\
			kArrow1:SetParamValue(\"iSectionRange\", iSectionRange)\n\
			kArrow1:SetParamValue(\"iCurve\", iCurve)\n\
			Act_Mon_Shot_S_Curve_SetProjectileDirection(kArrow1, iArrowCount*fire_delay)\n\
\n\
			iArrowCount=iArrowCount+1\n\
		end\n\
		\n\
\n\
		kAction:ClearTargetList()\n\
\n\
	end\n\
	\n\
	if textKey == \"quake\" then\n\
		Act_Mon_QuakeCamera(actor)\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("--       \n\
function Act_Mon_Touch_up_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	return		true;\n\
	\n\
end\n\
\n\
function Act_Mon_Touch_up_SetState(actor,action,kState)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(3)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Touch_up_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Act_Mon_Touch_up_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Touch_up_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Touch_up_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Touch_up_LoadToWeapon(actor,action,iProjectileIndex)\n\
	--ODS(\"Act_Mon_Touch_up_LoadToWeapon\\n\",false,6482)\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	--ODS(\"Act_Mon_Touch_up_LoadToWeapon CurrentSlot:\"..action:GetCurrentSlot()..\"\\n\")\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_Touch_up\"\n\
	end\n\
\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_mouth\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mon_Touch_up_Fire(actor,action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Touch_up_OnEnter(actor, action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Act_Mon_Touch_up_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\")\n\
	\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local byPacketType = kPacket:PopByte()\n\
		local iCount = kPacket:PopInt()\n\
		\n\
		action:SetParamAsPoint(0, kPacket:PopPoint3() )\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Touch_up_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    --ODS(\"Act_Mon_Touch_up_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Touch_up_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Touch_up_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		--ODS(\"Act_Mon_Touch_up_OnEnter Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Touch_up_OnUpdate(actor, accumTime, frameTime)\n\
	--ODS(\"Act_Mon_Touch_up_OnUpdate \\n\",false,6482)\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local	iState = action:GetParamInt(0)\n\
		\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if animDone == true then\n\
			if iState == 2 then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(3)) == 0 then\n\
					return false\n\
				else\n\
					Act_Mon_Touch_up_SetState(actor,action,\"RETURN\")\n\
				end\n\
			end\n\
			\n\
			if iState == 3 then\n\
				return false\n\
			end\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Touch_up_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Touch_up_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Touch_up_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Touch_up_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Touch_up_OnLeave\\n\")\n\
	return true\n\
end\n\
\n\
function  Act_Mon_Touch_up_NextProjectile(kProjectile, fDelayFire)	\n\
	if nil==kProjectile then\n\
		return false\n\
	end\n\
\n\
	--ODS(\"Act_Mon_Touch_up_NextProjectile\\n\",false,6482)\n\
	--  \n\
	-- \n\
	--   .     ..\n\
\n\
	local upActionNo = tonumber(kProjectile:GetParamValue(\"UpActionNo\"))\n\
	local upProjectileSpeed = tonumber(kProjectile:GetParamValue(\"UpProjectileSpeed\"))\n\
	local upProjectileScale = tonumber(kProjectile:GetParamValue(\"UpProjectileScale\"))\n\
	local upProjectileAlpha = tonumber(kProjectile:GetParamValue(\"UpProjectileAlpha\"))\n\
	local upProjectileHeight = tonumber(kProjectile:GetParamValue(\"UpProjectileHeight\"))\n\
	local upFireEffect = kProjectile:GetParamValue(\"UpFireEffect\")\n\
	local upFireEffectScale = kProjectile:GetParamValue(\"UpFireEffectScale\")\n\
	local upFireSound = kProjectile:GetParamValue(\"UpFireSound\")\n\
		\n\
	\n\
	--ODS(\"NextProjectile UpActionNo:\"..upActionNo..\", FireEffect:\"..upFireEffect..\", ProjectileSpeed:\"..upProjectileSpeed..\", upProjectileScale:\"..upProjectileScale..\"\\n\",false,6482)\n\
	\n\
	if upActionNo == 0 then\n\
		-- local iAttachParticleNo = tonumber(kProjectile:GetParamValue(\"UpFireAttachParticleNo\"))\n\
		-- g_world:DetachParticle(iAttachParticleNo)		\n\
		return false\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local actor = g_world:FindActor(kProjectile:GetParentPilotGuid())\n\
	if nil~=actor and false==actor:IsNil() then\n\
		if nil~=upFireEffect or \"\"~=upFireEffect then\n\
			local iAttachParticleNo = g_world:AttachParticleSWithRotate(upFireEffect, kProjectile:GetWorldPos(), upFireEffectScale, Point3(0,0,0))\n\
			kProjectile:SetParamValue(\"UpFireAttachParticleNo\", iAttachParticleNo)\n\
		end\n\
		if nil~=upFireSound or \"\"~=upFireSound then\n\
			g_world:AttachSound(upFireSound,kProjectile:GetWorldPos())\n\
		end\n\
\n\
		kProjectile:SetParamValue(\"USE_FLYING_START\", \"FALSE\")\n\
		kProjectile:SetMovingType(0)\n\
		if upProjectileSpeed then\n\
			kProjectile:SetSpeed(upProjectileSpeed)\n\
		end\n\
		kProjectile:SetAlpha(upProjectileAlpha)\n\
		kProjectile:SetHide(1==upProjectileAlpha)\n\
		kProjectile:SetScale(upProjectileScale)\n\
		kProjectile:SetParentActionInfo(upActionNo,kProjectile:GetParentActionInstanceID(),kProjectile:GetParentActionTimeStamp());\n\
		\n\
		local kTargetPos = kProjectile:GetWorldPos()\n\
		kTargetPos:SetZ(kTargetPos:GetZ()+20)\n\
		kProjectile:LoadToPosition(kTargetPos)\n\
		kTargetPos:SetZ(kTargetPos:GetZ()+upProjectileHeight)\n\
		kProjectile:SetTargetLoc(kTargetPos)\n\
		kProjectile:Fire()\n\
		\n\
	end\n\
\n\
	kProjectile:SetParamValue(\"UpActionNo\", 0)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Touch_up_OnEvent(actor,textKey)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction()\n\
		\n\
	CheckNil(kAction==nil);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
	--ODS(\"Act_Mon_Touch_up_OnEvent textKey:\"..textKey..\"\\n\",false,6482)	\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end\n\
\n\
		local fire_delay = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
		if nil == fire_delay or \"\" == fire_delay then\n\
			fire_delay = 0 --   \n\
		else\n\
			fire_delay = tonumber(fire_delay)\n\
		end		\n\
\n\
		local	upActionNo = actor:GetAnimationInfo(\"UP_ACTION_NO\")\n\
		if nil == upActionNo or \"\" == upActionNo then\n\
			upActionNo = kAction:GetActionNo()\n\
		else\n\
			upActionNo = tonumber(upActionNo)\n\
		end\n\
		\n\
		local upFireEffect = actor:GetAnimationInfo(\"UP_FIRE_EFFECT\")	\n\
		if nil == upFireEffect then\n\
			upFireEffect = \"\"\n\
		end\n\
		\n\
		local upFireEffectScale = actor:GetAnimationInfo(\"UP_FIRE_EFFECT_SCALE\")\n\
		if nil == upFireEffectScale then\n\
			upFireEffectScale = 1\n\
		else\n\
			upFireEffectScale = tonumber(upFireEffectScale)\n\
		end\n\
\n\
		local upFireSound = actor:GetAnimationInfo(\"UP_FIRE_SOUND\")\n\
		if nil == upFireSound then\n\
			upFireSound = \"\"\n\
		end\n\
\n\
		local fZ = actor:GetAnimationInfo(\"Z_FACTOR\")\n\
		if nil == fZ or \"\" == fZ then\n\
			fZ = 2\n\
		else\n\
			fZ = tonumber(fZ)\n\
		end\n\
		\n\
		local iDistance = actor:GetAnimationInfo(\"DISTANCE\")\n\
		if nil == iDistance or \"\" == iDistance then\n\
			iDistance = 250\n\
		else\n\
			iDistance = tonumber(iDistance)\n\
		end\n\
		\n\
		--ODS(\"UpActionNo:\"..upActionNo..\", FireEffect:\"..upFireEffect..\", fZ:\"..fZ..\", Distance:\"..iDistance..\"\\n\",false,6482)\n\
		\n\
		local fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
		if fProjectileSpeed ~= nil then\n\
			fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		end\n\
		\n\
		local upProjectileSpeed = actor:GetAnimationInfo(\"UP_PROJECTILE_SPEED\")\n\
		if upProjectileSpeed == nil then\n\
			upProjectileSpeed = 700\n\
		else\n\
			upProjectileSpeed = tonumber(upProjectileSpeed)\n\
		end\n\
\n\
		local upProjectileScale = actor:GetAnimationInfo(\"UP_PROJECTILE_SCALE\")\n\
		if upProjectileScale == nil then\n\
			upProjectileScale = 1\n\
		else\n\
			upProjectileScale = tonumber(upProjectileScale)\n\
		end\n\
		\n\
		local upProjectileAlpha = actor:GetAnimationInfo(\"UP_PROJECTILE_ALPHA\")\n\
		if upProjectileAlpha == nil then\n\
			upProjectileAlpha = 0\n\
		else\n\
			upProjectileAlpha = tonumber(upProjectileAlpha)\n\
		end\n\
		\n\
		local upProjectileHeight = actor:GetAnimationInfo(\"UP_PROJECTILE_HEIGHT\")\n\
		if upProjectileHeight == nil then\n\
			upProjectileHeight = 200\n\
		else\n\
			upProjectileHeight = tonumber(upProjectileHeight)\n\
		end\n\
		\n\
		local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
			Projectile_cnt = 1\n\
		else\n\
			Projectile_cnt = tonumber(Projectile_cnt)\n\
		end\n\
\n\
		local   iArrowCount = 0\n\
		while   iArrowCount<Projectile_cnt do\n\
		\n\
			local kArrow1 = Act_Mon_Touch_up_LoadToWeapon(actor, kAction, 0)\n\
			\n\
			if fProjectileSpeed then\n\
				kArrow1:SetSpeed(fProjectileSpeed)\n\
			end\n\
			\n\
			-- \n\
			local iPentrationCount = kAction:GetAbil(AT_PENETRATION_COUNT);\n\
			kArrow1:SetPenetrationCount(iPentrationCount);--   \n\
			if iPentrationCount ~= 0 then\n\
				kArrow1:SetMultipleAttack(true);\n\
			end\n\
\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local	kTargetLoc = kAction:GetParamAsPoint(0)\n\
			if kTargetLoc:IsZero() and kAction:GetTargetCount() > 0 then\n\
					--	  \n\
				local	kTargetGUID = kAction:GetTargetGUID(0)\n\
				local	iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0)\n\
				local 	kTargetActor = g_world:FindActor(kTargetGUID)\n\
				if kTargetActor:IsNil() == false then\n\
					local pt = kTargetActor:GetABVShapeWorldPos(iTargetABVShapeIndex)\n\
					actor:LookAt(pt,true,true)\n\
					kTargetLoc = kTargetActor:GetPos()\n\
				end\n\
			end\n\
\n\
			if nil==kTargetLoc or kTargetLoc:IsZero() then\n\
				local	kMovingDir = actor:GetLookingDir();	--    \n\
				kTargetLoc = kMovingDir:_Multiply(iDistance);\n\
				kTargetLoc:Add(actor:GetPos());\n\
			end\n\
			local	ptpoint = Point3(kTargetLoc:GetX(), kTargetLoc:GetY(), kTargetLoc:GetZ() + 100)\n\
			kTargetLoc = g_world:ThrowRay(ptpoint, Point3(0,0,-1), 300)\n\
			kTargetLoc:SetZ(kTargetLoc:GetZ()+1)\n\
\n\
			kArrow1:SetTargetLoc(kTargetLoc)\n\
			\n\
			kArrow1:SetParamValue(\"Z_FACTOR\", fZ)\n\
			kArrow1:SetParamValue(\"UpActionNo\", upActionNo)\n\
			kArrow1:SetParamValue(\"UpProjectileSpeed\", upProjectileSpeed)\n\
			kArrow1:SetParamValue(\"UpProjectileScale\", upProjectileScale)\n\
			kArrow1:SetParamValue(\"UpProjectileAlpha\", upProjectileAlpha)\n\
			kArrow1:SetParamValue(\"UpProjectileHeight\", upProjectileHeight)			\n\
			kArrow1:SetParamValue(\"UpFireEffect\", upFireEffect)\n\
			kArrow1:SetParamValue(\"UpFireEffectScale\", upFireEffectScale)\n\
			kArrow1:SetParamValue(\"UpFireSound\", upFireSound)\n\
			\n\
			if fire_delay then\n\
				kArrow1:DelayFire(iArrowCount*fire_delay, true)\n\
			else\n\
				kArrow1:Fire(true)\n\
			end\n\
\n\
			iArrowCount=iArrowCount+1\n\
		end\n\
		\n\
\n\
		kAction:ClearTargetList()\n\
\n\
	end\n\
	\n\
	if textKey == \"quake\" then\n\
		Act_Mon_QuakeCamera(actor)\n\
	end\n\
\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Touch_up_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end") );
	m_kContLuaText.push_back(std::string("function Skill_Mon_Pull_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Mon_Pull_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Mon_Pull_Fire(actor,action);\n\
end\n\
\n\
function Skill_Mon_Pull_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	if action:GetTargetCount()>0 then\n\
	    action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
	action:ClearTargetList()\n\
\n\
	local kFireEffectID = \"ef_skill_LightningMagnet_03\"\n\
	local kFireAttachNode = \"p_ef_heart\"\n\
	local kScale = 1\n\
\n\
	actor:AttachParticleS(182, kFireAttachNode, kFireEffectID, kScale)\n\
\n\
end\n\
\n\
function Skill_Mon_Pull_OnEnter(actor, action)\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(1, g_world:GetAccumTime())\n\
	local kCoolTime = action:GetAbil(ATS_COOL_TIME)\n\
	if nil==kCoolTime or 0==kCoolTime then\n\
		kCoolTime = 500\n\
	end\n\
\n\
	action:SetParamFloat(2, kCoolTime*0.001)\n\
\n\
	local kTime = action:GetAbil(AT_MAINTENANCE_TIME)/1000\n\
	ODS(\"Skill_Mon_Pull_OnEnter kTime: \"..kTime..\"\\n\",false,6482)\n\
	if 0==kTime then\n\
		kTime = 5	-- 5\n\
	else\n\
		kTime = kTime + 5	-- 5  \n\
	end\n\
\n\
	action:SetParamFloat(10, action:GetParamFloat(1)+kTime)\n\
\n\
\n\
	local kLoopEffectID = \"\"\n\
	local kLoopAttachNode = \"p_ef_heart\"\n\
	local kScale = 1\n\
	\n\
	if nil~=kLoopEffectID and \"\"~=kLoopEffectID then\n\
		actor:AttachParticleS(181, kLoopAttachNode, kLoopEffectID, kScale)\n\
	end\n\
	return true\n\
end\n\
\n\
function Skill_Mon_Pull_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local kAccumTime = action:GetParamFloat(1)\n\
	local kCoolTime = action:GetParamFloat(2)\n\
\n\
	if kCoolTime <= accumTime - kAccumTime then\n\
		Skill_Mon_Pull_Fire(actor, action)\n\
		action:SetParamFloat(1, accumTime)\n\
	end\n\
	\n\
	if accumTime > action:GetParamFloat(10) then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Mon_Pull_OnCleanUp(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Mon_Pull_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:DetachFrom(181)\n\
	actor:DetachFrom(182)\n\
	return true\n\
end\n\
\n\
function Skill_Mon_Pull_OnEvent(actor,textKey)\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Mon_Pull_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        action:GetTargetList():ApplyActionEffects();\n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_AirStrike_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_AirStrike_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			--ODS(\"Act_Mon_AirStrike_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_AirStrike_OnCastingCompleted(actor, action)\n\
\n\
	--ODS(\"Act_Mon_AirStrike_OnCastingCompleted\\n\",false,6482)\n\
	\n\
	Act_Mon_AirStrike_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_AirStrike_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_AirStrike_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
end\n\
\n\
function Act_Mon_AirStrike_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_AirStrike_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\" CurrentSlotAnimName : \"..action:GetCurrentSlotAnimName()..\"\\n\",false,6482 )\n\
	\n\
	local	kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kSize = kPacket:PopInt()\n\
		local kSafeLoc = nil\n\
		\n\
		action:SetParamInt(2999,kSize)\n\
		\n\
		for i = 0, kSize do\n\
			kSafeLoc = kPacket:PopPoint3()\n\
			if nil~=kSafeLoc and false==kSafeLoc:IsZero() then\n\
				--ODS(\"Act_Mon_AirStrike_OnEnter Zone X: \"..kSafeLoc:GetX()..\", Y: \"..kSafeLoc:GetY()..\", Z: \"..kSafeLoc:GetZ()..\"\\n\",false,6482)\n\
				action:SetParamAsPoint(3000+i,kSafeLoc)\n\
			end\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_AirStrike_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    --ODS(\"Act_Mon_AirStrike_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_AirStrike_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_AirStrike_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
\n\
	end\n\
\n\
	action:SetParamInt(21, 0)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_AirStrike_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	iState = action:GetParamInt(0)\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if \"air_strike_fire\"==action:GetParam(100) then\n\
			Act_Mon_AirStrike_DoProjectile(actor, action, frameTime)\n\
		end\n\
\n\
		if true==animDone then\n\
\n\
			if 2==iState then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
					return false\n\
				else\n\
					local kSize = action:GetParamInt(2999)\n\
					if( CheckNil(g_world == nil) ) then return false end\n\
					if( CheckNil(g_world:IsNil()) ) then return false end\n\
					for i = 0, kSize do\n\
						g_world:DetachParticle(action:GetParamInt(3000+i))\n\
					end\n\
					Act_Mon_AirStrike_SetState(actor,action,\"RETURN\")\n\
				end\n\
			elseif iState == 3 then\n\
				return false\n\
			end\n\
\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if true==animDone then\n\
				Act_Mon_AirStrike_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		elseif iState == 1 and 0 == action:GetParamInt(21) then\n\
			action:SetParamInt(21,1)\n\
\n\
			local eff = actor:GetAnimationInfo(\"FIRE_EFFECT\") --   \n\
			if nil~=eff then\n\
				local node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil==node then\n\
					node = \"char_root\"\n\
				end\n\
				actor:AttachParticle(230, node, eff)\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_AirStrike_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_AirStrike_OnCleanUp(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	local kSize = action:GetParamInt(2999)\n\
	for i = 0, kSize do\n\
		g_world:DetachParticle(action:GetParamInt(3000+i))\n\
	end	\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_AirStrike_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_AirStrike_OnLeave\\n\")\n\
	return true\n\
end\n\
\n\
function SafezoneEffect(actor, action, textKey)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	CheckNil(nil==textKey);\n\
	\n\
	if textKey == \"cast_ef_start\" then\n\
		local safe_zone = actor:GetAnimationInfo(\"SAFEZONE_EFFECT\") --  \n\
		if nil~=safe_zone and \"\"~=safe_zone then\n\
			local kSize = action:GetParamInt(2999)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			for i = 0, kSize do\n\
				local kSafeLoc = action:GetParamAsPoint(3000+i)\n\
				if nil~=kSafeLoc and false==kSafeLoc:IsZero() then\n\
					--ODS(\"SafezoneEffect Zone X: \"..kSafeLoc:GetX()..\", Y: \"..kSafeLoc:GetY()..\", Z: \"..kSafeLoc:GetZ()..\"\\n\",false,6482)\n\
					local iAttachParticleNo = g_world:AttachParticle(safe_zone, kSafeLoc)\n\
					action:SetParamInt(3000+i,iAttachParticleNo)\n\
				end\n\
			end\n\
		end\n\
	end\n\
end\n\
\n\
function Act_Mon_AirStrike_DoProjectile(actor, action, frameTime)\n\
	local delay = actor:GetAnimationInfo(\"DELAY\")\n\
	local kSaveTime = action:GetParamFloat(101)\n\
	if nil~=delay and tonumber(delay)>kSaveTime then\n\
		--ODS(\"kSaveTime: \"..kSaveTime..\", frameTime: \"..frameTime..\"\\n\",false,6482)\n\
		action:SetParamFloat(101, frameTime+kSaveTime)\n\
		return\n\
	end\n\
	action:SetParamFloat(101, 0.0)\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 200 \n\
	end\n\
	\n\
	local fire_delay = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
	if nil == fire_delay or \"\" == fire_delay then\n\
		fire_delay = 0 --   \n\
	else\n\
		fire_delay = tonumber(fire_delay)\n\
	end\n\
	\n\
	local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
	if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
		Projectile_cnt = 8\n\
	else\n\
		Projectile_cnt = tonumber(Projectile_cnt)\n\
	end\n\
	\n\
	local fire_random = actor:GetAnimationInfo(\"FIRE_RANDOM\")\n\
	if nil == fire_random or \"\" == fire_random then\n\
		fire_random = 3\n\
	else\n\
		fire_random = tonumber(fire_random)\n\
	end\n\
	\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
\n\
	local	i = 0;\n\
	local fRotateAngle = math.pi/4.0\n\
	local	kRotateAxis = Point3(0,0,1);\n\
	\n\
	\n\
	local UID = action:GetParamInt(10+i)\n\
\n\
	local	kArrow = nil\n\
	--kArrow = Act_Mon_Shot_Around_LoadToWeapon(actor,action, i)\n\
	local LocZ = actor:GetAnimationInfo(\"TARGET_LOC_Z\")\n\
	if nil~=LocZ and \"\"~=LocZ then\n\
		LocZ = tonumber(LocZ)\n\
	end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local	kTargets = CreateActionTargetList(actor:GetPilotGuid(),action:GetActionInstanceID(),action:GetActionNo());\n\
\n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local iFoundNum = action:FindTargetsEx2(action:GetActionNo(), TAT_SPHERE, kParam, kTargets, kTargets, actor:GetPilot());\n\
	--local iFoundNum = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	--ODS(\"iFoundNum: \"..iFoundNum..\"\\n\",false,6482)\n\
	for idx=0, iFoundNum do\n\
		local	kTargetInfo = kTargets:GetTargetInfo(idx);\n\
		if kTargetInfo:IsNil() then\n\
			break\n\
		end\n\
		\n\
		local	kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		if kTargetGUID:IsNil() then\n\
			break\n\
		end\n\
\n\
		local fRotateAngle = math.pi/4.0\n\
		\n\
		for cnt=0, Projectile_cnt-1 do\n\
			local iProjectaleIndex = Random()%fire_random\n\
			kArrow = Act_Mon_Shot_Around_LoadToWeapon(actor, action, iProjectaleIndex)\n\
			if nil~=kArrow and false==kArrow:IsNil() then\n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
				local	kFireTarget = actor:GetLookingDir()\n\
				kFireTarget:Multiply(iAttackRange);\n\
				kFireTarget:Rotate(Point3(0,0,1),fRotateAngle*cnt);\n\
				kFireTarget:Add(arrow_worldpos);\n\
				kArrow:SetTargetLoc(kFireTarget);\n\
			\n\
				kArrow:SetTargetGuidFromServer(kTargetGUID)\n\
				\n\
				if cnt*fire_delay then\n\
					kArrow:DelayFire(cnt*fire_delay,true)\n\
				else\n\
					kArrow:Fire(true);--	!\n\
				end\n\
				--ODS(\"Act_Mon_Shot_Around_OnEvent \"..cnt.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			end\n\
		end\n\
\n\
		action:ClearTargetList()\n\
\n\
	end\n\
	DeleteActionTargetList(kTargets);\n\
end\n\
\n\
function Act_Mon_AirStrike_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_AirStrike_OnEvent textKey:\"..textKey..\"\\n\")	\n\
\n\
	SafezoneEffect(actor, kAction, textKey)\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
	\n\
		actor:DetachFrom(230)	--  \n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
\n\
\n\
		local	iState = kAction:GetParamInt(0)\n\
		if 2==iState then\n\
			kAction:SetParam(100, \"air_strike_fire\")\n\
			kAction:SetParamFloat(101, 0.0)\n\
		end\n\
	elseif textKey == \"hit_end\" or textKey == \"end\" or textKey == \"sound06\" then\n\
		kAction:SetParam(100, \"\")\n\
	end\n\
\n\
	return	true\n\
end\n\
\n\
function Act_Mon_AirStrike_OnTargetListModified(actor,action,bIsBefore)\n\
	-- if( CheckNil(nil==actor) ) then return false end\n\
	-- if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	-- if( CheckNil(nil==action) ) then return false end\n\
	-- if( CheckNil(action:IsNil()) ) then return false end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_SCALE_NORMALIZE] :             \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [FFIRE_CASTER_EFFECT_SCALE_NORMALIZE2] :             \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [ROTATION_ANGLE_VALUE_TICK] : tick  \n\
-- [MOVING_ATTACK_TICK] :      0.3\n\
-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_RUN_STOP] : hit   \n\
\n\
-- Melee\n\
function Act_Pet_Melee_Default_OnCheckCanEnter(actor, kNextAction)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==kNextAction);\n\
	CheckNil(kNextAction:IsNil());\n\
	\n\
	if(\"USING\" == actor:GetParam(\"SKILL_STATE\")) then\n\
		--ODS(\"    \\n\",false, 912)\n\
		return false\n\
	end\n\
	\n\
	local kMyPilot = actor:GetPilot()\n\
	if kMyPilot:IsNil() then return false end\n\
	local kMyUnit = kMyPilot:GetUnit()\n\
	if kMyUnit:IsNil() then return false end\n\
	local kCallerPilot = g_pilotMan:FindPilot(kMyUnit:GetCaller())\n\
	if kCallerPilot:IsNil() then return false end\n\
	local kCallerUnit = kCallerPilot:GetUnit()\n\
	if kCallerUnit:IsNil() then return false end\n\
	if(true == kCallerUnit:IsDead()) then return false end\n\
	--	local weapontype = actor:GetEquippedWeaponType();	\n\
	--	if weapontype == 0 then\n\
	--		return	false;\n\
	--	end\n\
\n\
	local kCallerActor = kCallerPilot:GetActor()\n\
	if kCallerActor:IsNil() then return true end\n\
	local kPlayerPos = kCallerActor:GetPos()\n\
	local kPetPosToPlayer = kPlayerPos:_Subtract(actor:GetPos())\n\
	local fDist = kPetPosToPlayer:Length()\n\
	--ODS(\":\"..fDist..\"\\n\",false, 912)\n\
	if(200 < fDist) then --   		\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Act_Pet_Melee_Default_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
\n\
end\n\
\n\
function Act_Pet_Melee_Default_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		--ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
		\n\
	local fEffectScale = 1\n\
	local   kFireEffectNomalize = action:GetScriptParam(\"FIRE_CASTER_EFFECT_SCALE_NORMALIZE\");	\n\
	if(\"\" ~= kFireEffectNomalize) then\n\
		local iAttackRange = action:GetSkillRange(0,actor);\n\
		kFireEffectNomalize = tonumber(kFireEffectNomalize)\n\
		fEffectScale = iAttackRange/kFireEffectNomalize\n\
	end\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7212,kFireEffectTargetNodeID,kFireEffectID, fEffectScale);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPointS(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,fEffectScale);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion(),fEffectScale)\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	fEffectScale = 1\n\
	kFireEffectNomalize = action:GetScriptParam(\"FIRE_CASTER_EFFECT_SCALE_NORMALIZE2\");	\n\
	if(\"\" ~= kFireEffectNomalize) then\n\
		local iAttackRange = action:GetSkillRange(0,actor);\n\
		kFireEffectNomalize = tonumber(kFireEffectNomalize)\n\
		fEffectScale = iAttackRange/kFireEffectNomalize		\n\
	end\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7213,kDir,kFireEffectID,kFireEffectNomalize);\n\
            \n\
        else\n\
            actor:AttachParticleS(7213,kFireEffectTargetNodeID,kFireEffectID, fEffectScale,kFireEffectNomalize);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);        \n\
        end\n\
    end\n\
	\n\
	--   Player  .	\n\
	local kMyPilot = actor:GetPilot()\n\
	if kMyPilot:IsNil() then return true end\n\
	local kMyUnit = kMyPilot:GetUnit()\n\
	if kMyUnit:IsNil() then return true end\n\
	local kCallerPilot = g_pilotMan:FindPilot(kMyUnit:GetCaller())\n\
	if kCallerPilot:IsNil() then return true end\n\
	local kCallerActor = kCallerPilot:GetActor()\n\
	if kCallerActor:IsNil() then return true end\n\
	local kPlayerPos = kCallerActor:GetPos()\n\
	--Pos\n\
	local kMoveDir = kCallerActor:GetMovingDir()\n\
	local kTarget = kMyPilot:GetTarget()\n\
\n\
	if 0~=actor:GetAbil(AT_AUTO_PET_SKILL) and false==kTarget:IsNil() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local kTargetActor = g_world:FindActor(kTarget)\n\
		if false==kTargetActor:IsNil() then\n\
			local kTargetPos = kTargetActor:GetPos()\n\
			actor:LookAt(kTargetPos, true)\n\
--			ODS(\"  \"..action:GetID()..\" X : \"..kTargetPos:GetX()..\" Y : \"..kTargetPos:GetY()..\"\\n\", false, 912)\n\
			kMoveDir = kTargetPos:_Subtract(actor:GetPos())\n\
			kMoveDir:Unitize()\n\
--			ODS(\"\\nDIr X : \"..kMoveDir:GetX()..\" Y : \"..kMoveDir:GetY()..\" ActorPos X : \"..actor:GetPos():GetX()..\" Y : \"..actor:GetPos():GetY()..\"\\n\\n\", false, 912)\n\
		end\n\
	end\n\
	--actor:SetTraceFlyTargetLoc( kPlayerPos )\n\
	actor:SetMovingDir(kMoveDir);\n\
	actor:FindPathNormal();\n\
\n\
	action:SetParamFloat(15, kMoveDir:GetX());\n\
	action:SetParamFloat(16, kMoveDir:GetY());\n\
	action:SetParamFloat(17, kMoveDir:GetZ());\n\
	action:SetParamFloat(18, tonumber(action:GetScriptParam(\"ROTATION_ANGLE_VALUE_TICK\")));\n\
	\n\
	local fAttackTick = 0.3;\n\
\n\
	if nil ~= tonumber(action:GetScriptParam(\"MOVING_ATTACK_TICK\")) then\n\
		fAttackTick = tonumber(action:GetScriptParam(\"MOVING_ATTACK_TICK\"))\n\
	end\n\
\n\
	action:SetParamAsPoint(7, actor:GetPos());\n\
	action:SetParamFloat(8, timeGetTime());\n\
\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
\n\
	action:SetParamFloat(9, 2000); -- MaxMoveTime\n\
	if false == kSkillDef:IsNil() then\n\
		local iMoveSpeed = kSkillDef:GetAbil(AT_MOVESPEED);\n\
		local iMaxDistance = action:GetParamInt(30)\n\
		action:SetParamFloat(9, iMaxDistance / iMoveSpeed * 1000); -- MaxMoveTime\n\
		if 0 < iMoveSpeed and 0 < iMaxDistance then\n\
			if actor:IsUnderMyControl() then\n\
				if 0.0 < fAttackTick then\n\
					action:StartTimer(iMaxDistance / iMoveSpeed, fAttackTick, 0);\n\
					if 0 == action:GetParamInt(20) then\n\
						local iMaxCount = (iMaxDistance / iMoveSpeed) / fAttackTick;\n\
						action:SetParamInt(iMaxCount);\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	if actor:IsUnderMyControl() then\n\
		if (nil ~= string.find(action:GetID(), \"a_blizzard_pet\")) then\n\
			--action:GetID() == \"a_blizzard_pet_a\" or action:GetID() == \"a_blizzard_pet_b\" or action:GetID() == \"a_blizzard_pet_c\" then			\n\
			local iTotalProjectile = 0;\n\
\n\
			local	kSkillDef = GetSkillDef(action:GetActionNo());\n\
			if kSkillDef:IsNil() == false then\n\
				iTotalProjectile = kSkillDef:GetAbil(AT_PROJECTILE_NUM);\n\
			end\n\
\n\
			action:SetParamInt(100, iTotalProjectile);\n\
			\n\
			local kPos = actor:GetNodeWorldPos(\"char_root\");\n\
\n\
			local fRange = 75;\n\
\n\
			local i = 0;\n\
\n\
			-- 2  .  / \n\
			iTotalProjectile = iTotalProjectile * 2;\n\
			while i < iTotalProjectile do\n\
				local fRandomX = math.random(-fRange,fRange);\n\
				local fRandomY = math.random(-fRange,fRange);\n\
\n\
				if 2 > iTotalProjectile then --   1  \n\
					fRandomX = 0;\n\
					fRandomY = 0;\n\
				end\n\
				local kStartPos = Point3(kPos:GetX() + fRandomX,\n\
										 kPos:GetY() + fRandomY,\n\
										 kPos:GetZ() + 150);\n\
								\n\
				local kEndPos = Point3(kStartPos:GetX(), kStartPos:GetY(), kPos:GetZ());\n\
				\n\
				action:SetParamAsPoint(101 + i, kStartPos);\n\
				action:SetParamAsPoint(101 + i + 1, kEndPos);\n\
\n\
				i=i+2;\n\
			end			\n\
\n\
		elseif (nil ~= string.find(action:GetID(), \"a_meteor_pet\")) then \n\
			--action:GetID() == \"a_meteor_pet_a\" or action:GetID() == \"a_meteor_pet_b\" or action:GetID() == \"a_meteor_pet_c\" then\n\
\n\
			--  .. \n\
			--         .\n\
			--         .\n\
			\n\
			local iTotalProjectile = 1; \n\
			action:SetParamInt(100, iTotalProjectile);\n\
			\n\
			local kPos = actor:GetNodeWorldPos(\"char_root\");\n\
\n\
			local fRange = 75;\n\
\n\
			local i = 0;\n\
			local j = 0;\n\
\n\
			--     \n\
			action:CreateActionTargetList(actor, false);	--    \n\
			local kTargetList = action:GetTargetList();\n\
			local iTargetCount = kTargetList:size();\n\
			local findTarget = false;\n\
			local i=0;\n\
			local j=0;\n\
\n\
			local kStartPos;\n\
			local kEndPos;\n\
			if iTargetCount > 0 then\n\
				while i < iTargetCount do\n\
					local targetInfo = kTargetList:GetTargetInfo(i);\n\
					local targetGUID = targetInfo:GetTargetGUID();\n\
					local targetPilot = g_pilotMan:FindPilot(targetGUID);\n\
					if targetPilot:IsNil() == false then\n\
						local targetActor = targetPilot:GetActor();\n\
						if targetActor:IsNil() == false then\n\
							local targetPos = targetActor:GetPos();\n\
\n\
							kStartPos = Point3(targetPos:GetX(),\n\
										 targetPos:GetY(),\n\
										 targetPos:GetZ() + 150);\n\
								\n\
							kEndPos = Point3(kStartPos:GetX(), kStartPos:GetY(), targetPos:GetZ());						\n\
\n\
							break;\n\
						end\n\
					end\n\
\n\
					i = i + 1;\n\
				end\n\
\n\
				if (nil ~= string.find(action:GetID(), \"a_meteor_pet\")) then \n\
					--action:GetID() == \"a_meteor_pet_a\" or action:GetID() == \"a_meteor_pet_b\" or action:GetID() == \"a_meteor_pet_c\" then --   \n\
					local kMovingDir = actor:GetLookingDir();\n\
") + std::string("					local iAttackRange = action:GetSkillRange(0,actor);\n\
					iAttackRange = iAttackRange * 0.7; -- 2/3   \n\
					kMovingDir:Multiply(iAttackRange);\n\
					kStartPos:Add(kMovingDir);\n\
				end\n\
\n\
				action:SetParamAsPoint(101 + j, kStartPos);\n\
				action:SetParamAsPoint(101 + j + 1, kEndPos);\n\
\n\
				i=i+2;\n\
			else --      .\n\
				local kPos = actor:GetNodeWorldPos(\"char_root\");\n\
				local kMovingDir = actor:GetLookingDir();\n\
				local iAttackRange = action:GetSkillRange(0,actor);\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kPos:Add(kMovingDir);\n\
\n\
				local kStartPos = Point3(kPos:GetX(), kPos:GetY(),kPos:GetZ() + 150);\n\
				local kEndPos = Point3(kStartPos:GetX(), kStartPos:GetY(), kPos:GetZ());\n\
\n\
				action:SetParamAsPoint(101, kStartPos);\n\
				action:SetParamAsPoint(102, kEndPos);\n\
			end\n\
			action:ClearTargetList();	--    \n\
			\n\
		elseif (nil ~= string.find(action:GetID(), \"a_bite_off\")) or (nil ~= string.find(action:GetID(), \"a_body_bump\")) then \n\
			--action:GetID() == \"a_bite_off\" or action:GetID() == \"a_body_bump_a\" or action:GetID() == \"a_body_bump_b\" or action:GetID() == \"a_body_bump_c\"  then\n\
			-- ,  \n\
			action:SetParamAsPoint(7, actor:GetPos())\n\
			\n\
			local kStartPos = actor:GetPos()\n\
			action:CreateActionTargetList(actor, false);\n\
			local kTargetList = action:GetTargetList();\n\
			local iTargetCount = kTargetList:size();\n\
			local findTarget = false;\n\
			local i=0;\n\
			local kEndPos = actor:GetPos()\n\
			if iTargetCount > 0 then\n\
				while i < iTargetCount do\n\
					local targetInfo = kTargetList:GetTargetInfo(i);\n\
					local targetGUID = targetInfo:GetTargetGUID();\n\
					local targetPilot = g_pilotMan:FindPilot(targetGUID);\n\
					if targetPilot:IsNil() == false then\n\
						local targetActor = targetPilot:GetActor();\n\
						if targetActor:IsNil() == false then\n\
							kEndPos = targetActor:GetPos();	\n\
						end\n\
					end\n\
					i = i + 1;\n\
				end\n\
				\n\
				action:SetParamAsPoint(500, kEndPos); --   \n\
				--ODS(\"  :\"..kEndPos:GetX()..\",\"..kEndPos:GetY()..\",\"..kEndPos:GetZ()..\"\\n\", false, 912)\n\
			else\n\
				--ODS(\" \\n\", false, 912)\n\
			end\n\
			action:ClearTargetList();			\n\
		end\n\
	else --  \n\
		local kPacket = action:GetParamAsPacket()\n\
		if nil==kPacket or kPacket:IsNil() then\n\
			return false\n\
		end\n\
		--ODS(\"  \\n\", false, 912)\n\
		\n\
		if (nil ~= string.find(action:GetID(), \"a_bite_off\")) or (nil ~= string.find(action:GetID(), \"a_body_bump\"))\n\
			--action:GetID() == \"a_bite_off\" or action:GetID() == \"a_body_bump_a\" or action:GetID() == \"a_body_bump_b\" or action:GetID() == \"a_body_bump_c\" --  \n\
		then\n\
			action:SetParamAsPoint(500, kPacket:PopPoint3());		--   \n\
			\n\
			local kEndPos = action:GetParamAsPoint(500)\n\
			actor:LookAt(kEndPos, true)\n\
			--ODS(\" :\"..kEndPos:GetX()..\",\"..kEndPos:GetY()..\",\"..kEndPos:GetZ()..\"\\n\", false, 912)\n\
		else   \n\
			local iTotalProjectile = kPacket:PopInt();\n\
			action:SetParamInt(100, iTotalProjectile);\n\
\n\
			local i = 0;\n\
			-- 2  .  / \n\
			iTotalProjectile = iTotalProjectile * 2;\n\
			while i < iTotalProjectile do\n\
\n\
				action:SetParamAsPoint(101 + i, kPacket:PopPoint3());		--  \n\
				action:SetParamAsPoint(101 + i + 1, kPacket:PopPoint3());	--   	\n\
\n\
				i=i+2;	--   \n\
			end\n\
		end\n\
		\n\
	end\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnOverridePacket(actor, action, packet)\n\
\n\
	if (nil ~= string.find(action:GetID(), \"a_blizzard_pet\")) or (nil ~= string.find(action:GetID(), \"a_meteor_pet\")) then\n\
		--action:GetID() == \"a_blizzard_pet_a\" or action:GetID() == \"a_blizzard_pet_b\" or action:GetID() == \"a_blizzard_pet_c\" \n\
		--or action:GetID() == \"a_meteor_pet_a\" or action:GetID() == \"a_meteor_pet_b\" or action:GetID() == \"a_meteor_pet_c\" then\n\
		\n\
		local iTotalProjectile = action:GetParamInt(100)\n\
		packet:PushInt(iTotalProjectile)\n\
		\n\
		-- 2  .  / \n\
		local i = 0;\n\
		iTotalProjectile = iTotalProjectile * 2;\n\
		while i < iTotalProjectile do\n\
			packet:PushPoint3(action:GetParamAsPoint(101 + i));\n\
			packet:PushPoint3(action:GetParamAsPoint(101 + i + 1));\n\
			i=i+2;\n\
		end	\n\
		\n\
	elseif (nil ~= string.find(action:GetID(), \"a_bite_off\")) or (nil ~= string.find(action:GetID(), \"a_body_bump\")) then\n\
		--action:GetID() == \"a_bite_off\" or action:GetID() == \"a_body_bump_a\" or action:GetID() == \"a_body_bump_b\" or action:GetID() == \"a_body_bump_c\" then\n\
		--  ,  \n\
		local kEndPos = action:GetParamAsPoint(500)\n\
		packet:PushPoint3(kEndPos)\n\
		--ODS(\"  :\"..kEndPos:GetX()..\",\"..kEndPos:GetY()..\",\"..kEndPos:GetZ()..\"\\n\", false, 912)\n\
	end\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:SetParam(\"SKILL_STATE\", \"USING\")\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Act_Pet_Melee_Default_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	action:SetParamInt(2, 0);\n\
\n\
	local iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
\n\
	action:SetParamInt(20, iTotalHit); -- MaxHitCount     Max\n\
	action:SetParamInt(21,0); -- HitCount\n\
	action:SetParamInt(22,0); -- Hit   DashStop (     )\n\
\n\
	local iHitRunEnd = 0;\n\
	if action:GetScriptParam(\"HIT_RUN_STOP\") == \"TRUE\" then\n\
		iHitRunEnd = 1;		\n\
	end\n\
\n\
	action:SetParamInt(23,iHitRunEnd); --   \n\
	action:SetParamInt(24,0); --   \n\
	action:SetParamInt(25,0); --   \n\
\n\
	local iMaxDistance = 0;\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
	if false == kSkillDef:IsNil() then\n\
		iMaxDistance = kSkillDef:GetAbil(AT_DISTANCE);		\n\
	end	\n\
\n\
	action:SetParamInt(30, iMaxDistance); -- Max Distance\n\
	\n\
	Act_Pet_Melee_Default_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	if 1 == action:GetParamInt(22) and action:GetParamInt(20) == action:GetParamInt(21) then\n\
		return false\n\
	end\n\
\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
\n\
	local iRotValue = action:GetParamFloat(18);\n\
	if nil ~= iRotValue and 0 ~= iRotValue then\n\
		actor:IncRotate(frameTime*15*360.0*math.pi/180.0);\n\
	end\n\
\n\
	if false == kSkillDef:IsNil() then\n\
		local iMoveSpeed = kSkillDef:GetAbil(AT_MOVESPEED);\n\
\n\
		if 0 < iMoveSpeed and 0 == action:GetParamInt(25) then\n\
			local kNewPos = actor:GetPos();\n\
			local kOldPos = action:GetParamAsPoint(7);\n\
			kOldPos:SetZ(0)\n\
			kNewPos:SetZ(0); --Z  .     \n\
\n\
			local iMaxDistance = action:GetParamInt(30);\n\
			local iHitRunEnd = action:GetParamInt(23)\n\
			--ODS(\"GetParamInt(23):\"..iHitRunEnd..\"\\n\", false, 912)\n\
			local kMovingDir = nil;\n\
			if 1 == iHitRunEnd then\n\
				local kStartPos = action:GetParamAsPoint(7);\n\
					\n\
				if actor:IsUnderMyControl() then					\n\
					action:CreateActionTargetList(actor, false);\n\
					local kTargetList = action:GetTargetList();\n\
					local iTargetCount = kTargetList:size();\n\
					local findTarget = false;\n\
					local i=0;\n\
					if iTargetCount > 0 then\n\
						while i < iTargetCount do\n\
							local targetInfo = kTargetList:GetTargetInfo(i);\n\
							local targetGUID = targetInfo:GetTargetGUID();\n\
							local targetPilot = g_pilotMan:FindPilot(targetGUID);\n\
							if targetPilot:IsNil() == false then\n\
								local targetActor = targetPilot:GetActor();\n\
								if targetActor:IsNil() == false then\n\
									local targetPos = targetActor:GetPos();\n\
									local distance = kStartPos:Distance(targetPos);\n\
									iMaxDistance = distance;\n\
									--          .\n\
									ODS(\" Dist:\"..distance..\"\\n\", false, 912)\n\
									break;\n\
								end\n\
							end\n\
							i = i + 1;\n\
						end\n\
					end\n\
					action:ClearTargetList();					\n\
				else\n\
					local targetPos = action:GetParamAsPoint(500)\n\
					local distance = kStartPos:Distance(targetPos);\n\
					iMaxDistance = distance;\n\
--					ODS(\" Dist:\"..distance..\"\\n\", false, 912)\n\
					kMovingDir = targetPos:_Subtract(kStartPos)\n\
					kMovingDir:Unitize()\n\
				end\n\
			end\n\
\n\
			action:SetParamInt(30, iMaxDistance); -- Max Distance\n\
\n\
			local fDistance = kNewPos:Distance(kOldPos);\n\
			\n\
			--   \n\
			if 0.0 < fDistance then\n\
				--  \n\
				local fDistance2 = iMaxDistance - fDistance;\n\
\n\
				--     \n\
				--       .\n\
				local kDirection = kNewPos:_Subtract(kOldPos);\n\
				kDirection:Unitize();\n\
				kDirection:Multiply(iMoveSpeed * frameTime);\n\
				kDirection:Add(kNewPos);\n\
\n\
				--    \n\
				local fDistance3 = kDirection:Distance(kOldPos);\n\
\n\
				--      \n\
				if iMaxDistance - fDistance3 < 0 then\n\
					--ODS(\"  \\n\",false, 912)\n\
					action:SetParamInt(25,1)					\n\
					return Act_Pet_Melee_Default_PlayNextAction(actor,action,iHitRunEnd);\n\
				end\n\
\n\
				if action:GetParamFloat(9) < timeGetTime() - action:GetParamFloat(8) then\n\
					--ODS(\"    \\n\",false, 912)\n\
					action:SetParamInt(25,1)\n\
					return Act_Pet_Melee_Default_PlayNextAction(actor,action,iHitRunEnd);\n\
				end\n\
			end\n\
\n\
			local fAnimSpeed = iMoveSpeed / 150;			\n\
			actor:SetAnimSpeed(fAnimSpeed);\n\
			\n\
			if nil ~= iRotValue and 0 ~= iRotValue then\n\
--				ODS(\"  \\n\", false, 912)\n\
				kMovingDir = Point3(action:GetParamFloat(15),action:GetParamFloat(16),action:GetParamFloat(17));\n\
			elseif (nil == kMovingDir) then\n\
--				ODS(\"   \\n\", false, 912)\n\
				kMovingDir = actor:GetLookingDir();\n\
			end\n\
			\n\
\n\
			kMovingDir:Multiply(iMoveSpeed);\n\
			\n\
			actor:SetMovingDelta(kMovingDir);\n\
			--ODS(\"\\n\",false, 912)\n\
		end\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	actor:SetParam(\"SKILL_STATE\", \"END\" )\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_trace_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
	\n\
--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end	\n\
	return true;\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_trace_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
") + std::string("\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Pet_Melee_Default_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
\n\
function Act_Pet_Melee_Default_HitOneTime(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
		local fHitEffectScale = 1\n\
		if(nil ~= string.find(action:GetID(), \"a_bite_off\")) then			\n\
			local iSkillLevel = action:GetAbil(AT_LEVEL);\n\
			local fIncScale = 0.05*iSkillLevel	--1LV 75%, 2Lv 80%, 3Lv 85%, 4Lv 90%, 5Lv 100%\n\
			fHitEffectScale = 0.7 + fIncScale\n\
			ODS(\"Level:\"..iSkillLevel..\" Scale:\"..fHitEffectScale..\"\\n\",false, 912)\n\
			if (1<fHitEffectScale) then fHitEffectScale = 1 end\n\
		end\n\
		\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticleS(7214,kHitEffectTargetNodeID,kHitEffectID,fHitEffectScale);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticleS(7214,kHitEffectTargetNodeID,kHitEffectID,fHitEffectScale);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPointS(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID,fHitEffectScale);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion(), fHitEffectScale)\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = action:GetParamInt(20)\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Act_Pet_Melee_Default_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Act_Pet_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
    if bIsBefore == false then\n\
\n\
		if actor:IsUnderMyControl()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
        		\n\
		--  hit  \n\
        --    .\n\
        Act_Pet_Melee_Default_HitOneTime(actor,action);\n\
		action:SetParamInt(24,action:GetParamInt(24) + 1);	\n\
        \n\
    end\n\
\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if 0 < kAction:GetParamInt(23) and 0 == kAction:GetParamInt(25) then\n\
			--   hit  \n\
			--     \n\
			return true;\n\
		end\n\
\n\
		local kProjectileID = kAction:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
		if (nil ~= string.find(kAction:GetID(), \"a_blizzard_pet\")) or (nil ~= string.find(kAction:GetID(), \"a_meteor_pet\")) then\n\
			--kAction:GetID() == \"a_blizzard_pet_a\" or kAction:GetID() == \"a_blizzard_pet_b\" or kAction:GetID() == \"a_blizzard_pet_c\" or \n\
			--kAction:GetID() == \"a_meteor_pet_a\" or kAction:GetID() == \"a_meteor_pet_b\" or kAction:GetID() == \"a_meteor_pet_c\" then\n\
			local kProjectileMan = GetProjectileMan();\n\
\n\
			local kPos = actor:GetNodeWorldPos(\"char_root\");\n\
\n\
			local iTotalProjectile = kAction:GetParamInt(100);\n\
			\n\
			if 0 == iTotalProjectile then\n\
				return true;\n\
			end\n\
\n\
			local i = 0;\n\
			local j = 0;\n\
			local k = 0;\n\
			local fFireDelay = 0.5;\n\
			local fRange = 75;\n\
\n\
			local	kProjectileID2 = kAction:GetScriptParam(\"PROJECTILE_ID\");\n\
\n\
			if \"\" ~= kProjectileID2 then\n\
				while i < iTotalProjectile do\n\
					local kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID2, actor:GetAction(), actor:GetPilotGuid());\n\
					if false == kNewArrow:IsNil() then\n\
						kNewArrow:SetMultipleAttack(true)\n\
						local kStartPos = kAction:GetParamAsPoint(101 + k);\n\
						local kEndPos = kAction:GetParamAsPoint(101 + k + 1);\n\
\n\
						if (nil ~= string.find(kAction:GetID(), \"a_meteor_pet\")) then --   \n\
							--kAction:GetID() == \"a_meteor_pet_a\" or kAction:GetID() == \"a_meteor_pet_b\" or kAction:GetID() == \"a_meteor_pet_c\" then \n\
							local kMovingDir = actor:GetLookingDir();\n\
							local iAttackRange = kAction:GetSkillRange(0,actor);\n\
							iAttackRange = iAttackRange * 0.7; -- 2/3   \n\
							kMovingDir:Multiply(iAttackRange);\n\
							kStartPos:Add(kMovingDir);\n\
						end\n\
\n\
						kNewArrow:LoadToPosition(kStartPos);	--				\n\
						kNewArrow:SetParamValue(\"index\", tostring(i))\n\
						kNewArrow:SetTargetLoc(kEndPos);\n\
						--         \n\
						kNewArrow:DelayFire(fFireDelay * j + (math.random(-3, 3) / 10) ,true);\n\
						kNewArrow:SetParentPilotGuid(actor:GetPilotGuid());\n\
						kNewArrow:SetHide(true);\n\
					end\n\
					i=i+1;\n\
					k=k+2;\n\
\n\
					-- 4    \n\
					if i % 4 == 0 then\n\
						j=j+1;\n\
					end\n\
				end\n\
			end\n\
		elseif kProjectileID ~= nil and \"\" ~= kProjectileID then\n\
			local	kProjectileMan = GetProjectileMan();\n\
			local	kArrow = Projectile_Default_LoadToWeapon(actor,kAction);				\n\
\n\
			if kArrow:IsNil() == false then\n\
				local	kMovingDir = actor:GetLookingDir();	--    \n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
\n\
				kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
\n\
				local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
			\n\
				kMovingDir:Multiply(iAttackRange);\n\
				kMovingDir:Add(arrow_worldpos);\n\
				kArrow:SetTargetLoc(kMovingDir);\n\
\n\
				local iPentrationCount = kAction:GetScriptParam(\"PENETRATION_COUNT\");\n\
				if iPentrationCount == nil then\n\
					iPentrationCount = \"0\";\n\
				end\n\
\n\
				kArrow:SetPenetrationCount(tonumber(iPentrationCount))--   \n\
				if iPentrationCount ~= 0 then\n\
					kArrow:SetMultipleAttack(true);\n\
				end\n\
				\n\
				kArrow:Fire();\n\
			end\n\
		else\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
\n\
				local	iHitCount = kAction:GetParamInt(21);\n\
				local	iTotalHit = kAction\n\
					:GetParamInt(20);\n\
\n\
				--        \n\
				if 0 ~= iTotalHit and iHitCount == iTotalHit then \n\
					return false\n\
				end\n\
			\n\
				if actor:IsUnderMyControl() then\n\
					kAction:CreateActionTargetList(actor);\n\
\n\
					if IsSingleMode() then			        \n\
						Act_Pet_Melee_Default_HitOneTime(actor,kAction)\n\
						Act_Pet_Melee_Default_OnTargetListModified(actor,kAction,false)\n\
			            \n\
						return;\n\
					else\n\
						if(0 == kAction:GetAbil(AT_CLASS)) then\n\
							kAction:BroadCastTargetListModify(actor:GetPilot());\n\
						end\n\
					end\n\
\n\
				end	\n\
			end\n\
		end\n\
\n\
\n\
		Act_Pet_Melee_Default_HitOneTime(actor,kAction);\n\
\n\
		--kAction:ClearTargetList();	\n\
\n\
		if kProjectileID ~= nil and \"\" ~= kProjectileID then\n\
			actor:ClearIgnoreEffectList();			\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Pet_Melee_Default_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(21);\n\
	local	iTotalHit = action:GetParamInt(20);\n\
\n\
	--        \n\
	if 0 ~= iTotalHit and iHitCount == iTotalHit then \n\
		return true\n\
	end\n\
\n\
	action:CreateActionTargetList(actor);\n\
	\n\
	if IsSingleMode() then\n\
    \n\
		Act_Pet_Melee_Default_HitOneTime(actor,action)\n\
		Act_Pet_Melee_Default_OnTargetListModified(actor,action,false)\n\
        \n\
		return true;\n\
	else\n\
\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
\n\
		if 0 < iTargetCount then\n\
			if(0 == action:GetAbil(AT_CLASS)) then\n\
				action:BroadCastTargetListModify(actor:GetPilot());\n\
			end			\n\
		end\n\
\n\
		Act_Pet_Melee_Default_HitOneTime(actor,action)\n\
	end\n\
\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(21,iHitCount);\n\
	\n\
	return	true\n\
\n\
end\n\
\n\
function Act_Pet_Melee_Default_PlayNextAction(actor, action,iHitRunEnd)\n\
\n\
	if 2 < action:GetSlotCount() and action:GetSlotCount() - 1 > action:GetCurrentSlot() then --  ,   0 \n\
		action:SetSlot(action:GetCurrentSlot()+1);\n\
		actor:PlayCurrentSlot();\n\
		return true;\n\
	elseif 1 == iHitRunEnd and 2 == action:GetSlotCount() and action:GetSlotCount() - 1 == action:GetCurrentSlot() then --    +  2 \n\
		if true == actor:IsUnderMyControl() then\n\
			local	iHitCount = action:GetParamInt(21);\n\
			local	iTotalHit = action:GetParamInt(20);\n\
\n\
			--        \n\
			if 0 ~= iTotalHit and iHitCount == iTotalHit then \n\
				return false\n\
			end\n\
\n\
			action:CreateActionTargetList(actor);\n\
			if(0 == action:GetAbil(AT_CLASS)) then\n\
				action:BroadCastTargetListModify(actor:GetPilot());\n\
			end\n\
			Act_Pet_Melee_Default_HitOneTime(actor,action)\n\
\n\
			return false;\n\
		end\n\
	end	\n\
\n\
	return false;\n\
end") );
	m_kContLuaText.push_back(std::string("-- [ATTACK_TIME] :    \n\
\n\
function Skill_Pet_CloudFire_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
	\n\
	action:SetParamInt(4,0);\n\
	\n\
	--          \n\
	local	iAttackRange = action:GetSkillRange(0,actor, true);\n\
	local fCloudScale = iAttackRange/100\n\
	actor:SetTargetScale(fCloudScale)\n\
--	ODS(\" iAttackRange:\"..iAttackRange..\"\\n\",false, 912)\n\
	\n\
--   \n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 3.0;\n\
    end	\n\
	action:SetParamFloat(9,fLifeTime)\n\
	action:SetParamFloat(10,action:GetAbil(AT_COUNT));\n\
	\n\
	local iAttackTickTime = action:GetAbil(AT_COUNT);\n\
	if iAttackTickTime == 0 then\n\
		iAttackTickTime = 0.3;\n\
	else\n\
		 iAttackTickTime = fLifeTime/action:GetAbil(AT_COUNT);\n\
--		 ODS(\":\"..fLifeTime..\"\\natcount:\"..action:GetAbil(AT_COUNT)..\"\\n : \"..iAttackTickTime..\"\\n\", false, 912)\n\
	end	\n\
	action:SetParamFloat(11,iAttackTickTime);\n\
	\n\
    action:CreateActionTargetList(actor);	    \n\
    if IsSingleMode() or action:GetTargetCount() == 0 then	    \n\
        Skill_Pet_CloudFire_OnTargetListModified(actor,action,false);	    \n\
    else	    \n\
        action:BroadCastTargetListModify(actor:GetPilot());\n\
        action:ClearTargetList();	    \n\
    end	   \n\
\n\
	return true\n\
end\n\
\n\
function Skill_Pet_CloudFire_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	kParam:SetParam_1(kPos,kDir);\n\
   	kParam:SetParam_2(iAttackRange,30,50,0);\n\
\n\
	local strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(iAttackRange,30,50,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(iAttackRange,60,50,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(0,0,iAttackRange,0);\n\
	end\n\
	\n\
	return action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Pet_CloudFire_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
		\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end			\n\
    end\n\
\n\
end\n\
\n\
function Skill_Pet_CloudFire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(4);\n\
	\n\
	local   fLifeTime = action:GetParamFloat(9)	\n\
	local iAttackTickTime = action:GetParamFloat(11)	\n\
	local   fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
	--ODS(\"fElapsedTIme>iAttackTickTime:\"..fElapsedTIme..\" > \"..iAttackTickTime..\"\\n\", false, 912)\n\
	\n\
	if fElapsedTIme > iAttackTickTime then\n\
--		ODS(\" \\n\", false, 912)\n\
	    action:SetParamFloat(1,accumTime);\n\
	    action:CreateActionTargetList(actor);\n\
	    \n\
	    if IsSingleMode() or action:GetTargetCount() == 0 then	    \n\
	        Skill_Pet_CloudFire_OnTargetListModified(actor,action,false);	    \n\
	    else	    \n\
	        action:BroadCastTargetListModify(actor:GetPilot());\n\
	        action:ClearTargetList();\n\
	    end	    \n\
	end\n\
\n\
	if iSlotNum == 0 then\n\
		local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
		if fTotalElapsedTime > fLifeTime then\n\
			actor:PlayNext();\n\
		end\n\
\n\
	elseif iSlotNum == 1 then\n\
	\n\
		if iState == 0 then\n\
			action:SetParamInt(4,1);\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
		end\n\
	end\n\
\n\
	if iState == 1 then\n\
		if accumTime - action:GetParamFloat(6) > 0.4 then\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.7);\n\
			action:SetParamInt(4,2);\n\
		end\n\
	elseif iState == 2 then\n\
		if accumTime - action:GetParamFloat(6) > 1.0 then\n\
			return false;\n\
		end\n\
	end\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Pet_CloudFire_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_Pet_CloudFire_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iSlotNum = action:GetCurrentSlot();\n\
\n\
	if iSlotNum == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Pet_CloudFire_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("function Act_Pet_AIOnOff_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return true\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	actor:SetAttackState(1)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnFindTarget(actor,action,kTargets)\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnUpdate(actor, accumTime, frameTime)\n\
	return false\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Pet_AIOnOff_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Pet_Mount_OnCheckCanEnter(actor,action)\n\
	local kMyPilot = actor:GetPilot()\n\
	if kMyPilot:IsNil() then return false end\n\
	local kMyUnit = kMyPilot:GetUnit()\n\
	if kMyUnit:IsNil() then return false end\n\
	local kCallerPilot = g_pilotMan:FindPilot(kMyUnit:GetCaller())\n\
	if kCallerPilot:IsNil() then return false end\n\
	local kCallerActor = kCallerPilot:GetActor()\n\
	if kCallerActor:IsNil() then return false end		\n\
	local kCallerAction = kCallerActor:GetAction()\n\
	if kCallerAction:IsNil() then return false end\n\
	\n\
	local kCurPetAction = actor:GetAction()\n\
	if kCurPetAction:IsNil() == false and kCurPetAction:GetID() == \"a_pet_melee_02\" then --  ,          ( )\n\
		return false\n\
	end\n\
	--/  \n\
	if kCallerActor:IsRidingPet() then --       \n\
		if kCallerAction:GetID() ~= \"a_idle\" and\n\
			kCallerAction:GetID() ~= \"a_rp_idle\" and\n\
			kCallerAction:GetID() ~= \"a_rp_walk\" and\n\
			kCallerAction:GetID() ~= \"a_lock_move\" and\n\
			kCallerAction:GetID() ~= \"a_unlock_move\" and\n\
			kCallerAction:GetID() ~= \"a_dmg\" and\n\
			kCallerAction:GetID() ~= \"a_down_damage\" and\n\
			kCallerAction:GetID() ~= \"a_down_damage_2\" and\n\
			kCallerAction:GetID() ~= \"a_die\" and\n\
			kCallerAction:GetID() ~= \"a_trap\" and\n\
			kCallerAction:GetID() ~= \"a_walk\" and\n\
			kCallerAction:GetID() ~= \"a_walk_left\" and\n\
			kCallerAction:GetID() ~= \"a_walk_right\" and\n\
			kCallerAction:GetID() ~= \"a_walk_up\" and\n\
			kCallerAction:GetID() ~= \"a_walk_down\" and\n\
			kCallerAction:GetID() ~= \"a_run\" and\n\
			kCallerAction:GetID() ~= \"a_run_left\" and\n\
			kCallerAction:GetID() ~= \"a_run_right\" and\n\
			kCallerAction:GetID() ~= \"a_run_up\" and\n\
			kCallerAction:GetID() ~= \"a_run_down\" and\n\
			kCallerAction:GetID() ~= \"a_battle_idle\" and\n\
			kCallerAction:GetID() ~= \"a_knockdown\" and\n\
			kCallerAction:GetID() ~= \"a_fall\" and\n\
			kCallerAction:GetID() ~= \"a_lightning_default\" and\n\
			kCallerAction:GetID() ~= \"a_lightning_low\" and\n\
			kCallerAction:GetID() ~= \"a_lightning_float_dmg\" and\n\
			kCallerAction:GetID() ~= \"a_lightning_throw_down\" and\n\
			kCallerAction:GetID() ~= \"a_throw_down\" and\n\
			kCallerAction:GetID() ~= \"a_throw_down2\" and\n\
			kCallerAction:GetID() ~= \"a_stun\" and\n\
			kCallerAction:GetID() ~= \"a_knock_back\" and\n\
			kCallerAction:GetID() ~= \"a_float_dmg\" and\n\
			kCallerAction:GetID() ~= \"a_hold_down\" and\n\
			kCallerAction:GetID() ~= \"a_touch_dmg\" and\n\
			kCallerAction:GetID() ~= \"a_creep_down\" and\n\
			kCallerAction:GetID() ~= \"a_blow_up\" and\n\
			kCallerAction:GetID() ~= \"a_blow_up_large\" and\n\
			kCallerAction:GetID() ~= \"a_blow_up_medium\" and\n\
			kCallerAction:GetID() ~= \"a_blow_up_small\" and\n\
			kCallerAction:GetID() ~= \"a_blow_down\" then\n\
			return false\n\
		end\n\
	else --       \n\
		--    \n\
		if kCallerActor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_transform_to_mahalka_Fig\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_transform_to_mahalka_Mag\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_transform_to_mahalka_Arc\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_transform_to_mahalka_Thi\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_barricade\") or\n\
			--kCallerActor:CheckStatusEffectExist(\"se_TimeReverse_Caster\") or --   \n\
			--kCallerActor:CheckStatusEffectExist(\"se_OffecsiveAura_Caster\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_burrow\") or\n\
			kCallerActor:CheckStatusEffectExist(\"se_transform_to_fu_box\") or \n\
			kCallerActor:CheckStatusEffectExist(\"se_twin_fusion\")\n\
			then\n\
			g_ChatMgrClient:Notice_Show(GetTextW(451003), 1) --    .\n\
			return false\n\
		end\n\
		if kCallerActor:CheckStatusEffectTypeExist(2) or\n\
			kCallerActor:CheckStatusEffectExist(\"se_ProtectEdge\") then --   \n\
			g_ChatMgrClient:Notice_Show(GetTextW(451006), 1) --   \n\
			return false\n\
		end\n\
		\n\
		if kCallerAction:GetID() ~= \"a_idle\" and\n\
			kCallerAction:GetID() ~= \"a_rp_idle\" and\n\
			kCallerAction:GetID() ~= \"a_rp_walk\" and\n\
			kCallerAction:GetID() ~= \"a_walk\" and\n\
			kCallerAction:GetID() ~= \"a_walk_left\" and\n\
			kCallerAction:GetID() ~= \"a_walk_right\" and\n\
			kCallerAction:GetID() ~= \"a_walk_up\" and\n\
			kCallerAction:GetID() ~= \"a_walk_down\" and\n\
			kCallerAction:GetID() ~= \"a_run\" and\n\
			kCallerAction:GetID() ~= \"a_run_left\" and\n\
			kCallerAction:GetID() ~= \"a_run_right\" and\n\
			kCallerAction:GetID() ~= \"a_run_up\" and\n\
			kCallerAction:GetID() ~= \"a_run_down\" and\n\
			kCallerAction:GetID() ~= \"a_battle_idle\" and\n\
			kCallerAction:GetID() ~= \"a_step_the_beat\" and\n\
			kCallerAction:GetID() ~= \"a_step_the_beat_idle\" then\n\
			return false\n\
		end\n\
	end\n\
	\n\
	if kCallerActor:IsMyActor() and actor:IsRidingPet() then --\n\
		local kWnd = GetUIWnd(\"SFRM_TRANSTOWER\")\n\
		if kWnd:IsNil() == false then\n\
			local kWndByPet = kWnd:GetControl(\"FRM_CALLER_IS_PET\") --   UI  \n\
			if kWndByPet:IsNil() == false and kWndByPet:IsVisible() == true then\n\
				kWnd:Close() -- \n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Pet_Mount_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Pet_Mount_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_Pet_Mount_OnFindTarget(actor,action,kTargets)\n\
end\n\
\n\
function Act_Pet_Mount_OnUpdate(actor, accumTime, frameTime)\n\
	return false\n\
end\n\
\n\
function Act_Pet_Mount_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Pet_Mount_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Pet_Mount_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Pet_Call_Trans_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kCallerActor = actor:GetMountTargetPet()\n\
	if kCallerActor:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	local kCallerAction = kCallerActor:GetAction()\n\
	if kCallerAction:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	if actor:IsMeetFloor() == false or (kCallerAction:GetID() ~= \"a_rp_idle\" and kCallerAction:GetID() ~= \"a_rp_walk\") then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kCallerActor = actor:GetCallerActor()\n\
	if kCallerActor:IsNil() or kCallerActor:IsMyActor() == false then\n\
		return false\n\
	end\n\
	if kCallerActor:IsRidingPet() == false then --     !!\n\
		g_ChatMgrClient:Notice_Show(GetTextW(451005), 1)\n\
		return false\n\
	end\n\
	action:SetNextActionName(\"a_riding_ground\")	\n\
	CallPetTRANSPORT(actor:GetPilotGuid())\n\
\n\
	return true\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnFindTarget(actor,action,kTargets)\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnUpdate(actor, accumTime, frameTime)\n\
	return false\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Pet_Call_Trans_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function PetMeleeRiding_OnCheckCanEnter(actor,action)\n\
	if nil==actor or actor:IsNil() then\n\
		return false\n\
	end\n\
	if nil==action or action:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	--  \n\
	local kCurAction = actor:GetAction()\n\
	if nil == kCurAction or kCurAction:IsNil() then\n\
		return false\n\
	end\n\
	if kCurAction:GetID() == \"a_pet_melee_02\" and actor:CheckCanRidingAttack() == false then\n\
		return false\n\
	end\n\
	if kCurAction:GetID() ~= \"a_riding_ground\" and kCurAction:GetID() ~= \"a_pet_melee_01\" then\n\
		AddWarnDataTT(451005)\n\
		return false\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function PetMeleeRiding_OnEnter(actor, action)\n\
	if nil==actor or actor:IsNil() then\n\
		return false\n\
	end\n\
	if nil==action or action:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	if actor:CheckCanRidingAttack() then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
\n\
	actor:ResetAnimation();\n\
	action:SetSlot(0)\n\
	actor:PlayCurrentSlot(true)\n\
	\n\
	return true\n\
end\n\
\n\
function PetMeleeRiding_OnFindTarget(actor,action,kTargets)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if actor:CheckCanRidingAttack() == false then\n\
		return 0\n\
	end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
end\n\
\n\
function PetMeleeRiding_OnUpdate(actor, accumTime, frameTime)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	\n\
	if animDone == true then\n\
		return false\n\
		--return	MagicianShot_Finished(actor,action);\n\
	end\n\
\n\
	if actor:CheckCanRidingAttack() == true then\n\
		local fMovingSpeed = 0;\n\
		if IsSingleMode() == true then\n\
			fMovingSpeed = 120\n\
		else\n\
			fMovingSpeed = actor:GetAbil(AT_C_MOVESPEED)\n\
		end	\n\
\n\
		local dir = actor:GetDirection()\n\
		if dir ~= DIR_NONE then\n\
			actor:Walk(dir, fMovingSpeed)\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function PetMeleeRiding_OnEvent(actor, textKey)\n\
end\n\
\n\
function PetMeleeRiding_OnLeave(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local nextActionName = action:GetID()\n\
	if nextActionName ~= \"a_riding_ground\" then\n\
		return false\n\
	end\n\
--	if action:GetID() == \"a_pet_melee_01\" then\n\
--	end\n\
	\n\
	return true\n\
end\n\
\n\
function PetMeleeRiding_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Earthquake_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_Earthquake_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		local CastEffect = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT\", \"earthquake_battleidle\"):GetStr()\n\
		if nil~=CastEffect and \"\"~=CastEffect then\n\
			local CastEffectNode = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT_NODE\",\"earthquake_battleidle\"):GetStr()\n\
			if nil==CastEffectNode or \"\"==CastEffectNode then\n\
				CastEffectNode = \"Bip01 Prop1\"\n\
			end\n\
			actor:AttachParticle(3251,CastEffectNode ,CastEffect)\n\
-- \n\
		end\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
			return	false\n\
		end\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_Earthquake_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Earthquake_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_Earthquake_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Earthquake_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_Mon_Earthquake_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Earthquake_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Earthquake_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Earthquake_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_Earthquake_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if iState == 3 then\n\
			if actor:IsAnimationDone() == true then\n\
				return false;\n\
			end\n\
		else\n\
			if actor:IsAnimationDone() == true then\n\
			\n\
				local	iHitCount = action:GetParamInt(1)\n\
			\n\
				if iHitCount>=5 then\n\
					return Act_Mon_Earthquake_SetState(actor,action,\"RETURN\")\n\
				end\n\
			end\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Earthquake_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Earthquake_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Earthquake_OnCleanUp(actor, action)\n\
\n\
	actor:DetachFrom(3251);\n\
\n\
end\n\
\n\
function Act_Mon_Earthquake_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Act_Mon_Earthquake_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if bIsBefore == false then\n\
	\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
	\n\
	end\n\
\n\
end\n\
\n\
function Act_Mon_Earthquake_OnTimer(actor,accumtime,action,iTimerID)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local	iHitCount = action:GetParamInt(1)\n\
	if iHitCount == 5 then\n\
		return	false\n\
	end\n\
	\n\
	local	kLookDir = actor:GetLookingDir()\n\
	local	fPreDistance = 100	--    \n\
	local	fDistance = 30.0	--    \n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
	if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
		fPreDistance = kSkillDef:GetAbil(AT_SKILL_MIN_RANGE)\n\
		\n\
		local iSkillRange = kSkillDef:GetAbil(AT_ATTACK_RANGE)\n\
		if 0 < iSkillRange then\n\
			fDistance = (iSkillRange-fPreDistance)*0.2--5 \n\
		end\n\
	end\n\
\n\
	local kFirePos = nil\n\
	local FireNode = actor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil~=FireNode and \"\"~=FireNode then\n\
		kFirePos = actor:GetNodeTranslate(FireNode)\n\
	end\n\
	if nil==kFirePos then\n\
		kFirePos = actor:GetPos()\n\
	end\n\
\n\
	local	kNextPos = kFirePos:_Add(kLookDir:_Multiply(fPreDistance+iHitCount*fDistance))\n\
	\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
	if fireEffect ~= nil and \"\" ~= fireEffect then\n\
		local rot = 0--Random()%(math.pi)\n\
		local scale = actor:GetAnimationInfo(\"RANDOM_SCALE\")\n\
		if nil == scale then\n\
			scale = 1\n\
		else\n\
			scale = 1 + (Random()%(scale*100)/100-scale*0.5) -- scale  \n\
			rot = Random()%(math.pi)\n\
		end\n\
\n\
		local quat = Quaternion(rot, Point3(0,0,1))\n\
		actor:AttachParticleToPointWithRotate(31+iHitCount,kNextPos,fireEffect,quat,scale)\n\
	end				\n\
\n\
	iHitCount = iHitCount +1;\n\
	action:SetParamInt(1,iHitCount);\n\
	\n\
	return	iHitCount<5;\n\
\n\
end\n\
\n\
function Act_Mon_Earthquake_OnEvent(actor,textKey)\n\
\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
		if( CheckNil(nil==actor) ) then return false end\n\
		if( CheckNil(actor:IsNil()) ) then return false end		\n\
\n\
		local   action = actor:GetAction();\n\
\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
		if action:GetActionParam() == AP_CASTING then\n\
			return\n\
		end\n\
	\n\
		local FireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT2\")\n\
		if nil~=FireEffect and \"\"~=FireEffect then\n\
			local FireEffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE2\")\n\
			if nil==FireEffectNode or \"\"==FireEffectNode then\n\
				FireEffectNode = \"char_root\"\n\
			end\n\
			actor:AttachParticle(3252, FireEffectNode ,FireEffect)\n\
		end\n\
		local kQuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")\n\
		if nil==kQuakeFactor or \"\"==kQuakeFactor then\n\
			kQuakeFactor = 5\n\
		else\n\
			kQuakeFactor = tonumber(kQuakeFactor)\n\
		end\n\
		\n\
		local kQuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil==kQuakeTime or \"\"==kQuakeTime then\n\
			kQuakeTime = 1\n\
		elseif \"NONE\"==kQuakeTime then\n\
		else\n\
			kQuakeTime = tonumber(kQuakeTime)\n\
		end\n\
		\n\
		if \"NONE\"~=kQuakeTime then\n\
			QuakeCamera(kQuakeTime,kQuakeFactor,0,0.1,5);\n\
		end\n\
		\n\
       \n\
		local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local kTotalTime = 1.0\n\
		if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
			local kSpeed = kSkillDef:GetAbil(AT_MOVESPEED)\n\
			if kSpeed <= 0 then\n\
				kSpeed = 190\n\
			end\n\
			local kRange = kSkillDef:GetAbil(AT_ATTACK_RANGE)\n\
			if kRange <= 0 then\n\
				kRange = 300\n\
			end\n\
\n\
			kTotalTime = kRange/kSpeed\n\
		end\n\
		local kTimeInter = kTotalTime*0.2\n\
	    action:StartTimer(kTotalTime,kTimeInter,0)\n\
--	    action:StartTimer(1.0,0.1,0)\n\
	    \n\
	end\n\
	\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_EnergyExplosion_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_EnergyExplosion_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
\n\
		local FireEffect = actor:GetAnimationInfoFromAniName(\"FIRE_EFFECT\",action:GetSlotAnimName(2))\n\
		if nil==FireEffect or FireEffect:IsNil() then\n\
			FireEffect = \"ef_deathmaster_skill_02_01_p_ef_head\"\n\
		else\n\
			FireEffect = FireEffect:GetStr()\n\
		end\n\
\n\
		if \"NONE\"~=FireEffect then\n\
			actor:AttachParticle(1204,\"p_ef_head\",FireEffect);\n\
		end\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_EnergyExplosion_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
	\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_EnergyExplosion_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_EnergyExplosion_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	--	attack target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Act_Mon_EnergyExplosion_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
			ptTargetPos = actor:GetPos()\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat());\n\
		end\n\
	end	\n\
	\n\
	local	fSkillRange = action:GetSkillRange(0,actor)\n\
	if fSkillRange == 0 then\n\
		fSkillRange = 100\n\
	end\n\
\n\
	local effect = actor:GetAnimationInfoFromAniName(\"RANGE_EFFECT\",action:GetCurrentSlotAnimName())	\n\
	if nil~=effect then\n\
		effect = effect:GetStr()\n\
		if \"\"==effect then\n\
			effect = \"ef_deathmaster_skill_02_05_char_root\"\n\
		end\n\
		if \"NONE\"~=effect then\n\
			actor:AttachParticleToPointS(81190,ptTargetPos, effect, fSkillRange*0.0043);\n\
		end\n\
	end\n\
	\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_EnergyExplosion_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_EnergyExplosion_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_EnergyExplosion_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_EnergyExplosion_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_Mon_EnergyExplosion_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_EnergyExplosion_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_EnergyExplosion_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_EnergyExplosion_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Mon_EnergyExplosion_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Mon_EnergyExplosion_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_EnergyExplosion_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end	\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
\n\
			if iState == 2 then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) ~= 0 then\n\
					Act_Mon_EnergyExplosion_SetState(actor,action,\"RETURN\")\n\
					return true\n\
				end\n\
			end\n\
\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_EnergyExplosion_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > 2.0 then -- action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_EnergyExplosion_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_EnergyExplosion_OnCleanUp(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	actor:DetachFrom(81190);\n\
end\n\
\n\
function Act_Mon_EnergyExplosion_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_EnergyExplosion_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_EnergyExplosion_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local   action = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
		\n\
    ODS(\"Act_Mon_EnergyExplosion_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
       \n\
    if	textKey == \"attk_ground\" then\n\
		\n\
		local Effect = actor:GetAnimationInfo(\"GROUND_EFFECT\")\n\
		if nil==Effect or \"\"==Effect then\n\
			Effect = \"ef_deathmaster_skill_02_03_char_root\"\n\
		end\n\
		\n\
		local	kActorPos = actor:GetPos()\n\
		local	fSkillRange = action:GetSkillRange(0,actor)\n\
		if fSkillRange == 0 then\n\
			fSkillRange = 100\n\
		end\n\
\n\
		local	kLookDir = actor:GetLookingDir()\n\
		kLookDir:Multiply(fSkillRange);\n\
		\n\
		local	kTargetPos = action:GetParamAsPoint(0);\n\
		if \"NONE\"~=Effect then\n\
			actor:AttachParticleToPointS(4381,kTargetPos,Effect, fSkillRange*0.0043);\n\
		end\n\
    \n\
	    Act_Mon_Melee_DoDamage(actor,action);    \n\
		action:SetParam(2,\"HIT\")\n\
		\n\
	elseif	textKey == \"hit\" then\n\
	\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
		action:SetParam(2,\"HIT\")\n\
\n\
    elseif  textKey == \"fire\" then\n\
    \n\
		local FireEffect = actor:GetAnimationInfoFromAniName(\"FIRE_EFFECT\",action:GetSlotAnimName(2))\n\
		if nil==FireEffect or FireEffect:IsNil() then\n\
			FireEffect = \"ef_deathmaster_skill_02_02_p_ef_head\"\n\
		else\n\
			FireEffect = FireEffect:GetStr()\n\
		end\n\
\n\
		if \"NONE\"~=FireEffect then\n\
			actor:AttachParticle(1204,\"p_ef_head\",FireEffect);\n\
		end\n\
\n\
	    \n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_EnergyExplosion_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	if bIsBefore == false then\n\
		if action:GetParam(2) == \"HIT\" then\n\
        \n\
           --  hit  \n\
           --    .\n\
			Act_Mon_Melee_DoDamage(actor,action);    \n\
\n\
		end    \n\
	end        \n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Rush_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Rush_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	ODS(\"kState : \"..kState..\"\\n\", false, 1509)\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
		\n\
		local	effect = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT\", action, 1000205)\n\
		if nil ~= effect then\n\
			local	node = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT_NODE\", action, 1000205)\n\
			if nil == node then\n\
				node = \"char_root\"\n\
			end\n\
		    actor:AttachParticle(129,node,effect)\n\
		end\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_Rush_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
		if actor:IsEqualObjectName(\"m_Parel\") then\n\
		    actor:AttachParticle(129,\"char_root\",\"ef_parel_skill_05_01\");\n\
		else\n\
			local	effect = actor:GetAnimationInfoFromAniName(\"FIRE_EFFECT\", \"dashattk_btlidle_01\")\n\
			if \"NONE\"==effect:GetStr() then\n\
\n\
			else\n\
				if nil==effect then\n\
					effect = \"ef_Mahalka_skill_03_01_char_root\"\n\
				end\n\
			    actor:AttachParticle(129,\"char_root\",effect);\n\
			end\n\
		end\n\
		\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(4)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	\n\
			action:SetSlot(3);	--	Finish     Idle  .\n\
		end\n\
\n\
		iNewState = 3;\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_Rush_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Rush_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
\n\
	actor:SetNoWalkingTarget(false)\n\
	actor:FreeMove(true)\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	--	rush target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Act_Mon_Rush_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\")\n\
			return	false;\n\
		else\n\
			ptTargetPos = Point3(0,0,0);\n\
			ptTargetPos:SetX(kPacket:PopFloat());\n\
			ptTargetPos:SetY(kPacket:PopFloat());\n\
			ptTargetPos:SetZ(kPacket:PopFloat());\n\
		end\n\
		\n\
	end\n\
	\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
		\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Rush_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_Rush_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Rush_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
\n\
		actor:LookAt(ptTargetPos,true,false,true);\n\
		actor:SetMovingDir(actor:GetLookingDir());\n\
\n\
	end\n\
	\n\
	action:SetParamInt(10,0)\n\
\n\
			local pilot = actor:GetPilot()\n\
			if false == pilot:IsNil() then\n\
				pilot:SetGoalPos(Point3(0,0,0))\n\
			end\n\
	return true\n\
end\n\
function Act_Mon_Rush_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Rush_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Rush_Fire(actor,action);	\n\
end\n\
\n\
function Act_Mon_Rush_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	  \n\
	local	ptTargetPos = action:GetParamAsPoint(0)\n\
	actor:LookAt(ptTargetPos,true,false,true);\n\
\n\
	--	  \n\
	local	kCurrentPos = actor:GetPos()\n\
	local	kDirVector = ptTargetPos:_Subtract(kCurrentPos)\n\
	kDirVector:Unitize()\n\
	\n\
	action:SetParamAsPoint(1,kDirVector)\n\
	\n\
	if actor:IsEqualObjectName(\"m_Parel\") then\n\
		actor:AttachParticle(129,\"char_root\",\"ef_parel_skill_05_02\");\n\
	else\n\
		local	effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		if nil ~= effect then\n\
			local	node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
			if nil == node then\n\
				node = \"char_root\"\n\
			end\n\
			if \"NONE\"~=effect then\n\
			    actor:AttachParticle(129,node,effect)\n\
			end\n\
		else\n\
		    actor:AttachParticle(129,\"char_root\",\"ef_Mahalka_skill_03_02_char_root\");\n\
		end\n\
	end\n\
\n\
	local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID)\n\
	end\n\
end\n\
\n\
function Act_Mon_Rush_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
			local pilot = actor:GetPilot()\n\
			if false == pilot:IsNil() then\n\
				pilot:SetGoalPos(Point3(0,0,0))\n\
			end\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		local	kMovingDir = action:GetParamAsPoint(1)\n\
		local	kMovingTarget = action:GetParamAsPoint(0)\n\
		local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/10000.0);\n\
			\n\
		local	ptTargetPos = action:GetParamAsPoint(0)\n\
		local	kCurrentPos = actor:GetPos()\n\
\n\
		local	kCurrentDir = ptTargetPos:_Subtract(kCurrentPos)\n\
		ODS(\" : \" .. kCurrentDir:Length() .. \"\\n\")\n\
		kCurrentDir:Unitize()\n\
		\n\
		local	fDot = kCurrentDir:Dot(kMovingDir)\n\
		if fDot<0 then\n\
--			return	false\n\
--		elseif fDot<0.01 then\n\
			actor:DetachFrom(129)\n\
			if 0 == action:GetParamInt(10) then\n\
				if 0 < actor:GetAnimationLength(action:GetSlotAnimName(4)) then	-- \n\
					Act_Mon_Rush_SetState(actor,action,\"RETURN\")\n\
					action:SetParamInt(10,1)\n\
				else\n\
					return false	--   \n\
				end\n\
			else	-- \n\
				if actor:IsAnimationDone() then\n\
					return false\n\
				end\n\
			end\n\
		else\n\
			kMovingDir:Multiply(fMoveSpeed)\n\
		\n\
			actor:SetMovingDelta(kMovingDir);\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
 \n\
		local fAddZ = actor:GetAnimationInfo(\"ADD_Z\")\n\
		\n\
		if nil ~= fAddZ then\n\
\n\
			local pos = actor:GetPos()\n\
			fAddZ = tonumber(fAddZ)\n\
			pos:SetZ(pos:GetZ() + fAddZ*frameTime)\n\
			actor:SetTranslate(pos)\n\
		end\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Rush_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Rush_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_Rush_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	actor:DetachFrom(129)\n\
	actor:FreeMove(false)\n\
end\n\
\n\
function Act_Mon_Rush_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_Rush_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Act_Mon_Rush_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
			\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local pilot = actor:GetPilot()\n\
	if false == pilot:IsNil() then\n\
		pilot:SetGoalPos(Point3(0,0,0))\n\
	end\n\
	\n\
--	if bIsBefore == false then\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
        action:GetTargetList():ApplyActionEffects();    \n\
--	end\n\
\n\
end\n\
\n\
function Act_Mon_Rush_OnEvent(actor,textKey)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_RushPiercing_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_RushPiercing_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if bIsBefore == false then\n\
		ODS(\"Act_Mon_RushPiercing_OnTargetListModified\\n\");\n\
		Act_Mon_Melee_DoDamage(actor,actor:GetAction());\n\
	end\n\
\n\
end\n\
\n\
function Act_Mon_RushPiercing_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_RushPiercing_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"WAIT\" then\n\
		action:SetSlot(4)\n\
		local fAniTime = actor:GetAnimationLength(action:GetSlotAnimName(4))\n\
		if fAniTime == 0 then\n\
		\n\
			ODS(\"Act_Mon_RushPiercing_SetState SlotName[\"..action:GetSlotAnimName(4)..\"] Not Exist -> SetSlot To Next\\n\")\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
			fAniTime = 1.0;\n\
		end\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(3,g_world:GetAccumTime());\n\
		action:SetParamFloat(30,fAniTime);\n\
		iNewState = 3\n\
		actor:DetachFrom(129)\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
\n\
end\n\
\n\
function Act_Mon_RushPiercing_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_RushPiercing_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	--	rush target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Act_Mon_RushPiercing_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
			return	false;\n\
			\n\
		else\n\
			ptTargetPos = Point3(0,0,0);\n\
			ptTargetPos:SetX(kPacket:PopFloat());\n\
			ptTargetPos:SetY(kPacket:PopFloat());\n\
			ptTargetPos:SetZ(kPacket:PopFloat());\n\
		end\n\
		\n\
	end\n\
	\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
		\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_RushPiercing_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_RushPiercing_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_RushPiercing_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_RushPiercing_OnEnter Start Casting CurPos :\"..actor:GetPos():GetX()..\n\
	    \",\"..actor:GetPos():GetY()..\n\
	    \",\"..actor:GetPos():GetZ()..\n\
	    \" TargetPos: \"..ptTargetPos:GetX()..\",\"..ptTargetPos:GetY()..\",\"..ptTargetPos:GetZ()..\"\\n\");\n\
\n\
		--SetBreak();\n\
		actor:LookAt(ptTargetPos,true,false,true);\n\
		actor:SetMovingDir(actor:GetLookingDir());\n\
		\n\
		local	kLookDir = actor:GetLookingDir();\n\
	    ODS(\"Act_Mon_RushPiercing_OnEnter Looking Dir:\"..kLookDir:GetX()..\",\"..kLookDir:GetY()..\",\"..kLookDir:GetZ()..\"\\n\");\n\
		\n\
\n\
	end\n\
	\n\
	action:SetParamInt(10,0)	-- \n\
	\n\
	return true\n\
end\n\
function Act_Mon_RushPiercing_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_RushPiercing_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_RushPiercing_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_RushPiercing_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_RushPiercing_Fire\\n\");\n\
	\n\
	--	  \n\
	local	ptTargetPos = action:GetParamAsPoint(0)\n\
	--actor:LookAt(ptTargetPos,true,false,true);\n\
\n\
	--	  \n\
	local	kCurrentPos = actor:GetPos()\n\
	local	kDirVector = ptTargetPos:_Subtract(kCurrentPos)\n\
	kDirVector:Unitize()\n\
	\n\
	action:SetParamAsPoint(1,kDirVector)\n\
\n\
	local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	if nil==Effect or \"\"==Effect then\n\
		Effect = \"ef_Vagavond_skill_03_02_char_root\"\n\
	end\n\
\n\
	local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
	if nil==EffectNode or \"\"==EffectNode then\n\
		EffectNode = \"char_root\"\n\
	end\n\
\n\
	local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
	if nil==EffectScale or \"\"==EffectScale then\n\
		EffectScale = 1.0\n\
	else\n\
		EffectScale = tonumber(EffectScale)\n\
	end\n\
\n\
	if \"NONE\"~=Effect then\n\
		actor:AttachParticleS(129, EffectNode, Effect, EffectScale)\n\
	end\n\
\n\
	local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
\n\
	Act_Mon_Melee_DoDamage(actor,actor:GetAction())\n\
end\n\
\n\
function Act_Mon_RushPiercing_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end	\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	local	kLookDir = actor:GetLookingDir();\n\
    ODS(\"Act_Mon_RushPiercing_OnUpdate Looking Dir:\"..kLookDir:GetX()..\",\"..kLookDir:GetY()..\",\"..kLookDir:GetZ()..\"\\n\");\n\
\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if iState == 3 then\n\
		\n\
			local	fTotalTime = action:GetParamFloat(30)\n\
			local	fElapsedTime = accumTime - action:GetParamFloat(3)\n\
			if fElapsedTime>fTotalTime then\n\
				return	false\n\
			end\n\
		\n\
		else\n\
		\n\
			local	kMovingDir = action:GetParamAsPoint(1)\n\
--			local	kMovingTarget = action:GetParamAsPoint(0)\n\
			local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/10000.0);\n\
				\n\
			local	ptTargetPos = action:GetParamAsPoint(0)\n\
			local	kCurrentPos = actor:GetPos()\n\
\n\
			local	kCurrentDir = ptTargetPos:_Subtract(kCurrentPos)\n\
			kCurrentDir:Unitize()\n\
			\n\
			local	fDot = kCurrentDir:Dot(kMovingDir)\n\
			if fDot<0 then\n\
				Act_Mon_RushPiercing_SetState(actor,action,\"WAIT\");\n\
				return	true;\n\
			end\n\
			\n\
			kMovingDir:Multiply(fMoveSpeed)\n\
			\n\
			actor:SetMovingDelta(kMovingDir);\n\
			\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_RushPiercing_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		elseif iState == 1 then\n\
			if action:GetParamInt(10) == 0 then\n\
				local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
				local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil~=EffectNode and nil~=Effect and \"NONE\"~=Effect then\n\
					local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
					if nil==EffectScale or \"\"==EffectScale then\n\
						EffectScale = 1\n\
					else\n\
						EffectScale = tonumber(EffectScale)\n\
					end\n\
					actor:AttachParticleS(129, EffectNode, Effect, EffectScale)\n\
				end\n\
				action:SetParamInt(10,1) \n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_RushPiercing_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_RushPiercing_OnCleanUp(actor, action)\n\
	actor:DetachFrom(129)\n\
end\n\
\n\
function Act_Mon_RushPiercing_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_RushPiercing_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_RushPiercing_OnEvent(actor,textKey)\n\
\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Skill_Mon_Blocking_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Skill_Mon_Blocking_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Skill_Mon_Blocking_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
	\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Skill_Mon_Blocking_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Mon_Blocking_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Skill_Mon_Blocking_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Skill_Mon_Blocking_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Skill_Mon_Blocking_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Skill_Mon_Blocking_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Skill_Mon_Blocking_OnCastingCompleted(actor,action)	\n\
\n\
	Skill_Mon_Blocking_SetState(actor,action,\"FIRE\")\n\
	\n\
	Skill_Mon_Blocking_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Skill_Mon_Blocking_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Skill_Mon_Blocking_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
	if fireStartNode == nil then\n\
		fireStartNode = \"char_root\"\n\
	end\n\
\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	if fireEffect == nil or fireEffect==\"\" then\n\
		fireEffect = \"ef_deathmaster_skill_03_02_char_root\"\n\
		local lwFireEffect = actor:GetAnimationInfoFromAniName(\"FIRE_EFFECT\", \"blocking_01\"):GetStr()\n\
		if \"NONE\"==lwFireEffect then\n\
			fireEffect = \"NONE\"\n\
		end\n\
	end\n\
\n\
	if fireEffect ~= \"NONE\" then\n\
		actor:AttachParticle(89110,fireStartNode,fireEffect);\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Skill_Mon_Blocking_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Skill_Mon_Blocking_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
		\n\
	if action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Skill_Mon_Blocking_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Skill_Mon_Blocking_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	elseif iState == 2 then\n\
	\n\
		if actor:IsAnimationDone() then\n\
			actor:PlayNext();\n\
			action:SetParamInt(0,3);\n\
		end	\n\
	\n\
	end\n\
	return true\n\
end\n\
function Skill_Mon_Blocking_OnCleanUp(actor, action)\n\
	actor:DetachFrom(89110)end\n\
\n\
function Skill_Mon_Blocking_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Skill_Mon_Blocking_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Skill_Mon_Blocking_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	if actor:GetAction():GetActionParam() == AP_FIRE then\n\
		if textKey == \"end\" then\n\
			local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
			if nil==fireEffect or \"NONE\"~=fireEffect then\n\
				actor:AttachParticle(89110,\"char_root\",\"ef_deathmaster_skill_03_01_char_root\");	\n\
			end\n\
			\n\
		end\n\
	end\n\
\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_MassiveProjectile_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_MassiveProjectile_OnCastingCompleted(actor, action)\n\
\n\
	--ODS(\"Act_Mon_MassiveProjectile_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_MassiveProjectile_Fire(actor,action);\n\
	\n\
\n\
end\n\
\n\
function	Act_Mon_MassiveProjectile_LoadToWeapon(actor,action,kStartPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	kAttachID=\"\";\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjectileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"));\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	if false == kNewArrow:IsNil() then\n\
		if nil~=fProjectileScale and \"\"~=fProjectileScale then\n\
			local scale = tonumber(actor:GetAnimationInfo(\"RANDOM_SCALE\"))\n\
			if nil == scale then\n\
				scale = fProjectileScale\n\
			else\n\
	\n\
				if 0==scale then \n\
					scale = fProjectileScale \n\
				else\n\
					scale = fProjectileScale + (Random()%(scale*2) - scale) -- scale  \n\
					local min_scale = actor:GetAnimationInfo(\"RANDOM_MIN_SCALE\")\n\
					if nil~=min_scale then\n\
						min_scale = tonumber(min_scale)\n\
					else\n\
						min_scale = 0\n\
					end\n\
					if scale < min_scale then\n\
						scale = min_scale\n\
					end\n\
				end\n\
			end\n\
	\n\
			kNewArrow:SetScale(scale)\n\
		end\n\
		local rotate = actor:GetAnimationInfo(\"RANDOM_ROTATE\")\n\
		if nil ~= rotate then\n\
			local w = (Random()%(math.pi*0.5))\n\
			local x = (Random()%20-10)*0.1\n\
			local y = (Random()%20-10)*0.1\n\
			local z = (Random()%20-10)*0.1\n\
			local point = Point3(x,y,z)\n\
			point:Unitize()\n\
			kNewArrow:SetRotate(Quaternion(w,point))\n\
		end\n\
	end\n\
\n\
	local	fProjectileSpeed = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SPEED\"));\n\
	if fProjectileSpeed ~= nil then\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
\n\
	local	kSound = actor:GetAnimationInfo(\"ARRIVED_SOUND\")\n\
	if nil~=kSound and \"\"~=kSound then\n\
		kNewArrow:SetParamValue(\"ARRIVED_SOUND\", kSound)\n\
	end\n\
\n\
	local	kEffect = actor:GetAnimationInfo(\"ARRIVED_EFFECT\")\n\
	if nil~=kEffect and \"\"~=kEffect then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT\", kEffect)\n\
	end\n\
\n\
	local	kScale = actor:GetAnimationInfo(\"ARRIVED_EFFECT_SCALE\")\n\
	if nil~=kScale and \"\"~=kScale then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT_SCALE\", kScale)\n\
	end\n\
\n\
	local	kFactor = actor:GetAnimationInfo(\"PROJECTILE_QUAKE_FACTOR\")\n\
	if nil~=kFactor and \"\"~=kFactor then\n\
		kNewArrow:SetParamValue(\"QUAKE_FACTOR\", kFactor)\n\
	end\n\
	\n\
	kNewArrow:LoadToPosition(kStartPos);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_TopPosZ(kPos, actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAddZ = 300\n\
	if actor:IsEqualObjectName(\"m_cleef_VanHelsing\") == true then\n\
		kAddZ = 400\n\
	elseif actor:IsEqualObjectName(\"m_elga03\") == true then\n\
		kAddZ = 500\n\
	else\n\
		local action = actor:GetAction()\n\
		if false==action:IsNil() then\n\
			local Height = actor:GetAnimationInfoFromAniName(\"TOP_RANGE_EFFECT_HEIGHT\",actor:GetAction():GetSlotAnimName(1))\n\
			if nil~=Height and false==Height:IsNil() then\n\
				kAddZ = tonumber(Height:GetStr())\n\
			end\n\
		end\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kTopDir = Point3(0,0,1)\n\
	--ODS(\"ptTargetPos] X: \"..kPos:GetX()..\", Y: \"..kPos:GetY()..\", Z: \"..kPos:GetZ()..\"\\n\",false,6482)\n\
	local kFireTargetPos = g_world:ThrowRay(kPos,kTopDir,kAddZ)\n\
	if kFireTargetPos:GetZ() ~= -1 then\n\
		kAddZ = kFireTargetPos:GetZ()-kPos:GetZ()-1\n\
	end\n\
	if kAddZ < 0 then\n\
		kAddZ = 0\n\
	end\n\
	return kAddZ\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_OnEnter(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	ODS(\"Act_Mon_MassiveProjectile_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
\n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
	local	fSkillRange = 100\n\
	local	fSkillTime = 5.0\n\
	if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
		fSkillRange = kSkillDef:GetAbil(AT_1ST_AREA_PARAM2)\n\
		if 0==fSkillRange then\n\
			fSkillRange = 100\n\
		end\n\
		\n\
		local fSkillTime = kSkillDef:GetAbil(AT_MAINTENANCE_TIME) / 1000.0\n\
		--ODS(\"Act_Mon_MassiveProjectile_OnEnter fSkillTime: \"..fSkillTime..\"\\n\",false,6482)\n\
		if 0==fSkillTime then\n\
			fSkillTime = 5.0\n\
		end\n\
	end\n\
		\n\
	action:SetParamInt(4,fSkillRange)\n\
	action:SetParamFloat(10,fSkillTime)\n\
	action:SetParamInt(5,0) -- \n\
	action:SetParamInt(6,0) -- \n\
	action:SetParamInt(7,0) --   (0: , 1: )\n\
	for i=0, action:GetSlotCount() do\n\
		local Effect = actor:GetAnimationInfoFromAniName(\"RANGE_EFFECT\", action:GetSlotAnimName(i))\n\
		if false==Effect:IsNil() then\n\
			action:SetParamInt(7,1)\n\
			break\n\
		end\n\
	end\n\
\n\
	local RangeEffectDelay = actor:GetAnimationInfoFromAniName(\"RANGE_EFFECT_DELAY\", action:GetCurrentSlotAnimName())\n\
	if nil~=RangeEffectDelay and false==RangeEffectDelay:IsNil() then\n\
		RangeEffectDelay = tonumber(RangeEffectDelay:GetStr()) / 1000.0\n\
	else\n\
		RangeEffectDelay = 0\n\
	end\n\
	action:SetParamFloat(777,RangeEffectDelay+g_world:GetAccumTime())\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_MassiveProjectile_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_MassiveProjectile_OnEnter Start Casting\\n\");\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		local	ptTargetPos = 0;\n\
		\n\
		if IsSingleMode() then\n\
			ptTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local 	IsTargetPosBySelf = actor:GetAnimationInfoFromAniName(\"IS_TARGET_POS_BY_SELF\", action:GetCurrentSlotAnimName()):GetStr()\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() or (nil~=IsTargetPosBySelf and \"TRUE\"==IsTargetPosBySelf) then\n\
				ptTargetPos = actor:GetPos()\n\
			else\n\
				ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat());\n\
			end\n\
		end\n\
\n\
		-- Look at targetpos\n\
		actor:LookAt(ptTargetPos,true,false);\n\
		\n\
		-- Save the targetpos\n\
		action:SetParamAsPoint(0,ptTargetPos)\n\
\n\
		-- Save the    \n\
		action:SetParamInt(10,Act_Mon_MassiveProjectile_TopPosZ(ptTargetPos,actor))\n\
\n\
		local	fRange =action:GetParamInt(4);\n\
		local	iTotalProjectile = 20;\n\
		local count = actor:GetAnimationInfoFromAniName(\"PROJECTILE_COUNT\",action:GetSlotAnimName(2))\n\
		if nil~=count and false==count:IsNil() then\n\
			iTotalProjectile = tonumber(count:GetStr())\n\
		end\n\
		action:SetParamInt(81190, iTotalProjectile)\n\
\n\
		for i=1, iTotalProjectile do\n\
			local	kStartPos = Point3(ptTargetPos:GetX()+math.random(-fRange/2,fRange/2),\n\
									ptTargetPos:GetY()+math.random(-fRange/2,fRange/2),\n\
									ptTargetPos:GetZ()+10);\n\
\n\
			-- local	kFireDir = Point3(0,0,-1)\n\
			-- local	kFireTargetPos = g_world:ThrowRay(kStartPos,kFireDir,1000)\n\
			-- if kFireTargetPos:GetX() ~= -1 then\n\
				-- kStartPos:SetZ(kFireTargetPos:GetZ()+1)\n\
			-- end\n\
			action:SetParamAsPoint(81190+i,kStartPos)\n\
			--ODS(i..\"] OnEnter \"..kStartPos:GetX()..\", \"..kStartPos:GetY()..\", \"..kStartPos:GetZ()..\"\\n\",false,6482)\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
\n\
	local isRange = action:GetParamInt(6)\n\
	if 0==isRange then	--    \n\
		if g_world:GetAccumTime() >= action:GetParamFloat(777) then\n\
			local RangeEffect = actor:GetAnimationInfo(\"RANGE_EFFECT\")\n\
			if 0==action:GetParamInt(7) and nil==RangeEffect or \"\"==RangeEffect then\n\
				RangeEffect = \"ef_Shark_king_abdula_skill_03_03_char_root\"\n\
			end\n\
			\n\
			if nil==RangeEffect or \"\"==RangeEffect then\n\
				RangeEffect = \"NONE\"\n\
			end\n\
\n\
			local RangeEffectEach = actor:GetAnimationInfo(\"IS_RANGE_EFFECT_EACH\")\n\
			if nil==RangeEffectEach or \"TRUE\"~=RangeEffectEach then\n\
				if actor:IsEqualObjectName(\"m_cleef_VanHelsing\") == false and \"NONE\"~=RangeEffect then\n\
					action:SetParamInt(6,1)\n\
					local fSkillRange = action:GetParamInt(4)\n\
					local fEffectScale = fSkillRange*0.009\n\
					actor:AttachParticleToPointS(81190,action:GetParamAsPoint(0),RangeEffect, fEffectScale)\n\
				end\n\
			else\n\
				if \"NONE\"~=RangeEffect then\n\
					action:SetParamInt(6,1)\n\
					local iTotalCount = action:GetParamInt(81190)\n\
					for i=1, iTotalCount do\n\
						local kStartPos = action:GetParamAsPoint(81190+i)					\n\
						actor:AttachParticleToPointS(81190+i, kStartPos, RangeEffect, 1)\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	local isRange = action:GetParamInt(5)\n\
	if 0==isRange then	--   \n\
		action:SetParamInt(5,1)\n\
				\n\
		local fSkillRange = action:GetParamInt(4)\n\
		local fEffectScale = fSkillRange*0.009\n\
\n\
		--ODS(\"Actor:ID: \" ..action:GetActionName()..\"\\n\",false,6482) --massive_projectile_btlidle\n\
		local TopRangeEffect = actor:GetAnimationInfo(\"TOP_RANGE_EFFECT\")\n\
		if nil~=TopRangeEffect and \"\"~=TopRangeEffect then\n\
			local TopRangeEffectScale = actor:GetAnimationInfo(\"TOP_RANGE_EFFECT_SCALE\")\n\
			if  nil==TopRangeEffectScale or \"\"==TopRangeEffectScale then\n\
				TopRangeEffectScale = 1.0\n\
			else\n\
				TopRangeEffectScale = tonumber(TopRangeEffectScale)\n\
			end\n\
			local TopPos = action:GetParamAsPoint(0)\n\
			TopPos:SetZ(TopPos:GetZ()+action:GetParamInt(10))\n\
\n\
			local fSkillTime = 0\n\
			local TopEffectTime = actor:GetAnimationInfo(\"TOP_RANGE_EFFECT_TIME\")\n\
			if nil~=TopEffectTime and TopEffectTime~=\"\" then\n\
				fSkillTime = tonumber(TopEffectTime)\n\
			end\n\
\n\
			if 0==fSkillTime then\n\
				fSkillTime = action:GetParamFloat(10)\n\
			end\n\
			--ODS(\"AttachParticleSWithRotate: \"..TopRangeEffect..\", X:\"..TopPos:GetX()..\", Y:\"..TopPos:GetY()..\", Z:\"..TopPos:GetZ()..\"\\n\",false,6482)\n\
			g_world:AttachParticleSWithRotate(TopRangeEffect,TopPos,fEffectScale*TopRangeEffectScale,Point3(0,0,0),fSkillTime)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if true == animDone then\n\
			if 2==iState then	--Fire  Return\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then -- \n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				else --\n\
					Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
				end\n\
			elseif 3==iState then	-- \n\
				action:SetParam(1, \"end\")	-- \n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if true == animDone then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_MassiveProjectile_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_OnCleanUp(actor)\n\
	actor:DetachFrom(81190)\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_OnLeave(actor, action)\n\
	--ODS(\"Act_Mon_MassiveProjectile_OnLeave\\n\");\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_FireArrow(actor,action,fFireDelay, iCount)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local	fRange =action:GetParamInt(4);\n\
	local	kTargetCenterPos = action:GetParamAsPoint(0);	\n\
	local	kStartPos = action:GetParamAsPoint(81190+iCount)\n\
\n\
	-- local	kStartPos = Point3(kTargetCenterPos:GetX()+math.random(-fRange/2,fRange/2),\n\
								-- kTargetCenterPos:GetY()+math.random(-fRange/2,fRange/2),\n\
								-- kTargetCenterPos:GetZ()+10);\n\
	\n\
	local	kFireDir = Point3(0,0,-1)\n\
	local	kFireTargetPos = g_world:ThrowRay(kStartPos,kFireDir,1000)\n\
	if kFireTargetPos:GetX() == -1 then\n\
		return false\n\
	end\n\
	kFireTargetPos:SetX(kStartPos:GetX())\n\
	kFireTargetPos:SetY(kStartPos:GetY())\n\
\n\
	local	iSkillRange = action:GetSkillRange(0,actor)\n\
	local	kAddZ = Act_Mon_MassiveProjectile_TopPosZ(kFireTargetPos,actor)\n\
	kStartPos:SetZ(kFireTargetPos:GetZ()+kAddZ)\n\
\n\
	local	kProjectile = Act_Mon_MassiveProjectile_LoadToWeapon(actor,action,kStartPos);\n\
	\n\
	local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
	if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
		kProjectile:SetParamValue(\"IS_QUAKE_CAMERA\",\"FALSE\")\n\
	end\n\
\n\
	kProjectile:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
	kProjectile:SetTargetLoc(kFireTargetPos);\n\
	kProjectile:DelayFire(fFireDelay,true);\n\
	\n\
	local	iFireCount = action:GetParamInt(3);\n\
	action:SetParamInt(3,iFireCount+1);\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	--ODS(\"Act_Mon_MassiveProjectile_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		local	iTotalProjectile = kAction:GetParamInt(81190);\n\
\n\
		local	fFireTerm = 0.1\n\
		local term = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
		if nil ~= term then\n\
			fFireTerm = tonumber(term)\n\
		end\n\
\n\
		local	kSoundID = actor:GetAnimationInfo(\"FIRE_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:AttachSound(kSoundID, kAction:GetParamAsPoint(0))\n\
		end\n\
\n\
		local	i=1\n\
		while i<=iTotalProjectile do\n\
		\n\
			Act_Mon_MassiveProjectile_FireArrow(actor,kAction,fFireTerm*i, i);\n\
			i=i+1;\n\
		\n\
		end\n\
		\n\
		if kAction:GetTargetList():IsNil() == false then\n\
			kAction:GetTargetList():ApplyActionEffects();\n\
		end\n\
		kAction:ClearTargetList()\n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
	elseif textKey == \"cam\" then\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_MassiveProjectile2_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_MassiveProjectile2_OnCastingCompleted(actor, action)\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_MassiveProjectile2_Fire(actor,action);\n\
	\n\
end\n\
\n\
function	Act_Mon_MassiveProjectile2_LoadToWeapon(actor,action,kStartPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	kAttachID=\"\";\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjectileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"));\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	if false == kNewArrow:IsNil() then\n\
		\n\
		if nil~=fProjectileScale and \"\"~=fProjectileScale then\n\
			local scale = actor:GetAnimationInfo(\"RANDOM_SCALE\")\n\
			if nil == scale then\n\
				scale = fProjectileScale\n\
			else\n\
				scale = fProjectileScale-scale + Random()%scale*2 -- scale  \n\
			end\n\
			kNewArrow:SetScale(scale)\n\
		end\n\
\n\
		local rotate = actor:GetAnimationInfo(\"RANDOM_ROTATE\")\n\
		if nil ~= rotate then\n\
			local w = (Random()%(math.pi*0.5))\n\
			local x = (Random()%20-10)*0.1\n\
			local y = (Random()%20-10)*0.1\n\
			local z = (Random()%20-10)*0.1\n\
			local point = Point3(x,y,z)\n\
			point:Unitize()\n\
			kNewArrow:SetRotate(Quaternion(w,point))\n\
		end\n\
	end\n\
\n\
	local	fProjectileSpeed = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SPEED\"));\n\
	if fProjectileSpeed ~= nil then\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:LoadToPosition(kStartPos);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_OnEnter(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	action:SetParamInt(4,100)\n\
	action:SetParamInt(5,0)\n\
	action:SetParamInt(11,0)	--    \n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_MassiveProjectile2_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		local	ptTargetPos = actor:GetPos()\n\
		\n\
		if IsSingleMode() then\n\
			ptTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ptTargetPos = actor:GetPos()\n\
			else\n\
				local iCount = kPacket:PopInt()\n\
				action:SetParamInt(11,iCount)\n\
				for i = 1, iCount do\n\
					ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
					action:SetParamAsPoint(i,ptTargetPos)					\n\
				end\n\
				ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat());\n\
			end\n\
		end\n\
		\n\
		-- Look at targetpos\n\
		actor:LookAt(ptTargetPos,true,false);\n\
		\n\
		-- Save the targetpos\n\
		if 0==action:GetParamInt(11) then\n\
			action:SetParamAsPoint(0,ptTargetPos)\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
\n\
	local isRange = action:GetParamInt(5)\n\
	if 0==isRange then	--   \n\
		action:SetParamInt(5,1)\n\
		local RangeEffect = actor:GetAnimationInfo(\"RANGE_EFFECT\")\n\
		if nil==RangeEffect or \"\"==RangeEffect then\n\
			RangeEffect = \"ef_Shark_king_abdula_skill_03_03_char_root\"\n\
		end\n\
		local kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local	fSkillRange = 100\n\
		if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
			fSkillRange = kSkillDef:GetAbil(AT_1ST_AREA_PARAM2)\n\
			if 0==fSkillRange then\n\
				fSkillRange = 100\n\
			end\n\
		end\n\
		action:SetParamInt(4,fSkillRange)\n\
		if actor:IsEqualObjectName(\"m_cleef_VanHelsing\") == false then\n\
			local iTargetCount = action:GetParamInt(11)\n\
			if 0==iTargetCount then\n\
				actor:AttachParticleToPointS(81190,action:GetParamAsPoint(0),RangeEffect, fSkillRange*0.009)\n\
			else\n\
				for i=1, iTargetCount do\n\
					actor:AttachParticleToPointS(81190+i,action:GetParamAsPoint(i),RangeEffect, fSkillRange*0.009)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if animDone == true then\n\
			if 2==iState then	--Fire  Return\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then -- \n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				else --\n\
					Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
				end\n\
			elseif 3==iState then	-- \n\
				action:SetParam(1, \"end\")	-- \n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_MassiveProjectile2_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==actor:GetAction());\n\
	CheckNil(actor:GetAction():IsNil());\n\
	actor:DetachFrom(81190)\n\
	local iTargetCount = actor:GetAction():GetParamInt(11)\n\
	for i=1,iTargetCount do\n\
		actor:DetachFrom(81190+i)\n\
	end\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_FireArrow(actor,action,fFireDelay,iParam)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if nil==iParam then\n\
		iParam = 0\n\
	end\n\
	\n\
	local	fRange =action:GetParamInt(4);\n\
	local	kTargetCenterPos = action:GetParamAsPoint(iParam);	\n\
	\n\
	local	kStartPos = Point3(kTargetCenterPos:GetX()+math.random(-fRange/2,fRange/2),\n\
								kTargetCenterPos:GetY()+math.random(-fRange/2,fRange/2),\n\
								kTargetCenterPos:GetZ()+300);\n\
	\n\
	local	kFireDir = Point3(0,0,-1)\n\
	local	kFireTargetPos = g_world:ThrowRay(kStartPos,kFireDir,1000)\n\
	if kFireTargetPos:GetX() == -1 then\n\
		return true\n\
	end\n\
	kFireTargetPos:SetX(kStartPos:GetX())\n\
	kFireTargetPos:SetY(kStartPos:GetY())\n\
\n\
	local	iSkillRange = action:GetSkillRange(0,actor)\n\
	\n\
	kStartPos:SetZ(kFireTargetPos:GetZ()+300)\n\
	\n\
	local	kProjectile = Act_Mon_MassiveProjectile2_LoadToWeapon(actor,action,kStartPos);\n\
	\n\
	kProjectile:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
	kProjectile:SetTargetLoc(kFireTargetPos);\n\
	kProjectile:DelayFire(fFireDelay,true);\n\
	\n\
	local	iFireCount = action:GetParamInt(3);\n\
	action:SetParamInt(3,iFireCount+1);\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile2_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		local	iTotalProjectile = 20;\n\
		\n\
		local count = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil ~= count then\n\
			iTotalProjectile = tonumber(count)\n\
		end\n\
\n\
		local	fFireTerm = 0.1\n\
		local term = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
		if nil ~= term then\n\
			fFireTerm = tonumber(term)\n\
		end\n\
\n\
		local iTargetCount = kAction:GetParamInt(11)\n\
		for ii = 1,iTargetCount do\n\
			local	i=0\n\
			while i<iTotalProjectile do\n\
				Act_Mon_MassiveProjectile2_FireArrow(actor,kAction,fFireTerm*i,ii)\n\
				i=i+1;\n\
			end\n\
		end\n\
		\n\
		if kAction:GetTargetList():IsNil() == false then\n\
			kAction:GetTargetList():ApplyActionEffects();\n\
		end\n\
		kAction:ClearTargetList()\n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
	elseif textKey == \"cam\" then\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_MassiveProjectile_Jump_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_MassiveProjectile_Jump_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_MassiveProjectile_Jump_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_MassiveProjectile_Jump_Fire(actor,action);\n\
	\n\
\n\
end\n\
\n\
function	Act_Mon_MassiveProjectile_Jump_LoadToWeapon(actor,action,kStartPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	kAttachID=\"\";\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjectileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"));\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	if false == kNewArrow:IsNil() then\n\
		if nil~=fProjectileScale and \"\"~=fProjectileScale then\n\
			local scale = actor:GetAnimationInfo(\"RANDOM_SCALE\")\n\
			if nil == scale or \"\"==scale then\n\
				scale = fProjectileScale\n\
			else\n\
				scale = fProjectileScale - scale + Random()%scale*2 -- scale  \n\
			end\n\
			kNewArrow:SetScale(scale)\n\
		end\n\
		local rotate = actor:GetAnimationInfo(\"RANDOM_ROTATE\")\n\
		if nil ~= rotate then\n\
			local w = (Random()%(math.pi*0.5))\n\
			local x = (Random()%20-10)*0.1\n\
			local y = (Random()%20-10)*0.1\n\
			local z = (Random()%20-10)*0.1\n\
			local point = Point3(x,y,z)\n\
			point:Unitize()\n\
			kNewArrow:SetRotate(Quaternion(w,point))\n\
		end\n\
	end\n\
\n\
	local	fProjectileSpeed = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SPEED\"));\n\
	if fProjectileSpeed ~= nil then\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	local	kEffect = actor:GetAnimationInfo(\"ARRIVED_EFFECT\")\n\
	if nil~=kEffect and \"\"~=kEffect then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT\", kEffect)\n\
	end\n\
\n\
	local	kScale = actor:GetAnimationInfo(\"ARRIVED_EFFECT_SCALE\")\n\
	if nil~=kScale and \"\"~=kScale then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT_SCALE\", kScale)\n\
	end\n\
\n\
	if actor:IsEqualObjectName(\"m_MetalKamparling\") == true then\n\
		kNewArrow:SetParamValue(\"ARRIVED_EFFECT_Z\", 0)\n\
	end\n\
\n\
	kNewArrow:LoadToPosition(kStartPos);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_OnEnter(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	ODS(\"Act_Mon_MassiveProjectile_Jump_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	action:SetParamInt(4,100)\n\
	action:SetParamInt(5,0)\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_MassiveProjectile_Jump_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_MassiveProjectile_Jump_OnEnter Start Casting\\n\");\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		local	ptTargetPos = 0;\n\
		\n\
		if IsSingleMode() then\n\
			ptTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ptTargetPos = actor:GetPos()\n\
			else\n\
				ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat());\n\
			end\n\
		end\n\
		ODS(\"X:\"..ptTargetPos:GetX()..\" Y:\"..ptTargetPos:GetY()..\" Z:\"..ptTargetPos:GetZ()..\"\\n\")\n\
		\n\
		-- Look at targetpos\n\
		actor:LookAt(ptTargetPos,true,false);\n\
		\n\
		-- Save the targetpos\n\
		local kPos = ptTargetPos\n\
		kPos:SetZ(kPos:GetZ() + 10)\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1), 300);\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			ptcl = ptTargetPos\n\
		else\n\
			ptTargetPos:SetZ(ptcl:GetZ()+25)\n\
		end\n\
		\n\
		action:SetParamAsPoint(0,ptTargetPos)\n\
		action:SetParamAsPoint(1,actor:GetPos())\n\
		action:SetParamFloat(1,g_world:GetAccumTime());	--	Start Time\n\
		action:SetParamInt(8,0)\n\
		action:SetParamInt(9,0)\n\
		\n\
		actor:FreeMove(true);	\n\
		actor:StopJump();\n\
		actor:SetNoWalkingTarget(false)\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	local kCurAction = actor:GetAction()\n\
	local iCurrnetSlot = kCurAction:GetCurrentSlot()\n\
	if iCurrnetSlot == 0 or iCurrnetSlot == 1 then\n\
		local	fFlyHeight = 300\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
		--ODS(\"Time:\"..fElapsedTime..\"\\n\",false,987)\n\
		local	fRate  = fElapsedTime;\n\
			\n\
		if fRate>1.0 then\n\
			fRate = 1.0\n\
			--actor:SetHide(true)\n\
		end\n\
		local	kStartPos = action:GetParamAsPoint(1)\n\
		local	kMovingVec = Point3(0,0,1)\n\
		local	fMovingDist = fRate*fFlyHeight*4;\n\
		if fMovingDist > 450 then\n\
			fMovingDist = 450\n\
		end\n\
		kMovingVec:Multiply(fMovingDist);\n\
		\n\
		local	kNewPos = kStartPos:_Add(kMovingVec);\n\
		\n\
		actor:SetTranslate(kNewPos);\n\
	end\n\
	\n\
	local kEnd = action:GetParamInt(9)\n\
	if iCurrnetSlot == 4 and kEnd == 0 then\n\
		local kInit = action:GetParamInt(8)\n\
		if kInit == 0 then\n\
			action:SetParamFloat(2,g_world:GetAccumTime())\n\
			action:SetParamInt(8,1)\n\
			--actor:SetHide(false)\n\
		end\n\
		local	fFlyHeight = 300\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(2)\n\
		local	fRate  = fElapsedTime;\n\
		\n\
		local 	kEndAniTime = 0.6		\n\
		if fRate>kEndAniTime then\n\
			fRate = kEndAniTime\n\
			actor:FreeMove(false)\n\
			action:SetParamInt(9,1)\n\
		end\n\
		\n\
		local	kStartPos = action:GetParamAsPoint(0)\n\
		local	kMovingVec = Point3(0,0,1)\n\
		local	fMovingDist = (kEndAniTime - fRate)*fFlyHeight*4;\n\
		kMovingVec:Multiply(fMovingDist);\n\
		\n\
		local	kNewPos = kStartPos:_Add(kMovingVec);\n\
		--kNewPos:SetZ(kNewPos:GetZ() + 5)\n\
		actor:SetTranslate(kNewPos);\n\
		--ODS(\"NewPos X:\"..kNewPos:GetX()..\"NewPos Y:\"..kNewPos:GetY()..\"NewPos Z:\"..kNewPos:GetZ()..\"\\n\",false,987)\n\
	end\n\
\n\
	local isRange = action:GetParamInt(5)\n\
	if 0==isRange then	--   \n\
		action:SetParamInt(5,1)\n\
		local RangeEffect = actor:GetAnimationInfo(\"RANGE_EFFECT\")\n\
		if nil==RangeEffect or \"\"==RangeEffect then\n\
			RangeEffect = \"ef_Shark_king_abdula_skill_03_03_char_root\"\n\
		end\n\
		local kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local	fSkillRange = 100\n\
		if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
			fSkillRange = kSkillDef:GetAbil(AT_1ST_AREA_PARAM2)\n\
			if 0==fSkillRange then\n\
				fSkillRange = 100\n\
			end\n\
		end\n\
\n\
		local kTargetPos = action:GetParamAsPoint(0)\n\
		kTargetPos = g_world:ThrowRay(kTargetPos, Point3(0,0,-1), 300);\n\
		if kTargetPos:GetX() == -1 and kTargetPos:GetY() == -1 and kTargetPos:GetZ() == -1 then\n\
			kTargetPos = action:GetParamAsPoint(0)\n\
		end\n\
\n\
		action:SetParamInt(4,fSkillRange)\n\
		if actor:IsEqualObjectName(\"m_cleef_VanHelsing\") == false then\n\
			actor:AttachParticleToPointS(81190, kTargetPos, RangeEffect, fSkillRange*0.009)\n\
		end\n\
	end\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if animDone == true then\n\
			if 2==iState then	--Fire  Return\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then -- \n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				else --\n\
					Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
				end\n\
			elseif 3==iState then	-- \n\
				action:SetParam(1, \"end\")	-- \n\
				ODS(\"End\\n\",false,987)\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_MassiveProjectile_Jump_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_OnCleanUp(actor, action)\n\
	actor:DetachFrom(81190)\n\
	actor:FreeMove(false);	\n\
	ODS(\"Act_Mon_MassiveProjectile_Jump_OnCleanUp\\n\",false,987)\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_EnergyExplosion_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_FireArrow(actor,action,fFireDelay)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local	fRange =action:GetParamInt(4);\n\
	local	kTargetCenterPos = action:GetParamAsPoint(0);	\n\
	\n\
	local	kStartPos = Point3(kTargetCenterPos:GetX(),\n\
								kTargetCenterPos:GetY(),\n\
								kTargetCenterPos:GetZ()+300);\n\
	\n\
	local	kFireDir = Point3(0,0,-1)\n\
	local	kFireTargetPos = g_world:ThrowRay(kStartPos,kFireDir,1000)\n\
	if kFireTargetPos:GetX() == -1 then\n\
		return true\n\
	end\n\
\n\
	local	iSkillRange = action:GetSkillRange(0,actor)\n\
	\n\
	kStartPos:SetZ(kFireTargetPos:GetZ()+300)\n\
	\n\
	local	kProjectile = Act_Mon_MassiveProjectile_Jump_LoadToWeapon(actor,action,kStartPos);\n\
	\n\
	kProjectile:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
	kProjectile:SetTargetLoc(kFireTargetPos);\n\
	kProjectile:DelayFire(fFireDelay,true);\n\
	\n\
	local	iFireCount = action:GetParamInt(3);\n\
	action:SetParamInt(3,iFireCount+1);\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Jump_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	ODS(\"Act_Mon_MassiveProjectile_Jump_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		local	iTotalProjectile = 20;\n\
		\n\
		local count = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil ~= count then\n\
			iTotalProjectile = tonumber(count)\n\
		end\n\
		\n\
		--actor:SetHide(true)\n\
\n\
		local	fFireTerm = 0.1\n\
		local term = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
		if nil ~= term then\n\
			fFireTerm = tonumber(term)\n\
		end\n\
\n\
		local	i=0\n\
		while i<iTotalProjectile do\n\
		\n\
			Act_Mon_MassiveProjectile_Jump_FireArrow(actor,kAction,fFireTerm*i);\n\
			i=i+1;\n\
		\n\
		end\n\
		\n\
		if kAction:GetTargetList():IsNil() == false then\n\
			kAction:GetTargetList():ApplyActionEffects();\n\
		end\n\
		kAction:ClearTargetList()\n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
	elseif textKey == \"cam\" then\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_MassiveProjectile_Move_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_MassiveProjectile_Move_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_MassiveProjectile_Move_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_MassiveProjectile_Move_Fire(actor,action);\n\
	\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_OnEnter(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	action:SetParamInt(4,100)\n\
	action:SetParamFloat(5,0)\n\
	action:SetParamInt(1,0)	--  ?\n\
	action:SetParamInt(2,0)	--  .\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_MassiveProjectile_Move_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_MassiveProjectile_Move_OnEnter Start Casting\\n\");\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		local	ptTargetPos = 0;\n\
		\n\
		if IsSingleMode() then\n\
			ptTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ptTargetPos = actor:GetPos()\n\
			else\n\
				ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat());\n\
				ODS(\"Act_Mon_MassiveProjectile_Move_OnEnter X : \"..ptTargetPos:GetX()..\" Y : \"..ptTargetPos:GetY()..\" Z : \"..ptTargetPos:GetZ()..\"\\n\", false, 1509)\n\
			end\n\
		end\n\
		\n\
		-- Look at targetpos\n\
		actor:LookAt(ptTargetPos)\n\
		actor:SetMovingDir(ptTargetPos)\n\
		\n\
		-- Save the targetpos\n\
		action:SetParamAsPoint(0,ptTargetPos)\n\
\n\
		ptTargetPos:Subtract(actor:GetTranslate())\n\
		local kLookDir = actor:GetLookingDir()\n\
\n\
		local angle = (1-ptTargetPos:Dot(kLookDir))*(math.pi*0.5)\n\
--		actor:IncRotate(angle)\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_OnUpdate(actor, accumTime, frameTime)\n\
\n\
--	ODS(\"Act_Mon_MassiveProjectile_Move_OnUpdate\\n\", false, 1509)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
\n\
\n\
	local iRangeType = action:GetAbil(AT_2ND_AREA_TYPE)\n\
	local iRange = action:GetAbil(AT_2ND_AREA_PARAM1)--action:GetSkillRange(action:GetActionNo(), actor)\n\
	local iRange2 = action:GetAbil(AT_2ND_AREA_PARAM2)\n\
--	ODS(\"iRange : \"..iRange..\" 2 : \"..iRange2..\"\\n\", false, 1509)\n\
	local ptActorPos = actor:GetPos()\n\
	local ptActorPos2 = actor:GetPos()\n\
--	ODS(\" ActorPos X : \"..ptActorPos:GetX()..\" Y : \"..ptActorPos:GetY()..\"\\n\", false, 1509)\n\
	\n\
	local	ptTargetMovePos = action:GetParamAsPoint(0)	--.      EffectScaleEffectScale\n\
	ptTargetMovePos:Subtract(ptActorPos)--actor:GetLookingDir()\n\
	ptTargetMovePos:SetZ(0)\n\
	ptTargetMovePos:Unitize()\n\
	local kLookDir = ptTargetMovePos\n\
\n\
	local IsParticle = action:GetParamInt(1)\n\
	if 0==IsParticle then	--   \n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		action:SetParamInt(1, 1)\n\
		if nil~=Effect then\n\
			if nil==EffectNode or \"\"==EffectNode then\n\
				EffectNode = \"char_root\"\n\
			end\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			actor:AttachParticleS(12500, EffectNode, Effect, EffectScale)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		local fLastFireTime = action:GetParamFloat(5)\n\
		local iInter = actor:GetAnimationInfo(\"PROJECTILE_INTER\")\n\
		if nil==iInter or \"\"==iInter then\n\
			iInter = 0.1\n\
		else\n\
			iInter = tonumber(iInter)\n\
		end\n\
		local iDeltaTime = accumTime - fLastFireTime\n\
		local ArriveEffect = actor:GetAnimationInfo(\"ARRIVE_EFFECT\")\n\
		if iInter < iDeltaTime then\n\
			action:SetParamFloat(5, accumTime)\n\
			local iFireCount = 1--iDeltaTime/iInter	-- \n\
			for i=0,2 do\n\
				local ptDropPos = ptActorPos\n\
				local w = 0\n\
				local h = 0\n\
				if 0==iRangeType then	--\n\
					w = Random()%iRange\n\
					h = Random()%iRange\n\
					w = w - iRange*0.5\n\
					h = h - iRange*0.5\n\
				else					--\n\
					w = Random()%(iRange*2)\n\
					h = Random()%iRange2\n\
					w=w-iRange	-- \n\
					h=h-(iRange2*0.5)\n\
					local kRight = Point3(1,0,0)\n\
					local angle = (1-kRight:Dot(kLookDir))*(math.pi*0.5)\n\
--					ODS(\"angle : \"..angle..\" Look X : \"..kLookDir:GetX()..\" Y : \"..kLookDir:GetY()..\" Z : \"..kLookDir:GetZ()..\"\\n\", false, 1509)\n\
					local TempVec = Point3(w, h, 0)\n\
					TempVec:Rotate(Point3(0,0,1), angle)\n\
					w = TempVec:GetX()\n\
					h = TempVec:GetY()\n\
				end\n\
				ptDropPos:SetX(ptActorPos2:GetX()+w)\n\
				ptDropPos:SetY(ptActorPos2:GetY()+h)\n\
				ptDropPos:SetZ(ptActorPos2:GetZ()+200)\n\
--				ptDropPos:SetZ(200)\n\
--				ODS(\"FIRE iDeltaTime : \"..iDeltaTime..\" X : \"..ptDropPos:GetX()..\" Y : \"..ptDropPos:GetY()..\" Z : \"..ptDropPos:GetZ()..\"\\n\", false, 1509)\n\
--				ODS(\"w : \"..w..\" h : \"..h..\" ActorPos X : \"..ptActorPos2:GetX()..\" Y : \"..ptActorPos2:GetY()..\"\\n\", false, 1509)				\n\
\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				local kFireTargetPos = g_world:ThrowRay(ptDropPos, Point3(0,0,-1), 500)\n\
				if nil~=kFireTargetPos and false==kFireTargetPos:IsZero() and -1~=kFireTargetPos:GetX() and -1~=kFireTargetPos:GetY() then\n\
					local kProjectile = Act_Mon_MassiveProjectile_LoadToWeapon(actor, action, ptDropPos)\n\
					if nil~=kProjectile and false==kProjectile:IsNil() then\n\
						kProjectile:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
\n\
						local iIndex = action:GetParamInt(2)\n\
						kProjectile:SetParamValue(\"index\", tostring(iIndex))\n\
						if nil~=ArriveEffect and \"\"==ArriveEffect then\n\
							kProjectile:SetParamValue(\"effect\", ArriveEffect)\n\
						end\n\
						ODS(\"kFireTargetPos X : \"..kFireTargetPos:GetX()..\" Y : \"..kFireTargetPos:GetY()..\" Z : \"..kFireTargetPos:GetZ()..\"\\n\", false, 1509)\n\
						kProjectile:SetTargetLoc(kFireTargetPos);\n\
						kProjectile:DelayFire(iInter*i,true);\n\
--						kProjectile:Fire(true)					\n\
						action:SetParamInt(2, action:GetParamInt(2)+1)\n\
					end\n\
				end\n\
			end\n\
		end\n\
				\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_MassiveProjectile_Move_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	end\n\
\n\
	local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/ABILITY_RATE_VALUE)\n\
	ptTargetMovePos:Multiply(fMoveSpeed)\n\
	\n\
	actor:SetMovingDelta(ptTargetMovePos)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_OnCleanUp(actor)\n\
	ODS(\"Act_Mon_MassiveProjectile_Move_OnCleanUp\\n\", false, 1509)\n\
	actor:DetachFrom(125)\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_MassiveProjectile_Move_OnLeave\\n\");\n\
	return true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	ODS(\"Act_Mon_MassiveProjectile_Move_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
		\n\
		if kAction:GetTargetList():IsNil() == false then\n\
			kAction:GetTargetList():ApplyActionEffects();\n\
		end\n\
		kAction:ClearTargetList()\n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
	elseif textKey == \"cam\" then\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_MassiveProjectile_Move_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- Mon_360Degree_Shot\n\
function Skill_Mon_360Degree_Shot_OnCheckCanEnter(actor, action)\n\
\n\
end\n\
\n\
function Skill_Mon_360Degree_Shot_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Skill_Mon_360Degree_Shot_OnCastingCompleted(actor,action)\n\
	else\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			action:SetSlot(1)\n\
		end\n\
		\n\
		actor:ResetAnimation()\n\
		actor:PlayCurrentSlot()\n\
	end\n\
	\n\
	--	 \n\
	if action:GetScriptParam(\"MOVE\")==\"TRUE\" then\n\
		local	kTargetPos =  nil\n\
		if IsSingleMode() then\n\
			kTargetPos = GetMyActor():GetPos()\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ODS(\"[SkillError] Skill_Mon_360Degree_Shot_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\")\n\
				return	false\n\
			else\n\
				kTargetPos = Point3(0,0,0)\n\
				kTargetPos:SetX(kPacket:PopFloat())\n\
				kTargetPos:SetY(kPacket:PopFloat())\n\
				kTargetPos:SetZ(kPacket:PopFloat())\n\
			end\n\
			\n\
		end\n\
		\n\
		action:SetParamAsPoint(0,kTargetPos);\n\
		\n\
		local	kMoveDir = kTargetPos:_Subtract(actor:GetPos())\n\
		kMoveDir:SetZ(0)\n\
		kMoveDir:Unitize()\n\
		\n\
		action:SetParamAsPoint(1,kMoveDir)\n\
	\n\
	end	\n\
\n\
	return true\n\
end\n\
function Skill_Mon_360Degree_Shot_OnCastingCompleted(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(2)\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	\n\
	Skill_Mon_360Degree_Shot_Fire(actor,action)	\n\
end\n\
function  Skill_Mon_360Degree_Shot_OnTargetListModified(actor,action,bIsBefore)\n\
--    ODS(\"Skill_Mon_360Degree_Shot_OnTargetListModified\\n\", false, 150);\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
end\n\
\n\
function Skill_Mon_360Degree_Shot_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime())	--	Rotation Start Time\n\
	action:SetParamFloat(1,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(2,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(3,actor:GetLookingDir():GetZ());\n\
	\n\
	action:SetParamInt(4,0);\n\
	\n\
	local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
	if fireStartNode == nil then\n\
		fireStartNode = \"char_root\"\n\
	end\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
	if fireEffect ~= nil then\n\
		actor:AttachParticle(581,fireStartNode,fireEffect)\n\
--		fireEffect = \"e_m_Mahalka_skill_01_char_root\"\n\
	end					\n\
\n\
	action:SetParamInt(4,0)	-- . \n\
	action:SetParamInt(5,0)	--   . \n\
end\n\
\n\
function Skill_Mon_360Degree_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local	action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		local	bIsMove = action:GetScriptParam(\"MOVE\") == \"TRUE\"\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0)\n\
		local	fTotalTime = action:GetAbil(AT_MAINTENANCE_TIME)/1000.0\n\
\n\
		if bIsMove == false then\n\
			\n\
			if fElapsedTime > fTotalTime then\n\
				return false\n\
			end\n\
			\n\
		else\n\
		\n\
			local	kMovingDir = action:GetParamAsPoint(1)\n\
			local	kMovingTarget = action:GetParamAsPoint(0)\n\
			local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/10000.0);\n\
			\n\
			kMovingDir:Multiply(fMoveSpeed)\n\
			\n\
			actor:SetMovingDelta(kMovingDir);		\n\
			\n\
			local	kCurrentPos = actor:GetPos()\n\
			local	kCurrentDir = kMovingTarget:_Subtract(kCurrentPos)\n\
			kCurrentDir:Unitize()\n\
			\n\
			local	fDot = kCurrentDir:Dot(kMovingDir)\n\
			if fDot<0 then\n\
				return	false\n\
			end			\n\
		\n\
		end\n\
		\n\
		--actor:IncRotate(frameTime*3*460.0*3.141592/180.0);\n\
\n\
		local iAngle = 30\n\
\n\
		local iDegree = fElapsedTime/fTotalTime*360/iAngle--*3.141592/180.0 /30\n\
		iDegree = math.floor(iDegree * iAngle)\n\
		local Delta = iDegree - action:GetParamInt(4)\n\
		if Delta > iAngle then\n\
			actor:IncRotate(math.rad(Delta))\n\
			action:SetParamInt(4, iDegree)\n\
			actor:ResetAnimation()\n\
			actor:PlayCurrentSlot()\n\
		end\n\
		\n\
		if IsSingleMode() then\n\
		\n\
			if action:GetParamInt(4) == 0 and fElapsedTime>0.5 then\n\
				Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);\n\
				action:SetParamInt(4,1);\n\
			end\n\
			\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if action:GetCurrentSlot() == 0 then\n\
			if actor:IsAnimationDone() then\n\
				action:SetSlot(1)\n\
				actor:ResetAnimation();\n\
				actor:PlayCurrentSlot();				\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
				action:SetActionParam(AP_FIRE)\n\
				Skill_Mon_360Degree_Shot_OnCastingCompleted(actor,action)\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Mon_360Degree_Shot_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	actor:DetachFrom(581) \n\
	local kAction = actor:GetAction();\n\
	\n\
	if kAction:IsNil() == false then\n\
		kAction:ClearTargetList();\n\
	end\n\
end\n\
\n\
function Skill_Mon_360Degree_Shot_OnLeave(actor, action)\n\
	return	true\n\
end\n\
\n\
function Skill_Mon_360Degree_Shot_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		--   \n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
\n\
		--  \n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
			\n\
			actor:AttachParticle(231, fireStartNode, fireEffect)\n\
		end\n\
\n\
		-- \n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200\n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
\n\
		local	iProjectileIndex = kAction:GetParamInt(5)\n\
\n\
			local	kArrow = Act_Mon_RangeAttack_LoadToWeapon(actor,kAction,iProjectileIndex);\n\
			if kArrow == nil or kArrow:IsNil() then\n\
				return\n\
			end\n\
\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			--WriteToConsole(\"________MovingDir : \" .. kMovingDir:GetX() .. \", \" .. kMovingDir:GetY() .. \", \" .. kMovingDir:GetZ() .. \"\\n\")\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
			kMovingDir:Multiply(iAttackRange)\n\
			kMovingDir:Add(arrow_worldpos)\n\
			kArrow:SetTargetLoc(kMovingDir)\n\
			kArrow:Fire()\n\
			iProjectileIndex=iProjectileIndex+1;\n\
--			kAction:SetParamInt(5,iProjectileIndex)\n\
--		end\n\
--		kAction:ClearTargetList();\n\
	end\n\
\n\
	return	true\n\
end\n\
\n\
function	Skill_Mon_360Degree_Shot_LoadToWeapon(actor,action,iProjectileIndex)\n\
	return Act_Mon_RangeAttack_LoadToWeapon(actor,action,iProjectileIndex)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Mon_SummonThorn_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThorn_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
--		actor:AttachParticle(1204,\"p_ef_head\",\"ef_deathmaster_skill_02_01_p_ef_head\");\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			action:SetSlot(3)	--	 Idle     Idle  \n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		iNewState = 3\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--    \n\
			return false\n\
		end\n\
		action:SetSlot(4)\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true\n\
end\n\
\n\
function Act_Mon_SummonThorn_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	actor:ResetAnimation()\n\
	\n\
	--	attack target pos\n\
	local	ptTargetPos = 0;\n\
\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket()\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			if iTargetCount>0 then\n\
				local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
				if kTargetInfo:IsNil() == false then\n\
					local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
					if kTargetPilot:IsNil() == false then			\n\
						ptTargetPos = kTargetPilot:GetPos()\n\
					end\n\
				end\n\
			else\n\
				ptTargetPos = actor:GetPos()\n\
			end\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
		end\n\
	end\n\
\n\
--[[	ptTargetPos = g_world:ThrowRay(ptTargetPos,Point3(0,0,-1),500)\n\
	ptTargetPos:SetZ(ptTargetPos:GetZ() + 2)	--   \n\
	\n\
	local iAbil = action:GetAbil(AT_2ND_AREA_PARAM1)\n\
	if iAbil <= 0 then\n\
		iAbil = 60\n\
	end\n\
	actor:AttachParticleToPointS(81190,ptTargetPos,\"ef_Umai_skill_03_02_char_root\", iAbil/64*2)	-- ]]\n\
	\n\
	action:SetParamAsPoint(0,ptTargetPos)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_SummonThorn_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_SummonThorn_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_SummonThorn_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
		\n\
		--     .\n\
	\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_SummonThorn_OnCastingCompleted(actor,action)\n\
	Act_Mon_SummonThorn_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_SummonThorn_Fire(actor,action);\n\
end\n\
\n\
function Act_Mon_SummonThorn_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--     .\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
		if kTargetInfo:IsNil() == false then\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
			if kTargetPilot:IsNil() == false then\n\
				local	kTargetActor = kTargetPilot:GetActor()\n\
				if kTargetActor:IsNil() == false then\n\
					actor:LookAt(kTargetActor:GetPos(),true,true)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_SummonThorn_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			if iState==2 then	--  \n\
				return Act_Mon_SummonThorn_SetState(actor,action,\"RETURN\")\n\
			else\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_SummonThorn_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > 2.0 then -- action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_SummonThorn_OnCastingCompleted(actor,action)			\n\
			end\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThorn_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
\n\
	actor:DetachFrom(81190)\n\
end\n\
\n\
function Act_Mon_SummonThorn_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
--	local	kCurAction = actor:GetAction()\n\
\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Mon_SummonThorn_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
     \n\
    if	textKey == \"fire\" then\n\
        local   action = actor:GetAction()\n\
			\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
		--local	kActorPos = actor:GetPos()\n\
		local	fSkillRange = action:GetSkillRange(0,actor)\n\
		if fSkillRange == 0 then\n\
			fSkillRange = 100\n\
		end\n\
		\n\
		local	kLookDir = actor:GetLookingDir()\n\
		kLookDir:Multiply(fSkillRange)\n\
\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		if iTargetCount>0 then\n\
			for i=0,iTargetCount-1 do\n\
				local kTargetInfo = kTargetList:GetTargetInfo(i)	\n\
				if kTargetInfo:IsNil() == false then\n\
					local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
					if kTargetPilot:IsNil() == false then\n\
--						local pos = kTargetPilot:GetPos()\n\
						local apos = kTargetPilot:GetActor():GetPos()\n\
						apos:SetZ(apos:GetZ()+50)\n\
						local PartPos = g_world:ThrowRay(apos,Point3(0,0,-1),500)\n\
						actor:AttachParticleToPoint(4381+i, PartPos, \"ef_Umai_skill_03_03_char_root\")\n\
					end\n\
				end\n\
			end\n\
		end\n\
		\n\
--	    Act_Mon_Melee_DoDamage(actor,action)\n\
	end\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Mon_SummonThorns_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThorns_SetState(actor,action,kState) \n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	local	iNewState = -1\n\
--	ODS(\"Act_Mon_SummonThorns_SetState \" ..kState .. \"\\n\", false, 1509)\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			action:SetSlot(3)	--	 Idle     Idle  \n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		iNewState = 3\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
			return false\n\
		end\n\
		action:SetSlot(4)\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true\n\
end\n\
\n\
function Act_Mon_SummonThorns_OnEnter(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	actor:ResetAnimation()\n\
	\n\
	--	attack target pos\n\
	local	ptTargetPos = 0;\n\
\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	action:SetParamInt(1,1)\n\
	action:SetParamInt(2,0)	--  \n\
	\n\
	if IsSingleMode() then\n\
		action:AddNewGUID(GetMyActor():GetPos())\n\
	else\n\
		local	kPacket = action:GetParamAsPacket()\n\
		if kPacket == nil or kPacket:IsNil() then	--  \n\
			if iTargetCount>0 then\n\
				for i=0,iTargetCount-1 do\n\
					local	kTargetInfo = kTargetList:GetTargetInfo(i)\n\
					if kTargetInfo:IsNil() == false then\n\
						action:AddNewGUID(kTargetInfo:GetTargetGUID())\n\
					end\n\
				end\n\
			else\n\
				action:AddNewGUID(GetMyActor():GetPos())\n\
			end\n\
		else\n\
			local byPacketType = kPacket:PopByte()\n\
			local iCount = kPacket:PopInt()\n\
			action:SetParamInt(1,iCount)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			for i=1,iCount do\n\
				local kGuid = kPacket:PopGuid()\n\
				local kTarget = g_world:FindActor(kGuid)\n\
				if nil~=kTarget and false==kTarget:IsNil() then\n\
					action:AddNewGUID(kGuid)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_SummonThorns_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_SummonThorns_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_SummonThorns_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
		\n\
		--     .\n\
	\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_SummonThorns_OnCastingCompleted(actor,action)\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	Act_Mon_SummonThorns_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_SummonThorns_Fire(actor,action);\n\
end\n\
\n\
function Act_Mon_SummonThorns_Fire(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--     .\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
		if kTargetInfo:IsNil() == false then\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
			if kTargetPilot:IsNil() == false then\n\
				local	kTargetActor = kTargetPilot:GetActor()\n\
				if kTargetActor:IsNil() == false then\n\
					actor:LookAt(kTargetActor:GetPos(),true,true)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_SummonThorns_OnUpdate(actor, accumTime, frameTime)\n\
--	ODS(\"Act_Mon_SummonThorns_OnUpdate\\n\", false, 1509)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	local	action = actor:GetAction()\n\
	local	iState = action:GetParamInt(0)\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	if 0==action:GetParamInt(2) then	--  \n\
		action:SetParamInt(2,1)\n\
		local RangeEffect = actor:GetAnimationInfo(\"RANGE_EFFECT\")\n\
		if nil == RangeEffect then	--  \n\
			RangeEffect = \"ef_valgon_skill_03_03_char_root\"\n\
		end\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local iTotal = action:GetTotalGUIDInContainer()\n\
		for i=0,iTotal-1 do\n\
			local kTarget = g_world:FindActor(action:GetGUIDInContainer(i))\n\
			if nil~=kTarget and false==kTarget:IsNil() then\n\
				kTarget:AttachParticle(81190, \"char_root\", RangeEffect)\n\
			end\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if actor:IsAnimationDone() == true then\n\
			if iState == 2 then	--Fire \n\
				return Act_Mon_SummonThorns_SetState(actor, action, \"RETURN\")\n\
			else\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_SummonThorns_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > 2.0 then -- action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_SummonThorns_OnCastingCompleted(actor,action)			\n\
			end\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThorns_OnCleanUp(actor, action)\n\
--	ODS(\"Act_Mon_SummonThorns_OnCleanUp\\n\", false, 1509)\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	local	kCurAction = actor:GetAction()\n\
	if nil~=kCurAction and false==kCurAction:IsNil() then\n\
		local iTargetCount = kCurAction:GetParamInt(1)\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		for i=0,iTargetCount do\n\
			local kGuid = kCurAction:GetGUIDInContainer(i)\n\
			if false==kGuid:IsNil() then\n\
				local kTarget = g_world:FindActor(kGuid)\n\
				if nil~=kTarget and false==kTarget:IsNil() then\n\
					kTarget:DetachFrom(81190)\n\
				end\n\
			end\n\
		end\n\
	end\n\
end\n\
\n\
function Act_Mon_SummonThorns_OnLeave(actor, action)\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	local	kCurAction = actor:GetAction()\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Mon_SummonThorns_OnEvent(actor,textKey)\n\
   	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
    if	textKey == \"fire\" or textKey == \"hit\" then\n\
--		ODS(\"Act_Mon_SummonThorns_OnEvent \" .. textKey .. \"\\n\", false, 1509)\n\
        local   action = actor:GetAction()\n\
		if( CheckNil(nil==action) ) then return end\n\
		if( CheckNil(action:IsNil()) ) then return end\n\
		local	kActorPos = actor:GetPos()\n\
		local	fSkillRange = action:GetSkillRange(0,actor)\n\
		if fSkillRange == 0 then\n\
			fSkillRange = 100\n\
		end\n\
		\n\
		local	kLookDir = actor:GetLookingDir()\n\
		kLookDir:Multiply(fSkillRange)\n\
	\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = action:GetTotalGUIDInContainer()\n\
--		ODS(\"action:GetGUIDInContainer \" .. iTargetCount .. \"\\n\", false, 1509)\n\
		--      \n\
		local bSoundplay = false\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		for i=0,iTargetCount do	--0\n\
--			ODS(\"Act_Mon_SummonThorns_OnEvent \" .. iTargetCount .. \"\\n\", false, 1509)\n\
			local kGuid = action:GetGUIDInContainer(i)\n\
			if false==kGuid:IsNil() then\n\
				local kTarget = g_world:FindActor(kGuid)\n\
				if nil~=kTarget and false==kTarget:IsNil() then\n\
					kTarget:DetachFrom(81190)\n\
					if bSoundplay == false then\n\
						local	kSoundID = actor:GetAnimationInfo(\"HIT_SOUND_ID\");\n\
						if kSoundID ~= \"\" then\n\
							kTarget:AttachSound(986,kSoundID);\n\
						end	\n\
						bSoundplay = true\n\
					end\n\
				end\n\
			end\n\
		end\n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThorns_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
\n\
-- Melee\n\
function Skill_Mon_BatMissle_OnCheckCanEnter(actor,action)\n\
	return true\n\
end\n\
function Skill_Mon_BatMissle_OnCastingCompleted(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(action:GetCurrentSlot()+1)\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	Skill_Mon_BatMissle_Fire(actor,action)\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	actor:DetachFrom(123)	--  \n\
end\n\
\n\
function Skill_Mon_BatMissle_Fire(actor,action)\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function Skill_Mon_BatMissle_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	actor:ResetAnimation();\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Skill_Mon_BatMissle_OnCastingCompleted(actor,action)\n\
	else\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		local effect = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT\", action, 1000212)\n\
		if nil ~= effect then\n\
			local node = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT_NODE\", action, 1000212)\n\
			if nil == node then\n\
				node = \"char_root\"\n\
			end\n\
\n\
			actor:AttachParticle(123, node, effect)\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Mon_BatMissle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
\n\
	local	iState = action:GetParamInt(1)\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if animDone == true then\n\
			if iState == 2 then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
					return false\n\
				else\n\
					Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
					return true\n\
				end\n\
			end\n\
			\n\
			return false\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then\n\
			if animDone then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Mon_BatMissle_OnCleanUp(actor)\n\
    return true;\n\
end\n\
\n\
function Skill_Mon_BatMissle_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	--ODS(\"Act_Mon_Melee_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Skill_Mon_BatMissle_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Skill_Mon_BatMissle_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
        actor:ClearIgnoreEffectList();\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local   kTargetList = kAction:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
--		local   iTargetNum = 0\n\
		local   kTargetInfo = nil\n\
\n\
		local fire_delay = actor:GetAnimationInfo(\"FIRE_DELAY\")\n\
		if nil == fire_delay or \"\" == Projectile_cnt then\n\
			fire_delay = 0 --   \n\
		else\n\
			fire_delay = tonumber(fire_delay)\n\
		end\n\
\n\
		local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
			Projectile_cnt = 5 --  5\n\
		else\n\
			Projectile_cnt = tonumber(Projectile_cnt)\n\
		end\n\
		\n\
		if iTargetCount>0 then\n\
				--	  \n\
			local	kTargetGUID = kAction:GetTargetGUID(0);\n\
			local   iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
			local   targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				local   pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end	\n\
		end		\n\
\n\
		local   kLookDir = actor:GetLookingDir();\n\
		local kUp = Point3(0,0,1)\n\
		local kRight = kLookDir:Cross(kUp)	--   right \n\
		kRight:Unitize()	-- \n\
		local iRound = kAction:GetAbil(AT_1ST_AREA_PARAM2)\n\
\n\
		if iRound == 0 then\n\
			iRound = 40\n\
		end\n\
\n\
		local kAddZ = actor:GetAnimationInfo(\"PROJECTILE_ADD_Z\")\n\
		local no = actor:GetAnimationInfo(\"NO_VERICAL_RANDOM\")\n\
		local   iArrowCount = 0\n\
		while   iArrowCount<Projectile_cnt do\n\
		    --   \n\
			local	kNewArrow = Skill_Mon_BatMissle_LoadToWeapon(actor,kAction,0,kAddZ);\n\
			if kNewArrow == nil or kNewArrow:IsNil() then\n\
				ODS(\"Arrow is nil\\n\")\n\
				return\n\
			end\n\
\n\
		    kTargetInfo = kTargetList:GetTargetInfo(0)\n\
		    \n\
		    kNewArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
		    local	arrow_worldpos = kNewArrow:GetWorldPos()	--	 \n\
	        local   kTargetPos = actor:GetLookingDir()\n\
			kTargetPos:Multiply(iAttackRange)\n\
			kTargetPos:Add(arrow_worldpos)\n\
\n\
			if nil==no then\n\
				kTargetPos:Add(Point3(0,0,math.random(-iRound, iRound)))\n\
			end\n\
			local addx = kRight:_Multiply(math.random(-iRound, iRound))\n\
\n\
			if nil~=kAddZ and 0~=kAddZ then\n\
				addx:SetZ(addx:GetZ()+kAddZ)\n\
			end\n\
\n\
			kTargetPos:Add(addx)\n\
\n\
			kNewArrow:SetTargetLoc(kTargetPos)    \n\
		    \n\
		    kNewArrow:DelayFire(iArrowCount*fire_delay)\n\
		    \n\
		    iArrowCount=iArrowCount+1\n\
		end\n\
\n\
		local dmg = actor:GetAnimationInfo(\"DAMAGE_ON_EVENT\")\n\
		if nil~=dmg then\n\
			Act_Mon_Melee_DoDamage(actor, kAction)\n\
		end\n\
	end\n\
\n\
	return	true\n\
end\n\
\n\
function Skill_Mon_BatMissle_LoadToWeapon(actor,action,iProjectileIndex,kAddZ)\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	if iProjectileIndex>0 and kProjectileID==nil then\n\
		return	nil\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
\n\
	local kNodePos = actor:GetNodeTranslate(kTargetNodeID)\n\
	if nil~=kAddZ then\n\
		kNodePos:SetZ(kNodePos:GetZ()+kAddZ)\n\
	end\n\
	kNewArrow:LoadToPosition(kNodePos)\n\
--	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	return kNewArrow\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Mon_SummonThorn for skill actor\n\
\n\
function Act_Mon_SummonThornSA_OnCheckCanEnter(actor, action) \n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThornSA_SetState(actor,action,kState)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
	return	true\n\
end\n\
\n\
function Act_Mon_SummonThornSA_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	local	kPacket = action:GetParamAsPacket()\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			if iTargetCount>0 then\n\
				local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
				if kTargetInfo:IsNil() == false then\n\
					local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
					if kTargetPilot:IsNil() == false then			\n\
						ptTargetPos = kTargetPilot:GetPos()\n\
					end\n\
				end\n\
			else\n\
				ptTargetPos = actor:GetPos()\n\
			end\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
		end\n\
\n\
	action:SetParamFloat(2, 0.0)-- \n\
	action:SetParamAsPoint(3, actor:GetPos())--  \n\
	action:SetParamInt(4,0)\n\
\n\
	return true\n\
end\n\
function Act_Mon_SummonThornSA_OnCastingCompleted(actor,action)\n\
	Act_Mon_SummonThornSA_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_SummonThornSA_Fire(actor,action);\n\
end\n\
\n\
function Act_Mon_SummonThornSA_Fire(actor,action)\n\
	\n\
end\n\
\n\
function Act_Mon_SummonThornSA_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
		\n\
	if action:IsNil() then\n\
		return true\n\
	end\n\
	\n\
--	local	action = actor:GetAction()\n\
--	local	iState = action:GetParamInt(0)\n\
	local 	fTime = action:GetParamFloat(2)\n\
	local 	fDelta = accumTime - fTime\n\
	local 	kCenter = action:GetParamAsPoint(3)\n\
	local	iAbil = action:GetAbil(AT_2ND_AREA_PARAM1)\n\
	if iAbil <= 0 then\n\
		iAbil = 80\n\
	end\n\
	local 	iIdx = action:GetParamInt(4)\n\
	local kEffect = actor:GetAnimationInfo(\"FIRE_START_EFFECT\")\n\
	if nil==kEffect or \"\"==kEffect then\n\
		kEffect = \"ef_Umai_skill_03_03_char_root\"\n\
	end\n\
	\n\
	local kInterval = actor:GetAnimationInfo(\"INTER_TIME\")\n\
	if nil==kInterval then\n\
		kInterval = 0.08\n\
	else\n\
		kInterval = tonumber(kInterval)\n\
	end\n\
\n\
	if fDelta > kInterval then\n\
		local fValue = Random()\n\
		fValue = (fValue%628)*0.01\n\
		local kPos = Point3(math.sin(fValue), math.cos(fValue), 0)\n\
		kPos:Unitize()\n\
		kPos:Multiply(math.random(1,iAbil-10))\n\
		kPos:Add(kCenter)\n\
--		actor:AttachParticleToPoint(4381+iIdx, kPos, \"ef_Umai_skill_03_03_char_root\")	\n\
\n\
		local rot = Random()%math.pi\n\
		local quat = Quaternion(rot, Point3(0,0,1))\n\
		local scale = Random()%5*0.1 + 0.8 --1.0~1.4\n\
		actor:AttachParticleToPointWithRotate(4381+iIdx, kPos, kEffect, quat, scale)	\n\
\n\
		action:SetParamFloat(2, accumTime)-- \n\
		action:SetParamInt(4, iIdx+1)\n\
\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThornSA_OnCleanUp(actor, action)\n\
	actor:DetachFrom(81190)\n\
end\n\
\n\
function Act_Mon_SummonThornSA_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	kCurAction = actor:GetAction()\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Mon_SummonThornSA_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThornSA_OnTargetListModified(actor,action,bIsBefore)\n\
end") );
	m_kContLuaText.push_back(std::string("-- Mon_SummonThorn for skill actor\n\
\n\
function Act_Mon_SummonThornsSA_OnCheckCanEnter(actor, action) \n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_SetState(actor,action,kState)\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	local	iNewState = -1	--   \n\
	if kState == \"BATTLEIDLE_START\" then\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
	return	true\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_OnEnter(actor, action)\n\
--	ODS(\"Act_Mon_SummonThornsSA_OnEnter\\n\", false, 1509)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	local	kPacket = action:GetParamAsPacket()\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			if iTargetCount>0 then\n\
				local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
				if kTargetInfo:IsNil() == false then\n\
					local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
					if kTargetPilot:IsNil() == false then			\n\
						ptTargetPos = kTargetPilot:GetPos()\n\
					end\n\
				end\n\
			else\n\
				ptTargetPos = actor:GetPos()\n\
			end\n\
		else\n\
			ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
		end\n\
\n\
	action:SetParamFloat(2, 0.0)-- \n\
	action:SetParamAsPoint(3, actor:GetPos())--  \n\
	action:SetParamInt(4,0)\n\
\n\
	return true\n\
end\n\
function Act_Mon_SummonThornsSA_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	Act_Mon_SummonThornsSA_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_SummonThornsSA_Fire(actor,action);\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_Fire(actor,action)\n\
	\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_OnUpdate(actor, accumTime, frameTime)\n\
--	ODS(\"Act_Mon_SummonThornsSA_OnUpdate\\n\", false, 1509)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	local	action = actor:GetAction()\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	if action:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	local	action = actor:GetAction()\n\
	local	iState = action:GetParamInt(0)\n\
	local 	fTime = action:GetParamFloat(2)\n\
	local 	kCenter = action:GetParamAsPoint(3)\n\
	local	iAbil = action:GetAbil(AT_2ND_AREA_PARAM1)\n\
	if iAbil <= 0 then\n\
		iAbil = 80\n\
	end\n\
	local 	iIdx = 0\n\
\n\
	for i=1,10 do\n\
		local fValue = Random()\n\
		fValue = (fValue%628)*0.01\n\
		local kPos = Point3(math.sin(fValue), math.cos(fValue), 0)\n\
		kPos:Unitize()\n\
		kPos:Multiply(math.random(1,iAbil-10))\n\
		kPos:Add(kCenter)\n\
\n\
		local rot = Random()%math.pi\n\
		local quat = Quaternion(rot, Point3(0,0,1))\n\
		local scale = Random()%5*0.1 + 0.8 --1.0~1.4\n\
		--FIRE_START_EFFECT\n\
		local kEffect = actor:GetAnimationInfo(\"FIRE_START_EFFECT\")\n\
		if nil==kEffect or \"\"==kEffect then\n\
			kEffect = \"ef_BossAram_Item03_01\"\n\
		end\n\
		actor:AttachParticleToPointWithRotate(4381+iIdx, kPos, kEffect, quat, scale)	\n\
\n\
		iIdx = iIdx+1\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_OnCleanUp(actor, action)\n\
\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_OnLeave(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	local	kCurAction = actor:GetAction()\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Mon_SummonThornsSA_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonThornsSA_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_DropProjectile_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_DropProjectile_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_DropProjectile_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
--	Act_Mon_DropProjectile_Fire(actor,action);\n\
end\n\
\n\
function	Act_Mon_DropProjectile_LoadToWeapon(actor,action,kStartPos)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kAttachID=\"\";\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjectileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"));\n\
	if fProjectileScale == nil then\n\
		fProjectileScale = 1.0\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	kNewArrow:SetScale(fProjectileScale*kNewArrow:GetScale());\n\
	kNewArrow:LoadToPosition(kStartPos);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_DropProjectile_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_DropProjectile_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_DropProjectile_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_DropProjectile_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_DropProjectile_OnEnter Start Casting\\n\");\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		local	ptTargetPos = 0;\n\
		\n\
		if IsSingleMode() then\n\
			ptTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ptTargetPos = actor:GetPos()\n\
			else\n\
				ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
			end\n\
		end\n\
		\n\
		-- Look at targetpos\n\
		actor:LookAt(ptTargetPos,true,false);\n\
		\n\
		-- Save the targetpos\n\
		action:SetParamAsPoint(0,ptTargetPos);		\n\
		\n\
		local effect = actor:GetAnimationInfoFromAniName(\"RANGE_EFFECT\",\"drop_projectile_btlidle\")\n\
		if effect:IsNil() or \"\"==effect:GetStr() then\n\
			effect:Set(\"ef_Shark_king_abdula_skill_03_03_char_root\")\n\
		end\n\
		actor:AttachParticleToPoint(81190,ptTargetPos,effect:GetStr());\n\
		\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_DropProjectile_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
--	local	iTotalProjectile = 30;\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_DropProjectile_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_DropProjectile_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(81190);\n\
	return true;\n\
end\n\
\n\
function Act_Mon_DropProjectile_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_DropProjectile_OnLeave\\n\");\n\
	return true;\n\
end\n\
\n\
function Act_Mon_DropProjectile_FireArrow(actor,action,fFireDelay)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	\n\
	local	fRange = 100.0;\n\
	local	kTargetCenterPos = action:GetParamAsPoint(0);	\n\
	\n\
	local	kStartPos = kTargetCenterPos\n\
	kStartPos:SetZ(kStartPos:GetZ()+30)\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local	kFireDir = Point3(0,0,-1)\n\
	local	kFireTargetPos = g_world:ThrowRay(kStartPos,kFireDir,1000)\n\
	if kFireTargetPos:GetX() == -1 then\n\
		return true\n\
	end\n\
	\n\
	local	iSkillRange = action:GetSkillRange(0,actor)\n\
	\n\
	kStartPos:SetZ(kFireTargetPos:GetZ()+300)\n\
	\n\
	local	kProjectile = Act_Mon_DropProjectile_LoadToWeapon(actor,action,kStartPos);\n\
	\n\
	kProjectile:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
\n\
	kFireTargetPos:SetZ(kFireTargetPos:GetZ()+10)\n\
	kProjectile:SetTargetLoc(kFireTargetPos)\n\
	local effect = actor:GetAnimationInfo(\"EFFECT_TO_GROUND\")\n\
	if nil==effect then\n\
		effect = \"ef_woody_attk\"\n\
	end\n\
	kProjectile:SetParamValue(\"EFFECT_TO_GROUND\", effect)\n\
	local qtime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
	if nil==qtime then\n\
		qtime = \"0.5\"\n\
	end\n\
	kProjectile:SetParamValue(\"QUAKE_TIME\", qtime)\n\
	local qfactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")\n\
	if nil==qfactor then\n\
		qfactor = \"2.1\"\n\
	end\n\
	kProjectile:SetParamValue(\"QUAKE_FACTOR\", qfactor)\n\
\n\
	local kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and \"\"~=kSoundID then\n\
		kProjectile:SetParamValue(\"SOUND_ID\", kSoundID)\n\
	end\n\
\n\
	kProjectile:Fire(true)\n\
	\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_DropProjectile_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	ODS(\"Act_Mon_DropProjectile_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		Act_Mon_DropProjectile_FireArrow(actor,kAction,0);\n\
		\n\
		if kAction:GetTargetList():IsNil() == false then\n\
			kAction:GetTargetList():ApplyActionEffects()\n\
		end\n\
		kAction:ClearTargetList();	\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_DropProjectile_01_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_DropProjectile_01_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_DropProjectile_01_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
--	Act_Mon_DropProjectile_01_Fire(actor,action);\n\
end\n\
\n\
function	Act_Mon_DropProjectile_01_LoadToWeapon(actor,action,kStartPos)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kAttachID=\"\";\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjectileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"));\n\
	if fProjectileScale == nil then\n\
		fProjectileScale = 1.0\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	kNewArrow:SetScale(fProjectileScale*kNewArrow:GetScale());\n\
	kNewArrow:LoadToPosition(kStartPos);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_Fire(actor,action)\n\
\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_DropProjectile_01_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_DropProjectile_01_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_DropProjectile_01_OnEnter Start Casting\\n\");\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		local	ptTargetPos = 0;\n\
		\n\
		if IsSingleMode() then\n\
			ptTargetPos = GetMyActor():GetPos();\n\
		else\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ptTargetPos = actor:GetPos()\n\
			else\n\
				ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
			end\n\
		end\n\
		\n\
		-- Look at targetpos\n\
		actor:LookAt(ptTargetPos,true,false);\n\
		\n\
		-- Save the targetpos\n\
		action:SetParamAsPoint(0,ptTargetPos);		\n\
		\n\
		actor:AttachParticleToPoint(81190,ptTargetPos,\"ef_Blizzard_mon\");\n\
		\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
--	local	iTotalProjectile = 30;\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_DropProjectile_01_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(81190);\n\
	return true;\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_DropProjectile_01_OnLeave\\n\");\n\
	return true;\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_FireArrow(actor,action,fFireDelay)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	\n\
	local	fRange = 100.0;\n\
	local	kTargetCenterPos = action:GetParamAsPoint(0);	\n\
	\n\
	local	kStartPos = kTargetCenterPos\n\
	kStartPos:SetZ(kStartPos:GetZ()+30)\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local	kFireDir = Point3(0,0,-1)\n\
	local	kFireTargetPos = g_world:ThrowRay(kStartPos,kFireDir,1000)\n\
	if kFireTargetPos:GetX() == -1 then\n\
		return true\n\
	end\n\
	\n\
	local	iSkillRange = action:GetSkillRange(0,actor)\n\
	\n\
	kStartPos:SetZ(kFireTargetPos:GetZ()+300)\n\
	\n\
	local	kProjectile = Act_Mon_DropProjectile_01_LoadToWeapon(actor,action,kStartPos);\n\
	\n\
	kProjectile:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
\n\
	kFireTargetPos:SetZ(kFireTargetPos:GetZ()+10)\n\
	kProjectile:SetTargetLoc(kFireTargetPos)\n\
	local effect = actor:GetAnimationInfo(\"EFFECT_TO_GROUND\")\n\
	if nil==effect then\n\
		effect = \"ef_woody_attk\"\n\
	end\n\
	kProjectile:SetParamValue(\"EFFECT_TO_GROUND\", effect)\n\
	local qtime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
	if nil==qtime then\n\
		qtime = \"0.5\"\n\
	end\n\
	kProjectile:SetParamValue(\"QUAKE_TIME\", qtime)\n\
	local qfactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")\n\
	if nil==qfactor then\n\
		qfactor = \"2.1\"\n\
	end\n\
	kProjectile:SetParamValue(\"QUAKE_FACTOR\", qfactor)\n\
\n\
	local kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and \"\"~=kSoundID then\n\
		kProjectile:SetParamValue(\"SOUND_ID\", kSoundID)\n\
	end\n\
\n\
	kProjectile:Fire(true)\n\
	\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_DropProjectile_01_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	ODS(\"Act_Mon_DropProjectile_01_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		Act_Mon_DropProjectile_01_FireArrow(actor,kAction,0);\n\
		\n\
		if kAction:GetTargetList():IsNil() == false then\n\
			kAction:GetTargetList():ApplyActionEffects()\n\
		end\n\
		kAction:ClearTargetList();	\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_Antares_Laser_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_Antares_Laser_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_Antares_Laser_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Antares_Laser_Fire(actor,action);\n\
	\n\
\n\
end\n\
\n\
function	Act_Mon_Antares_Laser_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kAttachID=\"\";\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..(iProjectileIndex);\n\
	end\n\
\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID);\n\
	if kTargetNodeID == nil then\n\
		if 0==iProjectileIndex then\n\
			kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\");\n\
		else\n\
			return nil\n\
		end\n\
	end\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_weapon\"\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"PROJECTILE_ANTARES_LASER\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_Antares_Laser_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\");\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Antares_Laser_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
		\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Antares_Laser_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Antares_Laser_OnEnter Start Casting\\n\");\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_RangeAttack Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParamFloat(4, 0)	-- \n\
	action:SetParamInt(5, 0)	--  \n\
	action:SetParam(6, \"end\")	--,   \n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_Antares_Laser_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
	local actionID = action:GetID();\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\");\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		if bIsBoomerang then\n\
			if action:GetParam(1) == \"end\" then\n\
				return	false;\n\
			elseif action:GetParam(1) == \"wait_animdone\" then\n\
				if animDone == true then\n\
					action:SetParam(1, \"end\")\n\
					actor:DetachFrom(231)\n\
					return false\n\
				end\n\
			end	\n\
			return	true;\n\
		end\n\
\n\
		if animDone == true then\n\
			if iState==2 then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
					action:SetParam(1, \"end\")\n\
					actor:DetachFrom(231)\n\
					return false\n\
				else\n\
					Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
					action:SetParam(1,\"wait_animdone\")	\n\
				end\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				actor:DetachFrom(231)\n\
				return false\n\
			end\n\
		end\n\
		local pasttime = action:GetParamFloat(4)\n\
		local delta = accumTime - action:GetParamFloat(4)\n\
\n\
		if \"fire\"==action:GetParam(6) or \"hit\"==action:GetParam(6) then\n\
\n\
			local inter = actor:GetAnimationInfo(\"SHOT_INTER_TIME\")\n\
			if inter == nil then\n\
				inter = 0.3\n\
			else\n\
				inter = tonumber(inter)\n\
			end\n\
\n\
			if inter < delta then\n\
\n\
				action:SetParamFloat(4, accumTime)\n\
\n\
				for iLoop=0,3 do -- 4 \n\
\n\
					local	kArrow = Act_Mon_Antares_Laser_LoadToWeapon(actor,action,iLoop);\n\
					if kArrow == nil or kArrow:IsNil() then\n\
						return true\n\
					end\n\
\n\
					if bIsBoomerang then\n\
						kArrow:SetMultipleAttack(true);\n\
					end\n\
			\n\
					if kArrow:IsNil() == false then\n\
						kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
					end\n\
\n\
					local	kAttachID=\"\";\n\
	\n\
					if iLoop>0 then\n\
						kAttachID = \"\"..iLoop;\n\
					end\n\
			\n\
					local fZ = actor:GetAnimationInfo(\"Z_FACTOR\")\n\
					if nil ~= fZ then\n\
						fZ = tonumber(fZ)\n\
						kArrow:SetMovingType(1)\n\
						kArrow:SetParam_SinCurveLineType(fZ, 0)\n\
					end\n\
					\n\
					local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID);\n\
					if nil == kTargetNodeID then\n\
						kTargetNodeID = \"p_ef_weapon\"\n\
					end\n\
					\n\
					local	kScale = actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID);\n\
					if nil==kScale or \"\"==kScale then\n\
						kScale = 1.0\n\
					else\n\
						kScale = tonumber(kScale)\n\
					end\n\
\n\
					local weaponrot = actor:GetNodeRotateAxis(kTargetNodeID,2, true)\n\
					weaponrot:Multiply(-1)\n\
					local weaponpos = actor:GetNodeWorldPos(kTargetNodeID)\n\
					local kEndnode = kTargetNodeID..\"_end\"\n\
					local weaponendpos = actor:GetNodeWorldPos(kEndnode)\n\
					local dir = Point3(weaponendpos:GetX() - weaponpos:GetX(), weaponendpos:GetY() - weaponpos:GetY(), weaponendpos:GetZ() - weaponpos:GetZ())\n\
			\n\
					dir:Unitize()\n\
					local TargetPos = nil\n\
					local kEndFront = actor:GetAnimationInfo(\"FIRE_END_NODE_FRONT\"..kAttachID);\n\
					if nil~=kEndFront then\n\
						kEndFront = tonumber(kEndFront)\n\
						if kEndFront>0 then\n\
							local	kFireTarget = dir\n\
							kFireTarget:SetZ(0)\n\
							kFireTarget:Multiply(kEndFront)\n\
							kFireTarget:Add(weaponpos)\n\
							TargetPos = kFireTarget\n\
						end\n\
					end\n\
\n\
					if nil==TargetPos then\n\
						if( CheckNil(g_world == nil) ) then return false end\n\
						if( CheckNil(g_world:IsNil()) ) then return false end\n\
						TargetPos = g_world:ThrowRay(weaponpos,dir,500)	--  \n\
					end\n\
\n\
					kArrow:SetScale(kScale)\n\
					kArrow:SetTargetLoc(TargetPos)	\n\
					kArrow:Fire(true);\n\
					action:SetParamInt(5, action:GetParamInt(5)+1)\n\
					if actor:IsEqualObjectName(\"m_cleef_gatekeeper\") then\n\
						actor:AttachParticleToPoint(Random(),TargetPos,\"ef_gatekeeper_skill_02_03\")\n\
					else\n\
						local kGroundEff = actor:GetAnimationInfo(\"GROUND_EFFECT\");\n\
						if nil==kGroundEff then\n\
							actor:AttachParticleToPoint(Random(),TargetPos,\"ef_antares_skill_02_02_char_root\")\n\
						elseif \"\"~=kGroundEff and \"NONE\"~=kGroundEff then\n\
							actor:AttachParticleToPoint(Random(),TargetPos,kGroundEff)\n\
						end\n\
					end\n\
				end\n\
			end\n\
		end\n\
\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Antares_Laser_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Antares_Laser_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if actor:GetAction():GetParamInt(4) == 1 then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
		actor:GetAction():SetParamInt(4,0);\n\
	end	\n\
\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Antares_Laser_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Antares_Laser_OnLeave\\n\");\n\
	return true;\n\
end\n\
function Act_Mon_Antares_Laser_SwordReturn(actor,iActionInstanceID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0);\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
			action:SetParam(1,\"end\");\n\
		else\n\
		\n\
			Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
			action:SetParam(1,\"wait_animdone\")\n\
		\n\
		end\n\
	\n\
	end\n\
\n\
end\n\
function Act_Mon_Antares_Laser_OnEvent(actor,textKey)\n\
\n\
	ODS(\"Act_Mon_Antares_Laser_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		Act_Mon_Cast_Effect(actor,textKey)\n\
		return true;\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"end\" then\n\
		kAction:SetParam(6,textKey)\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\");\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1);	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil and \"NONE\" ~= fireEffect then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
			\n\
			actor:AttachParticle(231, fireStartNode, fireEffect)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		\n\
--		local	iProjectileIndex = 0\n\
\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
				\n\
		local	iTargetCount = kAction:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
\n\
		if iTargetCount>0 then\n\
				--	  \n\
			local	kTargetGUID = kAction:GetTargetGUID(0);\n\
			iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
			kActionTargetInfo = kAction:GetTargetInfo(0);\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt,true,true);\n\
			end						\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
--\n\
function	Act_Mon_PATROL_SHOT_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	\n\
	if kProjectileID == nil or kProjectileID == \"\" then\n\
		kProjectileID = \"PROJECTILE_Raum_Egg\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\");\n\
	if kTargetNodeID == nil or kTargetNodeID == \"\" then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		actor:ToLeft(true, true)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		actor:ToLeft(true, true)		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_PATROL_SHOT_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(5);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
\n\
		--actor:AttachParticle(129,\"char_root\",\"ef_Mahalka_skill_03_01_char_root\");		\n\
	elseif kState == \"FIRE\" then\n\
		actor:ToLeft(true, true)\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN1\" then\n\
		actor:ToLeft(true, true)\n\
		action:SetSlot(3)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(3)) == 0 then	\n\
			action:SetSlot(5)	--	Finish     Idle  .\n\
		end\n\
\n\
		iNewState = 3;\n\
	elseif kState == \"RETURN2\" then\n\
		actor:ToLeft(true, true)\n\
		action:SetSlot(4)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	\n\
			action:SetSlot(5)	--	Finish     Idle  .\n\
		end\n\
\n\
		iNewState = 4\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_PATROL_SHOT_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\")\n\
\n\
	actor:SetNoWalkingTarget(false)\n\
	actor:FreeMove(true)\n\
--	actor:ToLeft(true, true)\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
		\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_PATROL_SHOT_OnCastingCompleted(actor,action)\n\
	else\n\
		if( Act_Mon_PATROL_SHOT_SetState(actor,action,\"BATTLEIDLE_START\") == false) then	--  \n\
			Act_Mon_PATROL_SHOT_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
	end\n\
	\n\
	action:SetParamFloat(1,0)	--   \n\
	action:SetParamFloat(2,0)	--    \n\
	action:SetParamInt(3,0)	-- \n\
	action:SetParamFloat(5,0)	--   \n\
	action:SetParamAsPoint(7,actor:GetPos())-- \n\
	action:SetParamAsPoint(8,actor:GetPos())-- \n\
	action:SetParamFloat(9,0)	--ADD_Z\n\
	return true\n\
end\n\
function Act_Mon_PATROL_SHOT_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_PATROL_SHOT_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_PATROL_SHOT_Fire(actor,action);	\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--actor:AttachParticle(129,\"char_root\",\"ef_Mahalka_skill_03_02_char_root\");\n\
	if 0>=action:GetParamFloat(1) then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(1, g_world:GetAccumTime())--   \n\
		local rand = Random()%5*0.1+0.1\n\
		action:SetParamFloat(2, g_world:GetAccumTime()+rand)--    \n\
	end\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
--		local delta = accumTime - action:GetParamFloat(1)\n\
		local bRet = true\n\
		local param = action:GetParamInt(0)\n\
		if 2==param then\n\
			if actor:IsAnimationDone() then\n\
				action:SetParamAsPoint(7,actor:GetPos():_Subtract(action:GetParamAsPoint(8)))--   \n\
				Act_Mon_PATROL_SHOT_SetState(actor,action,\"RETURN1\")\n\
				action:SetParamFloat(5, accumTime)\n\
			end\n\
		elseif 3==param then	--return1\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_PATROL_SHOT_SetState(actor,action,\"RETURN2\")\n\
			else	--  \n\
				local deltareturn = accumTime - action:GetParamFloat(5)\n\
				local anilen = actor:GetAnimationLength(action:GetSlotAnimName(action:GetParamInt(0)))\n\
				local rate = 1 - deltareturn/anilen	--.      ??\n\
				if 0 < rate then\n\
					local loc = action:GetParamAsPoint(8):_Add(action:GetParamAsPoint(7):_Multiply(rate))\n\
					actor:SetTranslate(loc)	--  \n\
				end\n\
			end\n\
		elseif 4==param then	--return2\n\
			if actor:IsAnimationDone() then\n\
				actor:SetTranslate(action:GetParamAsPoint(8))	--  \n\
				bRet = false\n\
			end\n\
		end\n\
		return bRet\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		local fAddZ = actor:GetAnimationInfo(\"ADD_Z\")\n\
		\n\
		if nil ~= fAddZ then\n\
			fAddZ = tonumber(fAddZ)\n\
			local pos = actor:GetPos()\n\
			pos:SetZ(pos:GetZ() + fAddZ*frameTime)\n\
			actor:SetTranslate(pos)\n\
			action:SetParamFloat(9,fAddz)	--ADD_Z\n\
		end\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_PATROL_SHOT_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_PATROL_SHOT_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	else\n\
		ODS(\"actionparam : \" .. action:GetActionParam() .. \"\\n\")\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_PATROL_SHOT_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	actor:DetachFrom(129)\n\
	actor:FreeMove(false)\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_PATROL_SHOT_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Act_Mon_PATROL_SHOT_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
end\n\
\n\
function Act_Mon_PATROL_SHOT_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local kFireDir = Point3(0,0,-1)\n\
		local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\");\n\
		if kTargetNodeID == nil or kTargetNodeID == \"\" then\n\
			kTargetNodeID = \"p_ef_heart\"\n\
		end\n\
		local nodepos = actor:GetNodeWorldPos(kTargetNodeID)\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local kFireTargetPos = g_world:ThrowRay(nodepos,kFireDir,1000)\n\
		if kFireTargetPos:GetX() ~= -1 and kFireTargetPos:GetY() ~= -1 and kFireTargetPos:GetZ() ~= -1 then\n\
			local kNewArrow = Act_Mon_PATROL_SHOT_LoadToWeapon(actor,kAction,kAction:GetParamInt(3))\n\
			kAction:SetParamInt(3, kAction:GetParamInt(3)+1)\n\
			if nil~=kNewArrow and false == kNewArrow:IsNil() then\n\
				kNewArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
				kNewArrow:SetTargetLoc(kFireTargetPos)\n\
				kNewArrow:Fire(true)\n\
			end\n\
		end\n\
	end\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Skill_Mon_Breath_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Mon_Breath_OnEnter(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--ODS(\"Skill_Mon_Breath_OnEnter ActionParam : \"..action:GetActionParam()..\"\\n\")\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Skill_Mon_Breath_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then	--   \n\
			action:SetSlot(1)\n\
		end\n\
\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		--ODS(\"Skill_Mon_Breath Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					end\n\
				end\n\
			end\n\
		end\n\
		\n\
		actor:ResetAnimation()\n\
		actor:PlayCurrentSlot()\n\
\n\
		--ODS(\"Skill_Mon_Breath_OnEnter \"..action:GetSlotAnimName(action:GetCurrentSlot())..\" \\n\", false, 1509)\n\
\n\
		local Effect = actor:GetAnimationInfoFromAction(\"CAST_EFFECT\",action,4294967294)--4294967294    .     \n\
		if nil~=Effect and \"\"~=Effect then\n\
			local EffectNode = actor:GetAnimationInfoFromAction(\"CAST_EFFECT_NODE\",action)\n\
			if nil==EffectNode or \"\"==EffectNode then\n\
				EffectNode = \"char_root\"\n\
			end\n\
			\n\
			actor:AttachParticle(582,EffectNode,Effec);\n\
		end\n\
		\n\
	end\n\
\n\
	action:SetParamInt(10,0)\n\
\n\
	return true\n\
end\n\
function Skill_Mon_Breath_OnCastingCompleted(actor,action)\n\
	--ODS(\"Skill_Mon_Breath_OnCastingCompleted\\n\")\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(2)\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	\n\
	Skill_Mon_Breath_Fire(actor,action);\n\
	\n\
end\n\
function  Skill_Mon_Breath_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    --ODS(\"Skill_Mon_Breath_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
end\n\
\n\
function Skill_Mon_Breath_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime())	--	Rotation Start Time\n\
	action:SetParamFloat(1,actor:GetLookingDir():GetX());\n\
	action:SetParamFloat(2,actor:GetLookingDir():GetY());\n\
	action:SetParamFloat(3,actor:GetLookingDir():GetZ());\n\
	\n\
	action:SetParamInt(4,0);\n\
	\n\
	local bUseTime	= actor:GetAnimationInfo(\"USE_ABIL_TIME\")\n\
	if nil~=bUseTime and \"TRUE\"~=bUseTime then\n\
		action:SetParamInt(14,1)\n\
	end\n\
\n\
	local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
	if fireStartNode ~= nil then\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect == nil then\n\
			fireEffect = \"e_m_Mahalka_skill_01_char_root\"\n\
		end					\n\
		--ODS(\"Skill_Mon_Breath_Fire OK. NODE : \" .. fireStartNode .. \" EFF : \" .. fireEffect ..  \"\\n\", false, 1509)\n\
		actor:AttachParticle(581,fireStartNode,fireEffect);\n\
	end\n\
	action:SetParamInt(10,1)\n\
\n\
	actor:DetachFrom(582)	--  \n\
end\n\
\n\
function Skill_Mon_Breath_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--ODS(\"Skill_Mon_Breath_OnUpdate accumTime:\"..accumTime..\"\\n\");\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(0);\n\
\n\
		if 0 ~= action:GetParamInt(10) and actor:IsAnimationDone() then\n\
			if action:GetCurrentSlot() == 2 then\n\
				local anilen = actor:GetAnimationLength(action:GetSlotAnimName(3))\n\
				if 0 < anilen then	-- 	\n\
					action:SetSlot(3)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					return true\n\
				end\n\
			end\n\
\n\
			return false\n\
		end\n\
		\n\
		if 0==action:GetParamInt(14) then\n\
			local	fTotalTime = action:GetAbil(AT_MAINTENANCE_TIME)/1000.0;\n\
			ODS(\"Skill_Mon_Breath_OnUpdate fTotalTime:\"..fTotalTime..\"\\n\",false,6482);\n\
			if fElapsedTime > fTotalTime then\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if action:GetCurrentSlot() == 0 then\n\
			if actor:IsAnimationDone() then\n\
				action:SetSlot(1)\n\
				actor:ResetAnimation();\n\
				actor:PlayCurrentSlot();				\n\
			end\n\
		end\n\
	end\n\
	\n\
	--ODS(\"Skill_Mon_Breath_OnUpdate OK\\n\")\n\
	return true\n\
end\n\
\n\
function Skill_Mon_Breath_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	actor:DetachFrom(231)\n\
	actor:DetachFrom(581)\n\
	actor:DetachFrom(582)	--  \n\
end\n\
\n\
function Skill_Mon_Breath_OnLeave(actor, action)\n\
	return	true\n\
end\n\
\n\
function Skill_Mon_Breath_OnEvent(actor,textKey)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
			\n\
			actor:AttachParticle(231, fireStartNode, fireEffect)\n\
		end			\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_RushAttack_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_RushAttack_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    local	kTargetList = action:GetTargetList();\n\
    local	iTargetCount = kTargetList:size();\n\
	local 	kDoDamage = actor:GetAnimationInfo(\"DO_DAMAGE\")\n\
	if nil ~= kDoDamage and \"TRUE\" == kDoDamage then\n\
		kDoDamage = true\n\
	else\n\
		kDoDamage = false\n\
	end\n\
	if 1==action:GetParamInt(4) or kDoDamage then\n\
		Act_Mon_RushAttack_DoDamage(actor,action)\n\
	end\n\
\n\
end\n\
\n\
function Act_Mon_RushAttack_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_RushAttack_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			--action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
		\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
		actor:DetachFrom(129)\n\
	elseif kState == \"WAIT\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_RushAttack_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			--action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(3,g_world:GetAccumTime())\n\
		iNewState = 3\n\
		actor:DetachFrom(129)\n\
	elseif kState == \"ATTACK\" then\n\
		action:SetSlot(3)\n\
		iNewState = 4\n\
		actor:DetachFrom(129)\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	action:SetParamInt(952,0)\n\
	\n\
	return	true\n\
\n\
end\n\
\n\
function Act_Mon_RushAttack_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	ODS(\"Act_Mon_RushAttack_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	--	rush target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Act_Mon_RushAttack_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\");\n\
			return	false;\n\
			\n\
		else\n\
			ptTargetPos = Point3(0,0,0);\n\
			ptTargetPos:SetX(kPacket:PopFloat());\n\
			ptTargetPos:SetY(kPacket:PopFloat());\n\
			ptTargetPos:SetZ(kPacket:PopFloat());\n\
		end\n\
		\n\
	end\n\
	\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
		\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_RushAttack_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_RushAttack_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_RushAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_RushAttack_OnEnter Start Casting CurPos :\"..actor:GetPos():GetX()..\n\
	    \",\"..actor:GetPos():GetY()..\n\
	    \",\"..actor:GetPos():GetZ()..\n\
	    \" TargetPos: \"..ptTargetPos:GetX()..\",\"..ptTargetPos:GetY()..\",\"..ptTargetPos:GetZ()..\"\\n\");\n\
\n\
		--SetBreak();\n\
		actor:LookAt(ptTargetPos,true,false,true);\n\
		actor:SetMovingDir(actor:GetLookingDir());\n\
		\n\
		local	kLookDir = actor:GetLookingDir();\n\
	    ODS(\"Act_Mon_RushAttack_OnEnter Looking Dir:\"..kLookDir:GetX()..\",\"..kLookDir:GetY()..\",\"..kLookDir:GetZ()..\"\\n\")\n\
	end\n\
	\n\
	action:SetParamInt(10,0)	-- \n\
	action:SetParamInt(4,0)		--TargetListModified fire   \n\
\n\
	action:SetParamInt(104,0)	--rush  ? Loop=0 / Clamp=1\n\
	local Loop = actor:GetAnimationInfoFromAniName(\"LOOP\",action:GetSlotAnimName(2))\n\
	if false==Loop:IsNil() and \"FALSE\"==Loop:GetStr() then\n\
		action:SetParamInt(104,1)\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_RushAttack_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_RushAttack_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_RushAttack_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_RushAttack_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--ODS(\"Act_Mon_RushAttack_Fire\\n\");\n\
	\n\
	--	  \n\
	local	ptTargetPos = action:GetParamAsPoint(0)\n\
	--actor:LookAt(ptTargetPos,true,false,true);\n\
\n\
	if action:IsSkillFireType(EFireType_Ani_Moving) then\n\
		local fAniTime = actor:GetAnimationLength(action:GetCurrentSlotAnimName())	--dash_after_attk_rush\n\
		action:SetParamFloat(5, fAniTime)\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(1,g_world:GetAccumTime())\n\
		action:SetParamAsPoint(10,actor:GetPos());	--	Start Pos\n\
\n\
		-- \n\
		local Dist = ptTargetPos:Distance( actor:GetPos() )\n\
		action:SetParamFloat(33, Dist)\n\
		\n\
		if actor:HaveAnimationTextKey(\"hit\",action:GetCurrentSlotAnimName()) then\n\
			action:SetParamInt(952,1)	--	State\n\
		end\n\
	end\n\
\n\
	--	  \n\
	local	kCurrentPos = actor:GetPos()\n\
	local	kDirVector = ptTargetPos:_Subtract(kCurrentPos)\n\
	kDirVector:Unitize()\n\
	\n\
	action:SetParamAsPoint(1,kDirVector)\n\
	\n\
	local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
	local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
	if nil==Effect or Effect==\"\" then\n\
		Effect = \"ef_Vagavond_skill_03_02_char_root\"\n\
	end\n\
	if nil==EffectNode or EffectNode==\"\" then\n\
		EffectNode = \"char_root\"\n\
	end\n\
	if nil==EffectScale or \"\"==EffectScale then\n\
		EffectScale = 1.0\n\
	else\n\
		EffectScale = tonumber(EffectScale)\n\
	end\n\
\n\
	if \"NONE\"~=Effect then\n\
		actor:AttachParticleS(129, EffectNode, Effect, EffectScale)\n\
	end\n\
\n\
	local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID)\n\
	end\n\
\n\
end\n\
\n\
function Act_Mon_RushAttack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	local	kLookDir = actor:GetLookingDir();\n\
    --ODS(\"Act_Mon_RushAttack_OnUpdate Looking Dir:\"..kLookDir:GetX()..\",\"..kLookDir:GetY()..\",\"..kLookDir:GetZ()..\"\\n\");\n\
	\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if iState == 3 then\n\
		\n\
			local	fTotalTime = 1.0\n\
			local	fElapsedTime = accumTime - action:GetParamFloat(3)\n\
			if fElapsedTime>fTotalTime then\n\
				return	false\n\
			end\n\
		elseif iState == 4 then\n\
			if actor:IsAnimationDone() then\n\
				return	false\n\
			end\n\
		else\n\
		\n\
			local	kMovingDir = action:GetParamAsPoint(1)\n\
			local	ptTargetPos = action:GetParamAsPoint(0)\n\
			local	kCurrentPos = actor:GetPos()\n\
\n\
			local	kCurrentDir = ptTargetPos:_Subtract(kCurrentPos)\n\
			kCurrentDir:Unitize()\n\
			local	fAniTime = action:GetParamFloat(5)\n\
			if fAniTime > 0 then\n\
				local	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
				local	fRate  = fElapsedTime / fAniTime\n\
				if fRate>1.0 then\n\
					fRate = 1.0\n\
				end\n\
\n\
				local	fMovingDist = (fRate)*action:GetParamFloat(33)\n\
				local	kStartPos = action:GetParamAsPoint(10)\n\
				kMovingDir:Multiply(fMovingDist)\n\
				local	kNewPos = kStartPos:_Add(kMovingDir)\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				kNewPos = g_world:ThrowRay(kNewPos,Point3(0,0,-1),500)\n\
				if kNewPos:GetX() ~= -1 and kNewPos:GetY() ~= -1 and kNewPos:GetZ() ~= -1 then\n\
					kNewPos:SetZ(kNewPos:GetZ()+25)\n\
					actor:SetTranslate(kNewPos);\n\
				end\n\
\n\
				if fRate == 1.0 then\n\
					if 0==action:GetParamInt(104) or (1==action:GetParamInt(104) and actor:IsAnimationDone()) then\n\
						Act_Mon_RushAttack_SetState(actor,action,\"ATTACK\")\n\
					end\n\
					return	true\n\
				end\n\
			else\n\
			\n\
	--			local	kMovingTarget = action:GetParamAsPoint(0)\n\
				local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/10000.0);\n\
				local	fDot = kCurrentDir:Dot(kMovingDir)\n\
				if fDot<0 then\n\
					if 0==action:GetParamInt(104) or (1==action:GetParamInt(104) and actor:IsAnimationDone()) then\n\
						Act_Mon_RushAttack_SetState(actor,action,\"ATTACK\")\n\
					end\n\
					return	true\n\
				end\n\
\n\
				kMovingDir:Multiply(fMoveSpeed)\n\
\n\
				actor:SetMovingDelta(kMovingDir)\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_RushAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		elseif iState == 1 then\n\
			if action:GetParamInt(10) == 0 then\n\
				local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
				local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil~=EffectNode and nil~=Effect then\n\
					local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
					if nil==EffectScale or \"\"==EffectScale then\n\
						EffectScale = 1\n\
					else\n\
						EffectScale = tonumber(EffectScale)\n\
					end\n\
					actor:AttachParticleS(129, EffectNode, Effect, EffectScale)\n\
				end\n\
				action:SetParamInt(10,1) \n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_RushAttack_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_RushAttack_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	actor:DetachFrom(129)\n\
	actor:DetachFrom(125)\n\
\n\
	local CurAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==CurAction)\n\
	CheckNil(CurAction:IsNil())\n\
\n\
--	local kPos = CurAction:GetParamAsPoint(0)\n\
--	if false==kPos:IsZero() then\n\
--		actor:SetTranslate(kPos)\n\
--	end\n\
end\n\
\n\
function Act_Mon_RushAttack_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kCurAction) ) then return true end\n\
	if( CheckNil(kCurAction:IsNil()) ) then return true end\n\
	\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_RushAttack_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_RushAttack_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
		local   action = actor:GetAction()\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
		\n\
		if 0==action:GetParamInt(4) and 4==action:GetParamInt(0) then	-- \n\
			action:SetParamInt(4,1)\n\
			Act_Mon_RushAttack_DoDamage(actor, action)\n\
		else\n\
			if 1==action:GetParamInt(952) then\n\
				ODS(\"if 1==action:GetParamInt(952) then\\n\",false,6482)\n\
				action:SetParamInt(4,1)\n\
			end\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_RushAttack_DoDamage(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
    local	kTargetList = action:GetTargetList();\n\
    local	iTargetCount = kTargetList:size();\n\
	if 0>=iTargetCount then\n\
		return\n\
	end\n\
\n\
	Act_Mon_Melee_DoDamage(actor,action)\n\
	local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
	if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
		local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
		if  nil == QuakeFactor then\n\
			QuakeFactor = 1.0\n\
		else\n\
			QuakeFactor = tonumber(QuakeFactor)\n\
		end\n\
		QuakeCamera(QuakeTime, QuakeFactor)\n\
	end\n\
\n\
	local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
	local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	if nil~=EffectNode and nil~=Effect then\n\
		actor:AttachParticle(125, EffectNode, Effect)\n\
	end\n\
	action:SetParamInt(4,0)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_DieSkill_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_DieSkill_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	local bRemoveStatusEffectFromActor = false\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_DieSkill_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(2, g_world:GetAccumTime())\n\
		local kDef = GetSkillDef(action:GetActionNo())\n\
		action:SetParamFloat(3,0)\n\
		if false==kDef:IsNil() then\n\
			local time = kDef:GetAbil(AT_CAST_TIME)*0.001\n\
			ODS(\" : \" .. action:GetActionNo() .. \"  : \" .. time .. \"\\n\", false, 1509)\n\
			action:SetParamFloat(3, time)\n\
			action:SetParamFloat(10, time)	--\n\
		end\n\
		action:SetParamFloat(5,0.6)	--    \n\
		action:SetParamFloat(6,0)	--   \n\
		action:SetParamFloat(11,action:GetParamFloat(5))	--    \n\
		\n\
	elseif kState == \"FIRE\" then\n\
		action:SetParamInt(4,0)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(2)) == 0 then	--   \n\
			action:SetParamInt(4,1)\n\
		end\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
		bRemoveStatusEffectFromActor = true\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	if(bRemoveStatusEffectFromActor) then\n\
		-- (  curAction    !!!)\n\
		local EffMan = GetStatusEffectMan()\n\
		local guid = actor:GetPilotGuid()\n\
		EffMan:RemoveStatusEffectFromActor(guid, 200000010)	--\n\
	end\n\
	return	true\n\
\n\
end\n\
\n\
function Act_Mon_DieSkill_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_DieSkill_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_DieSkill_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_DieSkill_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_DieSkill_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_DieSkill_OnEnter Start Casting\\n\");\n\
		\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_DieSkill_OnCastingCompleted(actor,action)\n\
\n\
	Act_Mon_DieSkill_SetState(actor,action,\"FIRE\")\n\
\n\
end\n\
\n\
function Act_Mon_DieSkill_Hide(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	actor:HideNode(\"Scene Root\",true);	--	 \n\
	actor:ReleaseAllParticles();\n\
	actor:SetHideShadow(true)\n\
\n\
	local	die_particle_id = actor:GetDieParticleID();\n\
	if nil~=die_particle_id and \"\"~=die_particle_id then\n\
		local heartPos = actor:GetNodeTranslate(\"p_ef_heart\")\n\
		local DieParticleNode = actor:GetDieParticleNode()\n\
		if nil~=DieParticleNode and 0<string.len(DieParticleNode) then\n\
			heartPos = actor:GetNodeTranslate(DieParticleNode)\n\
		end\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AttachParticleSWithRotate(die_particle_id, heartPos, actor:GetDieParticleScale(), Point3(0,0,0))\n\
	end			\n\
	\n\
end\n\
\n\
function Act_Mon_DieSkill_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if 0~=action:GetParamInt(4) then--    \n\
			Act_Mon_DieSkill_DoDamage(actor, action)\n\
			Act_Mon_DieSkill_Hide(actor, action)\n\
			return false\n\
		elseif actor:IsAnimationDone() == true then\n\
			Act_Mon_DieSkill_Hide(actor, action)\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_DieSkill_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
		local EffMan = GetStatusEffectMan()\n\
		local guid = actor:GetPilotGuid()\n\
		local fAlarmDelta = accumTime - action:GetParamFloat(6)\n\
		local fInter = action:GetParamFloat(5)\n\
		--ODS(\"fAlarmDelta : \" .. fAlarmDelta .. \" fInter : \" .. fInter .. \"\\n\", false, 1509)\n\
		if fAlarmDelta > fInter or action:GetParamFloat(6)==0 then	-- \n\
			action:SetParamFloat(6, accumTime)			-- \n\
\n\
			local iInstanceID = action:GetParamInt(7);\n\
			EffMan:RemoveStatusEffectFromActor2(guid, iInstanceID) --   (   ,    )\n\
			\n\
			local kDieBlink = actor:GetAnimationInfo(\"DIEBLINK\")\n\
			if nil==kDieBlink or \"\"==kDieBlink then\n\
				kDieBlink = \"se_damage_blink_red\"\n\
			end\n\
\n\
			iInstanceId = EffMan:AddStatusEffectToActor(guid, kDieBlink, 0, 0)	-- \n\
			action:SetParamInt(7,iInstanceID)\n\
\n\
			--  \n\
			local fDelta = (accumTime - action:GetParamFloat(2))\n\
			local fRate = 1 - (fDelta*1000)/(action:GetParamFloat(10)*1000)	--  \n\
			--ODS(\"Param10 : \" .. action:GetParamFloat(10) .. \" Param2 : \" .. action:GetParamFloat(2) .. \" fDelta : \" .. fDelta .. \" fRate : \" .. fRate .. \"\\n\", false, 1509)\n\
			action:SetParamFloat(5, action:GetParamFloat(11)*fRate)\n\
		else\n\
			local	iInstanceID = action:GetParamInt(7);\n\
			EffMan:RemoveStatusEffectFromActor2(guid, iInstanceID)	--\n\
		end\n\
\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_DieSkill_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_DieSkill_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_DieSkill_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_DieSkill_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Act_Mon_DieSkill_DoDamage(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local	kTargetList = action:GetTargetList();\n\
    local	iTargetCount = kTargetList:size();\n\
	\n\
    local iCount = 0\n\
    while iCount<iTargetCount do\n\
	    local	kTargetInfo = kTargetList:GetTargetInfo(iCount);\n\
	    if kTargetInfo:IsNil() == false then\n\
		\n\
		    local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
		    if kTargetPilot:IsNil() == false then\n\
			\n\
			    local	kTargetActor = kTargetPilot:GetActor();\n\
			    if kTargetActor:IsNil() == false then\n\
			    \n\
                    local targetEffectNode = actor:GetAnimationInfo(\"TARGET_EFFECT_NODE\")\n\
                    local targetEffect = actor:GetAnimationInfo(\"TARGET_EFFECT\")\n\
                	\n\
                    if targetEffectNode ~= nil and targetEffect ~= nil then\n\
                    \n\
						ODS(\"TARGET_EFFECT:\"..targetEffect..\" TARGET_EFFECT_NODE : \"..targetEffectNode..\"\\n\", false, 1509);\n\
\n\
						kTargetActor:AttachParticle(124, targetEffectNode, targetEffect)\n\
                    \n\
                    end\n\
				\n\
			    end\n\
		    end\n\
	    end\n\
	    \n\
	    iCount=iCount+1;\n\
    end\n\
\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects();\n\
	end\n\
	action:ClearTargetList();	    \n\
end\n\
\n\
function Act_Mon_DieSkill_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
       ODS(\"Act_Mon_DieSkill_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
       \n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
        local   action = actor:GetAction();\n\
		Act_Mon_DieSkill_DoDamage(actor,action);\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
\n\
		if nil~=EffectNode and nil~=Effect then\n\
			actor:AttachParticleS(125, EffectNode, Effect, EffectScale)\n\
		end\n\
\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_DieSkill_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Only_Ani_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_Only_Ani_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_Mon_Only_Ani_SetState kState : \" .. kState ..\"\\n\", false, 998)\n\
\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(0) : \" ..action:GetSlotAnimName(0) ..\"\\n\", false, 998)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			--ODS(\"  \\n\", false, 998)\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(1) : \" ..action:GetSlotAnimName(1) ..\"\\n\", false, 998)\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			action:SetSlot(4) --	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(2) : \" ..action:GetSlotAnimName(2) ..\"\\n\", false, 998)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(2)) == 0 then\n\
			return false\n\
		end\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(3) : \" ..action:GetSlotAnimName(3) ..\"\\n\", false, 998)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(3)) == 0 then\n\
			return false\n\
		end\n\
		action:SetSlot(3)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Only_Ani_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_Mon_Only_Ani_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\", false, 998)\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Only_Ani_OnCastingCompleted(actor,action)\n\
	else\n\
		if false == Act_Mon_Only_Ani_SetState(actor, action, \"BATTLEIDLE_START\") then	-- \n\
			Act_Mon_Only_Ani_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_Only_Ani_OnCastingCompleted(actor,action)\n\
	Act_Mon_Only_Ani_Fire(actor,action)\n\
end\n\
\n\
function Act_Mon_Only_Ani_Fire(actor,action)\n\
	Act_Mon_Only_Ani_SetState(actor,action,\"FIRE\")\n\
end\n\
\n\
function Act_Mon_Only_Ani_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	local	bDone = actor:IsAnimationDone()\n\
	local	aParam = action:GetActionParam()\n\
\n\
	--ODS( GetAccumTime() .. \"  Act_Mon_Only_Ani_OnUpdate\\n\", false, 998)\n\
	\n\
	if aParam == AP_FIRE then\n\
		if bDone then\n\
			if iState == 2 then\n\
				local bRet = Act_Mon_Only_Ani_SetState(actor,action,\"RETURN\")	--fire   \n\
				if bRet==false then\n\
					--ODS(\"bRet==false\\n\",false,998)\n\
				end\n\
				return bRet\n\
			else\n\
				--ODS(\"  \\n\",false,998)\n\
				return false	--  \n\
			end\n\
		end\n\
	elseif aParam == AP_CASTING then\n\
		if iState == 0 then\n\
			if bDone then\n\
				Act_Mon_Only_Ani_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_Mon_Only_Ani_OnCleanUp(actor, action)\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_Mon_Only_Ani_OnCleanUp\\n\", false, 998)\n\
end\n\
\n\
function Act_Mon_Only_Ani_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
--	local	kCurAction = actor:GetAction()\n\
	local	actionID = action:GetID()\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_Mon_Only_Ani_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\")\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false\n\
end\n\
\n\
function Act_Mon_Only_Ani_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
       --ODS(GetAccumTime() .. \"   \" .. \"Act_Mon_Only_Ani_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\")\n\
       \n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
--        local   action = actor:GetAction();\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
\n\
		if nil~=EffectNode and nil~=Effect then\n\
			actor:AttachParticleS(125, EffectNode, Effect, EffectScale)\n\
		end\n\
\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_Only_Ani_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill \n\
 \n\
function Act_Mon_Melee_Finish_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C) \n\
end \n\
 \n\
function Act_Mon_Melee_Finish_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	ODS(\"Act_Mon_Melee_Finish_SetState \" .. kState .. \"\\n\", false, 1509)\n\
	local	iNewState = -1; \n\
	if kState == \"BATTLEIDLE_START\" then \n\
	 \n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then \n\
			return	false	 \n\
		end \n\
				 \n\
		action:SetSlot(0) \n\
		iNewState = 0; \n\
	 \n\
	elseif kState == \"BATTLEIDLE_LOOP\" then \n\
		 \n\
		action:SetSlot(1) \n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then \n\
		 \n\
			ODS(\"Act_Mon_Melee_Finish_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\"); \n\
		 \n\
			action:SetSlot(6);	--	 Idle     Idle  . \n\
		end \n\
		iNewState = 1; \n\
		 \n\
	elseif kState == \"FIRE\" then \n\
	 \n\
		action:SetSlot(2) \n\
		iNewState = 2; \n\
	elseif kState == \"RETURN2\" then \n\
--		ODS(\"RETURN2 AniName : \" ..action:GetSlotAnimName(3)..\"\\n\", false, 1509)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(3)) ~= 0 then\n\
			action:SetSlot(3)\n\
			iNewState = 3\n\
		else\n\
			return false\n\
		end\n\
	elseif kState == \"RETURN3\" then \n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) ~= 0 then\n\
			action:SetSlot(4)\n\
			iNewState = 4\n\
		else\n\
			return false\n\
		end\n\
	elseif kState == \"RETURN4\" then \n\
--		ODS(\"Act_Mon_Melee_Finish_SetState SlotName[\"..action:GetSlotAnimName(5)..\"]\\n\", false, 1509)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(5)) ~= 0 then\n\
			action:SetSlot(5)\n\
			iNewState = 5\n\
		else\n\
			return false\n\
		end\n\
	elseif kState == \"RETURN5\" then\n\
--		ODS(\"Act_Mon_Melee_Finish_SetState SlotName[\"..action:GetSlotAnimName(5)..\"]\\n\", false, 1509)\n\
	end\n\
	 \n\
	actor:ResetAnimation(); \n\
	actor:PlayCurrentSlot(); \n\
	action:SetParamInt(0,iNewState) \n\
	\n\
	return	true\n\
end \n\
 \n\
function Act_Mon_Melee_Finish_OnEnter(actor, action)\n\
 \n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	ODS(\"Act_Mon_Melee_Finish_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\"); \n\
	 \n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if nil~=prevAction and prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop() \n\
		end \n\
	end\n\
	 \n\
	actor:ResetAnimation() \n\
	 \n\
	if action:GetActionParam() == AP_FIRE then \n\
		Act_Mon_Melee_Finish_OnCastingCompleted(actor,action) \n\
	else \n\
	 \n\
		if( Act_Mon_Melee_Finish_SetState(actor,action,\"BATTLEIDLE_START\") == false) then \n\
			Act_Mon_Melee_Finish_SetState(actor,action,\"BATTLEIDLE_LOOP\") \n\
		end	 \n\
		 \n\
	    ODS(\"Act_Mon_Melee_Finish_OnEnter Start Casting\\n\"); \n\
		 \n\
		--     . \n\
		local	kTargetList = action:GetTargetList(); \n\
		local	iTargetCount = kTargetList:size(); \n\
	 \n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\"); \n\
 \n\
		 \n\
		if iTargetCount>0 then \n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0); \n\
			if kTargetInfo:IsNil() == false then \n\
			 \n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID()); \n\
				if kTargetPilot:IsNil() == false then \n\
				 \n\
					local	kTargetActor = kTargetPilot:GetActor(); \n\
					if kTargetActor:IsNil() == false then \n\
					 \n\
						--actor:LookAtBidirection(kTargetActor:GetPos()); \n\
						actor:LookAt(kTargetActor:GetPos(),true,true); \n\
					 \n\
					end \n\
				end \n\
			end \n\
		end \n\
	end \n\
	 \n\
 \n\
	return true \n\
end \n\
function Act_Mon_Melee_Finish_OnCastingCompleted(actor,action)	 \n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	Act_Mon_Melee_Finish_SetState(actor,action,\"FIRE\") \n\
	 \n\
	Act_Mon_Melee_Finish_Fire(actor,action)\n\
end \n\
 \n\
function Act_Mon_Melee_Finish_Fire(actor,action) \n\
 \n\
 	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor) \n\
 \n\
	--     . \n\
	local	kTargetList = action:GetTargetList(); \n\
	local	iTargetCount = kTargetList:size(); \n\
	 \n\
	ODS(\"Act_Mon_Melee_Finish_Fire iTargetCount:\"..iTargetCount..\"\\n\"); \n\
	 \n\
	 \n\
	if iTargetCount>0 then \n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0); \n\
		if kTargetInfo:IsNil() == false then \n\
		 \n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID()); \n\
			if kTargetPilot:IsNil() == false then \n\
			 \n\
				local	kTargetActor = kTargetPilot:GetActor(); \n\
				if kTargetActor:IsNil() == false then \n\
				 \n\
					ODS(\"Act_Mon_Melee_Finish_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\"); \n\
					--actor:LookAtBidirection(kTargetActor:GetPos()); \n\
					actor:LookAt(kTargetActor:GetPos(),true,true); \n\
				end \n\
			end \n\
		end \n\
	end \n\
	Skill_ChainLightning_Fire(actor,action)\n\
	actor:SetParam(\"lightning\", \"false\")\n\
end \n\
 \n\
function Act_Mon_Melee_Finish_OnUpdate(actor, accumTime, frameTime) \n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction() \n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0) \n\
--	ODS(\"Act_Mon_Melee_Finish_OnUpdate iState : \" .. iState ..\" AParma : \" .. action:GetActionParam() .. \"\\n\", false, 1509)\n\
\n\
	if action:GetActionParam() == AP_FIRE then \n\
	 \n\
		if actor:IsAnimationDone() == true then\n\
			if iState>=2 then	--fire\n\
				if iState>=5 then return false end\n\
				local bRet = Act_Mon_Melee_Finish_SetState(actor,action,\"RETURN\"..iState)\n\
				if bRet==false then\n\
--					ODS(\"Act_Mon_Melee_Finish_SetState false. iState : \" .. iState .. \"\\n\", false, 1509)\n\
				else\n\
					local 	bEnd = actor:GetAnimationInfo(\"IS_LIGHTING_END\")\n\
					if nil~=bEnd and \"TRUE\"==bEnd then\n\
						Act_Mon_Melee_Finish_ReleasePlane(actor)\n\
					end\n\
				end\n\
				return bRet\n\
			end\n\
		end\n\
		if iState<=2 and \"true\"==actor:GetParam(\"lightning\") then\n\
			local   fLastUpdateTime = action:GetParamFloat(3);\n\
			\n\
			if IsShowTargetLightning(actor, action) then\n\
				if accumTime - fLastUpdateTime > 0.5 then\n\
					local path = actor:GetAnimationInfo(\"LIGHTNING_PATH\")\n\
					Skill_ChainLightning_CreateLinkedPlane(actor,action,path)\n\
					action:SetParamFloat(3,accumTime);\n\
				end\n\
				local node = actor:GetAnimationInfo(\"LIGHTNING_START_NODE\")\n\
				Skill_ChainLightning_UpdatePlanePos(actor, action, node)\n\
			end\n\
		end\n\
		 \n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		 \n\
		if iState == 0 then \n\
			if actor:IsAnimationDone() then \n\
				Act_Mon_Melee_Finish_SetState(actor,action,\"BATTLEIDLE_LOOP\") \n\
			end \n\
		end \n\
	 \n\
		if IsSingleMode() then \n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then \n\
			 \n\
				action:SetActionParam(AP_FIRE) \n\
				Act_Mon_Melee_Finish_OnCastingCompleted(actor,action) \n\
			 \n\
			end \n\
		end \n\
	 \n\
	end \n\
	return true \n\
end\n\
\n\
function Act_Mon_Melee_Finish_ReleasePlane(actor)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local   iGroupNum = actor:GetAction():GetParamInt(2);\n\
	if iGroupNum ~= -1 then\n\
		local   kMan = GetLinkedPlaneGroupMan();\n\
		kMan:ReleaseLinkedPlaneGroup(iGroupNum);\n\
		actor:GetAction():SetParamInt(2,-1);\n\
		actor:GetAction():ClearTargetList();\n\
	end\n\
end\n\
\n\
function Act_Mon_Melee_Finish_OnCleanUp(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	Act_Mon_Melee_Finish_ReleasePlane(actor)\n\
end \n\
 \n\
function Act_Mon_Melee_Finish_OnLeave(actor, action) \n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end	\n\
 \n\
	local	kCurAction = actor:GetAction(); \n\
	\n\
	if( CheckNil(nil==kCurAction) ) then return true end\n\
	if( CheckNil(kCurAction:IsNil()) ) then return true end\n\
	\n\
	local	actionID = action:GetID() \n\
	ODS(\"Act_Mon_Melee_Finish_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\"); \n\
	if action:GetActionType()==\"EFFECT\" or \n\
		actionID == \"a_freeze\" or \n\
		actionID == \"a_reverse_gravity\" or \n\
		actionID == \"a_blow_up\" or \n\
		actionID == \"a_blow_up_small\" or \n\
		actionID == \"a_knock_back\" or \n\
		actionID == \"a_die\" or \n\
		actionID == \"a_idle\" or \n\
		actionID == \"a_run_right\" or \n\
		actionID == \"a_run_left\" or \n\
		actionID == \"a_handclaps\" then \n\
		return true \n\
	end \n\
	return false  \n\
end \n\
function Act_Mon_Melee_Finish_DoDamage(actor,action) \n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local	kTargetList = action:GetTargetList(); \n\
    local	iTargetCount = kTargetList:size()\n\
	--ODS(\"Act_Mon_Melee_Finish_DoDamage iTargetCount : \" .. iTargetCount .. \"\\n\", false, 1509) \n\
	 \n\
    local iCount = 0 \n\
    while iCount<iTargetCount do \n\
	    local	kTargetInfo = kTargetList:GetTargetInfo(iCount); \n\
	    if kTargetInfo:IsNil() == false then \n\
		 \n\
		    local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID()); \n\
		    if kTargetPilot:IsNil() == false then \n\
			 \n\
			    local	kTargetActor = kTargetPilot:GetActor(); \n\
			    if kTargetActor:IsNil() == false then \n\
			     \n\
                    local targetEffectNode = actor:GetAnimationInfo(\"TARGET_EFFECT_NODE\")\n\
                    local targetEffect = actor:GetAnimationInfo(\"TARGET_EFFECT\")\n\
                	\n\
                    if targetEffectNode ~= nil and targetEffect ~= nil then\n\
                    \n\
--						ODS(\"TARGET_EFFECT:\"..targetEffect..\" TARGET_EFFECT_NODE : \"..targetEffectNode..\"\\n\", false, 1509);\n\
\n\
						kTargetActor:AttachParticle(124, targetEffectNode, targetEffect) \n\
                     \n\
                    end \n\
				 \n\
			    end \n\
		    end \n\
	    end \n\
	     \n\
	    iCount=iCount+1; \n\
    end \n\
\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects();\n\
	end\n\
	if \"true\"~=actor:GetParam(\"lightning\") then\n\
		action:ClearTargetList();	     \n\
	end\n\
end \n\
 \n\
function Act_Mon_Melee_Finish_OnEvent(actor,textKey) \n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local FireEffect_TextKey = actor:GetAnimationInfo(\"FIRE_TEXTKEY\")\n\
	if nil~=FireEffect_TextKey and FireEffect_TextKey~=\"\" then\n\
		if textKey == FireEffect_TextKey then\n\
			local Fire_TextKey_Effect = actor:GetAnimationInfo(\"FIRE_TEXTKEY_EFFECT\")\n\
			local Fire_TextKey_Node = actor:GetAnimationInfo(\"FIRE_TEXTKEY_NODE\")\n\
			local Fire_TextKey_Scale = actor:GetAnimationInfo(\"FIRE_TEXTKEY_SCALE\")\n\
			actor:AttachParticleWithRotate(3851,Fire_TextKey_Node, Fire_TextKey_Effect, Fire_TextKey_Scale)\n\
		end\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then \n\
--       ODS(\"Act_Mon_Melee_Finish_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\", false, 1509)\n\
        local   action = actor:GetAction();\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
		local path = actor:GetAnimationInfo(\"LIGHTNING_PATH\")\n\
		if nil~=path and \"\"~=path then\n\
			if IsShowTargetLightning(actor, action) then\n\
				Skill_ChainLightning_CreateLinkedPlane(actor,action, path)\n\
			end\n\
			actor:SetParam(\"lightning\", \"true\")\n\
		end\n\
\n\
		local kDoDamage = actor:GetAnimationInfo(\"DO_DAMAGE\")\n\
		if nil ~= kDoDamage and \"TRUE\" == kDoDamage then\n\
			Act_Mon_Melee_Finish_DoDamage(actor,action); \n\
		end\n\
		\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		local EffectFront = actor:GetAnimationInfo(\"FIRE_EFFECT_FRONT\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
\n\
		if nil~=EffectNode and nil~=Effect then\n\
			actor:AttachParticleS(125, EffectNode, Effect, EffectScale)\n\
		elseif nil~=EffectFront and nil~=Effect then\n\
			EffectFront = tonumber(EffectFront)\n\
			local kLook = actor:GetLookingDir()\n\
			kLook:Unitize()\n\
			kLook:Multiply(EffectFront)\n\
			local kPos = actor:GetTranslate()\n\
			kPos:Add(kLook)\n\
			actor:AttachParticleToPointS(125, kPos, Effect, EffectScale)\n\
		end\n\
\n\
	end\n\
	 \n\
	return true; \n\
end\n\
\n\
function Act_Mon_Melee_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
    local	kTargetList = action:GetTargetList()\n\
    local	iTargetCount = kTargetList:size()\n\
	Act_Mon_Melee_Finish_DoDamage(actor,action)\n\
--	ODS(\"Act_Mon_Melee_Finish_OnTargetListModified iTargetCount : \" .. iTargetCount .. \"\\n\", false, 1509) \n\
end\n\
\n\
function IsShowTargetLightning(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	bShow = actor:GetAnimationInfo(\"IS_SHOW_TARGET_LIGHTNING\")\n\
	if nil==bShow or \"\"==bShow or \"TRUE\"==bShow then\n\
		bShow = true\n\
	else\n\
		bShow = action:GetTargetList():size() > 0\n\
	end\n\
	return bShow\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_RangeAttack_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_Shot_Around_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_Around_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_Shot_Around_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_Around_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_Around_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Around_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	--ODS(\"Name: \"..actor:GetID()..\", ProjectileIndex: \"..iProjectileIndex..\", AniName: \"..action:GetCurrentSlotAnimName()..\", ProjectileID: \"..kProjectileID..\", kTargetNodeID: \"..kTargetNodeID..\"\\n\",false,6482)\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed == nil then\n\
		fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	end\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	\n\
	local	kTargetEffect = actor:GetAnimationInfo(\"HIT_TARGET_EFFECT_ID\")\n\
	if nil~=kTargetEffect and \"\"~=kTargetEffect then\n\
		kNewArrow:SetParamValue(\"HIT_TARGET_EFFECT_ID\",kTargetEffect)\n\
	end\n\
	local	kTargetEffectNode = actor:GetAnimationInfo(\"HIT_TARGET_EFFECT_TARGET_NODE\")\n\
	if nil~=kTargetEffectNode and \"\"~=kTargetEffectNode then\n\
		kNewArrow:SetParamValue(\"HIT_TARGET_EFFECT_TARGET_NODE\",kTargetEffectNode)\n\
	end\n\
	\n\
	return kNewArrow\n\
\n\
end\n\
\n\
function Act_Mon_Shot_Around_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_Around_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(40,0)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kPacketType = kPacket:PopByte()\n\
		local kNum = kPacket:PopInt()\n\
		if kNum ~= 0 then\n\
			local kIndex=0\n\
			for i=0,kNum do\n\
				local kGuid = kPacket:PopGuid()\n\
				if nil ~= kGuid and false == kGuid:IsNil() then\n\
					action:SetParam(10+kIndex,kGuid:GetString())\n\
					kIndex = kIndex + 1\n\
				end\n\
			end\n\
			action:SetParamInt(40,kIndex)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_Around_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Shot_Around_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Shot_Around_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Shot_Around_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_Shot_Around Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	local	iState = action:GetParamInt(0)\n\
			local kParam1 = action:GetParam(1)	\n\
			\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if bIsBoomerang or action:GetParamInt(3) == 1 then\n\
\n\
			if kParam1 == \"end\" then\n\
				return	false\n\
			elseif kParam1 == \"wait_animdone\" then\n\
				if animDone == true then\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			elseif kParam1 == \"none\" then\n\
				if animDone and actor:GetAnimationLength(action:GetSlotAnimName(5)) ~= 0 then	--\n\
					action:SetSlot(5)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					action:SetParam(1, \"\")\n\
				end\n\
			end	\n\
			return	true\n\
		end\n\
		\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
			\n\
		elseif iState == 1 and 0 == action:GetParamInt(21) then\n\
			\n\
			action:SetParamInt(21,1)\n\
			local load = actor:GetAnimationInfo(\"PROJECTILE_LOAD\")\n\
			if nil~=load then\n\
				local	iProjectileIndex = 0	\n\
				while iProjectileIndex<8 do	\n\
					local	kArrow = Act_Mon_RangeAttack_LoadToWeapon(actor,action,iProjectileIndex)\n\
					if nil ~= kArrow and false == kArrow:IsNil() then\n\
						action:SetParamInt(10+iProjectileIndex, kArrow:GetUID())\n\
					end\n\
	\n\
					iProjectileIndex = iProjectileIndex + 1\n\
				end\n\
				action:SetParamInt(20, action:GetActionInstanceID())\n\
			end\n\
\n\
			local eff = actor:GetAnimationInfo(\"FIRE_EFFECT\") --   \n\
			if nil~=eff then\n\
				local node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil==node then\n\
					node = \"char_root\"\n\
				end\n\
				actor:AttachParticle(230, node, eff)\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Shot_Around_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Shot_Around_OnLeave\\n\")\n\
	return true\n\
end\n\
function Act_Mon_Shot_Around_SwordReturn(actor,iActionInstanceID)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0)\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
			action:SetParam(1,\"end\")										-- \n\
		else\n\
			Act_Mon_Shot_Around_SetState(actor,action,\"RETURN\")				--\n\
			action:SetParam(1,\"wait_animdone\")								--  \n\
		end\n\
	\n\
	end\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Around_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Act_Mon_Shot_Around_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
			\n\
	ODS(\"Act_Mon_Shot_Around_OnEvent textKey:\"..textKey..\"\\n\")\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
\n\
	Act_Mon_Cast_Effect(actor,textKey)\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
		\n\
		local fire_delay = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
		if nil == fire_delay or \"\" == fire_delay then\n\
			fire_delay = 0 --   \n\
		else\n\
			fire_delay = tonumber(fire_delay)\n\
		end\n\
		\n\
		local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
			Projectile_cnt = 8\n\
		else\n\
			Projectile_cnt = tonumber(Projectile_cnt)\n\
		end\n\
		\n\
		local fire_random = actor:GetAnimationInfo(\"FIRE_RANDOM\")\n\
		if nil == fire_random or \"\" == fire_random then\n\
			fire_random = 3\n\
		else\n\
			fire_random = tonumber(fire_random)\n\
		end\n\
		\n\
		\n\
		local	kProjectileMan = GetProjectileMan()\n\
\n\
		local	i = 0;\n\
		local fRotateAngle = math.pi / (Projectile_cnt/2)\n\
		local	kRotateAxis = Point3(0,0,1);\n\
		\n\
		\n\
		local UID = kAction:GetParamInt(10+i)\n\
\n\
		local	kArrow = nil\n\
		--kArrow = Act_Mon_Shot_Around_LoadToWeapon(actor,kAction, i)		\n\
		local LocZ = actor:GetAnimationInfo(\"TARGET_LOC_Z\")\n\
		if nil~=LocZ and \"\"~=LocZ then\n\
			LocZ = tonumber(LocZ)\n\
		end\n\
		while i<Projectile_cnt do\n\
			--kArrow = Act_Mon_Shot_Around_Projectile_Default_LoadToWeapon(actor, kAction)\n\
			local iProjectaleIndex = Random()%fire_random\n\
			--ODS(\"ProjectaleIndex: \"..iProjectaleIndex..\"\\n\",false,6482)\n\
			kArrow = Act_Mon_Shot_Around_LoadToWeapon(actor, kAction, iProjectaleIndex)\n\
			if nil~=kArrow and false==kArrow:IsNil() then\n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
				local	kFireTarget = actor:GetLookingDir()\n\
				if nil~=LocZ then\n\
					arrow_worldpos:SetZ(arrow_worldpos:GetZ()+LocZ)\n\
					kFireTarget = arrow_worldpos\n\
				else\n\
					kFireTarget:Multiply(iAttackRange);\n\
					kFireTarget:Rotate(kRotateAxis,fRotateAngle*i);\n\
					kFireTarget:Add(arrow_worldpos);			\n\
				end\n\
				kArrow:SetTargetLoc(kFireTarget);	\n\
\n\
				local kNum = kAction:GetParamInt(40)\n\
				if 0~= kNum then\n\
					local kRan = math.random(1,100)%kNum\n\
					local kGuidStr = kAction:GetParam(10+kRan)\n\
					local kGuid = GUID()\n\
					kGuid:Set(kGuidStr)\n\
					local target = g_pilotMan:FindPilot(kGuid)\n\
					if nil~=target and false == target:IsNil() then\n\
						kArrow:SetTargetGuidFromServer(kGuid)\n\
					end\n\
				end\n\
				\n\
				if fire_delay then\n\
					kArrow:DelayFire(i*fire_delay)\n\
				else\n\
					kArrow:Fire();--	!\n\
				end\n\
				--ODS(\"Act_Mon_Shot_Around_OnEvent \"..i.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			end\n\
\n\
			i=i+1;\n\
		end		\n\
\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_RangeAttack_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_Shot_Around2_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_Around2_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_Shot_Around2_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_Around2_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_Around2_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Around2_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	end\n\
	\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	end\n\
	\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	if iProjectileIndex>0 and kProjectileID==nil then\n\
		return	nil\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	end\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed == nil then\n\
		fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	end\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	return kNewArrow\n\
\n\
end\n\
\n\
function Act_Mon_Shot_Around2_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_Around2_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(40,0)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kPacketType = kPacket:PopByte()\n\
		local kNum = kPacket:PopInt()\n\
		local kGuid = kPacket:PopGuid()\n\
		action:SetParam(10,kGuid:GetString())\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_Around2_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Shot_Around2_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Shot_Around2_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Shot_Around2_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_Shot_Around2 Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around2_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	local	iState = action:GetParamInt(0)\n\
			local kParam1 = action:GetParam(1)	\n\
			\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if bIsBoomerang or action:GetParamInt(3) == 1 then\n\
\n\
			if kParam1 == \"end\" then\n\
				return	false\n\
			elseif kParam1 == \"wait_animdone\" then\n\
				if animDone == true then\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			elseif kParam1 == \"none\" then\n\
				if animDone and actor:GetAnimationLength(action:GetSlotAnimName(5)) ~= 0 then	--\n\
					action:SetSlot(5)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					action:SetParam(1, \"\")\n\
				end\n\
			end	\n\
			return	true\n\
		end\n\
		\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
			\n\
		elseif iState == 1 and 0 == action:GetParamInt(21) then\n\
			\n\
			action:SetParamInt(21,1)\n\
			local load = actor:GetAnimationInfo(\"PROJECTILE_LOAD\")\n\
			if nil~=load then\n\
				local	iProjectileIndex = 0	\n\
				while iProjectileIndex<8 do	\n\
					local	kArrow = Act_Mon_RangeAttack_LoadToWeapon(actor,action,iProjectileIndex)\n\
					if nil ~= kArrow and false == kArrow:IsNil() then\n\
						action:SetParamInt(10+iProjectileIndex, kArrow:GetUID())\n\
					end\n\
	\n\
					iProjectileIndex = iProjectileIndex + 1\n\
				end\n\
				action:SetParamInt(20, action:GetActionInstanceID())\n\
			end\n\
\n\
			local eff = actor:GetAnimationInfo(\"FIRE_EFFECT\") --   \n\
			if nil~=eff then\n\
				local node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil==node then\n\
					node = \"char_root\"\n\
				end\n\
				actor:AttachParticle(230, node, eff)\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Shot_Around2_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around2_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around2_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Shot_Around2_OnLeave\\n\")\n\
	return true\n\
end\n\
function Act_Mon_Shot_Around2_SwordReturn(actor,iActionInstanceID)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0)\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
			action:SetParam(1,\"end\")										-- \n\
		else\n\
			Act_Mon_Shot_Around2_SetState(actor,action,\"RETURN\")				--\n\
			action:SetParam(1,\"wait_animdone\")								--  \n\
		end\n\
	\n\
	end\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Around2_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Act_Mon_Shot_Around2_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
			\n\
	ODS(\"Act_Mon_Shot_Around2_OnEvent textKey:\"..textKey..\"\\n\")\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
\n\
	Act_Mon_Cast_Effect(actor,textKey)\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan()\n\
\n\
		local	i = 0;\n\
		local fRotateAngle = math.pi/4.0\n\
		local	kRotateAxis = Point3(0,1,0);\n\
		\n\
		\n\
		local UID = kAction:GetParamInt(10+i)\n\
\n\
		local	kArrow = nil\n\
		--kArrow = Act_Mon_Shot_Around2_LoadToWeapon(actor,kAction, i)		\n\
		while i<8 do\n\
			--kArrow = Act_Mon_Shot_Around2_Projectile_Default_LoadToWeapon(actor, kAction)\n\
			local iProjectaleIndex = Random()%3\n\
			kArrow = Act_Mon_Shot_Around2_LoadToWeapon(actor, kAction, iProjectaleIndex)\n\
			if nil~=kArrow and false==kArrow:IsNil() then\n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
				local	kFireTarget = actor:GetLookingDir()\n\
				if kFireTarget:GetX() == 0 and kFireTarget:GetX() == 0 and kFireTarget:GetX() == 0 then\n\
					kFireTarget:SetX(1)\n\
				end\n\
				\n\
				kFireTarget:Multiply(iAttackRange);\n\
				kFireTarget:Rotate(kRotateAxis,fRotateAngle*i);\n\
				kFireTarget:Add(arrow_worldpos);			\n\
				kArrow:SetTargetLoc(kFireTarget);	\n\
\n\
				local kGuidStr = kAction:GetParam(10)\n\
				local kGuid = GUID()\n\
				kGuid:Set(kGuidStr)\n\
				local target = g_pilotMan:FindPilot(kGuid)\n\
				if nil~=target and false == target:IsNil() then\n\
					kArrow:SetTargetGuidFromServer(kGuid)\n\
				end\n\
				\n\
				\n\
				kArrow:Fire();--	!\n\
				--ODS(\"Act_Mon_Shot_Around2_OnEvent \"..i.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			end\n\
\n\
			i=i+1;\n\
		end		\n\
\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_RangeAttack_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		--ODS(\"BATTLEIDLE_START ----- Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(0)..\"]\\n\", false, 3851)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
	elseif kState == \"FIRE\" then\n\
		--ODS(\"FIRE ----------- Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"]\\n\", false, 3851)\n\
		action:SetSlot(1)\n\
	elseif kState == \"RETURN\" then\n\
		--ODS(\"RETURN ---------- AniName : \" ..action:GetSlotAnimName(3)..\"\\n\", false, 3851)\n\
		action:SetSlot(3)\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_Shot_Around_Finish_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_Around_Finish_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_Around_Finish_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Around_Finish_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	--ODS(\"Name: \"..actor:GetID()..\", ProjectileIndex: \"..iProjectileIndex..\", AniName: \"..action:GetCurrentSlotAnimName()..\", ProjectileID: \"..kProjectileID..\", kTargetNodeID: \"..kTargetNodeID..\"\\n\",false,6482)\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed == nil then\n\
		fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	end\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	\n\
	local	kTargetEffect = actor:GetAnimationInfo(\"HIT_TARGET_EFFECT_ID\")\n\
	if nil~=kTargetEffect and \"\"~=kTargetEffect then\n\
		kNewArrow:SetParamValue(\"HIT_TARGET_EFFECT_ID\",kTargetEffect)\n\
	end\n\
	local	kTargetEffectNode = actor:GetAnimationInfo(\"HIT_TARGET_EFFECT_TARGET_NODE\")\n\
	if nil~=kTargetEffectNode and \"\"~=kTargetEffectNode then\n\
		kNewArrow:SetParamValue(\"HIT_TARGET_EFFECT_TARGET_NODE\",kTargetEffectNode)\n\
	end\n\
	\n\
	return kNewArrow\n\
\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(40,0)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kPacketType = kPacket:PopByte()\n\
		local kNum = kPacket:PopInt()\n\
		if kNum ~= 0 then\n\
			local kIndex=0\n\
			for i=0,kNum do\n\
				local kGuid = kPacket:PopGuid()\n\
				if nil ~= kGuid and false == kGuid:IsNil() then\n\
					action:SetParam(10+kIndex,kGuid:GetString())\n\
					kIndex = kIndex + 1\n\
				end\n\
			end\n\
			action:SetParamInt(40,kIndex)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_Around_Finish_OnCastingCompleted(actor,action)\n\
	else\n\
	    --ODS(\"Act_Mon_Shot_Around_Finish_OnEnter Start Casting\\n\", false, 3851)\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		--ODS(\"Act_Mon_Shot_Around_Finish Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	local iAttackCount = action:GetAbil(AT_COUNT)\n\
	action:SetParamInt(AT_COUNT, iAttackCount)\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	\n\
	if true == animDone then		\n\
		if 3 == action:GetCurrentSlot() then				\n\
			ODS(\"end Ani\\n\", false, 3851)\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if animDone == true then\n\
			--ODS(\"animDone / CurrentAction = \"..action:GetSlotAnimName(action:GetCurrentSlot())..\"\\n\", false, 3851);\n\
			local iAttackCount = action:GetParamInt(AT_COUNT)\n\
			if 1 < iAttackCount then\n\
				Act_Mon_Shot_Around_Finish_SetState(actor,action,\"FIRE\")\n\
				--ODS(\"Repeat Attack !!!!!         iAttackCount = \"..iAttackCount..\"\\n\", false, 3851)\n\
				action:SetParamInt( AT_COUNT, iAttackCount-1 )\n\
\n\
				return true\n\
			else\n\
				--ODS(\"End Attack !!!!!         iAttackCount = \"..iAttackCount..\"\\n\", false, 3851)\n\
				if 0 ~= action:GetAbil(AT_COUNT) then\n\
					Act_Mon_Shot_Around_Finish_SetState(actor,action,\"RETURN\")\n\
					return true\n\
				end\n\
			end\n\
			\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				--ODS(\"Act_Mon_Shot_Around_Finish_SetState2\\n\", false, 3851)\n\
				Act_Mon_Shot_Around_Finish_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_OnCleanUp(actor)\n\
	actor:DetachFrom(231)			\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_OnLeave(actor, action)\n\
	--ODS(\"Act_Mon_Shot_Around_Finish_OnLeave\\n\")\n\
	--ODS(\"OnLeave ---------- AniName : \" ..action:GetSlotAnimName(action:GetCurrentSlot())..\"\\n\", false, 3851)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_SwordReturn(actor,iActionInstanceID)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0)\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
			action:SetParam(1,\"end\")										-- \n\
		else\n\
			Act_Mon_Shot_Around_Finish_SetState(actor,action,\"RETURN\")				--\n\
			action:SetParam(1,\"wait_animdone\")								--  \n\
		end\n\
	\n\
	end\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Around_Finish_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Act_Mon_Shot_Around_Finish_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
			\n\
	ODS(\"Act_Mon_Shot_Around_Finish_OnEvent textKey:\"..textKey..\"\\n\")\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
\n\
	Act_Mon_Cast_Effect(actor,textKey)\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
	if textKey == \"start\" then\n\
		local EnterEffect = actor:GetAnimationInfo(\"ENTER_EFFECT\")	\n\
		if EnterEffect ~= nil then\n\
			local EnterStartNode	= actor:GetAnimationInfo(\"ENTER_EFFECT_NODE\")	\n\
			\n\
			if EnterStartNode == nil then\n\
				EnterStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"ENTER_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticle(231, EnterStartNode, EnterEffect, EffectScale)\n\
		end		\n\
	elseif textKey == \"end\" then\n\
		local EnterEffect = actor:GetAnimationInfo(\"ENTER_EFFECT\")	\n\
		if EnterEffect ~= nil then\n\
			actor:DetachFrom(231)\n\
		end\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
		\n\
		local fire_delay = actor:GetAnimationInfo(\"FIRE_TERM\")\n\
		if nil == fire_delay or \"\" == fire_delay then\n\
			fire_delay = 0 --   \n\
		else\n\
			fire_delay = tonumber(fire_delay)\n\
		end\n\
		\n\
		local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
			Projectile_cnt = 8\n\
		else\n\
			Projectile_cnt = tonumber(Projectile_cnt)\n\
		end\n\
		\n\
		local fire_random = actor:GetAnimationInfo(\"FIRE_RANDOM\")\n\
		if nil == fire_random or \"\" == fire_random then\n\
			fire_random = 3\n\
		else\n\
			fire_random = tonumber(fire_random)\n\
		end\n\
		\n\
		\n\
		local	kProjectileMan = GetProjectileMan()\n\
\n\
		local	i = 0;\n\
		local fRotateAngle = math.pi / (Projectile_cnt/2)\n\
		local	kRotateAxis = Point3(0,0,1);\n\
		\n\
		\n\
		local UID = kAction:GetParamInt(10+i)\n\
\n\
		local	kArrow = nil\n\
		--kArrow = Act_Mon_Shot_Around_Finish_LoadToWeapon(actor,kAction, i)		\n\
		local LocZ = actor:GetAnimationInfo(\"TARGET_LOC_Z\")\n\
		if nil~=LocZ and \"\"~=LocZ then\n\
			LocZ = tonumber(LocZ)\n\
		end\n\
		while i<Projectile_cnt do\n\
			--kArrow = Act_Mon_Shot_Around_Finish_Projectile_Default_LoadToWeapon(actor, kAction)\n\
			local iProjectaleIndex = Random()%fire_random\n\
			--ODS(\"ProjectaleIndex: \"..iProjectaleIndex..\"\\n\",false,6482)\n\
			kArrow = Act_Mon_Shot_Around_Finish_LoadToWeapon(actor, kAction, iProjectaleIndex)\n\
			if nil~=kArrow and false==kArrow:IsNil() then\n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
				local	kFireTarget = actor:GetLookingDir()\n\
				if nil~=LocZ then\n\
					arrow_worldpos:SetZ(arrow_worldpos:GetZ()+LocZ)\n\
					kFireTarget = arrow_worldpos\n\
				else\n\
					kFireTarget:Multiply(iAttackRange);\n\
					kFireTarget:Rotate(kRotateAxis,fRotateAngle*i);\n\
					kFireTarget:Add(arrow_worldpos);			\n\
				end\n\
				kArrow:SetTargetLoc(kFireTarget);	\n\
\n\
				local kNum = kAction:GetParamInt(40)\n\
				if 0~= kNum then\n\
					local kRan = math.random(1,100)%kNum\n\
					local kGuidStr = kAction:GetParam(10+kRan)\n\
					local kGuid = GUID()\n\
					kGuid:Set(kGuidStr)\n\
					local target = g_pilotMan:FindPilot(kGuid)\n\
					if nil~=target and false == target:IsNil() then\n\
						kArrow:SetTargetGuidFromServer(kGuid)\n\
					end\n\
				end\n\
				if 0 ~= fire_delay then\n\
					kArrow:DelayFire(i*fire_delay)\n\
				else\n\
					--ODS(\"-----------------------Fire kArrow---------------------------\\n\", false, 3851)\n\
					kArrow:Fire();--	!\n\
				end\n\
				--ODS(\"Act_Mon_Shot_Around_Finish_OnEvent \"..i.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			end\n\
\n\
			i=i+1;\n\
		end		\n\
\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_RangeAttack_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(actor==nil) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(action==nil) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_OnCastingCompleted(actor, action)\n\
\n\
	if( CheckNil(actor==nil) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(action==nil) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Shot_Bidirection_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_Bidirection_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_Bidirection_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Bidirection_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	if( CheckNil(actor==nil) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(action==nil) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	if iProjectileIndex>0 and kProjectileID==nil then\n\
		return	nil\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	return kNewArrow\n\
\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_Fire(actor,action)\n\
\n\
	if( CheckNil(actor==nil) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(action==nil) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_OnEnter(actor, action)\n\
\n\
	if( CheckNil(actor==nil) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(action==nil) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(40,0)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kNum = kPacket:PopByte()\n\
		if kNum ~= 0 then\n\
			local kIndex=0\n\
			for i=0,kNum do\n\
				local kGuid = kPacket:PopGuid()\n\
				if nil ~= kGuid and false == kGuid:IsNil() then\n\
					action:SetParam(10+kIndex,kGuid:GetString())\n\
					kIndex = kIndex + 1\n\
				end\n\
			end\n\
			action:SetParamInt(40,kIndex)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_Bidirection_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Shot_Bidirection_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Shot_Bidirection_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Shot_Bidirection_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_Shot_Bidirection Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(actor==nil) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(action==nil) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	local	iState = action:GetParamInt(0)\n\
			local kParam1 = action:GetParam(1)	\n\
			\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if bIsBoomerang or action:GetParamInt(3) == 1 then\n\
\n\
			if kParam1 == \"end\" then\n\
				return	false\n\
			elseif kParam1 == \"wait_animdone\" then\n\
				if animDone == true then\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			elseif kParam1 == \"none\" then\n\
				if animDone and actor:GetAnimationLength(action:GetSlotAnimName(5)) ~= 0 then	--\n\
					action:SetSlot(5)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					action:SetParam(1, \"\")\n\
				end\n\
			end	\n\
			return	true\n\
		end\n\
		\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
			\n\
		elseif iState == 1 and 0 == action:GetParamInt(21) then\n\
			\n\
			action:SetParamInt(21,1)\n\
			local load = actor:GetAnimationInfo(\"PROJECTILE_LOAD\")\n\
			if nil~=load then\n\
				local	iProjectileIndex = 0	\n\
				while iProjectileIndex<8 do	\n\
					local	kArrow = Act_Mon_RangeAttack_LoadToWeapon(actor,action,iProjectileIndex)\n\
					if nil ~= kArrow and false == kArrow:IsNil() then\n\
						action:SetParamInt(10+iProjectileIndex, kArrow:GetUID())\n\
					end\n\
	\n\
					iProjectileIndex = iProjectileIndex + 1\n\
				end\n\
				action:SetParamInt(20, action:GetActionInstanceID())\n\
			end\n\
\n\
			local eff = actor:GetAnimationInfo(\"FIRE_EFFECT\") --   \n\
			if nil~=eff then\n\
				local node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil==node then\n\
					node = \"char_root\"\n\
				end\n\
				actor:AttachParticle(230, node, eff)\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Shot_Bidirection_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Shot_Bidirection_OnLeave\\n\")\n\
	return true\n\
end\n\
function Act_Mon_Shot_Bidirection_SwordReturn(actor,iActionInstanceID)\n\
\n\
	if( CheckNil(actor==nil) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(action==nil) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0)\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
			action:SetParam(1,\"end\")										-- \n\
		else\n\
			Act_Mon_Shot_Bidirection_SetState(actor,action,\"RETURN\")				--\n\
			action:SetParam(1,\"wait_animdone\")								--  \n\
		end\n\
	\n\
	end\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Bidirection_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(actor==nil) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(action==nil) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Act_Mon_Shot_Bidirection_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(actor==nil) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	ODS(\"Act_Mon_Shot_Bidirection_OnEvent textKey:\"..textKey..\"\\n\")\n\
\n\
	local kAction = actor:GetAction()\n\
		\n\
	if( CheckNil(kAction==nil) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan()\n\
\n\
		local	i = 0;\n\
		local fRotateAngle = math.pi/8.0\n\
		local	kRotateAxis = Point3(0,0,1);\n\
		\n\
		\n\
		local UID = kAction:GetParamInt(10+i)\n\
\n\
		local	kArrow = nil\n\
		while i<8 do\n\
			--kArrow = Act_Mon_Shot_Bidirection_Projectile_Default_LoadToWeapon(actor, kAction)	\n\
			local iProjectaleIndex = Random()%3			\n\
			kArrow = Act_Mon_Shot_Bidirection_LoadToWeapon(actor, kAction, iProjectaleIndex)\n\
			if nil~=kArrow or false==kArrow:IsNil() then\n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
				--ODS(\"ap x:\"..arrow_worldpos:GetX()..\" ,ap y:\"..arrow_worldpos:GetY()..\"ap z:\"..arrow_worldpos:GetZ()..\"\\n\", false, 987)\n\
				local kTargetDir = actor:GetLookingDir()\n\
				local kCrossDir = actor:GetLookingDir()\n\
				if i==0 or i==1 or i==4 or i==5 then\n\
					kCrossDir:Cross(Point3(0,0,1))\n\
				else\n\
					kCrossDir:Cross(Point3(0,0,-1))\n\
				end\n\
				if i>3 then\n\
					kTargetDir:Rotate(kRotateAxis, math.pi)\n\
				end\n\
				--ODS(\"i\"..i..\" ,CRS X:\"..kTargetDir:GetX()..\" ,CRS Y:\"..kTargetDir:GetY()..\" ,CRS Z:\"..kTargetDir:GetZ()..\"\\n\", false, 987)\n\
				local kLength = 40\n\
				if (i%2) == 1 then\n\
					kLength = 120\n\
				end\n\
				local 	kPos1 = Point3(kCrossDir:GetX(),kCrossDir:GetY(),kCrossDir:GetZ())\n\
				--ODS(\"Pos1 X:\"..kPos1:GetX()..\" ,Pos1 Y:\"..kPos1:GetY()..\" ,Pos1 Z:\"..kPos1:GetZ()..\"\\n\", false, 987)\n\
				kPos1:Multiply(kLength)\n\
				--ODS(\"Pos1 X:\"..kPos1:GetX()..\" ,Pos1 Y:\"..kPos1:GetY()..\" ,Pos1 Z:\"..kPos1:GetZ()..\"\\n\", false, 987)\n\
				kPos1:Add(arrow_worldpos)\n\
				--ODS(\"Pos1 X:\"..kPos1:GetX()..\" ,Pos1 Y:\"..kPos1:GetY()..\" ,Pos1 Z:\"..kPos1:GetZ()..\"\\n\\n\", false, 987)\n\
				\n\
				local kPos2 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
				local kFireTarget = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
				kPos2:Multiply(500)\n\
				kPos2:Add(kPos1)\n\
				\n\
				kArrow:SetMovingType(2)\n\
				kFireTarget:Multiply(iAttackRange)\n\
				kFireTarget:Add(kPos1)\n\
				kArrow:SetParam_Bezier4SplineType(arrow_worldpos, kPos1, kPos2, kFireTarget)\n\
				--ODS(\"sp x:\"..arrow_worldpos:GetX()..\" ,sp y:\"..arrow_worldpos:GetY()..\"sp z:\"..arrow_worldpos:GetZ()..\"\\n\", false, 987)\n\
				--ODS(\"p1 x:\"..kPos1:GetX()..\" ,p1 y:\"..kPos1:GetY()..\"p1 z:\"..kPos1:GetZ()..\"\\n\", false, 987)\n\
				--ODS(\"p2 x:\"..kPos2:GetX()..\" ,p2 y:\"..kPos2:GetY()..\"p2 z:\"..kPos2:GetZ()..\"\\n\", false, 987)\n\
				--ODS(\"tg x:\"..kFireTarget:GetX()..\" ,tg y:\"..kFireTarget:GetY()..\"tg z:\"..kFireTarget:GetZ()..\"\\n\\n\", false, 987)\n\
				kArrow:SetTargetLoc(kFireTarget)\n\
				kArrow:Fire();--	!\n\
				-- --ODS(\"Act_Mon_Shot_Bidirection_OnEvent \"..i.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			end\n\
\n\
			i=i+1;\n\
		end		\n\
		-- while i<2 do\n\
			-- kArrow = Act_Mon_Shot_Bidirection_Projectile_Default_LoadToWeapon(actor, kAction)\n\
			-- if nil~=kArrow or false==kArrow:IsNil() then\n\
				-- local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
				-- local	kFireTarget = actor:GetLookingDir()\n\
				-- kFireTarget:Multiply(iAttackRange);\n\
				-- kFireTarget:Rotate(kRotateAxis,fRotateAngle*i);\n\
				-- kFireTarget:Add(arrow_worldpos);			\n\
			\n\
				-- kArrow:SetMovingType(2)\n\
				-- local kPos2 = Point3(arrow_worldpos:GetX(), arrow_worldpos:GetY(), arrow_worldpos:GetZ())\n\
				-- kPos2:SetY(kFireTarget:GetY())\n\
				-- local kPos3 = Point3(arrow_worldpos:GetX(), arrow_worldpos:GetY(), arrow_worldpos:GetZ())\n\
				-- kPos3:SetY(kFireTarget:GetY())\n\
				-- kPos3:SetX(kPos3:GetX() + ((kFireTarget:GetX() - arrow_worldpos:GetX()) / 4))\n\
				-- kArrow:SetParam_Bezier4SplineType(arrow_worldpos, kPos2, kPos3, kFireTarget);\n\
				\n\
				-- kArrow:SetTargetLoc(kFireTarget);\n\
				-- kArrow:Fire();--	!\n\
				-- --ODS(\"Act_Mon_Shot_Bidirection_OnEvent \"..i.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			-- end\n\
\n\
			-- i=i+1;\n\
		-- end		\n\
\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Teleport_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_Teleport_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_Teleport_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_Teleport_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Teleport_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		action:SetParamAsPoint(0, kPacket:PopPoint3() )\n\
	end\n\
	\n\
	local	prevAction = actor:GetAction()\n\
		if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Teleport_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_Teleport_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Teleport_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_Teleport_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_Mon_Teleport_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Teleport_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Teleport_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Teleport_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Mon_Teleport_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Mon_Teleport_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_Teleport_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Teleport_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
				\n\
				local eff = actor:GetAnimationInfo(\"CASTING_EFFECT\") --   \n\
				if nil~=eff then\n\
					local TargetPos = action:GetParamAsPoint(0)\n\
					if false==TargetPos:IsZero() then\n\
						actor:AttachParticleToPointWithRotate(230, TargetPos, eff, actor:GetRotateQuaternion(), 1.0);\n\
					else\n\
						local node = actor:GetAnimationInfo(\"CASTING_EFFECT_NODE\")\n\
						if nil==node then\n\
							node = \"char_root\"\n\
						end\n\
						actor:AttachParticle(230, node, eff)\n\
					end\n\
				end\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Teleport_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Teleport_OnCleanUp(actor, action)\n\
	actor:DetachFrom(230)	--  \n\
end\n\
\n\
function Act_Mon_Teleport_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_Teleport_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_Teleport_LoadToWeapon(kActor, kAction)\n\
	\n\
	if( CheckNil(nil==kActor) ) then return nil end\n\
	if( CheckNil(kActor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return nil end\n\
	if( CheckNil(kAction:IsNil()) ) then return nil end\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	--local kPos = kActor:GetPos()\n\
	--kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	local kPos = Point3(kAction:GetParamFloat(10), kAction:GetParamFloat(11), kAction:GetParamFloat(12))\n\
	kNewArrow:LoadToPosition(kPos)\n\
	--ODS(\" x:\"..kPos:GetX()..\" y:\"..kPos:GetY()..\" z:\"..kPos:GetZ()..\" ID:\"..kAction:GetID()..\"\\n\",false,987)\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mon_Teleport_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
    ODS(\"Act_Mon_Teleport_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
	   \n\
      \n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local action = actor:GetAction()\n\
		Act_Mon_Melee_DoDamage(actor,action)\n\
		-- ODS(\"aa:\"..kAction:GetParamFloat(10)..\"\\n\",false,987)		\n\
		-- local	kProjectileMan = GetProjectileMan()\n\
		-- local	kArrow = Act_Mon_Teleport_LoadToWeapon(actor,kAction)\n\
		-- if kArrow ~= nil then\n\
			-- if not kArrow:IsNil() then\n\
				-- local	iTargetCount = kAction:GetTargetCount()\n\
				-- local	iTargetABVShapeIndex = 0\n\
				-- local	kActionTargetInfo = nil\n\
				-- if iTargetCount>0 then\n\
					-- local kTargetGUID = kAction:GetTargetGUID(0)\n\
					-- iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0)\n\
					-- kActionTargetInfo = kAction:GetTargetInfo(0)\n\
					-- local kTargetobject = g_pilotMan:FindPilot(kTargetGUID)\n\
					-- if kTargetobject:IsNil() == false then\n\
						-- local kTargetActor = kTargetobject:GetActor()\n\
						-- if not kTargetActor:IsNil() then\n\
							-- local kTargetLoc = kTargetActor:GetABVShapeWorldPos(iTargetABVShapeIndex)\n\
							-- --kActor:LookAt(kTargetLoc,true,false)\n\
							-- --kTargetLoc:Add( Point3(0,-100,150) )\n\
							-- --kArrow:SetTargetLoc(kTargetLoc)\n\
							-- --kArrow:SetTargetLoc( Point3(-9,125,225) )\n\
							-- kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
							-- --kArrow:SetTargetObject( kActionTargetInfo )\n\
							\n\
							-- actor:ReleaseAllParticles()\n\
							-- kArrow:SetParamValue(\"exValue\", tostring(-150));\n\
						-- end\n\
					-- end\n\
				-- end\n\
				\n\
				-- kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
				-- kArrow:Fire()\n\
			-- end\n\
		-- end\n\
		-- kAction:ClearTargetList()\n\
	end\n\
	\n\
\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Teleport_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Mon_Shot_Sixshot_OnCheckCanEnter(actor,action)\n\
	return		true\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_Shot_Sixshot_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_Sixshot_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_Sixshot_Fire(actor,action)\n\
\n\
end\n\
\n\
-- function	Act_Mon_Shot_Sixshot_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	-- if( CheckNil(nil==actor) ) then return end\n\
	-- if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	-- if( CheckNil(nil==action) ) then return end\n\
	-- if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	-- local	kAttachID=\"\"\n\
	\n\
	-- if iProjectileIndex>0 then\n\
		-- kAttachID = \"\"..iProjectileIndex;\n\
	-- end\n\
	\n\
	-- local	kProjectileMan = GetProjectileMan()\n\
	-- local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	-- local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	-- if fProjetileScale == nil then\n\
		-- fProjetileScale = 1.0\n\
	-- end\n\
	\n\
	-- if iProjectileIndex>0 and kProjectileID==nil then\n\
		-- return	nil\n\
	-- end\n\
	\n\
	-- if kProjectileID == nil then\n\
		-- kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	-- end\n\
	\n\
	-- local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	-- if kNewArrow:IsNil() then\n\
		-- return nil\n\
	-- end\n\
	\n\
	-- local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	-- if kTargetNodeID == nil then\n\
		-- kTargetNodeID = \"p_ef_heart\"\n\
	-- end\n\
	\n\
	-- local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	-- if fProjectileSpeed ~= nil then\n\
		-- fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		-- kNewArrow:SetSpeed(fProjectileSpeed)\n\
	-- end\n\
		\n\
	-- kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
	\n\
	-- kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	-- return kNewArrow\n\
\n\
-- end\n\
\n\
function Act_Mon_Shot_Sixshot_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(40,0)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kNum = kPacket:PopByte()\n\
		if kNum ~= 0 then\n\
			local kIndex=0\n\
			for i=0,kNum do\n\
				local kGuid = kPacket:PopGuid()\n\
				if nil ~= kGuid and false == kGuid:IsNil() then\n\
					action:SetParam(10+kIndex,kGuid:GetString())\n\
					kIndex = kIndex + 1\n\
				end\n\
			end\n\
			action:SetParamInt(40,kIndex)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_Sixshot_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Shot_Sixshot_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Shot_Sixshot_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Shot_Sixshot_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_Shot_Around Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	local	iState = action:GetParamInt(0)\n\
			local kParam1 = action:GetParam(1)	\n\
			\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if bIsBoomerang or action:GetParamInt(3) == 1 then\n\
\n\
			if kParam1 == \"end\" then\n\
				return	false\n\
			elseif kParam1 == \"wait_animdone\" then\n\
				if animDone == true then\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end\n\
			elseif kParam1 == \"none\" then\n\
				if animDone and actor:GetAnimationLength(action:GetSlotAnimName(5)) ~= 0 then	--\n\
					action:SetSlot(5)\n\
					actor:ResetAnimation()\n\
					actor:PlayCurrentSlot()\n\
					action:SetParam(1, \"\")\n\
				end\n\
			end	\n\
			return	true\n\
		end\n\
		\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Shot_Sixshot_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
			\n\
		elseif iState == 1 and 0 == action:GetParamInt(21) then\n\
			\n\
			action:SetParamInt(21,1)\n\
			local load = actor:GetAnimationInfo(\"PROJECTILE_LOAD\")\n\
			if nil~=load then\n\
				local	iProjectileIndex = 0	\n\
				while iProjectileIndex<8 do	\n\
					local	kArrow = Act_Mon_Shot_Sixshot_LoadToWeapon(actor,action,iProjectileIndex)\n\
					if nil ~= kArrow and false == kArrow:IsNil() then\n\
						action:SetParamInt(10+iProjectileIndex, kArrow:GetUID())\n\
					end\n\
	\n\
					iProjectileIndex = iProjectileIndex + 1\n\
				end\n\
				action:SetParamInt(20, action:GetActionInstanceID())\n\
			end\n\
\n\
			local eff = actor:GetAnimationInfo(\"FIRE_EFFECT\") --   \n\
			if nil~=eff then\n\
				local node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
				if nil==node then\n\
					node = \"char_root\"\n\
				end\n\
				actor:AttachParticle(230, node, eff)\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Shot_Sixshot_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Shot_Sixshot_OnLeave\\n\")\n\
	return true\n\
end\n\
function Act_Mon_Shot_Sixshot_SwordReturn(actor,iActionInstanceID)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	if action:GetActionInstanceID() == iActionInstanceID then\n\
	\n\
		if action:GetParamInt(4) == 1 then\n\
			actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
			action:SetParamInt(4,0)\n\
		end\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
			action:SetParam(1,\"end\")										-- \n\
		else\n\
			Act_Mon_Shot_Sixshot_SetState(actor,action,\"RETURN\")				--\n\
			action:SetParam(1,\"wait_animdone\")								--  \n\
		end\n\
	\n\
	end\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Sixshot_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Act_Mon_Shot_Sixshot_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
			\n\
	ODS(\"Act_Mon_Shot_Sixshot_OnEvent textKey:\"..textKey..\"\\n\")\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" or textKey == \"shot\" then\n\
\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan()\n\
\n\
		local	i = 0;\n\
		local fRotateAngle = math.pi/6.0\n\
		local	kRotateAxis = Point3(0,0,1);\n\
		\n\
		\n\
		local UID = kAction:GetParamInt(10+i)\n\
\n\
		local	kArrow = nil\n\
\n\
		while i<6 do\n\
			--kArrow = Act_Mon_Shot_Sixshot_Projectile_Default_LoadToWeapon(actor, kAction)\n\
			local iProjectaleIndex = Random()%3\n\
			kArrow = Act_Mon_Shot_Around_LoadToWeapon(actor, kAction, iProjectaleIndex)\n\
			if nil~=kArrow and false==kArrow:IsNil() then\n\
				local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
				local	kFireTarget = actor:GetLookingDir()\n\
				kFireTarget:Multiply(iAttackRange);\n\
				local k = i\n\
				local pl = 0\n\
				if k > 2 then\n\
					k = k - 3\n\
					pl = math.pi\n\
				end\n\
				\n\
				kFireTarget:Rotate(kRotateAxis,fRotateAngle*(k-1)+pl);\n\
				kFireTarget:Add(arrow_worldpos);			\n\
				kArrow:SetTargetLoc(kFireTarget);	\n\
\n\
				local kNum = kAction:GetParamInt(40)\n\
				if 0~= kNum then\n\
					local kRan = math.random(1,100)%kNum\n\
					local kGuidStr = kAction:GetParam(10+kRan)\n\
					local kGuid = GUID()\n\
					kGuid:Set(kGuidStr)\n\
					local target = g_pilotMan:FindPilot(kGuid)\n\
					if nil~=target and false == target:IsNil() then\n\
						kArrow:SetTargetGuidFromServer(kGuid)\n\
					end\n\
				end\n\
				\n\
				kArrow:Fire();--	!\n\
				ODS(\"Act_Mon_Shot_Sixshot_OnEvent \"..i.. \" angle : \"..fRotateAngle..\" Target X : \"..kFireTarget:GetX()..\" Y : \"..kFireTarget:GetY()..\" Z : \"..kFireTarget:GetZ()..\"\\n\", false, 987)\n\
			end\n\
\n\
			i=i+1;\n\
		end		\n\
\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Move_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_Move_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Act_Mon_Move_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	actor:ResetAnimation()\n\
	action:SetSlot(0)\n\
	actor:PlayCurrentSlot()\n\
\n\
	return	true\n\
\n\
end\n\
\n\
function Act_Mon_Move_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	ODS(\"Act_Mon_Move_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
\n\
	local	ptTargetPos = 0;\n\
\n\
	local	kPacket = action:GetParamAsPacket();\n\
	if kPacket == nil or kPacket:IsNil() then\n\
		ODS(\"[SkillError] Act_Mon_Move_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\")\n\
		return	false;\n\
		\n\
	else\n\
		ptTargetPos = Point3(0,0,0);\n\
		ptTargetPos:SetX(kPacket:PopFloat());\n\
		ptTargetPos:SetY(kPacket:PopFloat());\n\
		ptTargetPos:SetZ(kPacket:PopFloat()+25);\n\
	end\n\
		\n\
\n\
	\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
		\n\
	actor:ResetAnimation()\n\
	action:SetSlot(0)\n\
	actor:PlayCurrentSlot()\n\
	\n\
	--	  \n\
	local	kCurrentPos = actor:GetPos()\n\
	local	kDirVector = ptTargetPos:_Subtract(kCurrentPos)\n\
	local len = kDirVector:Length()\n\
	kDirVector:Unitize()\n\
	\n\
	action:SetParamAsPoint(1,kDirVector)\n\
	\n\
	\n\
	if( Act_Mon_Move_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
		Act_Mon_Move_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
	end	\n\
\n\
\n\
	--SetBreak();\n\
	actor:LookAt(ptTargetPos,true,false,true);\n\
	actor:SetMovingDir(actor:GetLookingDir());\n\
	action:SetParamFloat(2,len)\n\
	ODS(\" \"..len..\"\\n\", false, 1509)\n\
\n\
	return true\n\
end\n\
function Act_Mon_Move_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Move_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Move_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Move_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_Move_Fire\\n\");\n\
	\n\
	--	  \n\
	local	ptTargetPos = action:GetParamAsPoint(0)\n\
	--actor:LookAt(ptTargetPos,true,false,true);\n\
\n\
	--	  \n\
	-- local	kCurrentPos = actor:GetPos()\n\
	-- local	kDirVector = ptTargetPos:_Subtract(kCurrentPos)\n\
	-- kDirVector:Unitize()\n\
	\n\
	-- action:SetParamAsPoint(1,kDirVector)\n\
\n\
\n\
end\n\
\n\
function Act_Mon_Move_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	local	kLookDir = actor:GetLookingDir();\n\
\n\
	\n\
	local	kMovingDir = action:GetParamAsPoint(1)\n\
	\n\
	local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/ABILITY_RATE_VALUE);\n\
\n\
	local	ptTargetPos = action:GetParamAsPoint(0)\n\
	local	kCurrentPos = actor:GetPos()\n\
	actor:LookAt(ptTargetPos,true,false,true);\n\
	local	kCurrentDir = ptTargetPos:_Subtract(kCurrentPos)\n\
	local len = kCurrentDir:Length()\n\
\n\
	if len <10 then\n\
		return false\n\
	end\n\
	\n\
	kMovingDir:Multiply(fMoveSpeed)\n\
	\n\
	actor:SetMovingDelta(kMovingDir);\n\
\n\
	action:SetParamFloat(2, len)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Move_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
\n\
end\n\
\n\
function Act_Mon_Move_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kCurAction) ) then return true end\n\
	if( CheckNil(kCurAction:IsNil()) ) then return true end\n\
	\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_Move_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_Move_OnEvent(actor,textKey)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
\n\
	return true\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Boss_Die_Movie_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_Boss_Die_Movie_OnEnter(actor, action)\n\
	local ifirst = action:GetParamInt(20)\n\
	if ifirst == 1 then\n\
		return true\n\
	end\n\
	\n\
	local kEnding = actor:GetParam(\"ending\")\n\
	if kEnding == \"start\" then\n\
		return true\n\
	end\n\
\n\
	action:SetParamInt(20,1)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Boss_Die_Movie_Start(actor, action)\n\
	local movie = actor:GetAnimationInfo(\"DIE_MOVIE\")\n\
	if nil~=movie then\n\
		if \"\"~=movie then\n\
			g_MovieMgr:Play(movie)\n\
			actor:SetParam(\"ending\", \"start\")\n\
			return true\n\
		end\n\
	end\n\
	\n\
	return false\n\
end\n\
function Act_Boss_Die_Movie_Ready()\n\
	LockPlayerInput(8)\n\
end\n\
\n\
function Act_Boss_Die_Movie_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	local action = actor:GetAction()\n\
\n\
	local kEnding = actor:GetParam(\"ending\")\n\
	if kEnding == \"start\" then	--   \n\
		if g_MovieMgr:IsPlay() == false then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
			return false\n\
		end\n\
	end\n\
\n\
	if actor:IsAnimationDone() == true then\n\
		Act_Boss_Die_Movie_Ready()\n\
		actor:SetHide(true);\n\
		actor:SetHideShadow(true);\n\
		Act_Boss_Die_Movie_Start(actor, action)\n\
		action:SetSlot(1)\n\
		actor:PlayCurrentSlot()\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
\n\
\n\
function Act_Boss_Die_Movie_OnCleanUp(actor, action)\n\
	UnLockPlayerInput(8)\n\
	actor:SetParam(\"ending\", \"\")\n\
end\n\
\n\
function Act_Boss_Die_Movie_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
\n\
function Act_Boss_Die_Movie_OnLeave(actor, action)\n\
	if actor == nil then\n\
		return true\n\
	end\n\
	\n\
	if g_MovieMgr:IsPlay() == false then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Mon_Select_Shot_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_Select_Shot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
	local kClassNo = kSkillDef:GetAbil(3322)\n\
	if kClassNo ~= 0 then\n\
		local	kProjectileMan = GetProjectileMan()\n\
		local	kArrow = Act_Mon_Select_Shot_LoadToWeapon(actor,action)\n\
		if kArrow ~= nil then\n\
			if not kArrow:IsNil() then\n\
				local kTargetActor = g_pilotMan:FindActorByClassNo(kClassNo)\n\
				if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
					kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
					kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
					kArrow:Fire()\n\
				end\n\
			end\n\
		end\n\
		action:ClearTargetList()\n\
	end\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Select_Shot_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_Select_Shot_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_Mon_Select_Shot_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Select_Shot_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Select_Shot_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Mon_Select_Shot_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Mon_Select_Shot_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_Select_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Select_Shot_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Select_Shot_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_Select_Shot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_Select_Shot_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_Select_Shot_LoadToWeapon(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	if( CheckNil(nil==kActor) ) then return nil end\n\
	if( CheckNil(kActor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return nil end\n\
	if( CheckNil(kAction:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	\n\
	-- local kPos = Point3(kAction:GetParamFloat(10), kAction:GetParamFloat(11), kAction:GetParamFloat(12))\n\
	-- kPos:SetZ(kPos:GetZ() + 100)\n\
	-- kNewArrow:LoadToPosition(kPos)\n\
	--ODS(\" x:\"..kPos:GetX()..\" y:\"..kPos:GetY()..\" z:\"..kPos:GetZ()..\" ID:\"..kAction:GetID()..\"\\n\",false,987)\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mon_Select_Shot_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Select_Shot_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Mon_Select_ShotbyKey_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Select_ShotbyKey_OnCastingCompleted(actor,action)\n\
	else\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_Select_ShotbyKey_OnEnter Start Casting\\n\");\n\
		\n\
		local kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local kClassNo = kSkillDef:GetAbil(3322)\n\
		if kClassNo ~= 0 then\n\
			local kTargetActor = g_pilotMan:FindActorByClassNo(kClassNo)\n\
			if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
				actor:LookAt(kTargetActor:GetPos(),true,true);\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_Select_ShotbyKey_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Select_ShotbyKey_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--   .\n\
	local kSkillDef = GetSkillDef(action:GetActionNo())\n\
	local kClassNo = kSkillDef:GetAbil(3322)\n\
	if kClassNo ~= 0 then\n\
		local kTargetActor = g_pilotMan:FindActorByClassNo(kClassNo)\n\
		if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
			actor:LookAt(kTargetActor:GetPos(),true,true);\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_OnUpdate(actor, accumTime, frameTime)\n\
\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			--return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Select_ShotbyKey_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_Select_ShotbyKey_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_Select_ShotbyKey_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_LoadToWeapon(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	if( CheckNil(nil==kActor) ) then return nil end\n\
	if( CheckNil(kActor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return nil end\n\
	if( CheckNil(kAction:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_OnEvent(actor,textKey)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local kClassNo = kSkillDef:GetAbil(AT_MON_SKILL_MONSTER_NO)\n\
		if kClassNo ~= 0 then\n\
			--local kActorPos = actor:GetPos()\n\
			--local kRange = kSkillDef:GetAbil(AT_2ND_AREA_PARAM1) * 3\n\
			\n\
			--local kPilot = g_pilotMan:FindPilotInRange(UT_PLAYER, kActorPos, kRange)\n\
			--ODS(\"Pos x: \"..kActorPos:GetX()..\" y: \"..kActorPos:GetY()..\" Z: \"..kActorPos:GetZ()..\"\\n\",false,987)\n\
			--if kPilot ~= nil and kPilot:IsNil() == false then\n\
				--ODS(\"fire\\n\",false,987)\n\
			local	kProjectileMan = GetProjectileMan()\n\
			local	kArrow = Act_Mon_Select_ShotbyKey_LoadToWeapon(actor,action)\n\
			if kArrow ~= nil then\n\
				if not kArrow:IsNil() then\n\
					local kTargetActor = g_pilotMan:FindActorByClassNo(kClassNo)\n\
					if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
						kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
						kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
						kArrow:Fire()\n\
					end\n\
				end\n\
			end\n\
			--end\n\
			action:ClearTargetList()\n\
		end\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Select_ShotbyKey_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Mon_CrossAttack_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Act_Mon_CrossAttack_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\")\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	actor:FindPathNormal(true)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_CrossAttack_OnCastingCompleted(actor,action)\n\
	else	\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_CrossAttack_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_CrossAttack Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_Mon_CrossAttack_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_CrossAttack_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_CrossAttack_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	-- local	kTargetList = action:GetTargetList();\n\
	-- local	iTargetCount = kTargetList:size();\n\
	\n\
	-- ODS(\"Act_Mon_CrossAttack_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	-- if iTargetCount>0 then\n\
		-- local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		-- if kTargetInfo:IsNil() == false then\n\
		\n\
			-- local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			-- if kTargetPilot:IsNil() == false then\n\
			\n\
				-- local	kTargetActor = kTargetPilot:GetActor();\n\
				-- if kTargetActor:IsNil() == false then\n\
				\n\
					-- ODS(\"Act_Mon_CrossAttack_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					-- --actor:LookAtBidirection(kTargetActor:GetPos());\n\
					-- --actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				-- end\n\
			-- end\n\
		-- end\n\
	-- end\n\
	\n\
end\n\
\n\
function Act_Mon_CrossAttack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			if 2==iState then\n\
				Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
			else\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_CrossAttack_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_CrossAttack_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_CrossAttack_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_CrossAttack_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_CrossAttack_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
    ODS(\"Act_Mon_CrossAttack_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
	\n\
	--Act_Mon_Cast_Effect(actor,textKey)\n\
	--Act_Mon_CrossAttack_SetEffectPos(actor)\n\
	Act_Mon_CrossAttack_PlayEffect(actor, textKey)\n\
	\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
        local   action = actor:GetAction();\n\
		\n\
		if( CheckNil(nil==action) ) then return false end\n\
		if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_CrossAttack_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Act_Mon_CrossAttack_SetEffectPos(actor)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local kSkillDef = GetSkillDef(action:GetActionNo())\n\
	local iDist = kSkillDef:GetAbil(AT_2ND_AREA_PARAM1)\n\
	local iCount = kSkillDef:GetAbil(AT_COUNT)\n\
	if(0==iCount) then\n\
		iCount = 2	-- 2\n\
	end\n\
\n\
	action:SetParamInt(4, iCount)\n\
\n\
	local kActorPos = actor:GetPos()\n\
	local kPathNormal = actor:GetPathNormal();\n\
\n\
	local iAngle = kSkillDef:GetAbil(AT_MON_CROSS_ATTACK_ANGLE) --\n\
	local fAngle = math.rad(iAngle)\n\
\n\
	local fInterAngle = math.rad(360/iCount)\n\
\n\
	local fCos = math.cos(fAngle)\n\
	local fSin = math.sin(fAngle)\n\
\n\
	local x = kPathNormal:GetX()\n\
	local y = kPathNormal:GetY()\n\
\n\
	local x_ = x*fCos + y*fSin--     \n\
	local y_ = y*fCos - x*fSin\n\
\n\
	kPathNormal:SetX(x_)\n\
	kPathNormal:SetY(y_)\n\
	kPathNormal:SetZ(0)			--Z  \n\
\n\
	kPathNormal:Unitize()\n\
	--kPathNormal:Multiply(iDist)	-- \n\
	action:SetParamAsPoint(5, kPathNormal) --  0\n\
\n\
	for i=1,iCount-1 do\n\
		fAngle = fInterAngle\n\
		fCos = math.cos(fAngle)\n\
		fSin = math.sin(fAngle)\n\
		x = kPathNormal:GetX()\n\
		y = kPathNormal:GetY()\n\
		x_ = x*fCos + y*fSin\n\
		y_ = y*fCos - x*fSin\n\
		kPathNormal:SetX(x_)\n\
		kPathNormal:SetY(y_)\n\
		kPathNormal:SetZ(0)			--Z  \n\
		kPathNormal:Unitize()\n\
		action:SetParamAsPoint(5+i, kPathNormal)\n\
	end\n\
end\n\
\n\
function Act_Mon_CrossAttack_PlayEffect(actor, textKey)\n\
	if actor == nil or textKey == nil then\n\
		return\n\
	end\n\
	\n\
	if textKey ~= \"start\" and textKey ~= \"fire\" and textKey ~= \"hit\" then\n\
		return\n\
	end\n\
	\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if textKey == \"start\" then\n\
		local iFirst = action:GetParamInt(88)\n\
		if iFirst == 1 then\n\
			return\n\
		end\n\
		action:SetParamInt(88, 1)\n\
		Act_Mon_CrossAttack_SetEffectPos(actor)\n\
	end\n\
	\n\
	local EffectNode = nil\n\
	local Effect = nil\n\
	local EffectScale = nil\n\
	\n\
	if textKey == \"start\" then\n\
		EffectNode = actor:GetAnimationInfo(\"CAST_EFFECT_NODE\")\n\
		if EffectNode == nil then\n\
			EffectNode = \"char_root\"\n\
		end\n\
		Effect = actor:GetAnimationInfo(\"CAST_EFFECT\")\n\
		EffectScale = actor:GetAnimationInfo(\"CAST_EFFECT_SCALE\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
	end\n\
	\n\
	if textKey == \"fire\" or textKey == \"hit\" then\n\
		EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		if EffectNode == nil then\n\
			EffectNode = \"char_root\"\n\
		end\n\
		Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end	\n\
	end\n\
	\n\
	if nil==Effect then\n\
		return\n\
	end\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local kSkillDef = GetSkillDef(action:GetActionNo())\n\
	local iDist = kSkillDef:GetAbil(AT_2ND_AREA_PARAM1)\n\
	local iWidth = kSkillDef:GetAbil(AT_2ND_AREA_PARAM2)*2\n\
	\n\
	if iWidth == 0 then\n\
		return\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kActorPos = actor:GetPos()\n\
	local kRayPos = Point3(kActorPos:GetX(), kActorPos:GetY(), kActorPos:GetZ()+100)\n\
	local kFloorPos = g_world:ThrowRay(kRayPos, Point3(0,0,-1), 200)\n\
\n\
	local iPacticleIdx = 43000\n\
	actor:AttachParticleToPointS(iPacticleIdx, kFloorPos, Effect, EffectScale)	--    \n\
	iPacticleIdx = iPacticleIdx + 1\n\
\n\
	local iCount = action:GetParamInt(4)	--\n\
	local iDrawCount = iDist / iWidth\n\
	local fRestLen = iDist - iWidth * iDrawCount + iWidth*0.5 -- \n\
\n\
	for i=0,iCount-1 do	-- \n\
		local kRot1 = action:GetParamAsPoint(5+i)	--  \n\
		if textKey ~= \"start\" then\n\
			local kTemp = Point3(kRot1:GetX(), kRot1:GetY(), kRot1:GetZ())\n\
			kTemp:Multiply(iDist)\n\
			kTemp:Add(kActorPos)\n\
		end\n\
		for k=0,iDrawCount-1 do	--  \n\
			local fLen = fRestLen + k * iWidth\n\
			local kPPos = kRot1:_Multiply(fLen)		--  \n\
			kPPos:Add(kActorPos)\n\
			actor:AttachParticleToPointS(iPacticleIdx, kPPos, Effect, EffectScale)\n\
			iPacticleIdx = iPacticleIdx + 1\n\
		end\n\
				\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Melee_Delay_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_SetState(actor,action,kState)\n\
	return Act_Mon_Melee_SetState(actor,action,kState)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_OnEnter(actor, action)\n\
	return Act_Mon_Melee_OnEnter(actor, action)\n\
end\n\
function Act_Mon_Melee_Delay_OnCastingCompleted(actor,action)	\n\
	Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_Fire(actor,action)\n\
	Act_Mon_Melee_Fire(actor,action)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_OnUpdate(actor, accumTime, frameTime)\n\
	return Act_Mon_Melee_OnUpdate(actor, accumTime, frameTime)\n\
end\n\
function Act_Mon_Melee_Delay_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_OnLeave(actor, action)\n\
	return Act_Mon_Melee_OnLeave(actor, action)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_OnEvent(actor,textKey)\n\
	return Act_Mon_Melee_OnEvent(actor,textKey)\n\
end\n\
\n\
function Act_Mon_Melee_Delay_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	if bIsBefore == false then\n\
		Act_Mon_Melee_DoDamage(actor,action)\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_Melee_Loop_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_Melee_Loop_SetState(actor,action,kState)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(5);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"LOOP\" then\n\
		\n\
		action:SetSlot(3)\n\
		iNewState = 3;\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 4;\n\
\n\
		local	bNotDetachEffect = actor:GetAnimationInfo(\"IS_NOT_DETACH_FIRE_EFFECT\")\n\
		if nil==bNotDetachEffect or \"TRUE\"~=bNotDetachEffect then\n\
			actor:DetachFrom(129)\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
\n\
	local	bDetachCastEffect = actor:GetAnimationInfo(\"USE_DETACH_CAST_EFFECT\")\n\
	if nil~=bDetachCastEffect and \"TRUE\"==bDetachCastEffect then\n\
		actor:DetachFrom(122)\n\
	end\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_Melee_Loop_OnEnter(actor, action)\n\
	-- if actor:IsEqualObjectName(\"m_elga02\") then\n\
		-- CallElga02_DownGroggy()\n\
	-- end\n\
	action:SetParamInt(55,0)	-- \n\
	-- ,  CastTime,    \n\
	local iEventNo = actor:GetAnimationInfoFromAniName(\"EVENT_SCRIPT\",action:GetCurrentSlotAnimName())\n\
	if nil~=iEventNo and \"\"~=iEventNo:GetStr() then\n\
		iEventNo = tonumber(iEventNo:GetStr())\n\
		GetEventScriptSystem():ActivateEvent(iEventNo) --\n\
	end\n\
\n\
	return Act_Mon_Melee_OnEnter(actor, action)\n\
end\n\
function Act_Mon_Melee_Loop_OnCastingCompleted(actor,action)	\n\
\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	if( CheckNil(nil==g_world) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
\n\
	local iDelay = action:GetAbil(AT_MAINTENANCE_TIME2) + action:GetAbil(AT_MAINTENANCE_TIME)	--  \n\
	action:SetParamFloat(5,g_world:GetAccumTime() + iDelay*0.001)	-- \n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Melee_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Melee_Loop_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if 0 == action:GetParamInt(55) then	-- \n\
		local	effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		if nil ~= effect and \"\" ~= effect then\n\
			local	node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
			if nil==node or \"\"==node then\n\
				node = \"char_root\"\n\
			end\n\
			local	scale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==scale or \"\"==scale then\n\
				scale = 1\n\
			else\n\
				scale = tonumber(scale)\n\
			end\n\
\n\
			if \"NONE\"~=effect then\n\
				actor:AttachParticleS(129,node,effect,scale)\n\
				action:SetParamInt(55,1)\n\
			end\n\
		end\n\
	end\n\
\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
	--  \n\
			if 4==iState then\n\
				return false;	--  \n\
			end\n\
			Act_Mon_Melee_Loop_SetState(actor,action,\"LOOP\")	\n\
		end\n\
\n\
		if action:GetParamFloat(5)<accumTime then\n\
			if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	--  \n\
				return false\n\
			elseif 4~=iState then\n\
				Act_Mon_Melee_Loop_SetState(actor,action,\"RETURN\")	\n\
			end\n\
		end\n\
		if \"true\"==actor:GetParam(\"lightning\") then\n\
			local   fLastUpdateTime = action:GetParamFloat(3);\n\
			if accumTime - fLastUpdateTime > 0.5 then\n\
				local path = actor:GetAnimationInfo(\"LIGHTNING_PATH\")\n\
				Skill_ChainLightning_CreateLinkedPlane(actor,action,path)\n\
				action:SetParamFloat(3,accumTime);\n\
			end\n\
			local node = actor:GetAnimationInfo(\"LIGHTNING_START_NODE\")\n\
			Skill_ChainLightning_UpdatePlanePos(actor, action, node)	\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Melee_Loop_OnCleanUp(actor, action)\n\
	Act_Mon_Melee_OnCleanUp(actor, action)\n\
	actor:DetachFrom(129)\n\
end\n\
\n\
function Act_Mon_Melee_Loop_OnLeave(actor, action)\n\
	return Act_Mon_Melee_OnLeave(actor, action)\n\
end\n\
function Act_Mon_Melee_Loop_DoDamage(actor,action)\n\
	Act_Mon_Melee_DoDamage(actor,action)\n\
end\n\
\n\
function Act_Mon_Melee_Loop_OnEvent(actor,textKey)\n\
	Act_Mon_Melee_OnEvent(actor,textKey)\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Melee_Loop_OnTargetListModified(actor,action,bIsBefore)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if bIsBefore == false then\n\
        --  .\n\
		Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
		action:GetTargetList():ApplyActionEffects();    \n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function CreateFuryCamera(actor, fCamDistance)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	if LOCALE.NC_DEVELOP == GetLocale()\n\
	or LOCALE.NC_KOREA == GetLocale() then\n\
		GetMyActor():AttachSound(98751, \"defence-monsterin\")\n\
		return false\n\
	end\n\
\n\
	if nil==fCamDistance or 0==fCamDistance then\n\
		fCamDistance = 180\n\
	end\n\
\n\
	local guid = GUID(\"123\")\n\
	guid:Generate();\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000041, 0, \"NPC\")\n\
	\n\
	if pilot == nil or pilot:IsNil() == true then\n\
		return false\n\
	end\n\
	\n\
	local kActor = pilot:GetActor()\n\
	if kActor == nil or kActor:IsNil() == true then\n\
		return false\n\
	end\n\
	kActor:SetHide(true)\n\
	\n\
	if IsSingleMode() == false then\n\
		g_pilotMan:InsertPilot(guid,pilot);\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:AddActor(guid, pilot:GetActor(), actor:GetPos(), 6)\n\
	\n\
	pilot:GetActor():ClearReservedAction()\n\
	local kAction = pilot:GetActor():ReserveTransitAction(\"a_fury_camera\")\n\
	kAction:SetSlot(0)\n\
	kActor:ResetAnimation()\n\
	\n\
	kAction:SetParam(104,actor:GetPilotGuid():GetString())\n\
	kAction:SetParamFloat(114,fCamDistance)\n\
end\n\
\n\
function RemoveFuryCamera(actor)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Act_Fury_Camera_OnCheckCanEnter(actor,action)\n\
	return	true\n\
end\n\
\n\
function Act_Fury_Camera_OnEnter(actor, action)\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	action:SetParamInt(99,0)\n\
	return Act_Mon_Melee_OnEnter(actor, action)\n\
end\n\
\n\
function Act_Fury_Camera_OnCastingCompleted(actor,action)	\n\
	return Act_Mon_Melee_OnCastingCompleted(actor,action)	\n\
end\n\
\n\
function Act_Fury_Camera_OnUpdate(actor, accumTime, frameTime)\n\
	--Act_Mon_Melee_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(99)\n\
	if 0==iState then\n\
		--SlowMotion\n\
		local	Type = 0\n\
		local	From = 0.004\n\
		local	To = 1\n\
		local	Time = 2.7\n\
		g_world:SetSlowMotion(Type, From, To, Time)\n\
		action:SetParamFloat(0,Time)\n\
		action:SetParamFloat(1,g_world:GetAccumTime());	--	Start Time\n\
		\n\
		--Set Camera\n\
		g_world:SetCameraMode(9,GetMyActor());\n\
		\n\
		local	fMoveTime = 0.6\n\
		local	fCamDistance = action:GetParamFloat(114)		--\n\
		local	fCamMoveUp = -40		--\n\
		local	fHorizRotAngle = 0\n\
		local	fVertRotAngle = math.atan(GetCameraTrn():GetZ()/GetCameraTrn():GetY())*180/3.141592;	\n\
\n\
		local	kEventCam = g_world:GetCameraModeEvent()\n\
		if kEventCam:IsNil() then\n\
			return	false\n\
		end\n\
\n\
		local	kGuid = action:GetParam(104)		-- Unit Guid\n\
		kEventCam:SetTargetActor(GUID(kGuid));		\n\
		kEventCam:StartMoveCamera(fMoveTime,fCamDistance,fCamMoveUp,fHorizRotAngle,fVertRotAngle);\n\
		\n\
		--NextState\n\
		action:SetParamInt(99,1)\n\
	elseif 1==iState then\n\
		local	kEventCam = g_world:GetCameraModeEvent()\n\
		if kEventCam:IsNil() then\n\
			return	false\n\
		end\n\
		\n\
		local 	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
		if fElapsedTime >= action:GetParamFloat(0) and kEventCam:GetState() == 2 then\n\
			action:SetParamInt(99,2)\n\
		end\n\
	elseif 2==iState then\n\
		local	WaitTime = 0.7\n\
		action:SetParamFloat(0,WaitTime)\n\
		action:SetParamFloat(1,g_world:GetAccumTime());	--	Start Time\n\
		\n\
		action:SetParamInt(99,5)\n\
	elseif 5==iState then\n\
		local 	fElapsedTime = accumTime - action:GetParamFloat(1)\n\
		if fElapsedTime >= action:GetParamFloat(0) then\n\
			action:SetParamInt(99,6)\n\
		end\n\
	elseif 6==iState then\n\
		local	kActor = GetMyActor()\n\
		if kActor == nil or kActor:IsNil() then\n\
			return	false\n\
		end\n\
		\n\
		local	fMoveTime = 0.8\n\
		local	fCamDistance = math.sqrt(GetCameraTrn():GetY()*GetCameraTrn():GetY()+GetCameraTrn():GetZ()*GetCameraTrn():GetZ());\n\
		local	fCamMoveUp = GetCameraRot():GetZ();\n\
		local	fHorizRotAngle = 0\n\
		local	fVertRotAngle = math.atan(GetCameraTrn():GetZ()/GetCameraTrn():GetY())*180/3.141592;	\n\
\n\
		local	kEventCam = g_world:GetCameraModeEvent()\n\
		if kEventCam:IsNil() then\n\
			return	false\n\
		end\n\
\n\
		kEventCam:SetTargetActor(kActor:GetPilotGuid());		\n\
		kEventCam:StartMoveCamera(fMoveTime,fCamDistance,fCamMoveUp,fHorizRotAngle,fVertRotAngle);\n\
		\n\
		action:SetParamInt(99,7)\n\
	elseif 7==iState then\n\
		local	kEventCam = g_world:GetCameraModeEvent()\n\
		if kEventCam:IsNil() then\n\
			return	false\n\
		end\n\
\n\
		if kEventCam:GetState() == 2 then\n\
			action:SetParamInt(99,8)\n\
		end\n\
	elseif 8==iState then\n\
		local	kActor = GetMyActor()\n\
		if kActor == nil or kActor:IsNil() then\n\
			return	false\n\
		end\n\
		\n\
		g_world:SetCameraMode(1,kActor);\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Fury_Camera_OnCleanUp(actor, action)\n\
	return Act_Mon_Melee_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Fury_Camera_OnLeave(actor, action)\n\
	RemoveFuryCamera(actor)\n\
	return Act_Mon_Melee_OnLeave(actor, action)\n\
end\n\
\n\
function Act_Fury_Camera_OnEvent(actor,textKey)\n\
	return Act_Mon_Melee_OnEvent(actor, textKey)\n\
end\n\
\n\
function Act_Fury_Camera_OnTargetListModified(actor,action,bIsBefore)\n\
	return Act_Mon_Melee_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
\n\
-- Melee\n\
function MagicMissle_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function MagicMissle_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	MagicMissle_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function MagicMissle_Fire(actor,action)\n\
	\n\
end\n\
function MagicMissle_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    local   iArrowCount = action:GetAbil(AT_LEVEL) * 2;\n\
    if iArrowCount == 0 then\n\
        return  0\n\
    end\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	\n\
    kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    kParam:SetParam_2(action:GetSkillRange(0,actor),30,5);\n\
    kParam:SetParam_3(true,FTO_NORMAL);\n\
    \n\
    local	kTempTargets = CreateActionTargetList(actor:GetPilotGuid(),action:GetActionInstanceID(),action:GetActionNo());\n\
    local iFound = action:FindTargets(TAT_RAY_DIR,kParam,kTempTargets,kTempTargets);		\n\
    \n\
    if iFound == 0 then\n\
    \n\
        DeleteActionTargetList(kTempTargets);\n\
        return  0\n\
    end\n\
    \n\
    \n\
    local   iArrowNum = 0;\n\
    local   kTargetInfo = nil;\n\
    local   iTargetNum=0;\n\
    while iArrowNum<iArrowCount do\n\
\n\
        kTargetInfo = kTempTargets:GetTargetInfo(iTargetNum);\n\
        kTargets:AddTarget(kTargetInfo);\n\
    \n\
        iArrowNum=iArrowNum+1;\n\
        iTargetNum = iTargetNum+1\n\
        if iTargetNum>=iFound then\n\
            iTargetNum = 0;\n\
        end\n\
    end\n\
    \n\
    \n\
    DeleteActionTargetList(kTempTargets);\n\
    \n\
    return  kTargets:size();\n\
	\n\
end\n\
\n\
function MagicMissle_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	MagicMissle_OnCastingCompleted(actor,action);\n\
\n\
	action:SetParam(10,\"\");\n\
	\n\
	return true\n\
end\n\
\n\
function MagicMissle_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function MagicMissle_OnCleanUp(actor)\n\
    return true;\n\
end\n\
\n\
function MagicMissle_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		--if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		--end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function MagicMissle_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"MagicMissle_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if kAction:GetParam(10) == \"hit\" then\n\
			return;\n\
		end\n\
\n\
		actor:ClearIgnoreEffectList();\n\
		kAction:CreateActionTargetList(actor, true);\n\
        \n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local   iTotalArrow = kAction:GetAbil(AT_LEVEL) * 2;\n\
		if iTotalArrow == 0 then\n\
		    return\n\
		end\n\
		\n\
		local	kProjectileMan = GetProjectileMan();\n\
	    local	kProjectileID = kAction:GetScriptParam(\"PROJECTILE_ID\");\n\
    	\n\
	    if kProjectileID == \"\" then\n\
		    kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	    end		\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local   kTargetList = kAction:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
--		local   iTargetNum = 0;\n\
		local   kTargetInfo = nil;\n\
		\n\
		if iTargetCount>0 then\n\
				--	  \n\
			local	kTargetGUID = kAction:GetTargetGUID(0);\n\
			local   iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0);\n\
			local   targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				local   pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end						\n\
		end		\n\
		\n\
		local   kCharPos = actor:GetPos();\n\
--		local   kLookDir = actor:GetLookingDir();\n\
		local   fFrontDist = 30;\n\
		local   fCircleRadius = 20;\n\
		local   kProjectileCreationCenter = actor:GetLookingDir();\n\
		kProjectileCreationCenter:Multiply(fFrontDist);\n\
		kProjectileCreationCenter:Add(kCharPos);\n\
		\n\
		local   iArrowCount = 0\n\
		while   iArrowCount<iTotalArrow do\n\
		\n\
		    kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		    \n\
		    --   \n\
		    local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,kAction,actor:GetPilotGuid());\n\
		    \n\
		    if iTotalArrow == 1 then\n\
		    \n\
		        --   1     .\n\
		        kNewArrow:LoadToPosition(kProjectileCreationCenter);\n\
		        \n\
		    else\n\
		    \n\
		        --  2       .\n\
		        local   fAngleDist = 360.0 / iTotalArrow;\n\
		        local   kRotAxis = actor:GetLookingDir();\n\
		        local   kVec = Point3(0,0,fCircleRadius)\n\
		        kVec:Rotate(kRotAxis,fAngleDist*iArrowCount*3.141492/180.0);\n\
		        kVec:Add(kProjectileCreationCenter);\n\
		        \n\
		        kNewArrow:LoadToPosition(kVec);\n\
		    \n\
		    end\n\
		    \n\
		    kNewArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
		    local	arrow_worldpos = kNewArrow:GetWorldPos();	--	 \n\
		    \n\
		    if kTargetInfo:IsNil() or iTargetCount == 0 then\n\
		    \n\
		        local   kTargetPos = actor:GetLookingDir();\n\
				kTargetPos:Multiply(iAttackRange);\n\
				kTargetPos:Add(arrow_worldpos);\n\
				kNewArrow:SetTargetLoc(kTargetPos);		    \n\
		    \n\
		    else\n\
		        kNewArrow:SetTargetObject(kTargetInfo);\n\
		        kTargetList:DeleteTargetInfo(0);\n\
		    end\n\
		    \n\
		    kNewArrow:DelayFire(iArrowCount*0.05);\n\
\n\
			ODS(\" : \".. iArrowCount+1 ..\"\\n\")\n\
    \n\
		    iArrowCount=iArrowCount+1;\n\
		    \n\
		end\n\
\n\
		kTargetList:clear();\n\
\n\
		kAction:SetParam(10,\"hit\");\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Self_Heal_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
\n\
end\n\
function Skill_Self_Heal_Fire(actor,action)\n\
	actor:DetachFrom(126)\n\
	actor:AttachParticle(127, \"p_wp_l_hand\", \"ef_mag_spell_finish\")\n\
	actor:AttachParticle(9125, \"char_root\", \"ef_skill_heal_self\")\n\
\n\
    action:CreateActionTargetList(actor);\n\
    \n\
end\n\
\n\
function Skill_Self_Heal_OnCastingCompleted(actor, action)\n\
\n\
	Skill_Self_Heal_Fire(actor,action);\n\
\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	\n\
end\n\
\n\
function Skill_Self_Heal_OnEnter(actor, action)\n\
	local prevActionID = actor:GetAction():GetID()\n\
\n\
	if prevActionID == \"a_Self Heal\" then\n\
		action:SetParam(911, \"end\")\n\
		action:SetDoNotBroadCast(true)\n\
		return true \n\
	end\n\
\n\
	actor:Stop()\n\
\n\
	actor:AttachParticle(126, \"p_wp_l_hand\", \"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\")\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Self_Heal_OnCastingCompleted(actor,action);	\n\
	return true\n\
end\n\
function Skill_Self_Heal_OnFindTarget(actor,action,kTargets)\n\
	local kParam = FindTargetParam()\n\
	kParam:SetParam_1(actor:GetTranslate(), actor:GetLookingDir())\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor), 30, 0, 0)\n\
	kParam:SetParam_3(true, FTO_NORMAL)\n\
\n\
	return	action:FindTargets(TAT_RAY_DIR, kParam, kTargets, kTargets);\n\
end\n\
\n\
function Skill_Self_Heal_OnUpdate(actor, accumTime, frameTime)\n\
	local action = actor:GetAction()\n\
	local bIsAnimDone = actor:IsAnimationDone()\n\
	local nextActionID = action:GetNextActionName()\n\
	local endParam = action:GetParam(911)\n\
	local iSlot = action:GetCurrentSlot()\n\
\n\
	if endParam == \"end\" then\n\
		return false\n\
	end\n\
\n\
	if bIsAnimDone == true then\n\
		if iSlot == 1 and nextActionID == \"a_idle\" then\n\
			action:SetParam(911, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Self_Heal_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_Self_Heal_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local nextActionID = action:GetID()\n\
	local endParam = curAction:GetParam(911)\n\
\n\
	if endParam == \"end\" then\n\
		return true\n\
	end\n\
\n\
	return false	\n\
end\n\
\n\
function Skill_Self_Heal_OnEvent(actor, textKey)\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		Skill_Self_Heal_DoEffect(actor)\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Self_Heal_DoEffect(actor)\n\
	local action = actor:GetAction()\n\
	local kGuid = actor:GetPilotGuid()\n\
\n\
	local kHelperPos = actor:GetNodeWorldPos(\"char_root\")\n\
	local iTargetCount = action:GetTargetCount()\n\
	\n\
	actor:AttachSound(7283,\"SelfHeal\");\n\
\n\
	-- TargetCount  .\n\
	ODS(\"Heal's Target Count = \" .. iTargetCount .. \"\\n\")\n\
	if iTargetCount > 0 then\n\
\n\
		local kActionResult = action:GetTargetActionResult(0)\n\
		local pt = actor:GetABVShapeWorldPos(action:GetTargetABVShapeIndex(0))\n\
\n\
		action:ClearTargetList()\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
\n\
function Skill_Transformation_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return true;	\n\
end\n\
\n\
function Skill_Transformation_OnCastingCompleted(actor, action)\n\
	Skill_Transformation_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
function Skill_Transformation_Fire(actor,action)\n\
	actor:DetachFrom(126)\n\
	--actor:AttachParticle(127, \"p_wp_l_hand\", \"ef_mag_spell_finish\") --   \n\
	actor:AttachParticle(127, \"char_root\", \"ef_mag_dash_attk_char_root\")\n\
\n\
	local iSkillRange = action:GetSkillRange(0,actor);\n\
	local kDir = actor:GetLookingDir();\n\
    kDir:Multiply(iSkillRange);\n\
    kDir:Add(actor:GetPos());\n\
    kDir:SetZ(kDir:GetZ()-20);\n\
\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	\n\
end\n\
\n\
function Skill_Transformation_OnEnter(actor, action)\n\
	local prevActionID = actor:GetAction():GetID()\n\
\n\
	if prevActionID == \"a_Transformation\" then\n\
		action:SetParam(911, \"end\")\n\
		action:SetDoNotBroadCast(true)\n\
		return true \n\
	end\n\
\n\
	actor:Stop()\n\
\n\
\n\
	local iSkillRange = action:GetSkillRange(0,actor);\n\
	local kDir = actor:GetLookingDir();\n\
    kDir:Multiply(iSkillRange);\n\
    kDir:Add(actor:GetPos());\n\
    kDir:SetZ(kDir:GetZ()-20);\n\
\n\
	actor:AttachParticleToPointS(7212,kDir, \"ef_Curseofwitch_01_char_root\", 1.2);\n\
\n\
	actor:AttachParticle(126, \"p_wp_l_hand\", \"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\")\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Transformation_OnCastingCompleted(actor,action);	\n\
	return true\n\
end\n\
function Skill_Transformation_OnFindTarget(actor,action,kTargets)\n\
\n\
--  \n\
	return Skill_Magician_Charge_Attack_OnFindTarget(actor,action,kTargets);\n\
end\n\
\n\
function Skill_Transformation_OnUpdate(actor, accumTime, frameTime)\n\
	local action = actor:GetAction()\n\
	local bIsAnimDone = actor:IsAnimationDone()\n\
	local nextActionID = action:GetNextActionName()\n\
	local endParam = action:GetParam(911)\n\
	local iSlot = action:GetCurrentSlot()\n\
\n\
	if endParam == \"end\" then\n\
		return false\n\
	end\n\
\n\
	if bIsAnimDone == true then\n\
		if iSlot == 1 and nextActionID == \"a_idle\" then\n\
			action:SetParam(911, \"end\")\n\
			nextActionID = \"a_battle_idle\"\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Transformation_OnCleanUp(actor, action)\n\
	actor:DetachFrom(126,true)\n\
	actor:DetachFrom(127,true)\n\
end\n\
\n\
function Skill_Transformation_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local nextActionID = action:GetID()\n\
	local endParam = curAction:GetParam(911)\n\
\n\
	if endParam == \"end\" then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
function Skill_Transformation_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
                Skill_Transformation_DoEffect(actor);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
function Skill_Transformation_OnEvent(actor, textKey)\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		actor:AttachSound(7283,\"Transformation\");\n\
		\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	kAction = actor:GetAction();\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Transformation_OnTargetListModified(actor,actor:GetAction(),false)\n\
				else\n\
					actor:GetAction():BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end\n\
		\n\
		end\n\
		actor:GetAction():SetParam(2,\"HIT\");\n\
			\n\
		Skill_Transformation_DoEffect(actor)\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Transformation_DoEffect(actor)\n\
	local action = actor:GetAction()\n\
	action:GetTargetList():ApplyActionEffects()\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("\n\
\n\
function Skill_Burberrian_OnCheckCanEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
end\n\
\n\
function Skill_Burberrian_OnCastingCompleted(actor, action)\n\
	Skill_Burberrian_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_Burberrian_Fire(actor,action)\n\
	actor:DetachFrom(126)\n\
	--actor:AttachParticle(127, \"p_wp_l_hand\", \"ef_mag_spell_finish\") --   \n\
	actor:AttachParticle(127, \"char_root\", \"ef_mag_dash_attk_char_root\")	\n\
end\n\
\n\
function Skill_Burberrian_OnEnter(actor, action)\n\
	local prevActionID = actor:GetAction():GetID()\n\
\n\
	if prevActionID == \"a_Burberrian\" then\n\
		action:SetParam(911, \"end\")\n\
		action:SetDoNotBroadCast(true)\n\
		return false \n\
	end\n\
\n\
	actor:Stop()\n\
\n\
	actor:AttachParticle(126, \"p_wp_l_hand\", \"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\")\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Burberrian_OnCastingCompleted(actor,action);	\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Burberrian_OnFindTarget(actor,action,kTargets)\n\
	--[[local kParam = FindTargetParam()\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 60\n\
	end	\n\
	kParam:SetParam_1(actor:GetTranslate(), actor:GetLookingDir())\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor), iParam2, 0, 0)\n\
	kParam:SetParam_3(true, FTO_NORMAL)\n\
	\n\
	return	action:FindTargets(TAT_BAR, kParam, kTargets, kTargets);\n\
	]]--\n\
\n\
	--  \n\
	return Skill_Magician_Charge_Attack_OnFindTarget(actor,action,kTargets);\n\
end\n\
\n\
function Skill_Burberrian_OnUpdate(actor, accumTime, frameTime)\n\
	local action = actor:GetAction()\n\
	local bIsAnimDone = actor:IsAnimationDone()\n\
	local nextActionID = action:GetNextActionName()\n\
	local endParam = action:GetParam(911)\n\
	local iSlot = action:GetCurrentSlot()\n\
\n\
	--ODS(\"_______Bur Update_________\\n\")\n\
\n\
	if endParam == \"end\" then\n\
		return false\n\
	end\n\
\n\
	if bIsAnimDone == true then\n\
		if iSlot == 1 and nextActionID == \"a_battle_idle\" then\n\
			action:SetParam(911, \"end\")\n\
			nextActionID = \"a_battle_idle\"\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Burberrian_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_Burberrian_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local nextActionID = action:GetID()\n\
	local endParam = curAction:GetParam(911)\n\
	--ODS(\"_______Bur Leave_________\\n\")\n\
\n\
\n\
	if endParam == \"end\" then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Burberrian_OnEvent(actor, textKey)\n\
	local action = actor:GetAction();\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		action:CreateActionTargetList(actor);\n\
		Skill_Burberrian_DoEffect(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Burberrian_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Act_Melee_Default_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
\n\
function Skill_Burberrian_DoEffect(actor)\n\
	local action = actor:GetAction()\n\
	local kHelperPos = actor:GetNodeWorldPos(\"p_wp_l_hand\")\n\
	local kTargetDir = actor:GetPos()\n\
	local kMovingDir = actor:GetLookingDir()\n\
	local guid = GUID(\"123\")\n\
	\n\
	--ODS(\"Skill_Burberrian_DoEffect kMovingDir:\"..kMovingDir:GetX()..\",\"..kMovingDir:GetY()..\",\"..kMovingDir:GetZ()..\"\\n\");\n\
\n\
	ODS(\"________ _______\\n\")\n\
\n\
	--  ,   \n\
	guid:Generate()\n\
	local pilot = g_pilotMan:NewPilot(guid, 900002, 0)\n\
	if pilot:IsNil() == false then\n\
		local kNewActor = pilot:GetActor()\n\
		kNewActor:FreeMove(true)\n\
		kMovingDir:Multiply(40)\n\
		kTargetDir:Add(kMovingDir)\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, kNewActor, kTargetDir, 9)\n\
		\n\
		local pt = kNewActor:GetTranslate()\n\
		pt:SetZ(pt:GetZ() - 10)\n\
		kNewActor:AttachParticleToPoint(192, pt, \"ef_bang\")\n\
		kNewActor:ReserveTransitAction(\"a_Burberrian_Freeze\")\n\
		kNewActor:ClearActionState()\n\
		kTargetDir:Add(kMovingDir)\n\
		kNewActor:LookAt(kTargetDir,true)\n\
		\n\
		kNewActor:AttachSound(7283,\"Burberrian\");\n\
		kNewActor:AttachParticle(7212,\"char_root\",\"ef_burberryman_01_char_root\");		\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects()\n\
end\n\
\n\
function Skill_Burberrian_DoUpdate(actor, accumTime, frameTime)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local world = g_world\n\
\n\
	if actor:IsAnimationDone() == true and\n\
		world:IsNil() == false then\n\
		local pt = actor:GetTranslate()\n\
		pt:SetZ(pt:GetZ() - 30)\n\
		actor:AttachParticleToPoint(192, pt, \"ef_bang\")\n\
		world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
	end\n\
end\n\
\n\
\n\
function Skill_Burberrian_Freeze_OnEnter(actor, action)\n\
	--action:SetDoNotBroadCast(true)\n\
	--ODS(\"Freeze Enter____________\\n\")\n\
	action:SetParamInt(4,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(6,g_world:GetAccumTime());\n\
	return true\n\
end\n\
\n\
function Skill_Burberrian_Freeze_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local action = actor:GetAction()\n\
	local iState = action:GetParamInt(4);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end	\n\
	local world = g_world;\n\
\n\
	--ODS(\"Freeze Update____________\\n\")\n\
	if iState == 0 then\n\
		if accumTime - action:GetParamFloat(6) > 1 then\n\
			action:SetParamInt(4,1);\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
		end\n\
	end\n\
\n\
	if iState == 1 then\n\
		if accumTime - action:GetParamFloat(6) > 1 then\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
			actor:SetTargetAlpha(actor:GetAlpha(), 0, 0.3);\n\
			action:SetParamInt(4,2);\n\
		end\n\
	elseif iState == 2 then\n\
		if accumTime - action:GetParamFloat(6) > 0.3 then\n\
			local pt = actor:GetTranslate()\n\
			pt:SetZ(pt:GetZ() - 30)\n\
			world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
			return false;\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Skill_Burberrian_Freeze_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_Burberrian_Freeze_OnLeave(actor, action)\n\
	--ODS(\"Freeze Leave____________\\n\")\n\
	return true\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("function MagicianShot_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function MagicianShot_OnCheckCanEnter(actor,action)\n\
	if nil==actor or actor:IsNil() then\n\
		return false\n\
	end\n\
	if nil==action or action:IsNil() then\n\
		return false\n\
	end\n\
	   \n\
\n\
    ODS(\"MagicianShot_OnCheckCanEnter\\n\");\n\
    \n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMeetFloor() == false then\n\
	\n\
		if 	actor:GetFloatHeight(30)<40 then\n\
		\n\
			return	false;	\n\
			\n\
		end\n\
		\n\
\n\
	end\n\
	\n\
	--   \n\
	if g_pilotMan:IsLockMyInput() == true then\n\
		return\n\
	end		\n\
			\n\
	return		true;\n\
	\n\
end\n\
function MagicianShot_FindTarget(kActor,kAction)\n\
	if nil==actor or actor:IsNil() then\n\
		return false\n\
	end\n\
	if nil==action or action:IsNil() then\n\
		return false\n\
	end\n\
	   \n\
\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = MagicianShot_OnFindTarget(kActor,kAction,kTargets);\n\
	\n\
	return	kTargets;\n\
end\n\
function MagicianShot_OnFindTarget(actor,action,kTargets)\n\
	if nil==actor or actor:IsNil() then\n\
		return false\n\
	end\n\
	if nil==action or action:IsNil() then\n\
		return false\n\
	end\n\
	   \n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
	\n\
\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,g_fMagicianShot_BarWidth,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
\n\
function MagicianShot_OnEnter(actor, action)\n\
	if nil==actor or actor:IsNil() then\n\
		return false\n\
	end\n\
	if nil==action or action:IsNil() then\n\
		return false\n\
	end\n\
\n\
	local	actorID = actor:GetID()\n\
	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"MagicianShot_OnEnter\\n\");\n\
	\n\
	if actor:IsMyActor() == true then\n\
				\n\
		if actor:IsMeetFloor() == false then	\n\
			if Act_Melee_ToFloatAttack(actor,action) then\n\
				return	true\n\
			end\n\
			return	false;\n\
		end\n\
		\n\
		if Act_Melee_IsToDownAttack(actor,action) then\n\
			if	Act_Melee_ToDownAttack(actor,action) then\n\
				return	true\n\
			end\n\
		end		\n\
		if Act_Melee_IsToUpAttack(actor,action) then\n\
			if	Act_Melee_ToBlowUpAttack(actor,action) then\n\
				return	true\n\
			end\n\
		end		\n\
		\n\
		local	iComboCount = actor:GetComboCount();\n\
		if iComboCount > 0 then\n\
			if actor:CanNowConnectToNextComboAttack(0.2) == false 	 then\n\
				actor:SetComboCount(0);	\n\
			end	\n\
		end		\n\
	\n\
		if actor:GetAbil(AT_SKILL_EXTENDED) == 1 then	--	 !!\n\
			--	 \n\
			if actor:GetAbil(AT_MP)>= action:GetAbil(AT_NEED_MP) then\n\
				actor:SetComboCount(0);	\n\
				action:ClearTargetList();\n\
				if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
					actor:ReserveTransitAction(\"a_st_combo_a_ThreeWay\");\n\
					actor:ResetAnimation();\n\
					return false;\n\
				end\n\
				action:SetNextActionName(\"a_Three Way_Fire\");\n\
				action:ChangeToNextActionOnNextUpdate(true, true)	\n\
				return	true;\n\
			end\n\
		elseif actor:GetAbil(AT_SKILL_EXTENDED) == 2 then --  \n\
			if action:CheckCanEnter(actor,\"a_mag_doubleshot\") then\n\
				if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
					actor:ReserveTransitAction(\"a_st_combo_a_Doubleshot\");\n\
					actor:ResetAnimation();\n\
					return false;\n\
				end\n\
				action:SetNextActionName(\"a_mag_doubleshot\");\n\
				action:ChangeToNextActionOnNextUpdate(true, true)	\n\
				return	true;	\n\
			end\n\
			\n\
		end\n\
		\n\
		--	 ,    ,  .\n\
		if actor:GetPilot():IsCorrectClass(CT_BATTLEMAGE) then\n\
			if action:CheckTargetExist(actor,\"a_mag_melee_01\") and\n\
				action:CheckCanEnter(actor,\"a_mag_melee_01\") then\n\
				action:SetNextActionName(\"a_mag_melee_01\");\n\
				action:ChangeToNextActionOnNextUpdate(true, true)	\n\
				\n\
				return	true;	\n\
			end\n\
		end\n\
\n\
		if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
			local iWeaponType = actor:GetEquippedWeaponType();\n\
			local bUseCombo = false	\n\
			if 3 == iWeaponType then\n\
				actor:ReserveTransitAction(\"a_st_combo_a\");\n\
				bUseCombo = true\n\
			elseif 4 == iWeaponType then\n\
				actor:ReserveTransitAction(\"a_sp_combo_a\");\n\
				bUseCombo = true\n\
			end\n\
			if true == bUseCombo then\n\
				actor:ResetAnimation();\n\
				return false;\n\
			end\n\
		end\n\
	end\n\
	\n\
	local iTargetCount = action:GetTargetCount();\n\
	ODS(\"MagicianShot_Fire iTargetCount : \"..iTargetCount..\"\\n\");	\n\
	actor:SetComboCount(0);\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(0);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
		\n\
	action:SetParamInt(6,0);\n\
	action:SetParamInt(7,1);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());	\n\
	    GetComboAdvisor():AddNextAction(action:GetID());	\n\
	end	\n\
	return true\n\
end\n\
\n\
function	MagicianShot_LoadArrowToWeapon(actor,action)\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local 	kProjID = actor:GetEquippedWeaponProjectileID()\n\
	if nil==kProjID or \"\"==kProjID then\n\
		kProjID = \"PROJECTILE_MAGICIAN_DEFAULT_SHOT\"\n\
		local weapontype = actor:GetEquippedWeaponType()\n\
		if nil~=weapontype and WT_SPR==weapontype then	--  \n\
			kProjID = \"PROJECTILE_MAGE_DEFAULT_SHOT\"\n\
		end\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjID,action,actor:GetPilotGuid());\n\
\n\
	local	kPosition = actor:GetNodeWorldPos(\"p_ef_heart\");\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fMoveDistance = 30.0;\n\
	\n\
	kDir:Multiply(fMoveDistance)\n\
	kPosition:Add(kDir)\n\
	\n\
	kNewArrow:SetWorldPos(kPosition)\n\
\n\
	return	kNewArrow;	\n\
end\n\
\n\
function MagicianShot_Finished(actor,action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"MagicianShot_Finished\\n\");\n\
	\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	actionID = action:GetID();\n\
			\n\
	actor:SetNormalAttackEndTime();\n\
	\n\
		\n\
\n\
	local	curActionSlot = action:GetCurrentSlot()\n\
	local	curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = action:GetParam(1);\n\
\n\
		action:SetParam(0, \"null\")\n\
		action:SetParam(1, \"end\")\n\
		return false;\n\
	else\n\
\n\
		action:SetParam(0, \"null\")\n\
		action:SetParam(1, \"end\")\n\
		\n\
		return false\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function MagicianShot_OnUpdate(actor, accumTime, frameTime)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	actorID = actor:GetID()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if animDone == true then\n\
		return	MagicianShot_Finished(actor,action);\n\
	end\n\
	\n\
	\n\
	local fMovingSpeed = 0;\n\
\n\
	if IsSingleMode() == true then\n\
		fMovingSpeed = 120\n\
	else\n\
	    fMovingSpeed = actor:GetAbil(AT_C_MOVESPEED)\n\
	end	\n\
\n\
	local dir = actor:GetDirection()\n\
	if dir ~= DIR_NONE then\n\
		actor:Walk(dir, fMovingSpeed)\n\
	end\n\
\n\
	return true\n\
end\n\
function MagicianShot_OnCleanUp(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"MagicianShot_ReallyLeave\\n\");\n\
\n\
	--        (Text Key Event     ......)\n\
	if actor:GetAction():IsNil() == false then\n\
	\n\
	    if actor:GetAction():GetParamInt(7) == 1 then\n\
			actor:GetAction():SetParamInt(7,2);\n\
			MagicianShot_DoEffect(actor);\n\
	    end\n\
	\n\
	end	\n\
	return true;\n\
end\n\
function MagicianShot_OnLeave(actor, action)\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"MagicianShot_OnLeave NEXTACTION : \"..actionID..\" curParam:\"..curParam..\"\\n\");\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	\n\
	if actionID ==\"a_magician_charge_laser\" then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		--if actionID == \"a_MagicianShot_01\" then\n\
		--	return	false;\n\
		--end\n\
		\n\
		--if curAction:GetParam(4)~=\"\" then\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
		--end\n\
		\n\
		if curAction:GetParam(4) == \"HIT\" and\n\
		    actionID==\"a_run\" then\n\
		    if KeyIsDown(KEY_LEFT) or KeyIsDown(KEY_RIGHT) then\n\
		        return  true;\n\
		    end\n\
		end		    \n\
	\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function MagicianShot_DoEffect(actor)\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	local	action = actor:GetAction()\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then	--	 DB  ...\n\
		iAttackRange = 200\n\
	end\n\
	\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = MagicianShot_LoadArrowToWeapon(actor,action);\n\
	\n\
\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local szEffName = \"shot_rebound_01\"\n\
		local szNode = \"char_root\"\n\
		local kScale = 1.0\n\
		local kAEffect = actor:GetAttackEffect(action:GetID())\n\
		if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
			szEffName = kAEffect:GetEffectName()\n\
			szNode = kAEffect:GetNodeName()\n\
			kScale = kAEffect:GetScale()\n\
		end\n\
\n\
		actor:AttachParticleS(421,szNode,szEffName,kScale)\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		kMovingDir:Multiply(iAttackRange-45);\n\
		kMovingDir:Add(arrow_worldpos);\n\
		kArrow:SetTargetLoc(kMovingDir);	\n\
		\n\
		kArrow:Fire();\n\
	\n\
	end\n\
	\n\
	\n\
end\n\
\n\
function MagicianShot_OnEvent(actor, textKey)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"MagicianShot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\"then\n\
		local kCurAction = actor:GetAction();\n\
		if( CheckNil(kCurAction:IsNil()) ) then return false end\n\
\n\
		if kCurAction:GetParamInt(7) == 1 then\n\
		\n\
			kCurAction:SetParamInt(7,2);\n\
			MagicianShot_DoEffect(actor);\n\
		\n\
		end\n\
		\n\
\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function MagicianFloatShot_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function MagicianFloatShot_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end	\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMeetFloor() == false then\n\
		return	false;	\n\
	end\n\
		\n\
	return		true;\n\
	\n\
end\n\
function MagicianFloatShot_FindTarget(kActor,kAction)\n\
	\n\
	if( CheckNil(nil==kActor) ) then return end\n\
	if( CheckNil(kActor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = MagicianFloatShot_OnFindTarget(kActor,kAction,kTargets);\n\
	\n\
	return	kTargets;\n\
end\n\
function MagicianFloatShot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	return	MagicianFloatShot_OnFindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
end\n\
\n\
function MagicianFloatShot_OnFindTargetEx(actor,action,iActionID,iAttackRange,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	kParam = FindTargetParam();\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	\n\
	local	fFrontMove = 60;\n\
	\n\
	kMovingDir:Multiply(fFrontMove);\n\
	\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ()+60);\n\
\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,150,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);\n\
	local iTargetCount = action:FindTargetsEx(iActionID,TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	ODS(\"MagicianFloatShot_OnFindTargetEx iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	return	iTargetCount;\n\
	\n\
end\n\
\n\
\n\
function MagicianFloatShot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"MagicianFloatShot_OnEnter\\n\");\n\
		\n\
	MagicianFloatShot_Fire(actor,action);\n\
	\n\
	actor:ResetAnimation();\n\
		\n\
	action:SetParamInt(6,0);\n\
	\n\
	return true\n\
end\n\
function MagicianFloatShot_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iTargetCount = 0;\n\
\n\
	if actor:IsMyActor() == true then\n\
	\n\
		local kTargets = MagicianFloatShot_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);\n\
		\n\
		iTargetCount = kTargets:size();\n\
		\n\
	end\n\
	\n\
	iTargetCount = action:GetTargetCount();\n\
	ODS(\"MagicianFloatShot_Fire iTargetCount : \"..iTargetCount..\"\\n\");	\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(0);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	MagicianFloatShot_LoadArrowToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(\"PROJECTILE_MAGICIAN_DEFAULT_SHOT\",action,actor:GetPilotGuid());\n\
\n\
	local	kPosition = actor:GetNodeWorldPos(\"p_ef_heart\");\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fMoveDistance = 30.0;\n\
	\n\
	kDir:Multiply(fMoveDistance);\n\
	kPosition:Add(kDir);\n\
	\n\
	kNewArrow:SetWorldPos(kPosition);\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function MagicianFloatShot_Finished(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	actionID = action:GetID();\n\
			\n\
	actor:SetNormalAttackEndTime();\n\
\n\
	local	curActionSlot = action:GetCurrentSlot()\n\
	local	curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = action:GetParam(1);\n\
\n\
		action:SetParam(0, \"null\")\n\
		action:SetParam(1, \"end\")\n\
		\n\
		action:SetNextActionName(nextActionName)\n\
		return false;\n\
	else\n\
\n\
		action:SetParam(1, \"end\")\n\
\n\
		return false\n\
	end\n\
end\n\
\n\
function MagicianFloatShot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
			\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	if animDone == true then\n\
		return	MagicianFloatShot_Finished(actor,action);\n\
	end\n\
	\n\
	return true\n\
end\n\
function MagicianFloatShot_OnCleanUp(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"MagicianFloatShot_ReallyLeave\\n\");\n\
\n\
	if action:GetID() == \"a_jump\" then\n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
		return true\n\
	end	\n\
	\n\
	return true;\n\
end\n\
function MagicianFloatShot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
			\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"MagicianFloatShot_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		actionID == \"a_run\" then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" or\n\
		actionID == \"a_jump\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function MagicianFloatShot_DoEffect(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then	--	 DB  ...\n\
		iAttackRange = 200\n\
	end\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	actor:AttachParticle(10,\"p_wp_l_hand\",\"ef_mag_lightning\");\n\
	ODS(\"ef_mag_lightning\\n\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = MagicianFloatShot_LoadArrowToWeapon(actor,action);\n\
	\n\
\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		actor:AttachParticle(421,\"char_root\",\"shot_rebound_01\");\n\
		\n\
		\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
		local	pt = nil;\n\
		if iTargetCount>0 then\n\
				--	  \n\
			kActionTargetInfo = kTargetList:GetTargetInfo(0);\n\
\n\
			local	kTargetGUID = kActionTargetInfo:GetTargetGUID();\n\
			iTargetABVShapeIndex = kActionTargetInfo:GetABVIndex();\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end						\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
		else\n\
				\n\
			kArrow:SetTargetObjectList(kTargetList);	\n\
			\n\
		end\n\
		\n\
		kArrow:Fire();\n\
		ODS(\"MagicianShot Arrow Fire\\n\");\n\
		\n\
		kTargetList:clear();\n\
	\n\
	end\n\
	\n\
	\n\
end\n\
\n\
function MagicianFloatShot_OnEvent(actor, textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		\n\
		MagicianFloatShot_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
\n\
function Skill_Magician_Charge_Laser_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then		--    .\n\
		return	false;\n\
	end\n\
	\n\
	return		true;\n\
\n\
end\n\
\n\
function Skill_Magician_Charge_Laser_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1);\n\
	if actor:IsMyActor() == false then\n\
		Skill_Magician_Charge_Laser_Fire(actor,action);\n\
	end				\n\
end\n\
\n\
function Skill_Magician_Charge_Laser_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(3,0);\n\
	action:SetParamInt(1,0);\n\
	action:SetParamInt(5,0);\n\
				\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
\n\
	if action:GetActionParam() == AP_CASTING then\n\
		--    .\n\
		actor:AttachParticle(11,\"p_wp_r_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
		actor:AttachParticle(12,\"p_wp_l_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
	end\n\
		\n\
	action:SetAutoBroadCastWhenCastingCompleted(false);	\n\
	action:SetParamInt(6,0);\n\
	\n\
   return true\n\
end\n\
\n\
function Skill_Magician_Charge_Laser_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(1,1);\n\
	\n\
	actor:PlayNext();\n\
	\n\
	actor:DetachFrom(11);\n\
	actor:DetachFrom(12);\n\
	\n\
	action:SetParamInt(3,0);		\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		\n\
		action:SetActionInstanceID();\n\
		action:BroadCast(actor:GetPilot());\n\
	end\n\
\n\
    actor:AttachParticle(15,\"char_root\",\"ef_mag_gathering_01\");\n\
    \n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end    \n\
    \n\
end\n\
\n\
function Skill_Magician_Charge_Laser_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,50,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Magician_Charge_Laser_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	bKeyCheck = KeyIsDown(action:GetActionKeyNo(0))\n\
	local	iState = action:GetParamInt(6);\n\
	\n\
	if actor:IsMyActor() == false then\n\
		bKeyCheck = true;\n\
	end\n\
	\n\
	if iState == 0 then\n\
	\n\
		if animDone == true then\n\
			if curSlot == 0 then\n\
				actor:PlayNext();\n\
				local	kMovingVec = actor:GetLookingDir();\n\
				local	fDistance = 100;\n\
				kMovingVec:Multiply(fDistance);\n\
				kMovingVec:Add(actor:GetTranslate());\n\
				kMovingVec:SetZ(kMovingVec:GetZ() - 20)	\n\
				action:SetParamInt(3,1);							\n\
			end\n\
			if curSlot == 2 then\n\
				action:SetParamInt(6,1);\n\
				action:SetParamFloat(7,accumTime);\n\
				return true;\n\
			end\n\
		end\n\
		\n\
		if bKeyCheck == false then\n\
			if curSlot == 0 then\n\
				return	false;\n\
			end\n\
		\n\
			--  ,     .\n\
			if curSlot == 1 and action:GetParamInt(5) == 1 then\n\
				Skill_Magician_Charge_Laser_Fire(actor,action);\n\
			else\n\
				return false\n\
			end	\n\
		end\n\
		\n\
	else\n\
	\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(7);\n\
		if fElapsedTime>=g_fChargingFreezeTime then\n\
			action:SetParam(2,\"end\");\n\
			return	false;					\n\
		end		\n\
		\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Magician_Charge_Laser_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(9);\n\
	actor:DetachFrom(11);\n\
	actor:DetachFrom(12);\n\
	\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Magician_Charge_Laser_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetID() == \"a_jump\" or action:GetID() == \"a_MagicianShot_01\" then\n\
	\n\
		if actor:GetAction():GetParam(10) == \"HIT\" then\n\
			return true;\n\
		end\n\
	\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
		\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(1) == 1 and curAction:GetParam(2)~=\"end\" then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
\n\
function ASkill_Magician_Charge_Laser_DoDamage(actor, action,fAttackHoldingTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
\n\
	if 	iTargetCount == 0 then\n\
		return true;\n\
	end\n\
\n\
	local	i = 0;\n\
		\n\
	if fAttackHoldingTime == nil or fAttackHoldingTime == 0 then\n\
		fAttackHoldingTime = g_fAttackHitHoldingTime;\n\
	end\n\
	while i<iTargetCount do\n\
		\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			\n\
			local	actorTarget = kTargetPilot:GetActor();\n\
			if actorTarget:IsNil() == false and actorTarget:GetPilotGuid() ~= actor:GetPilotGuid() then\n\
			\n\
				local kActionResult = action:GetTargetActionResult(i);\n\
--				local	kActionTargetInfo = action:GetTargetInfo(i);	\n\
				\n\
				local	iSphereIndex = action:GetTargetABVShapeIndex(i);\n\
				local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex);		\n\
\n\
				actorTarget:AttachParticleToPoint(12, pt, \"ef_mag_gathering_02\")\n\
\n\
--				local	atAction = actorTarget:GetAction()\n\
				\n\
--				local	guidPilot = actorTarget:GetPilotGuid()\n\
--				local	pilot = g_pilotMan:FindPilot(guidPilot)\n\
				\n\
				local iHoldingTime = fAttackHoldingTime * 1000;\n\
				local	iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
				\n\
				--   \n\
				actor:SetAnimSpeedInPeriod(0.00001,iHoldingTime);\n\
				actor:SetShakeInPeriod(5,iShakeTime/2);\n\
				actorTarget:SetShakeInPeriod(5,iShakeTime);		\n\
				\n\
				--   \n\
				local kTargetAction = actor:GetAction()\n\
				if kTargetAction ~= nil and kTargetAction:IsNil() == false then\n\
					local actionName = kTargetAction:GetID()\n\
					if kActionResult:GetCritical() then\n\
						actionName = \"Critical_dmg\"\n\
					end\n\
					actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
				end\n\
\n\
			end\n\
		end\n\
		\n\
		i = i + 1;\n\
		\n\
	end\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects();\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
function Skill_Magician_Charge_Laser_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetParamInt(1) ~= 1 then\n\
		return true;\n\
	end\n\
	\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		action:SetParam(10,\"HIT\");\n\
		\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end		\n\
	\n\
		ASkill_Magician_Charge_Laser_DoDamage(actor,actor:GetAction())\n\
		\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Magician_Down_Shot_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Magician_Down_Shot_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		local weapontype = actor:GetEquippedWeaponType();\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
	end\n\
	return true\n\
	\n\
end\n\
function Magician_Down_Shot_FindTarget(kActor, kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());	\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Magician_Down_Shot_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
	return	kTargets;\n\
end\n\
function Magician_Down_Shot_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(iAttackRange);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ());		\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local	kPos2 = g_world:ThrowRay(kPos,Point3(0,0,-1),500);	--	  \n\
	if kPos2:GetX() ~= -1 then\n\
\n\
		local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
		if 0==iParam2 then\n\
			iParam2 = g_fMagician_JumpDown_Meteor_Blow_Range\n\
		end\n\
\n\
		local kParam = FindTargetParam();\n\
		kParam:SetParam_1(kPos2,actor:GetLookingDir());\n\
		kParam:SetParam_2(0,30,iParam2,0);	\n\
		kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP);\n\
		\n\
		return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)\n\
	\n\
	end\n\
	\n\
	return	0;\n\
end\n\
\n\
function Magician_Down_Shot_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	--ODS(\"Magician_Down_Shot_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
	\n\
	if action:CheckCanEnter(actor,\"a_mage_down_shot\") then\n\
		action:SetNextActionName(\"a_mage_down_shot\");\n\
		action:ChangeToNextActionOnNextUpdate(true, true)\n\
		return	true;\n\
	else\n\
		local Pilot = actor:GetPilot()\n\
		if not Pilot:IsNil() then\n\
			if ( CT_MAGE == actor:GetAbil(AT_CLASS) or CT_WIZARD == actor:GetAbil(AT_CLASS) )\n\
			and CheckLearnedPrecedentSkill(\"a_mage_down_shot\") then\n\
				return false;\n\
			end\n\
		end\n\
	end	\n\
\n\
	if actor:IsMyActor() == true then\n\
	\n\
		if actor:GetFloatHeight(40)<50 then\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		if actor:GetParam(\"JUMP_DOWN_ATTACK_ENABLE\") ~= nil and\n\
		    actor:GetParam(\"JUMP_DOWN_ATTACK_ENABLE\") == \"FALSE\" then\n\
		    \n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			\n\
			return	true;		\n\
			    \n\
		end\n\
		\n\
		actor:SetParam(\"JUMP_DOWN_ATTACK_ENABLE\",\"FALSE\");\n\
		\n\
			\n\
		action:SetParam(3,\"\");\n\
\n\
	end\n\
\n\
	Magician_Down_Shot_Fire(actor,action);\n\
	actor:FreeMove(true);\n\
	actor:StopJump();\n\
	\n\
	action:SetParam(3,-1);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());	\n\
	end		\n\
	\n\
	return true\n\
end\n\
function Magician_Down_Shot_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1)	\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Magician_Down_Shot_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);	\n\
	end\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
	--ODS(\"Magician_Down_Shot_Fire iTargetCount : \"..iTargetCount..\"\\n\");\n\
\n\
	local dis = 0\n\
	local lookNum = 0\n\
\n\
	for i = 0, iTargetCount - 1 do\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			pt:Subtract(actor:GetTranslate())\n\
			if dis < pt:Length() then\n\
				dis = pt:Length()\n\
				lookNum = i\n\
			end\n\
		end\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	Magician_Down_Shot_LoadArrowToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = action:GetScriptParam(\"ATTACH_NODE\");	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	local	iRandom = math.random(-100,100);\n\
	if iRandom == 0 then\n\
		iRandom = 1;\n\
	end\n\
\n\
	kMovingDir:Multiply(iAttackRange+iRandom);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ()+100);\n\
	\n\
	kNewArrow:SetWorldPos(kPos);\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function Magician_Down_Shot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Magician_Down_Shot_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
\n\
	if action:GetID() == \"a_jump\" then\n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
	end\n\
	\n\
	return true;\n\
end\n\
function Magician_Down_Shot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	--ODS(\"Magician_Down_Shot_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		--action:SetSlot(2)\n\
		--action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end		\n\
\n\
	if action:GetEnable() == true then\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		actionID == \"a_run\" then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Magician_Down_Shot_DoEffect(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	ODS(\"Magician_Down_Shot_DoEffect iAttackRange:\"..iAttackRange..\"\\n\");\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = Magician_Down_Shot_LoadArrowToWeapon(actor,action);\n\
	\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		local	kPos = actor:GetPos();\n\
		local	kMovingDir = actor:GetLookingDir();\n\
		kMovingDir:Multiply(iAttackRange);\n\
		kPos:Add(kMovingDir);\n\
		kPos:SetZ(kPos:GetZ()-20);		\n\
		\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local	kPos2 = g_world:ThrowRay(kPos,Point3(0,0,-1),500);	--	  \n\
		\n\
		ODS(\"___________TargetLoc : \" .. kPos2:GetX() .. \" , \" .. kPos2:GetY() .. \", \" .. kPos2:GetZ() .. \"\\n\")\n\
\n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
		\n\
		actor:LookAt(kPos);\n\
	\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		if iTargetCount>0 then\n\
			kArrow:SetTargetObjectList(action:GetTargetList());	\n\
		end\n\
\n\
		if kPos2:GetX() == -1 and \n\
			kPos2:GetY() == -1 and\n\
			kPos2:GetZ() == -1 then\n\
			kPos2 = g_world:ThrowRay(actor:GetPos(), Point3(0,0,-1), 500)\n\
		end\n\
\n\
		kArrow:SetTargetLoc(kPos2);		\n\
		kArrow:Fire();\n\
	\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Magician_Down_Shot_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	--ODS(\"Magician_Down_Shot_OnEvent key : \"..textKey..\"\\n\");\n\
	if (textKey == \"fire\" or textKey==\"hit\") and actor:GetAction():GetParam(4)~=\"HIT\" then\n\
		\n\
		Magician_Down_Shot_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Mage_Down_Shot_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Mage_Down_Shot_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		local weapontype = actor:GetEquippedWeaponType();\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
	end\n\
	\n\
	return true\n\
	\n\
end\n\
function Mage_Down_Shot_FindTarget(kActor, kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());	\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Mage_Down_Shot_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
	return	kTargets;\n\
end\n\
function Mage_Down_Shot_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(iAttackRange);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ());		\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local	kPos2 = g_world:ThrowRay(kPos,Point3(0,0,-1),500);	--	  \n\
	if kPos2:GetX() ~= -1 then\n\
\n\
		local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
		if 0==iParam2 then\n\
			iParam2 = g_fMage_JumpDown_Meteor_Blow_Range\n\
		end\n\
\n\
		local kParam = FindTargetParam();\n\
		kParam:SetParam_1(kPos2,actor:GetLookingDir());\n\
		kParam:SetParam_2(0,30,iParam2,0);	\n\
		kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP);\n\
		\n\
		return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)\n\
	\n\
	end\n\
	\n\
	return	0;\n\
end\n\
\n\
function Mage_Down_Shot_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	--ODS(\"Mage_Down_Shot_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
\n\
	if actor:IsMyActor() == true then\n\
	\n\
		if actor:GetFloatHeight(40)<50 then\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		if actor:GetParam(\"JUMP_DOWN_ATTACK_ENABLE\") ~= nil and\n\
		    actor:GetParam(\"JUMP_DOWN_ATTACK_ENABLE\") == \"FALSE\" then\n\
		    \n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			\n\
			return	true;		\n\
			    \n\
		end\n\
		\n\
		actor:SetParam(\"JUMP_DOWN_ATTACK_ENABLE\",\"FALSE\");\n\
		\n\
			\n\
		action:SetParam(3,\"\");\n\
\n\
	end\n\
\n\
	Mage_Down_Shot_Fire(actor,action);\n\
	actor:FreeMove(true);\n\
	actor:StopJump();\n\
	\n\
	action:SetParam(3,-1);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());	\n\
	end		\n\
	\n\
	return true\n\
end\n\
function Mage_Down_Shot_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1)	\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Mage_Down_Shot_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);	\n\
	end\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
	--ODS(\"Mage_Down_Shot_Fire iTargetCount : \"..iTargetCount..\"\\n\");\n\
\n\
	local dis = 0\n\
	local lookNum = 0\n\
\n\
	for i = 0, iTargetCount - 1 do\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			pt:Subtract(actor:GetTranslate())\n\
			if dis < pt:Length() then\n\
				dis = pt:Length()\n\
				lookNum = i\n\
			end\n\
		end\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function Mage_Down_Shot_LoadArrowToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = action:GetScriptParam(\"ATTACH_NODE\");	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	local	iRandom = math.random(-100,100);\n\
	if iRandom == 0 then\n\
		iRandom = 1;\n\
	end\n\
\n\
	kMovingDir:Multiply(iAttackRange+iRandom);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ()+100);\n\
	\n\
	kNewArrow:SetWorldPos(kPos);\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function Mage_Down_Shot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Mage_Down_Shot_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
\n\
	if action:GetID() == \"a_jump\" then\n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
	end\n\
	\n\
	return true;\n\
end\n\
function Mage_Down_Shot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	--ODS(\"Mage_Down_Shot_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	ODS(\"123\\n\")\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		--action:SetSlot(2)\n\
		--action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end		\n\
\n\
	if action:GetEnable() == true then\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		actionID == \"a_run\" then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Mage_Down_Shot_DoEffect(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	ODS(\"Mage_Down_Shot_DoEffect iAttackRange:\"..iAttackRange..\"\\n\");\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	\n\
	for i = 1, 3 do\n\
		local	kArrow = Mage_Down_Shot_LoadArrowToWeapon(actor,action);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			kArrow:SetParamValue(\"CNT\", tostring(i))\n\
			\n\
			if i == 2 then\n\
				kArrow:SetParamValue(\"NON_TARGET\", \"FALSE\")\n\
			else\n\
				kArrow:SetParamValue(\"NON_TARGET\", \"TRUE\")\n\
			end\n\
			\n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			local	kPos = actor:GetPos();\n\
			local	kMovingDir = actor:GetLookingDir();\n\
			local	kGab = iAttackRange / 2;\n\
			kMovingDir:Multiply(iAttackRange + ((i - 2) * kGab) + math.random(-10,10));\n\
			kPos:Add(kMovingDir);\n\
			kPos:SetZ(kPos:GetZ()-20);		\n\
			\n\
			local	kPos2 = g_world:ThrowRay(kPos,Point3(0,0,-1),500);	--	  \n\
			\n\
			ODS(\"___________TargetLoc : \" .. kPos2:GetX() .. \" , \" .. kPos2:GetY() .. \", \" .. kPos2:GetZ() .. \"\\n\")\n\
\n\
			\n\
			local	iTargetCount = action:GetTargetCount();\n\
			\n\
			actor:LookAt(kPos);\n\
		\n\
			kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
			\n\
			if iTargetCount>0 then\n\
				kArrow:SetTargetObjectList(action:GetTargetList());	\n\
			end\n\
\n\
			if kPos2:GetX() == -1 and \n\
				kPos2:GetY() == -1 and\n\
				kPos2:GetZ() == -1 then\n\
				kPos2 = g_world:ThrowRay(actor:GetPos(), Point3(0,0,-1), 500)\n\
			end\n\
\n\
			kArrow:SetTargetLoc(kPos2);		\n\
			kArrow:Fire();\n\
		\n\
		end\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Mage_Down_Shot_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	--ODS(\"Mage_Down_Shot_OnEvent key : \"..textKey..\"\\n\");\n\
	if (textKey == \"fire\" or textKey==\"hit\") and actor:GetAction():GetParam(4)~=\"HIT\" then\n\
		\n\
		Mage_Down_Shot_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Skill_Tornado_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Tornado_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Tornado_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Tornado_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Tornado_Fire\\n\");\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor);\n\
	end\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
			\n\
	actor:StartWeaponTrail();\n\
end\n\
function Skill_Tornado_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100 \n\
	end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	--local	fBackDistance = 10;\n\
	kDir:Multiply(iAttackRange);\n\
	kPos:Add(kDir);\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local   kGroundPos = g_world:ThrowRay(Point3(kPos:GetX(),kPos:GetY(),kPos:GetZ()+50.0),Point3(0,0,-1),100);\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 80\n\
	end\n\
    \n\
	local kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(kGroundPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,30,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	local iTargets = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
	\n\
end\n\
\n\
function Skill_Tornado_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Tornado_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Tornado_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Tornado_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Tornado_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Skill_Tornado_ReallyLeave\\n\");\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Skill_Tornado_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Tornado_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
	if kActionResult:GetCritical() then\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
	else\n\
		actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
	end	\n\
	\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	\n\
	--   \n\
	local actionName = kActionID\n\
	if kActionResult:GetCritical() then\n\
		actionName = \"Critical_dmg\"\n\
	end\n\
	actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, kActionTargetInfo);\n\
\n\
end\n\
\n\
function Skill_Tornado_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    ODS(\"Skill_Tornado_HitOneTime\\n\");\n\
    \n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	kDir:Multiply(iAttackRange);\n\
	kPos:Add(kDir);\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local   kGroundPos = g_world:ThrowRay(Point3(kPos:GetX(),kPos:GetY(),kPos:GetZ()+50.0),Point3(0,0,-1),100);\n\
	if kGroundPos:GetX() == -1 then\n\
	    kGroundPos = kPos;\n\
    end\n\
    \n\
    actor:AttachParticleToPoint(8111,kGroundPos,\"ef_Tornado_char_root\");\n\
	    \n\
	\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
		\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Tornado_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParamInt(2) > 0 then\n\
        \n\
            --  hit  \n\
            --    .\n\
            SkillHelpFunc_DefaultHitOneTime(actor,action, false);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
function Skill_Tornado_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
		\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if IsSingleMode() then\n\
					Skill_Tornado_OnTargetListModified(actor,kAction,false)\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end			\n\
			\n\
			end	\n\
			\n\
		end\n\
\n\
        Skill_Tornado_HitOneTime(actor,kAction)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [ATTACK_TIME] :    \n\
\n\
function Skill_BackDraft_Fire_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
	\n\
	action:SetParamInt(7,0);\n\
	if(\"TRUE\" == action:GetScriptParam(\"NO_TICK_ATTACK\") ) then\n\
		action:SetParamInt(8,1);\n\
	end\n\
	\n\
	local kTime = actor:GetAbil(AT_LIFETIME)\n\
	if 0~= kTime then\n\
		kTime = kTime + 2000	-- 2  \n\
		action:SetParamFloat(10, action:GetParamFloat(1)+kTime*0.001)\n\
	else\n\
		action:SetParamFloat(10, 0)\n\
	end\n\
	\n\
	if(\"TRUE\" == action:GetScriptParam(\"DARK_BG\") ) then\n\
		local kMyPilot = actor:GetPilot()\n\
		if not kMyPilot:IsNil() then 	\n\
			local kMyUnit = kMyPilot:GetUnit()\n\
			if not kMyUnit:IsNil() then \n\
				local kCallerPilot = g_pilotMan:FindPilot(kMyUnit:GetCaller())\n\
				if not kCallerPilot:IsNil() then \n\
					local kCallerActor = kCallerPilot:GetActor()\n\
					if not kCallerActor:IsNil() then\n\
						SkillHelpFunc_MakeDarkBG(kCallerActor)\n\
					end	\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 3.0;\n\
    end	\n\
	action:SetParamFloat(30, fLifeTime)\n\
	\n\
	local fAttackTickTime = tonumber(action:GetScriptParam(\"ATTACK_TIME\"));\n\
	if fAttackTickTime == nil then\n\
		local iMaxHitCount = action:GetAbil(AT_COUNT)\n\
		ODS(\"iMaxHitCount:\"..iMaxHitCount..\"\\n\", false, 912)\n\
		if(0 == iMaxHitCount) then 			\n\
			fAttackTickTime = 0.3;\n\
		else\n\
			fAttackTickTime = fLifeTime/iMaxHitCount\n\
		end\n\
	end\n\
	\n\
	action:SetParamFloat(40, fAttackTickTime)\n\
	action:SetParamInt(20, 0)\n\
	\n\
	local iMaxHitCount = action:GetAbil(AT_COUNT)\n\
	ODS(\"iMaxHitCount:\"..iMaxHitCount..\"\\n\", false, 912)\n\
	actor:FreeMove(true)	\n\
	return true\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	kParam:SetParam_1(kPos,kDir);\n\
   	kParam:SetParam_2(iAttackRange,30,50,0);\n\
\n\
	local strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
	\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(iAttackRange,30,50,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(iAttackRange,60,50,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
	    iFindTargetType = TAT_SPHERE;\n\
    	kParam:SetParam_1(kPos,kDir);\n\
    	kParam:SetParam_2(0,0,50,0);\n\
	end\n\
	\n\
	return action:FindTargets(iFindTargetType,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		if action:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
		else\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
		end\n\
		\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end			\n\
    end\n\
\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(7);\n\
\n\
	local   fLifeTime = action:GetParamFloat(30)\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 3.0;\n\
    end	\n\
	\n\
	local fAttackTickTime = action:GetParamFloat(40)\n\
	local iMaxHitCount = action:GetAbil(AT_COUNT)\n\
	if fAttackTickTime == nil then\n\
		ODS(\"iMaxHitCount:\"..iMaxHitCount..\"\\n\", false, 912)\n\
		if(0 == iMaxHitCount) then 			\n\
			fAttackTickTime = 0.3;\n\
		else\n\
			fAttackTickTime = fLifeTime/iMaxHitCount\n\
		end\n\
	end\n\
	\n\
	local iHitCount = action:GetParamInt(20);\n\
	\n\
	local   fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
	if(0 == action:GetParamInt(8)) then\n\
		if fElapsedTIme > fAttackTickTime \n\
			and iHitCount < iMaxHitCount\n\
		then\n\
						\n\
			action:SetParamInt(20, iHitCount + 1); --   .\n\
			action:SetParamFloat(1,accumTime);\n\
			action:CreateActionTargetList(actor);\n\
			\n\
			if IsSingleMode() or action:GetTargetCount() == 0 then\n\
			\n\
				Skill_BackDraft_Fire_OnTargetListModified(actor,action,false);\n\
			\n\
			else\n\
			\n\
				action:BroadCastTargetListModify(actor:GetPilot());\n\
				action:ClearTargetList();\n\
			\n\
			end\n\
			\n\
		end\n\
	end\n\
	\n\
	if iSlotNum == 0 then\n\
		local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
		if fTotalElapsedTime > fLifeTime then\n\
			actor:PlayNext();\n\
		end\n\
\n\
	elseif iSlotNum == 1 then\n\
	\n\
		if iState == 0 then\n\
			action:SetParamInt(7,1);\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
		end\n\
	end\n\
\n\
	if iState == 1 then\n\
		if accumTime - action:GetParamFloat(6) > 0.4 then\n\
			action:SetParamFloat(6,g_world:GetAccumTime());\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.7);\n\
			action:SetParamInt(7,2);\n\
		end\n\
	elseif iState == 2 then\n\
		if accumTime - action:GetParamFloat(6) > 1.0 then\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	if(0 < action:GetParamFloat(10) ) then\n\
		if accumTime > action:GetParamFloat(10) then\n\
			g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())	-- \n\
			return false\n\
		end\n\
	end\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iSlotNum = action:GetCurrentSlot();\n\
\n\
	if iSlotNum == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_BackDraft_Fire_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end	\n\
	\n\
	if \"hit\" == textKey or \"fire\" == textKey then\n\
		local iMaxHitCount = kAction:GetAbil(AT_COUNT)\n\
		\n\
		local iHitCount = kAction:GetParamInt(20);\n\
		if( iHitCount >= iMaxHitCount ) then return end\n\
		\n\
		kAction:SetParamInt(20, iHitCount + 1); --   .\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			\n\
			kAction:CreateActionTargetList(actor);\n\
			if IsSingleMode() then		        \n\
				SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
				Skill_BackDraft_Fire_OnTargetListModified(actor,kAction,false)		            \n\
				return;\n\
			else\n\
				local	kTargetList = kAction:GetTargetList();\n\
				local	iTargetCount = kTargetList:size();\n\
\n\
				if 0 < iTargetCount then\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				end\n\
			end			\n\
			\n\
		end\n\
\n\
		kAction:ClearTargetList();\n\
	elseif \"fade_out\" == textKey then\n\
		actor:SetTargetAlpha(actor:GetAlpha(), 0, 0.5)\n\
				\n\
		if(\"TRUE\" == kAction:GetScriptParam(\"DARK_BG\") ) then\n\
			local kMyPilot = actor:GetPilot()\n\
			if not kMyPilot:IsNil() then 	\n\
				local kMyUnit = kMyPilot:GetUnit()\n\
				if not kMyUnit:IsNil() then \n\
					local kCallerPilot = g_pilotMan:FindPilot(kMyUnit:GetCaller())\n\
					if not kCallerPilot:IsNil() then \n\
						local kCallerActor = kCallerPilot:GetActor()\n\
						if not kCallerActor:IsNil() then\n\
							SkillHelpFunc_RemoveDarkBG(kCallerActor)\n\
						end	\n\
					end\n\
				end\n\
			end\n\
		end\n\
		\n\
	end	\n\
		\n\
	return	true;\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_SnowBlues_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	SkillFunc_InitUseDmgEffect(action);\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());	\n\
	action:SetParamFloat(2,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(3, 0);\n\
	action:SetParamFloat(8, 90);\n\
	action:SetParamFloat(10,g_world:GetAccumTime());	-- \n\
\n\
	--actor:AttachParticleToPoint(7212,actor:GetPos(),\"ef_SnowBlues_01\");\n\
	actor:AttachParticle(7212,\"char_root\",\"ef_SnowBlues_01\");\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_SnowBlues_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_SnowBlues_Play_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        --Skill_SnowBlues_DoDamage(actor,action,0,false);\n\
		--action:GetTargetList():ApplyActionEffects();    \n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_SnowBlues_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iCurrentSlot = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(3);\n\
	\n\
	local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
	local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
	if fMoveSpeed == 0 then\n\
	    fMoveSpeed = action:GetParamFloat(8);\n\
	end\n\
	\n\
	if iState == 0 then\n\
		kMoveDir:Multiply(fMoveSpeed);	\n\
		actor:SetMovingDelta(kMoveDir);\n\
\n\
		local   fElapsedTIme = accumTime - action:GetParamFloat(2);\n\
		if fElapsedTIme>0.1 then\n\
			action:GetParamFloat(2, accumTime);\n\
			action:SetParamFloat(8, action:GetParamFloat(8) - 0.5);\n\
			\n\
			if 0 > action:GetParamInt(8) then\n\
				action:SetParamInt(8, 0);\n\
			end\n\
		end\n\
	\n\
\n\
		if iCurrentSlot == 0 then -- \n\
			local   fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
			if fElapsedTIme>0.6 then	\n\
				action:SetParamFloat(1,accumTime);\n\
				action:SetSlot(1);\n\
				actor:PlayCurrentSlot();\n\
			end\n\
		elseif  iCurrentSlot == 1 then -- \n\
			if animDone == true then\n\
				action:SetParamFloat(1,accumTime);\n\
				action:SetSlot(2);\n\
				actor:PlayCurrentSlot();\n\
			end\n\
		end\n\
			local   fElapsedTIme10 = accumTime - action:GetParamFloat(10)\n\
			if fElapsedTIme10>0.3 then\n\
		\n\
				action:SetParamFloat(10,accumTime)\n\
				action:CreateActionTargetList(actor);\n\
			    \n\
				if IsSingleMode() or action:GetTargetCount() == 0 then\n\
			    \n\
					Skill_SnowBlues_Play_OnTargetListModified(actor,action,false);\n\
			    \n\
				else\n\
			    \n\
					action:BroadCastTargetListModify(actor:GetPilot());\n\
					action:ClearTargetList();\n\
			    \n\
				end\n\
			end\n\
\n\
		\n\
	elseif iState == 1 then\n\
		local   fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
		if fElapsedTIme>0.3 then\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.5);\n\
			action:SetParamInt(3, 2);\n\
		end\n\
	end\n\
\n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 2.0;\n\
    end	\n\
\n\
    local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
\n\
	if iState == 0 and iCurrentSlot == 2 then --    \n\
		if fLifeTime - fTotalElapsedTime < 3.6 then			\n\
			action:SetParamInt(3, 1);\n\
			actor:SetHideShadow(true);\n\
		end\n\
	end\n\
    \n\
\n\
    if fTotalElapsedTime > fLifeTime then\n\
        return  false\n\
    end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_SnowBlues_Play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_SnowBlues_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
--[[\n\
function Skill_SnowBlues_DoDamage(actor, action,fAttackHoldingTime,bNoHold)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local	iTargetCount = action:GetTargetCount();\n\
\n\
	if 	iTargetCount == 0 then\n\
		return true;\n\
	end\n\
\n\
	local	i = 0;\n\
	\n\
	if bNoHold == nil then\n\
	    bNoHold = false\n\
	end\n\
		\n\
	if fAttackHoldingTime == nil or fAttackHoldingTime == 0 then\n\
		fAttackHoldingTime = g_fAttackHitHoldingTime;\n\
	end\n\
	\n\
	local bWeaponSoundPlayed = false;\n\
	\n\
	while i<iTargetCount do\n\
		\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			\n\
			local	actorTarget = kTargetPilot:GetActor();\n\
			if actorTarget:IsNil() == false and actorTarget:GetPilotGuid() ~= actor:GetPilotGuid() then\n\
			\n\
				local kActionResult = action:GetTargetActionResult(i);\n\
				\n\
				if kActionResult:IsMissed() == false then\n\
	\n\
	                if bWeaponSoundPlayed == false then\n\
	                    bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID()\n\
						if kActionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
						actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end	\n\
                    				\n\
--					local	kActionTargetInfo = action:GetTargetInfo(i);	\n\
					\n\
					local	iSphereIndex = action:GetTargetABVShapeIndex(i);\n\
					local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex);		\n\
\n\
					local bCri = kActionResult:GetCritical()\n\
					local DamageEff = actor:GetDamageEffectID(bCri)\n\
					if nil==DamageEff or 0==string.len(DamageEff) then\n\
						if bCri then\n\
							DamageEff = \"e_dmg_cri\"\n\
						else\n\
							DamageEff = \"e_dmg\"\n\
						end\n\
					end\n\
					actorTarget:AttachParticleToPoint(12, pt, DamageEff)\n\
					--actorTarget:AttachParticleToPointS(13, actorTarget:GetNodeWorldPos(\"char_root\"), \"ef_Blizzard_00002\",2.0)\n\
					actorTarget:AttachParticleToPointWithRotate(13, actorTarget:GetNodeWorldPos(\"char_root\"),\"ef_Blizzard_00002\", Quaternion(math.random(0,360), Point3(0,0,1)), 2);\n\
\n\
--					local	atAction = actorTarget:GetAction()\n\
					\n\
--					local	guidPilot = actorTarget:GetPilotGuid()\n\
--					local	pilot = g_pilotMan:FindPilot(guidPilot)\n\
					\n\
					local iHoldingTime = fAttackHoldingTime * 1000;\n\
					local	iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
					\n\
					--   \n\
					if bNoHold == false then\n\
					    actor:SetAnimSpeedInPeriod(0.00001,iHoldingTime);\n\
					end\n\
					\n\
					actor:SetShakeInPeriod(5,iShakeTime/2);\n\
					actorTarget:SetShakeInPeriod(5,iShakeTime);		\n\
					\n\
				end\n\
\n\
			end\n\
		end\n\
		\n\
		i = i + 1;\n\
		\n\
	end\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects();\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
]]\n\
function Skill_SnowBlues_Play_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("function Skill_Energy_Ball_Play_OnCastingCompleted(actor, action)\n\
\n\
end\n\
\n\
function Skill_Energy_Ball_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(3, 0);\n\
\n\
	if actor:IsUnderMyControl() then\n\
		local kSkillDef = GetSkillDef(action:GetActionNo());\n\
		local fTickTime = 0.5;\n\
		if kSkillDef:IsNil() == false then\n\
			local iNeedBaseSkill = kSkillDef:GetAbil(AT_CHILD_SKILL_NUM_01);\n\
			local iUpgradeSkill = actor:CheckSkillExist(iNeedBaseSkill);\n\
\n\
			if 0 ~= iUpgradeSkill then\n\
				local kChildSkillDef = GetSkillDef(iUpgradeSkill);\n\
				fTickTime = fTickTime + kChildSkillDef:GetAbil(AT_ADD_TICK_ATTACK_TIME)/1000.0; \n\
				if fTickTime <= 0.3 then\n\
					fTickTime = 0.3;\n\
				end\n\
			end\n\
		end\n\
		\n\
		action:SetParamFloat(100,fTickTime);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Energy_Ball_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 50\n\
	end	\n\
\n\
	local tat_type = TAT_SPHERE\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	if 0==action:GetAbil(AT_1ST_AREA_TYPE) then\n\
		kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	else\n\
		kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
		tat_type = TAT_BAR\n\
	end\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(tat_type,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Energy_Ball_Play_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_Energy_Ball_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
--	local iCurrentSlot = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(3);\n\
	\n\
	local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
	local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
	if fMoveSpeed == 0 then\n\
	    fMoveSpeed = 50\n\
    end\n\
	\n\
	kMoveDir:Multiply(fMoveSpeed);	\n\
	actor:SetMovingDelta(kMoveDir);\n\
\n\
	if iState == 0 then\n\
		local fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
		if actor:IsUnderMyControl() then\n\
			local fTickTime = action:GetParamFloat(100);\n\
\n\
			if fTickTime == nil then\n\
				fTickTime = 0.5;\n\
			end\n\
			\n\
			if fElapsedTIme > fTickTime then\n\
\n\
				action:SetParamFloat(1,accumTime);\n\
				action:CreateActionTargetList(actor);\n\
			    \n\
				if IsSingleMode() or action:GetTargetCount() == 0 then\n\
					Skill_Energy_Ball_Play_OnTargetListModified(actor,action,false);	    \n\
				else		    \n\
					action:BroadCastTargetListModify(actor:GetPilot());\n\
					action:ClearTargetList();\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 2.0;\n\
    end	\n\
\n\
    local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
\n\
	if iState == 0 then\n\
		if fLifeTime - fTotalElapsedTime < 1.5 then\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0, 0.5);\n\
			action:SetParamInt(3, 1);\n\
			actor:SetHideShadow(true);\n\
		end\n\
	end    \n\
\n\
    if fTotalElapsedTime > fLifeTime then\n\
        return  false\n\
    end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Energy_Ball_Play_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_Energy_Ball_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function	Skill_Valcan300_Play_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	if( CheckNil(kNewArrow == nil) ) then return false end\n\
	if( CheckNil(kNewArrow:IsNil()) ) then return false end\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
\n\
end\n\
\n\
function Skill_Valcan300_Play_FindTarget(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
	\n\
	local	kTargets = CreateActionTargetList(actor:GetPilotGuid(),action:GetActionInstanceID(),action:GetActionNo());\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	\n\
    kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    kParam:SetParam_2(action:GetSkillRange(0,actor),60,0,0);\n\
    kParam:SetParam_3(true,FTO_NORMAL);            	\n\
    \n\
    local iFoundNum = action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
    \n\
    if iFoundNum == 0 then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetInfo = kTargets:GetTargetInfo(0);\n\
	if kTargetInfo:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetGUID = kTargetInfo:GetTargetGUID();\n\
	if kTargetGUID:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
	if kTargetPilot:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	local	kTargetActor = kTargetPilot:GetActor();\n\
	if kTargetActor:IsNil() then\n\
		return	nil\n\
	end\n\
    \n\
    DeleteActionTargetList(kTargets);\n\
    \n\
    return  kTargetActor;\n\
end\n\
\n\
function Skill_Valcan300_Play_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	actor:LockBidirection(false);\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	\n\
	--actor:AttachSound(120,\"AutoShootSystem1\");\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
	\n\
	action:SetParamInt(2,1)\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local kEffectDef = GetEffectDef(action:GetActionNo());\n\
	if( CheckNil(kEffectDef == nil) ) then return false end\n\
	if( CheckNil(kEffectDef:IsNil()) ) then return false end\n\
	\n\
	local fDurationTime = kEffectDef:GetDurationTime()/1000.0;\n\
	action:SetParamFloat(8, fDurationTime); --   \n\
	action:SetParamFloat(9, g_world:GetAccumTime()); --  \n\
	action:SetParamFloat(10, g_world:GetAccumTime()); --  \n\
	actor:SetParam(\"End\",\"FALSE\"); --     \n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_Valcan300_Play_GetAimingTarget(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	if action:GetTotalGUIDInContainer() == 0 then\n\
		return nil;\n\
	end\n\
	\n\
	local	kTargetGUID = action:GetGUIDInContainer(0);\n\
	if kTargetGUID:IsNil() then\n\
		return	nil;\n\
	end\n\
	\n\
	local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
	if kTargetPilot:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	local	kTargetActor = kTargetPilot:GetActor();\n\
	if kTargetActor:IsNil() then\n\
		return	nil\n\
	end\n\
	\n\
	return	kTargetActor;\n\
\n\
end\n\
function Skill_Valcan300_Play_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Valcan300_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	if bIsBefore == false then\n\
		ODS(\"Skill_Valcan300_Play_OnTargetListModified\\n\");\n\
--		Skill_Valcan300_Play_FireToTarget(actor,action);\n\
	end\n\
\n\
end\n\
\n\
function Skill_Valcan300_Play_FireToTarget(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	actor:ResetAnimation();\n\
	action:SetSlot(1)\n\
	actor:PlayCurrentSlot();\n\
\n\
	--actor:LookAt(Point3(action:GetParamFloat(7),action:GetParamFloat(8),action:GetParamFloat(9)),true,false,true);\n\
end\n\
\n\
function Skill_Valcan300_Play_BroadCastFire(actor,action,kTargetPos)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	action:SetParamInt(2,1)\n\
	\n\
	if IsSingleMode() then\n\
		Skill_Valcan300_Play_OnTargetListModified(actor,action,false)\n\
	else\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
end\n\
\n\
function Skill_Valcan300_Play_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
--	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(2);	\n\
	\n\
	if 1 == iState then\n\
		if accumTime - action:GetParamFloat(9) > 0.2 then\n\
			action:SetParamFloat(9, g_world:GetAccumTime());\n\
			action:SetParamInt(2,4)\n\
		end\n\
	elseif 4 == iState then\n\
		if accumTime - action:GetParamFloat(9) > 0.5 then\n\
			action:SetSlot(1);\n\
			actor:PlayCurrentSlot();\n\
			action:SetParamFloat(9, g_world:GetAccumTime());\n\
		end\n\
\n\
		if accumTime - action:GetParamFloat(10) > action:GetParamFloat(8) - 0.7 then\n\
			action:SetSlot(0);\n\
			actor:PlayCurrentSlot();\n\
			action:SetParamFloat(10, g_world:GetAccumTime());\n\
			action:SetParamInt(2,3)\n\
			actor:SetTargetAlpha(actor:GetAlpha(),0.0, 0.3);\n\
\n\
		end\n\
	end\n\
\n\
	ODS(\"Skill_Valcan300_Play_OnUpdate iState:\"..iState..\"\\n\");\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Valcan300_Play_OnCleanUp(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
\n\
--	if actor:IsUnderMyControl() then\n\
--		Net_C_M_REQ_DELETE_ENTITY(actor:GetPilotGuid());\n\
--	end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Valcan300_Play_OnLeave(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if actor:GetParam(\"End\") == \"TRUE\" then\n\
		return true;\n\
	end\n\
\n\
	return false;\n\
end\n\
\n\
function Skill_Valcan300_Play_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local kAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
\n\
	ODS(\"Skill_Valcan300_Play_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
\n\
		local	kProjectileMan = GetProjectileMan();\n\
		local	kArrow = Skill_Valcan300_Play_LoadToWeapon(actor,kAction);\n\
		\n\
		local	targetobject = nil;\n\
\n\
		if kArrow:IsNil() == false then\n\
\n\
			kAction:BroadCastTargetListModify(actor:GetPilot(),true);\n\
		\n\
			local	kMovingDir = Point3(0,0,0)\n\
			kMovingDir:SetX(kAction:GetParamFloat(4));\n\
			kMovingDir:SetY(kAction:GetParamFloat(5));\n\
			kMovingDir:SetZ(kAction:GetParamFloat(6));\n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			ODS(\"kMovingDir :\"..kMovingDir:GetX()..\",\"..kMovingDir:GetY()..\",\"..kMovingDir:GetZ()..\"\\n\");\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
						\n\
			-- \n\
			local iPentrationCount = kAction:GetAbil(AT_PENETRATION_COUNT);\n\
			kArrow:SetPenetrationCount(iPentrationCount);--   \n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			ODS(\"Arrow is nil\\n\");\n\
		end\n\
		\n\
		kAction:ClearTargetList();\n\
		actor:ClearIgnoreEffectList();\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Thrust_OnCheckCanEnter(actor,action)\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 1 then\n\
		return	false;\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Thrust_FindTarget(kActor,kAction)\n\
\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Skill_Thrust_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
	ODS(\"  : \" .. iFound .. \"\\n\")\n\
	\n\
	return	kTargets;\n\
end\n\
function Skill_Thrust_OnFindTarget(actor,action,kTargets)\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 15;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
   \n\
   local range = action:GetSkillRange(0,actor)\n\
   ODS(\"  : \" .. range .. \"\\n\")\n\
   if range <= 50 then\n\
		range =150\n\
	end\n\
	kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(range,30,0,10);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Thrust_OnCastingCompleted(actor, action)\n\
	Skill_Thrust_Fire(actor,action);\n\
\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_Thrust_OnEnter(actor, action)\n\
	local	actorID = actor:GetID()\n\
	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	action:SetParam(101,\"\");\n\
	\n\
	ODS(\"Skill_Thrust_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
	\n\
	actor:ResetAnimation();\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Thrust_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
function Skill_Thrust_Fire(actor,action)\n\
	\n\
	action:SetParamInt(5,1)\n\
		\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Thrust_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);	\n\
	end\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
	ODS(\"Skill_Thrust_Fire iTargetCount : \"..iTargetCount..\"\\n\");\n\
\n\
	local dis = 0\n\
	local lookNum = 0\n\
\n\
	for i = 0, iTargetCount - 1 do\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			pt:Subtract(actor:GetTranslate())\n\
			if dis < pt:Length() then\n\
				dis = pt:Length()\n\
				lookNum = i\n\
			end\n\
		end\n\
\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
			local tlist = action:GetTargetList()\n\
--			tlist:SwapPosition(0, lookNum)	--   \n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	Skill_Thrust_LoadArrowToWeapon(actor,action)\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	kNewArrow:LoadToWeapon(actor);	--	\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Thrust_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	local	actionID = action:GetID();\n\
\n\
	if action:GetParam(101) ==\"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Thrust_OnCleanUp(actor,action)\n\
\n\
	return true;\n\
end\n\
function Skill_Thrust_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
--	ODS(\"Skill_Thrust_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
\n\
	if actor:IsMyActor() == false or curAction:GetParam(101)==\"end\" then\n\
		return true;\n\
	end\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	if actionID == \"a_shot_01\" then\n\
		action:SetParam(0,\"Continue\");\n\
	end\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Thrust_DoEffect(actor)\n\
\n\
	local	action = actor:GetAction()\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	actor:AttachSound(7283,\"Thrust\");	\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = Skill_Thrust_LoadArrowToWeapon(actor,action);\n\
	\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
		local dis = 0\n\
		local lookNum = 0\n\
\n\
		for i = 0, iTargetCount -1 do\n\
			local	kTargetGUID = action:GetTargetGUID(i);\n\
			local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
			if targetobject:IsNil() == false then\n\
				local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				pt:Subtract(actor:GetTranslate())\n\
				ODS(\" : \" .. pt:Length() .. \" i : \" .. i .. \"\\n\")\n\
				if dis < pt:Length() then\n\
					dis = pt:Length()\n\
					lookNum = i\n\
				end\n\
			end\n\
\n\
		end\n\
	\n\
		if iTargetCount>0 then\n\
				--	  \n\
			ODS(\" : \" .. lookNum .. \"\\n\")\n\
			local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
			iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
			kActionTargetInfo = action:GetTargetInfo(lookNum);\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
				local tlist = action:GetTargetList()\n\
				--tlist:SwapPosition(0, lookNum)\n\
			end						\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
		else\n\
			kArrow:SetTargetObjectList(action:GetTargetList());	\n\
		end\n\
		\n\
		kArrow:Fire();\n\
		\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Skill_Thrust_OnEvent(actor, textKey)\n\
	ODS(\"Skill_Thrust_OnEvent key : \"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		\n\
		Skill_Thrust_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Arrow_Shower_OnCastingCompleted(actor,action)\n\
	\n\
	Skill_Arrow_Shower_Fire(actor,action)\n\
\n\
 	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
   ODS(\"Skill_Arrow_Shower_OnCastingCompleted \\n\")\n\
end\n\
\n\
function Skill_Arrow_Shower_OnCheckCanEnter(actor,action)\n\
   ODS(\"Skill_Arrow_Shower_OnCheckCanEnter \\n\")\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
   ODS(\"Skill_Arrow_Shower_OnCheckCanEnter OK! \\n\")\n\
	return		true;\n\
	\n\
end\n\
function Arrow_Shower_FindTarget(kActor,kAction)\n\
\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Skill_Arrow_Shower_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
   ODS(\"   : \" .. iFound .. \"\\n\")\n\
	\n\
	return	kTargets;\n\
end\n\
function Skill_Arrow_Shower_OnFindTarget(actor,action,kTargets)\n\
	local range = action:GetSkillRange(0,actor)\n\
\n\
	local	kPos = actor:GetPos();\n\
	local 	kOrigin = kPos\n\
	local	kDir = actor:GetLookingDir();\n\
	kDir:Multiply(range) -- cm  \n\
	kPos:Add(kDir)\n\
	local range2 = action:GetAbil((AT_CUSTOMDATA1))\n\
\n\
   	kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(range,360,range2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Arrow_Shower_OnEnter(actor, action)\n\
	local	actorID = actor:GetID()\n\
	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	action:SetParamInt(6,0);\n\
	\n\
	ODS(\"Skill_Arrow_Shower_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
	\n\
	--  \n\
	local range = action:GetSkillRange(0,actor)\n\
	ODS(\"   : \" .. range .. \"\\n\")\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	kDir:Multiply(range)\n\
	kPos:Add(kDir)\n\
	local ptpoint = Point3(kPos:GetX(), kPos:GetY(), kPos:GetZ() + 100)\n\
  ODS(\"OnEnter ptpoint X : \" ..ptpoint:GetX().. \" Y : \" ..ptpoint:GetY().. \" Z : \" ..ptpoint:GetZ().. \"\\n\")\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local ptcl = g_world:ThrowRay(ptpoint, Point3(0,0,-1), 200)\n\
  if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
     ODS(\" \\n\")\n\
  end\n\
	ptcl:SetZ(ptcl:GetZ()+5)\n\
	actor:AttachParticleToPoint(1508, ptcl, \"ef_arrow_shower_ring\")\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	Skill_Arrow_Shower_OnCastingCompleted(actor,action);\n\
		\n\
	return true\n\
end\n\
function Skill_Arrow_Shower_Fire(actor,action)\n\
	\n\
	 action:SetParamInt(5,1)\n\
	 	\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Arrow_Shower_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);\n\
	end\n\
\n\
	actor:AttachSound(2785,\"ArrowShower_Start\");\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	Skill_Arrow_Shower_LoadArrowToWeapon(actor,action)\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = action:GetScriptParam(\"ATTACH_NODE\");	\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Arrow_Shower_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	local	actionID = action:GetID();\n\
\n\
	if animDone == true then\n\
				\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Arrow_Shower_OnCleanUp(actor,action)\n\
	\n\
	return true;\n\
end\n\
function Skill_Arrow_Shower_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	ODS(\"Skill_Arrow_Shower_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Arrow_Shower_DoEffect(actor)\n\
\n\
	ODS(\"Skill_Arrow_Shower_DoEffect \\n\");\n\
\n\
	local	action = actor:GetAction()\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = Skill_Arrow_Shower_LoadArrowToWeapon(actor,action);\n\
	\n\
	local	targetobject = nil;\n\
	\n\
	if kArrow:IsNil() then\n\
		ODS(\"kArrow:IsNil() iProjectileUID : \"..iProjectileUID..\" action : \"..action:GetID()..\"\\n\");\n\
	end\n\
\n\
\n\
	if kArrow:IsNil() == false then\n\
		kArrow:SetMovingType(1)\n\
		kArrow:SetParam_SinCurveLineType(300, 0)\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
      ODS(\"actor:GetLookingDir() : \" ..kMovingDir:GetX().. \" Y : \" ..kMovingDir:GetY().. \" Z : \" ..kMovingDir:GetZ().. \"\\n\")\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
      ODS(\"kArrow:GetWorldPos() : \" ..arrow_worldpos:GetX().. \" Y : \" ..arrow_worldpos:GetY().. \" Z : \" ..arrow_worldpos:GetZ().. \"\\n\")\n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
 	\n\
      if iTargetCount > 0 then\n\
         kArrow:SetTargetObjectList(action:GetTargetList());	\n\
      end\n\
     \n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
      ODS(\"iAttackRange : \" .. iAttackRange .. \"\\n\")\n\
		kMovingDir:Multiply(iAttackRange);\n\
		kMovingDir:Add(actor:GetPos());\n\
\n\
		local ptpoint = Point3(kMovingDir:GetX(), kMovingDir:GetY(), kMovingDir:GetZ() + 100)\n\
      ODS(\"ptpoint X : \" ..ptpoint:GetX().. \" Y : \" ..ptpoint:GetY().. \" Z : \" ..ptpoint:GetZ().. \"\\n\")\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(ptpoint, Point3(0,0,-1), 200)\n\
		ptcl:SetZ(ptcl:GetZ()+5)\n\
\n\
		kArrow:SetTargetLoc(ptcl);	\n\
      ODS(\"   X : \" ..ptcl:GetX().. \" Y : \" ..ptcl:GetY().. \" Z : \" ..ptcl:GetZ().. \"\\n\")\n\
		\n\
		kArrow:Fire();\n\
		\n\
	end\n\
	\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Skill_Arrow_Shower_OnEvent(actor, textKey)\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		local kAction = actor:GetAction();\n\
		if kAction:GetParamInt(6) ~= 0 then\n\
			return true;\n\
		end\n\
		kAction:SetParamInt(6,1);\n\
\n\
		Skill_Arrow_Shower_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Daepodong_OnCheckCanEnter(actor,action)\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Daepodong_FindTarget(kActor, kAction)\n\
\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Skill_Daepodong_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
	ODS(\" 1  : \" .. iFound .. \"\\n\")\n\
	\n\
	return	kTargets;\n\
end\n\
function Skill_Daepodong_OnFindTarget(actor,action,kTargets)\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(iAttackRange);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ());		\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 71\n\
	end\n\
	\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,30,iParam2,0);	--    \n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
	if 5 == iSkillLevel then\n\
		kParam:SetParam_3(true,FTO_NORMAL + FTO_BLOWUP);\n\
	end\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)\n\
end\n\
\n\
function Skill_Daepodong_OnCastingCompleted(actor, action)\n\
	Skill_Daepodong_Fire(actor,action)\n\
\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_Daepodong_OnEnter(actor, action)\n\
	local	actorID = actor:GetID()\n\
	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	action:SetParam(101,\"\");\n\
	action:SetParam(4,\"\");\n\
\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	\n\
	ODS(\"Skill_Daepodong_OnEnter weapontype : \"..weapontype..\"\\n\");\n\
\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Daepodong_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
function Skill_Daepodong_Fire(actor,action)\n\
	\n\
	action:SetParamInt(5,1)	\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Daepodong_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);	\n\
	end\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
	ODS(\"Skill_Daepodong_Fire iTargetCount : \"..iTargetCount..\"\\n\");\n\
\n\
	local dis = 0\n\
	local lookNum = 0\n\
\n\
	for i = 0, iTargetCount - 1 do\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			pt:Subtract(actor:GetTranslate())\n\
			if dis < pt:Length() then\n\
				dis = pt:Length()\n\
				lookNum = i\n\
			end\n\
		end\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	actor:AttachSound(2785,\"Deapodong_Start\");\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	Skill_Daepodong_LoadArrowToWeapon(actor,action)\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = action:GetScriptParam(\"ATTACH_NODE\");	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	local	kPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	local	iRandom = math.random(-200,200);\n\
	if iRandom == 0 then\n\
		iRandom = 1;\n\
	end\n\
\n\
	kMovingDir:Multiply(iAttackRange+iRandom);\n\
	kPos:Add(kMovingDir);\n\
	kPos:SetZ(kPos:GetZ()+500);\n\
\n\
	local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
	if 0 == iSkillLevel then\n\
		iSkillLevel = 1;\n\
	end\n\
	kNewArrow:SetScale(0.2 + (iSkillLevel * 0.16)); --    .  1\n\
	kNewArrow:SetWorldPos(kPos);\n\
	kNewArrow:SetParamValue(\"SkillLevel\", \"\"..iSkillLevel);\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Daepodong_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	local	actionID = action:GetID();\n\
\n\
	if action:GetParam(101) ==\"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Daepodong_OnCleanUp(actor,action)\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	return true;\n\
end\n\
function Skill_Daepodong_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
--	ODS(\"Skill_Daepodong_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
\n\
	if actor:IsMyActor() == false or curAction:GetParam(101)==\"end\" then\n\
		return true;\n\
	end\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end		\n\
\n\
	if action:GetEnable() == true then\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Daepodong_DoEffect(actor)\n\
	\n\
	if \"HIT\" ==	 actor:GetAction():GetParam(4) then\n\
		ODS(\"\\n\");\n\
		return;\n\
	end\n\
\n\
	actor:SetNormalAttackEndTime();\n\
\n\
	local	action = actor:GetAction()\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = Skill_Daepodong_LoadArrowToWeapon(actor,action);\n\
	\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		local	kPos = actor:GetPos();\n\
		local	kMovingDir = actor:GetLookingDir();\n\
		kMovingDir:Multiply(iAttackRange);\n\
		kPos:Add(kMovingDir);\n\
		kPos:SetZ(kPos:GetZ()-20);		\n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
		\n\
		actor:LookAt(kPos);\n\
	\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		if iTargetCount>0 then\n\
			kArrow:SetTargetObjectList(action:GetTargetList());	\n\
		end\n\
\n\
		kArrow:SetTargetLoc(kPos);		\n\
		kArrow:Fire();\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1), 100)\n\
		ptcl:SetZ(ptcl:GetZ()+5)\n\
\n\
			 local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
		if 0 == iSkillLevel then\n\
			iSkillLevel = 1;\n\
		end\n\
		actor:AttachParticleToPointS(13,ptcl,\"ef_Roketlauncher_01\", iSkillLevel);\n\
		\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Skill_Daepodong_OnEvent(actor, textKey)\n\
	ODS(\"Skill_Daepodong_OnEvent key : \"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		\n\
		Skill_Daepodong_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Cushion_OnCheckCanEnter(actor,action)\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 1 then\n\
		return	false;\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
function Cushion_FindTarget(kActor, kAction)\n\
\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Skill_Cushion_OnFindTarget(kActor,kAction,kTargets);\n\
\n\
	ODS(\"  : \" .. iFound .. \"\\n\")\n\
	\n\
	return	kTargets;\n\
end\n\
function Skill_Cushion_OnFindTarget(actor,action,kTargets)\n\
	local range1 = action:GetSkillRange(0,actor)\n\
\n\
\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 15;\n\
	kDir:Multiply(-fBackDistance);\n\
	kPos:Add(kDir);\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(range1,30,0,1);	--    \n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	local i = action:FindTargets(0,kParam,kTargets,kTargets)\n\
	if i > 0 then\n\
      local info = kTargets:GetTargetInfo(0)\n\
      local	kTargetGUID = info:GetTargetGUID();\n\
      local targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
      local iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
      if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex)\n\
\n\
         kParam:SetParam_1(pt,targetobject:GetActor():GetLookingDir())\n\
         local targetNum = action:GetAbil(AT_MAX_TARGETNUM)\n\
         if targetNum < 3 then\n\
            targetNum = 3\n\
         end\n\
\n\
         local range = action:GetAbil(AT_CUSTOMDATA1)\n\
         if range <= 47.244095 then\n\
            range = 47.244095\n\
         end\n\
         kParam:SetParam_2(0,360,range,targetNum);	--   \n\
         kParam:SetParam_3(true,FTO_NORMAL);\n\
         kTargets:clear()\n\
         i = action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)	--2 =>TAT_SPHERE\n\
      end\n\
	end\n\
\n\
   ODS(\"  GUID \\n\")\n\
   for k=0,i-1 do\n\
      ODS(k)\n\
      kTargets:GetTargetInfo(k):GetTargetGUID():ODS()\n\
   end\n\
   ODS(\"-----------------\\n\")\n\
	\n\
	return	i\n\
end\n\
\n\
function Skill_Cushion_OnCastingCompleted(actor, action)\n\
	Skill_Cushion_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_Cushion_OnEnter(actor, action)\n\
	local	actorID = actor:GetID()\n\
	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
\n\
	action:SetParam(101,\"\");\n\
		\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Cushion_OnCastingCompleted(actor,action);\n\
		\n\
	return true\n\
end\n\
function Skill_Cushion_Fire(actor,action)\n\
	\n\
	if actor:IsMyActor() == true then\n\
		local kTargets = Cushion_FindTarget(actor,action);\n\
		action:SetTargetList(kTargets);\n\
		DeleteActionTargetList(kTargets);	\n\
	end\n\
	\n\
	local	iTargetCount = action:GetTargetCount();\n\
	ODS(\"Skill_Cushion_Fire iTargetCount : \"..iTargetCount..\"\\n\");\n\
\n\
	local dis = 0\n\
	local lookNum = 0\n\
\n\
	for i = 0, iTargetCount - 1 do\n\
		local	kTargetGUID = action:GetTargetGUID(i);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(i);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			pt:Subtract(actor:GetTranslate())\n\
			if dis < pt:Length() then\n\
				dis = pt:Length()\n\
				lookNum = i\n\
			end\n\
		end\n\
	end\n\
	\n\
	if iTargetCount>0 then\n\
			--	  \n\
		local	kTargetGUID = action:GetTargetGUID(lookNum);\n\
		local	targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
		local	iTargetABVShapeIndex = action:GetTargetABVShapeIndex(lookNum);\n\
		if targetobject:IsNil() == false then\n\
			local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
			actor:LookAt(pt);\n\
		end\n\
	end\n\
\n\
	GetActionResultCS(action, actor)\n\
	return	true;\n\
end\n\
\n\
function	Skill_Cushion_LoadArrowToWeapon(actor,action)\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	kNewArrow:LoadToWeapon(actor);	--	\n\
	kNewArrow:SetParamValue(\"Target\", \"0\")\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Cushion_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	local	iMaxActionSlot = action:GetSlotCount();\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	local	actionID = action:GetID();\n\
\n\
	if action:GetParam(101) ==\"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		action:SetParam(1, \"end\")\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Cushion_OnCleanUp(actor,action)\n\
	return true;\n\
end\n\
function Skill_Cushion_OnLeave(actor, action)\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
--	ODS(\"Skill_Cushion_OnLeave NEXTACTION : \"..actionID..\"\\n\");\n\
\n\
	if actor:IsMyActor() == false or curAction:GetParam(101)==\"end\" then\n\
		return true;\n\
	end\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetActionType()==\"EFFECT\"then\n\
		return true;\n\
	end	\n\
	\n\
	local	kNextActionName = curAction:GetParam(1);\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Cushion_DoEffect(actor)\n\
\n\
	actor:SetNormalAttackEndTime();\n\
\n\
	local	action = actor:GetAction()\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = Skill_Cushion_LoadArrowToWeapon(actor,action);\n\
	\n\
	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
	\n\
		kArrow:SetParamValue(\"DMG_SOUND\",\"CushionShot\");\n\
	\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
	\n\
		if iTargetCount>0 then\n\
				--	  \n\
			local	kTargetGUID = action:GetTargetGUID(0);\n\
			iTargetABVShapeIndex = action:GetTargetABVShapeIndex(0);\n\
			kActionTargetInfo = action:GetTargetInfo(0);\n\
			targetobject = g_pilotMan:FindPilot(kTargetGUID);\n\
			if targetobject:IsNil() == false then\n\
				local pt = targetobject:GetActor():GetABVShapeWorldPos(iTargetABVShapeIndex);\n\
				actor:LookAt(pt);\n\
			end						\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		if targetobject == nil or targetobject:IsNil()==true or kActionTargetInfo==nil or kActionTargetInfo:IsNil() == true then\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);		\n\
		else\n\
			kArrow:SetTargetObjectList(action:GetTargetList());	\n\
		end\n\
		\n\
		kArrow:Fire();\n\
	\n\
	end\n\
	action:ClearTargetList();\n\
end\n\
\n\
function Skill_Cushion_OnEvent(actor, textKey)\n\
	ODS(\"Skill_Cushion_OnEvent key : \"..textKey..\"\\n\");\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		\n\
		Skill_Cushion_DoEffect(actor);\n\
\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID, \"\"      ID  .\n\
-- [ATTACH_NODE_ID] :     ID, \"\"     .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_AUTO_CONNECT] :     \n\
\n\
-- Melee\n\
function Skill_DoubleShot_OnCheckCanEnter(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_DoubleShot_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	Skill_DoubleShot_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function	Skill_DoubleShot_LoadToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return nil end\n\
	if( CheckNil(actor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==action) ) then return nil end\n\
	if( CheckNil(action:IsNil()) ) then return nil end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Skill_DoubleShot_Fire(actor,action)\n\
end\n\
\n\
function Skill_DoubleShot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	action:SetParamInt(2,0);    --  Fire Counter\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	actor:ResetAnimation();\n\
\n\
	Skill_DoubleShot_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_DoubleShot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DoubleShot_OnCleanUp(actor,action)\n\
	return true;\n\
end\n\
\n\
function Skill_DoubleShot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		if curAction:GetScriptParam(\"NO_AUTO_CONNECT\") ~= \"TRUE\" then\n\
		\n\
			curAction:SetParam(0,\"GoNext\");\n\
			curAction:SetParam(1,actionID);\n\
			\n\
		end\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_DoubleShot_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local kAction = actor:GetAction();\n\
			\n\
	if( CheckNil(nil==kAction) ) then return false end\n\
	if( CheckNil(kAction:IsNil()) ) then return false end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	ODS(\"Skill_DoubleShot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
	    local   iFireCount = kAction:GetParamInt(2);\n\
	    \n\
	    local   iMaxFireCount = 2;\n\
	    \n\
	    if iFireCount == iMaxFireCount then \n\
	        return\n\
	    end\n\
	    \n\
	    kAction:SetParamInt(2,iFireCount+1);\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local	kArrow = Skill_DoubleShot_LoadToWeapon(actor,kAction);\n\
\n\
		if kArrow:IsNil() == false then\n\
		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			kArrow:SetParamValue(\"HIT_COUNT\",\"\"..iFireCount);\n\
			\n\
			kArrow:Fire();\n\
			\n\
		else\n\
			\n\
			ODS(\"Arrow is nil\\n\");\n\
		\n\
		end\n\
					\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_Falcon_Beat_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	    \n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_Falcon_Beat_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Falcon_Beat_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Falcon_Beat_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function Skill_Falcon_Beat_FindGenPoint(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	   .\n\
	local	fDistance = -100;\n\
	local	kTargetPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(fDistance);\n\
	kTargetPos:Add(kMovingDir);\n\
	\n\
	\n\
	return	kTargetPos;\n\
\n\
end\n\
function Skill_Falcon_Beat_CreateWolf(actor,action,kTargetPos)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900008, 0)\n\
	if pilot:IsNil() == false then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9)\n\
		pilot:GetActor():FreeMove(true)\n\
		\n\
		--pilot:GetActor():ToLeft(actor:IsToLeft(),true);\n\
		pilot:GetActor():ReserveTransitAction(\"a_Falcon Beat_Play\")\n\
		\n\
		local   kLookTarget = actor:GetLookingDir();\n\
		kLookTarget:Multiply(40);\n\
		kLookTarget:Add(kTargetPos);\n\
		pilot:GetActor():LookAt(kLookTarget,true);\n\
		\n\
		local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		if kAction:IsNil() == false then\n\
		\n\
		    GetActionTargetTransferInfoMan():AddTransferInfo_Actor(\n\
		                    actor:GetPilotGuid(),\n\
		                    action:GetActionNo(),\n\
		                    action:GetActionInstanceID(),\n\
		                    pilot:GetGuid());\n\
		                    \n\
            --SetBreak();\n\
			kAction:SetTargetList(action:GetTargetList());\n\
			kAction:AddNewGUID(actor:GetPilotGuid());\n\
			\n\
			local kLookDir = actor:GetLookingDir();\n\
			\n\
			kAction:SetParamInt(10,action:GetSkillRange(0,actor));\n\
			kAction:SetParamFloat(11,kLookDir:GetX());\n\
			kAction:SetParamFloat(12,kLookDir:GetY());\n\
			kAction:SetParamFloat(13,kLookDir:GetZ());\n\
			\n\
			action:ClearTargetList();\n\
		\n\
		end\n\
	end	\n\
\n\
end\n\
\n\
function Skill_Falcon_Beat_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
--	local	kDir = actor:GetLookingDir();\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,10,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Falcon_Beat_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Falcon_Beat_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Falcon_Beat_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Falcon_Beat_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Skill_Falcon_Beat_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Falcon_Beat_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
	    if kAction:GetParamInt(2) == 0 then\n\
		    local	kTargetPos = Skill_Falcon_Beat_FindGenPoint(actor,kAction);\n\
		    Skill_Falcon_Beat_CreateWolf(actor,kAction,kTargetPos);	\n\
		    actor:ClearIgnoreEffectList();\n\
    		\n\
		    kAction:SetParamInt(2,1);\n\
\n\
			local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
			if kSoundID~=\"\" then\n\
				actor:AttachSound(2784,kSoundID);\n\
			end\n\
	    end	\n\
	\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_Blitz_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	return		true;\n\
	\n\
end\n\
function Skill_Blitz_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Blitz_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Blitz_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function Skill_Blitz_FindGenPoint(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	--	   .\n\
	local	fDistance = -80;\n\
	local	kTargetPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(fDistance);\n\
	kTargetPos:Add(kMovingDir);\n\
	\n\
	\n\
	return	kTargetPos;\n\
\n\
end\n\
function Skill_Blitz_CreateWolf(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900008, 0)\n\
	if pilot:IsNil() == false then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9)\n\
		\n\
		--pilot:GetActor():ToLeft(actor:IsToLeft(),true);\n\
		pilot:GetActor():ReserveTransitAction(\"a_Blitz_Play\")\n\
		pilot:GetActor():FreeMove(true)\n\
		local   kLookTarget = actor:GetLookingDir();\n\
		kLookTarget:Multiply(40);\n\
		kLookTarget:Add(kTargetPos);\n\
		pilot:GetActor():LookAt(kLookTarget,true);\n\
		\n\
		local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		if kAction:IsNil() == false then\n\
		\n\
		    GetActionTargetTransferInfoMan():AddTransferInfo_Actor(\n\
		                    actor:GetPilotGuid(),\n\
		                    action:GetActionNo(),\n\
		                    action:GetActionInstanceID(),\n\
		                    pilot:GetGuid());\n\
		                    \n\
            --SetBreak();\n\
			kAction:SetTargetList(action:GetTargetList());\n\
			kAction:AddNewGUID(actor:GetPilotGuid());\n\
			\n\
			local kLookDir = actor:GetLookingDir();\n\
			\n\
			kAction:SetParamInt(10,action:GetSkillRange(0,actor));\n\
			kAction:SetParamFloat(11,kLookDir:GetX());\n\
			kAction:SetParamFloat(12,kLookDir:GetY());\n\
			kAction:SetParamFloat(13,kLookDir:GetZ());\n\
\n\
			local	kTargetPos = kLookDir:_Multiply(action:GetSkillRange(0,actor));\n\
			kTargetPos:Add(actor:GetPos());\n\
\n\
			kAction:SetParamFloat(30,kTargetPos:GetX());\n\
			kAction:SetParamFloat(31,kTargetPos:GetY());\n\
			kAction:SetParamFloat(32,kTargetPos:GetZ());\n\
			\n\
			action:ClearTargetList();\n\
		\n\
		end\n\
	end	\n\
\n\
end\n\
\n\
function Skill_Blitz_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	kDir2 = Point3(kDir:GetX(),kDir:GetY(),kDir:GetZ());\n\
\n\
	kDir2:Multiply(action:GetSkillRange(0,actor));\n\
	kPos:Add(kDir2);\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Blitz_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Blitz_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Blitz_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Blitz_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Skill_Blitz_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());	\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Blitz_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
	    if kAction:GetParamInt(2) == 0 then\n\
		    local	kTargetPos = Skill_Blitz_FindGenPoint(actor,kAction);\n\
		    Skill_Blitz_CreateWolf(actor,kAction,kTargetPos);	\n\
		    actor:ClearIgnoreEffectList();\n\
    		\n\
		    kAction:SetParamInt(2,1);\n\
\n\
			local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
			if kSoundID~=\"\" then\n\
				actor:AttachSound(2784,kSoundID);\n\
			end\n\
	    end	\n\
	\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Skill_Wolf_Rush_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
    \n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Wolf_Rush_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Wolf_Rush_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_Wolf_Rush_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:CreateActionTargetList(actor);\n\
end\n\
\n\
function Skill_Wolf_Rush_FindGenPoint(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	   .\n\
	local	fDistance = 20;\n\
	local	kTargetPos = actor:GetPos();\n\
	local	kMovingDir = actor:GetLookingDir();\n\
	kMovingDir:Multiply(fDistance);\n\
	kTargetPos:Add(kMovingDir);\n\
	\n\
	\n\
	return	kTargetPos;\n\
\n\
end\n\
function Skill_Wolf_Rush_CreateWolf(actor,action,kTargetPos)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900009, 0)\n\
	if pilot:IsNil() == false then\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9)\n\
		pilot:GetActor():FreeMove(true)\n\
		--pilot:GetActor():ToLeft(actor:IsToLeft(),true);\n\
		pilot:GetActor():ReserveTransitAction(\"a_Wolf Rush_Play\")\n\
		\n\
		local   kLookTarget = actor:GetLookingDir();\n\
		kLookTarget:Multiply(40);\n\
		kLookTarget:Add(kTargetPos);\n\
		pilot:GetActor():LookAt(kLookTarget,true);\n\
		\n\
		local kAction = pilot:GetActor():GetReservedTransitAction();\n\
		if kAction:IsNil() == false then\n\
		\n\
		    GetActionTargetTransferInfoMan():AddTransferInfo_Actor(\n\
		                    actor:GetPilotGuid(),\n\
		                    action:GetActionNo(),\n\
		                    action:GetActionInstanceID(),\n\
		                    pilot:GetGuid());\n\
		                    \n\
            --SetBreak();\n\
			kAction:SetTargetList(action:GetTargetList());\n\
			kAction:AddNewGUID(actor:GetPilotGuid());\n\
			\n\
			local kLookDir = actor:GetLookingDir();\n\
			\n\
			kAction:SetParamInt(10,action:GetSkillRange(0,actor));\n\
			kAction:SetParamFloat(11,kLookDir:GetX());\n\
			kAction:SetParamFloat(12,kLookDir:GetY());\n\
			kAction:SetParamFloat(13,kLookDir:GetZ());\n\
			\n\
			action:ClearTargetList();\n\
		\n\
		end\n\
	end	\n\
\n\
end\n\
\n\
function Skill_Wolf_Rush_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 60\n\
	end	\n\
	\n\
	action:SetParam(0,\"\");\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
	kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,10,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL + FTO_DOWN);\n\
	\n\
	return	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_Wolf_Rush_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Wolf_Rush_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Wolf_Rush_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParamInt(2) == 0 then\n\
		local	kTargetPos = Skill_Wolf_Rush_FindGenPoint(actor,action);\n\
		Skill_Wolf_Rush_CreateWolf(actor,action,kTargetPos);	\n\
		actor:ClearIgnoreEffectList();\n\
		\n\
		action:SetParamInt(2,1);\n\
\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Wolf_Rush_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Skill_Wolf_Rush_OnLeave(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Wolf_Rush_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Skill_Multiple_Shot_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());	\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Multiple_Shot_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Multiple_Shot_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+3);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_Multiple_Shot_Fire(actor,action)\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,3)	\n\
end\n\
\n\
\n\
function Skill_Multiple_Shot_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	if action:GetID() ~= \"a_Throwing Dagger\" and \n\
	action:GetID() ~= \"a_dragon_tooth\" then\n\
		actor:AttachParticle(7215,\"char_root\",\"ef_Multishot_01_char_root\");\n\
		actor:AttachSound(200,\"MultiShot_Start\");\n\
	end\n\
\n\
	MagMultiShot_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMyActor() then\n\
		local	iSkillLevel = action:GetAbil(AT_LEVEL);\n\
\n\
		if iSkillLevel == nil then\n\
			iSkillLevel = 5;\n\
		end\n\
\n\
		local	iFireCount = 3;\n\
\n\
		if iSkillLevel >= 5 then\n\
			iFireCount = 7;\n\
		elseif iSkillLevel >= 3 then\n\
			iFireCount = 5;\n\
		else\n\
			iFireCount = 3;\n\
		end\n\
\n\
		if action:GetID() == \"a_Throwing Dagger\" then\n\
			iFireCount = 1;\n\
			local	kSkillDef = GetSkillDef(action:GetActionNo());\n\
			if kSkillDef:IsNil() == false then\n\
				local iNeedBaseSkill = kSkillDef:GetAbil(AT_CHILD_SKILL_NUM_01);\n\
				local iUpgradeSkill = actor:CheckSkillExist(iNeedBaseSkill);\n\
				\n\
				if 0 ~= iUpgradeSkill then\n\
					local kChildSkillDef = GetSkillDef(iUpgradeSkill);\n\
					if kChildSkillDef:IsNil() == false then\n\
						local iChildSkillLevel = kChildSkillDef:GetAbil(AT_LEVEL);\n\
\n\
						if iChildSkillLevel >= 5 then\n\
							iFireCount = 7;\n\
						elseif iChildSkillLevel >= 3 then\n\
							iFireCount = 5;\n\
						else\n\
							iFireCount = 3;\n\
						end						\n\
					end			\n\
				end\n\
			end\n\
		elseif action:GetID() == \"a_dragon_tooth\" then\n\
			iFireCount = 1;\n\
			local	kSkillDef = GetSkillDef(action:GetActionNo());\n\
			iFireCount = kSkillDef:GetAbil(AT_LEVEL);\n\
			--ODS(\"iFireCount : \"..iFireCount..\"\\n\", false, 3851)\n\
		end\n\
		\n\
		action:SetParamInt(100,iFireCount);\n\
	else\n\
		local kPacket = action:GetParamAsPacket();\n\
		local iFireCount = kPacket:PopInt();\n\
		action:SetParamInt(100,iFireCount);\n\
\n\
	end\n\
	\n\
	actor:StopJump();\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Multiple_Shot_OnOverridePacket(actor,action,packet)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetActionParam() == AP_FIRE then\n\
		local iFireCount = action:GetParamInt(100);\n\
		packet:PushInt(iFireCount);\n\
    end    \n\
end\n\
\n\
function Skill_Multiple_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	weapontype = actor:GetEquippedWeaponType();\n\
--	local	actionID = action:GetID();\n\
	if action:GetParam(300) == \"finish\" then\n\
		return	false;\n\
	end\n\
	if actor:IsMyActor() and action:GetParamInt(6) == 0 then\n\
		if KeyIsDown(action:GetActionKeyNo(0)) == false then\n\
			action:SetParamInt(6,3);\n\
		end\n\
	end\n\
\n\
	if animDone == true then\n\
		\n\
--		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(3);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(3, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(3, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Multiple_Shot_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(7215,true)\n\
	return true;\n\
end\n\
\n\
function Skill_Multiple_Shot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
		local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());	\n\
	\n\
	local	curParam = curAction:GetParam(3)\n\
	local	actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" or curAction:GetParam(300)==\"finish\" then\n\
		return true;\n\
	end	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(3,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
\n\
function Skill_Multiple_Shot_Fire7(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
	\n\
	--  \n\
	local	kRotateAxis = Point3(0,0,1);\n\
	local fRotateAngle = 12.0*(math.pi/180.0)\n\
	local	i = 0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	while i<7 do\n\
	\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i-3));\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
		i=i+1;\n\
	end\n\
	\n\
end\n\
\n\
function Skill_Multiple_Shot_Fire5(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	--  \n\
	local	kRotateAxis = Point3(0,0,1);\n\
	local fRotateAngle = 12.0*(math.pi/180.0)\n\
	local	i = 0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	while i<5 do\n\
	\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i-2));\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
		i=i+1;\n\
	end	\n\
end\n\
\n\
function Skill_Multiple_Shot_Fire4(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	--  \n\
	local	kRotateAxis = Point3(0,0,1);\n\
	local fRotateAngle = 12.0*(math.pi/180.0)\n\
	local	i = 0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	while i<4 do\n\
	\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i-1.5));\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
		i=i+1;\n\
	end	\n\
end\n\
\n\
function Skill_Multiple_Shot_Fire3(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--  \n\
	local	kRotateAxis = Point3(0,0,1);\n\
	local fRotateAngle = 12.0*(math.pi/180.0)\n\
	local	i = 0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	while i<3 do\n\
	\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i-1));\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
		i=i+1;\n\
	end	\n\
end\n\
\n\
function Skill_Multiple_Shot_Fire2(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
\n\
	--  \n\
	local	kRotateAxis = Point3(0,0,1);\n\
	local fRotateAngle = 12.0*(math.pi/180.0)\n\
	local	i = 0;\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	while i<2 do\n\
	\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,action);\n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local	kFireTarget = actor:GetLookingDir()\n\
		kFireTarget:Multiply(iAttackRange-30);\n\
		kFireTarget:Rotate(kRotateAxis,fRotateAngle*(i-0.5));\n\
		kFireTarget:Add(arrow_worldpos);			\n\
		kArrow:SetTargetLoc(kFireTarget);	\n\
		kArrow:Fire();--	!\n\
\n\
		i=i+1;\n\
	end	\n\
end\n\
\n\
function Skill_Multiple_Shot_Fire1(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	--  \n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	\n\
	local	kArrow = Projectile_Default_LoadToWeapon(actor,action);\n\
	local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
	local	kFireTarget = actor:GetLookingDir()\n\
	kFireTarget:Multiply(iAttackRange-30);\n\
	kFireTarget:Add(arrow_worldpos);			\n\
	kArrow:SetTargetLoc(kFireTarget);	\n\
	kArrow:Fire();--	!\n\
end\n\
\n\
\n\
function Skill_Multiple_Shot_OnEvent(actor, textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" or textKey == \"end\" then\n\
	\n\
		if actor:GetAction():GetParam(7) == \"FIRED\" then\n\
			return true\n\
		end\n\
	\n\
		local	action = actor:GetAction()\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
	\n\
		local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(3784,kSoundID);\n\
		end\n\
\n\
		if actor:GetPilot():GetBaseClassID() == CT_SHAMAN then\n\
			actor:AttachParticleS(3851, \"p_ef_fire\", \"eff_sum_skill_smn_muzz00\", 1.0)\n\
		end\n\
		\n\
\n\
		local iFireCount = action:GetParamInt(100);\n\
		if iFireCount == 7 then\n\
			Skill_Multiple_Shot_Fire7(actor,action);\n\
		elseif iFireCount == 5 then\n\
			Skill_Multiple_Shot_Fire5(actor,action);\n\
		elseif iFireCount == 4 then\n\
			Skill_Multiple_Shot_Fire4(actor,action);\n\
		elseif iFireCount == 3 then\n\
			Skill_Multiple_Shot_Fire3(actor,action);\n\
		elseif iFireCount == 2 then\n\
			Skill_Multiple_Shot_Fire2(actor,action);\n\
		elseif iFireCount == 1 then\n\
			Skill_Multiple_Shot_Fire1(actor,action);\n\
		end		\n\
		\n\
		actor:GetAction():SetParam(7,\"FIRED\");\n\
\n\
	end\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_ParticleCanon_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_ParticleCanon_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	local   action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"fire\" or textKey==\"hit\" then		\n\
\n\
		action:SetParam(2,\"HIT\");\n\
		\n\
		--ODS(\" !. :\"..action:GetParamInt(30)..\"\\n\", false, 912)		\n\
		action:StartTimer(1.0, 1.0 / action:GetParamInt(30),0);\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_ParticleCanon_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000654, 0) -- sa_particlecanon\n\
	if false == pilot:IsNil() then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		local kCanon = pilot:GetActor()\n\
		if false == kCanon:IsNil() then\n\
			kCanon:FreeMove(true)\n\
			local kTrans = actor:GetTranslate()\n\
			kTrans:SetZ(kTrans:GetZ()+10)\n\
			g_world:AddActor(guid, kCanon, kTrans, 9);\n\
			pilot:GetUnit():SetCaller(actor:GetPilotGuid())\n\
			local	kLookAt = actor:GetLookingDir()\n\
			kCanon:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
			kCanon:ReserveTransitAction(\"a_particle_canon_sa\")\n\
			kCanon:SetTargetScale(1, 0);\n\
			pilot:GetActor():ClearActionState();\n\
			if actor:IsMyActor() then\n\
	        	pilot:GetActor():SetUnderMyControl(true);\n\
		    end\n\
\n\
			-- local fscale = (action:getskilllevel()%10)*0.05 + 1.0	--  \n\
			-- kCanon:settargetscale(fscale, 0.56)\n\
		end\n\
	end\n\
\n\
	Skill_ParticleCanon_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_ParticleCanon_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	action:SetParamFloat(2, g_world:GetAccumTime()); --   \n\
	action:SetParamInt(9,0);	--	Hit Count\n\
	action:SetParamInt(30, action:GetAbil(AT_COUNT))	--	Max Count\n\
end\n\
\n\
function Skill_ParticleCanon_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_ParticleCanon_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_ParticleCanon_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if action:GetParam(2) == \"HIT\" then\n\
        \n\
            --  hit  \n\
            --    .\n\
            if actor:IsMyActor()  then\n\
				action:GetTargetList():ApplyActionEffects(true,true);\n\
            else\n\
				SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
            end\n\
        \n\
        end        \n\
    \n\
    end		\n\
end\n\
\n\
function Skill_ParticleCanon_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local bAnimDone = actor:IsAnimationDone();\n\
	local iSlot = action:GetCurrentSlot();\n\
	local nextActionName = action:GetNextActionName();\n\
	\n\
	if iSlot == 1 then\n\
		if bAnimDone then\n\
			local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED)*1.8;   --   2\n\
			\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			action:SetParamFloat(0, g_world:GetAccumTime());	-- Start Time\n\
			action:SetParamFloat(1, fMoveSpeed);	-- Start Velocity\n\
			\n\
			action:SetParamFloat(6,actor:GetLookingDir():GetX());\n\
			action:SetParamFloat(7,actor:GetLookingDir():GetY());\n\
			action:SetParamFloat(8,actor:GetLookingDir():GetZ());\n\
			actor:SetMovingDelta(Point3(0,0,0));\n\
\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
		end\n\
	elseif iSlot == 2 then\n\
		if bAnimDone then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();			\n\
		else\n\
			local fAccel = -100 * frameTime\n\
			local fVelocity = action:GetParamFloat(1)\n\
			\n\
			fVelocity = fVelocity + fAccel\n\
			action:SetParamFloat(1, fVelocity)\n\
\n\
			local fElapsedTime = accumTime - action:GetParamFloat(0);\n\
			if fElapsedTime < 1.2 or fVelocity > 0 then\n\
				local kMovingDir = Point3(action:GetParamFloat(6),\n\
											action:GetParamFloat(7),\n\
											action:GetParamFloat(8));\n\
											\n\
				kMovingDir:Multiply(-fVelocity)\n\
				actor:SetMovingDelta(kMovingDir);\n\
			end\n\
		end\n\
	else\n\
		if bAnimDone then        \n\
			action:SetParam(1,\"end\");\n\
			return false        \n\
		end    \n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_ParticleCanon_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(199)\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_ParticleCanon_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_ParticleCanon_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Skill_ParticleCanon fAccumTime:\"..fAccumTime..\"\\n\");\n\
	local iComboCount = actor:GetComboCount();\n\
	--ODS(\"Combo:\"..iComboCount..\"\\n\", false, 912);\n\
\n\
	local	iHitCount = action:GetParamInt(9);\n\
	local	iTotalHit = action:GetParamInt(30);	\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return true\n\
	end\n\
\n\
	if actor:IsMyActor() then	\n\
		action:CreateActionTargetList(actor);		\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
		if 0 < iTargetCount then\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
		end\n\
	end\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(9,iHitCount);\n\
	\n\
	return	true	\n\
end\n\
\n\
-- Ebtity\n\
function Skill_ParticleCanonSA_OnCheckCanEnter(actor,action)\n\
	return true\n\
end\n\
\n\
function Skill_ParticleCanonSA_OnEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	local kPos = actor:GetTranslate()\n\
	local kLookPos = actor:GetLookingDir()\n\
	kLookPos:Multiply(35);\n\
	kPos:Add(kLookPos);\n\
	kPos:SetZ(kPos:GetZ() - 20);\n\
	actor:AttachParticleToPointS(7213, kPos, \"ef_smog_04\", 1);\n\
	actor:AttachParticleS(7212,\"p_ef_shot_01\",\"ef_skill_particlecanon_01\", 1);\n\
	return true\n\
end\n\
\n\
function Skill_ParticleCanonSA_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamFloat(2, g_world:GetAccumTime());\n\
end\n\
\n\
function Skill_ParticleCanonSA_Shot_Fire(actor,action)\n\
\n\
end\n\
\n\
\n\
function Skill_ParticleCanonSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return not actor:IsAnimationDone();\n\
end\n\
function Skill_ParticleCanonSA_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	return true;\n\
end\n\
function Skill_ParticleCanonSA_OnLeave(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	actor:DetachFrom(7212)\n\
	actor:DetachFrom(7213)\n\
\n\
	return true\n\
end\n\
\n\
function Skill_ParticleCanonSA_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
	elseif textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0,0.5);\n\
	end\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_Raid_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
\n\
	return		true\n\
	\n\
end\n\
function Skill_Raid_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	Skill_Raid_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+1)\n\
	actor:PlayCurrentSlot()\n\
	action:SetParam(1,\"start\")\n\
	\n\
	--local	kTargetPos = actor:GetNodeWorldPos(\"char_root\")\n\
	--actor:AttachParticleToPointWithRotate(8,kTargetPos,\"ef_ScrewUpper_01_char_root\", actor:GetRotateQuaternion())\n\
\n\
end\n\
\n\
\n\
function Skill_Raid_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	ODS(\"RestoreItemModel Skill_Raid_Fire\\n\")\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail()\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(2,g_world:GetAccumTime()) --   \n\
	action:SetParamFloat(6,0)\n\
	action:SetParamInt(9,0)	--	Hit Count\n\
\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID)\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"))\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\")\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true)\n\
	end\n\
\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID)            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID)\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID)			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\")\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\")\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID)\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID)\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail()\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0)        \n\
        end\n\
    \n\
    end\n\
\n\
end\n\
function Skill_Raid_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor)	\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	ODS(\"Skill_Raid_OnFindTarget iAttackRange:\"..iAttackRange..\"\\n\")\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
\n\
	local	kPos = actor:GetPos()\n\
	local	kDir = actor:GetLookingDir()\n\
	local	fBackDistance = 10\n\
	kDir:Multiply(-fBackDistance)\n\
	kPos:Add(kDir)\n\
\n\
	local kParam = FindTargetParam()\n\
	\n\
    local iFindTargetType = TAT_SPHERE\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir())\n\
	kParam:SetParam_2(0,0,iAttackRange,0)\n\
	\n\
	kParam:SetParam_3(true,action:GetAbil(AT_ATTACK_UNIT_POS))\n\
	local iTargets = action:FindTargets(iFindTargetType,kParam,kTargets,kTargets)\n\
	\n\
	return iTargets\n\
end\n\
\n\
function Skill_Raid_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	ODS(\"Skill_Raid_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\")\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	Skill_Raid_OnCastingCompleted(actor,action)\n\
	\n\
	return true\n\
end\n\
function Skill_Raid_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true)\n\
			return\n\
		end\n\
		\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Raid_OnTimer(actor,fAccumTime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local	iHitCount = action:GetParamInt(9)\n\
	local	iTotalHit = action:GetAbil(AT_COUNT)\n\
	if iHitCount == iTotalHit then	\n\
		return\n\
	end\n\
\n\
	if actor:IsUnderMyControl() then\n\
		action:CreateActionTargetList(actor)\n\
		action:BroadCastTargetListModify(actor:GetPilot())\n\
	end\n\
		\n\
	iHitCount = iHitCount + 1\n\
	action:SetParamInt(9,iHitCount)\n\
	\n\
	if actor:IsMyActor() then\n\
		QuakeCamera(0.1,1,0,0.01,10)\n\
	end	\n\
	\n\
	return	true	\n\
\n\
end\n\
\n\
function Skill_Raid_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local actionID = action:GetID()\n\
	local movingSpeed = 0\n\
	local bAnimDone = actor:IsAnimationDone()\n\
	local iSlot = action:GetCurrentSlot()\n\
	local CurState = action:GetParam(1)\n\
	\n\
	if bAnimDone then\n\
		action:SetParam(1,\"end\")\n\
		return false\n\
	elseif CurState == \"start\" then\n\
        action:SetParam(1,\"timerSet\")\n\
		if actor:IsMyActor() then\n\
			action:StartTimer(1.0,0.09,0)\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Raid_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	local   kCurAction = actor:GetAction()\n\
\n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail()\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false\n\
		local DefaultDetaChID2 = false\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\")\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\")\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"))\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale)\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\")			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true)\n\
	end\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID)\n\
        \n\
        end\n\
    \n\
    end\n\
	return true\n\
end\n\
\n\
function Skill_Raid_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local curAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==curAction)\n\
	CheckNil(curAction:IsNil())\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if curParam == \"end\" then \n\
			action:SetSlot(2)\n\
			action:SetDoNotBroadCast(true)\n\
			return true\n\
		end\n\
		return	false\n\
	end\n\
	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Raid_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
-- Melee\n\
function Skill_RainOfFire_OnCheckCanEnter(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
\n\
	return		true\n\
	\n\
end\n\
\n\
function Skill_RainOfFire_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
--	local actorID = kActor:GetID()\n\
	local actionID = kAction:GetID()\n\
--	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
	ODS(\"Skill_RainOfFire_OnEnter actionID:\"..actionID..\" GetActionParam:\"..kAction:GetActionParam()..\"\\n\")\n\
		ODS(\"Skill_InstallDefault_OnEnter actionID:\"..actionID..\" GetActionParam:\"..kAction:GetActionParam()..\"\\n\");\n\
	local   kFireEffectID = kAction:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = kAction:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = kAction:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = kAction:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	local   kFireEffectID1 = kAction:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID1\");\n\
    local   kFireEffectTargetNodeID1 = kAction:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE1\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" \n\
	   or (kFireEffectID1 ~= \"\" and  kFireEffectTargetNodeID1 ~=\"\")\n\
	   then    \n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(kActor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            kActor:AttachParticleToPoint(7215,kDir,kFireEffectID);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            kActor:AttachParticle(7215,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			kActor:AttachParticleToPoint(7215,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    kActor:AttachParticleToPointWithRotate(7215,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, kActor:GetRotateQuaternion())\n\
        end\n\
		\n\
		if kFireEffectTargetNodeID1 ~= \"\" then \n\
			kActor:AttachParticle(7216,kFireEffectTargetNodeID1,kFireEffectID1)\n\
		end\n\
    end	\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2785,kSoundID);\n\
	end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	Skill_RainOfFire_OnCastingCompleted(kActor,kAction)\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_RainOfFire_OnCastingCompleted(kActor, kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	Skill_RainOfFire_Fire(kActor,kAction)\n\
	kAction:SetSlot(kAction:GetCurrentSlot()+1)	\n\
\n\
	--kAction:SetParam(1,\"end\")	\n\
	--local	kTargetPos = kActor:GetNodeWorldPos(\"char_root\")\n\
	--kActor:AttachParticleToPointWithRotate(8,kTargetPos,\"ef_ScrewUpper_01_char_root\", kActor:GetRotateQuaternion())\n\
\n\
end\n\
\n\
\n\
function Skill_RainOfFire_Fire(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	ODS(\"RestoreItemModel Skill_RainOfFire_Fire\\n\")\n\
	if kAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    kActor:StartWeaponTrail()\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	kAction:SetParamFloat(2,g_world:GetAccumTime()) --   \n\
	kAction:SetParamFloat(6,0)\n\
	kAction:SetParamInt(9,0)	--	Hit Count\n\
\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2783,kSoundID)\n\
	end	\n\
	\n\
	--	  \n\
	if kAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		kActor:ChangeItemModel(ITEM_WEAPON, kAction:GetScriptParam(\"WEAPON_XML\"))\n\
		ODS(\"ChangeItemModel \"..kAction:GetScriptParam(\"WEAPON_XML\")..\"\\n\")\n\
	end\n\
	\n\
	if kAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		kActor:HideParts(EQUIP_POS_WEAPON, true)\n\
	end\n\
\n\
    local   kFireEffectID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 100\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)            \n\
            --kActor:AttachParticleToPoint(7212,kDir,kFireEffectID)\n\
			kActor:AttachParticleToPointS( 7212, kDir, kFireEffectID, 0.7)\n\
			\n\
			--kActor:AttachParticleToPoint(7220,kDir,\"ef_Pattern_RainOfFire_char_root\")	--  \n\
			kActor:AttachParticleToPointS(7220, kDir,\"ef_Pattern_RainOfFire_char_root\", 0.7)	--  \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            kActor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID)\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			kActor:AttachParticleToPoint(7212,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID)			\n\
		else\n\
		    kActor:AttachParticleToPointWithRotate(7212,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, kActor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\")\n\
    kFireEffectTargetNodeID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\")\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)            \n\
            kActor:AttachParticleToPoint(7213,kDir,kFireEffectID)\n\
        else\n\
            kActor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID)\n\
        end\n\
    \n\
    end	\n\
		\n\
	if kAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    kActor:StartWeaponTrail()\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = kAction:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kAction:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:AddStatusEffectToActor(kActor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0)        \n\
        end\n\
    \n\
    end\n\
	\n\
	if kActor:IsMyActor() then\n\
		kAction:SetParamFloat(2,accumTime);\n\
		kAction:StartTimer(1.0,0.1,0);\n\
	end\n\
end\n\
\n\
function Skill_RainOfFire_OnTimer(kActor,fAccumTime,kAction,iTimerID)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	local	iHitCount = kAction:GetParamInt(9)\n\
	local	iTotalHit = kAction:GetAbil(AT_COUNT)\n\
	if iHitCount == iTotalHit then	\n\
		return\n\
	end\n\
			\n\
	if kActor:IsMyActor() then\n\
		kAction:CreateActionTargetList(kActor)\n\
		kAction:BroadCastTargetListModify(kActor:GetPilot())\n\
		kAction:ClearTargetList()\n\
	end\n\
	\n\
	if kActor:IsMyActor() then\n\
		QuakeCamera(0.1,1,0,0.01,10)\n\
	end	\n\
	\n\
	\n\
	iHitCount = iHitCount + 1\n\
	kAction:SetParamInt(9,iHitCount)\n\
	\n\
	return	true\n\
end\n\
\n\
function Skill_RainOfFire_OnUpdate(kActor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	local actorID = kActor:GetID()\n\
	local kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	--local actionID = kAction:GetID()\n\
	--local movingSpeed = 0\n\
	local bAnimDone = kActor:IsAnimationDone()\n\
	local iSlot = kAction:GetCurrentSlot()\n\
	--local CurState = kAction:GetParam(1)\n\
	\n\
--	ODS(\" : \"..iSlot..\"\\n\", false, 912)\n\
	if iSlot == 1 then\n\
		if bAnimDone then\n\
			kActor:PlayNext()	\n\
			kAction:SetParam(1,\"end\")\n\
--[[			if kAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
				local DefaultDetaChID = false\n\
				if kAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
					DefaultDetaChID = true\n\
				end\n\
				kActor:DetachFrom(7215,DefaultDetaChID)\n\
				kActor:DetachFrom(7216,DefaultDetaChID)\n\
			end			\n\
	]]\n\
			return false\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Skill_RainOfFire_OnCleanUp(kActor)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	local   kCurAction = kActor:GetAction()\n\
\n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		kActor:RestoreItemModel(ITEM_WEAPON)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		kActor:HideParts(EQUIP_POS_WEAPON, false)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    kActor:EndWeaponTrail()\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false\n\
		local DefaultDetaChID2 = false\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true\n\
		end		\n\
\n\
	    kActor:DetachFrom(7212,DefaultDetaChID)\n\
	    kActor:DetachFrom(7213,DefaultDetaChID2)\n\
		kActor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
		kActor:DetachFrom(7215,DefaultDetaChID)\n\
		kActor:DetachFrom(7216,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\")\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\")\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"))\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 kActor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale)\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		kActor:DetachFrom(7215,true)\n\
		kActor:DetachFrom(7216,true)\n\
		if( false == kActor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\")			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true)\n\
	end\n\
	--    (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:RemoveStatusEffectFromActor(kActor:GetPilotGuid(),iTransformEffectID)\n\
        end\n\
    end\n\
	return true\n\
end\n\
\n\
function Skill_RainOfFire_OnLeave(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local curAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==curAction)\n\
	CheckNil(curAction:IsNil())\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = kAction:GetID()\n\
	\n\
	if kActor:IsMyActor() == false then\n\
		return true\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if curParam == \"end\" then \n\
			kAction:SetSlot(2)\n\
			kAction:SetDoNotBroadCast(true)\n\
			return true\n\
		end\n\
		return	false\n\
	end\n\
	\n\
	\n\
	if kAction:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_RainOfFire_OnEvent(kActor,textKey)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
\n\
	local kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	return	true\n\
end\n\
\n\
function Skill_RainOfFire_OnTargetListModified(kActor,kAction,bIsBefore)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(kActor,kAction, true);\n\
    end\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [INSTALL_EFFECT_TARGET_NODE] : Install Target  ,  \n\
-- [INSTALL_EFFECT_ID] : Install Target   ID\n\
-- [FIRE_CASTER_SCALE_NORMALIZE] :          \n\
-- [ENTER_TIMER_TIME] : OnEnter   \n\
-- [ENTER_TIMER_TICK] : OnEnter  Tick \n\
function Skill_Spark_Rock_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
	\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime())\n\
	action:SetParamFloat(1,g_world:GetAccumTime())\n\
	\n\
\n\
	--local iSkillLevel = actor:GetAbil(AT_LEVEL)-1\n\
	--actor:SetTargetScale(1+(0.1*iSkillLevel))\n\
	action:SetParam(1, \"start\")\n\
	action:SetParam(2, \"EnterPassed\")\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor);\n\
	local fCasterScaleNomalize = action:GetScriptParamAsFloat(\"FIRE_CASTER_SCALE_NORMALIZE\")\n\
	if(0 ~= fCasterScaleNomalize) then\n\
		fCasterScaleNomalize = tonumber(fCasterScaleNomalize)\n\
		fCasterScaleNomalize = iAttackRange/fCasterScaleNomalize\n\
		actor:SetTargetScale(fCasterScaleNomalize)\n\
	end\n\
	\n\
	local iFollowPlayerDir = 1\n\
	if(\"FALSE\" == action:GetScriptParam(\"FOLLOW_PLAYER_DIRECTION\")) then\n\
		iFollowPlayerDir = 0\n\
	end\n\
		\n\
	if(1 == iFollowPlayerDir) then\n\
		--      \n\
		local kQuat = Quaternion(-90*DEGTORAD, Point3(0,0,1))\n\
		local kMyPilot = actor:GetPilot()\n\
		if not kMyPilot:IsNil() then 	\n\
			local kMyUnit = kMyPilot:GetUnit()\n\
			if not kMyUnit:IsNil() then \n\
				local kCallerPilot = g_pilotMan:FindPilot(kMyUnit:GetCaller())\n\
				if not kCallerPilot:IsNil() then \n\
					local kCallerActor = kCallerPilot:GetActor()\n\
					if not kCallerActor:IsNil() then\n\
						local kCallerRot= kCallerActor:GetRotateQuaternion()\n\
						kQuat = kCallerRot:Multiply(kQuat)\n\
						actor:SetRotationQuat(kQuat)		\n\
					end	\n\
				end\n\
			end\n\
		end	\n\
		action:SetParamFloat(10, kQuat:GetX())\n\
		action:SetParamFloat(11, kQuat:GetY())\n\
		action:SetParamFloat(12, kQuat:GetZ())\n\
		action:SetParamFloat(13, kQuat:GetW())\n\
	end\n\
	\n\
	action:SetParamInt(14, iFollowPlayerDir)\n\
	\n\
	local kTime = actor:GetAbil(AT_LIFETIME)\n\
	if 0==kTime then\n\
		kTime = 4000\n\
	else\n\
		kTime = kTime + 1000	-- 1  (       .  1 )\n\
	end\n\
	action:SetParamFloat(20, action:GetParamFloat(0)+kTime/1000)\n\
	--ODS(\":\"..actor:GetAbil(AT_LIFETIME)..\"\\n:\"..action:GetParamFloat(0)..\":\"..action:GetParamFloat(20)..\"\\n\", false, 912)\n\
	--	ODS(\"   :\"..fCasterScaleNomalize..\"\\n\", false, 912)\n\
	\n\
	local fTimerTotalTime = action:GetScriptParamAsFloat(\"ENTER_TIMER_TIME\")\n\
	if(0 == fTimerTotalTime) then --     \n\
		fTimerTotalTime = actor:GetAbil(AT_LIFETIME)/1000\n\
	end\n\
	\n\
	local fTimeTick = action:GetScriptParamAsFloat(\"ENTER_TIMER_TICK\")\n\
	action:StartTimer(fTimerTotalTime, fTimeTick, 0)\n\
	actor:FreeMove(true)\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    local   kParam = FindTargetParam()\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir())\n\
	kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0)\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN+FTO_BLOWUP)\n\
	\n\
	return action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    if bIsBefore == false then\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnUpdate(actor, accumTime, frameTime)\n\
	--ODS(\"  \\n\", false, 912)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	--ODS(\"accumTime:\"..accumTime..\"\\n\", false, 912)\n\
	if accumTime > action:GetParamFloat(20) then\n\
		action:SetParam(1, \"end\")\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())	\n\
		--ODS(\" \\n\", false, 912)\n\
		return false\n\
	end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	if animDone == true then\n\
		--ODS(\"animDone\\n\", false, 912)\n\
		actor:PlayNext()\n\
	end\n\
	\n\
	\n\
	--          \n\
	local iFollowPlayerDir = action:GetParamInt(14)\n\
	if(1 == iFollowPlayerDir) then\n\
		--ODS(\"\", false, 912)\n\
		local kQuat = Quaternion(0*DEGTORAD, Point3(0,0,1))\n\
		kQuat:SetX(action:GetParamFloat(10))	\n\
		kQuat:SetY(action:GetParamFloat(11))	\n\
		kQuat:SetZ(action:GetParamFloat(12))	\n\
		kQuat:SetW(action:GetParamFloat(13))\n\
		actor:SetRotationQuat(kQuat)\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnCleanUp(actor, action)\n\
	--SetBreak()\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local	kCurAction = actor:GetAction()	\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	\n\
	if(kCurAction:GetParam(2) == \"EnterPassed\") then \n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
		actor:DetachFrom(7212)\n\
		actor:DetachFrom(7213)\n\
		--ODS(\"   \\n\", false, 912)\n\
	end\n\
	actor:FreeMove(false)\n\
	--ODS(\"   true\\n\", false, 912)\n\
	return true\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnLeave(actor, action)\n\
	--ODS(\"  Leave \\n\", false, 912)\n\
--	SetBreak();\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local	kCurAction = actor:GetAction()	\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	\n\
	if(\"end\" == kCurAction:GetParam(1)) then\n\
		--ODS(\"  Leave \\n\", false, 912)\n\
		return true\n\
	end\n\
	--ODS(\"  Leave \\n\", false, 912)\n\
	return false\n\
end\n\
\n\
\n\
function Skill_Spark_Rock_Play_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
    --   \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
    action:SetParamFloat(2,g_world:GetAccumTime())\n\
    action:SetParamFloat(3,g_world:GetAccumTime())\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"INSTALL_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"INSTALL_EFFECT_TARGET_NODE\")\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID)\n\
        else\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID)\n\
        end\n\
    end	\n\
\n\
	local   kFireEffectID2 = action:GetScriptParam(\"INSTALL_EFFECT_ID2\")\n\
    local   kFireEffectTargetNodeID2 = action:GetScriptParam(\"INSTALL_EFFECT_TARGET_NODE2\")\n\
    \n\
    if kFireEffectID2 ~= \"\" and kFireEffectTargetNodeID2 ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID2 == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID2)\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID2,kFireEffectID2)\n\
        end\n\
    \n\
    end	\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			\n\
			local fTimeTick = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TICK\")\n\
			if(0 ~= fTimeTick) then\n\
				local fTimerTotalTime = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TIME\")\n\
				if(0 == fTimerTotalTime) then --     \n\
					fTimerTotalTime = actor:GetAbil(AT_LIFETIME)/1000\n\
				end\n\
				kAction:StartTimer(fTimerTotalTime, fTimeTick, 1);\n\
			end\n\
		end\n\
		\n\
	end\n\
end\n\
\n\
function Skill_Spark_Rock_Play_OnTimer(actor,fAccumTime,action,iTimerID)	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if 0 == iTimerID or 1 == iTimerID then\n\
		Skill_Spark_Rock_Play_Fire(actor, action)\n\
		--action:SetParamFloat(1,g_world:GetAccumTime())\n\
		action:CreateActionTargetList(actor)\n\
		\n\
		if IsSingleMode() or action:GetTargetCount() == 0 then	    \n\
			Skill_Spark_Rock_Play_OnTargetListModified(actor,action,false)\n\
		elseif actor:IsUnderMyControl() then\n\
			action:BroadCastTargetListModify(actor:GetPilot())\n\
			action:ClearTargetList()\n\
		end\n\
	end	\n\
	return true\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
\n\
-- Melee\n\
function Skill_Master_Summon_Common_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if 0 == iTimerID then\n\
		local	iHitCount = action:GetParamInt(9);\n\
		local	iTotalHit = action:GetParamInt(30);	\n\
		if iHitCount == iTotalHit then\n\
			return true\n\
		end\n\
\n\
		action:CreateActionTargetList(actor);\n\
\n\
		local i = 0;\n\
		local kTargetList = action:GetTargetList();\n\
		local iTargetCount = kTargetList:size();\n\
		while i<iTargetCount do\n\
			local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
			local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
			if kTargetPilot:IsNil() == false then\n\
				if actor:IsMyActor() then\n\
					if( CheckNil(g_world == nil) ) then return false end\n\
					if( CheckNil(g_world:IsNil()) ) then return false end\n\
					g_world:AddDrawActorFilter(kTargetGUID);\n\
				end\n\
			end\n\
			i = i + 1;\n\
		end\n\
		\n\
		if IsSingleMode() then\n\
	    \n\
			Skill_Master_Summon_Common_HitOneTime(actor,action)\n\
			Skill_Master_Summon_Common_OnTargetListModified(actor,action,false)\n\
	        \n\
			return true;\n\
		else\n\
\n\
			local	kTargetList = action:GetTargetList();\n\
			local	iTargetCount = kTargetList:size();\n\
\n\
			if 0 < iTargetCount then\n\
				action:BroadCastTargetListModify(actor:GetPilot());\n\
			end\n\
		end\n\
\n\
		iHitCount = iHitCount + 1;\n\
		action:SetParamInt(9,iHitCount);\n\
		\n\
	elseif 1 == iTimerID then --   \n\
		local iSkillRange = action:GetParamInt(21);\n\
		local iIndex = action:GetParamInt(20);\n\
\n\
		local kPos = actor:GetPos();	\n\
\n\
		kPos:SetX(kPos:GetX() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetY(kPos:GetY() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetZ(kPos:GetZ() + 200);\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			--  .\n\
			ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				return true;\n\
			end			\n\
		end\n\
\n\
		actor:AttachParticleToPointS(1000 + iIndex, ptcl, \"ef_skill_dragon_rush_lightning_01\", math.random(-1.0, 1));\n\
\n\
		action:SetParamInt(20, iIndex + 1);\n\
	end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Master_Summon_Common_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
\n\
function Skill_Master_Summon_Common_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Master_Summon_Common_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);        \n\
        end    \n\
    end\n\
\n\
	if \"\" ~= action:GetScriptParam(\"SUMMON_CLASSNO\") then\n\
		local iSummonClassNo = tonumber(action:GetScriptParam(\"SUMMON_CLASSNO\"));\n\
		local kSummonReserveAction = action:GetScriptParam(\"SUMMON_RESERVE_ACTION\");\n\
		Skill_Master_Summon_Common_Create_Summon(actor,iSummonClassNo,kSummonReserveAction);\n\
	end\n\
\n\
\n\
	local iTotalHit = 0;\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
	if kSkillDef:IsNil() == false then\n\
		iTotalHit  = kSkillDef:GetAbil(AT_COUNT);\n\
	end\n\
\n\
	action:SetParamInt(9,0)	--	Hit Count\n\
	action:SetParamInt(30,iTotalHit);\n\
	action:SetParamInt(31,0); -- hit_timer  Check\n\
\n\
	action:SetParamInt(20,0); --   \n\
\n\
	if \"a_groundzero\" == action:GetID() then --   		\n\
		actor:AttachParticle(2000, \"p_wp_l_hand\", \"ef_Ground_Zero_Gun_l\")	--		actor:AttachParticle(2000, \"Bip01 L Hand\", \"ef_Ground_Zero_Gun_l\")\n\
		actor:AttachParticle(2001, \"p_wp_r_hand\", \"ef_Ground_Zero_Gun_r\")\n\
	end\n\
	\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Master_Summon_Common_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"CASTING_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"CASTING_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Master_Summon_Common_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.4,true,true);\n\
		g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
	end\n\
\n\
	action:CreateActionTargetList(actor,true);\n\
\n\
	local i = 0;\n\
	local kTargetList = action:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			if actor:IsMyActor() then\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				g_world:AddDrawActorFilter(kTargetGUID);\n\
			end\n\
		end\n\
		i = i + 1;\n\
	end\n\
\n\
	action:ClearTargetList();\n\
\n\
	if \"a_Summon_Dragon_Rush\" == action:GetID() then\n\
		action:SetParamInt(21, action:GetSkillRange(0,actor)) --  \n\
		action:StartTimer(4.6, 0.1,1); --   1\n\
	end\n\
\n\
	actor:SetCanHit(false);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot()\n\
	local iMaxActionSlot = action:GetSlotCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		if(false == actor:PlayNext()) then	--   			\n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				return false;\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end		\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
") + std::string("	\n\
	ODS(\"RestoreItemModel Skill_Master_Summon_Common_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	--   \n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        end\n\
    end\n\
\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
\n\
	if \"a_groundzero\" == kCurAction:GetID() then\n\
	 --   ,  \n\
		actor:DetachFrom(2000, true) actor:DetachFrom(2001, true) actor:DetachFrom(2002, true) actor:DetachFrom(2003, true)\n\
		actor:SetCanHit(true);\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if curAction:GetNextActionName() ~= actionID then\n\
		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		if actor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Master_Summon_Common_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
\n\
function Skill_Master_Summon_Common_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_Master_Summon_Common_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
end\n\
function Skill_Master_Summon_Common_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
		--  hit  \n\
        --    .\n\
        Skill_Master_Summon_Common_HitOneTime(actor,action);\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end       \n\
 \n\
    end\n\
\n\
end\n\
\n\
function Skill_Master_Summon_Common_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsUnderMyControl() then\n\
			local iTimerTime = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TIME\");\n\
			if 0 == iTimerTime then\n\
				if 0 == kAction:GetParamInt(31) then -- hit          .\n\
					kAction:CreateActionTargetList(actor);\n\
\n\
					local i = 0;\n\
					local kTargetList = kAction:GetTargetList();\n\
					local iTargetCount = kTargetList:size();\n\
					while i<iTargetCount do\n\
						local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
						local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
						local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
						if kTargetPilot:IsNil() == false then\n\
							if actor:IsMyActor() then\n\
								if( CheckNil(g_world == nil) ) then return false end\n\
								if( CheckNil(g_world:IsNil()) ) then return false end\n\
								g_world:AddDrawActorFilter(kTargetGUID);\n\
							end\n\
						end\n\
						i = i + 1;\n\
					end\n\
\n\
					if IsSingleMode() then\n\
			        \n\
						Skill_Master_Summon_Common_HitOneTime(actor,kAction)\n\
						Skill_Master_Summon_Common_OnTargetListModified(actor,kAction,false)\n\
			            \n\
						return;\n\
					else\n\
						kAction:BroadCastTargetListModify(actor:GetPilot());\n\
					end\n\
\n\
					kAction:SetParamInt(31,1);\n\
				end\n\
			else --   \n\
				local iTimerick = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TICK\");\n\
				kAction:StartTimer(iTimerTime, iTimerick,0);\n\
				if kAction:GetID() == \"a_Summon_Dragon_Rush\" then\n\
					if actor:IsMyActor() then\n\
						QuakeCamera(4, 2, 1, 1, 1);\n\
					end\n\
				end\n\
			end\n\
		end		\n\
	end\n\
	if(kAction:GetID() == \"a_groundzero\") then\n\
		local kPos = Point3(0,0,0)\n\
		local kQuat = Quaternion4(0,0,0,1)\n\
		if(textKey == \"bang_l\") then 		--  \n\
			kPos = actor:GetParticleNodeWorldPos(2000, \"p_ef_shot_02\")\n\
			kQuat = actor:GetNodeWorldRotate(\"p_ef_head\")\n\
			actor:AttachParticleToPointWithRotate(2002, kPos, \"ef_groundzero_gun_fire_blue\", kQuat, 0.5)\n\
		elseif(textKey == \"bang_r\") then 	--  \n\
			kPos = actor:GetParticleNodeWorldPos(2001, \"p_ef_shot_01\")\n\
			kQuat = actor:GetNodeWorldRotate(\"p_ef_head\")\n\
			actor:AttachParticleToPointWithRotate(2003, kPos, \"ef_groundzero_gun_fire_blue\", kQuat, 0.5)\n\
		elseif(textKey == \"hit\") then\n\
			QuakeCamera(6, 0.5, 1, 0.01, 1)\n\
		end\n\
	end\n\
		\n\
	return	true;\n\
end\n\
\n\
function Skill_Master_Summon_Common_Create_Summon(actor, iClassNo, kReserveAction)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kTargetPos = actor:GetPos();\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
\n\
	ODS(\"Create Entity GUID[\".. guid:GetString().. \"] \\n\", false, 1509)\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, iClassNo, 0)\n\
	if pilot:IsNil() == false then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9);\n\
	\n\
	    if actor:IsMyActor() then\n\
	        pilot:GetActor():SetUnderMyControl(true);\n\
	    end\n\
\n\
		pilot:GetUnit():SetCaller(actor:GetPilotGuid());\n\
		pilot:GetActor():FreeMove(true)\n\
		pilot:GetActor():ReserveTransitAction(kReserveAction);\n\
		ODS(\" : \"..kReserveAction.. \"\\n\",false, 912)\n\
		pilot:GetActor():ClearActionState();\n\
		pilot:GetActor():FindPathNormal();\n\
		pilot:GetActor():LockBidirection(false);\n\
		pilot:GetActor():ToLeft(actor:IsToLeft());\n\
		pilot:GetActor():SeeFront(true,true);\n\
		pilot:GetActor():SetTargetAlpha(0,1,0.2)\n\
\n\
		if actor:IsMyActor() then\n\
	        g_world:AddDrawActorFilter(guid);\n\
	    end		\n\
	end	\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [CHECK_CAN_PREV_ACTION_ID] :      .\n\
function Skill_Master_Summon_Finish_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnCheckCanEnter(actor,action)\n\
\n\
	ODS(\"Skill_Master_Summon_Finish_OnCheckCanEnter \\n\",false, 1509)\n\
	local	kCurrentAction = actor:GetAction();\n\
	if ( false == kCurrentAction:IsNil() ) then\n\
		local   kPrevActionID = action:GetScriptParam(\"CHECK_CAN_PREV_ACTION_ID\");\n\
		return (kCurrentAction:GetID() == kPrevActionID);\n\
	end\n\
	\n\
	return true;	\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	return Skill_Master_Summon_Common_OnTimer(actor,fAccumTime,action,iTimerID);\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if \"a_Summon_Dragon_Rush2\" == action:GetID() then\n\
		action:SetParamInt(21, action:GetSkillRange(0,actor) / 5 * 3) --  \n\
		action:StartTimer(2.6, 0.04, 1); --   1\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		if(false == actor:PlayNext()) then	--   			\n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				return false;\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end		\n\
	end		\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
		g_world:ClearDrawActorFilter()\n\
	end	\n\
\n\
	actor:RestoreLockBidirection();\n\
	\n\
	if \"a_groundzero_finish\" == kCurAction:GetID() then\n\
	--   ,  \n\
		actor:DetachFrom(2004, true)\n\
	end\n\
\n\
	actor:SetCanHit(true);\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
			\n\
	if(nil == string.find(actionID, \"a_run\")) then\n\
		if curAction:GetNextActionName() ~= actionID then\n\
			ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsMyActor() then\n\
			kAction:CreateActionTargetList(actor);\n\
\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local i = 0;\n\
			local kTargetList = kAction:GetTargetList();\n\
			local iTargetCount = kTargetList:size();\n\
			while i<iTargetCount do\n\
				local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
				local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
				local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false then\n\
					if actor:IsMyActor() then\n\
						g_world:AddDrawActorFilter(kTargetGUID);\n\
					end\n\
				end\n\
				i = i + 1;\n\
			end\n\
	\n\
			if IsSingleMode() then\n\
				SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
				Skill_Master_Summon_Finish_OnTargetListModified(actor,kAction,false)\n\
\n\
				return;\n\
			else\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end\n\
		end	\n\
	\n\
        SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
		\n\
		--    \n\
		if \"a_Summon_Demolition_Bomber2\" == kAction:GetID() then\n\
			kAction:SetParamInt(20);\n\
			kAction:SetParamInt(21, 300);\n\
			local i = 0;\n\
			\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			while i < 20 do\n\
				local bAddEffect = true;\n\
				local iSkillRange = kAction:GetParamInt(21);\n\
				local iIndex = kAction:GetParamInt(20);\n\
\n\
				local kPos = actor:GetPos();	\n\
\n\
				kPos:SetX(kPos:GetX() + math.random(-iSkillRange,iSkillRange));\n\
				kPos:SetY(kPos:GetY() + math.random(-iSkillRange,iSkillRange));\n\
				kPos:SetZ(kPos:GetZ() + 200);\n\
\n\
				local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
				if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
					--  .\n\
					ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
					if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
						bAddEffect = false;						\n\
					end			\n\
				end\n\
\n\
				if true == bAddEffect then\n\
					actor:AttachParticleToPointS(1000 + iIndex, ptcl, \"ef_boom_01\", math.random(-0.8, 1.5));\n\
					kAction:SetParamInt(20, iIndex + 1);\n\
					i = i + 1;\n\
				end\n\
				\n\
			end\n\
		end\n\
		\n\
		--     \n\
		if \"a_groundzero_finish\" == kAction:GetID() then\n\
			kAction:SetParamInt(20);\n\
			kAction:SetParamInt(21, 300);			\n\
			local i = 0;\n\
		\n\
			--  \n\
			local iGrenadeNum = 8\n\
			local kRotateAxis = Point3(0,0,1)\n\
			local fRotateAngle = (360/iGrenadeNum)*DEGTORAD\n\
			local i = 0;\n\
			local fRadius = 150\n\
			local kCenterPos = actor:GetPos()\n\
			\n\
			while i<iGrenadeNum do\n\
				local iIndex = kAction:GetParamInt(20)\n\
				local kEffectPos = actor:GetLookingDir()\n\
				kEffectPos:Multiply(fRadius)\n\
				kEffectPos:Rotate(kRotateAxis,fRotateAngle*(i))\n\
				kEffectPos:Add(kCenterPos)\n\
				actor:AttachParticleToPointS(1000 + iIndex, kEffectPos, \"ef_boom_01\", 1.0)\n\
				kAction:SetParamInt(20, iIndex + 1)\n\
				i=i+1\n\
			end\n\
			QuakeCamera(1, 3, 1, 1, 1)\n\
		end\n\
	end\n\
	\n\
	if textKey == \"bomb_start\" and \"a_groundzero_finish\" == kAction:GetID() then\n\
		actor:AttachParticle(2004, \"char_root\", \"ef_Ground_Zero_Bomb\")\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Master_Summon_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
	return Skill_Master_Summon_Common_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
-- Melee\n\
function Skill_Demolition_Bomber_Idle_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Demolition_Bomber_Idle_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Demolition_Bomber_Idle_Fire(actor,action);\n\
	\n\
	actor:PlayCurrentSlot();\n\
end\n\
function Skill_Demolition_Bomber_Idle_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
end\n\
\n\
function Skill_Demolition_Bomber_Idle_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Demolition_Bomber_Idle_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Demolition_Bomber_Idle_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Demolition_Bomber_Idle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Demolition_Bomber_Idle_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"Skill_Demolition_Bomber_Idle_OnCleanUp\\n\", false, 1509);\n\
\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Demolition_Bomber_Idle_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	return true \n\
end\n\
\n\
function Skill_Demolition_Bomber_Idle_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			QuakeCamera(0.8, 5, 1, 1, 1);\n\
		end	\n\
\n\
		local kCallerGUID = actor:GetCallerGuid();\n\
		local kCallerPilot = g_pilotMan:FindPilot(kCallerGUID);\n\
		local kCallerActor = kCallerPilot:GetActor();\n\
		if kCallerActor:IsNil() then return true end;\n\
\n\
		local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				kCallerActor:AttachParticle(7220,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            kCallerActor:AttachParticle(7220,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				kCallerActor:AttachParticleToPoint(7220,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    kCallerActor:AttachParticleToPointWithRotate(7220,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	elseif textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0,0.2);\n\
	elseif textKey == \"alpha_start\" then\n\
		actor:SetTargetAlpha(0,1,0.5);	\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function SummonCommonSAInit(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:SetTargetAlpha(actor:GetAlpha(),0,0.1);\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
\n\
-- Melee\n\
function Skill_Master_PhantomClone_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Master_PhantomClone_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Master_PhantomClone_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
\n\
function Skill_Master_PhantomClone_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Master_PhantomClone_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
	\n\
	if bUseTLM == false then\n\
--		action:CreateActionTargetList(actor);\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	actor:HideParts(EQUIP_POS_WEAPON, true);\n\
\n\
	actor:AttachParticle(7212, \"char_root\", \"ef_skill_Phantom_Warrior_01_char_root\");\n\
	actor:AttachParticle(7213, \"char_root\", \"ef_skill_Phantom_Warrior_02_char_root\");\n\
	actor:AttachParticle(7214, \"char_root\", \"ef_skill_Phantom_Warrior_03_char_root\");\n\
	actor:AttachParticle(7215, \"char_root\", \"ef_skill_Phantom_Warrior_04_char_root\");\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end		\n\
end\n\
\n\
function Skill_Master_PhantomClone_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Master_PhantomClone_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
\n\
	action:SetParamInt(100,0);\n\
		\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"CASTING_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"CASTING_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Master_PhantomClone_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.4,true,true);\n\
		g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
	end\n\
\n\
	--    \n\
	Skill_Master_PhantomClone_Create_Phantom_Warrior(actor);\n\
\n\
	actor:SetCanHit(false);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Master_PhantomClone_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
\n\
	if 1 == action:GetParamInt(100) then\n\
		action:SetParamInt(100, 0);\n\
\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
		\n\
		local i = 0;\n\
		local kTargetList = action:GetTargetList();\n\
		local iTargetCount = kTargetList:size();\n\
		while i<iTargetCount do\n\
            local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
			local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
			if kTargetPilot:IsNil() == false then\n\
				if actor:IsMyActor() then\n\
					if( CheckNil(g_world == nil) ) then return false end\n\
					if( CheckNil(g_world:IsNil()) ) then return false end\n\
					g_world:AddDrawActorFilter(kTargetGUID);\n\
				end\n\
			end\n\
			i = i + 1;\n\
		end\n\
		\n\
	elseif 3 == action:GetParamInt(100) then\n\
		action:SetParamInt(100, 0);\n\
		action:SetParam(1, \"end\" );\n\
		local iSummonCount = actor:GetSummonUnitCount();\n\
		local i = 0;\n\
\n\
		while i < iSummonCount do\n\
			local kSummonGUID = actor:GetSummonUnit(i);\n\
			local kTargetPilot = g_pilotMan:FindPilot(kSummonGUID);\n\
			if kTargetPilot:IsNil() then return true end\n\
			local kTargetActor = kTargetPilot:GetActor()\n\
			if kTargetActor:IsNil() then return true end\n\
\n\
			kTargetActor:SetParam(\"SummonEnd\", \"true\");\n\
\n\
			i = i + 1;\n\
		end\n\
		return false;\n\
	end\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Master_PhantomClone_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"RestoreItemModel Skill_Master_PhantomClone_ReallyLeave\\n\");\n\
\n\
	actor:HideParts(EQUIP_POS_WEAPON, false);\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
\n\
	actor:ClearSummonUnit();\n\
	\n\
    actor:DetachFrom(7212)\n\
    actor:DetachFrom(7213)\n\
	actor:DetachFrom(7214)\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
		g_world:ClearDrawActorFilter()\n\
	end	\n\
		\n\
	actor:RestoreLockBidirection();\n\
\n\
	actor:SetCanHit(true);\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Master_PhantomClone_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if(nil == string.find(actionID, \"a_run\")) then\n\
		if curAction:GetNextActionName() ~= actionID then\n\
			ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		if actor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Master_PhantomClone_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    end	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
\n\
function Skill_Master_PhantomClone_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
") + std::string("		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_Master_PhantomClone_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Master_PhantomClone_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local kTargetList = action:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	local i = 0;\n\
	while i < iTargetCount do\n\
		local kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
\n\
		if kTargetPilot:IsNil() == false then\n\
			local   kTargetActor = kTargetPilot:GetActor();\n\
			if kTargetActor:IsNil() == false then\n\
				kTargetActor:SetAbil(AT_NOT_FLY_TO_CAMERA, 1);\n\
			end\n\
		end\n\
\n\
		i = i + 1;\n\
	end\n\
\n\
end\n\
\n\
function Skill_Master_PhantomClone_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Master_PhantomClone_Create_Phantom_Warrior(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kTargetPos = actor:GetPos();\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 900101, 0)\n\
	if pilot:IsNil() == false then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9);\n\
	\n\
	    if actor:IsMyActor() then\n\
	        pilot:GetActor():SetUnderMyControl(true);\n\
	    end\n\
\n\
		pilot:GetUnit():SetCaller(actor:GetPilotGuid());\n\
		pilot:GetActor():FreeMove(true)\n\
		pilot:GetActor():ReserveTransitAction(\"a_Phantom_Warrior_idle\");\n\
		pilot:GetActor():ClearActionState();\n\
		pilot:GetActor():FindPathNormal();\n\
		pilot:GetActor():LockBidirection(false);\n\
		pilot:GetActor():ToLeft(actor:IsToLeft());\n\
		pilot:GetActor():SeeFront(true,true);		\n\
		pilot:GetActor():SetTargetAlpha(0,1,0.2)\n\
		\n\
		if actor:IsMyActor() then\n\
	        g_world:AddDrawActorFilter(guid);\n\
	    end		\n\
	end	\n\
\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
function Skill_Phantom_Warrior_Idle_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Phantom_Warrior_Idle_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
\n\
end\n\
function Skill_Phantom_Warrior_Idle_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
end\n\
\n\
function Skill_Phantom_Warrior_Idle_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	action:SetParam(3,\"0\");\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Phantom_Warrior_Idle_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Phantom_Warrior_Idle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	if animDone == true then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Phantom_Warrior_Idle_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
		\n\
	return true;\n\
end\n\
\n\
function Skill_Phantom_Warrior_Idle_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	return true\n\
end\n\
\n\
\n\
function Skill_Phantom_Warrior_Idle_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
    end\n\
end\n\
\n\
function Skill_Phantom_Warrior_Idle_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"summon\" then --   .\n\
		local kCallerGUID = actor:GetCallerGuid();\n\
		local kCallerPilot = g_pilotMan:FindPilot(kCallerGUID);\n\
		local kCallerActor = kCallerPilot:GetActor();\n\
		if kCallerActor:IsNil() then return true end;\n\
\n\
		local kCallerAction = kCallerActor:GetAction();\n\
		if kCallerAction:IsNil() then return true end;\n\
\n\
		kCallerAction:SetParamInt(100, 1);\n\
	elseif textKey == \"summon_end\" then --    \n\
		local kCallerGUID = actor:GetCallerGuid();\n\
		local kCallerPilot = g_pilotMan:FindPilot(kCallerGUID);\n\
		local kCallerActor = kCallerPilot:GetActor();\n\
		if kCallerActor:IsNil() then return true end;\n\
\n\
		local kCallerAction = kCallerActor:GetAction();\n\
		if kCallerAction:IsNil() then return true end;\n\
\n\
		kCallerAction:SetParamInt(100, 3);\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0,0.1)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
function Skill_Phantom_Ninja_Idle_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Phantom_Ninja_Idle_Fire(actor,action);\n\
--	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
function Skill_Phantom_Ninja_Idle_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Phantom_Ninja_Idle_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
end\n\
function Skill_Phantom_Ninja_Idle_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Phantom_Ninja_Idle_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Phantom_Ninja_Idle_OnCastingCompleted(actor,action);\n\
	\n\
	local kGuidString = actor:GetParam(\"TargetGUID\");\n\
	if nil == kGuidString then\n\
		actor:AttachSound(2780, \"Ninja_Poof\");\n\
		actor:SetParam(\"SummonEnd\", \"false\");\n\
		actor:AttachParticleToPoint(7220, actor:GetNodeWorldPos(\"char_root\"), \"ef_smog_03_char_root\");\n\
		local kCallerGUID = actor:GetCallerGuid();\n\
		local kCallerPilot = g_pilotMan:FindPilot(kCallerGUID);\n\
		local kCallerActor = kCallerPilot:GetActor();\n\
		if kCallerActor:IsNil() then return true end;\n\
		\n\
		if kCallerActor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
		end\n\
\n\
		-- Caller Caller   .\n\
		kCallerActor:AddSummonUnit(actor:GetPilotGuid());\n\
\n\
		actor:SetParam(\"TargetGUID\", \"\");\n\
\n\
		local kCallerAction = kCallerActor:GetAction();\n\
		if kCallerAction:IsNil() then return true end;\n\
\n\
		local kTargetList = kCallerAction:GetTargetList();\n\
		local iTargetCount = kTargetList:size();\n\
		if 0 < iTargetCount then\n\
			local kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			local kTargetGUID = kTargetInfo:GetTargetGUID();\n\
			local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
\n\
			if kTargetPilot:IsNil() == false then\n\
				local   kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
					actor:SetParam(\"TargetGUID\", kTargetActor:GetPilotGuid():GetString());\n\
\n\
					--    .\n\
					kTargetList:DeleteTargetInfo(0);\n\
				end\n\
			end\n\
		else\n\
			actor:SetParam(\"TargetGUID\", \"\");\n\
		end\n\
\n\
		actor:SetParam(\"CurHit\", tostring(0)); -- Current Hit\n\
		actor:SetParam(\"TotalHit\",tostring(8)); -- Total Hit	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Phantom_Ninja_Idle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
\n\
	local kGuidString = actor:GetParam(\"TargetGUID\");\n\
	local kGuid = GUID(\"123\");\n\
	if nil ~= kGuidString then\n\
		kGuid:Set(kGuidString);\n\
	else\n\
		local kMyPilot = actor:GetPilot()\n\
		if kMyPilot:IsNil() then return true end\n\
		local kMyUnit = kMyPilot:GetUnit()\n\
		if kMyUnit:IsNil() then return true end\n\
		local kCallerGUID = kMyUnit:GetCaller();\n\
		if nil ~= kCallerGUID then\n\
			kGuid:Set(kMyUnit:GetCaller());\n\
		end\n\
	end\n\
\n\
	local kParamValue = actor:GetParam(\"SummonEnd\");\n\
	if kParamValue == \"true\" then\n\
		return false;\n\
	end\n\
\n\
	local kTargetPilot = g_pilotMan:FindPilot(kGuid)\n\
	if kTargetPilot:IsNil() then return true end\n\
	local kTargetActor = kTargetPilot:GetActor()\n\
	if kTargetActor:IsNil() then return true end\n\
	local kTargetPos = kTargetActor:GetPos()\n\
\n\
	local iNextSlot = 0;\n\
	local bForceNextSlot = false\n\
	--Pos\n\
	actor:SetTraceFlyTargetLoc( kTargetPos )\n\
	local fDistance = Trace(actor, 2.5, frameTime, 40.0, 15.0, true )\n\
	if fDistance < 50.0 then\n\
		iNextSlot = 1;\n\
		bForceNextSlot = true;\n\
		if nil ~= kGuidString then\n\
			local kGuid = GUID(\"123\");\n\
			kGuid:Set(kGuidString);\n\
			local kTargetPilot = g_pilotMan:FindPilot(kGuid);\n\
			if false == kTargetPilot:IsNil() then\n\
				local kTargetUnit = kTargetPilot:GetUnit()\n\
				if false == kTargetUnit:IsNil() then\n\
					if false == kTargetUnit:IsDead() then\n\
						\n\
						local iTotalHit =  tonumber(actor:GetParam(\"TotalHit\"));\n\
						local iCurHit = tonumber(actor:GetParam(\"CurHit\"));\n\
\n\
						if iTotalHit < iCurHit then\n\
							iNextSlot = 0;\n\
							bForceNextSlot = false;\n\
						elseif iTotalHit > iCurHit then\n\
							iCurHit = iCurHit + 1;\n\
							actor:SetParam(\"CurHit\", tostring(iCurHit));\n\
\n\
							actor:ReserveTransitAction(\"a_Phantom_Ninja_melee_01\");\n\
						elseif iTotalHit == iCurHit then\n\
							iCurHit = iCurHit + 1;\n\
							actor:SetParam(\"CurHit\", tostring(iCurHit));\n\
							actor:ReserveTransitAction(\"a_Phantom_Ninja_melee_finish\");\n\
						end\n\
\n\
					else\n\
						iNextSlot = 0;\n\
						bForceNextSlot = false;\n\
					end\n\
				end				\n\
			end\n\
		end		\n\
	else\n\
		iNexSlot = 1;\n\
		bForceNextSlot = true;\n\
	end	\n\
\n\
	if actor:IsAnimationDone() or bForceNextSlot then\n\
		action:SetSlot(iNextSlot)\n\
		actor:PlayCurrentSlot(false)\n\
	end\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Phantom_Ninja_Idle_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"RestoreItemModel Skill_Phantom_Ninja_Idle_ReallyLeave\\n\");\n\
\n\
	local kCallerGUID = actor:GetCallerGuid();\n\
	local kCallerPilot = g_pilotMan:FindPilot(kCallerGUID);\n\
	local kCallerActor = kCallerPilot:GetActor();\n\
	if kCallerActor:IsNil() then return true end;\n\
	\n\
	local kParamValue = actor:GetParam(\"SummonEnd\");\n\
	if kParamValue == \"true\" then\n\
		kCallerActor:AttachSound(2780, \"Ninja_Poof\");\n\
		kCallerActor:DeleteSummonUnit(actor:GetPilotGuid());\n\
		kCallerActor:AttachParticleToPoint(7220, actor:GetNodeWorldPos(\"char_root\"), \"ef_smog_03_char_root\");\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
	end\n\
		\n\
	return true\n\
end\n\
\n\
function Skill_Phantom_Ninja_Idle_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Phantom_Ninja_Idle_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
\n\
function Skill_Phantom_Ninja_Idle_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
") + std::string("					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_Phantom_Ninja_Idle_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Phantom_Ninja_Idle_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Phantom_Ninja_Idle_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Phantom_Ninja_Idle_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
					local iTargetCount = kAction:GetTargetCount();\n\
					if iTargetCount == tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
						AddWarnDataStr(GetTextW(tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2);		\n\
					end\n\
				end\n\
\n\
				if IsSingleMode() then\n\
		        \n\
					Skill_Phantom_Ninja_Idle_HitOneTime(actor,kAction)\n\
					Skill_Phantom_Ninja_Idle_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
		        \n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		            \n\
				end			\n\
			\n\
			end	\n\
		end\n\
	\n\
        Skill_Phantom_Ninja_Idle_HitOneTime(actor,kAction)\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Trace(actor, fSpeed, fFrameTime, fLimitDistance, fAccelateScale, bCanRotate)\n\
	\n\
	if actor:IsNil() then\n\
		return 0\n\
	end\n\
\n\
	local rkCurPos = actor:GetPos();\n\
	local kTempTargetLoc = Point3(actor:GetTraceFlyTargetLoc():GetX(), actor:GetTraceFlyTargetLoc():GetY(), actor:GetTraceFlyTargetLoc():GetZ());\n\
	local kTempCurLoc = Point3(rkCurPos:GetX(), rkCurPos:GetY(), rkCurPos:GetZ());\n\
\n\
	kTempTargetLoc:SetZ(0);\n\
	kTempCurLoc:SetZ(0);\n\
\n\
	local kDiffPos = kTempTargetLoc:_Subtract(kTempCurLoc);\n\
	local fDistance = kDiffPos:Length();\n\
\n\
	kDiffPos:Unitize();\n\
\n\
	local kTempNextPos = actor:GetTranslate();\n\
	local kNextPos = Point3(kTempNextPos:GetX(), kTempNextPos:GetY(), kTempNextPos:GetZ());\n\
\n\
	actor:FreeMove(false);\n\
	local bZDist = 250 < math.abs(rkCurPos:GetZ() - actor:GetTraceFlyTargetLoc():GetZ());\n\
\n\
	local bIsFloor = true;\n\
	local iActionNo = 0;\n\
	local bIsRiding = false;\n\
\n\
	local kGuidString = actor:GetParam(\"TargetGUID\");\n\
	local kGuid = GUID(\"123\");\n\
	if nil ~= kGuidString then\n\
		kGuid:Set(kGuidString);\n\
	else\n\
		local kMyPilot = actor:GetPilot()\n\
		if kMyPilot:IsNil() then return 0 end\n\
		local kMyUnit = kMyPilot:GetUnit()\n\
		if kMyUnit:IsNil() then return 0 end\n\
		local kCallerGUID = kMyUnit:GetCaller();\n\
		if nil ~= kCallerGUID then\n\
			kGuid:Set(kMyUnit:GetCaller());\n\
		end\n\
	end\n\
\n\
	local kTargetPilot = g_pilotMan:FindPilot(kGuid)\n\
	if kTargetPilot:IsNil() then return 0 end\n\
	local kTargetActor = kTargetPilot:GetActor()\n\
	if kTargetActor:IsNil() then return 0 end\n\
	local kTargetPos = kTargetActor:GetPos()\n\
\n\
	if false == kTargetActor:IsNil() then\n\
		bIsFloor = kTargetActor:IsMeetFloor();\n\
		if false == kTargetActor:GetAction():IsNil() then\n\
			iActionNo = kTargetActor:GetAction():GetActionNo();\n\
			bIsRiding = kTargetActor:IsOnRidingObject();\n\
		end\n\
	end\n\
\n\
	local bTelePort = false;\n\
\n\
	if 150 < fDistance or bZDist then\n\
		if bIsFloor and false == bIsRiding then --     \n\
			local kTempNextPos = actor:GetTraceFlyTargetLoc();\n\
			kNextPos = Point3(kTempNextPos:GetX(), kTempNextPos:GetY(), kTempNextPos:GetZ());\n\
			\n\
			bTelePort = true;\n\
			actor:AttachParticle(1010, \"p_ef_heart\", \"ef_show_01_p_ef_heart\");\n\
		end\n\
	end\n\
	\n\
	if fLimitDistance < fDistance and false == bZDist and false == bTelePort then\n\
		--  \n\
		--kNextPos = rkCurPos + (kDiffPos * fSpeed * fFrameTime) + (kDiffPos * (fDistance-fLimitDistance) * fAccelateScale * fFrameTime);\n\
		kNextPos = kDiffPos:_Multiply(fSpeed * fFrameTime);\n\
		kNextPos:Add(rkCurPos);\n\
\n\
		local kTempNewPos = kDiffPos:_Multiply((fDistance - fLimitDistance) * fAccelateScale * fFrameTime);		\n\
		kNextPos:Add(kTempNewPos);\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local kTempDown = g_world:ThrowRay(Point3(kNextPos:GetX(), kNextPos:GetY(), kNextPos:GetZ()+50.0), Point3(0.0,0.0,-1.0), 200.0);\n\
		local kTempPos = g_world:ThrowRay(Point3(kNextPos:GetX(), kNextPos:GetY(), actor:GetTraceFlyTargetLoc():GetZ()+10), Point3(0.0,0.0,-1.0), 1000.0);	--    ?\n\
\n\
		if (-1 == kTempPos:GetX() and -1 and kTempPos:GetY() and -1 == kTempPos:GetZ()) or 95.0 < rkCurPos:GetZ() - kTempPos:GetZ() then\n\
			local kFrontDir = kDiffPos;\n\
			kFrontDir:Unitize();\n\
			local kTempFront = g_world:ThrowRay(actor:GetLastFloorPos(), kFrontDir, 40.0);	-- \n\
			if -1 == kTempFront:GetX() and -1 and kTempFront:GetY() and -1 == kTempFront:GetZ() then\n\
				actor:SetTraceFlyTargetLoc(rkCurPos); -- \n\
				fDistance = 0.0;\n\
				return fDistance;\n\
			end\n\
		else\n\
			kNextPos:SetZ(kTempPos:GetZ() + 25.0)\n\
		end\n\
\n\
		if -1 == kTempPos:GetX() and -1 and kTempPos:GetY() and -1 == kTempPos:GetZ() then -- \n\
			if false == bIsFloor then\n\
				if 100005440 == iActionNo then --\n\
					actor:SetFreeMove(true);--       \n\
					kNextPos:SetZ(actor:GetTraceFlyTargetLoc():GetZ());\n\
				else --  .  .  \n\
					actor:SetTraceFlyTargetLoc(rkCurPos); --  \n\
					kNextPos = actor:GetTranslate();\n\
					fDistance = 0.0;\n\
				end\n\
			end\n\
		end\n\
\n\
		kNextPos:SetZ(kTempPos:GetZ() + 25.0)\n\
	end\n\
\n\
	if false == actor:GetTranslate():IsEqual(kNextPos) then\n\
		actor:SetTranslate(kNextPos);\n\
		actor:SetTranslate(kNextPos,true);\n\
		actor:SetWorldTranslate(kNextPos);\n\
\n\
		if bCanRotate then\n\
			actor:SetMovingDir(kDiffPos);\n\
			actor:ConcilDirection(kDiffPos, true);\n\
		end\n\
	end\n\
\n\
	return fDistance;\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
-- Melee\n\
function Skill_Phantom_Ninja_Melee_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_Phantom_Ninja_Melee_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Phantom_Ninja_Melee_Fire(actor,action);\n\
	local iSlotCount = action:GetSlotCount()\n\
	action:SetSlot(math.random(0, iSlotCount))\n\
\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
function Skill_Phantom_Ninja_Melee_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Phantom_Ninja_Melee_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
\n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Skill_Phantom_Ninja_Melee_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Phantom_Ninja_Melee_OnCastingCompleted(actor,action);\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"RestoreItemModel Skill_Phantom_Ninja_Melee_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
	\n\
--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end\n\
    \n\
    end	\n\
	return true;\n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == actor:PlayNext()) then \n\
			actor:GetAction():SetNextActionName(\"a_battle_idle\");\n\
		end\n\
		actor:GetAction():ChangeToNextActionOnNextUpdate(true,true);\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
") + std::string("	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_Phantom_Ninja_Melee_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
function Skill_Phantom_Ninja_Melee_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or action:GetParamInt(2) > 0  then\n\
        \n\
            --  hit  \n\
            --    .\n\
            Skill_Phantom_Ninja_Melee_HitOneTime(actor,action);\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_Phantom_Ninja_Melee_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		if actor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(actor);\n\
				if kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
					local iTargetCount = kAction:GetTargetCount();\n\
					if iTargetCount == tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
						AddWarnDataStr(GetTextW(tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2);		\n\
					end\n\
				end\n\
\n\
				if IsSingleMode() then\n\
		        \n\
					Skill_Phantom_Ninja_Melee_HitOneTime(actor,kAction)\n\
					Skill_Phantom_Ninja_Melee_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
		        \n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		            \n\
				end			\n\
			\n\
			end	\n\
		end\n\
	\n\
        Skill_Phantom_Ninja_Melee_HitOneTime(actor,kAction)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [PROJECTILE_ID] :   ID.     .\n\
function Skill_Ice_Shower_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	if weapontype == 0 then\n\
		return false\n\
	end\n\
\n\
	return actor:IsMeetFloor()\n\
	\n\
end\n\
function Skill_Ice_Shower_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(1,0)	--    . \n\
\n\
	actor:StopJump()\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000652, 0) -- sa_iceshower\n\
	if false == pilot:IsNil() then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		local kBird = pilot:GetActor()\n\
		if false == kBird:IsNil() then\n\
			kBird:FreeMove(true)\n\
			local kTrans = actor:GetTranslate()\n\
			kTrans:SetZ(kTrans:GetZ()+5)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:AddActor(guid, kBird, kTrans, 9);\n\
			pilot:GetUnit():SetCaller(actor:GetPilotGuid())\n\
			local	kLookAt = actor:GetLookingDir()\n\
			kBird:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
			kBird:ReserveTransitAction(\"a_IceShowerSA\")\n\
			pilot:GetActor():ClearActionState();\n\
			if actor:IsMyActor() then\n\
	        	pilot:GetActor():SetUnderMyControl(true);\n\
		    end\n\
\n\
			local fScale = (action:GetSkillLevel()%10)*0.05 + 1.0	--  \n\
			kBird:SetTargetScale(fScale, 0.56)\n\
\n\
			local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
			if nil~=kSoundID and kSoundID~=\"\" then\n\
				actor:AttachSound(2783,kSoundID);\n\
			end\n\
		end\n\
	end\n\
\n\
	actor:AttachParticle(199, \"char_root\", \"ef_skill_iceshower_01_char_root\")\n\
	actor:AttachParticle(1196, \"char_root\", \"ef_skill_iceshower_02_char_root\")\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Ice_Shower_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Ice_Shower_Fire(actor,action)\n\
	action:SetSlot(action:GetCurrentSlot()+3);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_Ice_Shower_Shot_Fire(actor,action)\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end\n\
\n\
function Skill_Ice_Shower_LoadToWeapon(actor,action, kPos)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID()\n\
	local	kAttackNodeName = \"\"\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\")\n\
	end\n\
\n\
	local	kPilotGuid = actor:GetPilotGuid()\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid)\n\
	if nil~=kNewArrow and false==kNewArrow:IsNil() then\n\
		kNewArrow:LoadToPosition(kPos)\n\
	end\n\
	\n\
	return kNewArrow;\n\
end\n\
\n\
function Skill_Ice_Shower_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
	if 1==action:GetParamInt(1) then\n\
		Skill_Ice_Shower_FireProjectile(actor, action)\n\
		action:SetParamInt(1,0)\n\
	end\n\
	if action:GetParam(300) == \"finish\" then\n\
		return	false;\n\
	end\n\
	if actor:IsMyActor() and action:GetParamInt(6) == 0 then\n\
		if KeyIsDown(action:GetActionKeyNo(0)) == false then\n\
			action:SetParamInt(6,3);\n\
		end\n\
	end\n\
\n\
	if animDone == true then\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(3);\n\
			\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(3, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
\n\
			action:SetParam(3, \"end\")\n\
\n\
			return false\n\
		end\n\
	end\n\
	return true\n\
end\n\
function Skill_Ice_Shower_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:FreeMove(false)\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
\n\
	return true;\n\
end\n\
function Skill_Ice_Shower_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());	\n\
	\n\
	local	curParam = curAction:GetParam(3)\n\
	local	actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\" or curAction:GetParam(300)==\"finish\" then\n\
		return true;\n\
	end	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(3,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Ice_Shower_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		local	action = actor:GetAction()\n\
		\n\
		CheckNil(nil==action)\n\
		CheckNil(action:IsNil())\n\
		\n\
		actor:ClearIgnoreEffectList()\n\
	end\n\
end\n\
\n\
function Skill_Ice_Shower_OnOverridePacket(actor,action,packet)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if action:GetActionParam() == AP_FIRE then\n\
		packet:PushInt(3);\n\
    end    \n\
end\n\
\n\
function Skill_Ice_Shower_FireProjectile(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local	iAttackRange = action:GetAbil(AT_2ND_AREA_PARAM2)\n\
	if 0==iAttackRange then\n\
		iAttackRange = 50\n\
	end\n\
\n\
	local kActorPos = actor:GetTranslate()\n\
\n\
	local	kLookingDir = actor:GetLookingDir()\n\
	kLookingDir:Unitize()\n\
	kLookingDir:Multiply(-1)\n\
	\n\
	--  \n\
	local	kRotateAxis = actor:GetLookingDir()\n\
	kRotateAxis:Cross(Point3(0,0,1));\n\
	kRotateAxis:Unitize()\n\
	\n\
	local kAddZ = iAttackRange*0.5+30\n\
	local kRange = action:GetAbil(AT_1ST_AREA_PARAM3)\n\
	if 0==kRange then\n\
		kRange = kAddZ\n\
	end\n\
\n\
	local kAngle = 90-math.atan(kRange/kAddZ)*180/math.pi\n\
	fRotateAngle = -kAngle*math.pi/180.0;\n\
\n\
	local Projectile_cnt = action:GetAbil(AT_PROJECTILE_NUM)\n\
	if nil==Projectile_cnt or 0==Projectile_cnt then\n\
		Projectile_cnt = 20\n\
	end\n\
\n\
	local	kDelay = actor:GetAnimationInfo(\"PROJECTILE_DELAY\")\n\
	if nil==kDelay or \"\"==kDelay then\n\
		kDelay = (1667*0.001)/Projectile_cnt--tonumber(kDelay)	--         \n\
	else\n\
		kDelay = tonumber(kDelay)	--         \n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local i = 0\n\
	while i<Projectile_cnt do\n\
		local kOriginPos = Point3(math.random(-iAttackRange,iAttackRange), math.random(-iAttackRange,iAttackRange), 0)\n\
		kOriginPos:Rotate(kRotateAxis, kAngle*math.pi/180.0)\n\
		local	dir = actor:GetLookingDir()\n\
		dir:Rotate(kRotateAxis, fRotateAngle)\n\
		dir:Unitize()\n\
\n\
		kOriginPos:Add(kActorPos)\n\
		kOriginPos:SetZ(kOriginPos:GetZ()+kAddZ)\n\
		local	kArrow = Skill_Ice_Shower_LoadToWeapon(actor,action, kOriginPos)\n\
\n\
		local TargetPos = g_world:ThrowRay(kOriginPos,dir,1500)\n\
	\n\
		kArrow:SetParamValue(\"index\", tostring(i))\n\
		kArrow:SetParentPilotGuid(actor:GetPilotGuid());\n\
		kArrow:SetHide(true)\n\
		kArrow:SetTargetLoc(TargetPos)\n\
		kArrow:SetScale(math.random(0.7, 1.0))\n\
		kArrow:DelayFire(i*kDelay);--	!\n\
		i=i+1\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
function Skill_Ice_ShowerSA_OnCheckCanEnter(actor,action)\n\
	return true\n\
end\n\
function Skill_Ice_ShowerSA_OnEnter(actor, action)\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
	return true\n\
end\n\
\n\
function Skill_Ice_ShowerSA_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Skill_Ice_ShowerSA_Shot_Fire(actor,action)\n\
\n\
end\n\
\n\
\n\
function Skill_Ice_ShowerSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil())\n\
\n\
	return not actor:IsAnimationDone()\n\
end\n\
function Skill_Ice_ShowerSA_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	return true;\n\
end\n\
function Skill_Ice_ShowerSA_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Ice_ShowerSA_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		local kCallerGuid = actor:GetCallerGuid()\n\
		if true == kCallerGuid:IsNil() then return end\n\
\n\
		local kCallerPilot = g_pilotMan:FindPilot(kCallerGuid)\n\
		if true == kCallerPilot:IsNil() then return end\n\
\n\
		local kCallerActor = kCallerPilot:GetActor()\n\
		if true == kCallerActor:IsNil() then return end\n\
\n\
		local kCallerAction = kCallerActor:GetAction()\n\
		if true == kCallerAction:IsNil() then return end\n\
\n\
		kCallerAction:SetParamInt(1, 1)\n\
	elseif textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0.0, 0.25); --   \n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_DeathStinger_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_DeathStinger_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_DeathStinger_Fire(actor,action);\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
	actor:AttachParticle(7212,\"char_root\",\"ef_skill_death_stinger_02_char_root\"); \n\
end\n\
function Skill_DeathStinger_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
--	action:CreateActionTargetList(actor);\n\
	\n\
	actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,0,0);\n\
	action:SetParamFloat(2,actor:GetPos():GetX());	--	  \n\
	action:SetParamFloat(3,actor:GetPos():GetY());	--	  \n\
	action:SetParamFloat(4,actor:GetPos():GetZ());	--	  \n\
	action:SetParamFloat(5,g_world:GetAccumTime());	--	  \n\
	action:SetParamInt(6,0)	--	Step	\n\
		\n\
	actor:FreeMove(true);\n\
	actor:StopJump();\n\
	actor:SetMovingDelta(Point3(0,0,0));\n\
end\n\
\n\
function Skill_DeathStinger_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actionID = action:GetID()\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_DeathStinger_OnCastingCompleted(actor,action);\n\
\n\
	--   \n\
	action:SetParamAsPoint(7, actor:GetPos());\n\
\n\
	actor:StopJump()\n\
\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000653, 0) -- sa_iceshower\n\
	if false == pilot:IsNil() then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		local kBird = pilot:GetActor()\n\
		if false == kBird:IsNil() then\n\
			local kTrans = actor:GetTranslate()\n\
			kBird:FreeMove(true)\n\
			kTrans:SetZ(kTrans:GetZ()+5)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:AddActor(guid, kBird, kTrans, 9);\n\
			pilot:GetUnit():SetCaller(actor:GetPilotGuid())\n\
			local	kLookAt = actor:GetLookingDir()\n\
			kBird:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
			kBird:ReserveTransitAction(\"a_DeathStingerSA\")\n\
			pilot:GetActor():ClearActionState();\n\
			if actor:IsMyActor() then\n\
	        	pilot:GetActor():SetUnderMyControl(true);\n\
		    end\n\
\n\
			local fScale = (action:GetSkillLevel()%10)*0.05 + 1.0	--  \n\
			kBird:SetTargetScale(fScale, 0.56)\n\
			action:SetParam(123,guid:GetString())	--GUID \n\
			g_pilotMan:InsertPilot(guid, pilot)\n\
		end\n\
	end\n\
\n\
	action:SetParamInt(122,0)\n\
	action:SetParamInt(121,0)\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_DeathStinger_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local	iStep = action:GetParamInt(6);\n\
\n\
	local curAnimSlot = action:GetCurrentSlot();\n\
\n\
	if curAnimSlot == 0 then\n\
		if animDone == true then\n\
			action:SetSlot(action:GetCurrentSlot()+1);\n\
			actor:PlayCurrentSlot();\n\
			local	iBaseClassID = actor:GetPilot():GetBaseClassID()\n\
			if iBaseClassID == CT_FIGHTER then\n\
				actor:AttachParticle(493,\"char_root\",\"ef_fig_tackle_char_root\");\n\
			elseif iBaseClassID == CT_MAGICIAN then\n\
				actor:AttachParticle(494,\"char_root\",\"ef_Lightningamor_01_char_root\");\n\
			end\n\
\n\
			local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
			if kSoundID~=\"\" then\n\
				actor:AttachSound(2783,kSoundID);\n\
			end	\n\
		end	\n\
	else\n\
		if action:GetActionParam() == AP_FIRE then\n\
			local	kStartPos = Point3(action:GetParamFloat(2),action:GetParamFloat(3),action:GetParamFloat(4));\n\
			local	fMoveSpeed = 600;\n\
			   \n\
			local kNewPos = actor:GetPos();\n\
			local kOldPos = action:GetParamAsPoint(7);\n\
			kOldPos:SetZ(0)\n\
			kNewPos:SetZ(0); --Z  .     \n\
\n\
			local fDistance = kNewPos:Distance(kOldPos);\n\
			local fMaxDistance = action:GetAbil(AT_CASTER_MOVERANGE)\n\
			if 0==fMaxDistance then\n\
				fMaxDistance=144\n\
			end\n\
\n\
			--   \n\
			local AttackCount = action:GetParamInt(121)\n\
			if 0.0 <= fDistance then\n\
				--  \n\
				local fDistance2 = fMaxDistance - fDistance;\n\
				if 1>=fDistance2 then\n\
					local guid = GUID(action:GetParam(123))\n\
					local Death = g_pilotMan:FindPilot(guid)\n\
					if false==Death:IsNil() and false==Death:GetActor():IsNil() then\n\
						Death:GetActor():EndBodyTrail()\n\
					end\n\
				end\n\
\n\
				--     \n\
				--       .\n\
				local kDirection = kNewPos:_Subtract(kOldPos);\n\
				kDirection:Unitize();\n\
				kDirection:Multiply(fMoveSpeed * frameTime);\n\
				kDirection:Add(kNewPos);\n\
\n\
				--    \n\
				local fDistance3 = kDirection:Distance(kOldPos);\n\
\n\
				--      \n\
				if fMaxDistance - fDistance3 < 0 then\n\
					--fMoveSpeed   .				\n\
					fMoveSpeed = fDistance2 / frameTime;\n\
				end\n\
				local iRate = math.floor((fDistance/fMaxDistance)*100/20)\n\
				if 5>AttackCount then\n\
					if iRate ~= action:GetParamInt(122) or iRate >= AttackCount then\n\
					    action:CreateActionTargetList(actor);\n\
						if action:GetTargetCount()>0 then\n\
						    action:BroadCastTargetListModify(actor:GetPilot());\n\
							action:SetParamInt(121,action:GetParamInt(121)+1)\n\
						end\n\
						action:ClearTargetList()\n\
						action:SetParamInt(122,iRate)\n\
					end\n\
				end\n\
			end\n\
		\n\
			local kMovingDir = actor:GetLookingDir()\n\
			kMovingDir:Multiply(fMoveSpeed);\n\
			\n\
			actor:SetMovingDelta(kMovingDir);\n\
			\n\
			local	fCurrentDistance = kStartPos:Distance(actor:GetPos());\n\
			local	fElapsedTime = accumTime - action:GetParamFloat(5);\n\
\n\
			ODS(\"fCurrentDistance : \" .. fCurrentDistance .. \" fMaxDistance : \" .. fMaxDistance .. \" fElapsedTime : \" .. fElapsedTime);\n\
			if fCurrentDistance >= fMaxDistance or fElapsedTime > 1 then\n\
\n\
				action:SetParamInt(6,1);\n\
				action:SetParamFloat(5,accumTime);\n\
--				Skill_DeathStinger_DoDamageToTargets(actor);\n\
				\n\
				actor:DetachFrom(493);\n\
				\n\
				local curActionParam = action:GetParam(0)\n\
				if curActionParam == \"GoNext\" then\n\
					if 2==curAnimSlot then\n\
						return false==animDone	--  \n\
					elseif 1==curAnimSlot then\n\
						actor:PlayNext()\n\
						local guid = GUID(action:GetParam(123))\n\
						local Death = g_pilotMan:FindPilot(guid)\n\
						if false==Death:IsNil() and false==Death:GetActor():IsNil() then\n\
							Death:GetActor():PlayNext()\n\
						end\n\
\n\
						action:SetParam(0, \"null\")\n\
						action:SetParam(1, \"end\")\n\
						return true\n\
					end\n\
					nextActionName = action:GetParam(1);\n\
\n\
					action:SetParam(0, \"null\")\n\
					action:SetParam(1, \"end\")\n\
					\n\
					action:SetNextActionName(nextActionName)\n\
					return false;\n\
				else\n\
					if true==animDone then\n\
					end\n\
					if 2==curAnimSlot then\n\
						if false==animDone then\n\
\n\
							action:SetParam(0, \"null\")\n\
							action:SetParam(1, \"end\")\n\
							return true	--  \n\
						end\n\
					elseif 1==curAnimSlot then\n\
						actor:PlayNext()\n\
						actor:PlayCurrentSlot()\n\
						local guid = GUID(action:GetParam(123))\n\
						local Death = g_pilotMan:FindPilot(guid)\n\
						if false==Death:IsNil() and false==Death:GetActor():IsNil() then\n\
							Death:GetActor():PlayNext()\n\
						end\n\
						action:SetParam(0, \"null\")\n\
						action:SetParam(1, \"end\")\n\
						return true\n\
					end\n\
					action:SetParam(1, \"end\")\n\
					return false\n\
				end						\n\
			\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DeathStinger_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	actor:DetachFrom(493);\n\
	actor:DetachFrom(494);\n\
	actor:DetachFrom(7212);	\n\
	actor:EndBodyTrail();\n\
	actor:FreeMove(false);\n\
\n\
	Skill_DeathStinger_RemoveEntity(actor:GetAction())\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_DeathStinger_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	ODS(\"curParam : \" .. curParam .. \"\\n\", false, 1509)\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_DeathStinger_RemoveEntity(curAction)\n\
	local guid = GUID(curAction:GetParam(123))\n\
	local Death = g_pilotMan:FindPilot(guid)	--      \n\
	if false==Death:IsNil() and false==Death:GetActor():IsNil() then\n\
		Death:GetActor():GetAction():SetSlot(2)\n\
		Death:GetActor():PlayCurrentSlot()\n\
	end\n\
end\n\
\n\
function Skill_DeathStinger_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
\n\
	local kAction = actor:GetAction()\n\
\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	local kActionID = kAction:GetID()\n\
\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
\n\
	local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
	local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
	\n\
	if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
		local nUnitSize = actorTarget:GetAbil(AT_UNIT_SIZE);\n\
		local nEffectScale = 1.0;\n\
		if 1 == nUnitSize then --1:Small\n\
			nEffectScale = 1.0;\n\
			ODS(\"Small Monster\\n\");\n\
		elseif 2 == nUnitSize then --2:Middle\n\
			nEffectScale = 1.5;\n\
			ODS(\"Middle Monster\\n\");\n\
		elseif 3 == nUnitSize then --3:Large\n\
			nEffectScale = 2.0;\n\
			ODS(\"Large Monster\\n\");\n\
		end\n\
		\n\
		actorTarget:AttachParticleS(12,kHitTargetEffectTargetNodeID,kHitTargetEffectID, nEffectScale);\n\
	else\n\
		if kActionResult:GetCritical() then\n\
			actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
		else\n\
			actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
		end	\n\
	end\n\
\n\
	--   \n\
	local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
\n\
	--   \n\
	local actionName = kActionID\n\
	if kActionResult:GetCritical() then\n\
		actionName = \"Critical_dmg\"\n\
	end\n\
	actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, kActionTargetInfo);\n\
\n\
end\n\
function Skill_DeathStinger_DoDamageToTargets(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	kAction = actor:GetAction();\n\
\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
\n\
	local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end\n\
\n\
	local iTargetCount = kAction:GetTargetCount();\n\
	if iTargetCount>0 then\n\
\n\
		local i = 0;\n\
		while i<iTargetCount do\n\
\n\
			local kActionResult = kAction:GetTargetActionResult(i);\n\
			if kActionResult:IsNil() == false then\n\
\n\
				local kTargetGUID = kAction:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and kActionResult:IsMissed() == false then\n\
\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					Skill_DeathStinger_DoDamage(actor,actorTarget,kActionResult,kAction:GetTargetInfo(i));\n\
\n\
				end\n\
			end\n\
\n\
			i=i+1;\n\
\n\
		end\n\
\n\
	end\n\
\n\
	if kAction:GetTargetList():IsNil() == false then\n\
		kAction:GetTargetList():ApplyActionEffects();\n\
	end\n\
	kAction:ClearTargetList();	\n\
\n\
end\n\
\n\
\n\
function Skill_DeathStinger_OnEvent(actor,textKey)\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_DeathStinger_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if bIsBefore == false then\n\
		--  .\n\
		Skill_DeathStinger_DoDamageToTargets(actor)   --   \n\
		action:GetTargetList():ApplyActionEffects();    \n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_DeathStingerSA_OnCheckCanEnter(actor,action)\n\
	return true\n\
end\n\
function Skill_DeathStingerSA_OnEnter(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	action:SetDoNotBroadCast(true)\n\
	action:SetParamAsPoint(1, actor:GetTranslate())\n\
	return true\n\
end\n\
\n\
function Skill_DeathStingerSA_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:PlayCurrentSlot()\n\
end\n\
\n\
function Skill_DeathStingerSA_Shot_Fire(actor,action)\n\
\n\
end\n\
\n\
\n\
function Skill_DeathStingerSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	local action = actor:GetAction()\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local iSlot = action:GetCurrentSlot()\n\
	local bDone = actor:IsAnimationDone()\n\
	if true==bDone then\n\
		if 2==iSlot	then\n\
			return false == bDone\n\
		elseif 0==iSlot then\n\
			actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,0,0);\n\
		end\n\
\n\
		actor:PlayNext()\n\
	end\n\
\n\
--	if 2>iSlot then\n\
		local guid = actor:GetCallerGuid()\n\
		if false==guid:IsNil() then\n\
			local Caller = g_pilotMan:FindPilot(guid)\n\
			if false==Caller:IsNil() then		\n\
				local CallerActor = Caller:GetActor()\n\
				if false == CallerActor:IsNil() then\n\
					actor:SetTranslate(CallerActor:GetTranslate())\n\
				end\n\
			else\n\
				return false\n\
			end\n\
		end\n\
--	end\n\
	\n\
	return true\n\
end\n\
function Skill_DeathStingerSA_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:EndBodyTrail();	-- \n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	return true;\n\
end\n\
function Skill_DeathStingerSA_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_DeathStingerSA_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0.0, 0.25); --   \n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 15[int] : AT_COUNT\n\
-- 16[float] : total timer time\n\
-- 17[int] :  \n\
\n\
\n\
\n\
function Skill_WarLord_SoulDrain_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(15, action:GetAbil(AT_COUNT));\n\
	action:SetParamFloat(16,5.0);\n\
	action:SetParamInt(17,0);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	local kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local kEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNodeID ~= \"\" then\n\
		actor:AttachParticle(201, kEffectNode, kEffectID);\n\
	end	\n\
	\n\
	Skill_WarLord_SoulDrain_Fire(actor,action);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		local fElapsedTime = accumTime - action:GetParamFloat(11);\n\
		if fElapsedTime > action:GetParamInt(16) then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(101);\n\
	actor:DetachFrom(102);\n\
	\n\
	actor:RestoreLockBidirection();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Skill_WarLord_SoulDrain_HitOneTime(actor,action);\n\
    end\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnEvent(actor,textKey,seqID)\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_OnTimer(actor,accumtime,action,iTimerID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local hitcount = action:GetParamInt(17);\n\
	if hitcount >= action:GetParamInt(15) then\n\
		return true;\n\
	end\n\
\n\
	action:SetParamInt(17, hitcount + 1 );\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	action:ClearTargetList();\n\
		\n\
	if IsSingleMode() then\n\
    	Skill_WarLord_SoulDrain_OnTargetListModified(actor,action,false);\n\
    	return true;\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:PlayNext();\n\
	\n\
	if actor:IsMyActor() == true then\n\
		local totalTime = action:GetParamFloat(16);\n\
		local termTime = totalTime / (action:GetParamInt(15) + 1);\n\
\n\
		action:StartTimer(totalTime,termTime,0);\n\
	end\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_CreateProjectile(kActor, kAction, kPos)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	if nil == kProjectileID then\n\
		kProjectileID = kActor:GetEquippedWeaponProjectileID()\n\
		if kProjectileID == \"\" then\n\
			kProjectileID = \"PROJECTILE_Big_Master_machine_shot_02\"\n\
		end\n\
	end\n\
	\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	--kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	kNewArrow:LoadToPosition(kPos)\n\
\n\
	return kNewArrow\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_FireProjectile(kActor, kAction)\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local kTargetList = kAction:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	local i = 0\n\
	\n\
	while i<iTargetCount do\n\
		local kTargetGUID = kAction:GetTargetGUID(i)\n\
		local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
		if kTargetPilot:IsNil() == false then\n\
			local kTargetActor = kTargetPilot:GetActor()\n\
			if kTargetActor:IsNil() == false then\n\
				local kTargetPos = kTargetActor:GetPos()\n\
				local kProjectile = Skill_WarLord_SoulDrain_CreateProjectile(kActor, kAction, kTargetPos)\n\
				\n\
				if kProjectile ~= nil then\n\
					if kProjectile:IsNil() == false then\n\
						local kGoalPos = kTargetActor:GetPos()\n\
						kGoalPos:SetZ(kGoalPos:GetZ() + 500)\n\
						kProjectile:SetTargetLoc(kGoalPos)\n\
						kProjectile:Fire()\n\
					end\n\
				end\n\
			end\n\
		end\n\
		i = i + 1\n\
	end\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_WarLord_SoulDrain_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
        actorTarget:AttachParticle(7111+iHitCount,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	actor:AttachParticle(101,\"p_wp_r_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
	actor:AttachParticle(102,\"p_wp_l_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
	\n\
	local kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local kEffectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectNode, kEffectID);\n\
	end\n\
    \n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	actor:AttachParticleS(201, \"char_root\", \"ef_skill_souldrain_01_char_root\",0.4);\n\
   return true\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:RestoreLockBidirection();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
	end\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_OnEvent(actor,textKey,seqID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		Skill_WarLord_SoulDrain_Ready_Fire(actor,action);\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:PlayNext();\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
		action:ClearTargetList();\n\
	end\n\
    \n\
	local kTargetPos = actor:GetPos();\n\
	Skill_WarLord_SoulDrain_Ready_CreateDarkElemental(actor,action,kTargetPos);\n\
	local kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
	local kEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectNode ~= \"\" then\n\
		actor:AttachParticle(202, kEffectNode, kEffectID);\n\
	end\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Ready_CreateDarkElemental(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\");\n\
	guid:Generate();\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000701, 0);\n\
\n\
	if pilot:IsNil() == false then\n\
		local kNewActor = pilot:GetActor();\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, kNewActor, kTargetPos, 9);\n\
		kNewActor:FreeMove(true);\n\
		kNewActor:SetTranslate(kTargetPos);\n\
		kNewActor:ReserveTransitAction(\"a_SoulDrain_Play\");\n\
		kNewActor:ClearActionState()\n\
		local	kPathNormal = actor:GetPathNormal();\n\
		kPathNormal:Multiply(-1);\n\
		kNewActor:LookAt(kNewActor:GetTranslate():_Add(kPathNormal), true)	\n\
		kNewActor:PlayCurrentSlot();\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
\n\
	Skill_WarLord_SoulDrain_Finish_Fire(actor,action);	\n\
	return true\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end\n\
\n\
	actor:RestoreLockBidirection();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_OnEvent(actor,textKey,seqID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_WarLord_SoulDrain_Finish_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:PlayNext();\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
		action:ClearTargetList();\n\
	end\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :  \n\
\n\
function Skill_SoulDrain_play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_SoulDrain_play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if iSlotNum == 0 then\n\
			if animDone == true then\n\
				action:SetSlot(iSlotNum + 1);\n\
				actor:PlayCurrentSlot(true);\n\
				action:SetParamFloat(12,accumTime);\n\
				\n\
				local kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
				local kEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
				if kEffectID ~= \"\" and kEffectNode ~= \"\" then\n\
					actor:AttachParticleS(201, kEffectNode, kEffectID,0.4);\n\
				end\n\
			end\n\
		elseif iSlotNum == 1 then\n\
			local fElapsedTime = accumTime - action:GetParamFloat(12);\n\
			if fElapsedTime >= 3.5 then\n\
				action:SetSlot(iSlotNum + 1);\n\
				actor:PlayCurrentSlot(true);\n\
			end\n\
		elseif iSlotNum == 2 then\n\
			if animDone == true then\n\
				action:SetParamInt(10,1);\n\
			end\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_SoulDrain_play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_SoulDrain_play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_SoulDrain_play_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_SoulDrain_play_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_SoulDrain_play_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Skill_SoulDrain_play_OnCastingCompleted(actor,action,bIsBefore)\n\
end") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[int] :  \n\
\n\
function Skill_WarLord_MagmaPiston_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(12,0);\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		--    .\n\
		actor:AttachParticle(101,\"p_wp_r_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
		actor:AttachParticle(102,\"p_wp_l_hand\",\"ef_mag_charge01_loop_p_wp_r_hand_p_wp_l_hand\");	\n\
	end\n\
	\n\
	local kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local kEffectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectNode, kEffectID);\n\
	end\n\
	\n\
	-- local kTargetPos = actor:GetPos();\n\
	-- Skill_WarLord_MagmaPiston_CreateDarkElemental(actor,action,kTargetPos);\n\
    \n\
   return true\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
	local kTargetPos = actor:GetPos();\n\
	Skill_WarLord_MagmaPiston_CreateDarkElemental(actor,action,kTargetPos);\n\
	local kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local kEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNodeID ~= \"\" then\n\
		actor:AttachParticle(202, kEffectNode, kEffectID);\n\
	end\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			if curSlot == 0 then\n\
				Skill_WarLord_MagmaPiston_Fire(actor,action);\n\
				return true\n\
			end\n\
		end\n\
\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(11);\n\
\n\
		if curSlot == 1 and fElapsedTime > 5 then\n\
			actor:PlayNext();\n\
			return true;\n\
		end\n\
		if animDone == true and curSlot == 2 then\n\
			action:SetParamInt(10,1);\n\
			return true;\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:DetachFrom(101, true);\n\
	actor:DetachFrom(102, true);\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202, true);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
\n\
	actor:RestoreLockBidirection();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2783,kSoundID);\n\
		end	\n\
		if actor:IsMyActor() then\n\
			QuakeCamera(4, 1);\n\
		end\n\
	end\n\
	return true;\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	-- local kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    -- local kEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	-- if kEffectID ~= \"\" and kEffectTargetNodeID ~= \"\" then\n\
		-- actor:AttachParticle(202, kEffectNode, kEffectID);\n\
	-- end\n\
	\n\
	actor:PlayNext();\n\
end\n\
\n\
function Skill_WarLord_MagmaPiston_CreateDarkElemental(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\");\n\
	guid:Generate();\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000702, 0);\n\
		if pilot:IsNil() == false then\n\
		local kNewActor = pilot:GetActor();\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, kNewActor, kTargetPos, 9);\n\
		kNewActor:FreeMove(true);\n\
		kNewActor:SetTranslate(kTargetPos);\n\
		kNewActor:ReserveTransitAction(\"a_MagmaPiston_Play\");\n\
		kNewActor:ClearActionState()\n\
		local	kPathNormal = actor:GetPathNormal();\n\
		kPathNormal:Multiply(-1);\n\
		kNewActor:LookAt(kNewActor:GetTranslate():_Add(kPathNormal), true)	\n\
		kNewActor:PlayCurrentSlot();\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :  \n\
\n\
function Skill_MagmaPiston_play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	local kPos = actor:GetPos();\n\
	kPos:SetZ(kPos:GetZ()-30);\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_MagmaPiston_play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if iSlotNum == 0 then\n\
			if animDone == true then\n\
				action:SetSlot(iSlotNum + 1);\n\
				actor:PlayCurrentSlot(true);\n\
				action:SetParamFloat(12,accumTime);\n\
			end\n\
		elseif iSlotNum == 1 then\n\
			local fElapsedTime = accumTime - action:GetParamFloat(12);\n\
			if fElapsedTime >= 3.0 then\n\
				action:SetSlot(iSlotNum + 1);\n\
				actor:PlayCurrentSlot(true);\n\
			end\n\
		elseif iSlotNum == 2 then\n\
			if animDone == true then\n\
				action:SetParamInt(10,1);\n\
			end\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_MagmaPiston_play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_MagmaPiston_play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_MagmaPiston_play_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_MagmaPiston_play_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_MagmaPiston_play_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Skill_MagmaPiston_play_OnCastingCompleted(actor,action,bIsBefore)\n\
end") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :   \n\
-- 13[int] :  \n\
\n\
function Skill_MagmaPiston_attack_OnCheckCanEnter(actor,action)\n\
	return true;\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	  \n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	local iTime = actor:GetAbil(AT_TIME) / AT_CALCUATEABIL_MAX;\n\
	\n\
	action:SetParamFloat(12,iTime + g_world:GetAccumTime());\n\
	action:SetParamInt(13,0);\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	return true\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iState = action:GetParamInt(10);\n\
	if iState == 0 then\n\
		local startTime = action:GetParamFloat(12);\n\
		local startOK = action:GetParamInt(13);\n\
		if startOK == 0 and accumTime > startTime then\n\
			action:StartTimer(4.0,1.0,0);\n\
			action:SetParamInt(13,1);\n\
		end\n\
		\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(12);\n\
		if fElapsedTime > 5 then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true;\n\
	end\n\
	\n\
	return false;\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnTimer(actor,accumtime,action,iTimerID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if actor:IsUnderMyControl() then\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
		action:ClearTargetList();\n\
	end\n\
	\n\
	local effectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
	local effectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if effectID ~= \"\" and effectNode ~= \"\" then\n\
		actor:DetachFrom(201, true);\n\
		actor:AttachParticleS(201, effectNode, effectID, 0.12)\n\
	end\n\
	\n\
	if IsSingleMode() then\n\
    	Skill_WarLord_SoulDrain_OnTargetListModified(actor,action,false);\n\
    	return true;\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
function MagmaPistonPlayInit(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	-- actor:SetHide(true);\n\
	-- actor:SetHideShadow(true);	\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnOverridePacket(actor,action,packet)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end\n\
\n\
function Skill_MagmaPiston_attack_OnCastingCompleted(actor,action)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[int] : timer count\n\
-- 15[int] : AT_COUNT\n\
-- 16[float] : total timer time\n\
\n\
function Skill_Maniac_HellShout_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	action:SetParamInt(10,0) -- 	\n\
	action:SetParamFloat(11,g_world:GetAccumTime()) -- \n\
	action:SetParamInt(15, action:GetAbil(AT_COUNT));\n\
	action:SetParamFloat(16, 1);\n\
	Skill_Maniac_HellShout_Fire(actor,action)\n\
		\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	local kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local kEffectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectNode, kEffectID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_HellShout_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kTargetPos = actor:GetPos()\n\
	Skill_Maniac_HellShout_CreateElemental(actor,action,kTargetPos)\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	iState = action:GetParamInt(10);\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1)\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:DetachFrom(201, true);\n\
	actor:DetachFrom(202);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Maniac_HellShout_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		if actor:IsMyActor() == true then\n\
			-- action:CreateActionTargetList(actor);\n\
			-- action:BroadCastTargetListModify(actor:GetPilot());\n\
			-- action:ClearTargetList();\n\
			local totalTime = action:GetParamFloat(16);\n\
			local termTime = totalTime / (action:GetParamInt(15) + 1);\n\
			action:StartTimer(totalTime,termTime,0);\n\
			action:SetParamInt(12,action:GetParamInt(15));\n\
		end\n\
		\n\
		local kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
		local kEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
		if kEffectID ~= \"\" and kEffectNode ~= \"\" then\n\
			actor:AttachParticle(202, kEffectNode, kEffectID);\n\
		end\n\
		QuakeCamera(1.0, 0.5);\n\
	end\n\
	return	true;\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
\n\
end\n\
\n\
function Skill_Maniac_HellShout_CreateElemental(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000704, 0)\n\
	if pilot:IsNil() == false then\n\
		local newActor = pilot:GetActor();\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, newActor, kTargetPos, 9)\n\
		newActor:FreeMove(true)\n\
		newActor:ReserveTransitAction(\"a_HellShout_Play\")\n\
		newActor:ClearActionState()\n\
		local	kLookAt = actor:GetLookingDir()\n\
		newActor:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
		newActor:PlayCurrentSlot();\n\
	end\n\
end\n\
\n\
function Skill_Maniac_HellShout_OnTimer(actor, accumTime, action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local count = action:GetParamInt(12);\n\
	\n\
	if count == 0 then\n\
		return true\n\
	end\n\
\n\
	action:SetParamInt(12, count-1);\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	action:ClearTargetList();\n\
	\n\
	return true;\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 19[Int] : \n\
\n\
function Skill_Maniac_Marionette_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(19,200);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kEffectTargetNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectTargetNode, kEffectID);\n\
	end\n\
	\n\
	Skill_Maniac_Marionette_CreateElemental(actor, action, actor:GetPos());\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iState = action:GetParamInt(10);\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			if iSlotNum == 0 then\n\
				action:SetSlot(iSlotNum+1);\n\
				actor:PlayCurrentSlot();\n\
				actor:DetachFrom(201, true);\n\
			elseif iSlotNum == 1 or iSlotNum == 2 then\n\
				action:SetSlot(iSlotNum+1);\n\
				actor:PlayCurrentSlot();\n\
				local   kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
				local   kEffectTargetNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
				if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
					actor:AttachParticle(202, kEffectTargetNode, kEffectID);\n\
				end\n\
			elseif iSlotNum == 3 then\n\
				action:SetParamInt(10,1);\n\
			end\n\
		end\n\
\n\
		if iSlotNum == 1 then\n\
			local findTarget = Skill_Maniac_Marionette_SearchTarget(actor,action);\n\
			if findTarget == true then\n\
				action:SetSlot(2);\n\
				actor:PlayCurrentSlot();\n\
				local guid = action:GetGUIDInContainer(0);\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				local elemental = g_world:FindActor(guid);\n\
				if elemental:IsNil() == false then\n\
					local elementalAction = elemental:GetAction();\n\
					if elementalAction:IsNil() == false then\n\
						elementalAction:SetSlot(2);\n\
						elemental:PlayCurrentSlot();\n\
					else\n\
						elemental:PlayNext();\n\
					end\n\
					elemental:SetTranslate(actor:GetPos());\n\
				end\n\
				local   kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
				local   kEffectTargetNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
				if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
					actor:AttachParticle(202, kEffectTargetNode, kEffectID);\n\
				end\n\
			else\n\
				local velocity = action:GetParamInt(19);\n\
				local dir = actor:GetLookingDir();\n\
				dir:Multiply(velocity);\n\
				actor:SetMovingDelta(dir);\n\
			end\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction()	\n\
	local actionID = action:GetID()\n\
	\n\
	if curAction:GetNextActionName() ~= actionID then\n\
		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
\n\
function Skill_Maniac_Marionette_OnEvent(actor,textKey,seqID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		Skill_Maniac_Marionette_Fire(actor,action);\n\
	end\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_Marionette_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
		action:ClearTargetList();\n\
	end\n\
	\n\
	if IsSingleMode() then\n\
    	Skill_Maniac_Marionette_OnTargetListModified(actor,action,false);\n\
	end	\n\
end\n\
\n\
function Skill_Maniac_Marionette_CreateElemental(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\");\n\
	guid:Generate();\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000706, 0);\n\
	if pilot:IsNil() == false then\n\
		action:AddNewGUID(guid);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9);\n\
		pilot:GetActor():FreeMove(true)\n\
		pilot:GetActor():ReserveTransitAction(\"a_MarionetteSA\");\n\
		pilot:GetActor():ClearActionState()\n\
		local	kLookAt = actor:GetLookingDir()\n\
		pilot:GetActor():LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
		pilot:GetActor():PlayCurrentSlot();\n\
		local entityAction = pilot:GetActor():GetReservedTransitAction();\n\
		if entityAction:IsNil() == false then\n\
			entityAction:SetParamInt(19, action:GetParamInt(19)); --  \n\
			entityAction:AddNewGUID(actor:GetPilotGuid());\n\
		end\n\
		actor:AddSummonUnit(guid);\n\
	end\n\
end\n\
\n\
function Skill_Maniac_Marionette_SearchTarget(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:CreateActionTargetList(actor, true);\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	local findTarget = false;\n\
	if iTargetCount > 0 then\n\
		local actorPos = actor:GetPos();\n\
		local kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local iSkillRange = 100;\n\
		if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
			iSkillRange = kSkillDef:GetAbil(AT_ATTACK_RANGE);\n\
			if iSkillRange == 0 then\n\
				iSkillRange = 100;\n\
			end\n\
		end\n\
		local checkRange = iSkillRange * 0.7;\n\
		local i=0;\n\
		while i < iTargetCount do\n\
			local targetInfo = kTargetList:GetTargetInfo(i);\n\
			local targetGUID = targetInfo:GetTargetGUID();\n\
			local targetPilot = g_pilotMan:FindPilot(targetGUID);\n\
			if targetPilot:IsNil() == false then\n\
				local targetActor = targetPilot:GetActor();\n\
				if targetActor:IsNil() == false then\n\
					local targetPos = targetActor:GetPos();\n\
					local distance = actorPos:Distance(targetPos);\n\
					if distance < checkRange then\n\
						findTarget = true;\n\
						break;\n\
					end\n\
				end\n\
			end\n\
			i = i + 1;\n\
		end\n\
	end\n\
	action:ClearTargetList();\n\
	\n\
	return findTarget;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
\n\
function Skill_Maniac_Marionette_Finish_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if actor:IsMyActor() == true then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0.7, 0,true,true);\n\
	end\n\
	\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kEffectTargetNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectTargetNode, kEffectID);\n\
	end\n\
	\n\
	local iSummonCount = actor:GetSummonUnitCount();\n\
	local guid = actor:GetSummonUnit(0);\n\
	local elemental = g_world:FindActor(guid);\n\
	if elemental:IsNil() == false then\n\
		if actor:IsMyActor() == false then\n\
			local kLookAt = elemental:GetLookingDir()\n\
			actor:LookAt(actor:GetTranslate():_Add(kLookAt), true);\n\
		end\n\
	end\n\
				\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iState = action:GetParamInt(10);\n\
\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	local guid = actor:GetSummonUnit(0);\n\
	local elemental = g_world:FindActor(guid);\n\
	if elemental:IsNil() == false then\n\
		actor:DeleteSummonUnit(guid);\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction()	\n\
	local actionID = action:GetID()\n\
	\n\
	if(nil == string.find(actionID, \"a_run\")) then\n\
		if curAction:GetNextActionName() ~= actionID then\n\
			ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_OnEvent(actor,textKey,seqID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		Skill_Maniac_Marionette_Finish_Fire(actor,action);\n\
	end\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_Marionette_Finish_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:CreateActionTargetList(actor);\n\
		action:BroadCastTargetListModify(actor:GetPilot());\n\
		action:ClearTargetList();\n\
	end\n\
	\n\
	if IsSingleMode() then\n\
    	Skill_Maniac_Marionette_Finish_OnTargetListModified(actor,action,false);\n\
	end	\n\
	\n\
	local   kEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
	local   kEffectTargetNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(202, kEffectTargetNode, kEffectID);\n\
	end\n\
				\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :  \n\
-- 19[int] : \n\
\n\
function Skill_Maniac_MarionetteSA_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	local iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			if iSlotNum == 0 then\n\
				action:SetSlot(iSlotNum+1);\n\
				actor:PlayCurrentSlot(true);\n\
			elseif iSlotNum == 1 then\n\
				action:SetSlot(iSlotNum+1);\n\
				actor:PlayCurrentSlot(true);\n\
			elseif iSlotNum == 2 then\n\
				action:SetSlot(iSlotNum+1);\n\
				actor:PlayCurrentSlot(true);\n\
			elseif iSlotNum == 3 then\n\
				action:SetSlot(iSlotNum+1);\n\
				actor:PlayCurrentSlot(true);\n\
			elseif iSlotNum == 4 then\n\
				action:SetParamInt(10,1);\n\
			end\n\
		end\n\
		\n\
		if iSlotNum == 1 then\n\
			local velocity = action:GetParamInt(19);\n\
			local dir = actor:GetLookingDir();\n\
			dir:Multiply(velocity);\n\
			actor:SetMovingDelta(dir);\n\
		end\n\
		\n\
		local guid = action:GetGUIDInContainer(0);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local parent = g_world:FindActor(guid);\n\
		if parent:IsNil() == false then\n\
			local paction = parent:GetAction();\n\
			if paction:IsNil() == false then\n\
				local ActionID = paction:GetID()\n\
				if ActionID ~= \"a_Marionette\" and ActionID ~= \"a_Marionette_Finish\" then\n\
					action:SetParamInt(10,1);\n\
				end\n\
			end\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Maniac_MarionetteSA_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
\n\
function Skill_Shadow_ShadowBlade_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
	local kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kEffectTargetNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectTargetNode, kEffectID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
\n\
	Skill_Shadow_ShadowBlade_Fire(actor,action);\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local iState = action:GetParamInt(10);\n\
	local iSlotNum = action:GetCurrentSlot();\n\
	\n\
	if iState == 0 then\n\
		local deltaTime = accumTime - action:GetParamFloat(11);\n\
		if deltaTime > 5 then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_OnEvent(actor,textKey,seqID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBlade_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local fireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local fireEffectTargetNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if fireEffectID ~= \"\" and fireEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(202, fireEffectTargetNode, fireEffectID);\n\
	end\n\
	\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :  \n\
\n\
function Skill_Shadow_ShadowBladeSA_OnCastingCompleted(kActor,kAction)\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kEffectTargetNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectTargetNode, kEffectID);\n\
	end\n\
	\n\
	local fireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local fireEffectTargetNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if fireEffectID ~= \"\" and fireEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(202, fireEffectTargetNode, fireEffectID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if textKey == \"hit\" then\n\
		if actor:IsUnderMyControl() then\n\
			action:CreateActionTargetList(actor);\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:ClearTargetList();\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSA_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :  \n\
function Skill_Shadow_ShadowBladeSAFinish_OnCastingCompleted(kActor,kAction)\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kEffectTargetNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectTargetNode, kEffectID);\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	local kCallerGuid = actor:GetCallerGuid();\n\
	if kCallerGuid:IsNil() == false then\n\
		local callerActor = g_world:FindActor(kCallerGuid)\n\
		if callerActor:IsNil() == false then\n\
			local callerAction = callerActor:GetAction();\n\
			if callerAction ~= nil and callerAction:IsNil() == false then\n\
				callerAction:SetParamInt(10,1);\n\
			end\n\
			local effectpos = actor:GetPos()\n\
			callerActor:AttachParticleToPoint(305, effectpos, \"ef_smog_03_char_root\");\n\
		end\n\
	end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if textKey == \"hit\" then\n\
		if actor:IsUnderMyControl() then\n\
			action:CreateActionTargetList(actor);\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:ClearTargetList();\n\
		end\n\
	elseif textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Shadow_ShadowBladeSAFinish_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [FIRE_SOUND_ID] :     ID\n\
\n\
function Skill_HellShout_play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	\n\
	local effectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local effectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if effectID ~= \"\" and effectNode ~= \"\" then\n\
		actor:AttachParticle(201, effectNode, effectID);\n\
	end\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_HellShout_play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	\n\
	if animDone == true then\n\
		return false;\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_HellShout_play_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_HellShout_play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_HellShout_play_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_HellShout_play_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
	\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_HellShout_play_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Skill_HellShout_play_OnCastingCompleted(actor,action,bIsBefore)\n\
end") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[float] :   \n\
-- 13[float] :  \n\
-- 14[float] :  \n\
-- 15[int] : AT_COUNT\n\
-- 16[float] : total timer time\n\
-- 17[int] :  \n\
\n\
-- Param Point\n\
-- 101 :   \n\
\n\
function Skill_DragonKnight_AscensionDragon_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(10,0)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamFloat(13,20);\n\
	action:SetParamFloat(14,20);\n\
	action:SetParamInt(15, action:GetAbil(AT_COUNT));\n\
	action:SetParamFloat(16, 0.7);\n\
	action:SetParamInt(17, 0);\n\
	action:SetParamAsPoint(101,actor:GetPos());\n\
\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	if kEffectID ~= \"\" then\n\
		local kDir = actor:GetPos();\n\
		kDir:SetZ(kDir:GetZ()-28);\n\
		actor:AttachParticleToPoint(201,kDir, kEffectID)\n\
	end\n\
\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
\n\
	actor:StartWeaponTrail();\n\
\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:PlayNext();\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
		actor:AttachParticleToPointWithRotate(202,actor:GetPos(),kFireEffectID,actor:GetRotateQuaternion(),1.0);            \n\
	end\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
		local totalTime = action:GetParamFloat(16);\n\
		local termTime = totalTime / (action:GetParamInt(15) + 1);\n\
		action:StartTimer(totalTime,termTime,0);\n\
    end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(12,g_world:GetAccumTime());\n\
\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			if curSlot == 0 then\n\
				Skill_DragonKnight_AscensionDragon_Fire(actor,action)\n\
			end\n\
		end\n\
\n\
		local fElapsedTime = accumTime - action:GetParamFloat(12);\n\
		local totalTime = action:GetParamFloat(16);\n\
		\n\
		if curSlot == 2 and animDone == true then\n\
			action:SetParamInt(10,1);\n\
			actor:FreeMove(false);\n\
		elseif curSlot == 1 and fElapsedTime > totalTime then\n\
			actor:PlayNext();\n\
		elseif curSlot == 1 then\n\
			local	kMovingVec = actor:GetLookingDir();\n\
			local fDirRate = 1;\n\
			if fElapsedTime < totalTime then\n\
				local angle = (math.pi/2) * (fElapsedTime / totalTime);\n\
				fDirRate = math.cos(angle);\n\
			end\n\
			local fDistance = fDirRate * 180;\n\
			local height = fDirRate * 300;\n\
			kMovingVec:Multiply(fDistance);\n\
			kMovingVec:SetZ(height);\n\
			actor:SetMovingDelta(kMovingVec);\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	actor:EndWeaponTrail();\n\
\n\
	actor:FreeMove(false);\n\
		\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local actionID = action:GetID()\n\
\n\
	if actionID == \"a_jump\" then \n\
	\n\
		if curAction:GetParamInt(10) == 1 then \n\
\n\
			action:SetSlot(2);\n\
			action:SetDoNotBroadCast(true);\n\
			return true;\n\
		end\n\
		return	false;\n\
	end\n\
\n\
	if action:GetEnable() == false then\n\
\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
\n\
		return true;\n\
	end	\n\
\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_DragonKnight_AscensionDragon_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action)\n\
	end\n\
end\n\
\n\
function  Skill_DragonKnight_AscensionDragon_OnTimer(actor,accumtime,action,iTimerID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local hitcount = action:GetParamInt(17);\n\
	if hitcount >= action:GetParamInt(15) then\n\
		return true;\n\
	end\n\
	\n\
	action:SetParamInt(17, hitcount + 1 );\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	action:ClearTargetList();\n\
\n\
	if IsSingleMode() then\n\
    	Skill_DragonKnight_AscensionDragon_OnTargetListModified(actor,action,false);\n\
    	return true;\n\
	end	\n\
	\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_LightningMargnetSA_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_LightningMargnetSA_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_LightningMargnetSA_Fire(actor,action);\n\
end\n\
function Skill_LightningMargnetSA_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	if action:GetTargetCount()>0 then\n\
	    action:BroadCastTargetListModify(actor:GetPilot());\n\
	end\n\
	action:ClearTargetList()\n\
	local kRange = action:GetSkillRange(action:GetActionNo(), actor)\n\
	if kRange==0 then kRange = 160 end\n\
	actor:AttachParticleToPointS(181, actor:GetPos(), \"ef_skill_LightningMagnet_03\", kRange/160)	--160 \n\
\n\
end\n\
\n\
function Skill_LightningMargnetSA_OnEnter(actor, action)\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(1, g_world:GetAccumTime())\n\
	local kCoolTime = action:GetAbil(ATS_COOL_TIME)\n\
	if nil==kCoolTime or 0==kCoolTime then\n\
		kCoolTime = 500\n\
	end\n\
\n\
	action:SetParamFloat(2, kCoolTime*0.001)\n\
\n\
	local kTime = actor:GetAbil(AT_LIFETIME)\n\
	if 0==kTime then\n\
		kTime = 17000	-- 15\n\
	else\n\
		kTime = kTime + 5000	-- 5  \n\
	end\n\
\n\
	action:SetParamFloat(10, action:GetParamFloat(1)+kTime*0.001)\n\
	return true\n\
end\n\
\n\
function Skill_LightningMargnetSA_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local kAccumTime = action:GetParamFloat(1)	\n\
	local kCoolTime = action:GetParamFloat(2)	\n\
\n\
	if kCoolTime <= accumTime - kAccumTime then\n\
		Skill_LightningMargnetSA_Fire(actor, action)\n\
		action:SetParamFloat(1, accumTime)\n\
	end\n\
	\n\
	if accumTime > action:GetParamFloat(10) then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())	-- \n\
		return false\n\
	end\n\
	\n\
	return true	--return false  .    \n\
end\n\
\n\
function Skill_LightningMargnetSA_OnCleanUp(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_LightningMargnetSA_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_LightningMargnetSA_OnEvent(actor,textKey)\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_LightningMargnetSA_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_LightningMargnetPlay_OnCheckCanEnter(actor,action)\n\
	return		true;\n\
	\n\
end\n\
function Skill_LightningMargnetPlay_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end\n\
function Skill_LightningMargnetPlay_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
end\n\
\n\
function Skill_LightningMargnetPlay_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	actor:SeeFront(true, true)\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_LightningMargnetPlay_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local iSlot = action:GetCurrentSlot()\n\
	local bDone = actor:IsAnimationDone()\n\
	if true==bDone then\n\
		if 2==iSlot	then\n\
			return false == bDone\n\
		elseif 0==iSlot	then\n\
			actor:AttachParticle(123, \"char_root\", \"ef_skill_LightingMagnet_01_char_root\")\n\
		end\n\
\n\
		actor:PlayNext()\n\
	end\n\
	local guid = actor:GetCallerGuid()\n\
	if false==guid:IsNil() then\n\
		local Caller = g_pilotMan:FindPilot(guid)\n\
		if true==Caller:IsNil() and 2~=iSlot then		\n\
			actor:AttachSoundToPoint(120, \"LightningMagnet_End\", actor:GetTranslate())\n\
			action:SetSlot(2)\n\
			actor:PlayCurrentSlot()\n\
			return true\n\
		else\n\
			return true\n\
		end\n\
	else\n\
		return false\n\
	end\n\
	return true\n\
end\n\
\n\
function Skill_LightningMargnetPlay_OnCleanUp(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
	actor:DetachFrom(123)	--  \n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_LightningMargnetPlay_OnLeave(actor, action)\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_LightningMargnetPlay_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0.0, 0.25); --   \n\
		actor:DetachFrom(123)\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_LightningMargnetPlay_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 13[float] : fire \n\
-- 14[float] : ,     \n\
\n\
-- Param Point\n\
-- 101 :   \n\
\n\
function Skill_Striker_SelfBomber_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	-- if actor:IsMeetFloor() == true then\n\
		-- return	false;\n\
	-- end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function Skill_Striker_SelfBomber_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_Striker_SelfBomber_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == true then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(10,0)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamFloat(14,0);\n\
	action:SetParamAsPoint(101,actor:GetPos());\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
	actor:StopJump();\n\
	actor:FreeMove(true);\n\
	Skill_Striker_SelfBomber_Fire(actor,action);\n\
\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
    return true\n\
end\n\
\n\
function Skill_Striker_SelfBomber_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
	\n\
	local   kMan = GetStatusEffectMan();\n\
	kMan:AddStatusEffectToActor(actor:GetPilotGuid(),\"se_transform_to_selfbomber\",0,0);\n\
	\n\
	action:SetSlot(1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function Skill_Striker_SelfBomber_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	actor:StopJump();		--   Leave  StopJump   \n\
	actor:FreeMove(true);	\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			if curSlot == 1 then\n\
				action:SetSlot(2);\n\
				actor:PlayCurrentSlot();\n\
				action:SetParamFloat(13, accumTime);\n\
				if 1 == actor:GetAbil(AT_GENDER) then\n\
					actor:AttachSound(2785,\"voice_male3\");\n\
				-- \n\
				else\n\
					actor:AttachSound(2785,\"voice_female5\");\n\
				end\n\
				if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
					actor:StartWeaponTrail();\n\
				end\n\
			end\n\
		end\n\
		\n\
		if curSlot == 1 then\n\
			actor:SetTranslate(action:GetParamAsPoint(101));\n\
		elseif curSlot == 2 then\n\
			local bombTime = action:GetParamFloat(14);\n\
			if actor:IsMeetFloor() == true and bombTime == 0 then\n\
				Skill_Striker_SelfBomber_HitBomb(actor);\n\
				action:SetParamFloat(14,accumTime);\n\
			elseif bombTime == 0 then\n\
				local kMovingVec = actor:GetLookingDir();\n\
				kMovingVec:SetZ(-1);\n\
				kMovingVec:Multiply(400);\n\
				actor:SetMovingDelta(kMovingVec);\n\
			elseif accumTime - bombTime > 0.2 then\n\
				action:SetParamInt(10,1);\n\
			end\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Striker_SelfBomber_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
\n\
	if actor:GetAction():GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	--  (  curAction    !!!)\n\
	local   kMan = GetStatusEffectMan();\n\
	kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),0);\n\
\n\
	actor:FreeMove(false);\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Striker_SelfBomber_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local actionID = action:GetID()\n\
\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Striker_SelfBomber_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Striker_SelfBomber_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action)\n\
	end\n\
end\n\
\n\
function Skill_Striker_SelfBomber_HitBomb(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
		\n\
	if actor:IsMyActor() then\n\
		kAction:CreateActionTargetList(actor);\n\
		kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		kAction:ClearTargetList();\n\
	end\n\
\n\
	actor:AttachParticleToPointS(201,actor:GetPos(),\"ef_boom_01\", 1.15);\n\
	actor:AttachSound(2790,\"SelfBomber_Bomb\");\n\
	QuakeCamera(0.4, 3)\n\
	\n\
 	if IsSingleMode() then\n\
    	Skill_WarLord_SoulDrain_OnTargetListModified(actor,kAction,false);\n\
	end\n\
end\n\
\n\
\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[int] : \n\
-- Param Point\n\
-- 101 :   \n\
\n\
function Skill_Striker_SelfBomber2_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Striker_SelfBomber2_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(10,0)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(12,action:GetAbil(AT_DISTANCE));\n\
	action:SetParamAsPoint(101,actor:GetPos());\n\
\n\
	actor:StopJump();\n\
\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
    return true\n\
end\n\
\n\
function Skill_Striker_SelfBomber2_Fire(actor,action)\n\
end\n\
\n\
function Skill_Striker_SelfBomber2_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		else\n\
			local distance = action:GetParamInt(12);\n\
			local kMovingVec = actor:GetLookingDir();\n\
			kMovingVec:Multiply(-distance);\n\
			actor:SetMovingDelta(kMovingVec);\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Striker_SelfBomber2_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Striker_SelfBomber2_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Striker_SelfBomber2_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Striker_SelfBomber2_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
\n\
") );
	m_kContLuaText.push_back(std::string("-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [FIRE_SOUND_ID] :     ID\n\
function Skill_Dragon_Dive_OnCastingCompleted(actor,action)\n\
end\n\
	\n\
function Skill_Dragon_Dive_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
\n\
	if actor:IsMeetFloor() then\n\
		AddWarnDataStr(GetTextW(239), 2, true)\n\
		return	false\n\
	end\n\
	\n\
	if actor:GetFloatHeight(70)<70 then\n\
		return	false	\n\
	end\n\
	\n\
	return		true	\n\
end\n\
\n\
function Skill_Dragon_Dive_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType()\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	if kEffectID ~= \"\" then\n\
		local kDir = actor:GetPos();\n\
		kDir:SetZ(kDir:GetZ()-28);\n\
		actor:AttachParticleToPoint(201,kDir, kEffectID)\n\
	end\n\
\n\
	--actor:AttachParticle(204,\"char_root\", \"ef_skill_Ascension_Dragon_02_char_root\");\n\
	\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	actor:StopJump()\n\
	actor:FreeMove(true)\n\
	action:SetParamInt(0, -1)\n\
	action:SetParamFloat(2,300)	-- Drop Speed!\n\
	actor:StartWeaponTrail()\n\
	action:SetParamAsPoint(10,actor:GetPos())\n\
	\n\
	action:SetParamInt(15, action:GetAbil(AT_COUNT)) --    \n\
	action:SetParamFloat(16, 0.7)\n\
	action:SetParamInt(17, 0)\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(100, g_world:GetAccumTime())	--  \n\
	action:SetParamAsPoint(101,actor:GetPos())			--  \n\
\n\
	action:SetParamFloat(103,-360.0*DEGTORAD)		--   /   360 \n\
	action:SetParamAsPoint(200, actor:GetLookingDir())\n\
	\n\
	action:SetParamFloat(300, action:GetAbil(AT_SKILL_MAXIMUM_SPEED)) -- g_fMaxLength = 300	\n\
	action:SetParamFloat(301, action:GetParamFloat(300)) -- g_fFrontLenth =g_fMaxLength	\n\
	action:SetParamFloat(302, 1) -- g_fDownLenth = 1	\n\
	action:SetParamFloat(303, 100) -- g_fDelta = 10	\n\
	\n\
	action:SetParamFloat(400, 1000)\n\
	\n\
	actor:PlayCurrentSlot()\n\
\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Dragon_Dive_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 70\n\
	end\n\
	\n\
	--      \n\
	local	kPos = action:GetParamAsPoint(10)	\n\
	local kParam = FindTargetParam()\n\
	kParam:SetParam_1(kPos,Point3(0,0,-1));\n\
	kParam:SetParam_2(400,iAttackRange*2,0,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_BLOWUP);\n\
	return action:FindTargetsEx(iActionNo,TAT_BAR,kParam,kTargets,kTargets);	\n\
end\n\
\n\
function Skill_Dragon_Dive_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if actor:IsMeetFloor() == true then\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	slotNum = action:GetCurrentSlot()\n\
	local	iState = action:GetParamInt(0)\n\
	--ODS(\"******Slot :\"..slotNum..\"*********\\n\", false, 912)\n\
	\n\
	local kDownVec = Point3(0,0,-1)\n\
	local kFrontVec = actor:GetLookingDir()\n\
	local fMaxLenth = action:GetParamFloat(300)	\n\
	\n\
--	ODS(\"!! : \"..fFrontLenth..\"\\n\", false, 912)\n\
	--ODS(\"!! : \"..fDownLength..\"\\n\", false, 912)\n\
\n\
	if iState == -1 then \n\
		if animDone == true then\n\
			actor:PlayNext()\n\
			action:SetParamInt(0, 0)\n\
			Skill_Dragon_Dive_Fire(actor,action)\n\
		else\n\
			--   \n\
			-- if actor:IsMyActor() then			\n\
				-- local iMetaDist = 0\n\
				-- local fScalar = action:GetParamFloat(400)\n\
				-- if(KeyIsDown(KEY_DOWN)) then \n\
					-- iMetaDist = fScalar* frameTime					\n\
				-- elseif(KeyIsDown(KEY_UP)) then\n\
					-- iMetaDist = -(fScalar*frameTime)/2				\n\
				-- end\n\
				-- if iMetaDist ~= 0 then\n\
					-- fMaxLenth =  fMaxLenth+iMetaDist\n\
					-- action:SetParamFloat(300, fMaxLenth)\n\
				-- end\n\
			--end	\n\
		end\n\
	end\n\
	--ODS(\"fMaxlenth:\"..fMaxLenth..\"\\n\", false, 912)\n\
	local fFrontLenth = action:GetParamFloat(301)\n\
	local fDownLength = action:GetParamFloat(302, 1)\n\
	local fDownLenth_local = (fMaxLenth-fFrontLenth)\n\
	local fFrontLenth_local = (fMaxLenth-fDownLength)\n\
	\n\
	if iState == 0 then\n\
\n\
		local	kLookingDir = actor:GetLookingDir()\n\
		local	kRotateAxis = actor:GetLookingDir()\n\
		--local fSpeed = action:GetParamFloat(2)\n\
				\n\
		kRotateAxis:Cross(Point3(0,0,1))\n\
		kRotateAxis:Unitize()\n\
		local	fRotateAngle = action:GetParamFloat(103)* frameTime\n\
		--ODS(\":\"..fRotateAngle*(180/math.pi)..\"\\n\", false, 912)\n\
		\n\
		kLookingDir = action:GetParamAsPoint(200)\n\
		--local	kMovingDelta = kLookingDir:_Multiply(fSpeed)\n\
\n\
		local	kMovingDelta = kLookingDir:_Multiply(fFrontLenth_local)\n\
		\n\
		\n\
		\n\
		local kDownVec = Point3(0,0,-1)\n\
		kDownVec:Multiply(fDownLenth_local)\n\
		kMovingDelta:Rotate(kRotateAxis,fRotateAngle)\n\
		kMovingDelta:Add(kDownVec)		\n\
		\n\
		kFrontVec:Multiply(fFrontLenth_local/2)\n\
		kMovingDelta:Add(kFrontVec)		\n\
		--ODS(\"  : \"..kMovingDelta:Length()..\"\\n\", false, 912)\n\
		actor:SetMovingDelta(kMovingDelta)\n\
		\n\
		--   \n\
		kMovingDelta:Unitize()		\n\
		--  (  (1,0,0)),    0    \n\
		kLookingDir = actor:GetLookingDir()\n\
		local fDot = kLookingDir:Dot(kMovingDelta)\n\
--		fDot = math.acos(fDot)		\n\
--		fDot = fDot*(180/math.pi)\n\
		--ODS(\":\"..fDot..\"\\n\", false, 912)\n\
		if( 0 >= fDot) then\n\
			kMovingDelta = Point3(0,0,-1)\n\
			kMovingDelta:Multiply(fMaxLenth)\n\
			actor:SetMovingDelta(kMovingDelta)\n\
			--action:SetParamFloat(2, 1000)\n\
			\n\
			--ODS(\"---------------------------------------------  ---------------------------------------------\\n\", false, 912)\n\
		--	actor:PlayNext()	--    \n\
		--	action:SetParamInt(0,2)			\n\
		else\n\
--			kMovingDelta:_Multiply(fSpeed)\n\
			action:SetParamAsPoint(200, kMovingDelta)			\n\
			--ODS(\"==========================================================================================\\n\", false, 912)\n\
		end		\n\
		\n\
		local fDelta = action:GetParamFloat(303)\n\
		fDelta = fDelta+fDelta*frameTime\n\
		action:SetParamFloat(303, fDelta) -- g_fDelta =g_fDelta+g_fDelta*frameTime\n\
		\n\
		action:SetParamFloat(301, fMaxLenth-fDelta) -- g_fFrontLenth = fMaxLenth-g_fDelta				\n\
		fFrontLenth = action:GetParamFloat(301)\n\
		\n\
		action:SetParamFloat(302, fMaxLenth-fFrontLenth)\n\
		fDownLength = action:GetParamFloat(302)			--g_fDownLenth  = fMaxLenth-fFrontLenth\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Dragon_Dive_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	actor:FreeMove(false)\n\
	actor:EndWeaponTrail()\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Dragon_Dive_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	curAction = actor:GetAction()\n\
			\n\
	CheckNil(nil==curAction)\n\
	CheckNil(curAction:IsNil())\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Dragon_Dive_OnLeave actionID:\"..actionID..\"\\n\")\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true\n\
	end\n\
\n\
	if actionID == \"a_jump\" then \n\
		return false\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true\n\
	end\n\
\n\
	if curParam == \"end\" then \n\
		return true\n\
	end	\n\
\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(1,\"\")\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
		\n\
		if actionID == \"a_run\" or \n\
			string.sub(actionID,1,7) == \"a_melee\" or \n\
			string.sub(actionID,1,11) == \"a_thi_melee\" then\n\
	\n\
			curAction:SetParam(3,\"GoNext\")\n\
			curAction:SetParam(1,actionID)	\n\
			\n\
		elseif actionID == \"a_telejump\" then\n\
			actor:DetachFrom(32)\n\
			return true\n\
		end\n\
	\n\
		return false\n\
	\n\
	elseif curParam == \"end\" and actionID == \"a_run\" then\n\
		return true\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Skill_Dragon_Dive_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())	\n\
	\n\
	local	iTotalHit = action:GetParamInt(15) \n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	local	iHitCount = action:GetParamInt(17)\n\
	if iHitCount >= iTotalHit then\n\
		return\n\
	end\n\
			ODS(\"iHitCount:\"..iHitCount..\" Hit:\"..iTotalHit..\"\\n\", false, 912)\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	\n\
	if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
		actor:AttachParticleToPointWithRotate(202,actor:GetPos(),kFireEffectID,actor:GetRotateQuaternion(),1.0)\n\
	end\n\
	\n\
	-- if actor:IsMyActor() then\n\
	    -- GetComboAdvisor():OnNewActionEnter(action:GetID())\n\
		 --action:StartTimer(0.5,0.1,0)\n\
	    --GetComboAdvisor():AddNextAction(\"a_jump\")\n\
    -- end\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
--[[		local totalTime = action:GetParamFloat(16);\n\
		local termTime = totalTime / (action:GetParamInt(15) + 1);\n\
		action:StartTimer(totalTime,termTime,0);\n\
		]]\n\
		 action:StartTimer(0.3,0.05,0)\n\
    end\n\
\n\
end\n\
\n\
function Skill_Dragon_Dive_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
     if bIsBefore == false then		\n\
		Skill_Dragon_Dive_HitOneTime(actor,action)  \n\
	end\n\
\n\
end\n\
\n\
function Skill_Dragon_Dive_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(17);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	iTotalHit = action:GetParamInt(15) --tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"));\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
	\n\
	if iHitCount >= iTotalHit then\n\
		ODS(\"    \\n\", false, 912)\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Act_Melee_Default_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(17,iHitCount);\n\
	ODS(iHitCount..\" \\n\", false, 912)\n\
	\n\
end\n\
\n\
function   Skill_Dragon_Dive_OnTimer(actor,accumtime,action,iTimerID)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	action:CreateActionTargetList(actor)\n\
	action:BroadCastTargetListModify(actor:GetPilot())\n\
\n\
	local	iTargetCount = action:GetTargetCount()\n\
	action:SetSlot(1)	\n\
	\n\
	if 	iTargetCount == 0 then\n\
		return true\n\
	end\n\
	\n\
	local hitcount = action:GetParamInt(17);\n\
	if hitcount >= action:GetParamInt(15) then\n\
		return true;\n\
	end\n\
	\n\
	\n\
	local	i = 0\n\
	\n\
	local bWeaponSoundPlayed = false\n\
		\n\
	while i<iTargetCount do\n\
		\n\
		local	kTargetGUID = action:GetTargetGUID(i)\n\
		local	kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
		if kTargetPilot:IsNil() == false then\n\
			\n\
			local	actorTarget = kTargetPilot:GetActor()\n\
			if actorTarget:IsNil() == false and actorTarget:GetPilotGuid() ~= actor:GetPilotGuid() then\n\
			\n\
				local kActionResult = action:GetTargetActionResult(i)\n\
			\n\
				if kActionResult:IsMissed() == false then\n\
				\n\
	                if bWeaponSoundPlayed == false then\n\
	                    bWeaponSoundPlayed = true\n\
                        --   \n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, action:GetID(), 0, action:GetTargetInfo(i))\n\
                    end				\n\
				\n\
--					local	kActionTargetInfo = action:GetTargetInfo(i)	\n\
					\n\
					local	iSphereIndex = action:GetTargetABVShapeIndex(i)\n\
					local pt = actorTarget:GetABVShapeWorldPos(iSphereIndex)		\n\
					if kActionResult:GetCritical() then\n\
						actorTarget:AttachParticleToPoint(12, pt, \"e_dmg_cri\")\n\
					else\n\
						actorTarget:AttachParticleToPoint(12, pt, \"e_dmg\")\n\
					end\n\
\n\
--					local	atAction = actorTarget:GetAction()\n\
					\n\
--					local	guidPilot = actorTarget:GetPilotGuid()\n\
--					local	pilot = g_pilotMan:FindPilot(guidPilot)\n\
					\n\
					local iShakeTime = g_fAttackHitHoldingTime * 1000\n\
						\n\
					--   \n\
					actor:SetShakeInPeriod(5,iShakeTime/2)\n\
					actorTarget:SetShakeInPeriod(5,iShakeTime)		\n\
				\n\
				end\n\
				\n\
			end\n\
		end\n\
		\n\
		i = i + 1\n\
		\n\
	end\n\
	\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects()\n\
	end\n\
	action:ClearTargetList()\n\
	actor:ClearIgnoreEffectList()\n\
") + std::string("\n\
	return true\n\
\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Dragon_Dive_Finish_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
	\n\
	if not actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	return		true\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	ODS(\"Skill_Dragon_Dive_Finish_OnEnter\\n\", false, 912)\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
--	local	weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	action:SetParamInt(0, 0)\n\
	\n\
--	actor:StopJump()\n\
--	actor:FreeMove(true)\n\
	actor:StartWeaponTrail()\n\
	actor:PlayCurrentSlot()\n\
	return true\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local iAttackRange = action:GetSkillRange(0,actor)	\n\
	if iAttackRange == 0 then\n\
		iAttackRange = 100\n\
	end\n\
	\n\
	local kParam = FindTargetParam()\n\
	kParam:SetParam_1(actor:GetPos(),Point3(0,0,-1))\n\
	kParam:SetParam_2(0,0,iAttackRange,0)\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN)\n\
	\n\
	return	action:FindTargets(TAT_SPHERE,kParam,kTargets,kTargets)\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	ODS(\"Skill_Dragon_Dive_Finish_OnUpdate\\n\", false, 912)\n\
	--Act_Melee_Default_OnUpdate(actor, accumTime, frameTime)\n\
	if action:GetParamInt(0) == 0 and actor:IsMeetFloor() then\n\
		--ODS(\" \\n\", false, 912)\n\
		Skill_Dragon_Dive_Finish_OnMeetFloor(actor,action,accumTime)\n\
	end\n\
	if action:GetParamInt(0) == 1 \n\
		--and actor:IsAnimationDone() \n\
		then\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	ODS(\"Skill_Dragon_Dive_Finish_OnCleanUp\\n\", false, 912)\n\
\n\
	actor:FreeMove(false)\n\
	actor:EndWeaponTrail()\n\
	\n\
--	actor:DetachFrom(12)\n\
--	actor:DetachFrom(13)\n\
	return true\n\
end\n\
function Skill_Dragon_Dive_Finish_OnLeave(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	curAction = actor:GetAction()\n\
			\n\
	CheckNil(nil==curAction)\n\
	CheckNil(curAction:IsNil())\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Dragon_Dive_Finish_OnLeave actionID:\"..actionID..\"\\n\", false, 912)\n\
		if actor:IsMyActor() == false then\n\
		return true\n\
	end\n\
\n\
	if actionID == \"a_jump\" then \n\
		--ODS(\"1\\n\", false, 912)\n\
		return false\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true\n\
	end\n\
\n\
	if curParam == \"end\" then \n\
		return true\n\
	end	\n\
\n\
	if action:GetEnable() == false then\n\
		\n\
		if curParam==actionID then\n\
			curAction:SetParam(1,\"\")\n\
		end\n\
		\n\
	end	\n\
	\n\
	if action:GetEnable() == true then\n\
		\n\
		if actionID == \"a_run\" or \n\
			string.sub(actionID,1,7) == \"a_melee\" or \n\
			string.sub(actionID,1,11) == \"a_thi_melee\" then\n\
	\n\
			curAction:SetParam(3,\"GoNext\")\n\
			curAction:SetParam(1,actionID)	\n\
			\n\
		elseif actionID == \"a_telejump\" then\n\
			actor:DetachFrom(32)\n\
			return true				\n\
		elseif curParam == \"end\" and actionID == \"a_run\" then\n\
			return true\n\
		elseif actionID == \"a_idle\" or\n\
			actionID == \"a_die\" or\n\
			actionID == \"a_handclaps\" or\n\
			actionID == \"a_battle_idle\" then\n\
			return true\n\
		end\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_DoDamage(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())	\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID())\n\
		action:StartTimer(0.5,0.1,0)\n\
	    --GetComboAdvisor():AddNextAction(\"a_jump\")\n\
    end\n\
\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
     if bIsBefore == false then\n\
		\n\
		Act_Melee_Default_HitOneTime(actor,action)\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true, true)\n\
			return\n\
		end\n\
\n\
		local	iTotalHit = tonumber(action:GetScriptParam(\"MULTI_HIT_NUM\"))		\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
        if iTotalHit>1 then\n\
            Act_Melee_Default_HitOneTime(actor,action)\n\
        end        \n\
	end\n\
\n\
end\n\
\n\
function Skill_Dragon_Dive_Finish_OnMeetFloor(actor,action,accumTime)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	action:SetParam(6,\"HIT\")\n\
	action:SetParamInt(0,1)\n\
	actor:FindPathNormal()\n\
	action:SetParamFloat(5,accumTime)\n\
	actor:FreeMove(false)\n\
	\n\
	if actor:IsMyActor() then\n\
		QuakeCamera(g_fMeleeDropQuakeValue[1]\n\
		, g_fMeleeDropQuakeValue[2]\n\
		, g_fMeleeDropQuakeValue[3]\n\
		, g_fMeleeDropQuakeValue[4]\n\
		, g_fMeleeDropQuakeValue[5])\n\
	end\n\
	\n\
	local	kPos = actor:GetPos()	\n\
	actor:AttachParticleToPointS(12, kPos, \"ef_thi_jump_down_attk\", 1.5)\n\
	\n\
	--            \n\
	kPos = actor:GetNodeWorldPos(\"char_root\")\n\
	local kQuatRotate = actor:GetNodeWorldRotate(\"char_root\")\n\
	actor:AttachParticleToPointWithRotate(13, kPos, \"ef_dragon_dive\",kQuatRotate, 1)\n\
	actor:AttachSound(2784,\"DragonDive_FIRE\")\n\
	 \n\
	if actor:IsUnderMyControl() then\n\
	\n\
		action:CreateActionTargetList(actor)\n\
		if IsSingleMode() then\n\
			Act_Melee_OnTargetListModified(actor,action,false)\n\
		else\n\
			action:BroadCastTargetListModify(actor:GetPilot())\n\
		end			\n\
	\n\
	end\n\
	\n\
	Skill_Dragon_Dive_Finish_DoDamage(actor,action)\n\
end\n\
\n\
function   Skill_Dragon_Dive_Finish_OnTimer(actor,accumtime,action,iTimerID)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	action:CreateActionTargetList(actor)\n\
	action:BroadCastTargetListModify(actor:GetPilot())\n\
	return true\n\
\n\
end") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 15[int] : AT_COUNT\n\
-- 16[float] : total timer time\n\
-- 17[int] :  \n\
\n\
function Skill_Sentinel_WindBlade_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
	action:SetParamInt(10,0);\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(15, action:GetAbil(AT_COUNT));\n\
	action:SetParamFloat(16,1.0);\n\
	action:SetParamInt(17,0);\n\
	\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
\n\
	local effectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local effectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if effectID ~= \"\" and effectNode ~= \"\" then\n\
		actor:AttachParticle(201, effectNode, effectID);\n\
	end\n\
	\n\
	local fireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
	local fireEffectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if fireEffectID ~= \"\" and fireEffectNode ~= \"\" then\n\
		actor:AttachParticle(202, fireEffectNode, fireEffectID);\n\
	end\n\
\n\
	Skill_Sentinel_WindBlade_CreateElemental(actor, action, actor:GetPos());\n\
	return true\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
	actor:DetachFrom(203);\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		Act_Melee_Default_HitOneTime(actor,action);\n\
    end\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnEvent(actor,textKey,seqID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
			\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		local fireEffectID2 = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
		local fireEffectNode2 = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
		if fireEffectID2 ~= \"\" and fireEffectNode2 ~= \"\" then\n\
			actor:AttachParticle(203, fireEffectNode2, fireEffectID2);\n\
		end\n\
		Skill_Sentinel_WindBlade_Fire(actor,action);\n\
	end\n\
	return true;\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_OnTimer(actor,accumtime,action,iTimerID)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local hitcount = action:GetParamInt(17);\n\
	if hitcount >= action:GetParamInt(15) then\n\
		return true;\n\
	end\n\
	\n\
	action:SetParamInt(17, hitcount + 1 );\n\
	action:CreateActionTargetList(actor);\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	action:ClearTargetList();\n\
		\n\
	if IsSingleMode() then\n\
    	Skill_Sentinel_WindBlade_OnTargetListModified(actor,action,false);\n\
    	return true;\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		local totalTime = action:GetParamFloat(16);\n\
		local termTime = totalTime / (action:GetParamInt(15) + 1);\n\
\n\
		action:StartTimer(totalTime,termTime,0);\n\
	end\n\
	\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
\n\
	\n\
end\n\
\n\
function Skill_Sentinel_WindBlade_CreateElemental(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\");\n\
	guid:Generate();\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000703, 0);\n\
	if pilot:IsNil() == false then\n\
		newActor = pilot:GetActor();\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, newActor, kTargetPos, 9);\n\
		newActor:FreeMove(true)\n\
		newActor:ReserveTransitAction(\"a_WindBladeSA\");\n\
		newActor:ClearActionState()\n\
		local fScale = (action:GetSkillLevel()%10)*0.05 + 1.0;\n\
		newActor:SetTargetScale(fScale);\n\
		local	kLookAt = actor:GetLookingDir()\n\
		newActor:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
		newActor:PlayCurrentSlot();\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
function Skill_Sentinel_WindBladeSA_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
\n\
	local   kEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kEffectTargetNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if kEffectID ~= \"\" and kEffectTargetNode ~= \"\" then\n\
		actor:AttachParticle(201, kEffectTargetNode, kEffectID);\n\
	end\n\
	\n\
	actor:AttachParticle(202, \"bone16\", \"ef_skill_wind_blade_02_bone16\");\n\
	actor:AttachParticle(203, \"char_root\", \"ef_skill_wind_blade_03_char_root\");\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iState = action:GetParamInt(10);\n\
	\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1);\n\
		end\n\
	else\n\
		return false;\n\
	end\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201);\n\
	actor:DetachFrom(202);\n\
	actor:DetachFrom(203);\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Sentinel_WindBladeSA_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 10[int] :  \n\
-- 11[float] : \n\
-- 12[int] : timer count\n\
-- 13[int] : hit   .\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnCastingCompleted(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	actor:CutSkillCasting();\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	action:SetParamInt(10,0);\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(13,0);\n\
	\n\
	Skill_Arcmage_WrathOfHeaven_Fire(actor,action)\n\
		\n\
	if actor:IsMyActor() then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
    end\n\
    \n\
	local effectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local effectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if effectID ~= \"\" and effectNode ~= \"\" then\n\
		actor:AttachParticle(201, effectNode, effectID);\n\
	end\n\
	\n\
	local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
\n\
	if actor:IsMyActor() then\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
	\n\
	local iTotalHit = 0;\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
	if kSkillDef:IsNil() == false then\n\
		iTotalHit  = kSkillDef:GetAbil(AT_COUNT);\n\
	end\n\
	action:SetParamInt(12,iTotalHit);\n\
--	ODS(\"iTotalHit:\"..iTotalHit..\"\\n\",false, 912)\n\
   return true\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_Fire(actor,action)\n\
		\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kTargetPos = actor:GetPos();\n\
	kTargetPos:SetZ(kTargetPos:GetZ() + 30);\n\
	Skill_Arcmage_WrathOfHeaven_CreateElemental(actor,action,kTargetPos)\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	iState = action:GetParamInt(10);\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			action:SetParamInt(10,1)\n\
		end\n\
	else\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:DetachFrom(201);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	curAction = actor:GetAction();\n\
	if curAction:GetParamInt(10) == 1 then\n\
		return true\n\
	end\n\
\n\
	return false\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnEvent(actor,textKey,seqID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" then\n\
		if actor:IsMyActor() == true then\n\
			action:StartTimer(1,0.15,0)			\n\
			-- action:CreateActionTargetList(actor);\n\
			-- action:BroadCastTargetListModify(actor:GetPilot());\n\
			-- action:ClearTargetList();\n\
		end\n\
		local kEffectID = action:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
		if kEffectID ~= \"\" then\n\
			local effectPos = actor:GetPos();\n\
			effectPos:SetZ(effectPos:GetZ() - 30);\n\
			local lookAt = actor:GetLookingDir();\n\
			lookAt:Multiply(100);\n\
			effectPos:Add(lookAt);\n\
			actor:AttachParticleToPoint(210, effectPos, kEffectID);\n\
		end\n\
	end\n\
	return	true;\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	CheckNil(action:IsNil());\n\
	\n\
	if bIsBefore == false then\n\
		Skill_Arcmage_WrathOfHeaven_HitOneTime(actor,action)\n\
    end\n\
\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_CreateElemental(actor,action,kTargetPos)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000705, 0)\n\
	if pilot:IsNil() == false then\n\
		local kNewActor = pilot:GetActor();\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, kNewActor, kTargetPos, 9);\n\
		kNewActor:FreeMove(true);\n\
		kNewActor:SetTranslate(kTargetPos);\n\
		kNewActor:ReserveTransitAction(\"a_WrathOfHeavenSA\");\n\
		kNewActor:ClearActionState()\n\
		local	kLookAt = actor:GetLookingDir()\n\
		kNewActor:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
		kNewActor:PlayCurrentSlot();\n\
	end\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_OnTimer(actor, accumTime, action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local count = action:GetParamInt(12);\n\
	\n\
	if count == 0 then\n\
		return true\n\
	end\n\
\n\
	action:SetParamInt(12, count-1);\n\
	\n\
	action:CreateActionTargetList(actor);\n\
	action:BroadCastTargetListModify(actor:GetPilot());\n\
	action:ClearTargetList();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(2);\n\
		local	iTotalHit = action:GetParamInt(12)\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1;\n\
	end\n\
--	ODS(\" iTotalHit\"..iTotalHit..\"iHitCount:\"..iHitCount..\"\\n\",false, 912)\n\
	\n\
	if iHitCount == iTotalHit then\n\
--		ODS(\"\\n\", false,912)\n\
		return\n\
	end\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_Arcmage_WrathOfHeaven_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	actor:ClearIgnoreEffectList();\n\
	\n\
	iHitCount = iHitCount + 1;\n\
	action:SetParamInt(2,iHitCount);\n\
	action:SetParamInt(13,1);\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeaven_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
	local disableEffect = kAction:GetParamInt(13);\n\
	if disableEffect == 0 then\n\
		local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
		local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
		if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
			actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
		end	\n\
	end\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000;\n\
	        actor:SetAnimSpeedInPeriod(0.01, iShakeTime);\n\
	        actor:SetShakeInPeriod(5, iShakeTime/2);\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime);		\n\
	    end\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("------------------------------------------------\n\
-- Definitions\n\
------------------------------------------------\n\
-- Param\n\
-- 11[float] : \n\
-- 12[int] :   \n\
function Skill_Arcmage_WrathOfHeavenSA_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(11,g_world:GetAccumTime());\n\
	action:SetParamInt(12, 0);\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end		\n\
	\n\
	local effectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
	local effectNode = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	if effectID ~= \"\" and effectNode ~= \"\" then\n\
		actor:AttachParticle(201, effectNode, effectID);\n\
	end\n\
	\n\
	local effectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
	local effectNode = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	if effectID ~= \"\" and effectNode ~= \"\" then\n\
		actor:AttachParticle(202, effectNode, effectID);\n\
	end\n\
	actor:FreeMove(true)\n\
	return true\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	\n\
	local deltaTime = accumTime - action:GetParamFloat(11);\n\
	local IsDetach = action:GetParamInt(12);\n\
	if IsDetach == 0 then\n\
		if deltaTime > 1 then\n\
			action:SetParamInt(12,1);\n\
			actor:DetachFrom(202);\n\
		end\n\
	end\n\
	\n\
	if animDone == true then\n\
		return false;\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(201, true);\n\
	actor:DetachFrom(202);\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
    g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_OnLeave(actor, action)\n\
	return true;\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0, 0.25);\n\
	end\n\
	\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Arcmage_WrathOfHeavenSA_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
\n\
-- Melee\n\
function Skill_Lighting_Storm_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Lighting_Storm_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	ODS(\"Skill_Lighting_Storm_OnTimer:\"..iTimerID..\"\\n\", false, 912)\n\
	\n\
	if 0 == iTimerID then\n\
		local	iHitCount = SkillHelpFunc_GetHitCount(action)\n\
		local	iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
		if iHitCount == iTotalHit then\n\
			action:SetParamInt(33, 1);\n\
\n\
			return true\n\
		end\n\
\n\
		local iCreateLimitCnt = action:GetParamInt(10)\n\
		if(0 < iCreateLimitCnt) then\n\
			ODS(\"iCreateLimitCnt \\n\", false, 912)\n\
			action:CreateActionTargetList(actor);		\n\
			iCreateLimitCnt  = iCreateLimitCnt-1\n\
			action:SetParamInt(10, iCreateLimitCnt)			\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:GetTargetList():SetActionEffectApplied(true)		\n\
		end\n\
\n\
		local i = 0;\n\
		local kTargetList = action:GetTargetList();\n\
		local iTargetCount = kTargetList:size();\n\
		while i<iTargetCount do\n\
			local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
			local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
			if kTargetPilot:IsNil() == false then\n\
				if actor:IsMyActor() then\n\
					if( CheckNil(g_world == nil) ) then return false end\n\
					if( CheckNil(g_world:IsNil()) ) then return false end\n\
					g_world:AddDrawActorFilter(kTargetGUID);\n\
				end\n\
			end\n\
			i = i + 1;\n\
		end\n\
		\n\
		if IsSingleMode() then\n\
	    \n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
			Skill_Lighting_Storm_OnTargetListModified(actor,action,false)\n\
	        \n\
			return true;\n\
		else\n\
\n\
			--  1 ,    \n\
			ODS(\" iHitCount:\"..iHitCount..\"\\n\", false, 912)\n\
			SkillHelpFunc_DoDividedDamage(actor, action, iHitCount)\n\
			if iHitCount == iTotalHit-1 then\n\
				action:SetParam(1, \"end\")\n\
			end\n\
		end\n\
\n\
		SkillHelpFunc_IncHitCount(action, 1)\n\
		\n\
		--ODS(\"iTotalHit : \" .. iTotalHit..\" iHitCount: \".. iHitCount..\"\\n\", false, 1509);\n\
		\n\
	elseif 1 == iTimerID then\n\
		local iSkillRange = action:GetParamInt(21);\n\
		local iIndex = action:GetParamInt(20);\n\
\n\
		local kPos = actor:GetPos();\n\
\n\
		kPos:SetX(kPos:GetX() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetY(kPos:GetY() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetZ(kPos:GetZ() + 200);\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			--  .\n\
			ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				return true;\n\
			end			\n\
		end\n\
\n\
		actor:AttachParticleToPointS(1000 + iIndex, ptcl, \"ef_skill_lightingstorm_02_char_root\", math.random(-1.0, 1));\n\
\n\
		action:SetParamInt(20, iIndex + 1);\n\
	elseif 2 == iTimerID then\n\
		local iIndex = action:GetParamInt(19);\n\
		local kSoundIdTBl = {\"LightningStorm_01\", \"LightningStorm_02\", \"LightningStorm_03\"};\n\
		local iIdx = math.random(1 ,table.getn(kSoundIdTBl))\n\
		actor:AttachSound(200 + iIndex , kSoundIdTBl[iIdx]);\n\
		action:SetParamInt(19, iIndex + 1);\n\
	end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function Skill_Lighting_Storm_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Lighting_Storm_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	SkillHelpFunc_SetNoneCastingState(action)			--  \n\
end\n\
\n\
function Skill_Lighting_Storm_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Lighting_Storm_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	SkillHelpFunc_PlayFireSound(actor, action)	--  		\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	SkillHelpFunc_ChangeWeapon(actor, action)	--   	\n\
	SkillHelpFunc_ExpressFireEffect(actor, action)	--   \n\
    SkillHelpFunc_AttachWeaponTrail(actor, action)	--   \n\
	SkillHelpFunc_TransformShape(actor, action)		--   \n\
	\n\
	SkillHelpFunc_InitHitCount(action) -- Hit Count\n\
	action:SetParamInt(31,0); -- hit_timer  Check\n\
	action:SetParamInt(33,0);\n\
\n\
	action:SetParamInt(19,0);\n\
	action:SetParamInt(20,0);\n\
end\n\
\n\
function Skill_Lighting_Storm_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Lighting_Storm_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	SkillHelpFunc_InitHitCount(action)					-- HitCount 	\n\
	SkillHelpFunc_ExpressCastingEffect(actor, action)	--     	\n\
	SkillHelpFunc_PlayCastingSound(actor, action) 		--  	\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	Skill_Lighting_Storm_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.4,true,true);\n\
		g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
	end\n\
\n\
	action:CreateActionTargetList(actor,true);\n\
	local i = 0;\n\
	local kTargetList = action:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			if actor:IsMyActor() then\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				g_world:AddDrawActorFilter(kTargetGUID);\n\
			end\n\
		end\n\
		i = i + 1;\n\
	end	\n\
	action:ClearTargetList();	\n\
	action:SetParamInt(21, action:GetSkillRange(0,actor)) --  		\n\
	actor:SetCanHit(true);\n\
	\n\
	local kMulptiple = action:GetScriptParam(\"MULTIPLE_ATTACK\")\n\
	if kMulptiple~=\"\" then\n\
		action:SetParamInt(100, 1)\n\
		action:SetParamInt(10,1) -- Timer  CreateTargetList 1    \n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Lighting_Storm_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot();\n\
\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		if 1 == iSlot then\n\
			actor:PlayNext();\n\
		end\n\
	end\n\
\n\
	local kHitEnd = action:GetParamInt(33);\n\
	if 1 == kHitEnd then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		else\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end		\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Lighting_Storm_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
\n\
	SkillHelpFunc_RestoreWeapon(actor, kCurAction)					--   	\n\
	SkillHelpFunc_ShowWeapon(actor, kCurAction)						--   	\n\
	SkillHelpFunc_DetachWeaponTrail(actor, kCurAction)				--    	\n\
    SkillHelpFunc_RestoreShape(actor, kCurAction)					--  	\n\
	SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, kCurAction)	--      	\n\
	SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, kCurAction)--     	\n\
	SkillHelpFunc_ExpressCleanUpEffect(actor, kCurAction)			-- CleanUp( )    	\n\
	SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
	SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Lighting_Storm_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if curAction:GetNextActionName() ~= actionID then\n\
		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		if actor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function Skill_Lighting_Storm_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if(0 == action:GetParamInt(100) ) then\n\
		if bIsBefore == false then\n\
\n\
			--  hit  \n\
			--    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action);	 \n\
		end\n\
	end\n\
\n\
end\n\
\n\
function Skill_Lighting_Storm_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		local iTimerTime = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TIME\");\n\
		local iTimerick = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TICK\");\n\
		kAction:StartTimer(iTimerTime, iTimerick,0);\n\
		\n\
		if actor:IsUnderMyControl() then\n\
			QuakeCamera(5.5, 2, 1, 1, 1);\n\
		end\n\
\n\
		kAction:StartTimer(4.0, 0.1,1); --   1\n\
		kAction:StartTimer(4.0, 0.3,2); --   2\n\
		\n\
		actor:AttachParticleS(7218, \"p_ef_heart\",\"ef_skill_raceofheaven_01_p_ef_r_hand\", 5.0);\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [CHECK_CAN_PREV_ACTION_ID] :      .\n\
function Skill_Lighting_Storm_Finish_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnCheckCanEnter(actor,action)\n\
\n\
	local	kCurrentAction = actor:GetAction();\n\
\n\
	local   kPrevActionID = action:GetScriptParam(\"CHECK_CAN_PREV_ACTION_ID\");\n\
\n\
	return (kCurrentAction:GetID() == kPrevActionID);\n\
	\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	return Skill_Lighting_Storm_OnTimer(actor,fAccumTime,action,iTimerID);\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(21, action:GetSkillRange(0,actor) / 5 * 3) --  \n\
	action:StartTimer(0.9, 0.1, 1); --   1\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot();\n\
\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		else\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end		\n\
		\n\
	return	true;\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
		g_world:ClearDrawActorFilter()\n\
	end		\n\
\n\
	actor:RestoreLockBidirection();\n\
\n\
	actor:SetCanHit(true);\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		actor:DetachFrom(7218)\n\
\n\
		if actor:IsMyActor() then\n\
			kAction:CreateActionTargetList(actor);\n\
\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local i = 0;\n\
			local kTargetList = kAction:GetTargetList();\n\
			local iTargetCount = kTargetList:size();\n\
			while i<iTargetCount do\n\
				local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
				local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
				local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false then\n\
					if actor:IsMyActor() then\n\
						g_world:AddDrawActorFilter(kTargetGUID);\n\
					end\n\
				end\n\
				i = i + 1;\n\
			end\n\
	\n\
			if IsSingleMode() then\n\
				SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
				Skill_Lighting_Storm_Finish_OnTargetListModified(actor,kAction,false)\n\
\n\
				return;\n\
			else\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				kAction:ClearTargetList();\n\
			end\n\
		end	\n\
	\n\
        SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Lighting_Storm_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
	return Skill_Lighting_Storm_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_HealingWave_OnCheckCanEnter(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
	return		true	\n\
end\n\
\n\
function Skill_HealingWave_OnCastingCompleted(kActor, kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	Skill_HealingWave_Fire(kActor,kAction)\n\
	--kAction:SetSlot(kAction:GetCurrentSlot())\n\
	kActor:PlayCurrentSlot()\n\
	kActor:CutSkillCasting()\n\
end\n\
\n\
function Skill_HealingWave_OnTargetListModified(kActor,kAction,bIsBefore)	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())	\n\
    --ODS(\"Skill_HealingWave_OnTargetListModified\\n\", false, 912)\n\
    --      \n\
    if bIsBefore then\n\
    else\n\
	    Skill_HealingWave_CreateLinkedPlane(kActor,kAction)   --  LinkedPlane 	    \n\
	    kAction:GetTargetList():ApplyActionEffects()\n\
		local kTargetList = kAction:GetTargetList()		\n\
		local iTargetCount = kTargetList:size()\n\
		if(0 == iTargetCount) then return end\n\
		local i =0\n\
		--     \n\
		while i<iTargetCount do			\n\
			local   kTargetInfo = kTargetList:GetTargetInfo(i)\n\
			if(true == kTargetInfo:IsNil()) then return end\n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
			if(true == kTargetGUID:IsNil()) then return end			\n\
			local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
			--local Name = kTargetPilot:GetName():GetStr()\n\
			--ODS(\"   :\"..Name..\"\\n\",false, 912)\n\
			\n\
			if kTargetPilot:IsNil() == false then\n\
				local kTargetActor = kTargetPilot:GetActor()\n\
				kTargetActor:AttachParticleS(200,\"char_root\", \"ef_slowheal_02_char_root\", 1) \n\
			else\n\
				--ODS(\"kTargetPilot \\n\", false, 912)\n\
			end\n\
			i=i+1\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2784,kSoundID)\n\
		end	\n\
    end\n\
end\n\
\n\
\n\
function Skill_HealingWave_Fire(kActor,kAction)\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
--	ODS(\"RestoreItemModel Skill_HealingWave_Fire\\n\", false, 912)\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	kAction:SetParamInt(2,-1)    --   \n\
	kAction:SetParamFloat(3,g_world:GetAccumTime()-1)  --    	\n\
	kAction:SetParamInt(4,0) --   \n\
end\n\
\n\
function Skill_HealingWave_UpdateTarget(kActor,kAction,accumTime)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    if kActor:IsMyActor() == false then\n\
        return\n\
    end\n\
\n\
    --  1      .\n\
    local   fLastUpdateTime = kAction:GetParamFloat(3)\n\
    if accumTime - fLastUpdateTime <= 1.0 then\n\
        return\n\
    end\n\
   \n\
    kAction:SetParamFloat(3,accumTime)\n\
	Skill_HealingWave_OnFindTarget(kActor, kAction, kAction:GetTargetList())\n\
	--   \n\
	if kActor:IsMyActor() == true then\n\
		--kAction:CreateActionTargetList(kActor)		\n\
		local kTargetList = kAction:GetTargetList()		\n\
		local iTargetCount = kTargetList:size()\n\
		local iMaxTargetCnt = kAction:GetAbil(AT_MAX_TARGETNUM)\n\
		local i = iMaxTargetCnt\n\
		if(iMaxTargetCnt < iTargetCount) then 			\n\
			while(i < iTargetCount) do \n\
				kTargetList:DeleteTargetInfo(i)\n\
				i=i+1\n\
			end\n\
		end\n\
		kAction:BroadCastTargetListModify(kActor:GetPilot(),true)		\n\
	end\n\
	\n\
	Skill_HealingWave_CreateLinkedPlane(kActor,kAction)   --  LinkedPlane \n\
end\n\
\n\
function Skill_HealingWave_OnFindTarget(kActor,kAction,kTargets)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())	\n\
	\n\
	kAction:ClearTargetList()   --  \n\
	\n\
	local  iAttackRange = kAction:GetSkillRange(0,kActor)\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
--	ODS(\" :\"..iAttackRange..\"\\n\", false, 912)\n\
	\n\
    local   kMyHandPos = kActor:GetNodeWorldPos(\"p_wp_l_hand\")\n\
	local kParam = FindTargetParam()\n\
	\n\
	--     \n\
	kParam:SetParam_1(kMyHandPos,kActor:GetLookingDir())\n\
	kParam:SetParam_2(iAttackRange,kAction:GetAbil(AT_1ST_AREA_PARAM2),0,1)\n\
	kParam:SetParam_3(true,FTO_NORMAL)\n\
	local	kTempTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo())\n\
	local iTargets = kAction:FindTargets(TAT_BAR,kParam,kTempTargets,kTempTargets)\n\
	\n\
	--    ~\n\
	if iTargets == 0 then\n\
		return  iTargets\n\
	end\n\
	--ODS(\"  ---------------------------------------------------------\\n\", false, 912)\n\
	local kTargetInfo = Skill_HealingWave_GetNearest_NoMarked_TargetInfo(kActor, kAction, kMyHandPos, kTempTargets)\n\
    if nil == kTargetInfo then return 0 end\n\
	if true == kTargetInfo:IsNil() then return 0 end\n\
\n\
    --   \n\
	Skill_HealingWave_AddTarget(kAction, kTargetInfo)\n\
		\n\
	--     . \n\
	local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
	if(true == kTargetGUID:IsNil()) then return end\n\
	local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)	\n\
	local 	kActorTarget = kTargetPilot:GetActor()		\n\
	local kBeginPos = kActorTarget:GetPos()\n\
	Skill_HealingWave_FindTarget(kActor, kAction, kBeginPos)\n\
	\n\
	local kCurTargetList = kAction:GetTargetList()\n\
	local iTargetCount = kCurTargetList:size()	\n\
	--ODS(\"   :\"..iTargetCount..\"---------------------------------------------------------\\n\", false, 912)	\n\
	return iTargetCount\n\
end\n\
\n\
\n\
function Skill_HealingWave_CreateLinkedPlane(kActor,kAction)\n\
\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    local   kMan = GetLinkedPlaneGroupMan()\n\
       \n\
    local   iGroupNum = kAction:GetParamInt(2)\n\
    local   kGroup\n\
    if iGroupNum == -1 then\n\
        --    .\n\
        kGroup = kMan:CreateNewLinkedPlaneGroup()\n\
        kGroup:SetTexture(\"../Data/5_Effect/9_Tex/ef_healing_wave_01.dds\")\n\
        kAction:SetParamInt(2,kGroup:GetInstanceID())\n\
        \n\
    else\n\
        --     \n\
        kGroup = kMan:GetLinkedPlaneGroup(iGroupNum)\n\
        kGroup:ReleaseAllPlane()\n\
    end\n\
\n\
    local kPlane = kGroup:AddNewPlane(127)    --   1 .\n\
    kPlane:SetWidth(20)\n\
    \n\
    local   kTargetList = kAction:GetTargetList()\n\
    local   iTargetCount = kTargetList:size()    \n\
    local   i=0\n\
\n\
    while i<iTargetCount-1 do\n\
        local kPlane = kGroup:AddNewPlane(127)\n\
        kPlane:SetWidth(20)\n\
        i=i+1\n\
    end\n\
\n\
end\n\
function Skill_HealingWave_UpdatePlanePos(kActor,kAction)\n\
--         \n\
--    TargetList        \n\
--               \n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    local   kMan = GetLinkedPlaneGroupMan()\n\
\n\
    local   iGroupNum = kAction:GetParamInt(2)\n\
\n\
    local kGroup = kMan:GetLinkedPlaneGroup(iGroupNum)\n\
--    kGroup:SetTextureCoordinateUpdateDelay(0.05)\n\
    local   kTargetList = kAction:GetTargetList()\n\
	if(true == kTargetList:IsNil()) then \n\
		ODS(\"Skill_HealingWave_UpdatePlanePos:   \\n\", false, 912)\n\
		return\n\
	end\n\
    local   iTargetCount = kTargetList:size()\n\
    \n\
    local   i=0\n\
    \n\
    local   kPlane = kGroup:GetPlane(i)\n\
\n\
    --    StartPos   .\n\
	local kDist = kActor:GetLookingDir()\n\
    local   kMyHandPos = kActor:GetNodeWorldPos(\"p_wp_r_hand\")\n\
	kDist:Multiply(-12)\n\
	kMyHandPos:Add(kDist)	\n\
    kPlane:SetStartPos(kMyHandPos)\n\
		\n\
	local  iAttackRange = kAction:GetSkillRange(0,kActor)\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
    if iTargetCount == 0 then\n\
    \n\
       --     AttackRange      .\n\
        local kLookDir = kActor:GetLookingDir()		\n\
        kLookDir:Multiply(iAttackRange)\n\
        kLookDir:Add(kMyHandPos)        \n\
        kPlane:SetEndPos(kLookDir)    \n\
		kPlane:SetEnable(true)\n\
		--ODS(\"   \\n\", false, 912)\n\
        return\n\
    end    \n\
    \n\
    local   kFirstPos = kMyHandPos\n\
    local 	kPrevPos = kMyHandPos\n\
	--ODS(\"   :\"..iTargetCount..\"\\n\", false, 912)\n\
	\n\
	--   \n\
	\n\
	--ODS(\"  -----------------------------\"..iTargetCount..\"\\n\", false, 912)\n\
    while i<iTargetCount do\n\
	\n\
        -- local   kTargetInfo = kTargetList:GetTargetInfo(i)\n\
		-- if(nil == kTargetInfo) then return end\n\
		-- if(true == kTargetInfo:IsNil()) then return end\n\
        -- local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
		-- if(true == kTargetGUID:IsNil()) then return end\n\
        -- local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
        local   bActorInvalid = true\n\
        \n\
--      if kTargetPilot:IsNil() == false then\n\
		--	local Name = kTargetPilot:GetName():GetStr()\n\
	--		ODS(\"   :\"..Name..\"\\n\",false, 912)\n\
			\n\
            --local   kTargetActor = kTargetPilot:GetActor()\n\
			local kTargetActor = Skill_HealingWave_GetNearestActor(kActor, kAction, kFirstPos, kTargetList)\n\
			if(nil == kTargetActor) then return end\n\
            if kTargetActor:IsNil() == false then				\n\
				local kCurPos = kTargetActor:GetPos()\n\
                kPlane:SetEndPos(kCurPos)\n\
                kPlane:SetEnable(true)\n\
                bActorInvalid = false\n\
                \n\
                --if kFirstPos == nil then\n\
                    kFirstPos = kTargetActor:GetPos()				\n\
                --end\n\
				--[[\n\
				local fDist = kPrevPos:Distance(kCurPos)\n\
				kPrevPos = kTargetActor:GetPos()	-- \n\
				if(fDist > iAttackRange) then\n\
					bActorInvalid = true\n\
					--ODS(\"  \\n\", false, 912)\n\
					kTargetList:DeleteTargetInfo(i)\n\
				end\n\
				]]\n\
				--ODS(\"iAttackRange:\"..iAttackRange..\"\\n\", false, 912)					\n\
               \n\
            end\n\
		--end \n\
        kPlane:SetEnable(bActorInvalid == false)   --      .\n\
                \n\
        i=i+1\n\
        \n\
        kPlane = kGroup:GetPlane(i)\n\
   \n\
        if kPlane:IsNil() then\n\
            break\n\
        end\n\
\n\
        if kFirstPos ~= nil then\n\
            kPlane:SetStartPos(kFirstPos)\n\
        else\n\
            kPlane:SetStartPos(kMyHandPos)\n\
        end\n\
        \n\
    end\n\
	--ODS(\"  --------------------------------------------\\n\", false, 912)\n\
end\n\
\n\
function Skill_HealingWave_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local actorID = kActor:GetID()\n\
	local actionID = kAction:GetID()\n\
	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
--	ODS(\"Skill_HealingWave_OnEnter actionID:\"..actionID..\" GetActionParam:\"..kAction:GetActionParam()..\"\\n\", false, 912)\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	Skill_HealingWave_OnCastingCompleted(kActor,kAction)\n\
	kActor:SetParam(\"shot\", \"false\")\n\
	\n\
	kAction:SetParamInt(10, 0)	--   	\n\
	local iMaxTargetCnt = kAction:GetAbil(AT_MAX_TARGETNUM)\n\
	if(0 == iMaxTargetCnt) then \n\
		iMaxTargetCnt = 3\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	kAction:SetParamFloat(30, g_world:GetAccumTime())\n\
	local  iAttackRange = kAction:GetSkillRange(0,kActor)\n\
\n\
	return true\n\
end\n\
\n\
function Skill_HealingWave_OnUpdate(kActor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
--	local actorID = kActor:GetID()\n\
	local kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	--ODS(\" :\"..kAction:GetParamInt(10)..\"\\n\", false, 912)\n\
	\n\
	local animDone = kActor:IsAnimationDone()\n\
	\n\
\n\
--	local nextActionName = kAction:GetNextActionName()\n\
--	local actionID = kAction:GetID()\n\
	local iCurrentSlot = kAction:GetCurrentSlot()\n\
\n\
	if kActor:IsMyActor() then\n\
		local	bKeyUp = KeyIsDown(KEY_UP)\n\
		local	bKeyDown = KeyIsDown(KEY_DOWN)\n\
		local	bKeyLeft = KeyIsDown(KEY_LEFT)\n\
		local	bKeyRight = KeyIsDown(KEY_RIGHT)\n\
		\n\
		local	iDir = 0\n\
		if bKeyUp then \n\
			iDir = iDir + DIR_UP\n\
		end\n\
		if bKeyDown then\n\
			iDir = iDir + DIR_DOWN\n\
		end\n\
		if bKeyLeft then\n\
			iDir = iDir + DIR_LEFT\n\
		end\n\
		if bKeyRight then\n\
			iDir = iDir + DIR_RIGHT\n\
		end\n\
\n\
		if iDir ~= 0 then\n\
			local iMoveSpeed = kAction:GetAbil(AT_MOVESPEED)\n\
			--ODS(\"\"..iMoveSpeed..\"\\n\", false, 912)\n\
			local kDirection = kActor:GetDirectionVector(iDir)\n\
\n\
			kDirection:Multiply(iMoveSpeed)\n\
			kActor:SetMovingDelta(kDirection)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local fTimeDelta = g_world:GetAccumTime() - kAction:GetParamFloat(30)\n\
			if(fTimeDelta > 0.02) then --       \n\
				g_pilotMan:BroadcastDirection(kActor:GetPilot(), iDir)\n\
				kAction:SetParamFloat(30, g_world:GetAccumTime())\n\
			end\n\
		end\n\
	end	\n\
	\n\
	if(1 == kAction:GetParamInt(10)) then \n\
		kAction:SetParamInt(10, 2)\n\
		kActor:PlayNext()\n\
		--ODS(\" \\n\", false, 912)\n\
		return true\n\
	elseif (2 == kAction:GetParamInt(10) and (true == animDone) ) then\n\
		kAction:SetParamInt(10, 3)\n\
		return false\n\
	end\n\
	\n\
	\n\
	if animDone == true then\n\
		--ODS(\"update:\\n\", false, 912)\n\
		kAction:SetSlot(kAction:GetCurrentSlot()+1)\n\
		kActor:PlayCurrentSlot()\n\
		kActor:SetParam(\"shot\", \"true\")\n\
		kActor:AttachParticle(9221,\"p_wp_r_hand\",\"ef_skill_HealingWave_01\")\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		Skill_HealingWave_UpdateTarget(kActor,kAction,g_world:GetAccumTime())\n\
\n\
		Skill_HealingWave_CreateLinkedPlane(kActor,kAction)\n\
		kAction:SetParamInt(10, 4)\n\
	end\n\
\n\
	if iCurrentSlot == 1 then\n\
		if kAction:GetActionParam() == AP_FIRE and kActor:GetParam(\"shot\") == \"true\" then\n\
		--ODS(\"update: 1\\n\", false, 912)\n\
			if(false == Skill_IsHealingEffect(kActor, kAction)) then\n\
				return false\n\
			end\n\
			Skill_HealingWave_UpdateTarget(kActor,kAction,accumTime)\n\
			Skill_HealingWave_UpdatePlanePos(kActor,kAction)\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_HealingWave_OnCleanUp(kActor)\n\
	--ODS(\"~\\n\",false, 912)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
    --   .\n\
    local   iGroupNum = kActor:GetAction():GetParamInt(2)\n\
    if iGroupNum ~= -1 then\n\
        local   kMan = GetLinkedPlaneGroupMan()\n\
        kMan:ReleaseLinkedPlaneGroup(iGroupNum)\n\
        kActor:GetAction():SetParamInt(2,-1)\n\
    end \n\
   \n\
    kActor:DetachFrom(9221)    \n\
	return true\n\
end\n\
\n\
function Skill_HealingWave_OnLeave(kActor, kAction)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local kCurAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	\n\
	local curParam = kCurAction:GetParam(1)\n\
	local actionID = kAction:GetID()\n\
	\n\
--	ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
	if kActor:IsMyActor() == false then\n\
		return true\n\
	end\n\
\n\
	if(3 == kCurAction:GetParamInt(10)) then\n\
		--     \n\
		return true\n\
	end\n\
	\n\
	if kAction:GetActionType()==\"EFFECT\" then\n\
		return true\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true\n\
	end\n\
	\n\
    if \"a_run\" == actionID or  \"a_dash\" == actionID or \"a_hi\" == actionID then\n\
		--   ,     \n\
        return  false\n\
	else\n\
		--   \n\
		if(4 == kCurAction:GetParamInt(10)) then			\n\
			kCurAction:SetParamInt(10, 1)\n\
		end\n\
		return false\n\
") + std::string("    end\n\
			\n\
	return false \n\
end\n\
  \n\
function Skill_HealingWave_FindTarget(kActor, kAction, kBeginPos)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())	\n\
\n\
	-- MAX   \n\
	local kTargetList = kAction:GetTargetList()	\n\
	local iMaxTarget = kAction:GetAbil(AT_MAX_TARGETNUM)\n\
	if(iMaxTarget <= kTargetList:size()) then\n\
		return\n\
	end	\n\
		\n\
	local kParam = FindTargetParam()\n\
	--kBeginPos   \n\
	kParam:SetParam_1(kBeginPos,kActor:GetLookingDir())\n\
	kParam:SetParam_2(0,0,kAction:GetAbil(AT_2ND_AREA_PARAM1),kMaxTarget)\n\
	kParam:SetParam_3(true,FTO_NORMAL)	\n\
	\n\
	local	kTempTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo())\n\
	iTargets = kAction:FindTargets(TAT_SPHERE,kParam,kTempTargets,kTempTargets)\n\
	if(0 == iTargets) then \n\
	--       \n\
		DeleteActionTargetList(kTempTargets)\n\
		return \n\
	end\n\
	\n\
	--       \n\
	local kNewTargetInfo = nil\n\
	local i = 0\n\
	local iTargetCount = kTempTargets:size()\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTempTargets:GetTargetInfo(i)\n\
		if(true == kTargetInfo:IsNil()) then return end\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
		if(true == kTargetGUID:IsNil()) then return end\n\
		--  \n\
		kNewTargetInfo = Skill_HealingWave_GetNearest_NoMarked_TargetInfo(kActor, kAction, kBeginPos, kTempTargets)\n\
		if(nil ~= kNewTargetInfo) then\n\
			break\n\
		end		\n\
		i = i + 1\n\
	end\n\
	\n\
	if(nil == kNewTargetInfo) then \n\
--		ODS(\"  \\n\", false, 912)\n\
		return\n\
	end\n\
	\n\
--	local kCurTargetList = kAction:GetTargetList()\n\
--	kCurTargetList:AddTarget(kNewTargetInfo)\n\
	Skill_HealingWave_AddTarget(kAction, kNewTargetInfo)\n\
	\n\
	local   kTargetGUID = kNewTargetInfo:GetTargetGUID()\n\
	if(true == kTargetGUID:IsNil()) then return end\n\
\n\
	local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
	local   kTargetActor = nil	\n\
	if kTargetPilot:IsNil() == false then\n\
		kTargetActor = kTargetPilot:GetActor()\n\
	end\n\
	if(nil == kTargetActor) then return false end\n\
	local kTargetPos = kTargetActor:GetPos()\n\
	\n\
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\
	--  ,  \n\
	Skill_HealingWave_FindTarget(kActor,kAction, kTargetPos)\n\
	DeleteActionTargetList(kTempTargets) --      \n\
end\n\
\n\
function Skill_HealingWave_IsInActionTargetList(kActor,kAction, kCompareGUID)\n\
-- kCompareGUID GUID      \n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local i = 0\n\
	local kTargetList = kAction:GetTargetList()\n\
	local iTargetCount = kTargetList:size()\n\
--	ODS(\"    : \"..iTargetCount..\"\\n\", false, 912)\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i)\n\
		if(false == kTargetInfo:IsNil()) then \n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
			if(false == kTargetGUID:IsNil()) then \n\
				if(kTargetGUID:GetString() == kCompareGUID:GetString()) then\n\
	--			ODS(\"\\n\", false, 912)\n\
					return true\n\
				end\n\
			end\n\
		end		\n\
		i = i + 1\n\
	end	\n\
--	ODS(\" \\n\", false, 912)\n\
	return false\n\
end\n\
\n\
function Skill_HealingWave_AddTarget(kAction, kTargetInfo)\n\
-- MAX    \n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	local kTargetList = kAction:GetTargetList()\n\
	if(true == kTargetList:IsNil()) then return false end\n\
	\n\
	local iMaxTarget = kAction:GetAbil(AT_MAX_TARGETNUM)\n\
	--ODS(\"MaxTarget:\"..iMaxTarget..\"\\n\", false, 912)\n\
	if(iMaxTarget > kTargetList:size()) then\n\
		kTargetList:AddTarget(kTargetInfo)\n\
		-- local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
		-- if(false == kTargetGUID:IsNil()) then 		\n\
			-- local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
			-- if kTargetPilot:IsNil() == false then				\n\
			-- end\n\
		-- end\n\
		--ODS(\"  :\"..kTargetList:size()..\"\\n\", false, 912)		\n\
	else\n\
		return false\n\
	end	\n\
	return true \n\
end\n\
\n\
function Skill_HealingWave_GetNearest_NoMarked_TargetInfo(kActor, kAction, kFromPos, kTargetList)\n\
--kFromPos  \n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())	\n\
	if(nil == kFromPos) then return nil end\n\
\n\
	if(nil == kTargetList) then return nil end\n\
	if(true == kTargetList:IsNil()) then return nil end\n\
	\n\
	local kFoundTarget = nil	\n\
	local fMinDist = kAction:GetSkillRange(0,kActor)\n\
	if fMinDist == 0 then\n\
	    fMinDist = 100\n\
	end\n\
	\n\
	local i = 0	\n\
	local iTargetCount = kTargetList:size()\n\
	if(0 == iTargetCount) then \n\
		--ODS(\"Skill_HealingWave_GetNearest_NoMarked_TargetInfo  \\n\", false, 912)\n\
		return nil\n\
	end\n\
	--local Name  = \"\"\n\
	\n\
	--TargetList  \n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i)\n\
		if(false == kTargetInfo:IsNil()) then \n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
			if(false == kTargetGUID:IsNil()) then 		\n\
				local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
				if kTargetPilot:IsNil() == false then\n\
					local kTargetActor = kTargetPilot:GetActor()\n\
					local fDist = kFromPos:Distance(kTargetActor:GetPos())\n\
					--     \n\
					if(false == Skill_HealingWave_IsInActionTargetList(kActor,kAction, kTargetGUID)) then\n\
						if(fMinDist >= fDist) then \n\
							fMinDist = fDist\n\
							kFoundTarget = kTargetInfo  --	Name = kTargetPilot:GetName():GetStr()\n\
						end\n\
					end\n\
				end\n\
			end\n\
		end		\n\
		i = i + 1\n\
	end	\n\
	\n\
	-- if(nil == kFoundTarget) then \n\
		-- ODS(\"Skill_HealingWave_GetNearest_NoMarked_TargetInfo:   .\\n\", false, 912)\n\
	-- else\n\
		-- ODS(\"   :\"..Name..\"\\n\",false, 912)\n\
	-- end\n\
	\n\
	--\n\
	return kFoundTarget\n\
end\n\
\n\
\n\
\n\
function Skill_HealingWave_GetNearestActor(kActor, kAction, kFromPos, kTargetList)\n\
--kFromActor    \n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())	\n\
	if(nil == kFromPos) then return nil end\n\
	if(nil == kTargetList) then return nil end\n\
	if(true == kTargetList:IsNil()) then return nil end\n\
	\n\
\n\
	local kFoundActor = nil	\n\
	local fMinDist = kAction:GetSkillRange(0,kActor)\n\
	if fMinDist == 0 then\n\
	    fMinDist = 100\n\
	end\n\
	\n\
	local i = 0	\n\
	local iTargetCount = kTargetList:size()\n\
	if(0 == iTargetCount) then\n\
		return nil\n\
	end\n\
	--local Name  = \"\"\n\
	\n\
	--kTargetList   	\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i)\n\
		if(false == kTargetInfo:IsNil()) then \n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
			if(false == kTargetGUID:IsNil()) then 		\n\
				local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
				if kTargetPilot:IsNil() == false then\n\
					local kTargetActor = kTargetPilot:GetActor()\n\
					local kTargetPos = kTargetActor:GetPos()\n\
					--  ( ) \n\
					if(kTargetPos:GetX() ~= kFromPos:GetX() or\n\
					   kTargetPos:GetY() ~= kFromPos:GetY() or\n\
					   kTargetPos:GetZ() ~= kFromPos:GetZ()   ) then\n\
					   --   \n\
						local fDist = kFromPos:Distance(kTargetPos)						\n\
						if(fMinDist >= fDist) then \n\
							fMinDist = fDist\n\
							kFoundActor = kTargetActor 		--Name = kTargetPilot:GetName():GetStr()\n\
						end					\n\
					end\n\
				end\n\
			end\n\
		end		\n\
		i = i + 1\n\
	end	\n\
	-- if(nil == kFoundActor) then \n\
		-- ODS(\" :   .\\n\", false, 912)\n\
	-- else\n\
		-- ODS(\"     :\"..Name..\"\\n\",false, 912)\n\
	-- end\n\
	\n\
	--  \n\
	return kFoundActor\n\
end\n\
\n\
function Skill_IsHealingEffect(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsMyActor() == false then\n\
        return true;\n\
    end\n\
\n\
	local kPilot = actor:GetPilot();\n\
	if kPilot:IsNil() == false then\n\
		local kUnit = kPilot:GetUnit();\n\
		if kUnit:IsNil() == false then\n\
			local kSkillDef = GetSkillDef(action:GetActionNo());\n\
			if kSkillDef:IsNil() == false then\n\
				local kEffect = kUnit:GetEffect(kSkillDef:GetEffectNo(), true)\n\
		 		if kEffect:IsNil() == false then\n\
					return true;\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1,\"end\")\n\
	return false;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_DemolitionCharge_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Skill_DemolitionCharge_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_DemolitionCharge_Fire(actor,action);\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
function Skill_DemolitionCharge_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	action:CreateActionTargetList(actor);\n\
	\n\
end\n\
\n\
function Skill_DemolitionCharge_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local actionID = action:GetID()\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_DemolitionCharge_OnCastingCompleted(actor,action);\n\
\n\
	actor:StopJump()\n\
\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	local pilot = g_pilotMan:NewPilot(guid, 1000656, 0) -- sa_demolitioncharge\n\
	if false == pilot:IsNil() then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		local kBird = pilot:GetActor()\n\
		if false == kBird:IsNil() then\n\
			kBird:FreeMove(true)\n\
			local kTrans = actor:GetTranslate()\n\
			kTrans:SetZ(kTrans:GetZ()+5)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:AddActor(guid, kBird, kTrans, 9);\n\
			pilot:GetUnit():SetCaller(actor:GetPilotGuid())\n\
			local	kLookAt = actor:GetLookingDir()\n\
			kBird:LookAt(actor:GetTranslate():_Add(kLookAt), true)	--  \n\
			kBird:ReserveTransitAction(\"a_DemolitionChargeSA\")\n\
			pilot:GetActor():ClearActionState();\n\
			if actor:IsMyActor() then\n\
	        	pilot:GetActor():SetUnderMyControl(true);\n\
		    end\n\
\n\
			local fScale = (action:GetSkillLevel()%10)*0.05 + 1.0	--  \n\
			kBird:SetTargetScale(fScale, 0.56)\n\
			action:SetParam(123,guid:GetString())	--GUID \n\
			g_pilotMan:InsertPilot(guid, pilot)\n\
		end\n\
	end\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DemolitionCharge_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
\n\
	local curAnimSlot = action:GetCurrentSlot();\n\
\n\
	if curAnimSlot == 3 then\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\");\n\
			return false\n\
		end	\n\
	else\n\
		if action:GetActionParam() == AP_FIRE then\n\
			if animDone == true then\n\
				action:SetParam(1, \"end\");\n\
				if actor:IsMyActor() then\n\
					if 0==curAnimSlot then\n\
						actor:AttachParticle(123, \"char_root\", \"ef_skill_Demolition_charge_01_char_root\")\n\
					elseif 2==curAnimSlot then\n\
						actor:DetachFrom(123)\n\
					end\n\
				end\n\
				actor:PlayNext()\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DemolitionCharge_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	Skill_DemolitionCharge_RemoveEntity(actor:GetAction())\n\
	actor:DetachFrom(123)\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_DemolitionCharge_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
\n\
	if action:GetID() == \"a_battle_idle\" then\n\
		return true;\n\
	end\n\
\n\
	if action:GetID() ~= \"a_act\" then\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_DemolitionCharge_RemoveEntity(curAction)\n\
	local guid = GUID(curAction:GetParam(123))\n\
	local Death = g_pilotMan:FindPilot(guid)	--      \n\
	if false==Death:IsNil() and false==Death:GetActor():IsNil() then\n\
		if 3==Death:GetActor():GetAction():GetCurrentSlot() then\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:RemoveActorOnNextUpdate(guid)			\n\
		else\n\
			Death:GetActor():GetAction():SetSlot(3)\n\
			Death:GetActor():PlayCurrentSlot()\n\
			Death:GetActor():AttachParticle(125, \"char_root\", \"ef_skill_demolition_charge_03_char_root\")\n\
		end\n\
	end\n\
end\n\
\n\
function Skill_DemolitionCharge_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	Act_Melee_Default_OnEvent(actor,textKey)\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		QuakeCamera(0.5, 1.8)\n\
		local kPos = actor:GetTranslate()\n\
		local kDir = actor:GetLookingDir()\n\
		kDir:Unitize()\n\
		kDir:Multiply(90)\n\
		kPos:Add(kDir)\n\
		actor:AttachParticleToPointS(124, kPos, \"ef_boom_06\",0.7)\n\
		local action = actor:GetAction()\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
		local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2783,kSoundID);\n\
		end		\n\
	end\n\
	return	true;\n\
end\n\
\n\
function Skill_DemolitionCharge_OnTargetListModified(actor,action,bIsBefore)\n\
	Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [HIT_SOUND_ID] : HIT     ID\n\
-- [FIRE_SOUND_ID] :  FIRE     ID\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
-- Melee\n\
function Skill_DemolitionCharge1_OnCheckCanEnter(actor,action)\n\
	return 	Act_Melee_Default_OnCheckCanEnter(actor,action)\n\
end\n\
function Skill_DemolitionCharge1_OnCastingCompleted(actor, action)\n\
	Act_Melee_Default_OnCastingCompleted(actor,action)\n\
end\n\
function Skill_DemolitionCharge1_Fire(actor,action)\n\
	Act_Melee_Default_Fire(actor,action)\n\
end\n\
\n\
function Skill_DemolitionCharge1_OnEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	actor:DetachFrom(123)\n\
	return Act_Melee_Default_OnEnter(actor, action)\n\
end\n\
\n\
function Skill_DemolitionCharge1_OnUpdate(actor, accumTime, frameTime)\n\
	return Act_Melee_Default_OnUpdate(actor, accumTime, frameTime)\n\
end\n\
\n\
function Skill_DemolitionCharge1_OnCleanUp(actor)\n\
	return Act_Melee_Default_OnCleanUp(actor)\n\
end\n\
\n\
function Skill_DemolitionCharge1_OnLeave(actor, action)\n\
	return Act_Melee_Default_OnLeave(actor, action)\n\
end\n\
\n\
function Skill_DemolitionCharge1_OnEvent(actor,textKey)\n\
	return	Skill_DemolitionCharge_OnEvent(actor,textKey)\n\
end\n\
\n\
function Skill_DemolitionCharge1_OnTargetListModified(actor,action,bIsBefore)\n\
	Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_DemolitionChargeSA_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local kCurAction = actor:GetAction();\n\
	if( false == kCurAction:IsNil() ) then\n\
		if action:GetID() == kCurAction:GetID() then\n\
			return false\n\
		end\n\
	end\n\
	return true\n\
end\n\
function Skill_DemolitionChargeSA_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	return true\n\
end\n\
\n\
function Skill_DemolitionChargeSA_OnCastingCompleted(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	actor:PlayCurrentSlot()\n\
end\n\
\n\
function Skill_DemolitionChargeSA_Shot_Fire(actor,action)\n\
\n\
end\n\
\n\
\n\
function Skill_DemolitionChargeSA_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	local action = actor:GetAction()\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local iSlot = action:GetCurrentSlot()\n\
	local bDone = actor:IsAnimationDone()\n\
	if true==bDone then\n\
		if 3==iSlot	then\n\
			return false\n\
		elseif 0==iSlot then\n\
			actor:AttachParticleS(124, \"p_ef_r_hand\", \"ef_dmg01_b\", 2.0)\n\
			actor:AttachParticle(125, \"p_ef_r_hand\", \"ef_skill_demolition_charge_02_p_ef_r_hand\")\n\
		elseif 1==iSlot then\n\
			actor:AttachParticleS(125, \"p_ef_r_hand\", \"ef_skill_demolition_charge_02_p_ef_r_hand\",2.0)\n\
			actor:AttachParticleS(126, \"p_ef_r_hand\", \"ef_dmg01_b\", 4.5)\n\
		elseif 2==iSlot then\n\
			actor:DetachFrom(125)\n\
			actor:AttachParticle(125, \"char_root\", \"ef_skill_demolition_charge_03_char_root\")\n\
		end\n\
\n\
		actor:PlayNext()\n\
	end\n\
\n\
	if 2>iSlot then\n\
		local guid = actor:GetCallerGuid()\n\
		if false==guid:IsNil() then\n\
			local Caller = g_pilotMan:FindPilot(guid)\n\
			if false==Caller:IsNil() then		\n\
				local CallerActor = Caller:GetActor()\n\
				if false == CallerActor:IsNil() then\n\
					actor:SetTranslate(CallerActor:GetTranslate())\n\
\n\
					local CallerAction = CallerActor:GetAction()\n\
					if false==CallerAction:IsNil() then\n\
						local kName = CallerAction:GetActionName()\n\
						local iRet = string.find(kName, \"demolitioncharge\")\n\
						if nil==iRet then\n\
							return false\n\
						end\n\
					end\n\
				end\n\
			else\n\
				return false\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Skill_DemolitionChargeSA_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	action:SetDoNotBroadCast(true)\n\
\n\
	return true;\n\
end\n\
function Skill_DemolitionChargeSA_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_DemolitionChargeSA_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	if textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0.0, 0.15); --   \n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
function Skill_GroundZero_Creature_Idle_OnCastingCompleted(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	Skill_GroundZero_Creature_Idle_Fire(kActor,kAction)\n\
	kAction:SetSlot(kAction:GetCurrentSlot()+1)\n\
	kActor:PlayCurrentSlot()\n\
	kAction:SetParam(3,\"0\")\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_Fire(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	local actionID = kAction:GetID()\n\
	\n\
	kAction:SetParam(3,\"0\")\n\
	kAction:SetParamInt(2,0)\n\
	kAction:SetParamInt(20, 0)	\n\
	kAction:SetParamInt(30, 2000)\n\
		\n\
	kActor:LockBidirection(false)\n\
	kActor:SeeFront(true)\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"CASTING_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2785,kSoundID)\n\
	end	\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	Skill_GroundZero_Creature_Idle_OnCastingCompleted(kActor,kAction)\n\
	QuakeCamera(4, 0.2, 1, 1, 1)\n\
	return true\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_OnUpdate(kActor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	local kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	kActor:LockBidirection(false)\n\
	kActor:SeeFront(true)\n\
	\n\
	local animDone = kActor:IsAnimationDone()\n\
	local nextActionName = kAction:GetNextActionName()\n\
	\n\
	if animDone == true then\n\
		return false\n\
	end	\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_OnCleanUp(kActor)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	local   kCurAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(kActor:GetPilotGuid())\n\
\n\
	--   \n\
	local i = 1000\n\
	while(i <= 1018) do\n\
		kActor:DetachFrom(i, true)\n\
		i = i+1 \n\
	end\n\
	\n\
	--   \n\
	i = 0\n\
	local iMax = kCurAction:GetParamInt(20)\n\
	if(i < iMax) then 	\n\
		while(i < iMax) do\n\
			kActor:DetachFrom(i, true)\n\
			i = i+1 \n\
		end	\n\
	end\n\
\n\
	return true\n\
	\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_OnLeave(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
		\n\
	return true\n\
end\n\
\n\
\n\
function Skill_GroundZero_Creature_Idle_OnTargetListModified(kActor,kAction,bIsBefore)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if kActor:IsMyActor()  then\n\
			kAction:GetTargetList():ApplyActionEffects(true,true)\n\
			return\n\
		end\n\
    end\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_OnEvent(kActor,textKey)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
	local kAction = kActor:GetAction()\n\
		\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
--		ODS(\" :\"..textKey..\"\\n\", false, 912)\n\
		\n\
	if( textKey == \"bang_03\") then	--  \n\
		if(kAction:GetParamInt(2) == 0) then \n\
			kAction:StartTimer(4.6, 0.1, 0)\n\
			kAction:SetParamInt(2, 1)			\n\
		end \n\
		kActor:AttachParticleS(1000, \"p_ef_shot_14\", \"ef_groundzero_fire_purple\", 0.5)		\n\
		kActor:AttachParticleS(1001, \"p_ef_shot_13\", \"ef_groundzero_fire_purple\", 0.5)		\n\
		kActor:AttachParticleS(1002, \"p_ef_shot_15\", \"ef_groundzero_fire_purple\", 0.5)		\n\
		kActor:AttachParticleS(1003, \"p_ef_shot_12\", \"ef_groundzero_fire_purple\", 0.5)\n\
		\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_14\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_13\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_15\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_12\", math.random(2, 5)/10)\n\
	elseif( textKey == \"bang_01\") then\n\
		kActor:AttachParticleS(1009, \"p_ef_shot_21\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1010, \"p_ef_shot_17\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1011, \"p_ef_shot_18\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1012, \"p_ef_shot_19\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1013, \"p_ef_shot_16\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1014, \"p_ef_shot_20\", \"ef_groundzero_fire_red\", 0.5)\n\
\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_21\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_17\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_18\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_19\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_16\", math.random(2, 5)/10)\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_20\", math.random(2, 5)/10)\n\
		\n\
	elseif( textKey == \"bang_02\") then\n\
		kActor:AttachParticleS(1016, \"p_ef_shot_22\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1017, \"p_ef_shot_23\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1018, \"p_ef_shot_24\", \"ef_groundzero_fire_red\", 0.5)\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_22\", math.random(2, 5)/10, true)\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_23\", math.random(2, 5)/10, true)		\n\
		Skill_GroundZero_AttatchCartridge(kActor, kAction, \"p_ef_shot_24\", math.random(2, 5)/10, true)\n\
		\n\
	elseif( textKey == \"bang_04\") then\n\
		local iIndex = kAction:GetParamInt(30)		\n\
		kActor:AttachParticleS(1004, \"p_ef_shot_11\", \"ef_groundzero_fire_red\", 0.5)				\n\
		kActor:AttachParticleS(1005, \"p_ef_shot_25\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1006, \"p_ef_shot_09\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1007, \"p_ef_shot_26\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1008, \"p_ef_shot_10\", \"ef_groundzero_fire_red\", 0.5)		\n\
		kActor:AttachParticleS(1015, \"p_ef_shot_21\", \"ef_groundzero_fire_red\", 0.5)\n\
		\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_11\", math.random(2, 5)/10, Quaternion(180,Point3(0,0,1)))\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_25\", math.random(2, 5)/10, Quaternion(180,Point3(0,0,1)))\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_09\", math.random(2, 5)/10, Quaternion(180,Point3(0,0,1)))\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_26\", math.random(2, 5)/10, Quaternion(180,Point3(0,0,1)))\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_10\", math.random(2, 5)/10, Quaternion(180,Point3(0,0,1)))\n\
		Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, \"p_ef_shot_21\", math.random(2, 5)/10, Quaternion(180,Point3(0,0,1)))\n\
				\n\
			--   \n\
	elseif( textKey == \"bomb\") then\n\
		local i = 2000\n\
		local iMax = kAction:GetParamInt(30)\n\
		if(i < iMax) then \n\
			while(i < iMax) do\n\
				kActor:DetachFrom(i, true)\n\
				i = i+1 \n\
			end	\n\
		end\n\
	end\n\
	\n\
	return	true\n\
end\n\
\n\
function Skill_GroundZero_Creature_Idle_OnTimer(kActor,fAccumTime,kAction,iTimerID)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	if 0 == iTimerID then	\n\
		local kBombEffTbl = {\"ef_base_dmg_ar_01\", \"ef_base_dmg_ar_02\", \"ef_boom_05\", \"e_dmg\"}		\n\
		local iIndex = kAction:GetParamInt(20)\n\
		local kPos = kActor:GetPos()	\n\
		\n\
		kPos:SetX(kPos:GetX() + math.random(-200,200))\n\
		kPos:SetY(kPos:GetY() + math.random(-200,200))\n\
		kPos:SetZ(kPos:GetZ()+50)\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500)\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500)\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				return true\n\
			end			\n\
		end\n\
		local iIdx = math.random(1 ,table.getn(kBombEffTbl))\n\
		--ODS(\":\"..iIdx..\" :\"..(kBombEffTbl[iIdx])..\"\\n\",false, 912)\n\
		kActor:AttachParticleToPointS(iIndex, ptcl, kBombEffTbl[iIdx], math.random(1, 1))\n\
		kAction:SetParamInt(20, iIndex + 1)\n\
	end	\n\
\n\
	return true\n\
\n\
end\n\
\n\
function Skill_GroundZero_AttatchCartridge(kActor, kAction, strTargetNodeName, fScale, bOnPos)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local iIndex = kAction:GetParamInt(30)		\n\
	if(bOnPos) then \n\
		kActor:AttachParticleToPointS(iIndex, kActor:GetNodeTranslate(strTargetNodeName), \"ef_cartridge_01\", fScale)\n\
	else\n\
		kActor:AttachParticleS(iIndex,strTargetNodeName, \"ef_cartridge_01\", fScale)\n\
	end	\n\
\n\
	kAction:SetParamInt(30, iIndex+1)		\n\
end\n\
\n\
function Skill_GroundZero_AttatchCartridgeQuat(kActor, kAction, strTargetNodeName, fScale, kRotate)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local iIndex = kAction:GetParamInt(30)\n\
	local kNodePos = kActor:GetNodeTranslate(strTargetNodeName)\n\
	local kNodeRoate = kActor:GetNodeWorldRotate(strTargetNodeName)\n\
	if(nil ~= kRotate) then\n\
		kNodeRoate = kRotate\n\
	end\n\
	kActor:AttachParticleToPointWithRotate(iIndex, kNodePos, \"ef_cartridge_01\", kNodeRoate, fScale)\n\
	kAction:SetParamInt(30, iIndex+1)		\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
-- Melee\n\
function Skill_CrossBlade_Play_OnCheckCanEnter(kActor,kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	return		true\n\
	\n\
end\n\
function Skill_CrossBlade_Play_OnCastingCompleted(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	Skill_CrossBlade_Play_Fire(kActor,kAction)\n\
	kAction:SetParamInt(10, math.random(0, 1))\n\
	--local iSlotCount = kAction:GetSlotCount()\n\
	kAction:SetSlot(kAction:GetParamInt(10))\n\
	kActor:PlayCurrentSlot()\n\
	kAction:SetParam(3,\"0\")	\n\
--	kActor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",500,100,500)\n\
--	kActor:StartWeaponTrail()\n\
end\n\
function Skill_CrossBlade_Play_Fire(kActor,kAction)\n\
	ODS(\"RestoreItemModel Skill_CrossBlade_Play_Fire\\n\")\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2783,kSoundID)\n\
	end	\n\
	\n\
    local   kFireEffectID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            kActor:AttachParticleToPoint(7212,kDir,kFireEffectID)            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            kActor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID)\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			kActor:AttachParticleToPoint(7212,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID)			\n\
		else\n\
		    kActor:AttachParticleToPointWithRotate(7212,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, kActor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\")\n\
    kFireEffectTargetNodeID = kAction:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\")\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            kActor:AttachParticleToPoint(7213,kDir,kFireEffectID)\n\
            \n\
        else\n\
            kActor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID)\n\
        end\n\
    \n\
    end	\n\
		\n\
	if kAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    kActor:StartWeaponTrail()\n\
	end\n\
\n\
end\n\
\n\
function Skill_CrossBlade_Play_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
--	local actorID = kActor:GetID()\n\
	local actionID = kAction:GetID()\n\
--	local weapontype = kActor:GetEquippedWeaponType()\n\
	kAction:SetParamFloat(11,0)\n\
	\n\
	kAction:SetParamInt(100,0) --   . \n\
	kAction:SetParamInt(101,2)\n\
	\n\
	kAction:SetParamInt(102,3) --   \n\
	kAction:SetParamInt(103,3)\n\
	\n\
	\n\
	ODS(\"Skill_CrossBlade_Play_OnEnter actionID:\"..actionID..\" GetActionParam:\"..kAction:GetActionParam()..\"\\n\")\n\
	kAction:SetParamInt(AT_COUNT, 0)\n\
	kAction:SetParam(3,\"0\")\n\
	local   kFireEffectID = kAction:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = kAction:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = kAction:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == kAction:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (kAction:GetSkillRange(0,kActor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = kActor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(kActor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            kActor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize)\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            kActor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize)\n\
		else\n\
			kActor:AttachParticleToPointS(7215,kActor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize)\n\
        end\n\
		kAction:SetParam(3,\"1\")\n\
    end	\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"CASTING_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2785,kSoundID)\n\
	end	\n\
	\n\
	kAction:SetParamInt(2,0)\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	Skill_CrossBlade_Play_OnCastingCompleted(kActor,kAction)\n\
	\n\
	if kActor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(kAction:GetID())\n\
	end\n\
\n\
--	local fRandom = math.random(25, 50)\n\
--	fRandom =fRandom*0.01\n\
--	kActor:AttachParticleS(7217, \"char_root\" , \"ef_skill_cross_blade_03_char_root\", 0.5)	--   \n\
	kAction:StartTimer(10, 0.5, 0)\n\
	return true\n\
end\n\
\n\
function Skill_CrossBlade_Play_OnUpdate(kActor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
--	local actorID = kActor:GetID()\n\
	local kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
--	ODS(\" :\"..kAction:GetCurrentSlot()..\"\\n\",false, 912)\n\
	local animDone = kActor:IsAnimationDone()\n\
	local nextActionName = kAction:GetNextActionName()\n\
--	local actionID = kAction:GetID()\n\
--	local iComboCount = kActor:GetComboCount()\n\
	\n\
	if kAction:GetParam(1) == \"end\" then\n\
		return	false\n\
	end\n\
\n\
	if kAction:GetParam(1) == \"wait_for_end\" then\n\
		if(1 < GetWorldAccumTime()-kAction:GetParamFloat(11)) then \n\
			kAction:SetParam(1, \"end\")\n\
			kActor:SetHide(true)\n\
		end\n\
		return true\n\
	end\n\
\n\
	if animDone == true then\n\
		\n\
		--local iSlotCount = kAction:GetSlotCount()\n\
		--kAction:SetSlot(math.random(0, iSlotCount))		\n\
		local iSlot = kAction:GetParamInt(10)\n\
		\n\
		if(kAction:GetParam(1) == \"finish_attack\") then\n\
		--    \n\
			local iMin = kAction:GetParamInt(102)\n\
			local iMax = kAction:GetParamInt(103)\n\
			iSlot = math.random(iMin, iMax)\n\
			kAction:SetParam(1, \"add_smoke\")\n\
			kAction:DeleteTimer(0)\n\
		elseif kAction:GetParam(1) == \"add_smoke\"  then\n\
		--    \n\
			iSlot = kAction:GetSlotCount()-1\n\
			kAction:SetParamFloat(11, GetWorldAccumTime())\n\
			kAction:SetParam(1, \"wait_for_end\")\n\
			g_pilotMan:RemoveReservedPilot(kActor:GetPilotGuid())\n\
			kActor:AttachParticleS(7216,\"char_root\",\"ef_smog_03_char_root\", 1)\n\
			kActor:SetTargetAlpha(kActor:GetAlpha(),0, 0.5)\n\
		else\n\
		--  \n\
		--[[\n\
			if(0 == iSlot) then \n\
				iSlot = 1\n\
			else\n\
				iSlot = 0\n\
			end\n\
		]]\n\
			local iMin = kAction:GetParamInt(100)\n\
			local iMax = kAction:GetParamInt(101)\n\
			iSlot = math.random(iMin, iMax)\n\
			kAction:SetParamInt(10, iSlot)\n\
		end\n\
		kAction:SetSlot(iSlot)\n\
		kActor:PlayCurrentSlot()\n\
	end\n\
	--[[\n\
	if(kAction:GetParam(1) == \"finish_attack\" or kAction:GetParam(1) == \"add_smoke\") then\n\
		return true\n\
	end\n\
	]]\n\
				\n\
	local iMoveSpeed = kAction:GetAbil(AT_MOVESPEED)	\n\
	if (0 == iMoveSpeed) then\n\
		iMoveSpeed = 60\n\
	end\n\
	\n\
	local kDirection = kActor:GetLookingDir()\n\
	kDirection:Multiply(iMoveSpeed)\n\
	kActor:SetMovingDelta(kDirection)\n\
	return true\n\
end\n\
\n\
function Skill_CrossBlade_Play_OnCleanUp(kActor)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
    local   kCurAction = kActor:GetAction()\n\
	\n\
	ODS(\"RestoreItemModel Skill_CrossBlade_Play_ReallyLeave\\n\")\n\
--	kActor:EndBodyTrail()\n\
--	kActor:EndWeaponTrail()\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		kActor:RestoreItemModel(ITEM_WEAPON)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		kActor:HideParts(EQUIP_POS_WEAPON, false)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    kActor:EndWeaponTrail()\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false\n\
		local DefaultDetaChID2 = false\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true\n\
		end		\n\
\n\
	    kActor:DetachFrom(7212,DefaultDetaChID)\n\
	    kActor:DetachFrom(7213,DefaultDetaChID2)\n\
		kActor:DetachFrom(7214)\n\
		kActor:DetachFrom(7217, true) --  \n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
		kActor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\")\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\")\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"))\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 kActor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale)\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		kActor:DetachFrom(7215,true)\n\
		if( false == kActor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\")			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true)\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:RemoveStatusEffectFromActor(kActor:GetPilotGuid(),iTransformEffectID)\n\
        \n\
        end\n\
    \n\
    end	\n\
	return true\n\
end\n\
\n\
function Skill_CrossBlade_Play_OnLeave(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	local curAction = kActor:GetAction()\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = kAction:GetID()\n\
	\n\
	if kActor:IsMyActor() == false then\n\
		return true\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		if( false == kActor:PlayNext()) then \n\
			kActor:GetAction():SetNextActionName(\"a_battle_idle\")\n\
		end\n\
		kActor:GetAction():ChangeToNextActionOnNextUpdate(true,true)\n\
		return false\n\
	end\n\
	\n\
	if kAction:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true\n\
	end\n\
	\n\
	if kAction:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\")\n\
		end\n\
	end\n\
	\n\
	if kAction:GetEnable() == true then\n\
	\n\
\n\
		curAction:SetParam(0,\"GoNext\")\n\
		curAction:SetParam(1,actionID)\n\
\n\
		return false\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
") + std::string("end\n\
\n\
function Skill_CrossBlade_Play_DoDamage(kActor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult)\n\
	CheckNil(nil==kActionTargetInfo)\n\
	\n\
	local kAction = kActor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if kActor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex()\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex)\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\")\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\")\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" then\n\
    \n\
        actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID)\n\
    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"))\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = kActor:GetAction():GetParamInt(2)\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	    \n\
	    \n\
	    if kAction:GetScriptParam(\"NO_DAMAGE_HOLD\") ~= \"TRUE\" then\n\
    	    \n\
	        --   \n\
	        local iShakeTime = g_fAttackHitHoldingTime * 1000\n\
	        kActor:SetAnimSpeedInPeriod(0.01, iShakeTime)\n\
	        kActor:SetShakeInPeriod(5, iShakeTime/2)\n\
	        actorTarget:SetShakeInPeriod(5, iShakeTime)		\n\
	    end\n\
	end\n\
end\n\
\n\
function Skill_CrossBlade_Play_HitOneTime(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	local	iHitCount = kAction:GetParamInt(2)\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_ID\")\n\
	    local   kHitEffectTargetNodeID = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\")\n\
		local   kHitEffectTargetNodeIDToPos = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = kAction:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				kActor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID)\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            kActor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID)\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				kActor:AttachParticleToPoint(7214,kActor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID)			\n\
			else\n\
			    kActor:AttachParticleToPointWithRotate(7214,kActor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, kActor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
--[[\n\
	local	iTotalHit = tonumber(kAction:GetScriptParam(\"MULTI_HIT_NUM\"))\n\
	if iTotalHit == nil or iTotalHit == 0 then\n\
	    iTotalHit = 1\n\
	end\n\
]]\n\
	\n\
	if iHitCount == iTotalHit then\n\
		return\n\
	end\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2784,kSoundID)\n\
	end	\n\
	\n\
	-- \n\
	if 1 == kActor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = kAction:GetScriptParam(\"HIT_SOUND_ID_MALE\")\n\
		if kSoundID2~=\"\" then\n\
			kActor:AttachSound(2785,kSoundID2)\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = kAction:GetScriptParam(\"HIT_SOUND_ID_FEMALE\")\n\
		if kSoundID2~=\"\" then\n\
			kActor:AttachSound(2785,kSoundID2)\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = kAction:GetTargetCount()\n\
	local i =0\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = kAction:GetTargetActionResult(i)\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = kAction:GetTargetGUID(i)\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor()\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true\n\
                        --   \n\
						local actionName = kAction:GetID()\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, kActor, actionName, 0, kAction:GetTargetInfo(i))\n\
                    end\n\
					Skill_CrossBlade_Play_DoDamage(kActor,actorTarget,actionResult, kAction:GetTargetInfo(i))\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1\n\
		\n\
		end\n\
	end\n\
\n\
	kAction:GetTargetList():ApplyActionEffects()\n\
	kAction:ClearTargetList();\n\
	kActor:ClearIgnoreEffectList()\n\
	\n\
	iHitCount = iHitCount + 1\n\
	kAction:SetParamInt(2,iHitCount)\n\
	\n\
end\n\
function Skill_CrossBlade_Play_OnTargetListModified(kActor,kAction,bIsBefore)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if kActor:IsMyActor()  then\n\
			kAction:GetTargetList():ApplyActionEffects(true,true)\n\
			return\n\
		end\n\
--[[\n\
		local	iTotalHit = tonumber(kAction:GetScriptParam(\"MULTI_HIT_NUM\"))\n\
		if iTotalHit == nil then\n\
			iTotalHit = 1\n\
		end\n\
		\n\
        if iTotalHit>1 or kAction:GetParamInt(2) > 0  then\n\
    ]]    \n\
		if kAction:GetParamInt(2) > 0  then\n\
            --  hit  \n\
            --    .\n\
            Skill_CrossBlade_Play_HitOneTime(kActor,kAction)\n\
        \n\
        end        \n\
    \n\
    end\n\
\n\
end\n\
\n\
function Skill_CrossBlade_Play_OnEvent(kActor,textKey)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
	local kAction = kActor:GetAction()\n\
		\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
		--   \n\
		local iMaxAttackCnt = kAction:GetAbil(AT_COUNT)\n\
		local iCurAttackCnt = kAction:GetParamInt(AT_COUNT)+1\n\
		kAction:SetParamInt(AT_COUNT, iCurAttackCnt)\n\
		\n\
		if kActor:IsUnderMyControl() then\n\
			local	bUseTLM = (kAction:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\")\n\
			if bUseTLM then\n\
			\n\
				kAction:CreateActionTargetList(kActor)\n\
				if kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
					local iTargetCount = kAction:GetTargetCount()\n\
					if iTargetCount == tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
						AddWarnDataStr(GetTextW(tonumber(kAction:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2)		\n\
					end\n\
				end\n\
\n\
				if IsSingleMode() then\n\
		        \n\
					Skill_CrossBlade_Play_HitOneTime(kActor,kAction)\n\
					Skill_CrossBlade_Play_OnTargetListModified(kActor,kAction,false)\n\
		            \n\
					return\n\
				else\n\
		        \n\
					kAction:BroadCastTargetListModify(kActor:GetPilot())\n\
					kAction:ClearTargetList();\n\
				end			\n\
			\n\
			end	\n\
		end	\n\
        Skill_CrossBlade_Play_HitOneTime(kActor,kAction)		\n\
		if(iMaxAttackCnt <= iCurAttackCnt) then 			\n\
			kAction:SetParamInt(AT_COUNT)\n\
		elseif(iMaxAttackCnt-1 == iCurAttackCnt) then\n\
			--    \n\
			kAction:SetParam(1, \"finish_attack\")\n\
		end\n\
		\n\
	end\n\
	\n\
	return	true\n\
end\n\
\n\
\n\
function Skill_CrossBlade_Play_OnTimer(kActor,fAccumTime,kAction,iTimerID)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
		\n\
	if 0 == iTimerID then	\n\
		kActor:AttachParticleS(7217,\"char_root\",\"ef_skill_rollingground_03_char_root\", 0.5)\n\
	end\n\
\n\
	return true\n\
\n\
end\n\
--[[\n\
function Skill_CrossBlade_Play_OnFindTarget(kActor,kAction,kTargets)\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	kParam:SetParam_1(kActor:GetPos(),kActor:GetLookingDir());\n\
	--kParam:SetParam_2(0,0,kAction:GetSkillRange(0,kActor),0);\n\
	kParam:SetParam_2(kAction:GetSkillRange(0,kActor),\n\
					  kAction:GetAbil(AT_1ST_AREA_PARAM2),\n\
					  kAction:GetAbil(AT_1ST_AREA_PARAM2),\n\
					  0\n\
					  );\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
		\n\
	return kAction:FindTargets(TAT_BAR,kParam,kTargets,kTargets);	\n\
end\n\
]]") );
	m_kContLuaText.push_back(std::string("--     !\n\
-- [PROJECTILE_ID] :   ID.     .\n\
-- [ATTACH_NODE] :   .     .\n\
function Skill_Nuclear_OnCastingCompleted(kActor,kAction)\n\
end\n\
\n\
function Skill_Nuclear_OnCheckCanEnter(actor,action)\n\
	ODS(\"Skill_Nuclear_OnCheckCanEnter\\n\", false, 912)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		local weapontype = actor:GetEquippedWeaponType()\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	if actor:IsMyActor() == true then\n\
		if actor:GetFloatHeight(70)<50  then\n\
			action:ChangeToNextActionOnNextUpdate(true,true)\n\
			return	false	\n\
		end	\n\
	end\n\
	\n\
	return true	\n\
end\n\
\n\
function Skill_Nuclear_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 0.7, 0.4,true,true);\n\
	end\n\
	\n\
--	local	actorID = actor:GetID()\n\
--	local	actionID = action:GetID()\n\
	local	weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	ODS(\"Skill_Nuclear_OnEnter weapontype : \"..weapontype..\"\\n\")\n\
\n\
	if actor:IsMyActor() == true then\n\
		Skill_Nuclear_FindTargets(actor,action)\n\
	else\n\
		GetActionResultCS(action, actor)\n\
	end\n\
	\n\
	action:SetParamInt(10, 175) --   \n\
	actor:StopJump()\n\
	actor:FreeMove(true)\n\
	actor:AttachParticleS(7216,\"char_root\",\"ef_nuclear_pickout\", 1)\n\
	return true\n\
end\n\
function Skill_Nuclear_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())	\n\
\n\
	local iAttackRange = action:GetSkillRange(0,actor)\n\
	local	arrow_worldpos = actor:GetPos()--kNewArrow:GetWorldPos()	--	 \n\
	\n\
--  \n\
--[[\n\
	local	kRotateAxis = actor:GetLookingDir()\n\
	kRotateAxis:Cross(Point3(0,0,1))\n\
	kRotateAxis:Unitize()\n\
	local	fRotateAngle = 20.0*3.141592/180.0\n\
\n\
	local kParam = FindTargetParam()\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir())\n\
	kParam:SetParam_2(iAttackRange,20,0,1)\n\
	kParam:SetParam_3(true,FTO_NORMAL+FTO_DOWN)		\n\
\n\
	local	kFireTargetDir = Point3(0.1,0.1,-1)\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle)\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir)\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets)\n\
	\n\
	kFireTargetDir = Point3(0.1,0.1,-1)\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle*2)\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir)\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets)\n\
	\n\
	kFireTargetDir = Point3(0.1,0.1,-1)\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle*3)\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir)\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets)\n\
	]]\n\
	return	kTargets:size()\n\
end\n\
\n\
function Skill_Nuclear_FindTargets(actor,action)\n\
\n\
    action:CreateActionTargetList(actor)\n\
	\n\
end\n\
\n\
function Skill_Nuclear_LoadToWeapon(actor,action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID()\n\
	local	kAttackNodeName = \"\"\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\")\n\
	end\n\
	\n\
--	kAttackNodeName = \"p_ef_heart\"\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid()\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid)\n\
	\n\
	local kProjectileOption = kNewArrow:GetOptionInfo() --  0    \n\
	if(false == kProjectileOption:IsNil()) then\n\
		kProjectileOption:SetAutoRemoveIfNoneTarget(false)\n\
		kNewArrow:SetOptionInfo(kProjectileOption)\n\
	end\n\
	\n\
	if kAttackNodeName == \"\" then\n\
		--  (    \n\
		kNewArrow:LoadToWeapon(actor)\n\
		local kPos = kNewArrow:GetWorldPos()\n\
		kPos:SetZ(kPos:GetZ()+12)\n\
		local kDir = actor:GetLookingDir()\n\
		kDir:Multiply(-33)\n\
		kPos:Add(kDir)\n\
		kNewArrow:LoadToPosition(kPos)\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName)\n\
	end\n\
	return kNewArrow\n\
end\n\
\n\
function Skill_Nuclear_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
--	local	actorID = actor:GetID()\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount()\n\
--	local	weapontype = actor:GetEquippedWeaponType()\n\
--	local	actionID = action:GetID()\n\
\n\
	if animDone == true then\n\
	\n\
		if(actor:IsMeetFloor()) then\n\
			action:SetParam(1, \"end\")\n\
			actor:ReserveTransitAction(\"a_battle_idle\")\n\
			return false\n\
		end\n\
	\n\
--		local	curActionSlot = action:GetCurrentSlot()\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			action:SetNextActionName(nextActionName)\n\
			return false\n\
		else\n\
\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
	elseif(action:GetParam(1) ==\"end\") then	\n\
		return false\n\
	end\n\
	\n\
	if(actor:IsMeetFloor()) then\n\
		action:SetParam(1, \"end\")\n\
		actor:ReserveTransitAction(\"a_battle_idle\")\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Nuclear_OnCleanUp(actor,action)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	actor:FreeMove(false)\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
	end	\n\
	\n\
	return true\n\
end\n\
function Skill_Nuclear_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	curAction = actor:GetAction()\n\
		\n\
	CheckNil(nil==curAction)\n\
	CheckNil(curAction:IsNil())\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	if actor:IsMyActor() == false then\n\
		return true\n\
	end\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		return true\n\
	end	\n\
	if actionID == \"a_jump\" then \n\
		return true\n\
	end	\n\
	\n\
	if action:GetEnable() == false then\n\
		\n\
		if curAction:GetParam(1)==actionID then\n\
			curAction:SetParam(0,\"\")\n\
		end\n\
		\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true\n\
		end\n\
	\n\
		curAction:SetParam(0,\"GoNext\")\n\
		curAction:SetParam(1,actionID)\n\
		\n\
		return false\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Nuclear_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local	action = actor:GetAction()		\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
		\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
		\n\
		local kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2783,kSoundID);\n\
		end	\n\
	\n\
		--local	iAttackRange = action:GetSkillRange(0,actor)\n\
		local iMissileMoveDist = action:GetParamInt(10)\n\
		\n\
		local kMoveVec = actor:GetLookingDir()\n\
		kMoveVec:Multiply(iMissileMoveDist)\n\
		local kActorPos = actor:GetPos()\n\
		local kTargetPos = kActorPos\n\
		kTargetPos:Add(kMoveVec)		\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		kTargetPos = g_world:ThrowRay(kTargetPos, Point3(0,0,-1),500)\n\
		if kTargetPos:GetX() == -1 and kTargetPos:GetY() == -1 and kTargetPos:GetZ() == -1 then\n\
			kTargetPos = kActorPos	-- Ray  \n\
		end\n\
		if(kTargetPos:GetZ() > kActorPos:GetZ()) then \n\
			kTargetPos:SetZ(0)\n\
		end\n\
		\n\
		kTargetPos:SetZ(kTargetPos:GetZ()+40)\n\
		\n\
--		local	kProjectileMan = GetProjectileMan()		\n\
--		local	iTargetCount = action:GetTargetCount()\n\
		local	iTargetABVShapeIndex = 0\n\
	\n\
		--  \n\
\n\
		local	kActionTargetList = action:GetTargetList()\n\
		\n\
			local	kTargetActor = nil\n\
			local	kActionTargetInfo = kActionTargetList:GetTargetInfo(0)\n\
			iTargetABVShapeIndex = 0\n\
			\n\
			if kActionTargetInfo:IsNil() == false then\n\
			\n\
				iTargetABVShapeIndex = kActionTargetInfo:GetABVIndex()\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kActionTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
					kTargetActor = kTargetPilot:GetActor()\n\
				end			\n\
				\n\
			end\n\
\n\
			local	kArrow = Skill_Nuclear_LoadToWeapon(actor,action)\n\
			local	arrow_worldpos = kArrow:GetWorldPos()	--	 \n\
		\n\
			if kTargetActor ~= nil and kTargetActor:IsNil() == false and kActionTargetInfo~=nil and kActionTargetInfo:IsNil() == false then\n\
				kArrow:SetTargetObject(kActionTargetInfo)	\n\
				kActionTargetList:DeleteTargetInfo(0)\n\
			end\n\
				\n\
			kArrow:SetMovingType(1)\n\
			--kArrow:SetParam_SinCurveLineType(math.random(50, 70), math.random(-45, 45)*DEGTORAD)\n\
			kArrow:SetParam_SinCurveLineType(110, 0)\n\
			kArrow:SetParamValue(\"TIME\", tostring(GetWorldAccumTime()))\n\
			kArrow:SetTargetLoc(kTargetPos)\n\
			kArrow:Fire(true)--	!\n\
\n\
	\n\
		actor:GetAction():SetParam(7,\"FIRED\")\n\
		actor:DetachFrom(7216, true)	--     \n\
		actor:ClearIgnoreEffectList()\n\
	elseif (\"free\" == textKey) then\n\
		actor:FreeMove(false)\n\
		action:SetParam(1, \"end\")\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND] : HIT    ,  .\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [QUAKE_TIME] :   \n\
-- [QUAKE_POWER] :   \n\
-- Melee\n\
function Skill_Reverse_Gravity_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Reverse_Gravity_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Reverse_Gravity_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
end\n\
\n\
function Skill_Reverse_Gravity_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Reverse_Gravity_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"));\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\");\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true);\n\
	end\n\
\n\
	actor:AttachParticleToPointS(7212,actor:GetNodeWorldPos(\"char_root\"),\"ef_Reversegravity_01_char_root\",1.3);\n\
	actor:AttachParticleS(7213,\"char_root\",\"ef_Reversegravity_02_char_root\",2.5);\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\");\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\");\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID);\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID);\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail();\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0);        \n\
        end    \n\
    end\n\
\n\
	local iTotalHit = 0;\n\
	local kSkillDef = GetSkillDef(action:GetActionNo());\n\
	if kSkillDef:IsNil() == false then\n\
		iTotalHit  = kSkillDef:GetAbil(AT_COUNT);\n\
	end\n\
\n\
	action:SetParamInt(8,0);\n\
	action:SetParamInt(9,0)	--	Hit Count\n\
	action:SetParamInt(30,iTotalHit);\n\
	action:SetParamInt(31,0); -- hit_timer  Check\n\
\n\
	action:SetParamInt(20,0);\n\
end\n\
\n\
function Skill_Reverse_Gravity_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Reverse_Gravity_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetParam(3,\"0\");\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Reverse_Gravity_OnCastingCompleted(actor,action);\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.4,true,true);\n\
		g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
	end\n\
\n\
	action:CreateActionTargetList(actor,true);\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local i = 0;\n\
	local kTargetList = action:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			if actor:IsMyActor() then\n\
				g_world:AddDrawActorFilter(kTargetGUID);\n\
			end\n\
		end\n\
		i = i + 1;\n\
	end\n\
\n\
	action:ClearTargetList();\n\
	\n\
	action:SetParamInt(21, action:GetSkillRange(0,actor)) --  \n\
	\n\
	if actor:IsMyActor() then\n\
		QuakeCamera(4, 1, 1, 1, 1);\n\
	end\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"CASTING_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"CASTING_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	end\n\
\n\
	actor:SetCanHit(false);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Reverse_Gravity_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot();\n\
\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		else\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end		\n\
		\n\
	return	true;\n\
end\n\
\n\
function Skill_Reverse_Gravity_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"RestoreItemModel Skill_Reverse_Gravity_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
	\n\
--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        end\n\
    end	\n\
	return true;\n\
end\n\
\n\
function Skill_Reverse_Gravity_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if curAction:GetNextActionName() ~= actionID then\n\
--		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		if actor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Reverse_Gravity_DoDamage(actor,actorTarget,kActionResult,kActionTargetInfo)\n\
	\n\
	CheckNil(nil==kActionResult);\n\
	CheckNil(nil==kActionTargetInfo);\n\
	\n\
	local kAction = actor:GetAction()\n\
	local kActionID = kAction:GetID()\n\
	\n\
	if actor:GetPilotGuid():IsEqual(actorTarget:GetPilotGuid()) then\n\
		return\n\
	end\n\
	\n\
	local	iABVIndex = kActionTargetInfo:GetABVIndex();\n\
	local pt = actorTarget:GetABVShapeWorldPos(iABVIndex);\n\
	\n\
    local   kHitTargetEffectID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_ID\");\n\
    local   kHitTargetEffectTargetNodeID = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\");\n\
	local   kHitTargetEffectTargetNodeIDToGround = kAction:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE_TO_GROUND\");\n\
    \n\
    if kHitTargetEffectID ~= \"\" and kHitTargetEffectTargetNodeID ~= \"\" or kHitTargetEffectTargetNodeIDToGround ~= \"\" then\n\
") + std::string("		if kHitTargetEffectTargetNodeID ~= \"\" then\n\
			actorTarget:AttachParticle(7211,kHitTargetEffectTargetNodeID,kHitTargetEffectID);\n\
		elseif kHitTargetEffectTargetNodeIDToGround == \"TRUE\" then\n\
    			local kPos = actorTarget:GetPos();\n\
			kPos:SetZ(kPos:GetZ() + 200);\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				--  .\n\
				ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
				if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
					return false;\n\
				end			\n\
			end\n\
\n\
			actor:AttachParticleToPoint(100 + kAction:GetParamInt(8), ptcl, kHitTargetEffectID);\n\
	        \n\
			kAction:SetParamInt(8,kAction:GetParamInt(8) + 1);\n\
\n\
			actorTarget:AttachParticleToPointS(200, ptcl, \"ef_Reversegravity_02_char_root\", 0.5);\n\
			--actor:AttachParticleS(7213,\"char_root\",\"ef_Reversegravity_02_char_root\",2.5);\n\
		end    \n\
    end	\n\
	\n\
	\n\
	if kAction:GetScriptParam(\"NO_DEFAULT_HIT_EFFECT\") ~= \"TRUE\" then\n\
		local   kHitTargetEffectOffset = tonumber(kAction:GetScriptParam(\"HIT_TARGET_EFFECT_RANDOM_OFFSET\"));\n\
		\n\
		if kHitTargetEffectOffset ~= nil then\n\
			pt:SetX(pt:GetX() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetY(pt:GetY() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
			pt:SetZ(pt:GetZ() + math.random(-kHitTargetEffectOffset,kHitTargetEffectOffset))\n\
		end\n\
\n\
		local	iHitCount = actor:GetAction():GetParamInt(2);\n\
\n\
	    if kActionResult:GetCritical() then\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg_cri\")\n\
	    else\n\
		    actorTarget:AttachParticleToPoint(12 + iHitCount, pt, \"e_dmg\")\n\
	    end	\n\
	end\n\
end\n\
\n\
function Skill_Reverse_Gravity_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	iHitCount = action:GetParamInt(2);\n\
	\n\
	if iHitCount == 0 then\n\
	\n\
	    local   kHitEffectID = action:GetScriptParam(\"HIT_CASTER_EFFECT_ID\");\n\
	    local   kHitEffectTargetNodeID = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE\");\n\
		local   kHitEffectTargetNodeIDToPos = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
		local   kHitEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
	    if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" or kHitEffectTargetNodeIDToPos ~= \"\"  or kHitEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
			if kHitEffectID ~= \"\" and kHitEffectTargetNodeID ~= \"\" then\n\
				actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeID ~= \"\" then\n\
	            actor:AttachParticle(7214,kHitEffectTargetNodeID,kHitEffectID);\n\
			elseif kHitEffectTargetNodeIDToPos ~= \"\" then\n\
				actor:AttachParticleToPoint(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPos),kHitEffectID);			\n\
			else\n\
			    actor:AttachParticleToPointWithRotate(7214,actor:GetNodeWorldPos(kHitEffectTargetNodeIDToPosWithRotate), kHitEffectID, actor:GetRotateQuaternion())\n\
		    end\n\
		end\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	-- \n\
	if 1 == actor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = action:GetScriptParam(\"HIT_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			actor:AttachSound(2785,kSoundID2);\n\
		end	\n\
	end\n\
		\n\
	local iTargetCount = action:GetTargetCount();\n\
	local i =0;\n\
	if iTargetCount>0 then\n\
		\n\
		local bWeaponSoundPlayed = false;\n\
		\n\
		while i<iTargetCount do\n\
		\n\
			local actionResult = action:GetTargetActionResult(i);\n\
			if actionResult:IsNil() == false then\n\
			\n\
				local kTargetGUID = action:GetTargetGUID(i);\n\
				local kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false and actionResult:IsMissed() == false then\n\
					\n\
					local actorTarget = kTargetPilot:GetActor();\n\
					\n\
                    if bWeaponSoundPlayed == false then\n\
                        bWeaponSoundPlayed = true;\n\
                        --   \n\
						local actionName = action:GetID();\n\
						if actionResult:GetCritical() then\n\
							actionName = \"Critical_dmg\"\n\
						end\n\
                        actorTarget:PlayWeaponSound(WST_HIT, actor, actionName, 0, action:GetTargetInfo(i));\n\
                    end\n\
					Skill_Reverse_Gravity_DoDamage(actor,actorTarget,actionResult, action:GetTargetInfo(i));\n\
				end\n\
				\n\
			end\n\
			\n\
			i=i+1;\n\
		\n\
		end\n\
	end\n\
\n\
	action:GetTargetList():ApplyActionEffects();\n\
	\n\
end\n\
function Skill_Reverse_Gravity_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	\n\
    if bIsBefore == false then\n\
\n\
		--  hit  \n\
        --    .\n\
        Skill_Reverse_Gravity_HitOneTime(actor,action);\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end       \n\
 \n\
    end\n\
end\n\
\n\
function Skill_Reverse_Gravity_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsMyActor() then\n\
			local iQuakeTime = kAction:GetScriptParamAsFloat(\"QUAKE_TIME\");\n\
			local iQuakePower = kAction:GetScriptParamAsFloat(\"QUAKE_POWER\");\n\
			if 0 < iQuakeTime and 0 < iQuakePower then\n\
				QuakeCamera(iQuakeTime, iQuakePower, 1, 1, 1);\n\
			end\n\
		end\n\
\n\
		if actor:IsUnderMyControl() then\n\
			if 0 == kAction:GetParamInt(31) then -- hit          .\n\
				kAction:CreateActionTargetList(actor);\n\
\n\
				local i = 0;\n\
				local kTargetList = kAction:GetTargetList();\n\
				local iTargetCount = kTargetList:size();\n\
				while i<iTargetCount do\n\
					local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
					local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
					local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false then\n\
						if actor:IsMyActor() then\n\
							if( CheckNil(g_world == nil) ) then return false end\n\
							if( CheckNil(g_world:IsNil()) ) then return false end\n\
							g_world:AddDrawActorFilter(kTargetGUID);\n\
						end\n\
					end\n\
					i = i + 1;\n\
				end\n\
\n\
				if IsSingleMode() then\n\
		        \n\
					Skill_Reverse_Gravity_HitOneTime(actor,kAction)\n\
					Skill_Reverse_Gravity_OnTargetListModified(actor,kAction,false)\n\
		            \n\
					return;\n\
				else\n\
					kAction:BroadCastTargetListModify(actor:GetPilot());\n\
					kAction:ClearTargetList();\n\
				end\n\
\n\
				kAction:SetParamInt(31,1);\n\
			end\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [CHECK_CAN_PREV_ACTION_ID] :      .\n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
\n\
function Skill_Reverse_Gravity2_OnCastingCompleted(kActor,kAction)\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnCheckCanEnter(actor,action)\n\
\n\
	local	kCurrentAction = actor:GetAction();\n\
	if( false == kCurrentAction:IsNil() ) then\n\
		local   kPrevActionID = action:GetScriptParam(\"CHECK_CAN_PREV_ACTION_ID\");\n\
		return (kCurrentAction:GetID() == kPrevActionID);\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	return Skill_Reverse_Gravity_OnTimer(actor,fAccumTime,action,iTimerID);\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	action:SetParamInt(21, action:GetSkillRange(0,actor) / 5 * 3) --  \n\
	--action:StartTimer(0.9, 0.1, 1); --   1\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot();\n\
\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
\n\
	if animDone == true then\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		else\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end		\n\
		\n\
	return	true;\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local kEndAction;\n\
	\n\
	if false == action:IsNil() then\n\
		kEndAction = action:GetScriptParam(\"END_ACTION\");\n\
	end\n\
\n\
	if actor:IsMyActor() and kEndAction == \"TRUE\" then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
		g_world:ClearDrawActorFilter()\n\
	end	\n\
\n\
	if kEndAction == \"TRUE\" then\n\
		actor:DetachFrom(7212,true)\n\
		actor:DetachFrom(7213,true)\n\
		actor:SetCanHit(true);\n\
	end\n\
	actor:RestoreLockBidirection();\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsMyActor() then\n\
			if actor:IsMyActor() then\n\
				local iQuakeTime = kAction:GetScriptParamAsFloat(\"QUAKE_TIME\");\n\
				local iQuakePower = kAction:GetScriptParamAsFloat(\"QUAKE_POWER\");\n\
				if 0 < iQuakeTime and 0 < iQuakePower then\n\
					QuakeCamera(iQuakeTime, iQuakePower, 1, 1, 1);\n\
				end\n\
			end\n\
\n\
			kAction:CreateActionTargetList(actor);\n\
\n\
			local i = 0;\n\
			local kTargetList = kAction:GetTargetList();\n\
			local iTargetCount = kTargetList:size();\n\
			while i<iTargetCount do\n\
				local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
				local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
				local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false then\n\
					if actor:IsMyActor() then\n\
						if( CheckNil(g_world == nil) ) then return false end\n\
						if( CheckNil(g_world:IsNil()) ) then return false end\n\
						g_world:AddDrawActorFilter(kTargetGUID);\n\
					end\n\
				end\n\
				i = i + 1;\n\
			end\n\
	\n\
			if IsSingleMode() then\n\
				Skill_Reverse_Gravity_HitOneTime(actor,kAction)\n\
				Skill_Reverse_Gravity2_OnTargetListModified(actor,kAction,false)\n\
\n\
				return;\n\
			else\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
				kAction:ClearTargetList();\n\
			end\n\
		end	\n\
	\n\
        --Skill_Reverse_Gravity_HitOneTime(actor,kAction)\n\
\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Reverse_Gravity2_OnTargetListModified(actor,action,bIsBefore)\n\
	return Skill_Reverse_Gravity_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
\n\
-- Melee\n\
function Skill_Club_Mania_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Skill_Club_Mania_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if 0 == iTimerID then\n\
		local	iHitCount = SkillHelpFunc_GetHitCount(action)\n\
		local	iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
		if iHitCount == iTotalHit then\n\
			return true\n\
		end\n\
		\n\
		local iCreateLimitCnt = action:GetParamInt(10)\n\
		if(0 < iCreateLimitCnt) then\n\
			ODS(\"iCreateLimitCnt \\n\", false, 912)\n\
			action:CreateActionTargetList(actor);		\n\
			iCreateLimitCnt  = iCreateLimitCnt-1\n\
			action:SetParamInt(10, iCreateLimitCnt)			\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:GetTargetList():SetActionEffectApplied(true)		\n\
		end\n\
		\n\
		local i = 0;\n\
		local kTargetList = action:GetTargetList();\n\
		local iTargetCount = kTargetList:size();\n\
		while i<iTargetCount do\n\
			local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
			local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
			local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
			if kTargetPilot:IsNil() == false then\n\
				if actor:IsMyActor() then\n\
					if( CheckNil(g_world == nil) ) then return false end\n\
					if( CheckNil(g_world:IsNil()) ) then return false end\n\
					g_world:AddDrawActorFilter(kTargetGUID);\n\
				end\n\
			end\n\
			i = i + 1;\n\
		end\n\
		\n\
		if IsSingleMode() then\n\
	    \n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
			Skill_Club_Mania_OnTargetListModified(actor,action,false)\n\
	        \n\
			return true;\n\
		else\n\
\n\
			--  1 ,    \n\
			SkillHelpFunc_DoDividedDamage(actor, action, iHitCount)\n\
			if iHitCount == iTotalHit-1 then\n\
				action:SetParam(1, \"end\")\n\
			end\n\
		end\n\
		SkillHelpFunc_IncHitCount(action, 1)\n\
		\n\
	elseif 1 == iTimerID then --   \n\
		local iSkillRange = action:GetParamInt(21);\n\
		local iIndex = action:GetParamInt(20);\n\
\n\
		local kPos = actor:GetPos();	\n\
\n\
		kPos:SetX(kPos:GetX() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetY(kPos:GetY() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetZ(kPos:GetZ() + 200);\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			--  .\n\
			ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				return true;\n\
			end			\n\
		end\n\
\n\
		actor:AttachParticleToPointS(1000 + iIndex, ptcl, \"ef_skill_dragon_rush_lightning_01\", math.random(-1.0, 1));\n\
\n\
		action:SetParamInt(20, iIndex + 1);\n\
	end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function Skill_Club_Mania_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_Club_Mania_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	SkillHelpFunc_SetNoneCastingState(action)			--  	\n\
end\n\
\n\
function Skill_Club_Mania_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Skill_Club_Mania_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	SkillHelpFunc_PlayFireSound(actor, action)	--  		\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	SkillHelpFunc_ChangeWeapon(actor, action)	--   	\n\
	SkillHelpFunc_ExpressFireEffect(actor, action)	--   \n\
    SkillHelpFunc_AttachWeaponTrail(actor, action)	--   \n\
	SkillHelpFunc_TransformShape(actor, action)		--   \n\
	\n\
	actor:SeeFront(true);\n\
	actor:AttachParticle(7217 ,\"char_root\", \"ef_skill_Club_Mania_03_char_root\")\n\
\n\
	action:SetParamInt(31,0); -- hit_timer  Check\n\
	action:SetParamInt(20,0);\n\
\n\
	local iInstanceID = GetStatusEffectMan():AddStatusEffectToActor(actor:GetPilotGuid(),\"se_ClubMania\",0,1);\n\
	actor:SetParam(200, tostring(iInstanceID));\n\
\n\
end\n\
\n\
function Skill_Club_Mania_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Skill_Club_Mania_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\",false, 912);\n\
	SkillHelpFunc_InitHitCount(action)					-- HitCount 		\n\
	ODS(\"Club Mania Enter 1\\n\",false, 912);\n\
	SkillHelpFunc_ExpressCastingEffect(actor, action)	--     	\n\
	ODS(\"Club Mania Enter 2\\n\",false, 912);\n\
	SkillHelpFunc_PlayCastingSound(actor, action) 		--  \n\
	ODS(\"Club Mania Enter 3\\n\",false, 912);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_Club_Mania_OnCastingCompleted(actor,action);\n\
	ODS(\"Club Mania Enter 4\\n\");\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.4,true,true);\n\
		g_world:AddDrawActorFilter(actor:GetPilotGuid());\n\
	end\n\
\n\
	action:CreateActionTargetList(actor,true);\n\
	local i = 0;\n\
	local kTargetList = action:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			if actor:IsMyActor() then\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				g_world:AddDrawActorFilter(kTargetGUID);\n\
			end\n\
		end\n\
		i = i + 1;\n\
	end\n\
	action:ClearTargetList();	\n\
	actor:SetCanHit(true);\n\
	\n\
	local kMulptiple = action:GetScriptParam(\"MULTIPLE_ATTACK\")\n\
	if kMulptiple~=\"\" then\n\
		action:SetParamInt(100, 1)\n\
		action:SetParamInt(10,1) -- Timer  CreateTargetList 1    \n\
	end	\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Club_Mania_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		if(false == actor:PlayNext()) then	--   \n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				nextActionName = action:GetParam(1);\n\
\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				\n\
				action:SetNextActionName(nextActionName)\n\
				return false;\n\
			else\n\
			\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Club_Mania_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"RestoreItemModel Skill_Club_Mania_ReallyLeave\\n\", false, 912);\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\");			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true);\n\
	end\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        end\n\
    end\n\
	return true;\n\
end\n\
\n\
function Skill_Club_Mania_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	if curAction:GetNextActionName() ~= actionID then\n\
		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		if actor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Skill_Club_Mania_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if(0 == action:GetParamInt(100) ) then\n\
	\n\
		if bIsBefore == false then\n\
			--  hit  \n\
			--    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action);\n\
		end\n\
	end\n\
end\n\
\n\
function Skill_Club_Mania_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
--		if actor:IsUnderMyControl() then\n\
			local iTimerTime = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TIME\");\n\
") + std::string("			if 0 == iTimerTime then\n\
				if 0 == kAction:GetParamInt(31) then -- hit          .\n\
					kAction:CreateActionTargetList(actor);\n\
					ODS(\"Skill_Club_Mania_OnEvent : 1\\n\", false, 912)\n\
					local i = 0;\n\
					local kTargetList = kAction:GetTargetList();\n\
					local iTargetCount = kTargetList:size();\n\
					while i<iTargetCount do\n\
						local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
						local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
						local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
						if kTargetPilot:IsNil() == false then\n\
							if actor:IsMyActor() then\n\
								if( CheckNil(g_world == nil) ) then return false end\n\
								if( CheckNil(g_world:IsNil()) ) then return false end\n\
								g_world:AddDrawActorFilter(kTargetGUID);\n\
							end\n\
						end\n\
						i = i + 1;\n\
					end\n\
\n\
					if IsSingleMode() then\n\
			        \n\
						SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
						Skill_Club_Mania_OnTargetListModified(actor,kAction,false)\n\
			            \n\
						return;\n\
					else\n\
						kAction:BroadCastTargetListModify(actor:GetPilot());\n\
					end\n\
\n\
					kAction:SetParamInt(31,1);\n\
					Skill_Club_Mania_OnTargetListModified(actor,kAction,false)\n\
				end\n\
			else --   \n\
				local iTimerick = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TICK\");\n\
				kAction:StartTimer(iTimerTime, iTimerick,0);\n\
				QuakeCamera(3.8, 1, 1, 1, 1);\n\
			end\n\
--		end	\n\
	elseif textKey == \"summon\" then\n\
		if \"\" ~= kAction:GetScriptParam(\"SUMMON_CLASSNO\") then\n\
			local iSummonClassNo = tonumber(kAction:GetScriptParam(\"SUMMON_CLASSNO\"));\n\
			local kSummonReserveAction = kAction:GetScriptParam(\"SUMMON_RESERVE_ACTION\");\n\
			Skill_Club_Mania_Create_Summon(actor,iSummonClassNo,kSummonReserveAction);\n\
			QuakeCamera(2, 3, 1, 1, 1);\n\
		end\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Skill_Club_Mania_Create_Summon(actor, iClassNo, kReserveAction)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kTargetPos = actor:GetPos();\n\
	\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, iClassNo, 0)\n\
	if pilot:IsNil() == false then\n\
		pilot:SetUnit(guid,UT_ENTITY,1,1,0);\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:AddActor(guid, pilot:GetActor(), kTargetPos, 9);\n\
	\n\
	    if actor:IsMyActor() then\n\
	        pilot:GetActor():SetUnderMyControl(true);\n\
	    end\n\
\n\
		pilot:GetUnit():SetCaller(actor:GetPilotGuid());\n\
		pilot:GetActor():FreeMove(true)\n\
		pilot:GetActor():ReserveTransitAction(kReserveAction);\n\
		--ODS(\" : \"..kReserveAction.. \"\\n\",false, 912)\n\
		pilot:GetActor():ClearActionState();\n\
		pilot:GetActor():FindPathNormal();\n\
		pilot:GetActor():LockBidirection(false);\n\
		pilot:GetActor():ToLeft(actor:IsToLeft());\n\
		pilot:GetActor():SeeFront(true,true);\n\
		pilot:GetActor():SetTargetAlpha(0,1,0.2)\n\
		\n\
		if actor:IsMyActor() then\n\
	        g_world:AddDrawActorFilter(guid);\n\
	    end		\n\
	end	\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [CHECK_CAN_PREV_ACTION_ID] :      .\n\
\n\
function Skill_Club_Mania_Finish_OnCastingCompleted(actor,action)\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnCheckCanEnter(actor,action)\n\
\n\
	ODS(\"Skill_Club_Mania_Finish_OnCheckCanEnter \\n\",false, 1509)\n\
	local	kCurrentAction = actor:GetAction();\n\
\n\
	local   kPrevActionID = action:GetScriptParam(\"CHECK_CAN_PREV_ACTION_ID\");\n\
	if(false == kCurrentAction:IsNil() ) then\n\
		return (kCurrentAction:GetID() == kPrevActionID);\n\
	end\n\
	\n\
	return true;	\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	return Skill_Club_Mania_OnTimer(actor,fAccumTime,action,iTimerID);\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	if true == animDone then\n\
		if(false == actor:PlayNext()) then	--   \n\
			action:SetParam(1, \"end\")\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local   kCurAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
		g_world:ClearDrawActorFilter()\n\
	end	\n\
\n\
	actor:RestoreLockBidirection();\n\
\n\
	local	iInstanceID = tonumber(actor:GetParam(200));\n\
	GetStatusEffectMan():RemoveStatusEffectFromActor2(actor:GetPilotGuid(),iInstanceID);\n\
\n\
	actor:SetCanHit(true);\n\
\n\
	return true;\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	if(nil == string.find(actionID, \"a_run\")) then\n\
		if curAction:GetNextActionName() ~= actionID then\n\
			ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
			return false;\n\
		end\n\
	end\n\
	\n\
		\n\
	if actor:IsMyActor() == false then\n\
		ODS(\"1\\n\", false, 912);\n\
		return true;\n\
	end\n\
	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		ODS(\"2\\n\", false, 912);\n\
		return true;\n\
	end\n\
		\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsMyActor() then\n\
			kAction:CreateActionTargetList(actor);\n\
\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			local i = 0;\n\
			local kTargetList = kAction:GetTargetList();\n\
			local iTargetCount = kTargetList:size();\n\
			while i<iTargetCount do\n\
				local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
				local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
				local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
				if kTargetPilot:IsNil() == false then\n\
					if actor:IsMyActor() then\n\
						g_world:AddDrawActorFilter(kTargetGUID);\n\
					end\n\
				end\n\
				i = i + 1;\n\
			end\n\
	\n\
			if IsSingleMode() then\n\
				SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
				Skill_Club_Mania_Finish_OnTargetListModified(actor,kAction,false)\n\
\n\
				return;\n\
			else\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			end\n\
		end	\n\
	\n\
        SkillHelpFunc_DefaultHitOneTime(actor,kAction)\n\
		\n\
		--    		\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Club_Mania_Finish_OnTargetListModified(actor,action,bIsBefore)\n\
	return Skill_Club_Mania_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [LOOP_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_FIRE_EFFECT_AT_LEAVE] : _OnLeave   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
-- Melee\n\
function AwakeCharge_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	if(1 == actor:GetAbil(AT_AWAKE_STATE)) then	\n\
		return false\n\
	end\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
	\n\
	return true	\n\
end\n\
\n\
function AwakeCharge_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	ODS(\"AwakeCharge_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\")\n\
\n\
	action:SetParam(3,\"0\")\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize)\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize)\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize)\n\
        end\n\
		action:SetParam(3,\"1\")\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID)\n\
	end	\n\
	\n\
	action:SetParamInt(2,0)\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
\n\
	AwakeCharge_OnCastingCompleted(actor,action)\n\
	\n\
	if actor:IsMyActor() and actionID == \"a_archer_melee\" then\n\
	    GetComboAdvisor():OnNewActionEnter(action:GetID())\n\
	end\n\
		\n\
	return true\n\
end\n\
\n\
function AwakeCharge_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID()\n\
--	local iComboCount = actor:GetComboCount()\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false\n\
	end\n\
	\n\
	if(1 == actor:GetAbil(AT_AWAKE_STATE)) then	\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end	\n\
	\n\
	if true == animDone or \"DoEndAni\" == action:GetParam(1)then\n\
--		actor:PlayCurrentSlot()\n\
			\n\
		if(\"DoEndAni\" == action:GetParam(1)) then\n\
			action:SetParam(1, \"EndAniProcessing\")\n\
		end\n\
		\n\
		if(action:GetSlotCount() == action:GetCurrentSlot()) then\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
		\n\
		local iNextSlot = action:GetCurrentSlot()+1\n\
		if(1 == iNextSlot) then --0      \n\
			local	kSoundID = action:GetScriptParam(\"LOOP_SOUND_ID\")\n\
			if kSoundID~=\"\" then\n\
				actor:AttachSound(2783,kSoundID)\n\
			end	\n\
		end\n\
		action:SetSlot(iNextSlot)\n\
		actor:PlayCurrentSlot()\n\
		\n\
		local curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1)\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
\n\
function AwakeCharge_OnLeave(actor, action)\n\
	ODS(\"AwakeCharge_OnLeave\\n\", false, 912)\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local curAction = actor:GetAction()\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	ODS(\"actionID:\"..actionID..\"\\n\", false, 912)\n\
	\n\
	if( actor:IsMyActor() == false \n\
		or actionID == \"a_battle_idle\"\n\
		or actionID == \"a_run\"\n\
		or action:GetActionType()==\"EFFECT\"\n\
		or curParam == \"end\"\n\
	)\n\
	then \n\
		curAction:SetParam(1, \"end\")		\n\
		if curAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_LEAVE\") == \"TRUE\" then\n\
			actor:DetachFrom(7212,true)	\n\
			actor:DetachFrom(7213,true)\n\
		end		\n\
		return true\n\
	end\n\
\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\")\n\
		end\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function AwakeCharge_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
    local   kCurAction = actor:GetAction()\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	\n\
	--local iLevel = kCurAction:GetSkillLevel()-1\n\
	--ODS(\"iLevel:\"..iLevel..\"\\n\", false, 912)\n\
	local kEffectID = kCurAction:GetEffectNo()\n\
	--ODS(\"kEffectID:\"..kEffectID..\"\\n\", false, 912)\n\
	if kEffectID ~= 0 and actor:IsMyActor() then --  \n\
		local	kPacket = NewPacket(12130)\n\
		kPacket:PushGuid(actor:GetPilotGuid())\n\
		kPacket:PushInt(kEffectID)\n\
		Net_Send(kPacket)\n\
		DeletePacket(kPacket)\n\
	end	\n\
		\n\
	ODS(\"RestoreItemModel AwakeCharge_ReallyLeave\\n\")\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false)\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail()\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false\n\
		local DefaultDetaChID2 = false\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\")\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\")\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"))\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale)\n\
	end\n\
\n\
	if \"1\" == kCurAction:GetParam(3) then\n\
		--   \n\
		actor:DetachFrom(7215,true)\n\
		if( false == actor:PlayNext()) then \n\
			kCurAction:SetNextActionName(\"a_battle_idle\")			\n\
		end\n\
		kCurAction:ChangeToNextActionOnNextUpdate(true,true)\n\
	end\n\
	\n\
	actor:DetachFrom(7212,true)	\n\
	actor:DetachFrom(7213,true)\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID)\n\
        \n\
        end\n\
    \n\
    end	\n\
	return true\n\
end\n\
\n\
\n\
function AwakeCharge_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	AwakeCharge_Fire(actor,action)\n\
	action:SetParam(3,\"0\")\n\
end\n\
\n\
function AwakeCharge_Fire(actor,action)\n\
	ODS(\"RestoreItemModel AwakeCharge_Fire\\n\")\n\
	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\")		\n\
	\n\
	if bUseTLM == false then\n\
		action:CreateActionTargetList(actor)\n\
		if action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\") ~= \"\" then\n\
			local iTargetCount = action:GetTargetCount()\n\
			if iTargetCount == tonumber(action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_COUNT_NUM\")) then\n\
				AddWarnDataStr(GetTextW(tonumber(action:GetScriptParam(\"SHOW_TEXT_TARGETLIST_TEXTNO\"))),2)		\n\
			end\n\
		end\n\
	end\n\
\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\")\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID)\n\
	end	\n\
		\n\
	--	  \n\
	if action:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:ChangeItemModel(ITEM_WEAPON, action:GetScriptParam(\"WEAPON_XML\"))\n\
		ODS(\"ChangeItemModel \"..action:GetScriptParam(\"WEAPON_XML\")..\"\\n\")\n\
	end\n\
	\n\
	if action:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, true)\n\
	end\n\
\n\
    local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\")\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\")\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\")\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\")\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID)            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID)\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID)			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end\n\
    \n\
    end	\n\
\n\
    kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2\")\n\
    kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE2\")\n\
	\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir()\n\
            local   fDistance = 30\n\
            kDir:Multiply(fDistance)\n\
            kDir:Add(actor:GetPos())\n\
            kDir:SetZ(kDir:GetZ()-28)\n\
            \n\
            actor:AttachParticleToPoint(7213,kDir,kFireEffectID)\n\
            \n\
        else\n\
            actor:AttachParticle(7213,kFireEffectTargetNodeID,kFireEffectID)\n\
        end\n\
    \n\
    end	\n\
		\n\
	if action:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:StartWeaponTrail()\n\
	end\n\
	\n\
	--   \n\
    local kTransformXMLID = action:GetScriptParam(\"TRANSFORM_XML\")\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(action:GetScriptParam(\"TRANSFORM_ID\"))\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan()\n\
            kMan:AddStatusEffectToActor(actor:GetPilotGuid(),kTransformXMLID,iTransformEffectID,0)        \n\
        end\n\
") + std::string("    \n\
    end\n\
end\n\
\n\
\n\
function AwakeCharge_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	local kAction = actor:GetAction()\n\
		\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	return	true\n\
end") );
	m_kContLuaText.push_back(std::string("-- [ATTACK_TIME] :    \n\
function FriendShipBuff_OnCheckCanEnter(actor,action)\n\
	ODS(\"FriendShipBuff_OnCheckCanEnter\\n\", false, 912)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	return true	\n\
end\n\
\n\
function FriendShipBuff_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	action:SetDoNotBroadCast(true)\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	FriendShipBuff_OnCastingCompleted(actor, action)\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"CASTING_EFFECT_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
    \n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\" then\n\
    \n\
		local iSize = 1.0\n\
		if \"TRUE\" == action:GetScriptParam(\"CASTING_EFFECT_SIZE_TO_SKILLRANGE\") then\n\
			iSize = iSize * (action:GetSkillRange(0,actor) / 100)\n\
			iSize = iSize * 2 \n\
		end\n\
		\n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPointS(7215,kDir,kFireEffectID, iSize);\n\
            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticleS(7215,kFireEffectTargetNodeID,kFireEffectID,iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"EF_Mon_Agnis_whirlwind_01_char_root\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_Aram_skill_02_03_char_root\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_Enchant_clw_02_l\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_Enchant_clw_03_l\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_legend_R_01\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_Magma_Call_01_char_root\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"EF_Mon_Agnis_whirlwind_01_char_root\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"EF_Mon_Penryl_attk_03_char_root\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_Myroom_Buf_01_B\",iSize);\n\
			--actor:AttachParticleS(7215,kFireEffectTargetNodeID,\"ef_rest_01_char_root\",iSize);	\n\
\n\
		else\n\
			actor:AttachParticleToPointS(7215,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID,iSize);\n\
        end\n\
		action:SetParam(3,\"1\");\n\
    end	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
--[[	\n\
	local kAxis1 = Point3(1,0,0)	\n\
	local kQuat = Quaternion(90, kAxis1)\n\
	local kActorRot = actor:GetRotateQuaternion()\n\
	Quat = kActorRot:Multiply(kQuat)\n\
]]\n\
	local   kMarkEffectID = action:GetScriptParam(\"MARK_EFFECT_ID\");    \n\
	if(kMarkEffectID ~= \"\") then\n\
		local kPos = actor:GetPos()\n\
		--kPos:SetZ(kPos:GetZ()+ 70)\n\
		kPos:SetZ(kPos:GetZ()-20)\n\
		actor:AttachParticleToPointWithRotate(128, kPos, kMarkEffectID, Quaternion(0, Point3(0,0,1)), 5)\n\
	end\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"ENTER_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID);\n\
	end	\n\
	\n\
	return true\n\
end\n\
\n\
function FriendShipBuff_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
end\n\
\n\
function FriendShipBuff_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local iSlotNum = action:GetCurrentSlot();\n\
\n\
	local animDone = actor:IsAnimationDone()\n\
	if(animDone == true) then\n\
		ODS(\"animDone\\n\", false, 912)\n\
		--actor:PlayCurrentSlot();		\n\
		action:SetParam(1, \"end\")\n\
		return false\n\
	end\n\
	--actor:PlayCurrentSlot()\n\
	--ODS(\"FriendShipBuff_OnUpdate\\n\", false, 912)	\n\
	\n\
	\n\
	\n\
	return true\n\
end\n\
\n\
function FriendShipBuff_Fire(actor, action)\n\
	\n\
	if actor:IsMyActor() == true then		\n\
		action:CreateActionTargetList(actor);	    \n\
		if IsSingleMode() or action:GetTargetCount() == 0 then	    \n\
			FriendShipBuff_OnTargetListModified(actor,action,false);	    \n\
		else	    \n\
			action:BroadCastTargetListModify(actor:GetPilot(), true);\n\
			action:ClearTargetList();\n\
		end\n\
	end\n\
\n\
	--actor:AttachParticleWithRotate(10000, \"p_ef_heart\", \"ef_SiegeDragon_skill_03_01_char_root\", 2, false)\n\
	--actor:AttachParticleWithRotate(10000, \"char_root\", \"ef_Resurrection_01_01_char_root\", 2, false)	\n\
	--	actor:AttachParticleWithRotate(10000, \"char_root\", \"ef_Resurrection_01_02_char_root\", 1, false)	\n\
	--actor:AttachParticleWithRotate(10000, \"char_root\", \"ef_Resurrection_02_01_char_root\", 1.5, false)	\n\
	--actor:AttachParticleWithRotate(10000, \"char_root\", \"ef_Resurrection_02_02_char_root\", 1.5, false)	\n\
	--actor:AttachParticleWithRotate(10000, \"p_ef_heart\", \"ef_Resurrection_03_01_p_ef_heart\", 1, false)\n\
	--actor:AttachParticleWithRotate(10000, \"char_root\", \"ef_Resurrection_03_02_char_root\", 2, false)\n\
	--actor:AttachParticleWithRotate(10000, \"char_root\", \"ef_Master_machine_skill_02_01_p_ef_foot_04\", 4, false)	\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2783,kSoundID);\n\
	end	\n\
	\n\
	local   kFireEffectID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_ID\");\n\
    local   kFireEffectTargetNodeID = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE\");\n\
	local   kFireEffectTargetNodeIDToPos = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS\");\n\
	local   kFireEffectTargetNodeIDToPosWithRotate = action:GetScriptParam(\"FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE\");\n\
\n\
    if kFireEffectID ~= \"\" and kFireEffectTargetNodeID ~= \"\" or kFireEffectTargetNodeIDToPos ~= \"\"  or kFireEffectTargetNodeIDToPosWithRotate ~= \"\" then\n\
    \n\
        if kFireEffectTargetNodeID == \"__FRONT_ACTOR\" then\n\
            \n\
            local   kDir = actor:GetLookingDir();\n\
            local   fDistance = 30;\n\
            kDir:Multiply(fDistance);\n\
            kDir:Add(actor:GetPos());\n\
            kDir:SetZ(kDir:GetZ()-28);\n\
            \n\
            actor:AttachParticleToPoint(7212,kDir,kFireEffectID);            \n\
        elseif kFireEffectTargetNodeID ~= \"\" then\n\
            actor:AttachParticle(7212,kFireEffectTargetNodeID,kFireEffectID);\n\
		elseif kFireEffectTargetNodeIDToPos ~= \"\" then\n\
			actor:AttachParticleToPoint(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPos),kFireEffectID);			\n\
		else\n\
		    actor:AttachParticleToPointWithRotate(7212,actor:GetNodeWorldPos(kFireEffectTargetNodeIDToPosWithRotate), kFireEffectID, actor:GetRotateQuaternion())\n\
        end    \n\
    end\n\
	\n\
	-- \n\
	local kPos = actor:GetPos()\n\
	kPos:SetZ(kPos:GetZ()+40)\n\
	kPos:SetX(kPos:GetX()+20)						\n\
	actor:AttachParticleToPointS(7220, kPos ,\"ef_Enchant_clw_02_l\", 5);\n\
			\n\
end\n\
\n\
function FriendShipBuff_OnCleanUp(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	  local   kCurAction = actor:GetAction();\n\
	\n\
	ODS(\"RestoreItemModel Act_Melee_Default_ReallyLeave\\n\");\n\
	--	 \n\
	if kCurAction:GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"HIDE_WEAPON\") == \"TRUE\" then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false);\n\
	end\n\
\n\
	if kCurAction:GetScriptParam(\"NO_WEAPON_TRAIL\") ~= \"TRUE\" then	\n\
	    actor:EndWeaponTrail();\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_FIRE_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
	\n\
		local DefaultDetaChID = false;\n\
		local DefaultDetaChID2 = false;\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
\n\
		if kCurAction:GetScriptParam(\"FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID2 = true;\n\
		end		\n\
\n\
	    actor:DetachFrom(7212,DefaultDetaChID)\n\
	    actor:DetachFrom(7213,DefaultDetaChID2)\n\
		actor:DetachFrom(7214)\n\
	end\n\
	\n\
	if kCurAction:GetScriptParam(\"DETACH_CASTING_EFFECT_AT_FINISH\") == \"TRUE\" then\n\
		local DefaultDetaChID = false;\n\
		if kCurAction:GetScriptParam(\"CASTING_EFFECT_ID_DEFAULT_DETACH\") == \"TRUE\" then\n\
			DefaultDetaChID = true;\n\
		end\n\
		actor:DetachFrom(7215,DefaultDetaChID)\n\
	end\n\
		\n\
	local   kCleanUpEffectID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_ID\");\n\
    local   kCleanUpEffectTargetNodeID = kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_TARGET_NODE\");\n\
	local	fCleanUpScale = tonumber(kCurAction:GetScriptParam(\"CLEANUP_CASTER_EFFECT_SCALE\"));\n\
\n\
	if fCleanUpScale == 0 or fCleanUpScale == nil then\n\
		fCleanUpScale = 1.0;\n\
	end\n\
    \n\
    if kCleanUpEffectID ~= \"\" and kCleanUpEffectTargetNodeID ~= \"\" then\n\
		 actor:AttachParticleS(7216,kCleanUpEffectTargetNodeID,kCleanUpEffectID, fCleanUpScale);\n\
	end\n\
	\n\
	local   kMarkEffectID = kCurAction:GetScriptParam(\"MARK_EFFECT_ID\");    \n\
	if(kMarkEffectID ~= \"\") then\n\
		actor:DetachFrom(128,true)\n\
	end\n\
	actor:DetachFrom(7220)\n\
	\n\
	--  (  curAction    !!!)\n\
    local kTransformXMLID = kCurAction:GetScriptParam(\"TRANSFORM_XML\");\n\
    if kTransformXMLID ~= \"\" then\n\
    \n\
        local   iTransformEffectID = tonumber(kCurAction:GetScriptParam(\"TRANSFORM_ID\"));\n\
        if iTransformEffectID ~= nil then\n\
        \n\
            local   kMan = GetStatusEffectMan();\n\
            kMan:RemoveStatusEffectFromActor(actor:GetPilotGuid(),iTransformEffectID);\n\
        \n\
        end    \n\
    end\n\
end\n\
\n\
function FriendShipBuff_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	ODS(\"actionID:\"..actionID..\"\\n\",false, 912)\n\
	 \n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	 if \"a_hi\" ~= actionID then \n\
		return true		\n\
	end	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function FriendShipBuff_OnCastingCompleted(actor, action)	\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
end\n\
\n\
function FriendShipBuff_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
		\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then	\n\
		FriendShipBuff_Fire(actor, action)\n\
				\n\
	end\n\
	\n\
	return	true;\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
\n\
-- Melee\n\
function SharpShooting_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function SharpShooting_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	if 0 == iTimerID then\n\
		local	iHitCount = SkillHelpFunc_GetHitCount(action)\n\
		local	iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
		if iHitCount == iTotalHit then\n\
			return true\n\
		end\n\
\n\
		local iCreateLimitCnt = action:GetParamInt(10)\n\
		if(0 < iCreateLimitCnt) then\n\
			ODS(\"iCreateLimitCnt \\n\", false, 912)\n\
			action:CreateActionTargetList(actor);		\n\
			iCreateLimitCnt  = iCreateLimitCnt-1\n\
			action:SetParamInt(10, iCreateLimitCnt)			\n\
			action:BroadCastTargetListModify(actor:GetPilot());\n\
			action:GetTargetList():SetActionEffectApplied(true)		\n\
		end\n\
\n\
		--  1 ,    \n\
		SkillHelpFunc_DoDividedDamage(actor, action, iHitCount)\n\
		if iHitCount == iTotalHit-1 then\n\
			action:SetParam(1, \"end\")\n\
		end	\n\
		SkillHelpFunc_IncHitCount(action, 1)\n\
	end\n\
\n\
	return true;\n\
\n\
end\n\
\n\
function SharpShooting_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	SkillHelpFunc_SetNoneCastingState(action)			--  	\n\
	action:SetParamInt(102, 0)\n\
end\n\
\n\
function SharpShooting_Fire(actor,action)\n\
	ODS(\"RestoreItemModel SharpShooting_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	SkillHelpFunc_PlayFireSound(actor, action)	--  		\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	SkillHelpFunc_ChangeWeapon(actor, action)	--   	\n\
	SkillHelpFunc_ExpressFireEffect(actor, action)	--   \n\
    SkillHelpFunc_AttachWeaponTrail(actor, action)	--   \n\
	SkillHelpFunc_TransformShape(actor, action)		--   \n\
\n\
	SkillHelpFunc_InitHitCount(action) -- Hit Count\n\
	--action:SetParamInt(30, SkillHelpFunc_GetTotalHitCount(action))\n\
	action:SetParamInt(31,0); -- hit_timer  Check\n\
\n\
end\n\
\n\
function SharpShooting_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	--ODS(\"SharpShooting_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	ODS(\"action:GetSlotCount() :\"..action:GetSlotCount()..\"\\n\", false, 912);\n\
	\n\
	SkillHelpFunc_InitHitCount(action)					-- HitCount 	\n\
	SkillHelpFunc_ExpressCastingEffect(actor, action)	--     	\n\
	SkillHelpFunc_PlayCastingSound(actor, action) 		--  	\n\
		\n\
	if action:GetActionParam() == AP_CASTING then		--	  .\n\
		return	true;\n\
	end\n\
	SharpShooting_OnCastingCompleted(actor,action);\n\
	SkillHelpFunc_InitMaxFireCnt(action)\n\
\n\
	local kMulptiple = action:GetScriptParam(\"MULTIPLE_ATTACK\")\n\
	if kMulptiple~=\"\" then\n\
		action:SetParamInt(100, 1)\n\
		action:SetParamInt(10,1) -- Timer  CreateTargetList 1    \n\
	end\n\
	\n\
	SkillHelpFunc_AttachParticleToNode(10001, \"START_EFFECT_ID\", \"START_EFFECT_TARGET_NODEI\", 1, actor, action)\n\
	return true\n\
end\n\
\n\
function SharpShooting_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot()\n\
	local iMaxActionSlot = action:GetSlotCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	local iMaxAttackCnt = SkillHelpFunc_GetMaxFireCnt(action)\n\
	local iCurAttackCnt = SkillHelpFunc_GetCurFireCnt(action)		\n\
\n\
	if animDone == true then\n\
		--ODS(\"iCurAttackCnt:\"..iCurAttackCnt..\"\\n\", false, 912)\n\
		if(action:GetParamInt(102) == 0 ) then \n\
			action:SetParamInt(102, 1)					--   \n\
			action:SetSlot(action:GetCurrentSlot()+1)\n\
		end\n\
\n\
		if(action:GetCurrentSlot() ~= action:GetSlotCount()) then\n\
			actor:PlayCurrentSlot();\n\
		end	\n\
		if iCurAttackCnt >= iMaxAttackCnt then		\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		end		\n\
		SkillHelpFunc_IncCurFireCnt(action, 1) \n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function SharpShooting_OnCleanUp(actor, kNextAction)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	if(\"end\" ~= kCurAction:GetParam(1)) and true == actor:IsUnderMyControl() then\n\
		if(nil ~= kNextAction )  then\n\
			if( false == kNextAction:IsNil() ) then\n\
				if( \"a_dmg\" ~= kNextAction:GetID() ) then\n\
					return\n\
				end\n\
			end\n\
		end		\n\
	end\n\
\n\
	\n\
	ODS(\"RestoreItemModel SharpShooting_ReallyLeave\\n\");\n\
	SkillHelpFunc_RestoreWeapon(actor, kCurAction)					--   	\n\
	SkillHelpFunc_ShowWeapon(actor, kCurAction)						--   	\n\
	SkillHelpFunc_DetachWeaponTrail(actor, kCurAction)				--    	\n\
    SkillHelpFunc_RestoreShape(actor, kCurAction)					--  	\n\
	SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, kCurAction)	--      	\n\
	SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, kCurAction)--     	\n\
	SkillHelpFunc_ExpressCleanUpEffect(actor, kCurAction)			-- CleanUp( )    	\n\
	SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
	SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
\n\
	actor:DetachFrom(10001, true)\n\
\n\
	\n\
	return true;\n\
end\n\
\n\
function SharpShooting_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
		\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" \n\
		or \"a_run\" == actionID 	or \"a_jump\" == actionID \n\
	then\n\
		curAction:SetParam(1,\"end\");\n\
		return true;\n\
	end		\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	--  Update     \n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function SharpShooting_OnTargetListModified(actor,action,bIsBefore)\n\
	ODS(\"SharpShooting_OnTargetListModified\\n\", false, 912)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if(0 == action:GetParamInt(100) ) then		\n\
		if bIsBefore == false then\n\
			--  hit  \n\
			--    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action);\n\
		end		\n\
	end\n\
	\n\
end\n\
\n\
function SharpShooting_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsUnderMyControl() then\n\
			SharpShooting_Fire(actor,kAction);\n\
			\n\
			local iTimerTime = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TIME\");\n\
			if 0 == iTimerTime then\n\
				kAction:CreateActionTargetList(actor);\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
			else --   \n\
				local iTimerick = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TICK\");\n\
				kAction:StartTimer(iTimerTime, iTimerick,0);\n\
			end			\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);		\n\
		local	kArrow = Projectile_Default_LoadToWeapon(actor,kAction);		\n\
		if kArrow:IsNil() == false then		\n\
			local	kMovingDir = actor:GetLookingDir();	--    \n\
			-- local kPos = actor:GetLookingDir();\n\
			-- kPos:Multiply(-150)\n\
			-- kPos:Add(actor:GetPos())			\n\
			-- kArrow:LoadToPosition(kPos)			\n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 				\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);			\n\
			kArrow:Fire();		\n\
		end\n\
		\n\
		------------------------------------------------------------------------------------------------------------------------------------------------------\n\
	end\n\
			\n\
	return	true;\n\
end\n\
\n\
function SharpShooting_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  SharpShooting_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    SharpShooting_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
\n\
	local kParam = FindTargetParam();	\n\
		\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 80\n\
		end	\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
\n\
		iFindTargetType = TAT_SPHERE;\n\
\n\
		if 3 == action:GetAbil(AT_1ST_AREA_TYPE) then\n\
			kDir:Multiply(iAttackRange);\n\
			kPos:Add(kDir);\n\
			kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    		kParam:SetParam_2(0,0,iParam2,0);\n\
		else\n\
			kParam:SetParam_1(actor:GetPos(), actor:GetLookingDir());\n\
    		kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
		end\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
\n\
-- Melee\n\
function Sniping_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Sniping_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	SkillHelpFunc_SetNoneCastingState(action)			--  	\n\
	action:SetParamInt(102, 0)\n\
end\n\
\n\
function Sniping_Fire(actor,action)\n\
	ODS(\"RestoreItemModel Sniping_Fire\\n\");\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	SkillHelpFunc_PlayFireSound(actor, action)	--  		\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	SkillHelpFunc_ChangeWeapon(actor, action)	--   	\n\
	SkillHelpFunc_ExpressFireEffect(actor, action)	--   \n\
    SkillHelpFunc_AttachWeaponTrail(actor, action)	--   \n\
	SkillHelpFunc_TransformShape(actor, action)		--   \n\
\n\
	SkillHelpFunc_InitHitCount(action) -- Hit Count\n\
	--action:SetParamInt(30, SkillHelpFunc_GetTotalHitCount(action))\n\
	action:SetParamInt(31,0); -- hit_timer  Check\n\
\n\
end\n\
\n\
function Sniping_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	--ODS(\"Sniping_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
	ODS(\"action:GetSlotCount() :\"..action:GetSlotCount()..\"\\n\", false, 912);\n\
	\n\
	SkillHelpFunc_InitHitCount(action)					-- HitCount 	\n\
	SkillHelpFunc_ExpressCastingEffect(actor, action)	--     	\n\
	SkillHelpFunc_PlayCastingSound(actor, action) 		--  	\n\
		\n\
	if action:GetActionParam() == AP_CASTING then		--	  .\n\
		return	true;\n\
	end\n\
	Sniping_OnCastingCompleted(actor,action);\n\
	SkillHelpFunc_InitMaxFireCnt(action)\n\
\n\
	local kMulptiple = action:GetScriptParam(\"MULTIPLE_ATTACK\")\n\
	if kMulptiple~=\"\" then\n\
		action:SetParamInt(100, 1)\n\
		action:SetParamInt(10,1) -- Timer  CreateTargetList 1    \n\
	end\n\
	\n\
	SkillHelpFunc_AttachParticleToNode(10001, \"START_EFFECT_ID\", \"START_EFFECT_TARGET_NODEI\", 1, actor, action)\n\
	return true\n\
end\n\
\n\
function Sniping_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot()\n\
	local iMaxActionSlot = action:GetSlotCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	local iMaxAttackCnt = SkillHelpFunc_GetMaxFireCnt(action)\n\
	local iCurAttackCnt = SkillHelpFunc_GetCurFireCnt(action)		\n\
\n\
	if animDone == true then\n\
		if(action:GetParamInt(102) == 0 ) then \n\
			action:SetParamInt(102, 1)			--   \n\
			--action:SetSlot(action:GetCurrentSlot()+1);		actor:PlayCurrentSlot();\n\
			actor:PlayNext()\n\
			action:SetSlot(action:GetCurrentSlot()+1);			\n\
			return true\n\
		end\n\
\n\
		if(action:GetCurrentSlot() ~= action:GetSlotCount()) then\n\
			actor:PlayCurrentSlot();\n\
		end	\n\
		if iCurAttackCnt >= iMaxAttackCnt then		\n\
			action:SetParam(1, \"end\")\n\
			return false;\n\
		end		\n\
		SkillHelpFunc_IncCurFireCnt(action, 1) \n\
	end\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Sniping_OnCleanUp(actor, kNextAction)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(10001, true)\n\
	\n\
    local   kCurAction = actor:GetAction();\n\
	if(\"end\" ~= kCurAction:GetParam(1)) and true == actor:IsUnderMyControl() then\n\
		if(nil ~= kNextAction )  then\n\
			if( false == kNextAction:IsNil() ) then\n\
				if( \"a_dmg\" ~= kNextAction:GetID() ) then\n\
					return\n\
				end\n\
			end\n\
		end		\n\
	end\n\
		\n\
	SkillHelpFunc_RestoreWeapon(actor, kCurAction)					--   	\n\
	SkillHelpFunc_ShowWeapon(actor, kCurAction)						--   	\n\
	SkillHelpFunc_DetachWeaponTrail(actor, kCurAction)				--    	\n\
    SkillHelpFunc_RestoreShape(actor, kCurAction)					--  	\n\
	SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, kCurAction)	--      	\n\
	SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, kCurAction)--     	\n\
	SkillHelpFunc_ExpressCleanUpEffect(actor, kCurAction)			-- CleanUp( )    	\n\
	SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
	SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
\n\
\n\
	\n\
	return true;\n\
end\n\
\n\
function Sniping_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local curAction = actor:GetAction();\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
		\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" \n\
		or \"a_run\" == actionID 	or \"a_jump\" == actionID \n\
	then\n\
		curAction:SetParam(1,\"end\");\n\
		return true;\n\
	end	\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
	--  Update     \n\
		curAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Sniping_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if(0 == action:GetParamInt(100) ) then\n\
		\n\
		if bIsBefore == false then	\n\
			--  hit  \n\
			--    .\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action);\n\
		end\n\
		\n\
	end\n\
	\n\
end\n\
\n\
function Sniping_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsUnderMyControl() then\n\
			Sniping_Fire(actor,kAction);\n\
			\n\
			local iTimerTime = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TIME\");\n\
			if 0 == iTimerTime then\n\
				kAction:CreateActionTargetList(actor);								\n\
				\n\
				local i = 0;\n\
				local kTargetList = kAction:GetTargetList();\n\
				local iTargetCount = kTargetList:size();\n\
				while i<iTargetCount do\n\
					local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
					local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
					local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
					if kTargetPilot:IsNil() == false then						\n\
						local kTargetActor = kTargetPilot:GetActor();\n\
						--kTargetActor:AttachParticle(7215, \"char_root\", \"eff_skill_Sniping_00\");\n\
						--kTargetActor:AttachParticle(7215, \"p_ef_heart\", \"eff_skill_Sniping_00\");\n\
						kTargetActor:AttachParticle(7215, \"p_ef_heart\", \"ef_select_01\");\n\
					end\n\
					i = i + 1;\n\
				end\n\
								\n\
				kAction:BroadCastTargetListModify(actor:GetPilot());\n\
		\n\
			else --   \n\
				local iTimerick = kAction:GetScriptParamAsFloat(\"HIT_TIMER_TICK\");\n\
				kAction:StartTimer(iTimerTime, iTimerick,0);\n\
			end\n\
\n\
		end		\n\
	end\n\
			\n\
	return	true;\n\
end\n\
\n\
function Sniping_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParam(0,\"\");\n\
	\n\
	local  iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then\n\
	    iAttackRange = 100\n\
	end\n\
	\n\
	return  Sniping_FindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
	\n\
end\n\
function    Sniping_FindTargetEx(actor,action,iActionNo,iAttackRange,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kPos = actor:GetPos();\n\
	local	kDir = actor:GetLookingDir();\n\
	local	fBackDistance = 10;\n\
\n\
	local kParam = FindTargetParam();	\n\
		\n\
	local   strFindTargetType = action:GetScriptParam(\"FIND_TARGET_TYPE\");\n\
	if strFindTargetType == \"\" then\n\
	    strFindTargetType = \"RAY\"\n\
	end\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	\n\
	local iFindTargetType = TAT_RAY_DIR;\n\
	\n\
	if strFindTargetType == \"RAY\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
	\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_RAY_DIR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"BAR\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 80\n\
		end	\n\
		kDir:Multiply(-fBackDistance);\n\
		kPos:Add(kDir);\n\
	    iFindTargetType = TAT_BAR;\n\
    	kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	\n\
	elseif strFindTargetType == \"SPHERE\" then\n\
		if 0==iParam2 then\n\
			iParam2 = 30\n\
		end	\n\
\n\
		iFindTargetType = TAT_SPHERE;\n\
\n\
		if 3 == action:GetAbil(AT_1ST_AREA_TYPE) then\n\
			kDir:Multiply(iAttackRange);\n\
			kPos:Add(kDir);\n\
			kParam:SetParam_1(kPos,actor:GetLookingDir());\n\
    		kParam:SetParam_2(0,0,iParam2,0);\n\
		else\n\
			kParam:SetParam_1(actor:GetPos(), actor:GetLookingDir());\n\
    		kParam:SetParam_2(0,iParam2,iAttackRange,0);\n\
		end\n\
	end\n\
	\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
\n\
	local iTargets = action:FindTargetsEx(iActionNo,iFindTargetType,kParam,kTargets,kTargets);\n\
	\n\
	return iTargets;\n\
end") );
	m_kContLuaText.push_back(std::string("function Skill_FrozenShot_Play_OnCastingCompleted(actor, action)\n\
\n\
end\n\
\n\
function Skill_FrozenShot_Play_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(0,g_world:GetAccumTime());\n\
	action:SetParamFloat(1,g_world:GetAccumTime());	\n\
	\n\
	-- Looking Dir\n\
	local kLookDir = actor:GetLookingDir();\n\
	action:SetParamFloat( 4, kLookDir:GetX() );\n\
	action:SetParamFloat( 5, kLookDir:GetY() );\n\
	action:SetParamFloat( 6, kLookDir:GetZ() );\n\
\n\
	action:SetSlot(0);\n\
	actor:PlayCurrentSlot();\n\
\n\
	local iLearnSkillLv = action:GetSkillLevel()\n\
	local fProjectileFireInter = 1\n\
	\n\
	local iProectileNum = 4\n\
	if(1 < iLearnSkillLv) then\n\
		iProectileNum = 6		\n\
	end\n\
	\n\
	if(2 < iLearnSkillLv) then\n\
		fProjectileFireInter = 0.6\n\
	end\n\
	\n\
	action:SetParamInt(20, iLearnSkillLv);				-- Caller    \n\
	action:SetParamFloat(21, fProjectileFireInter);		--    	\n\
	action:SetParamInt(23, iProectileNum);				--  \n\
	\n\
	action:SetDoNotBroadCast(true)\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_FrozenShot_Play_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    local   kParam = FindTargetParam();\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 50\n\
	end	\n\
\n\
	local tat_type = TAT_SPHERE\n\
\n\
	kParam:SetParam_1(actor:GetPos(),actor:GetLookingDir());\n\
	if 0==action:GetAbil(AT_1ST_AREA_TYPE) then\n\
		kParam:SetParam_2(0,0,action:GetSkillRange(0,actor),0);\n\
	else\n\
		kParam:SetParam_2(action:GetSkillRange(0,actor),iParam2,0,0);\n\
		tat_type = TAT_BAR\n\
	end\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	return action:FindTargets(tat_type,kParam,kTargets,kTargets);\n\
end\n\
\n\
function Skill_FrozenShot_Play_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        SkillHelpFunc_DefaultHitOneTime(actor,action, true);\n\
    end\n\
\n\
end\n\
\n\
function Skill_FrozenShot_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
--	local iCurrentSlot = action:GetCurrentSlot();\n\
	\n\
	local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
	local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
	if fMoveSpeed == 0 then\n\
	    fMoveSpeed = 50\n\
    end\n\
	\n\
	kMoveDir:Multiply(fMoveSpeed);	\n\
	actor:SetMovingDelta(kMoveDir);\n\
\n\
\n\
	local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	if fLifeTime == 0 then\n\
	    fLifeTime = 2.0;\n\
    end	\n\
\n\
    local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
    if fTotalElapsedTime > fLifeTime then\n\
        return  false\n\
    end	\n\
\n\
	local iLearnSkillLv = action:GetParamInt(20);				-- Caller    \n\
	if( 0 < iLearnSkillLv) then\n\
		local fElapsedTime = accumTime - action:GetParamFloat(2)\n\
		local fProjectileFireInter = action:GetParamFloat(21);		--    \n\
		ODS(\"fProjectileFireInter:\"..fProjectileFireInter..\"\\n\", false, 912)\n\
		if fProjectileFireInter < fElapsedTime then \n\
			action:SetParamFloat(2, accumTime)		\n\
			SkillHelpFunc_PlaySound(actor, action, \"FIRE_SOUND_ID\")\n\
			local iProjectileRange = action:GetSkillRange(0,actor);			--  \n\
			local iProectileNum = action:GetParamInt(23);				--  \n\
			local	kProjectileMan = GetProjectileMan();\n\
			local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
			local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
\n\
		--  \n\
			local	kRotateAxis = Point3(0,0,1);\n\
			local fRotateAngle = 60.0*(DEGTORAD)\n\
			local	i = 0;\n\
			\n\
			while(i < iProectileNum) do \n\
	\n\
				local	kArrow = kProjectileMan:CreateNewProjectile(kProjectileID, action, actor:GetPilotGuid());\n\
				kArrow:LoadToHelper(actor, kTargetNodeID);	--	\n\
					\n\
				if kArrow:IsNil() == false then\n\
					action:BroadCastTargetListModify(actor:GetPilot(),true);\n\
					\n\
					local	kMovingDir = Point3(0,0,0)\n\
					kMovingDir:SetX(action:GetParamFloat(4));\n\
					kMovingDir:SetY(action:GetParamFloat(5));\n\
					kMovingDir:SetZ(action:GetParamFloat(6));\n\
					local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
					kMovingDir:Multiply(iProjectileRange);\n\
					kMovingDir:Rotate(kRotateAxis,fRotateAngle*(i)+30);\n\
					kMovingDir:Add(arrow_worldpos);\n\
					\n\
					kArrow:SetTargetLoc(kMovingDir);\n\
					kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
					\n\
					-- \n\
					local iPentrationCount = action:GetAbil(AT_PENETRATION_COUNT);\n\
					kArrow:SetPenetrationCount(iPentrationCount);--   \n\
					if iPentrationCount ~= 0 then\n\
						kArrow:SetMultipleAttack(true);\n\
					end\n\
					kArrow:Fire();\n\
				end\n\
				i=i+1\n\
			end	\n\
\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_FrozenShot_Play_OnCleanUp(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
end\n\
\n\
function Skill_FrozenShot_Play_OnLeave(actor, action)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [NO_WEAPON_TRAIL] :    \n\
\n\
-- Melee\n\
function Cmd_BroadCast_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
function Cmd_BroadCast_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
end\n\
\n\
function Cmd_BroadCast_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"RestoreItemModel Cmd_BroadCast_Fire\\n\");	\n\
end\n\
\n\
function Cmd_BroadCast_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());   \n\
end\n\
\n\
function Cmd_BroadCast_OnTimer(actor,fAccumTime,action,iTimerID)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Cmd_BroadCast_OnTimer fAccumTime:\"..fAccumTime..\"\\n\");\n\
	return	true	\n\
\n\
end\n\
\n\
function Cmd_BroadCast_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
	return	0;\n\
end\n\
\n\
function Cmd_BroadCast_OnOverridePacket(actor, action, packet)\n\
	local iType = action:GetParamInt(100)\n\
	packet:PushInt(iType)\n\
	ODS(\"Cmd_BroadCast_OnOverridePacket\\n\", false, 912)\n\
	--	local kEndPos = action:GetParamAsPoint(500)\n\
	--nil ~= string.find(action:GetID(), \"a_bite_off\")s\n\
end\n\
\n\
\n\
function Cmd_BroadCast_OnEnter(actor, action)\n\
	ODS(\"Cmd_BroadCast_OnEnter\\n\", false, 912)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
--	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
\n\
	Cmd_BroadCast_OnCastingCompleted(actor,action);\n\
	\n\
--    	\n\
--[[\n\
	local iType = 0\n\
	if actor:IsUnderMyControl() then\n\
		iType = action:GetParamInt(100)\n\
	else\n\
		local kPacket = action:GetParamAsPacket()\n\
		if nil==kPacket or kPacket:IsNil() then\n\
			return false\n\
		end\n\
		iType = kPacket:PopInt()		\n\
	end\n\
	\n\
	if(0 < iType) then\n\
		if(1 == iType) then \n\
			action:SetNextActionName(\"a_Multiple Shot\")\n\
		elseif (2== iType) then\n\
			action:SetNextActionName(\"a_Arrow Shower\")\n\
		elseif (3== iType) then\n\
			action:SetNextActionName(\"a_Padong_Succeed_0\")\n\
		end\n\
	else\n\
		action:SetNextActionName(\"a_battle_idle\")\n\
	end\n\
	]]\n\
	\n\
	local kNextActionName = action:GetParam(100000)	\n\
	if(nil ~= kNextActionName and \"\" ~= kNextActionName) then\n\
		--ODS(\"kNextActionName:\"..kNextActionName..\"\\n\", false, 912)\n\
		action:SetNextActionName(kNextActionName)\n\
	end\n\
			\n\
	action:ChangeToNextActionOnNextUpdate(true,true);\n\
	\n\
	action:SetParam(1, \"end\")\n\
	return true\n\
end\n\
\n\
function Cmd_BroadCast_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	\n\
	return false\n\
end\n\
\n\
function Cmd_BroadCast_OnCleanUp(actor)\n\
	return true;\n\
end\n\
\n\
function Cmd_BroadCast_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end	\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Cmd_BroadCast_HitOneTime(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());	\n\
\n\
end\n\
\n\
function Cmd_BroadCast_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
			\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [CASTING_SOUND_ID] :    \n\
-- [FIRE_SOUND_ID] :  \n\
-- [FIRE_SOUND_ID1] : \n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
\n\
function Skill_Multi_Strape_OnCheckCanEnter(kActor, kAction)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	local weapontype = kActor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
	\n\
	--   \n\
	if g_pilotMan:IsLockMyInput() == true then\n\
		return\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Multi_Strape_OnCastingCompleted(kActor, kAction)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	kActor:FreeMove(false)\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2784,kSoundID);\n\
	end\n\
	QuakeCamera(3, 0.6, 1, 1, 2)\n\
--	Act_Melee_Default_OnCastingCompleted(kActor,kAction); \n\
	--    \n\
	kAction:CreateActionTargetList(kActor, false, true)	--    (  ,      )\n\
	\n\
	--       \n\
	local i = 0;\n\
	local kTargetList = kAction:GetTargetList();\n\
	local iTargetCount = kTargetList:size();\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
		if kTargetPilot:IsNil() == false then\n\
			if kActor:IsMyActor() then\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				g_world:AddDrawActorFilter(kTargetGUID);\n\
			end\n\
		end\n\
		i = i + 1;\n\
	end	\n\
	\n\
	Skill_Master_Summon_Common_Fire(kActor,kAction)\n\
end\n\
\n\
function Skill_Multi_Strape_OnEnter(kActor, kAction)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
		\n\
	ODS(\"Skill_Multi_Strape_OnEnter\\n\", false, 912);\n\
	\n\
	kActor:FreeMove(false)\n\
	kActor:StartWeaponTrail() --  \n\
	\n\
	if kActor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(0x000000, 0.0, 1.0, 0.4,true,true)\n\
		g_world:AddDrawActorFilter(kActor:GetPilotGuid());\n\
	end\n\
	\n\
	local	kSoundID = kAction:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		kActor:AttachSound(2783,kSoundID);\n\
	end\n\
	\n\
	-- \n\
	if 1 == kActor:GetAbil(AT_GENDER) then\n\
		local	kSoundID2 = kAction:GetScriptParam(\"CASTING_SOUND_ID_MALE\");\n\
		if kSoundID2~=\"\" then\n\
			kActor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	-- \n\
	else\n\
		local	kSoundID2 = kAction:GetScriptParam(\"CASTING_SOUND_ID_FEMALE\");\n\
		if kSoundID2~=\"\" then\n\
			kActor:AttachSound(2786,kSoundID2);\n\
			ODS(\"\\n\", false, 912)\n\
		end	\n\
	end\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true\n\
	end\n\
	\n\
	Skill_Multi_Strape_OnCastingCompleted(kActor, kAction);	--    \n\
\n\
	kActor:StopJump()\n\
		  \n\
	kActor:SetCanHit(false);\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Multi_Strape_OnUpdate(kActor, fAccumTime, fFrameTime)	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
		\n\
	local	kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	kActor:LockBidirection(false);\n\
	kActor:SeeFront(true);\n\
	kActor:FreeMove(false);\n\
\n\
	local animDone = kActor:IsAnimationDone()\n\
	local nextActionName = kAction:GetNextActionName()\n\
	\n\
	if kAction:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
		QuakeCamera(1, 3, 1, 1, 1)\n\
		local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID1\");\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local curActionParam = kAction:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			kAction:SetParam(0, \"null\")\n\
			kAction:SetParam(1, \"end\")\n\
			return false;\n\
		else\n\
			kAction:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Multi_Strape_OnCleanUp(kActor, kNextAction)	\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kNextAction)\n\
	CheckNil(kNextAction:IsNil())\n\
\n\
	ODS(\"Skill_Multi_Strape_ReallyLeave nextaction : \"..kNextAction:GetID()..\"\\n\", false, 912)\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_Multi_Strape_OnLeave(kActor, kNextAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kNextAction)\n\
	CheckNil(kNextAction:IsNil())\n\
\n\
	local kCurAction = kActor:GetAction()\n\
	local actionID = kNextAction:GetID()\n\
	local curParam = kCurAction:GetParam(1)\n\
	\n\
	if kCurAction:GetNextActionName() ~= actionID then\n\
		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
	\n\
--	kNextAction:SetTargetList(kCurAction:GetTargetList())\n\
\n\
	local kTargetList = kCurAction:GetTargetList()\n\
	if(true == kTargetList:IsNil()) then return true end\n\
	local iTargetCount = kTargetList:size()\n\
	\n\
--	ODS(\":\"..kNextAction:GetID()..\"\\n\",false, 912)\n\
--	ODS(\":\"..kNextAction:GetActionNo()..\"\\n\",false, 912)\n\
	\n\
	local STD_INDEX = 1000\n\
	kActor:SetParam(STD_INDEX, tostring(iTargetCount))\n\
	\n\
	local i = 0\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i)\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID()\n\
		local iCurIndex = (STD_INDEX+1)+i\n\
		kActor:SetParam(iCurIndex, kTargetGUID:GetString())\n\
		\n\
		ODS(\"MultiStrape_Fire : Index:\"..(iCurIndex)..\"  GUID:\"..kTargetGUID:GetString()..\"\\n\", false, 912)\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID)\n\
--		if kTargetPilot:IsNil() == false then\n\
			local actorTarget = kTargetPilot:GetActor()\n\
		--	if false == actorTarget:IsNil() then\n\
				local kTargetPos = actorTarget:GetPos()\n\
				ODS(\"Index\"..iCurIndex..\" X:\"..kTargetPos:GetX()..\" Y:\"..kTargetPos:GetY()..\" Z:\"..kTargetPos:GetZ()..\"\\n\", false, 912)\n\
			--	kNextAction:SetParamAsPoint(1000+i, kTargetPos)\n\
			--end\n\
	--	end\n\
		i = i + 1;\n\
	end\n\
	\n\
	--   \n\
	kActor:SetParam(\"MULTISTRAPE_TARGET_INDEX\", tostring(STD_INDEX))	\n\
	kActor:SetParam(\"MULTISTRAPE_TARGET_REMAIN\", tostring(iTargetCount))\n\
	\n\
	if kActor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if kNextAction:GetActionType()==\"EFFECT\" then\n\
		if kActor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end	\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if kNextAction:GetEnable() == false then\n\
		if curParam == actionID then\n\
			kCurAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if kNextAction:GetEnable() == true then\n\
		kCurAction:SetParam(0,\"GoNext\");\n\
		return false;\n\
	end\n\
	return false \n\
end\n\
\n\
function Skill_Multi_Strape_DoEffect(kActor)\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
end\n\
\n\
function Skill_Multi_Strape_OnEvent(kActor, textKey)		\n\
	return false\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Skill_Multi_Strape_Fire_OnCheckCanEnter(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	local weapontype = kActor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	--   \n\
	if g_pilotMan:IsLockMyInput() == true then\n\
		return\n\
	end	\n\
			\n\
	return		true;\n\
	\n\
end\n\
function Skill_Multi_Strape_Fire_FindTarget(kActor,kAction)\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnFindTarget(kActor,kAction,kTargets)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnCastingCompleted(kActor,kAction)\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
		\n\
	ODS(\"Skill_Multi_Strape_Fire_OnEnter\\n\", false, 912);\n\
	kActor:FreeMove(false)\n\
	\n\
	Skill_Multi_Strape_Fire_OnCastingCompleted(kActor, kAction)\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	kAction:SetParamInt(99, 0)						--  0~2 \n\
	kAction:SetParamInt(100,0)						--  \n\
	kAction:SetParamInt(101,15)						--  \n\
	kActor:PlayCurrentSlot()\n\
---------------------------------------------------------------------------------\n\
--[[\n\
	kAction:ClearTargetList()\n\
	kAction:CreateActionTargetList(kActor,false);\n\
	local kTargetList = kAction:GetTargetList();\n\
	if(true == kTargetList:IsNil()) then return true end\n\
	local iTargetCount = kTargetList:size();\n\
\n\
	local STD_INDEX = 1000\n\
	kActor:SetParam(STD_INDEX, tostring(iTargetCount))\n\
	\n\
	local i = 0\n\
	while i<iTargetCount do\n\
		local   kTargetInfo = kTargetList:GetTargetInfo(i);\n\
		local   kTargetGUID = kTargetInfo:GetTargetGUID();\n\
		local iCurIndex = (STD_INDEX+1)+i\n\
		kActor:SetParam(iCurIndex, kTargetGUID:GetString())\n\
		\n\
		ODS(\"MultiStrape_Fire : Index:\"..(iCurIndex)..\"  GUID:\"..kTargetGUID:GetString()..\"\\n\", false, 912)\n\
		local   kTargetPilot = g_pilotMan:FindPilot(kTargetGUID);\n\
--		if kTargetPilot:IsNil() == false then\n\
			local actorTarget = kTargetPilot:GetActor();\n\
		--	if false == actorTarget:IsNil() then\n\
				local kTargetPos = actorTarget:GetPos();\n\
				ODS(\"Index\"..iCurIndex..\" X:\"..kTargetPos:GetX()..\" Y:\"..kTargetPos:GetY()..\" Z:\"..kTargetPos:GetZ()..\"\\n\", false, 912)\n\
			--	kNextAction:SetParamAsPoint(1000+i, kTargetPos)\n\
			--end\n\
	--	end\n\
		i = i + 1;\n\
	end\n\
	--   \n\
	if(g_TestValue == false) then \n\
		kActor:SetParam(\"MULTISTRAPE_TARGET_INDEX\", tostring(STD_INDEX))\n\
		g_TestValue = true\n\
	end\n\
]]\n\
--------------------------------------------------------------------\n\
	local animDone = kActor:IsAnimationDone()\n\
	local nextActionName = kAction:GetNextActionName()\n\
		\n\
	\n\
	if kAction:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then		\n\
		local curActionParam = kAction:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = kAction:GetParam(1);\n\
\n\
			kAction:SetParam(0, \"null\")\n\
			kAction:SetParam(1, \"end\")			\n\
			kAction:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
			kAction:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function	Skill_Multi_Strape_Fire_LoadArrowToWeapon(kActor,kAction)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(\"PROJECTILE_MULTISTRAPE_ARROW\",kAction,kActor:GetPilotGuid());\n\
	\n\
	--       (XML )\n\
	-- local kProjectileOption = kNewArrow:GetOptionInfo()\n\
	-- if(false == kProjectileOption:IsNil()) then\n\
		-- kProjectileOption:SetAutoRemoveIfNoneTarget(false)\n\
		-- kNewArrow:SetOptionInfo(kProjectileOption)\n\
	-- end\n\
	kNewArrow:LoadToWeapon(kActor) --    \n\
	return	kNewArrow;	\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_Finished(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	ODS(\"Skill_Multi_Strape_Fire_Finished\\n\", false, 912);\n\
		\n\
	local	nextActionName = kAction:GetNextActionName()\n\
--	local	iMaxActionSlot = kAction:GetSlotCount();\n\
--	local	actionID = kAction:GetID();\n\
\n\
	kActor:SetNormalAttackEndTime();\n\
\n\
	local	curActionParam = kAction:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = kAction:GetParam(1);\n\
\n\
		kAction:SetParam(0, \"null\")\n\
		kAction:SetParam(1, \"end\")\n\
		\n\
		kAction:SetNextActionName(nextActionName)\n\
		return false;\n\
	else\n\
\n\
		kAction:SetParam(1, \"end\")\n\
\n\
		return false\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnUpdate(kActor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
\n\
	local	kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	kActor:LockBidirection(false);\n\
	kActor:SeeFront(true);\n\
	kActor:FreeMove(false);\n\
	\n\
	local	animDone = kActor:IsAnimationDone()\n\
	local	weapontype = kActor:GetEquippedWeaponType();\n\
\n\
	local iMaxFireTime = kAction:GetParamInt(101)				--  \n\
	if(iMaxFireTime == kAction:GetParamInt(100)) then\n\
--		kAction:SetParamInt(7,1)	--    \n\
		kAction:SetParam(0, \"null\")\n\
		kAction:SetParam(1, \"end\")\n\
		return	Skill_Multi_Strape_Fire_Finished(kActor,kAction);\n\
	end\n\
\n\
	--if animDone == true then\n\
	if kAction:GetParamInt(7) == 1 then	\n\
--		kActor:PlayCurrentSlot();\n\
	--	kAction:SetParamInt(100, kAction:GetParamInt(100)+1)\n\
--		kAction:SetParamInt(7,0)\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnCleanUp(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	ODS(\"Skill_Multi_Strape_Fire_ReallyLeave nextaction : \"..kAction:GetID()..\"\\n\", false, 912);\n\
	\n\
	kActor:FreeMove(false);\n\
	kActor:EndWeaponTrail();\n\
	return true\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnLeave(kActor, kNextAction)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kNextAction);\n\
	CheckNil(kNextAction:IsNil());\n\
	\n\
	local kCurAction = kActor:GetAction();\n\
	\n\
	CheckNil(nil==kCurAction);\n\
	CheckNil(kCurAction:IsNil());\n\
	\n\
	local curParam = kCurAction:GetParam(1)\n\
	local actionID = kNextAction:GetID()\n\
	\n\
	ODS(\"Skill_Multi_Strape_Fire_OnLeave NEXTACTION : \"..actionID..\" curParam:\"..curParam..\"\\n\")\n\
	if kCurAction:GetNextActionName() ~= actionID then\n\
		ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		return false;\n\
	end\n\
	\n\
	if kActor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if kNextAction:GetActionType()==\"EFFECT\" then\n\
		if kActor:IsMyActor() then\n\
			if( CheckNil(g_world == nil) ) then return true end\n\
			if( CheckNil(g_world:IsNil()) ) then return true end\n\
			g_world:SetShowWorldFocusFilterColorAlpha(0xFFFFFF, g_world:GetWorldFocusFilterAlpha(), 0, 1, false,false);\n\
			g_world:ClearDrawActorFilter()\n\
		end	\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true\n\
	end\n\
	\n\
	if kNextAction:GetEnable() == false then\n\
		if curParam == actionID then\n\
			kCurAction:SetParam(0,\"\")\n\
		end\n\
	end\n\
	\n\
	if kNextAction:GetEnable() == true then\n\
		kCurAction:SetParam(0,\"GoNext\")\n\
		return false;\n\
	end\n\
	return false\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_OnEvent(kActor, textKey)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	local	kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	ODS(\"Skill_Multi_Strape_Fire_OnEvent textKey:\"..textKey..\"\\n\", false, 912);\n\
	if textKey == \"fire\" then	\n\
--		if kAction:GetParamInt(7) == 0 then	--   \n\
	--		kAction:SetParamInt(7, 1)\n\
			if(0 == kAction:GetParamInt(99)) then \n\
				Skill_Multi_Strape_Fire_DoEffect(kActor);\n\
			elseif(1 == kAction:GetParamInt(99)) then \n\
				Skill_Multi_Strape_Fire_DoEffect1(kActor);\n\
			elseif(2 == kAction:GetParamInt(99)) then \n\
				Skill_Multi_Strape_Fire_DoEffect2(kActor);\n\
			end\n\
			kAction:SetParamInt(100, kAction:GetParamInt(100)+1)\n\
--		end\n\
	end\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_DoEffect(kActor)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
    kActor:FreeMove(false);\n\
\n\
	local	kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	--	kAction:SetParam(4,\"HIT\");\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
\n\
	--  \n\
		local	kRotateAxis = Point3(0,0,1);		\n\
		local	kPlayerRightVec = Point3(0,0,1);\n\
		kPlayerRightVec:Cross(kActor:GetLookingDir())\n\
		local fRotateAngle = 12.0*DEGTORAD\n\
		local	i = 0;\n\
		local	iAttackRange = 300 --kAction:GetSkillRange(0,kActor);\n\
		\n\
--  	\n\
--				local iPentrationCount = kActor:GetAbil(AT_PENETRATION_COUNT); --    \n\
--[[	local kPos1 = kActor:GetNodeWorldPos(\"p_ef_heart\");\n\
	ODS(\"X:\"..kPos1:GetX()..\" Y:\"..kPos1:GetY()..\" Z:\"..kPos1:GetZ()..\"\\n\", false, 912)]]\n\
	local iMaxFireTime = kAction:GetParamInt(101)				--  \n\
	local iFiredTime = kAction:GetParamInt(100)		\n\
	local fRate = (iFiredTime*2)/iMaxFireTime\n\
	local fForce = 250\n\
	if(fRate < 1)  then \n\
		-- 1 to 0\n\
		fRate = 1 - fRate		--   \n\
		fForce = -fForce*fRate\n\
	else		\n\
		-- 0 to 1				--    \n\
		fRate = fRate -1 \n\
		fForce = fForce*fRate\n\
	end\n\
		\n\
		\n\
	local iTestArrowNum = 5\n\
	while i<iTestArrowNum do\n\
	local	kArrow = Skill_Multi_Strape_Fire_LoadArrowToWeapon(kActor,kAction);\n\
	\n\
		if kArrow:IsNil() == false then		\n\
--			kArrow:SetPenetrationCount(iPentrationCount);--   \n\
		--[[	\n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
]]		\n\
--[[			local kAEffect = kActor:GetAttackEffect(kAction:GetID())\n\
			if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
				kActor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
			end\n\
]]			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			local	kFireTarget = kActor:GetLookingDir()\n\
			kFireTarget:Multiply(250);\n\
			\n\
			kFireTarget:Rotate(kPlayerRightVec, -45.0*DEGTORAD);\n\
	--		ODS(\"   : \"..(iAttackRange-30)..\"\\n\", false, 912)\n\
			local iRotate = tonumber(kActor:GetParam(\"MULTISTRAPE\"))\n\
			if(nil == iRotate) then iRotate = 1 end\n\
			if(20 < iRotate) then \n\
				iRotate = 0\n\
			end\n\
--			ODS(\"iRotate :\"..iRotate..\"\\n\", false, 912)\n\
			kFireTarget:Rotate(kRotateAxis,fRotateAngle*(iRotate*math.random(2,10)));			\n\
			--kFireTarget:Rotate(kRotateAxis,fRotateAngle*(iRotate)*0.7);\n\
			\n\
			kActor:SetParam(\"MULTISTRAPE\", tostring(iRotate+1))\n\
			kFireTarget:Add(kArrow:GetWorldPos());\n\
--			ODS(\"X:\"..kFireTarget:GetX()..\" Y:\"..kFireTarget:GetY()..\" Z:\"..kFireTarget:GetZ()..\"\\n\", false, 912)\n\
			kArrow:SetTargetLoc(kFireTarget);\n\
			\n\
--------------------------------------------------------------------\n\
		kArrow:Fire(true);		\n\
		kArrow:SetMovingType(2); --    .\n\
		local kPos1 = kArrow:GetFireStartPos();\n\
		local kPos4 = kArrow:GetTargetLoc();\n\
		\n\
--		kPos1:SetZ(kPos1:GetZ()+ math.random(0,5))\n\
		kArrow:SetParam(350,50); 		 --, , \n\
		\n\
		local kPos2 = kArrow:GetFireStartPos();\n\
		local kPos3 = kArrow:GetTargetLoc();\n\
		kPos2:SetZ(kPos2:GetZ()+50);	\n\
		kPos2:SetX(kPos2:GetX()+fForce)		\n\
		\n\
		--kPos2:SetZ(kPos2:GetZ() + math.random(100, 120));		\n\
		-- kPos3:SetZ(kPos3:GetZ() - math.random(0, 30));		\n\
		-- kPos2:SetX(kPos2:GetX() + math.random(0, 50));\n\
		-- kPos3:SetX(kPos3:GetX() - math.random(0, 50));		\n\
		-- kPos2:SetY(kPos2:GetY() + math.random(0, 50));\n\
		-- kPos3:SetY(kPos3:GetY() - math.random(0, 50));\n\
\n\
		local kDistance = kPos1:Distance(kPos4);\n\
		local kDir = kArrow:GetDirection();\n\
		kDir:Multiply(kDistance*-0.20);\n\
		kPos2:Add(kDir);\n\
		\n\
		kPos3:SetX(kPos3:GetX()-fForce)\n\
		kDir = kArrow:GetDirection();\n\
		kDir:Multiply(kDistance*0.20);\n\
		kPos3:Add(kDir);\n\
		\n\
		kArrow:SetParam_Bezier4SplineType(kPos1, kPos2, kPos3, kPos4);\n\
-----------------------------------------------------------------------\n\
		end\n\
--		kActor:ClearIgnoreEffectList();	\n\
		i=i+1;\n\
	end	\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_DoEffect1(kActor)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
    kActor:FreeMove(false);\n\
\n\
	local	kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	--	kAction:SetParam(4,\"HIT\");\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
\n\
	--  \n\
		local	kRotateAxis = Point3(0,0,1);		\n\
		local	kPlayerRightVec = Point3(0,0,1);\n\
		kPlayerRightVec:Cross(kActor:GetLookingDir())\n\
		local fRotateAngle = 12.0*DEGTORAD\n\
		local	i = 0;\n\
		local	iAttackRange = 300 --kAction:GetSkillRange(0,kActor);\n\
		\n\
--  	\n\
--				local iPentrationCount = kActor:GetAbil(AT_PENETRATION_COUNT); --    \n\
--[[	local kPos1 = kActor:GetNodeWorldPos(\"p_ef_heart\");\n\
	ODS(\"X:\"..kPos1:GetX()..\" Y:\"..kPos1:GetY()..\" Z:\"..kPos1:GetZ()..\"\\n\", false, 912)]]\n\
	local iMaxFireTime = kAction:GetParamInt(101)				--  \n\
	local iFiredTime = kAction:GetParamInt(100)		\n\
	local fRate = (iFiredTime*2)/iMaxFireTime\n\
	local fForce = 250\n\
	if(fRate < 1)  then \n\
		-- 1 to 0\n\
		fRate = 1 - fRate		--   \n\
		fForce = -fForce*fRate\n\
	else		\n\
		-- 0 to 1				--    \n\
		fRate = fRate -1 \n\
		fForce = fForce*fRate\n\
	end\n\
		\n\
		\n\
	local iTestArrowNum = 5\n\
	while i<iTestArrowNum do\n\
	local	kArrow = Skill_Multi_Strape_Fire_LoadArrowToWeapon(kActor,kAction);\n\
	\n\
		if kArrow:IsNil() == false then		\n\
--			kArrow:SetPenetrationCount(iPentrationCount);--   \n\
		--[[	\n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
]]		\n\
--[[			local kAEffect = kActor:GetAttackEffect(kAction:GetID())\n\
			if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
				kActor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
			end\n\
]]			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			local	kFireTarget = kActor:GetLookingDir()\n\
			kFireTarget:Multiply(250);\n\
			\n\
			kFireTarget:Rotate(kPlayerRightVec, -45.0*DEGTORAD);\n\
	--		ODS(\"   : \"..(iAttackRange-30)..\"\\n\", false, 912)\n\
			local iRotate = tonumber(kActor:GetParam(\"MULTISTRAPE\"))\n\
			if(nil == iRotate) then iRotate = 1 end\n\
			if(20 < iRotate) then \n\
				iRotate = 0\n\
			end\n\
			kFireTarget:Rotate(kRotateAxis,fRotateAngle*(iRotate)*0.7);\n\
			\n\
			kActor:SetParam(\"MULTISTRAPE\", tostring(iRotate+1))\n\
			kFireTarget:Add(kArrow:GetWorldPos());\n\
--			ODS(\"X:\"..kFireTarget:GetX()..\" Y:\"..kFireTarget:GetY()..\" Z:\"..kFireTarget:GetZ()..\"\\n\", false, 912)\n\
			kArrow:SetTargetLoc(kFireTarget);\n\
			\n\
--------------------------------------------------------------------\n\
		kArrow:Fire(true);		\n\
		kArrow:SetMovingType(2); --    .\n\
		local kPos1 = kArrow:GetFireStartPos();\n\
		local kPos4 = kArrow:GetTargetLoc();\n\
		\n\
--		kPos1:SetZ(kPos1:GetZ()+ math.random(0,5))\n\
		kArrow:SetParam(350,50); 		 --, , \n\
		\n\
		local kPos2 = kArrow:GetFireStartPos();\n\
		local kPos3 = kArrow:GetTargetLoc();\n\
		kPos2:SetZ(kPos2:GetZ()+50);\n\
						-- if(i%2 == 0 ) then\n\
							-- --kPos2:SetX(kPos2:GetX()+math.random(10, 50))\n\
							-- kPos2:SetX(kPos2:GetX()+50)\n\
						-- else\n\
							-- --kPos2:SetX(kPos2:GetX()-math.random(10, 50))\n\
							-- kPos2:SetX(kPos2:GetX()-50)\n\
						-- end\n\
		kPos2:SetX(kPos2:GetX()+fForce)\n\
		\n\
		\n\
		--kPos2:SetZ(kPos2:GetZ() + math.random(100, 120));		\n\
		-- kPos3:SetZ(kPos3:GetZ() - math.random(0, 30));		\n\
		-- kPos2:SetX(kPos2:GetX() + math.random(0, 50));\n\
		-- kPos3:SetX(kPos3:GetX() - math.random(0, 50));		\n\
		-- kPos2:SetY(kPos2:GetY() + math.random(0, 50));\n\
		-- kPos3:SetY(kPos3:GetY() - math.random(0, 50));\n\
\n\
		local kDistance = kPos1:Distance(kPos4);\n\
		local kDir = kArrow:GetDirection();\n\
		kDir:Multiply(kDistance*-0.20);\n\
		kPos2:Add(kDir);\n\
		\n\
		kPos3:SetX(kPos3:GetX()-fForce)\n\
") + std::string("		kDir = kArrow:GetDirection();\n\
		kDir:Multiply(kDistance*0.20);\n\
		kPos3:Add(kDir);\n\
		\n\
		kArrow:SetParam_Bezier4SplineType(kPos1, kPos2, kPos3, kPos4);\n\
-----------------------------------------------------------------------\n\
		end\n\
--		kActor:ClearIgnoreEffectList();	\n\
		i=i+1;\n\
	end	\n\
end\n\
\n\
function Skill_Multi_Strape_Fire_DoEffect2(kActor)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
    kActor:FreeMove(false);\n\
\n\
	local	kAction = kActor:GetAction()\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	--	kAction:SetParam(4,\"HIT\");\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
\n\
	--  \n\
		local	kRotateAxis = Point3(0,0,1);		\n\
		local	kPlayerRightVec = Point3(0,0,1);\n\
		kPlayerRightVec:Cross(kActor:GetLookingDir())\n\
		local fRotateAngle = 12.0*DEGTORAD\n\
		local	i = 0;\n\
		local	iAttackRange = 300 --kAction:GetSkillRange(0,kActor);\n\
		\n\
--  	\n\
--				local iPentrationCount = kActor:GetAbil(AT_PENETRATION_COUNT); --    \n\
--[[	local kPos1 = kActor:GetNodeWorldPos(\"p_ef_heart\");\n\
	ODS(\"X:\"..kPos1:GetX()..\" Y:\"..kPos1:GetY()..\" Z:\"..kPos1:GetZ()..\"\\n\", false, 912)]]\n\
	local iMaxFireTime = kAction:GetParamInt(101)				--  \n\
	local iFiredTime = kAction:GetParamInt(100)		\n\
	-- local fRate = (iFiredTime*2)/iMaxFireTime\n\
	-- local fForce = 250\n\
	-- if(fRate < 1)  then \n\
		-- -- 1 to 0\n\
		-- fRate = 1 - fRate		--   \n\
		-- fForce = -fForce*fRate\n\
	-- else		\n\
		-- -- 0 to 1				--    \n\
		-- fRate = fRate -1 \n\
		-- fForce = fForce*fRate\n\
	-- end\n\
		\n\
		\n\
	local iTestArrowNum = 5\n\
	while i<iTestArrowNum do\n\
	local	kArrow = Skill_Multi_Strape_Fire_LoadArrowToWeapon(kActor,kAction);\n\
	\n\
		if kArrow:IsNil() == false then		\n\
--			kArrow:SetPenetrationCount(iPentrationCount);--   \n\
		--[[	\n\
			if iPentrationCount ~= 0 then\n\
				kArrow:SetMultipleAttack(true);\n\
			end\n\
]]		\n\
--[[			local kAEffect = kActor:GetAttackEffect(kAction:GetID())\n\
			if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
				kActor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
			end\n\
]]			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
			\n\
			local	kFireTarget = kActor:GetLookingDir()\n\
			kFireTarget:Multiply(250);\n\
			\n\
			kFireTarget:Rotate(kPlayerRightVec, -45.0*DEGTORAD);\n\
	--		ODS(\"   : \"..(iAttackRange-30)..\"\\n\", false, 912)\n\
			local iRotate = tonumber(kActor:GetParam(\"MULTISTRAPE\"))\n\
			if(nil == iRotate) then iRotate = 1 end\n\
			if(20 < iRotate) then \n\
				iRotate = 0\n\
			end\n\
--			ODS(\"iRotate :\"..iRotate..\"\\n\", false, 912)\n\
			kFireTarget:Rotate(kRotateAxis,fRotateAngle*(iRotate*math.random(2,10)));			\n\
			--kFireTarget:Rotate(kRotateAxis,fRotateAngle*(iRotate)*0.7);\n\
			\n\
			kActor:SetParam(\"MULTISTRAPE\", tostring(iRotate+1))\n\
			kFireTarget:Add(kArrow:GetWorldPos());\n\
--			ODS(\"X:\"..kFireTarget:GetX()..\" Y:\"..kFireTarget:GetY()..\" Z:\"..kFireTarget:GetZ()..\"\\n\", false, 912)\n\
			kArrow:SetTargetLoc(kFireTarget);\n\
			\n\
--------------------------------------------------------------------\n\
		kArrow:Fire(true);		\n\
		kArrow:SetMovingType(2); --    .\n\
		local kPos1 = kArrow:GetFireStartPos();\n\
		local kPos4 = kArrow:GetTargetLoc();\n\
		\n\
--		kPos1:SetZ(kPos1:GetZ()+ math.random(0,5))\n\
		kArrow:SetParam(350,50); 		 --, , \n\
		\n\
		local kPos2 = kArrow:GetFireStartPos();\n\
		local kPos3 = kArrow:GetTargetLoc();\n\
		kPos2:SetZ(kPos2:GetZ()+50);\n\
						 if(i%2 == 0 ) then\n\
							 --kPos2:SetX(kPos2:GetX()+math.random(10, 50))\n\
							 kPos2:SetX(kPos2:GetX()+50)\n\
						 else\n\
							 --kPos2:SetX(kPos2:GetX()-math.random(10, 50))\n\
							 kPos2:SetX(kPos2:GetX()-50)\n\
						 end\n\
		\n\
		\n\
		\n\
		--kPos2:SetZ(kPos2:GetZ() + math.random(100, 120));		\n\
		-- kPos3:SetZ(kPos3:GetZ() - math.random(0, 30));		\n\
		-- kPos2:SetX(kPos2:GetX() + math.random(0, 50));\n\
		-- kPos3:SetX(kPos3:GetX() - math.random(0, 50));		\n\
		-- kPos2:SetY(kPos2:GetY() + math.random(0, 50));\n\
		-- kPos3:SetY(kPos3:GetY() - math.random(0, 50));\n\
\n\
		local kDistance = kPos1:Distance(kPos4);\n\
		local kDir = kArrow:GetDirection();\n\
		kDir:Multiply(kDistance*-0.20);\n\
		kPos2:Add(kDir);\n\
		\n\
		--kPos3:SetX(kPos3:GetX()-fForce)\n\
		kDir = kArrow:GetDirection();\n\
		kDir:Multiply(kDistance*0.20);\n\
		kPos3:Add(kDir);\n\
		\n\
		kArrow:SetParam_Bezier4SplineType(kPos1, kPos2, kPos3, kPos4);\n\
-----------------------------------------------------------------------\n\
		end\n\
--		kActor:ClearIgnoreEffectList();	\n\
		i=i+1;\n\
	end	\n\
end") );
	m_kContLuaText.push_back(std::string("-- [FIRE_SOUND_ID] :     \n\
\n\
function Skill_MultiStrape_Melee_OnCastingCompleted(kActor,kAction)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnCheckCanEnter(kActor,kAction)\n\
\n\
	ODS(\"Skill_MultiStrape_Melee_OnCheckCanEnter \\n\",false, 1509)\n\
	return Skill_Master_Summon_Finish_OnCheckCanEnter(kActor,kAction)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnTimer(kActor,fAccumTime,kAction,iTimerID)\n\
	return Skill_Master_Summon_Finish__OnTimer(kActor,fAccumTime,kAction,iTimerID)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnEnter(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil())\n\
	kActor:FreeMove(false)\n\
	kActor:StartWeaponTrail()\n\
	return Skill_Master_Summon_Finish_OnEnter(kActor, kAction)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnUpdate(kActor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	kActor:FreeMove(false)\n\
	return 	Skill_Master_Summon_Finish_OnUpdate(kActor, accumTime, frameTime)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnCleanUp(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	Skill_Master_Summon_Common_OnCleanUp(kActor,kAction)\n\
	\n\
	return Skill_Master_Summon_Finish_OnCleanUp(kActor)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnLeave(kActor, kAction)\n\
\n\
	CheckNil(nil==kActor)\n\
	CheckNil(kActor:IsNil())\n\
	\n\
	CheckNil(nil==kAction)\n\
	CheckNil(kAction:IsNil())\n\
	\n\
	kActor:FreeMove(false)\n\
	kActor:EndWeaponTrail()\n\
\n\
	return Skill_Master_Summon_Finish_OnLeave(kActor, kAction)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnEvent(kActor, strTextKey)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
		\n\
	local kAction = kActor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if strTextKey == \"fire\" then	-- (fire)  \n\
		QuakeCamera(1, 1, 1, 1, 1)\n\
		local kArrow = Skill_MultiStrape_Melee_LoadArrowToWeapon(kActor, kAction)\n\
		if (false == kArrow:IsNil()) then \n\
			kArrow:SetParentActionInfo(0, kAction:GetActionInstanceID(), kAction:GetTimeStamp());\n\
			local	kYUnitVec = Point3(0,1,0)\n\
			local kTargetPos = kActor:GetLookingDir()\n\
			kTargetPos:Rotate(kYUnitVec, -90*DEGTORAD)\n\
\n\
			local kDist = Point3(0,0,1)\n\
			kDist:Multiply(270)\n\
			kTargetPos:Add(kArrow:GetWorldPos())\n\
			kTargetPos:Add(kDist)\n\
			kArrow:SetTargetLoc(kTargetPos)\n\
			kArrow:Fire(true)\n\
		end\n\
		\n\
		--   \n\
		if \"\" ~= kAction:GetScriptParam(\"SUMMON_CLASSNO\") then\n\
			local iSummonClassNo = tonumber(kAction:GetScriptParam(\"SUMMON_CLASSNO\"));\n\
			local kSummonReserveAction = kAction:GetScriptParam(\"SUMMON_RESERVE_ACTION\");\n\
			Skill_Master_Summon_Common_Create_Summon(kActor,iSummonClassNo,kSummonReserveAction);\n\
		end	\n\
		local	kSoundID = kAction:GetScriptParam(\"FIRE_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2783,kSoundID);\n\
		end\n\
		\n\
	elseif strTextKey == \"hit\" then	--hit    \n\
		QuakeCamera(1, 5, 1, 1, 2)\n\
		--  \n\
		\n\
		local iSkillRange = kAction:GetParamInt(21);\n\
		local iIndex = kAction:GetParamInt(20);\n\
\n\
		local kPos = kActor:GetPos();\n\
		--[[\n\
		kPos:SetX(kPos:GetX() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetY(kPos:GetY() + math.random(-iSkillRange,iSkillRange));\n\
		kPos:SetZ(kPos:GetZ() + 200);\n\
		]]\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local ptcl = g_world:ThrowRay(kPos, Point3(0,0,-1),500);\n\
		if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
			--  .\n\
			ptcl = g_world:ThrowRay(kPos, Point3(0,0,1),500);\n\
			if ptcl:GetX() == -1 and ptcl:GetY() == -1 and ptcl:GetZ() == -1 then\n\
				return true;\n\
			end			\n\
		end\n\
		ptcl:SetZ(ptcl:GetZ()-50)\n\
		\n\
		local fScale = 5\n\
		kActor:AttachParticleToPointS(1000 + iIndex, ptcl, \"ef_skill_dragon_rush_lightning_01\", fScale);\n\
		--kActor:AttachParticleToPointS(1000 + iIndex, kPos, \"ef_skill_dragon_rush_lightning_01\", fScale);\n\
		\n\
		kAction:SetParamInt(20, iIndex + 1);\n\
\n\
\n\
		return Skill_Master_Summon_Finish_OnEvent(kActor, strTextKey)\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_MultiStrape_Melee_OnTargetListModified(kActor, kAction, bIsBefore)\n\
	return Skill_Master_Summon_Finish_OnTargetListModified(kActor, kAction, bIsBefore)\n\
end\n\
\n\
function Skill_MultiStrape_Melee_LoadArrowToWeapon(kActor,kAction)\n\
\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(\"PROJECTILE_MULTISTRAPE_LAST_ARROW\", kAction, kActor:GetPilotGuid());\n\
	\n\
	--      (XML )\n\
	-- local kProjectileOption = kNewArrow:GetOptionInfo()\n\
	-- if(false == kProjectileOption:IsNil()) then\n\
		-- kProjectileOption:SetAutoRemoveIfNoneTarget(false)\n\
		-- kNewArrow:SetOptionInfo(kProjectileOption)\n\
	-- end\n\
	\n\
	kNewArrow:LoadToWeapon(kActor) --    \n\
	return	kNewArrow\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID] :      ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SHOW_TEXT_TARGETLIST_COUNT_NUM] :     \n\
-- [SHOW_TEXT_TARGETLIST_TEXTNO] :  \n\
\n\
function Skill_MutiStrape_Creature_Idle_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	Skill_MutiStrape_Creature_Idle_Fire(actor,action);\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
	action:SetParam(3,\"0\");\n\
\n\
end\n\
function Skill_MutiStrape_Creature_Idle_Fire(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
end\n\
\n\
function Skill_MutiStrape_Creature_Idle_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local actionID = action:GetID()\n\
	\n\
	action:SetParam(3,\"0\");\n\
	\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local	kSoundID = action:GetScriptParam(\"CASTING_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2785,kSoundID);\n\
	end	\n\
	\n\
	action:SetParamInt(2,0);\n\
	\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
\n\
	Skill_MutiStrape_Creature_Idle_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Skill_MutiStrape_Creature_Idle_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:LockBidirection(false);\n\
	actor:SeeFront(true);\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	\n\
	if animDone == true then\n\
		return false;\n\
	end	\n\
	\n\
	return true;\n\
end\n\
\n\
function Skill_MutiStrape_Creature_Idle_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid());\n\
		\n\
	return true;\n\
end\n\
\n\
function Skill_MutiStrape_Creature_Idle_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	return true\n\
end\n\
\n\
\n\
function Skill_MutiStrape_Creature_Idle_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
\n\
        if actor:IsMyActor()  then\n\
			action:GetTargetList():ApplyActionEffects(true,true);\n\
			return;\n\
		end\n\
    end\n\
end\n\
\n\
function Skill_MutiStrape_Creature_Idle_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local kAction = actor:GetAction();\n\
		\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
	elseif textKey == \"alpha_end\" then\n\
		actor:SetTargetAlpha(actor:GetAlpha(),0,0.2)\n\
	elseif textKey == \"alpha_start\" then\n\
		actor:SetTargetAlpha(0,1,0.5)\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bQuakedByHand = false\n\
iQuakedByHandTime = 1.867\n\
iGrapTime = 15			--     \n\
\n\
function Act_SP_Attk_01_OnEnter(actor, action)\n\
	action:SetParam(1,0)		--     \n\
	action:SetParam(0, 0)\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_01_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
		bQuakedByHand = false\n\
	elseif bQuakedByHand == false and (accumTime - action:GetParamFloat(1)) > iQuakedByHandTime then\n\
--		QuakeCamera(1.0, 1.2)		--     \n\
		bQuakedByHand = true\n\
		BossActor:AttachParticle(12361, \"Bip01 L Finger2\", \"e_b_dragonsapphire_hand_attk\")\n\
	end\n\
\n\
	if action:GetParamFloat(0) ~= 0 then\n\
		if (accumTime - action:GetParamFloat(0)) >= iGrapTime then\n\
			actor:PlayNext()\n\
			action:SetParam(0, 0)\n\
			curSlot = action:GetCurrentSlot()	--     \n\
			if iDownPuppetID4 ~= -1 then\n\
  				puppets[iDownPuppetID4]:TransitAction(\"up\")\n\
				iDownPuppetID4 = -1\n\
	  		end\n\
		end\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		action:SetParam(0, accumTime)			--     \n\
		actor:PlayNext()\n\
		curSlot = action:GetCurrentSlot()	--     \n\
	elseif curSlot == 2 and actor:IsAnimationDone() then	-- Idle  \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_01_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_01_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bQuakedByHand = false\n\
iQuakedByHandTime = 1.867\n\
iGrapTime = 15			--     \n\
\n\
function Act_SP_Attk_02_OnEnter(actor, action)	\n\
	action:SetParam(1,0)		--     \n\
	action:SetParam(0, 0)\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_02_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
		bQuakedByHand = false\n\
	elseif bQuakedByHand == false and (accumTime - action:GetParamFloat(1)) > iQuakedByHandTime then\n\
--		QuakeCamera(1.0, 1.2)		--     \n\
		bQuakedByHand = true\n\
		BossActor:AttachParticle(12360, \"Bip01 R Finger2\", \"e_b_dragonsapphire_hand_attk\")\n\
	end\n\
\n\
	if action:GetParamFloat(0) ~= 0 then\n\
		if (accumTime - action:GetParamFloat(0)) >= iGrapTime then\n\
			actor:PlayNext()\n\
			action:SetParam(0, 0)\n\
			curSlot = action:GetCurrentSlot()	--     \n\
			if iDownPuppetID4 ~= -1 then\n\
  				puppets[iDownPuppetID4]:TransitAction(\"up\")\n\
				iDownPuppetID4 = -1\n\
	  		end\n\
		end\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		action:SetParam(0, accumTime)			--     \n\
		actor:PlayNext()\n\
		curSlot = action:GetCurrentSlot()	--     \n\
	elseif curSlot == 2 and actor:IsAnimationDone() then	-- Idle  \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_02_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_02_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bRelease = false\n\
\n\
function Act_SP_Attk_03_OnEnter(actor, action)\n\
	action = actor:GetAction()\n\
	action:SetParam(0, 0)\n\
	action:SetParam(1, 0)\n\
	bBite = false\n\
	bRelease = false	-- \n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_03_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then\n\
		action:SetParam(1,accumTime)		--     \n\
		actor:PlayNext()		\n\
	elseif curSlot == 2 and actor:IsAnimationDone() then	\n\
		return false\n\
	end\n\
\n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
	elseif (accumTime - action:GetParamFloat(1)) > iBiteLongTime/1000 and bRelease == false then	--    \n\
		actor:PlayNext()	\n\
		bRelease = true		\n\
		if iDownPuppetID4 ~= -1 then\n\
			puppets[iDownPuppetID4]:TransitAction(\"up\")	--    up\n\
			iDownPuppetID4 = -1\n\
		end			\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_03_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_03_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("iAccumAngle = 0\n\
fRotRad = 0 \n\
iTotalAngle = 0		--    \n\
fBlockExploInter = 0.4		--     .\n\
\n\
function Act_SP_Attk_04_OnEnter(actor, action)\n\
	action:SetParam(0,0)\n\
	iAccumAngle = 0			--  \n\
	fRotRad = 0\n\
	if iExplotionNum > 0 then\n\
		iTotalAngle = math.rad(iExplotionNum * 10)\n\
	end\n\
	return true\n\
end\n\
--frameTime * 1    \n\
function Act_SP_Attk_04_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	Nowaction = actor:GetAction()		--    \n\
	curSlot = Nowaction:GetCurrentSlot()	--     \n\
\n\
	if Nowaction:GetParamFloat(0) == 0 then\n\
		Nowaction:SetParam(0, accumTime)\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		actor:PlayNext()\n\
--		fRotRad = 0.290888 -- math.rad(10)/ 0.6\n\
--		fRotRad = 0.581776 -- math.rad(10)/ 0.3\n\
		fRotRad = 0.4363323 -- math.rad(10)/ 0.3\n\
	elseif curSlot == 2 and actor:IsAnimationDone() then		--   \n\
		return false\n\
	end\n\
\n\
	if fRotRad ~= 0 then -- and accumTime - Nowaction:GetParamFloat(0) >= i1stAniTime/1000 then\n\
		actor:IncRotate( frameTime * fRotRad )	--  \n\
		iAccumAngle = iAccumAngle + frameTime * fRotRad\n\
	end\n\
\n\
	if iAccumAngle >= iTotalAngle and fRotRad ~= 0 then\n\
		actor:PlayNext()\n\
		fRotRad = 0\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_04_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_04_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("iAccumAngle = 0\n\
fRotRad = 0 \n\
iTotalAngle = 0		--    \n\
fBlockExploInter = 0.4		--     .\n\
\n\
function Act_SP_Attk_05_OnEnter(actor, action)\n\
	action:SetParam(0,0)\n\
	iAccumAngle = 0			--  \n\
	fRotRad = 0\n\
	if iExplotionNum > 0 then\n\
		iTotalAngle = math.rad(iExplotionNum * 10)\n\
	end\n\
	return true\n\
end\n\
--frameTime * 1    \n\
function Act_SP_Attk_05_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	Nowaction = actor:GetAction()					--    \n\
	curSlot = Nowaction:GetCurrentSlot()				--     \n\
\n\
	if Nowaction:GetParamFloat(0) == 0 then\n\
		Nowaction:SetParam(0, accumTime)\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then		--   \n\
		actor:PlayNext()\n\
--		fRotRad = -0.290888\n\
--		fRotRad = -0.581776 -- math.rad(10)/ 0.3\n\
		fRotRad = -0.4363323 -- math.rad(10)/ 0.4\n\
	elseif curSlot == 2 and actor:IsAnimationDone() then		--   \n\
		return false\n\
	end\n\
\n\
	if fRotRad ~= 0 then -- and accumTime - Nowaction:GetParamFloat(0) >= i1stAniTime/1000 then\n\
		actor:IncRotate( frameTime * fRotRad )	--  \n\
		iAccumAngle = iAccumAngle + frameTime * (fRotRad * -1)\n\
	end\n\
\n\
	if iAccumAngle >= iTotalAngle and fRotRad ~= 0 then\n\
		actor:PlayNext()\n\
		fRotRad = 0\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_05_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_05_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("iPreQuakeTime = 1.3	--     \n\
bPreQuake = false		\n\
\n\
function Act_SP_Attk_06_OnEnter(actor, action)\n\
	bPreQuake = false		\n\
	action:SetParam(0,0)\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_06_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	Nowaction = actor:GetAction()		--    \n\
	curSlot = Nowaction:GetCurrentSlot()	--     \n\
\n\
	if Nowaction:GetParamFloat(0) == 0 then\n\
		Nowaction:SetParam(0, accumTime)\n\
	elseif accumTime - Nowaction:GetParamFloat(0) > iPreQuakeTime and bPreQuake == false then\n\
		QuakeCamera(2.5, 1.0)\n\
		bPreQuake = true\n\
	elseif curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		return false					--   \n\
	end\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_06_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_06_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bQuakedByHand = false\n\
\n\
function Act_SP_Attk_07_OnEnter(actor, action)\n\
	action:SetParam(1,0)		--     \n\
	action:SetParam(0, 0)\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_07_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
		bQuakedByHand = false\n\
	elseif bQuakedByHand == false and (accumTime - action:GetParamFloat(1)) > 0.4 then\n\
		bQuakedByHand = true\n\
		if iDownPuppetID8%6 ~= 0 then\n\
			puppets[iDownPuppetID8]:AttachParticle(22344, \"block_s\", \"e_b_dragonsapphire_hand_attk\") \n\
		else\n\
			puppets[iDownPuppetID8]:AttachParticle(22344, \"block_b\", \"e_b_dragonsapphire_hand_attk\") \n\
		end\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		action:SetParam(0, accumTime)			--     \n\
		actor:PlayNext()\n\
		curSlot = action:GetCurrentSlot()	--     \n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	-- Idle  \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_07_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_07_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	bQuakedByHand = false\n\
	actor:SetAnimSpeed(1)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bQuakedByHand = false\n\
\n\
function Act_SP_Attk_08_OnEnter(actor, action)	\n\
	action:SetParam(1,0)		--     \n\
	action:SetParam(0, 0)\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_08_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	if tempTime == 0 then\n\
		tempTime = accumTime\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
		bQuakedByHand = false\n\
	elseif bQuakedByHand == false and (accumTime - action:GetParamFloat(1)) > 0.4 then\n\
		bQuakedByHand = true\n\
		if iDownPuppetID8%6 ~= 0 then\n\
			puppets[iDownPuppetID8]:AttachParticle(22344, \"block_s\", \"e_b_dragonsapphire_hand_attk\") \n\
		else\n\
			puppets[iDownPuppetID8]:AttachParticle(22344, \"block_b\", \"e_b_dragonsapphire_hand_attk\") \n\
		end\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		action:SetParam(0, accumTime)			--     \n\
		actor:PlayNext()\n\
		curSlot = action:GetCurrentSlot()	--     \n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	-- Idle  \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_08_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_08_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
\n\
	bQuakedByHand = false\n\
	actor:SetAnimSpeed(1)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bQuakedByHand = false\n\
iQuakedByHandTime = 1.867\n\
iGrapTime = 15			--     \n\
\n\
function Act_SP_Attk_09_OnEnter(actor, action)	\n\
	action:SetParam(1,0)		--     \n\
	action:SetParam(0, 0)\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_09_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
		bQuakedByHand = false\n\
	elseif bQuakedByHand == false and (accumTime - action:GetParamFloat(1)) > iQuakedByHandTime then\n\
		bQuakedByHand = true\n\
		if iDownPuppetID11%6 ~= 0 then\n\
			puppets[iDownPuppetID11]:AttachParticle(22344, \"block_s\", \"e_b_dragonsapphire_hand_attk\") \n\
		else\n\
			puppets[iDownPuppetID11]:AttachParticle(22344, \"block_b\", \"e_b_dragonsapphire_hand_attk\") \n\
		end\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		action:SetParam(0, accumTime)			--     \n\
		actor:PlayNext()\n\
		curSlot = action:GetCurrentSlot()	--     \n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_09_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_09_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("bQuakedByHand = false\n\
iQuakedByHandTime = 1.867\n\
iGrapTime = 15			--     \n\
\n\
function Act_SP_Attk_10_OnEnter(actor, action)	\n\
	action:SetParam(1,0)		--     \n\
	action:SetParam(0, 0)\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_10_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if action:GetParamFloat(1) == 0 then\n\
		action:SetParam(1, accumTime)\n\
		bQuakedByHand = false\n\
	elseif bQuakedByHand == false and (accumTime - action:GetParamFloat(1)) > iQuakedByHandTime then\n\
		bQuakedByHand = true\n\
		if iDownPuppetID11%6 ~= 0 then\n\
			puppets[iDownPuppetID11]:AttachParticle(22344, \"block_s\", \"e_b_dragonsapphire_hand_attk\") \n\
		else\n\
			puppets[iDownPuppetID11]:AttachParticle(22344, \"block_b\", \"e_b_dragonsapphire_hand_attk\") \n\
		end\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		action:SetParam(0, accumTime)			--     \n\
		actor:PlayNext()\n\
		curSlot = action:GetCurrentSlot()	--     \n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_10_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_10_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("iAccumAngle = 0\n\
fRotRad = 0 \n\
iTotalAngle = 0		--    \n\
fBlockExploInter = 0.4		--     .\n\
\n\
function Act_SP_Attk_11_OnEnter(actor, action)\n\
	action:SetParam(0,0)\n\
	action:SetParam(1,0.0)\n\
	iAccumAngle = 0			--  \n\
	fRotRad = 0\n\
	if iExplotionNum > 0 then\n\
		iTotalAngle = math.rad(iExplotionNum * 10)\n\
	end\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
--frameTime * 1    \n\
function Act_SP_Attk_11_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	Nowaction = actor:GetAction()		--    \n\
	curSlot = Nowaction:GetCurrentSlot()	--     \n\
\n\
	if Nowaction:GetParamFloat(0) == 0 then\n\
		Nowaction:SetParam(0, accumTime)\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		actor:PlayNext()\n\
--		fRotRad = 0.290888 -- math.rad(10)/ 0.6\n\
--		fRotRad = 0.581776 -- math.rad(10)/ 0.3\n\
		fRotRad = 0.4363323 -- math.rad(10)/ 0.3\n\
	elseif curSlot == 2 and actor:IsAnimationDone() then		--   \n\
		if iPunchBlockNum ~= -1 then\n\
			iAngle = iPunchBlockNum*360/iTotalBlock			--    \n\
			iRad = math.rad(iAngle)\n\
			LookPoint = Point3(math.cos(iRad),math.sin(iRad),0)\n\
			LookPoint:Unitize()					--  \n\
			LookPoint:SetX(LookPoint:GetX() * iBlockFromCentor)	--   .   \n\
			LookPoint:SetY(LookPoint:GetY() * iBlockFromCentor)	--   .   \n\
			LookPoint:SetZ(0)	--   .   \n\
\n\
			actor:LookAt(LookPoint)			--  \n\
		end\n\
\n\
		actor:PlayNext()\n\
		actor:SetAnimSpeed(fInterByMulti)\n\
		if Nowaction:GetParamFloat(1) == 0.0 then\n\
			Nowaction:SetParam(1, accumTime)\n\
			bQuakedByHand = false\n\
		end\n\
	elseif curSlot == 3 then\n\
		if actor:IsAnimationDone() then		--    \n\
			actor:PlayNext()\n\
			actor:SetAnimSpeed(1)\n\
			if iDownPuppetID4 ~= -1 then	-- \n\
  				puppets[iDownPuppetID4]:TransitAction(\"up\")\n\
				iDownPuppetID4 = -1\n\
	  		end\n\
		elseif bQuakedByHand == false and (accumTime - Nowaction:GetParamFloat(1)) > iQuakedByHandTime/4 then\n\
			bQuakedByHand = true		--  \n\
			actor:AttachParticle(12361, \"Bip01 L Finger2\", \"e_b_dragonsapphire_hand_attk\")\n\
		end\n\
	elseif curSlot == 4 then\n\
		if (accumTime - Nowaction:GetParamFloat(1)) >= iGrapTime then\n\
			actor:PlayNext()\n\
		end\n\
	elseif curSlot == 5 and actor:IsAnimationDone() then		--   \n\
		return false	\n\
	end\n\
\n\
	if fRotRad ~= 0 then -- and accumTime - Nowaction:GetParamFloat(0) >= i1stAniTime/1000 then\n\
		actor:IncRotate( frameTime * fRotRad )	--  \n\
		iAccumAngle = iAccumAngle + frameTime * fRotRad\n\
	end\n\
\n\
	if iAccumAngle >= iTotalAngle and fRotRad ~= 0 then\n\
		actor:PlayNext()\n\
		actor:SetAnimSpeed(fInterByMulti)	\n\
		fRotRad = 0\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_11_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_11_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("iAccumAngle = 0\n\
fRotRad = 0 \n\
iTotalAngle = 0		--    \n\
fBlockExploInter = 0.4		--     .\n\
\n\
function Act_SP_Attk_12_OnEnter(actor, action)\n\
	action:SetParam(0,0)\n\
	action:SetParam(1,0.0)\n\
	iAccumAngle = 0			--  \n\
	fRotRad = 0\n\
	if iExplotionNum > 0 then\n\
		iTotalAngle = math.rad(iExplotionNum * 10)\n\
	end\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
--frameTime * 1    \n\
function Act_SP_Attk_12_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	Nowaction = actor:GetAction()		--    \n\
	curSlot = Nowaction:GetCurrentSlot()	--     \n\
\n\
	if Nowaction:GetParamFloat(0) == 0 then\n\
		Nowaction:SetParam(0, accumTime)\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		actor:PlayNext()\n\
--		fRotRad = 0.290888 -- math.rad(10)/ 0.6\n\
--		fRotRad = 0.581776 -- math.rad(10)/ 0.3\n\
		fRotRad = -0.4363323 -- math.rad(10)/ 0.3\n\
	elseif curSlot == 2 and actor:IsAnimationDone() then		--   \n\
		if iPunchBlockNum ~= -1 then\n\
			iAngle = iPunchBlockNum*360/iTotalBlock			--    \n\
			iRad = math.rad(iAngle)\n\
			LookPoint = Point3(math.cos(iRad),math.sin(iRad),0)\n\
			LookPoint:Unitize()					--  \n\
			LookPoint:SetX(LookPoint:GetX() * iBlockFromCentor)	--   .   \n\
			LookPoint:SetY(LookPoint:GetY() * iBlockFromCentor)	--   .   \n\
			LookPoint:SetZ(0)	--   .   \n\
\n\
			actor:LookAt(LookPoint)			--  \n\
		end\n\
		actor:PlayNext()\n\
		actor:SetAnimSpeed(fInterByMulti)\n\
		if Nowaction:GetParamFloat(1) == 0.0 then\n\
			Nowaction:SetParam(1, accumTime)\n\
			bQuakedByHand = false\n\
		end\n\
	elseif curSlot == 3 then\n\
		if actor:IsAnimationDone() then		--    \n\
			actor:PlayNext()\n\
			actor:SetAnimSpeed(1)\n\
			if iDownPuppetID4 ~= -1 then	-- \n\
  				puppets[iDownPuppetID4]:TransitAction(\"up\")\n\
				iDownPuppetID4 = -1\n\
	  		end\n\
		elseif bQuakedByHand == false and (accumTime - Nowaction:GetParamFloat(1)) > iQuakedByHandTime/4 then\n\
			bQuakedByHand = true		--  \n\
			actor:AttachParticle(12361, \"Bip01 L Finger2\", \"e_b_dragonsapphire_hand_attk\")\n\
		end\n\
	elseif curSlot == 4 then\n\
		if (accumTime - Nowaction:GetParamFloat(1)) >= iGrapTime then\n\
			actor:PlayNext()\n\
		end\n\
	elseif curSlot == 5 and actor:IsAnimationDone() then		--   \n\
		return false	\n\
	end\n\
\n\
	if fRotRad ~= 0 then -- and accumTime - Nowaction:GetParamFloat(0) >= i1stAniTime/1000 then\n\
		actor:IncRotate( frameTime * fRotRad )	--  \n\
		iAccumAngle = iAccumAngle + frameTime * (fRotRad * -1)\n\
	end\n\
\n\
	if iAccumAngle >= iTotalAngle and fRotRad ~= 0 then\n\
		actor:PlayNext()\n\
		actor:SetAnimSpeed(fInterByMulti)\n\
		fRotRad = 0\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_12_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_12_OnLeave(actor, action)\n\
	if action:GetID() == \"a_dmg\" then\n\
		return false\n\
	end\n\
	\n\
	bQuakedByHand = false\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_SP_Attk_13_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_13_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Attk_13_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Attk_13_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
") );
	m_kContLuaText.push_back(std::string("function Act_SP_Appear_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_SP_Appear_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Appear_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Appear_OnLeave(actor, action)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_SP_Damage_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_SP_Damage_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Damage_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Damage_OnLeave(actor, action)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_SP_Die_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_SP_Die_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Die_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Die_OnLeave(actor, action)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_SP_Crystal_OnEnter(actor, action)\n\
   ODS(\"Act_SP_Crystal_OnEnter\\n\")\n\
	return true\n\
end\n\
\n\
function Act_SP_Crystal_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
      ODS(\" return false\\n\")\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_SP_Crystal_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_SP_Crystal_OnLeave(actor, action)\n\
   ODS(\"Act_SP_Crystal_OnLeave\\n\")\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_PAREL_Die_OnEnter(actor, action)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	\n\
	CallUI(\"FRM_MOVIE_IN\")\n\
	action:SetParamInt(0,0) --  ActionStep\n\
\n\
	\n\
	-- Slow Motion\n\
	local	fVelocity = action:GetScriptParamAsInt(\"VELOCITY\")\n\
	local	fInitVelocity = math.sqrt(2*-g_fGravity*fVelocity)\n\
	action:SetParamInt(1,0)	--	SlowMotion Step\n\
	action:SetParamFloat(2,fInitVelocity)	-- Initial Velocity\n\
	actor:FreeMove(true)\n\
	actor:StopJump()\n\
	actor:SetNoWalkingTarget(false)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local fAccumTime = g_world:GetAccumTime()\n\
	action:SetParamFloat(9,fAccumTime)\n\
	action:SetParamFloat(10,fAccumTime)\n\
	action:SetParamFloat(11,fAccumTime)\n\
	\n\
--	actor:StartGodTime(0)\n\
	actor:SetMovingDelta(Point3(0,0,0))\n\
	actor:SetCanHit(false)\n\
	actor:Concil(false)\n\
\n\
	actor:AttachParticle(9112,\"p_ef_heart\",\"ef_end_dem_01\");\n\
	actor:AttachParticle(9113,\"p_ef_heart\",\"ef_end_spot_01\");\n\
\n\
	g_world:SetUpdateSpeed(1)\n\
\n\
	g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
	, g_fChargeFocusFilterValue[2]\n\
	, g_fChargeFocusFilterValue[3]\n\
	, 0.2\n\
	,true\n\
	,true)\n\
\n\
	actor:ResetAnimation()\n\
	g_world:SetUpdateSpeed(0.0008)\n\
\n\
--	actor:AttachParticle(99, \"p_ef_center\", \"e_ef_parel_skill_04\")\n\
--	actor:AttachParticleToPoint(100, kCenter, \"e_ef_parel_die_01\")\n\
	return true\n\
end\n\
\n\
function Act_PAREL_Die_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	local action = actor:GetAction()		--    \n\
	if action:IsNil() == true then\n\
		ODS(\"[PAREL] Action Error\")\n\
		return false\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	\n\
	local ActionStep = action:GetParamInt(0)\n\
	local SlowStep = action:GetParamInt(1)\n\
	\n\
	local curSlot = action:GetCurrentSlot()	--     \n\
	\n\
	local	fTotalElapsedTime = action:GetParamFloat(9)\n\
	local	fTotalElapsedTime2 = accumTime - action:GetParamFloat(10)\n\
	local	fTotalPlayTime = 10\n\
	action:SetParamFloat(9,fTotalElapsedTime+frameTime)\n\
\n\
	if fTotalElapsedTime2 > fTotalPlayTime then\n\
		return false\n\
	end\n\
	\n\
	--	Slow Motion Processing\n\
	if 1 == SlowStep then\n\
	    local	fElapsedTime = GetAccumTime() - action:GetParamFloat(10)\n\
		local	fMaxSpeedTime = 4.0\n\
		local	fRate = fElapsedTime/fMaxSpeedTime;\n\
		if fRate> 1 then\n\
			fRate = 1\n\
		end\n\
\n\
		local fSpeed = fRate\n\
\n\
		if fRate<3.5 then\n\
			fSpeed = fSpeed*0.3\n\
		end\n\
\n\
		g_world:SetUpdateSpeed(fSpeed*0.995+0.005)\n\
\n\
		if fRate == 1.0 then\n\
			g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
			, g_world:GetWorldFocusFilterAlpha()\n\
			, 0\n\
			, 0.2\n\
			,false\n\
			,true)\n\
			\n\
			g_world:SetUpdateSpeed(1)\n\
			action:SetParamInt(1,2)\n\
		end\n\
	elseif 0 == SlowStep then\n\
	    local	fElapsedTime = GetAccumTime() - action:GetParamFloat(10)\n\
\n\
		if fElapsedTime > 1 then\n\
			action:SetParamFloat(10,GetAccumTime())\n\
			action:SetParamInt(1,1)\n\
		end\n\
		return true\n\
	end\n\
	\n\
	if 0 == ActionStep then\n\
	    if actor:IsAnimationDone() then\n\
			actor:PlayNext()\n\
			action:SetParamInt(0,1)\n\
		end\n\
	end\n\
	\n\
	if 2 > ActionStep then\n\
	    local	kMovingDir = actor:GetLookingDir()\n\
		local	fZ_Velocity_Init = action:GetParamFloat(2)\n\
		local	fZ_Velocity = g_fGravity*(0.5*frameTime+fTotalElapsedTime)+fZ_Velocity_Init\n\
		kMovingDir:SetZ(fZ_Velocity);\n\
\n\
		if kMovingDir:GetX() > 0 then\n\
			g_meleedrop = g_meleedrop+1\n\
			if g_meleedrop == 2 then\n\
				g_meleedrop = 0\n\
			end\n\
		end\n\
\n\
		if action:GetScriptParam(\"NO_HORI_MOVE\") ~= \"TRUE\" then\n\
			kMovingDir:SetX(kMovingDir:GetX()*-1*g_fBlowUpHorizonSpeed)\n\
			kMovingDir:SetY(kMovingDir:GetY()*-1*g_fBlowUpHorizonSpeed)\n\
		end\n\
		actor:SetMovingDelta(kMovingDir)\n\
	elseif 2 == ActionStep then\n\
	    local	kMovingDir = actor:GetLookingDir()\n\
		local	fZ_Velocity_Init = action:GetParamFloat(2)\n\
		local	fZ_Velocity = g_fGravity*(0.5*frameTime+fTotalElapsedTime)+fZ_Velocity_Init\n\
		kMovingDir:SetZ(fZ_Velocity)\n\
		\n\
		if action:GetScriptParam(\"NO_HORI_MOVE\") ~= \"TRUE\" then\n\
			kMovingDir:SetX(kMovingDir:GetX()*-1*g_fBlowUpHorizonSpeed*0.2);\n\
			kMovingDir:SetY(kMovingDir:GetY()*-1*g_fBlowUpHorizonSpeed*0.2);\n\
\n\
		end\n\
		actor:SetMovingDelta(kMovingDir)\n\
	elseif 3 == ActionStep then\n\
	    actor:SetDownState(false);\n\
		action:StartTimer(100000,0.5,0)\n\
		action:SetParamFloat(5,accumTime)\n\
		action:SetParamInt(0,4)\n\
		return	true\n\
	elseif 4 == ActionStep then\n\
	\n\
	    	--   \n\
	    	local kTargetPos= actor:GetTranslate()\n\
			local guid = GUID(\"\")\n\
			guid:Generate()\n\
			local kCubeParel = g_pilotMan:NewPilot(guid, 100057, 0)\n\
			local kCubeParelActor = kCubeParel:GetActor()\n\
			if kCubeParelActor:IsNil() == true then\n\
				ODS(\"[PAREL] CubeParel Generate Error\\n\")\n\
				return false\n\
			end\n\
			g_world:AddActor(guid, kCubeParelActor, Point3(kTargetPos:GetX(),kTargetPos:GetY(), 150 ), 6) -- NPC Create\n\
			kCubeParelActor:SetClonePos(actor)\n\
			kCubeParelActor:ClearActionState()\n\
			kCubeParelActor:SetTargetAnimation(\"die\")\n\
			kCubeParelActor:AttachParticle(99, \"char_root\", \"e_ef_parel_die_01\")\n\
\n\
			action:SetParamFloat(5, accumTime)	--  \n\
			action:SetParamInt(0,5)\n\
	elseif 5 == ActionStep then\n\
	    local fTime = accumTime - action:GetParamFloat(5)\n\
	    if fTime > 8.0 then\n\
   			return false\n\
		elseif fTime > 0.5 then\n\
		    actor:SetHide(true)\n\
		    actor:SetCanHit(false)\n\
		end\n\
	end\n\
\n\
 	if actor:IsMeetFloor() == true then\n\
\n\
		if 1 == ActionStep then\n\
\n\
			local	fVelocity = action:GetScriptParamAsInt(\"VELOCITY\")*g_fBlowUpSecondJumpPower;\n\
			local	fInitVelocity = math.sqrt(2*-g_fGravity*fVelocity);\n\
\n\
			action:SetParamFloat(2,fInitVelocity);	-- Initial Velocity\n\
			action:SetParamFloat(9,0);\n\
			action:SetParamInt(0,2);\n\
			\n\
			local pt = actor:GetTranslate()\n\
			pt:SetZ(pt:GetZ() - 30)\n\
			actor:AttachParticleToPoint(200, pt, \"e_jump\")\n\
			actor:SetBlowUp(false)\n\
		elseif 2 == ActionStep then\n\
\n\
			local pt = actor:GetTranslate()\n\
			pt:SetZ(pt:GetZ() - 30)\n\
			actor:AttachParticleToPoint(201, pt, \"e_jump\")\n\
			action:SetParamInt(0,3);\n\
			actor:SetSendBlowStatus(false, true)\n\
			actor:SetDownState(true)\n\
		end\n\
		\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_PAREL_Die_OnCleanUp(actor, action)\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	if( CheckNil(g_world == nil) ) then return true end\n\
	if( CheckNil(g_world:IsNil()) ) then return true end\n\
	\n\
    g_world:SetUpdateSpeed(1)\n\
	g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
				, g_world:GetWorldFocusFilterAlpha()\n\
				, 0\n\
				, 0.2\n\
				,false\n\
				,true)\n\
\n\
	actor:Concil(true)\n\
	actor:SetBlowUp(false)\n\
	actor:SetDownState(false)\n\
	actor:FreeMove(false)\n\
end\n\
\n\
function Act_PAREL_Die_OnLeave(actor, action)\n\
	CallUI(\"FRM_MOVIE_OUT\")\n\
	\n\
	actor:SetSendBlowStatus(false)\n\
	\n\
	--  \n\
--	g_world:RemoveActorOnNextUpdate(actor:GetPilotGuid())\n\
	return true\n\
end\n\
\n\
function Act_PAREL_Die_OnTimer(actor,accumTime,action,timerid)\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_PAREL_JumpAttack_OnEnter(actor,action)\n\
--	actor:StopJump()\n\
--	actor:ResetAnimation()\n\
	\n\
	local ptTargetPos = actor:GetPos()\n\
	ptTargetPos:SetZ(ptTargetPos:GetZ())\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat()+25)\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		-- Look at targetpos\n\
		\n\
		actor:LookAt(ptTargetPos,true,false)\n\
	\n\
		actor:SetWalkingTargetLoc(ptTargetPos,true)\n\
		actor:StartBodyTrail(\"../Data/5_Effect/9_Tex/swift_01.tga\",300,50,0)\n\
		\n\
		action:SetParamInt(0,0)	--	State\n\
		action:SetParamAsPoint(0,actor:GetWalkingTargetLoc())\n\
		action:SetParamFloat(1,-100)\n\
  		actor:AttachParticleToPointS(299,ptTargetPos,\"e_ef_colorshadow_monster\",2.5)\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_PAREL_JumpAttack_OnEvent(actor,textkey)\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if action:GetParamInt(0) == 0 then\n\
		if textkey == \"fly\" or textkey == \"end\" then\n\
--		    WriteToConsole(\"Act_PAREL_JumpAttack_OnEvent:\"..textkey..\"\\n\")\n\
			action:SetParamInt(0,1)\n\
		end\n\
	end	\n\
	return	true	\n\
end\n\
\n\
function Act_PAREL_JumpAttack_OnCastingCompleted(actor, action)\n\
	    Act_PAREL_Clear(actor)\n\
	    \n\
	    action:SetSlot(1)\n\
		actor:ResetAnimation()\n\
		actor:PlayCurrentSlot()\n\
		\n\
		action:SetParamInt(0,4)\n\
		local kPos = g_world:FindActorFloorPos(action:GetParamAsPoint(0))\n\
  		actor:SetTranslate(kPos)\n\
  		actor:AttachParticleToPoint(300,kPos,\"e_ef_parel_skill_04\")\n\
		QuakeCamera(0.5,5,0,0.1,5)\n\
		Act_Mon_Melee_DoDamage(actor,action)\n\
		actor:AttachSound(1158,\"Samb_start\")\n\
end\n\
\n\
function Act_PAREL_JumpAttack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local action = actor:GetAction()\n\
	local ptTargetPos = action:GetParamAsPoint(0) --TargetPos\n\
	\n\
--	WriteToConsole(\"Update TargetPos: \" .. ptTargetPos:GetX() .. \", \" .. ptTargetPos:GetY() .. \", \" .. ptTargetPos:GetZ() ..\"\\n\")\n\
  	local ActionState = action:GetParamInt(0)\n\
  	local oldPosZ = action:GetParamFloat(1)\n\
	local fVal = action:GetParamFloat(2)\n\
\n\
	if 0 == ActionState then\n\
	\n\
	elseif 1 == ActionState then-- 	 \n\
		--  \n\
			\n\
		action:SetParamFloat(1,actor:GetPos():GetZ())	--	Now Height\n\
		\n\
		local fVal = actor:StartTeleJump(ptTargetPos,400)\n\
		ptTargetPos:Subtract(actor:GetTranslate())\n\
		ptTargetPos:SetZ(0)\n\
		\n\
		local fDistance = ptTargetPos:Length()\n\
		action:SetParamFloat(2, math.abs(fVal))\n\
--		actor:SetAdjustValidPos(false)\n\
--		actor:SetForcePos(false)\n\
\n\
--		actor:SetActiveGrp(PG_PHYSX_GROUP_BASE_WALL, false)\n\
--		actor:LockBidirection(false)\n\
\n\
		action:SetParamInt(0,2)	--	State\n\
		\n\
	elseif 2 == ActionState then\n\
\n\
	    local NowPos = actor:GetTranslate()\n\
		actor:Walk(DIR_NONE, fVal, frameTime)\n\
		\n\
		local kNowPosZ = NowPos:GetZ()\n\
		if oldPosZ > kNowPosZ then\n\
			--   .\n\
			actor:PlayNext()\n\
			action:SetParamInt(0,3)\n\
		end\n\
		action:SetParamFloat(1,kNowPosZ)\n\
		\n\
	elseif 3 == ActionState then --  \n\
\n\
        local kWaitPos = ptTargetPos\n\
		kWaitPos:SetZ(oldPosZ)\n\
	    local NowPos = actor:GetTranslate()\n\
		actor:Walk(DIR_NONE, fVal, frameTime)\n\
		NowPos:SetZ(oldPosZ)\n\
--		actor:SetTranslate(kWaitPos)\n\
		\n\
--		local kPos = g_world:FindActorFloorPos(kWaitPos)\n\
\n\
--		return false\n\
	elseif 4 == ActionState then\n\
 	-- FireSkill\n\
		--  \n\
		\n\
		if actor:IsAnimationDone() then\n\
			actor:PlayNext()\n\
			action:SetParamInt(0,5)\n\
		end\n\
--		return false\n\
--	else\n\
--		if actor:IsAnimationDone() then\n\
--			return false\n\
--		end\n\
	elseif 5 == ActionState then\n\
		if actor:IsAnimationDone() then\n\
			return false\n\
		end\n\
	end	\n\
	return true\n\
end\n\
\n\
function Act_PAREL_Clear(actor)\n\
	WriteToConsole(\"Clear : \" .. actor:GetPos():GetX() ..  \"/\" .. actor:GetPos():GetY() .. \"/\" .. actor:GetPos():GetZ() .. \"\\n\")\n\
--	local targetDir = Point3(curAction:GetParamFloat(5), curAction:GetParamFloat(6), 0)\n\
--	actor:SetLookingDirection(actor:GetDirFromMovingVector(targetDir))\n\
\n\
	actor:SetNoWalkingTarget(false)\n\
--	actor:SetAdjustValidPos(true)\n\
--	actor:SetForcePos(true)\n\
	actor:EndBodyTrail()\n\
	actor:StopJump()\n\
	actor:ResetJumpAccumHeight()\n\
--	actor:SetActiveGrp(PG_PHYSX_GROUP_BASE_WALL, true)\n\
	actor:SetMeetFloor(true)\n\
	actor:FindPathNormal()\n\
--	actor:RestoreLockBidirection()\n\
end\n\
\n\
function Act_PAREL_JumpAttack_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_PAREL_JumpAttack_OnLeave(actor, action)\n\
	if action:GetParamInt(0) > 3 then\n\
    	actor:DetachFrom(299)\n\
		actor:DetachFrom(300)\n\
	else\n\
	end\n\
	return true\n\
end\n\
\n\
\n\
") );
	m_kContLuaText.push_back(std::string("function nop()\n\
end\n\
\n\
function lavalon_start()\n\
--	local packet = NewPacket(30101)\n\
--	packet:PushInt(1)\n\
--	packet:PushBool(true)\n\
\n\
--	Net_Send(packet)\n\
--	DeletePacket(packet)\n\
end\n\
\n\
\n\
function Act_LAVALON_Appear_OnEnter(actor, action)\n\
\n\
    Common_ManualOpening_Enter(actor,action)\n\
--	CallUI(\"FRM_MOVIE_IN\")\n\
--	CallUI(\"FRM_Lavalon\")\n\
--	CloseUI(\"FRM_MINIMAP\")\n\
--	CloseUI(\"FRM_SHINESTONE_MAIN\")\n\
\n\
	g_lavalon = actor\n\
	actor:FreeMove(false)\n\
	actor:LockBidirection(false)\n\
	actor:SeeFront(true, true)\n\
	actor:FindPathNormal()\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:SetCameraModeMovie(2, 1000000, \"nop()\")\n\
	QuakeCamera(15,0.5,1)\n\
\n\
--	LockPlayerInput()\n\
	\n\
	-- Esc Script Regist\n\
--	RegistESCScript(\"OnEsc_LavalonOpening\")\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Appear_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	actor:SeeFront(true)\n\
\n\
	local action = actor:GetAction()		--    \n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if 0 == action:GetParamFloat(124) then\n\
		action:SetParamFloat(124, accumTime)\n\
	end\n\
	local fCurAccumTime = (accumTime - action:GetParamFloat(124)) * 2000\n\
	\n\
	local kDropTime = action:GetParamFloat(123) + frameTime\n\
	action:SetParamFloat(123, kDropTime)\n\
	\n\
	if 14000 > fCurAccumTime and kDropTime * 1000 > math.random() * fCurAccumTime + 330 then\n\
		Meteor_Client_Only_Count(1, 2)\n\
		action:SetParamFloat(123, 0)\n\
	end\n\
	\n\
	if action:GetParamInt(81) == 1 then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
	    if true == g_world:IsEndShowWorldFocusFilter() then\n\
	        return false\n\
	    end\n\
	    return true\n\
	end\n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then\n\
  		Common_ManualOpening_End(actor,action)\n\
	end\n\
	\n\
	if KeyIsDown(KEY_ESC) then\n\
        Common_ManualOpening_End(actor,action)\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Appear_OnCleanUp(actor, action)\n\
	--   .\n\
	CloseUI(\"FRM_Lavalon\")\n\
	Common_ManualOpening_Leave(actor,action)\n\
	\n\
--	local kPacket = NewPacket(13201) -- PT_C_M_REQ_INDUN_START\n\
--	Net_Send(kPacket)\n\
--	DeletePacket(kPacket)\n\
end\n\
\n\
function Act_LAVALON_Appear_OnLeave(actor, action)\n\
\n\
--	SetBossGUIDForHPBar(actor:GetPilotGuid())\n\
--	UnLockPlayerInput()\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Appear_OnEvent(actor, textKey, seqID)\n\
\n\
	--ODS(\"_________________Lavalon Appear Event_________________\\n\")\n\
\n\
	if textKey == \"quake_01\" or\n\
		textKey == \"quake_02\" then\n\
		QuakeCamera(0.7, 2, 1, 1, 1)\n\
		Meteor_Client_Only_Count(2, 4)\n\
	elseif textKey == \"quake_03\" or\n\
		textKey == \"quake_04\" then\n\
		--ODS(\"_________Quake Camera 3,4__________\\n\")\n\
		Meteor_Client_Only_Count(3, 5)\n\
		QuakeCamera(0.7, 5, 1, 1, 1)\n\
	end\n\
	ODS( GetAccumTime() .. \" \" .. textKey .. \"\\n\", false, 998)\n\
	return true\n\
end\n\
\n\
function Meteor_Client_Only_Count(iMin, iMax)\n\
	local iCount = math.random(iMin, iMax)\n\
	local iCurCount = 0\n\
	while iCount > iCurCount do\n\
		Meteor_Client_Only()\n\
		iCurCount = iCurCount + 1\n\
	end\n\
end\n\
\n\
function Meteor_Client_Only()\n\
	-- Meteor  ..\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kTopLeft = g_world:GetObjectPosByName(\"pt_blaze_01\")		-- Top Left\n\
	local kTopRight = g_world:GetObjectPosByName(\"pt_blaze_02\")	-- Top Right\n\
	local kBottomLeft = g_world:GetObjectPosByName(\"pt_blaze_03\")	-- Bottom Left\n\
	local kBottomRight = g_world:GetObjectPosByName(\"pt_blaze_04\")	-- Bottm Right\n\
\n\
	--      .\n\
	local firstPos = kTopRight:_Subtract(kTopLeft)\n\
	firstPos = firstPos:_Multiply(math.random())\n\
	firstPos = firstPos:_Add(kTopLeft)\n\
	--ODS( GetAccumTime() .. \" 1. Meteor_Client_Only ......... X:\" .. firstPos:GetX() .. \", Y:\" .. firstPos:GetY() .. \", Z:\" .. firstPos:GetZ() .. \"\\n\", false, 998)\n\
\n\
	local secondPos = kBottomRight:_Subtract(kBottomLeft)\n\
	secondPos = secondPos:_Multiply(math.random())\n\
	secondPos = secondPos:_Add(kBottomLeft)\n\
	--ODS( GetAccumTime() .. \" 2. Meteor_Client_Only ......... X:\" .. secondPos:GetX() .. \", Y:\" .. secondPos:GetY() .. \", Z:\" .. secondPos:GetZ() .. \"\\n\", false, 998)\n\
\n\
	local finalPos = firstPos:_Subtract(secondPos)\n\
	finalPos = finalPos:_Multiply(math.random())\n\
	finalPos = finalPos:_Add(secondPos)\n\
	--ODS( GetAccumTime() .. \" f. Meteor_Client_Only ......... X:\" .. finalPos:GetX() .. \", Y:\" .. finalPos:GetY() .. \", Z:\" .. finalPos:GetZ() .. \"\\n\", false, 998)\n\
\n\
	local kFinalPos = g_world:ThrowRay(finalPos, Point3(0,0,-1), 500)\n\
	\n\
	--ODS( GetAccumTime() .. \" F. Meteor_Client_Only ......... X:\" .. kFinalPos:GetX() .. \", Y:\" .. kFinalPos:GetY() .. \", Z:\" .. kFinalPos:GetZ() .. \"\\n\", false, 998)\n\
	\n\
	local kProjectileMan = GetProjectileMan()\n\
	local kNewArrow = kProjectileMan:CreateNewProjectile(\"Projectile_Lavalon_Meteor\", GetDummyAction(), GUID(0))\n\
\n\
	if kNewArrow:IsNil() == true then\n\
		return false\n\
	end\n\
\n\
	kNewArrow:SetParamValue(\"EXTENSION\", 0)\n\
\n\
	local kInitPos = Point3(kFinalPos:GetX(), kFinalPos:GetY(), kFinalPos:GetZ() + 400)\n\
	kInitPos:SetX(kInitPos:GetX() + math.random(-20, 20))\n\
	if math.random(100) > 50 then\n\
		kInitPos:SetY(kInitPos:GetY() + math.random(-20, 20))\n\
	end\n\
	kInitPos:SetZ(kInitPos:GetZ() + math.random(0, 400))\n\
	kNewArrow:LoadToPosition(kInitPos)\n\
\n\
	kNewArrow:SetTargetLoc(kFinalPos)\n\
	kNewArrow:Fire()\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("local iExplosionParticleTargetRadius = 79\n\
local iExplosionParticleRadius = 100--110\n\
local iExplosionTerm = 1\n\
\n\
function Act_LAVALON_Blaze_OnEnter(actor, action)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kTopLeft = g_world:GetObjectPosByName(\"pt_blaze_01\")		-- Top Left\n\
	local kTopRight = g_world:GetObjectPosByName(\"pt_blaze_02\")	-- Top Right\n\
	local kBottomLeft = g_world:GetObjectPosByName(\"pt_blaze_03\")	-- Bottom Left\n\
	local kBottomRight = g_world:GetObjectPosByName(\"pt_blaze_04\")	-- Bottm Right\n\
\n\
	--				1\n\
	--     	---------------------\n\
	--     	|					|\n\
	--	4	|					|    2\n\
	--		|					|\n\
	--		|					|\n\
	--		|					|\n\
	--     	---------------------\n\
	--				3\n\
\n\
	local kUpperBase = kTopRight:_Subtract(kTopLeft)\n\
	local kRightBase = kTopRight:_Subtract(kBottomRight)\n\
	local kBottomBase = kBottomRight:_Subtract(kBottomLeft)\n\
	local kLeftBase = kTopLeft:_Subtract(kBottomLeft)\n\
\n\
	local akBasePos = {kTopLeft, kBottomRight, kBottomLeft, kBottomLeft}\n\
	local akAlpha = {kUpperBase, kRightBase, kBottomBase, kLeftBase}\n\
	\n\
	local iNbLine = kPacket:PopInt()\n\
	--ODS(\"________________NbLine ___________ : \" ..  iNbLine ..\"\\n\")\n\
--	local iNbLine = 3\n\
	action:SetParamInt(0, iNbLine)\n\
	local iLineIndex = 0\n\
\n\
	local iCount = 1\n\
	while iNbLine > iLineIndex do\n\
		local fMetaForStart = kPacket:PopFloat()\n\
		local fMetaForEnd = kPacket:PopFloat()\n\
		--ODS(\"________________Start___________ : \" ..  fMetaForStart ..\"\\n\")\n\
		--ODS(\"________________End ___________ : \" ..  fMetaForEnd ..\"\\n\")\n\
		--local fMetaForStart = math.random() + math.random(1, 2) \n\
		--local fMetaForEnd = math.random() + math.random(3, 4)\n\
\n\
		local kStartPos = akAlpha[math.floor(fMetaForStart)]:_Multiply(fMetaForStart - math.floor(fMetaForStart))\n\
		kStartPos = kStartPos:_Add(akBasePos[math.floor(fMetaForStart)])\n\
		kStartPos:SetZ(0)\n\
\n\
		local kEndPos = akAlpha[math.floor(fMetaForEnd)]:_Multiply(fMetaForEnd - math.floor(fMetaForEnd))\n\
		kEndPos = kEndPos:_Add(akBasePos[math.floor(fMetaForEnd)])\n\
		kEndPos:SetZ(0)\n\
\n\
		action:SetParamAsPoint(iLineIndex * 2 + 1, kStartPos)\n\
		action:SetParamAsPoint(iLineIndex * 2 + 2, kEndPos)\n\
		\n\
		local kWarnVector = kEndPos:_Subtract(kStartPos)\n\
		local fIncValue = iExplosionParticleTargetRadius / kWarnVector:Length()\n\
\n\
		local kProgress = 0\n\
		while kProgress < 1.0 do\n\
			local kWarnPos = kWarnVector:_Multiply(kProgress)\n\
			kWarnPos:Add(kStartPos)\n\
			kWarnPos:SetZ(kWarnPos:GetZ() + 100)\n\
			\n\
			local kFloorPos = g_world:ThrowRay(kWarnPos, Point3(0,0,-1), 200)\n\
			if -1 ~= kFloorPos:GetX() and -1 ~= kFloorPos:GetY() and -1 ~= kFloorPos:GetZ() then\n\
				GetPlayer():AttachParticleToPointS(90000 + iCount, kFloorPos, \"e_ef_fossilearth_target_01\", 1.0)\n\
			end\n\
			kProgress = kProgress + fIncValue\n\
			iCount = iCount + 1\n\
		end\n\
		\n\
		\n\
		iLineIndex = iLineIndex + 1\n\
	end\n\
\n\
	action:DeleteParamPacket()\n\
\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Blaze_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	actor:SeeFront(true, true)\n\
\n\
	local action = actor:GetAction()		--    \n\
	local actionParam = action:GetActionParam()\n\
	local curSlot = action:GetCurrentSlot()	--     \n\
	local curStage = action:GetCurrentStage()\n\
\n\
	local iNbExp = action:GetParamInt(0)\n\
	if actor:IsAnimationDone() == true then\n\
		if curSlot == 0 then\n\
			actor:PlayNext()\n\
		elseif curSlot == 2 and\n\
			curStage > iNbExp and\n\
			action:GetParam(219857) == \"TheEnd\" then\n\
			--  .\n\
			return false\n\
		end\n\
	elseif actionParam == AP_CASTING and\n\
		curSlot == 1 then\n\
		return true\n\
	end\n\
\n\
	--    .\n\
	if curStage >= 1 and actionParam == AP_FIRE then\n\
\n\
		--   .\n\
		--     !\n\
		local kLastExplosionTime = action:GetParamInt(982389);\n\
		local iNbExp = action:GetParamInt(0)\n\
		local iNbIdx = 0\n\
\n\
		local iStartParticleIDX = action:GetParamInt(90000)\n\
		if kLastExplosionTime == 0 or\n\
			iExplosionTerm < math.floor(accumTime * 1000 - kLastExplosionTime) then\n\
	\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			while iNbIdx < iNbExp and curStage <= iNbExp do\n\
				local kStartPos = action:GetParamAsPoint(iNbIdx * 2 + 1)\n\
				local kEndPos = action:GetParamAsPoint(iNbIdx * 2 + 2)\n\
\n\
				local kProgress = 0.0\n\
				while kProgress < 1.0 do\n\
					local kExplosionVector = kEndPos:_Subtract(kStartPos)\n\
					local kExpPos = kExplosionVector:_Multiply(kProgress)\n\
					kExpPos:Add(kStartPos)\n\
					kExpPos:SetZ(kExpPos:GetZ() + 100)\n\
					\n\
					local kFloorPos = g_world:ThrowRay(kExpPos, Point3(0,0,-1), 200)\n\
					if -1 ~= kFloorPos:GetX() and -1 ~= kFloorPos:GetY() and -1 ~= kFloorPos:GetZ() then\n\
						local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
						if Effect == nil or Effect == \"\" then\n\
							Effect = \"e_ef_fossilearth_explosion\"\n\
						end\n\
\n\
						if Effect ~= \"NONE\" then\n\
							GetPlayer():AttachParticleToPointS(90000+iStartParticleIDX, kFloorPos, Effect, 1.0)\n\
						end\n\
					end\n\
					\n\
					kProgress = math.min(kProgress + iExplosionParticleRadius / kExplosionVector:Length(), 1.0)\n\
					iStartParticleIDX = iStartParticleIDX + 1\n\
				end\n\
				action:NextStage()\n\
				iNbIdx = iNbIdx + 1\n\
			end\n\
		\n\
			action:SetParamInt(982389, math.floor(accumTime * 1000))\n\
\n\
			if curStage > iNbExp then\n\
				-- Action .\n\
				action:SetParam(219857 , \"TheEnd\")\n\
			\n\
				local kTargetList = action:GetTargetList()\n\
				kTargetList:ApplyActionEffects()\n\
			end\n\
		end\n\
		action:SetParamInt(90000, iStartParticleIDX)\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_Blaze_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Blaze_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
\n\
function Act_LAVALON_Blaze_OnCastingCompleted(actor, action)\n\
	--ODS(\"____________Lavalon Blaze OnCastingComplete \\n\")\n\
	action:SetSlot(2)\n\
	actor:PlayCurrentSlot()\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Blaze_OnEvent(actor, textKey, seqID)\n\
\n\
	if textKey == \"hit\" then\n\
		--ODS(\"____________Lavalon Blaze OnEvent : hit \" .. textKey .. \"\\n\")\n\
		local kAction = actor:GetAction()\n\
		kAction:NextStage()\n\
		QuakeCamera(1,1,1,1,1)\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_LAVALON_Blaze_OnTargetListModified(actor,action,bIsBefore)\n\
	Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_breath_c_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_c_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	actor:SeeFront(true)\n\
	\n\
	local action = actor:GetAction()		--    \n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 then\n\
		actor:PlayNext()\n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_breath_c_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_c_OnLeave(actor, action)\n\
	--actor:DetachFrom(12985)\n\
	return true\n\
end\n\
\n\
\n\
function Act_LAVALON_breath_c_OnEvent(actor, textkey, seq)\n\
	if textkey == \"hit\" then\n\
--		actor:AttachParticle(12985, \"p_ef_head\", \"e_ef_fossilearth_breath\")\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_c_OnCastingCompleted(actor, action)\n\
	return true\n\
end\n\
\n\
function  Act_LAVALON_breath_c_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    ODS(\"Act_LAVALON_breath_c_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_breath_l_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_l_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	actor:SeeFront(true)\n\
	\n\
	local action = actor:GetAction()		--    \n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 then\n\
		actor:PlayNext()\n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_breath_l_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
function Act_LAVALON_breath_l_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_l_OnEvent(actor, textkey, seq)\n\
	if textkey == \"hit\" then\n\
--		actor:AttachParticle(12985, \"p_ef_head\", \"e_ef_fossilearth_breath\")\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_l_OnCastingCompleted(actor, action)\n\
	return true\n\
end\n\
\n\
function  Act_LAVALON_breath_l_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    ODS(\"Act_LAVALON_breath_l_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_breath_r_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_r_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	actor:SeeFront(true)\n\
	\n\
	local action = actor:GetAction()		--    \n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 then\n\
		actor:PlayNext()\n\
	elseif curSlot == 1 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_breath_r_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_r_OnLeave(actor, action)\n\
	--actor:DetachFrom(12985)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_r_OnEvent(actor, textkey, seq)\n\
	if textkey == \"hit\" then\n\
--		actor:AttachParticle(12985, \"p_ef_head\", \"e_ef_fossilearth_breath\")\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_breath_r_OnCastingCompleted(actor, action)\n\
	return true\n\
end\n\
\n\
function  Act_LAVALON_breath_r_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
    ODS(\"Act_LAVALON_breath_r_OnTargetListModified\\n\");\n\
    \n\
    if bIsBefore == false then\n\
        --  .\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_Die_OnEnter(actor, action)\n\
	CallUI(\"FRM_MOVIE_IN\")\n\
	CloseUI(\"FRM_BAR_BOSS\")\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:SetCameraModeMovie(2, 1000002, \"nop()\")\n\
	LockPlayerInputMove(6) -- for lavalon die lock\n\
	LockPlayerInput(6)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Die_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		SetBreak()\n\
		return false\n\
	end\n\
	\n\
	actor:SeeFront(true)\n\
	\n\
	local action = actor:GetAction()		--    \n\
	local kEnd = action:GetParam(219)\n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then\n\
		if kEnd == \"null\" then	--   \n\
			--actor:SetTargetAlpha(actor:GetAlpha(),0.0, 2.0)\n\
			action:SetParam(219, 1)\n\
			return true \n\
		elseif actor:IsAlphaTransitDone() and\n\
			kEnd == \"1\" then\n\
			CallUI(\"FRM_MOVIE_OUT\")\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			g_world:SetCameraMode(8, GetPlayer())\n\
			action:SetParam(219, 2)\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_Die_OnCleanUp(actor, action)\n\
\n\
	UnLockPlayerInputMove(6) -- for lavalon die lock\n\
	UnLockPlayerInput(6)\n\
	\n\
	return true\n\
end\n\
function Act_LAVALON_Die_OnLeave(actor, action)\n\
\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Die_OnEvent(actor, textKey, seqID)\n\
\n\
	if textKey == \"quake\" then\n\
		QuakeCamera(2,1,1,1,1)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_Dmg_OnEnter(actor, action)\n\
	actor:DetachFrom(12985)	--       .\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Dmg_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	actor:SeeFront(true)\n\
	\n\
	local action = actor:GetAction()		--    \n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if actor:IsAnimationDone() then\n\
		if curSlot >= action:GetSlotCount() - 1 then\n\
			return false\n\
		else\n\
			actor:PlayNext()\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_Dmg_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Dmg_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Dmg_OnEvent(actor, textKey, seqID)\n\
\n\
	if textKey == \"hit\" then\n\
\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_Powerbreak_OnEnter(actor, action)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
\n\
\n\
	--     	---------------------\n\
	--     	|					|\n\
	--	0	|					|    1\n\
	--		|					|\n\
	--		|					|\n\
	--		|					|\n\
	--     	---------------------\n\
	--				2\n\
	--\n\
\n\
	--   .`\n\
	local iIndex = kPacket:PopInt()\n\
	action:SetParamInt(5, iIndex)\n\
	action:DeleteParamPacket()\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Powerbreak_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	actor:SeeFront(true)\n\
	\n\
	local action = actor:GetAction()		--    \n\
	local curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if actor:IsAnimationDone() then\n\
		if curSlot == 0 then\n\
			actor:PlayNext()\n\
		elseif curSlot == 2 then\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_LAVALON_Powerbreak_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Powerbreak_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Powerbreak_OnCastingCompleted(actor, action)\n\
	ODS(\"__________________Powerbreak Casting completed____________________\\n\")\n\
	action:SetSlot(2)\n\
	actor:PlayCurrentSlot()\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_Powerbreak_OnEvent(actor, textKey, seqID)\n\
\n\
	if textKey == \"hit\" then\n\
		local action = actor:GetAction()\n\
		local iIndex = action:GetParamInt(5)\n\
\n\
		--if LavPuppets[iIndex] ~= nil then\n\
		--	LavPuppets[iIndex]:TransitAction(\"dmg\")\n\
		--	g_world:SetActivePhysXGroup(1, iIndex + 6, false)\n\
		--	--    ..\n\
			local kTargetList = action:GetTargetList()\n\
			kTargetList:ApplyActionEffects()\n\
		--end\n\
		QuakeCamera(1,1,1,1,1)\n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function MagicCannon_Shot_OnCheckCanEnter(kActor, kAction)\n\
	return true\n\
end\n\
\n\
function MagicCannon_Shot_OnCastingCompleted(kActor, kAction)\n\
	return true\n\
end\n\
\n\
function MagicCannon_Shot_SetState(kActor,kAction,kState)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_SetState ......\" .. kState .. \"\\n\", false, 998 )\n\
	local	iNewState = -1\n\
	if kState == \"FIRE\" then\n\
		if kActor:GetAnimationLength(kAction:GetSlotAnimName(0)) == 0 then\n\
			return	false\n\
		end\n\
		kAction:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"RETURN\" then\n\
		kAction:SetSlot(1)\n\
		iNewState = 1\n\
	end\n\
	\n\
	kActor:ResetAnimation()\n\
	kActor:PlayCurrentSlot()\n\
	kAction:SetParamInt(0,iNewState)\n\
	\n\
	return true\n\
end\n\
\n\
function	MagicCannon_Shot_LoadToWeapon(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	return kNewArrow\n\
end\n\
\n\
function MagicCannon_Shot_OnEnter(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_OnEnter .....\" .. kAction:GetActionParam() .. \"\\n\", false, 998 )\n\
	\n\
	local	prevAction = kActor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		kActor:Stop()\n\
	end\n\
	\n\
	--[[\n\
		Casting -> Fire\n\
		Fire -> BIdle\n\
	]]\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		if not MagicCannon_Shot_SetState(kActor,kAction,\"FIRE\") then\n\
			return false\n\
		end\n\
	else --if kAction:GetActionParam() == AP_FIRE then\n\
		MagicCannon_Shot_SetState(kActor,kAction,\"RETURN\")\n\
\n\
		--[[local	kTargetList = kAction:GetTargetList()\n\
		if nil ~= kTargetList and not kTargetList:IsNil() and 0 < kTargetList:size() then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if not kTargetInfo:IsNil() then\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if not kTargetPilot:IsNil() then\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if not kTargetActor:IsNil() then\n\
						kActor:LookAt(kTargetActor:GetPos(),true,false)\n\
					end\n\
				end\n\
			end\n\
		end]]--\n\
	end\n\
	return true\n\
end\n\
\n\
function MagicCannon_Shot_OnUpdate(kActor, accumTime, frameTime)\n\
	local kAction = kActor:GetAction()\n\
	local bAnimDone = kActor:IsAnimationDone()\n\
	local iState = kAction:GetParamInt(0)\n\
	\n\
	if kAction:GetActionParam() == AP_FIRE then\n\
		if bAnimDone == true then\n\
			return false\n\
		end\n\
	elseif kAction:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then\n\
			if kActor:IsAnimationDone() then\n\
				MagicCannon_Shot_SetState(kActor,kAction,\"RETURN\")\n\
			end\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function MagicCannon_Shot_OnCleanUp(kActor)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_OnCleanUp .....\\n\", false, 998 )\n\
	kActor:AttachSound(12, \"MagicCannon_Idle01\")\n\
end\n\
\n\
function MagicCannon_Shot_OnLeave(kActor, action)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_OnLeave .....\\n\", false, 998 )\n\
	return true\n\
end\n\
\n\
function MagicCannon_Shot_OnEvent(kActor, kTextKey)\n\
	local kAction = kActor:GetAction()\n\
	--[[if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end]]\n\
	\n\
	if kTextKey == \"fire\" then\n\
		--ODS( GetAccumTime() .. \" MagicCannon_Shot_OnEvent ..... \" .. kTextKey .. \" \\n\", false, 998 )\n\
		--[[ local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2784,kSoundID)\n\
		end ]]\n\
		\n\
		\n\
		local	kProjectileMan = GetProjectileMan()\n\
		local	kArrow = MagicCannon_Shot_LoadToWeapon(kActor,kAction)\n\
		if not kArrow:IsNil() then\n\
			local	iTargetCount = kAction:GetTargetCount()\n\
			local	iTargetABVShapeIndex = 0\n\
			local	kActionTargetInfo = nil\n\
			if iTargetCount>0 then\n\
				--[[local kTargetGUID = kAction:GetTargetGUID(0)\n\
				iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0)\n\
				kActionTargetInfo = kAction:GetTargetInfo(0)\n\
				local kTargetobject = g_pilotMan:FindPilot(kTargetGUID)\n\
				if kTargetobject:IsNil() == false then\n\
					local kTargetActor = kTargetobject:GetActor()\n\
					if not kTargetActor:IsNil() then\n\
						local kTargetLoc = kTargetActor:GetABVShapeWorldPos(iTargetABVShapeIndex)]]\n\
						--kActor:LookAt(kTargetLoc,true,false)\n\
						--kTargetLoc:Add( Point3(0,-100,150) )\n\
						--kArrow:SetTargetLoc(kTargetLoc)\n\
						kArrow:SetTargetLoc( Point3(0,-290,170) )\n\
						--kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
						--kArrow:SetTargetObject( kActionTargetInfo )\n\
						\n\
						--[[kActor:ReleaseAllParticles()\n\
						kArrow:SetParamValue(\"exValue\", tostring(-150));\n\
					end\n\
				end]]\n\
			end\n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
			kArrow:Fire()\n\
		end\n\
		kAction:ClearTargetList()\n\
	end\n\
	return	true\n\
end") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_MagicCannon_OnlyCast_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_SetState(actor,action,kState)\n\
	local	iNewState = -1\n\
	\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_MagicCannon_OnlyCast_SetState kState : \" .. kState ..\"\\n\", false, 998)\n\
\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(0) : \" ..action:GetSlotAnimName(0) ..\"\\n\", false, 998)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			--ODS(\"  \\n\", false, 998)\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		actor:AttachParticle(9998, \"char_root\", \"ef_Magiccannon_01_btlidle_04_char_root\")\n\
		actor:AttachParticle(9999, \"p_ef_controler\", \"ef_Magiccannon_hilight_01_p_ef_controler\")\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(1) : \" ..action:GetSlotAnimName(1) ..\"\\n\", false, 998)\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			action:SetSlot(4) --	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		--actor:ReleaseAllParticles()\n\
		actor:DetachFrom(9997)\n\
		actor:DetachFrom(9998)\n\
		actor:DetachFrom(9999)\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(2) : \" ..action:GetSlotAnimName(2) ..\"\\n\", false, 998)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(2)) == 0 then\n\
			return false\n\
		end\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		--ODS(GetAccumTime() .. \"   \" .. \"action:GetSlotAnimName(3) : \" ..action:GetSlotAnimName(3) ..\"\\n\", false, 998)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(3)) == 0 then\n\
			return false\n\
		end\n\
		action:SetSlot(3)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_OnEnter(actor, action)\n\
\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_MagicCannon_OnlyCast_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\", false, 998)\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_MagicCannon_OnlyCast_OnCastingCompleted(actor,action)\n\
	else\n\
		if false == Act_MagicCannon_OnlyCast_SetState(actor, action, \"BATTLEIDLE_START\") then	-- \n\
			Act_MagicCannon_OnlyCast_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_MagicCannon_OnlyCast_OnCastingCompleted(actor,action)\n\
	Act_MagicCannon_OnlyCast_Fire(actor,action)\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_Fire(actor,action)\n\
	Act_MagicCannon_OnlyCast_SetState(actor,action,\"FIRE\")\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	local	action = actor:GetAction()\n\
	local	iState = action:GetParamInt(0)\n\
	local	bDone = actor:IsAnimationDone()\n\
	local	aParam = action:GetActionParam()\n\
\n\
	--ODS( GetAccumTime() .. \"  Act_MagicCannon_OnlyCast_OnUpdate\\n\", false, 998)\n\
	actor:DetachFrom(9996)\n\
	if aParam == AP_FIRE then\n\
		if bDone then\n\
			if iState == 2 then\n\
				local bRet = Act_MagicCannon_OnlyCast_SetState(actor,action,\"RETURN\")	--fire   \n\
				if bRet==false then\n\
					--ODS(\"bRet==false\\n\",false,998)\n\
				end\n\
				return bRet\n\
			else\n\
				--ODS(\"  \\n\",false,998)\n\
				return false	--  \n\
			end\n\
		end\n\
	elseif aParam == AP_CASTING then\n\
		if iState == 0 then\n\
			if bDone then\n\
				Act_MagicCannon_OnlyCast_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Act_MagicCannon_OnlyCast_OnCleanUp(actor, action)\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_MagicCannon_OnlyCast_OnCleanUp\\n\", false, 998)\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_OnLeave(actor, action)\n\
\n\
	local	kCurAction = actor:GetAction()\n\
	local	actionID = action:GetID()\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_MagicCannon_OnlyCast_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\")\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_OnEvent(actor,textKey)\n\
	--ODS(GetAccumTime() .. \"   \" .. \"Act_MagicCannon_OnlyCast_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\", false, 998)\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local   action = actor:GetAction();\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
\n\
		if nil~=EffectNode and nil~=Effect then\n\
			actor:AttachParticleS(125, EffectNode, Effect, EffectScale)\n\
		end\n\
	elseif textKey == \"load02\" then\n\
		actor:AttachParticle(9997, \"p_ef_arrow\", \"ef_Magiccannon_01_cast_p_ef_arrow\")\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_MagicCannon_OnlyCast_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_LAVALON_HEART_Die_OnEnter(actor, action)\n\
	ODS(\"Act_LAVALON_HEART_Die_OnEnter\\n\")\n\
	if false == actor:IsNil() then\n\
		actor:SeeFront(true, true)\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_HEART_Die_OnUpdate(actor, accumTime, frameTime)\n\
	return true\n\
end\n\
function Act_LAVALON_HEART_Die_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
function Act_LAVALON_HEART_Die_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_HEART_Die_OnEvent(actor, textKey, seqID)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- .. \n\
function Act_LAVALON_HEART_METEOR_OnEnter(actor,action)\n\
\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	local kPos = Point3(kPacket:PopInt(), kPacket:PopInt(), kPacket:PopInt() + 100) \n\
	local bMeteorExtension = kPacket:PopInt()\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kTargetPt = g_world:ThrowRay(kPos, Point3(0,0,-1), 500)\n\
	\n\
	actor:SetAbil(AT_SKILL_CUSTOM_DATA_01, 	kTargetPt:GetX())\n\
	actor:SetAbil(AT_SKILL_CUSTOM_DATA_01+1, 	kTargetPt:GetY())\n\
	actor:SetAbil(AT_SKILL_CUSTOM_DATA_01+2, 	kTargetPt:GetZ())\n\
	actor:SetAbil(AT_SKILL_CUSTOM_DATA_01+3, 	bMeteorExtension)\n\
	\n\
	kTargetPt:SetZ(kTargetPt:GetZ() + 10)\n\
	\n\
	local kMyPilot = g_pilotMan:GetPlayerActor()\n\
	if kMyPilot:IsNil() == false then\n\
		kMyPilot:AttachParticleToPoint(10000 + math.random(100), kTargetPt, \"e_ef_fossilearth_target_01\")\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_OnUpdate(actor, accumTime, frameTime)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_OnCleanUp(actor, action)\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
\n\
function Act_LAVALON_HEART_METEOR_OnCastingCompleted(actor, action)\n\
	ODS(\"____________Lavalon Heart Meteor OnCastingComplete \\n\")\n\
	action:SetSlot(2)\n\
	actor:PlayCurrentSlot()\n\
\n\
	if actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	local kX = actor:GetAbil(AT_SKILL_CUSTOM_DATA_01)\n\
	local kY = actor:GetAbil(AT_SKILL_CUSTOM_DATA_01+1)\n\
	local kZ = actor:GetAbil(AT_SKILL_CUSTOM_DATA_01+2)\n\
	local bMeteorExtension = actor:GetAbil(AT_SKILL_CUSTOM_DATA_01+3)\n\
	local kTargetPt = Point3(kX, kY, kZ + 10)\n\
\n\
	actor:AttachParticleToPoint(10001 + math.random(100), kTargetPt, \"e_ef_fossilearth_waver\")\n\
\n\
	local kProjectileMan = GetProjectileMan();\n\
	local kProjectileID = \"Projectile_Lavalon_Meteor\"\n\
	if bMeteorExtension == 1 then\n\
	    kProjectileID = \"Projectile_Lavalon_Meteor_Blue\"\n\
	end\n\
	\n\
	local kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, action, actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() == true then\n\
		return false\n\
	end\n\
\n\
	kNewArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
	kNewArrow:SetParamValue(\"EXTENSION\", bMeteorExtension)\n\
\n\
	local kInitPos = Point3(kX, kY, kZ + 400)\n\
	--kInitPos:SetX(kInitPos:GetX() + math.random(-200, 200))\n\
	--if math.random(100) > 50 then\n\
	--	kInitPos:SetY(kInitPos:GetY() + math.random(-200, 200))\n\
	--end\n\
	\n\
	kNewArrow:LoadToPosition(kInitPos)\n\
	kNewArrow:SetTargetLoc(Point3(kX, kY, kZ))\n\
	kNewArrow:Fire(true)\n\
\n\
	return true\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_OnEvent(actor, textKey, seqID)\n\
\n\
	if textKey == \"hit\" then\n\
		ODS(\"____________Lavalon Heart Meteor OnEvent : hit \" .. textKey .. \"\\n\")\n\
		local kAction = actor:GetAction()\n\
		kAction:NextStage()\n\
		QuakeCamera(1,1,1,1,1)\n\
	end\n\
	\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- .. \n\
function Act_LAVALON_HEART_METEOR_BLUE_OnEnter(actor,action)\n\
	return Act_LAVALON_HEART_METEOR_OnEnter(actor,action)\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_BLUE_OnUpdate(actor, accumTime, frameTime)\n\
	return Act_LAVALON_HEART_METEOR_OnUpdate(actor, accumTime, frameTime)\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_BLUE_OnCleanUp(actor, action)\n\
	return Act_LAVALON_HEART_METEOR_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_BLUE_OnLeave(actor, action)\n\
	return Act_LAVALON_HEART_METEOR_OnLeave(actor, action)\n\
end\n\
\n\
\n\
function Act_LAVALON_HEART_METEOR_BLUE_OnCastingCompleted(actor, action)\n\
	return Act_LAVALON_HEART_METEOR_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Act_LAVALON_HEART_METEOR_BLUE_OnEvent(actor, textKey, seqID)\n\
	return Act_LAVALON_HEART_METEOR_OnEvent(actor, textKey, seqID)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mutisha_InAram_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mutisha_InAram_SetState(actor,action,kState)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			--ODS(\"Act_Mutisha_InAram_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mutisha_InAram_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Act_Mutisha_InAram_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mutisha_InAram_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mutisha_InAram_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mutisha_InAram_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mutisha_InAram_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_Mutisha_InAram_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mutisha_InAram_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mutisha_InAram_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mutisha_InAram_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Mutisha_InAram_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Mutisha_InAram_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mutisha_InAram_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mutisha_InAram_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mutisha_InAram_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mutisha_InAram_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mutisha_InAram_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mutisha_InAram_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mutisha_InAram_LoadToWeapon(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	--local kPos = kActor:GetPos()\n\
	--kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	local kPos = Point3(kAction:GetParamFloat(10), kAction:GetParamFloat(11), kAction:GetParamFloat(12))\n\
	kPos:SetZ(kPos:GetZ() + 100)\n\
	kNewArrow:LoadToPosition(kPos)\n\
	--ODS(\" x:\"..kPos:GetX()..\" y:\"..kPos:GetY()..\" z:\"..kPos:GetZ()..\" ID:\"..kAction:GetID()..\"\\n\",false,987)\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mutisha_InAram_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
       ODS(\"Act_Mutisha_InAram_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
	   \n\
	   \n\
	if textKey == \"spell\" then\n\
        local   action = actor:GetAction();\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
	\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
\n\
		local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
		local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
		if nil==EffectScale or \"\"==EffectScale then\n\
			EffectScale = 1\n\
		else\n\
			EffectScale = tonumber(EffectScale)\n\
		end\n\
\n\
		if nil~=EffectNode and nil~=Effect then\n\
			actor:AttachParticleS(126, EffectNode, Effect, EffectScale)\n\
\n\
		end\n\
	end\n\
       \n\
	if textKey == \"attk\" then\n\
		local action = actor:GetAction();\n\
		local kPos = actor:GetPos()\n\
		--ODS(\" x:\"..kPos:GetX()..\" y:\"..kPos:GetY()..\" z:\"..kPos:GetZ()..\" ID:\"..action:GetID()..\"\\n\",false,987)\n\
		action:SetParamFloat(10, kPos:GetX())\n\
		action:SetParamFloat(11, kPos:GetY())\n\
		action:SetParamFloat(12, kPos:GetZ())\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		local kAction = actor:GetAction()\n\
		--ODS(\"aa:\"..kAction:GetParamFloat(10)..\"\\n\",false,987)		\n\
		local	kProjectileMan = GetProjectileMan()\n\
		local	kArrow = Act_Mutisha_InAram_LoadToWeapon(actor,kAction)\n\
		if kArrow ~= nil then\n\
			if not kArrow:IsNil() then\n\
				local	iTargetCount = kAction:GetTargetCount()\n\
				local	iTargetABVShapeIndex = 0\n\
				local	kActionTargetInfo = nil\n\
				\n\
				local kTargetActor = g_pilotMan:FindActorByClassNo(6000930)\n\
				if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
					kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
				end\n\
				\n\
				-- if iTargetCount>0 then\n\
					-- local kTargetGUID = kAction:GetTargetGUID(0)\n\
					-- iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0)\n\
					-- kActionTargetInfo = kAction:GetTargetInfo(0)\n\
					-- local kTargetobject = g_pilotMan:FindPilot(kTargetGUID)\n\
					-- if kTargetobject:IsNil() == false then\n\
						-- local kTargetActor = kTargetobject:GetActor()\n\
						-- if not kTargetActor:IsNil() then\n\
							-- local kTargetLoc = kTargetActor:GetABVShapeWorldPos(iTargetABVShapeIndex)\n\
							-- --kActor:LookAt(kTargetLoc,true,false)\n\
							-- --kTargetLoc:Add( Point3(0,-100,150) )\n\
							-- --kArrow:SetTargetLoc(kTargetLoc)\n\
							-- --kArrow:SetTargetLoc( Point3(-9,125,225) )\n\
							-- kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
							-- --kArrow:SetTargetObject( kActionTargetInfo )\n\
							\n\
							-- actor:ReleaseAllParticles()\n\
							-- kArrow:SetParamValue(\"exValue\", tostring(-150));\n\
						-- end\n\
					-- end\n\
				-- end\n\
				\n\
				kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
				kArrow:Fire()\n\
			end\n\
		end\n\
		kAction:ClearTargetList()\n\
	end\n\
	\n\
\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mutisha_InAram_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Aram_Backward_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Aram_Backward_SetState(actor,action,kState)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"FIRE\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1;\n\
	elseif kState == \"RETURN1\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN2\" then\n\
		action:SetSlot(3)\n\
		iNewState = 3;\n\
	else\n\
		return false\n\
	end\n\
	ODS(\"Backward State:\"..iNewState..\"\\n\",false,987)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Aram_Backward_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetSlot(0)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,0)\n\
\n\
	actor:DetachFrom(985)\n\
	actor:AttachParticle(986, \"p_ef_Head\", \"ef_Aram_end_01_p_ef_head\")\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Aram_Backward_OnCastingCompleted(actor,action)\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:RecoverCameraAdjustInfo()\n\
\n\
	return true\n\
end\n\
function Act_Aram_Backward_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Aram_Backward_SetState(actor,action,\"FIRE\")\n\
	\n\
	--Act_Aram_Backward_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Aram_Backward_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Aram_Backward_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Aram_Backward_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					--actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Aram_Backward_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if actor:IsAnimationDone() == true then\n\
			if iState == 3 then\n\
				return true\n\
			end\n\
			if iState >= 1 then\n\
				local bRet = Act_Aram_Backward_SetState(actor,action,\"RETURN\"..iState)\n\
				return bRet\n\
			end\n\
			return true\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Aram_Backward_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Aram_Backward_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	\n\
	actor:DetachFrom(986)\n\
	\n\
	--ODS(\"Act_Aram_Backward_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Aram_Backward_LoadToWeapon(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Aram_Backward_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	ODS(\"Act_Aram_Backward_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
		\n\
	-- if textKey == \"hit\" or textKey == \"fire\" or textKey == \"walk02\" then\n\
		-- local kAction = actor:GetAction()\n\
		-- local	kProjectileMan = GetProjectileMan()\n\
		-- local	kArrow = Act_Aram_Backward_LoadToWeapon(actor,kAction)\n\
		-- if kArrow ~= nil then\n\
			-- if not kArrow:IsNil() then\n\
				\n\
				-- local	iTargetCount = kAction:GetTargetCount()\n\
				-- local	iTargetABVShapeIndex = 0\n\
				-- local	kActionTargetInfo = nil\n\
				\n\
				-- local kTargetActor = g_pilotMan:FindActorByClassNo(6000940)\n\
				-- if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
					-- kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
				-- end\n\
				-- -- if iTargetCount>0 then\n\
					-- -- local kTargetGUID = kAction:GetTargetGUID(0)\n\
					-- -- iTargetABVShapeIndex = kAction:GetTargetABVShapeIndex(0)\n\
					-- -- kActionTargetInfo = kAction:GetTargetInfo(0)\n\
					-- -- local kTargetobject = g_pilotMan:FindPilot(kTargetGUID)\n\
					-- -- if kTargetobject:IsNil() == false then\n\
						-- -- local kTargetActor = kTargetobject:GetActor()\n\
						-- -- if not kTargetActor:IsNil() then\n\
							-- -- local kTargetLoc = kTargetActor:GetABVShapeWorldPos(iTargetABVShapeIndex)\n\
							-- -- --kActor:LookAt(kTargetLoc,true,false)\n\
							-- -- --kTargetLoc:Add( Point3(0,-100,150) )\n\
							-- -- --kArrow:SetTargetLoc(kTargetLoc)\n\
							-- -- --kArrow:SetTargetLoc( Point3(-9,125,225) )\n\
							-- -- kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
							-- -- --kArrow:SetTargetObject( kActionTargetInfo )\n\
							\n\
							-- -- actor:ReleaseAllParticles()\n\
							-- -- kArrow:SetParamValue(\"exValue\", tostring(-150));\n\
						-- -- end\n\
					-- -- end\n\
				-- -- end\n\
				\n\
				-- kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
				-- kArrow:Fire()\n\
			-- end\n\
		-- end\n\
		-- kAction:ClearTargetList()\n\
	-- end\n\
	\n\
\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Aram_Backward_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Aram_Frontward_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Aram_Frontward_SetState(actor,action,kState)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"FIRE\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1;\n\
	elseif kState == \"RETURN1\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN2\" then\n\
		action:SetSlot(3)\n\
		iNewState = 3;\n\
	else\n\
		return false\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Aram_Frontward_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Act_Aram_Frontward_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
\n\
	action:SetSlot(0)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Aram_Frontward_OnCastingCompleted(actor,action)\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:SetCameraAdjustInfo(143,-96,50,0,0)\n\
	actor:AttachParticle(984, \"p_ef_Head\", \"ef_Aram_start_01_p_ef_head\")\n\
\n\
	return true\n\
end\n\
function Act_Aram_Frontward_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Aram_Frontward_SetState(actor,action,\"FIRE\")\n\
	--Act_Aram_Frontward_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Aram_Frontward_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--     .\n\
	local	kTargetList = action:GetTargetList();\n\
	local	iTargetCount = kTargetList:size();\n\
	\n\
	ODS(\"Act_Aram_Frontward_Fire iTargetCount:\"..iTargetCount..\"\\n\");\n\
	\n\
	\n\
	if iTargetCount>0 then\n\
		local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
		if kTargetInfo:IsNil() == false then\n\
		\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
			\n\
				local	kTargetActor = kTargetPilot:GetActor();\n\
				if kTargetActor:IsNil() == false then\n\
				\n\
					ODS(\"Act_Aram_Frontward_Fire LookAtBidirection Attacker:\"..actor:GetID()..\" Target:\"..kTargetActor:GetID()..\"\\n\");\n\
					--actor:LookAtBidirection(kTargetActor:GetPos());\n\
					--actor:LookAt(kTargetActor:GetPos(),true,true);\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
end\n\
\n\
function Act_Aram_Frontward_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if actor:IsAnimationDone() == true then\n\
			if iState == 3 then\n\
				return true\n\
			end\n\
			if iState >= 1 then\n\
				local bRet = Act_Aram_Frontward_SetState(actor,action,\"RETURN\"..iState)\n\
				return bRet\n\
			end\n\
			return true\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Aram_Frontward_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Aram_Frontward_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	actor:DetachFrom(984)\n\
	actor:AttachParticle(985, \"p_ef_Head\", \"ef_Aram_idle_01_p_ef_head\")\n\
\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Aram_Frontward_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Aram_Frontward_LoadToWeapon(kActor, kAction)\n\
	--ODS( GetAccumTime() .. \" MagicCannon_Shot_LoadToWeapon..... \\n\", false, 998 )\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Aram_Frontward_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	ODS(\"Act_Aram_Frontward_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
		\n\
	-- if textKey == \"hit\" or textKey == \"fire\" or textKey == \"walk02\" then\n\
		-- local kAction = actor:GetAction()\n\
		-- local	kProjectileMan = GetProjectileMan()\n\
		-- local	kArrow = Act_Aram_Frontward_LoadToWeapon(actor,kAction)\n\
		-- if kArrow ~= nil then\n\
			-- if not kArrow:IsNil() then\n\
				\n\
				-- local	iTargetCount = kAction:GetTargetCount()\n\
				-- local	iTargetABVShapeIndex = 0\n\
				-- local	kActionTargetInfo = nil\n\
				\n\
				-- local kTargetActor = g_pilotMan:FindActorByClassNo(6000940)\n\
				-- if kTargetActor ~= nil and kTargetActor:IsNil() == false then\n\
					-- kArrow:SetTargetLoc( kTargetActor:GetNodeTranslate(\"p_ef_head\") )\n\
				-- end\n\
				\n\
				-- kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp())\n\
				-- kArrow:Fire()\n\
			-- end\n\
		-- end\n\
		-- kAction:ClearTargetList()\n\
	-- end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Aram_Frontward_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Opening_Movie_OnEnter(actor, action)\n\
   	--g_world:SetCameraModeMovie2(actor, 2, 1000081, \"nop()\")\n\
	--g_world:SetCameraMovieTranslate(Point3(0,0,-1500))\n\
	--ODS(\"Act_Opening_Movie_OnEnter\",false,987)\n\
\n\
	action:SetSlot(0)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(1,0)\n\
	return true\n\
end\n\
\n\
function Act_Opening_Movie_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
	-- local action = actor:GetAction()\n\
	-- if 0==action:GetParamInt(1) then\n\
		-- g_world:SetCameraModeMovie(2, 1000081, \"nop()\")\n\
		-- g_world:SetCameraMovieTranslate(Point3(0,0,-1500))\n\
		-- action:SetParamInt(1,1)\n\
	-- end\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Opening_Movie_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Opening_Movie_OnLeave(actor, action)\n\
   ODS(\"Act_Opening_Movie_OnLeave\\n\")\n\
	return true\n\
end\n\
\n\
\n\
function Act_Opening_Movie_OnEvent(actor,textKey)\n\
	--ODS(\"Act_Opening_Movie_OnEvent\",false,987)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if textKey == \"fade\" then	\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end	\n\
		g_world:SetShowWorldFocusFilterColorAlpha( 0x000000, 0.0, 1.0, 3.0, true )\n\
	end\n\
\n\
	return	true;\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Mutisha_Die_CreateEngingActor()\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, 6000932, 0,\"NPC\")\n\
	\n\
	if pilot == nil or pilot:IsNil() == true then\n\
		return true\n\
	end\n\
	\n\
	local kActor = pilot:GetActor()\n\
	if kActor == nil or kActor:IsNil() == true then\n\
		return true\n\
	end\n\
	\n\
	if IsSingleMode() == false then\n\
		g_pilotMan:InsertPilot(guid,pilot);\n\
	end\n\
\n\
	local	kSpawnPos = Point3(0, 0, 1000)\n\
	\n\
	kActor:FreeMove(true)\n\
	kActor:SetUseLOD(false)\n\
	kActor:SetUseSmoothShow(false)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:AddActor(guid, pilot:GetActor(), kSpawnPos, 6)\n\
	\n\
	-- local kTime = g_world:GetAccumTime()\n\
	-- kActor:SetAnimationStartTime(kTime)\n\
	\n\
	--pilot:SetName(kName);\n\
	pilot:GetActor():ClearReservedAction()\n\
	local kAction = pilot:GetActor():ReserveTransitAction(\"a_ending_movie\")\n\
	kAction:SetSlot(0)\n\
	kActor:ResetAnimation();\n\
	--kActor:PlayCurrentSlot();\n\
\n\
	pilot:GetActor():ClearActionState()\n\
	pilot:SetAbil(AT_HP, 1000000);\n\
	pilot:SetAbil(AT_UNIT_SIZE,2);\n\
	pilot:SetAbil(AT_DAMAGEACTION_TYPE,0);\n\
	pilot:SetAbil(AT_NOT_SEE_PLAYER, 0)\n\
	pilot:SetAbil(AT_DAMAGEACTION_TYPE, 0)	\n\
	\n\
	g_world:SetCameraModeMovie2(kActor, 2, 1000021, \"nop()\")\n\
end\n\
\n\
function Act_Mutisha_Die_OnEnter(actor, action)\n\
	--AramCreateOpeningActor()\n\
	action:SetParamInt(20,1)\n\
	return true\n\
end\n\
\n\
function Act_Mutisha_Die_Ready()\n\
	LockPlayerInputMove(8) -- for aram lock\n\
	LockPlayerInput(8)\n\
	CloseAllUI()\n\
	\n\
	CallUI(\"FRM_MOVIE_IN\")\n\
	StopBgSound()	-- \n\
end\n\
\n\
function Act_Mutisha_Die_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	action = actor:GetAction()\n\
	curSlot = action:GetCurrentSlot()\n\
	\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		local kPlay = action:GetParamInt(20)\n\
		if kPlay == 1 then\n\
			action:SetParamInt(20,0)\n\
			Act_Mutisha_Die_Ready()\n\
			Act_Mutisha_Die_CreateEngingActor()\n\
			actor:SetHide(true);\n\
			actor:SetHideShadow(true);\n\
			--AramCreateOpeningActor()\n\
			ODS(\"Act_Mutisha_Die_OnUpdate\\n\",false,987)\n\
		end\n\
		\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
\n\
\n\
function Act_Mutisha_Die_OnCleanUp(actor, action)\n\
	ODS(\"Act_Mutisha_Die_OnCleanUp\\n\",false,987)\n\
end\n\
\n\
function Act_Mutisha_Die_OnEvent(actor,textKey)\n\
	ODS(\"Act_Mutisha_Die_OnEvent\\n\",false,987)\n\
	return true\n\
end\n\
\n\
function Act_Mutisha_Die_OnLeave(actor, action)\n\
   ODS(\"Act_Mutisha_Die_OnLeave\\n\",false,987)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Ending_Movie_OnEnter(actor, action)\n\
   	--g_world:SetCameraModeMovie2(actor, 2, 1000021, \"nop()\")\n\
	ODS(\"Act_Ending_Movie_OnEnter\\n\",false,987)\n\
\n\
	-- local kTime = g_world:GetAccumTime()\n\
	-- actor:SetAnimationStartTime(kTime)\n\
	\n\
	action:SetParamInt(20,1)\n\
	\n\
	action:SetSlot(0)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(1,0)\n\
	\n\
\n\
	\n\
	ODS(\"Action Name:\"..action:GetID()..\"\\n\",false,987)\n\
	return true\n\
end\n\
\n\
function Act_Ending_Movie_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		local kPlay = action:GetParamInt(20)\n\
		if kPlay == 1 then\n\
			action:SetParamInt(20,0)\n\
			Act_Ending_Movie_RemoveActor()\n\
			ODS(\"Act_Ending_Movie_OnUpdate2\\n\",false,987)\n\
		end\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_Ending_Movie_RemoveEndingActor()\n\
	ODS(\"Act_Ending_Movie_RemoveEndingActor\\n\",false,987)\n\
	local kActor = g_pilotMan:FindActorByClassNo(6000932);\n\
	\n\
	if kActor == nil or kActor:IsNil() then\n\
		return	true\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:RemoveActorOnNextUpdate(kActor:GetPilotGuid())\n\
	g_world:RemoveCameraAM()\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Ending_Movie_RemoveActor()\n\
	ODS(\"Act_Ending_Movie_RemoveActor\\n\",false,987)\n\
	OnRecoveryMiniQuest(false)\n\
	-- \n\
	PlayBgSound(0)\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:SetShowWorldFocusFilterColorAlpha( 0x000000, 1.0, 0.0, 3.0, false )\n\
\n\
	Act_Ending_Movie_RemoveEndingActor()\n\
\n\
	g_world:SetCameraMode(1, GetMyActor())\n\
	g_world:SetCameraFixed(true) --  \n\
\n\
	CloseUI(\"FRM_MOVIE_IN\")\n\
	UI_DefaultActivate( true )\n\
	UnLockPlayerInputMove(8) -- for aram lock\n\
	UnLockPlayerInput(8)\n\
	CallMapMove(false)\n\
	g_world:SetCameraZoom(1.0) -- \n\
end\n\
\n\
function Act_Ending_Movie_OnCleanUp(actor, action)\n\
	ODS(\"Act_Ending_Movie_OnCleanUp\\n\",false,987)\n\
end\n\
\n\
function Act_Ending_Movie_OnLeave(actor, action)\n\
   ODS(\"Act_Ending_Movie_OnLeave\\n\",false,987)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("--  ,  ,  \n\
\n\
function Act_Mon_Shot_Twist_SetState(actor,action,kState)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			ODS(\"Act_Mon_Melee_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\")\n\
			action:SetSlot(3)	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		\n\
		action:SetSlot(4)\n\
		iNewState = 3\n\
	end\n\
\n\
	actor:ResetAnimation()\n\
	actor:PlayCurrentSlot()\n\
	action:SetParamInt(0,iNewState)\n\
	return	true\n\
end\n\
\n\
function Act_Mon_Shot_Twist_OnCastingCompleted(actor, action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_Shot_Twist_OnCastingCompleted\\n\")\n\
	\n\
	Act_Mon_Shot_Twist_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Shot_Twist_Fire(actor,action)\n\
\n\
end\n\
\n\
function	Act_Mon_Shot_Twist_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kAttachID=\"\"\n\
	\n\
	if iProjectileIndex>0 then\n\
		kAttachID = \"\"..iProjectileIndex;\n\
	end\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\"..kAttachID)\n\
	local	fProjetileScale = tonumber(actor:GetAnimationInfo(\"PROJECTILE_SCALE\"..kAttachID))\n\
	if fProjetileScale == nil then\n\
		fProjetileScale = 1.0\n\
	end\n\
\n\
	if iProjectileIndex>0 and kProjectileID==nil then\n\
		return	nil\n\
	end\n\
\n\
	if kProjectileID == nil then\n\
		kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	end\n\
	\n\
	if kProjectileID == nil then\n\
		kProjectileID = \"Projectile_arrow_02_arrow_head\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..kAttachID)\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = actor:GetAnimationInfo(\"PROJECTILE_SPEED\"..kAttachID)\n\
	if fProjectileSpeed ~= nil then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
		\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())	\n\
	\n\
	--kNewArrow:LoadToHelper(actor,kTargetNodeID)	--	\n\
	--kNewArrow:LoadToPosition(actor:GetPos())\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local startpos = g_world:GetObjectPosByName(\"bone_start2\")\n\
	kNewArrow:LoadToPosition(startpos)\n\
	return kNewArrow\n\
\n\
end\n\
\n\
function Act_Mon_Shot_Twist_Fire(actor,action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--	is this boomerang type?\n\
	local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
	if bIsBoomerang then\n\
		action:SetParamInt(3,1)	--	this is boomerang type\n\
	end\n\
end\n\
\n\
function Act_Mon_Shot_Twist_OnEnter(actor, action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\" )\n\
	for i=0,9 do\n\
		action:SetParamInt(10+i,-1)	--UID \n\
		action:SetParamInt(30+i,0)	--  \n\
	end\n\
	action:SetParamInt(20,0)	--ID\n\
	action:SetParamInt(21,0)	--  \n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
	\n\
	action:SetParamInt(40,0)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket ~= nil and false == kPacket:IsNil() then\n\
		local kNum = kPacket:PopByte()\n\
		if kNum ~= 0 then\n\
			local kIndex=0\n\
			for i=0,kNum do\n\
				local kGuid = kPacket:PopGuid()\n\
				if nil ~= kGuid and false == kGuid:IsNil() then\n\
					action:SetParam(10+kIndex,kGuid:GetString())\n\
					kIndex = kIndex + 1\n\
				end\n\
			end\n\
			action:SetParamInt(40,kIndex)\n\
		end\n\
	end\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Shot_Twist_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
	    ODS(\"Act_Mon_Shot_Twist_OnEnter Start Casting\\n\")\n\
\n\
		if( Act_Mon_Shot_Twist_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Shot_Twist_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		ODS(\"Act_Mon_Shot_Twist Casting Start iTargetCount :\"..iTargetCount..\"\\n\")\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos())\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
\n\
	action:SetParam(1, \"none\")\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Twist_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local	iState = action:GetParamInt(0)\n\
		\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		if animDone == true then\n\
			if iState == 2 then\n\
				if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then\n\
					return false\n\
				else\n\
					Act_Mon_Shot_Twist_SetState(actor,action,\"RETURN\")\n\
				end\n\
			end\n\
			\n\
			if iState == 3 then\n\
				return false\n\
			end\n\
		end\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_RangeAttack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Shot_Twist_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Twist_OnCleanUp(actor)\n\
	return true\n\
end\n\
\n\
function Act_Mon_Shot_Twist_OnLeave(actor, action)\n\
	ODS(\"Act_Mon_Shot_Twist_OnLeave\\n\")\n\
	return true\n\
end\n\
\n\
function	Act_Mon_Shot_Twist_Projectile_Default_LoadToWeapon(actor,action)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(action==nil);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	--local	kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")--..kAttachID)\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	local	kTargetNodeID = action:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Act_Mon_Shot_Twist_OnEvent(actor,textKey)\n\
\n\
	CheckNil(actor==nil);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	ODS(\"Act_Mon_Shot_Twist_OnEvent textKey:\"..textKey..\"\\n\")\n\
\n\
	local kAction = actor:GetAction()\n\
		\n\
	CheckNil(kAction==nil);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		actor:DetachFrom(230)	--  \n\
		local	bIsBoomerang = (actor:GetAnimationInfo(\"PROJECTILE_TYPE\") == \"BOOMERANG\")\n\
\n\
		if bIsBoomerang then\n\
			actor:HideParts(EQUIP_POS_WEAPON, true)	--	 \n\
			kAction:SetParamInt(4,1)	--	 		\n\
		end\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\")\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID)\n\
		end\n\
\n\
		local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
		if fireEffect ~= nil then\n\
			local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
			\n\
			if fireStartNode == nil then\n\
				fireStartNode = \"p_ef_heart\"\n\
			end\n\
\n\
			local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
			if nil==EffectScale or \"\"==EffectScale then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale)\n\
			end\n\
			\n\
			actor:AttachParticleS(231, fireStartNode, fireEffect, EffectScale)\n\
		end					\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor)\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200 \n\
		end\n\
		\n\
		local fire_delay = actor:GetAnimationInfo(\"FIRE_DELAY\")\n\
		if nil == fire_delay or \"\" == Projectile_cnt then\n\
			fire_delay = 0 --   \n\
		else\n\
			fire_delay = tonumber(fire_delay)\n\
		end\n\
\n\
		local Projectile_cnt = actor:GetAnimationInfo(\"PROJECTILE_COUNT\")\n\
		if nil == Projectile_cnt or \"\" == Projectile_cnt then\n\
			Projectile_cnt = 1\n\
		else\n\
			Projectile_cnt = tonumber(Projectile_cnt)\n\
		end\n\
\n\
		local   iArrowCount = 0\n\
		while   iArrowCount<Projectile_cnt do\n\
		\n\
			local kArrow1 = Act_Mon_Shot_Twist_LoadToWeapon(actor, kAction, 0)\n\
			local kArrow2 = Act_Mon_Shot_Twist_LoadToWeapon(actor, kAction, 0)\n\
			local arrow_worldpos1 = kArrow1:GetWorldPos()\n\
			local arrow_worldpos2 = kArrow2:GetWorldPos()\n\
			local kTargetDir = actor:GetLookingDir()\n\
			kTargetDir:Unitize()\n\
			local kCrossDir = actor:GetLookingDir()\n\
			kCrossDir:Unitize()\n\
			kCrossDir:Cross(Point3(0,0,1))\n\
			\n\
			local kLength = 450 - math.random(0,200)--400\n\
			local kPos1 = Point3(kCrossDir:GetX(),kCrossDir:GetY(),kCrossDir:GetZ())\n\
			kPos1:Multiply(kLength)\n\
			local kPos2 = Point3(kCrossDir:GetX(),kCrossDir:GetY(),kCrossDir:GetZ())\n\
			kPos2:Multiply(-kLength)\n\
\n\
			--ODS(\"1 X:\"..kPos1:GetX()..\" Y : \"..kPos1:GetY()..\" Z : \"..kPos1:GetZ()..\"\\n\",false,987)\n\
			--ODS(\"2 X:\"..kPos2:GetX()..\" Y : \"..kPos2:GetY()..\" Z : \"..kPos2:GetZ()..\"\\n\",false,987)\n\
			\n\
			local iMax = math.max((1500/kLength)*9, 20)\n\
			local fMulti = math.random(10,iMax)*0.1\n\
\n\
			local kArrow1Pos1 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
			kArrow1Pos1:Multiply(kLength)\n\
			kArrow1Pos1:Add(arrow_worldpos1)\n\
			kArrow1Pos1:Add(kPos1)\n\
			local kArrow1Pos2 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
			kArrow1Pos2:Multiply(kLength*fMulti)\n\
			kArrow1Pos2:Add(arrow_worldpos1)\n\
			kArrow1Pos2:Add(kPos2)\n\
			\n\
			ODS(\"1 X:\"..kArrow1Pos1:GetX()..\" Y : \"..kArrow1Pos1:GetY()..\" Z : \"..kArrow1Pos1:GetZ()..\"\\n\",false,987)\n\
			ODS(\"2 X:\"..kArrow1Pos2:GetX()..\" Y : \"..kArrow1Pos2:GetY()..\" Z : \"..kArrow1Pos2:GetZ()..\"\\n\",false,987)\n\
			\n\
			local kArrow2Pos1 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
			kArrow2Pos1:Multiply(kLength)\n\
			kArrow2Pos1:Add(arrow_worldpos2)\n\
			kArrow2Pos1:Add(kPos2)\n\
			local kArrow2Pos2 = Point3(kTargetDir:GetX(),kTargetDir:GetY(),kTargetDir:GetZ())\n\
			kArrow2Pos2:Multiply(kLength*fMulti)\n\
			kArrow2Pos2:Add(arrow_worldpos2)\n\
			kArrow2Pos2:Add(kPos1)\n\
			\n\
			local kFireTarget = actor:GetLookingDir()\n\
			kFireTarget:Unitize()\n\
			kFireTarget:Multiply(1500)\n\
			kFireTarget:Add(arrow_worldpos1)\n\
			\n\
			kArrow1:SetMovingType(2)\n\
			kArrow1:SetParam_Bezier4SplineType(arrow_worldpos1, kArrow1Pos1, kArrow1Pos2, kFireTarget)\n\
			kArrow1:SetTargetLoc(kFireTarget)\n\
			--kArrow1:Fire()\n\
			kArrow1:DelayFire(iArrowCount*fire_delay)\n\
			\n\
			kArrow2:SetMovingType(2)\n\
			kArrow2:SetParam_Bezier4SplineType(arrow_worldpos2, kArrow2Pos1, kArrow2Pos2, kFireTarget)\n\
			kArrow2:SetTargetLoc(kFireTarget)\n\
			--kArrow2:Fire()\n\
			kArrow2:DelayFire(iArrowCount*fire_delay)\n\
			\n\
			iArrowCount=iArrowCount+1\n\
		end\n\
		\n\
\n\
		kAction:ClearTargetList()\n\
					\n\
	end\n\
	\n\
	if textKey == \"quake\" then\n\
		Act_Mon_QuakeCamera(actor)\n\
	end\n\
\n\
	return	true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("local MAX_SUMMON_BONE_LINE_COUNT = 15;\n\
local MAX_SUMMON_BONE_SELECT_COUNT = 3;\n\
\n\
function Act_Mon_SummonBone_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_SummonBone_SetState(actor,action,kState)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
	\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	action:SetParamInt(820, 0)\n\
	action:SetParamInt(821, 0)\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_SummonBone_OnCastingCompleted(actor,action)\n\
	else\n\
		if( Act_Mon_SummonBone_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_SummonBone_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
	end\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kTopLeft = g_world:GetObjectPosByName(\"breath_L_top\")		-- left top\n\
	local kTopRight = g_world:GetObjectPosByName(\"breath_R_top\")	-- right top\n\
	local kBottomLeft = g_world:GetObjectPosByName(\"breath_L_bottom\")	-- left bottom\n\
	local kBottomRight = g_world:GetObjectPosByName(\"breath_R_bottom\")	-- right bottom\n\
\n\
	local kUpperBase = Point3((kTopRight:GetX()+kTopLeft:GetX())/2, (kTopRight:GetY()+kTopLeft:GetY())/2, (kTopRight:GetZ()+kTopLeft:GetZ())/2)\n\
	local kRightBase = Point3((kTopRight:GetX()+kBottomRight:GetX())/2, (kTopRight:GetY()+kBottomRight:GetY())/2, (kTopRight:GetZ()+kBottomRight:GetZ())/2)\n\
	local kBottomBase = Point3((kBottomRight:GetX()+kBottomLeft:GetX())/2, (kBottomRight:GetY()+kBottomLeft:GetY())/2, (kBottomRight:GetZ()+kBottomLeft:GetZ())/2)\n\
	local kLeftBase = Point3((kTopLeft:GetX()+kBottomLeft:GetX())/2, (kTopLeft:GetY()+kBottomLeft:GetY())/2, (kTopLeft:GetZ()+kBottomLeft:GetZ())/2)\n\
	\n\
	local fUnitLength = (kUpperBase:GetY() - kBottomBase:GetY()) / MAX_SUMMON_BONE_SELECT_COUNT\n\
	action:SetParamFloat(200, fUnitLength)\n\
	\n\
	local kStartPoint = Point3(kRightBase:GetX(), kUpperBase:GetY(), kUpperBase:GetZ())\n\
	action:SetParamAsPoint(300, kStartPoint)\n\
	\n\
	local ptStartPos = g_world:GetObjectPosByName(kStartPos)\n\
	\n\
	action:SetParamAsPoint(1, ptStartPos)\n\
	\n\
	local it = 0\n\
	while it < MAX_SUMMON_BONE_LINE_COUNT do\n\
		local jt = 0\n\
		while jt < MAX_SUMMON_BONE_SELECT_COUNT-1 do\n\
			local iPos = kPacket:PopInt()\n\
			ODS(\"aa   \"..iPos..\"\\n\",false,987)\n\
			action:SetParamInt(100 + (it*(MAX_SUMMON_BONE_SELECT_COUNT-1) + jt), iPos)\n\
			jt = jt + 1\n\
		end\n\
		it = it + 1\n\
	end\n\
	\n\
	action:DeleteParamPacket()\n\
	\n\
	Act_Mon_SummonBone_CastingEffect(actor, action)\n\
	\n\
	return true\n\
end\n\
function Act_Mon_SummonBone_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_SummonBone_SetState(actor,action,\"FIRE\")\n\
	\n\
	local kUseKey = actor:GetAnimationInfo(\"USE_EVENT_KEY\")\n\
	if nil~=kUseKey then\n\
		kUseKey = tonumber(kUseKey)\n\
		action:SetParamInt(800, kUseKey)\n\
	end\n\
\n\
	if nil==kUseKey and 0==kUseKey then\n\
		Act_Mon_SummonBone_Fire(actor,action);\n\
	end\n\
	\n\
end\n\
\n\
function Act_Mon_SummonBone_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(820, 1)\n\
	--Act_Mon_SummonBone_FireEffect(actor, action)\n\
	--GetActionResultCS(action, actor)\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_SummonBone_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_SummonBone_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	\n\
	if action:GetParamInt(820) == 1 then\n\
		local ipos = action:GetParamInt(821)\n\
		for i=0,1 do\n\
			Act_Mon_SummonBone_FireEffect_Each(actor, action, ipos, i)\n\
		end\n\
		ipos = ipos + 1\n\
		action:SetParamInt(821, ipos)\n\
		if ipos >= MAX_SUMMON_BONE_LINE_COUNT then\n\
			action:SetParamInt(820, 0)\n\
		end\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_SummonBone_OnCleanUp(actor, action)\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_SummonBone_OnTargetListModified(actor,action,bIsBefore)\n\
	Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Act_Mon_SummonBone_CastingEffect(actor, action)\n\
	local fUnitLen = action:GetParamFloat(200)\n\
	local fHalfLen = fUnitLen / 2\n\
	local kStartPoint = action:GetParamAsPoint(300)\n\
\n\
	local kCastEff = actor:GetAnimationInfo(\"CAST_EFFECT\")\n\
	if nil==kCastEff or \"\"==kCastEff then\n\
		kCastEff = \"EF_Pattern_BoneDragon_skill_01_char_root\"\n\
	end\n\
\n\
	local kScale = actor:GetAnimationInfo(\"CAST_EFFECT_SCALE\")\n\
	if nil==kScale or \"\"==kScale then\n\
		kScale = 0.55\n\
	end\n\
\n\
	kScale = tonumber(kScale)\n\
	\n\
	local it = 0\n\
	while it < MAX_SUMMON_BONE_LINE_COUNT do\n\
		local jt = 0\n\
		while jt < MAX_SUMMON_BONE_SELECT_COUNT-1 do\n\
			local iIndex = it*(MAX_SUMMON_BONE_SELECT_COUNT-1) + jt\n\
			local iPos = action:GetParamInt(100 + iIndex)\n\
			ODS(\" \"..iPos..\"\\n\",false,987)\n\
			local EffectPos = Point3(0,0,0)\n\
			EffectPos:SetX(kStartPoint:GetX() - (it * fUnitLen) - fHalfLen)\n\
			EffectPos:SetY(kStartPoint:GetY() - (iPos * fUnitLen) - fHalfLen)\n\
			EffectPos:SetZ(kStartPoint:GetZ())\n\
			GetPlayer():AttachParticleToPointS(80000 + iIndex, EffectPos, kCastEff, kScale)\n\
			jt = jt + 1\n\
		end\n\
		it = it + 1\n\
	end\n\
end\n\
\n\
function Act_Mon_SummonBone_FireEffect(actor, action)\n\
	local fUnitLen = action:GetParamFloat(200)\n\
	local fHalfLen = fUnitLen / 2\n\
	local kStartPoint = action:GetParamAsPoint(300)\n\
\n\
	local kGroundEff = actor:GetAnimationInfo(\"GROUND_EFFECT\")\n\
	if nil==kGroundEff or \"\"==kGroundEff then\n\
		kGroundEff = \"ef_BoneDragon_skill_01_02_char_root\"\n\
	end\n\
\n\
	local kScale = actor:GetAnimationInfo(\"GROUND_EFFECT_SCALE\")\n\
	if nil==kScale or \"\"==kScale then\n\
		kScale = 1.0\n\
	end\n\
	kScale = tonumber(kScale)\n\
	\n\
	local it = 0\n\
	while it < MAX_SUMMON_BONE_LINE_COUNT do\n\
		local jt = 0\n\
		while jt < MAX_SUMMON_BONE_SELECT_COUNT-1 do\n\
			local iIndex = it*(MAX_SUMMON_BONE_SELECT_COUNT-1) + jt\n\
			local iPos = action:GetParamInt(100 + iIndex)\n\
			local EffectPos = Point3(0,0,0)\n\
			EffectPos:SetX(kStartPoint:GetX() - (it * fUnitLen) - fHalfLen)\n\
			EffectPos:SetY(kStartPoint:GetY() - (iPos * fUnitLen) - fHalfLen)\n\
			EffectPos:SetZ(kStartPoint:GetZ())\n\
			GetPlayer():AttachParticleToPointS(90000 + iIndex, EffectPos, kGroundEff, kScale)\n\
			jt = jt + 1\n\
		end\n\
		it = it + 1\n\
	end\n\
end\n\
\n\
function Act_Mon_SummonBone_FireEffect_Each(actor, action, it, jt)\n\
	local fUnitLen = action:GetParamFloat(200)\n\
	local fHalfLen = fUnitLen / 2\n\
	local kStartPoint = action:GetParamAsPoint(300)\n\
\n\
	local kGroundEff = actor:GetAnimationInfo(\"GROUND_EFFECT\")\n\
	if nil==kGroundEff or \"\"==kGroundEff then\n\
		kGroundEff = \"ef_BoneDragon_skill_01_02_char_root\"\n\
	end\n\
\n\
	local kScale = actor:GetAnimationInfo(\"GROUND_EFFECT_SCALE\")\n\
	if nil==kScale or \"\"==kScale then\n\
		kScale = 1.0\n\
	end\n\
	kScale = tonumber(kScale)\n\
	\n\
	local iIndex = it*(MAX_SUMMON_BONE_SELECT_COUNT-1) + jt\n\
	local iPos = action:GetParamInt(100 + iIndex)\n\
	local EffectPos = Point3(0,0,0)\n\
	EffectPos:SetX(kStartPoint:GetX() - (it * fUnitLen) - fHalfLen)\n\
	EffectPos:SetY(kStartPoint:GetY() - (iPos * fUnitLen) - fHalfLen)\n\
	EffectPos:SetZ(kStartPoint:GetZ())\n\
	GetPlayer():AttachParticleToPointS(90000 + iIndex, EffectPos, kGroundEff, kScale)\n\
	\n\
end\n\
\n\
function Act_Mon_SummonBone_OnEvent(actor,textKey)\n\
\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
		CheckNil(nil==actor);\n\
		CheckNil(actor:IsNil());		\n\
	\n\
		local FireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT2\")\n\
		if nil~=FireEffect and \"\"~=FireEffect then\n\
			local FireEffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE2\")\n\
			if nil==FireEffectNode or \"\"==FireEffectNode then\n\
				FireEffectNode = \"char_root\"\n\
			end\n\
			--actor:AttachParticle(3252, FireEffectNode ,FireEffect)\n\
		end\n\
		\n\
		Act_Mon_QuakeCamera(actor)\n\
		\n\
        local   action = actor:GetAction();\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
		\n\
		Act_Mon_Melee_DoDamage(actor,action)\n\
\n\
		local kUseKey = action:GetParamInt(800)\n\
		if 0~=kUseKey then\n\
			Act_Mon_SummonBone_Fire(actor,action);\n\
		end\n\
	end\n\
	\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Mon_SummonThorn for skill actor\n\
\n\
function Act_Mon_SummonBone_Play_OnCheckCanEnter(actor, action) \n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_SetState(actor,action,kState)\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	local	iNewState = -1	--   \n\
	if kState == \"BATTLEIDLE_START\" then\n\
		--action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		--action:SetSlot(0)\n\
		iNewState = 1\n\
	elseif kState == \"FIRE\" then\n\
		--action:SetSlot(1)\n\
		iNewState = 2\n\
	elseif kState == \"RETURN\" then\n\
		--action:SetSlot(0)\n\
		iNewState = 3\n\
	end\n\
	return	true\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_OnEnter(actor, action)\n\
--	ODS(\"Act_Mon_SummonBone_Play_OnEnter\\n\", false, 1509)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	action:SetSlot(0)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	\n\
	actor:FreeMove(true)\n\
	local	kTargetList = action:GetTargetList()\n\
	local	iTargetCount = kTargetList:size()\n\
	local	kPacket = action:GetParamAsPacket()\n\
	if kPacket == nil or kPacket:IsNil() then\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then			\n\
					ptTargetPos = kTargetPilot:GetPos()\n\
				end\n\
			end\n\
		else\n\
			ptTargetPos = actor:GetPos()\n\
		end\n\
	else\n\
		ptTargetPos = Point3(kPacket:PopFloat(),kPacket:PopFloat(),kPacket:PopFloat())\n\
	end\n\
\n\
	action:SetParamFloat(2, 0.0)-- \n\
	action:SetParamAsPoint(3, actor:GetPos())--  \n\
	action:SetParamInt(4,0)\n\
	\n\
	local fireStartNode	= actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")	\n\
	if fireStartNode == nil then\n\
		fireStartNode = \"char_root\"\n\
	end\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
	if fireEffect == nil then\n\
		fireEffect = \"ef_deathmaster_skill_03_02_char_root\"\n\
	end					\n\
\n\
	--actor:AttachParticleToPoint(7231,actor:GetPos(),fireEffect);\n\
\n\
	return true\n\
end\n\
function Act_Mon_SummonBone_Play_OnCastingCompleted(actor,action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	Act_Mon_SummonBone_Play_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_SummonBone_Play_Fire(actor,action);\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_Fire(actor,action)\n\
	if action:GetTargetList():IsNil() == false then\n\
		action:GetTargetList():ApplyActionEffects();\n\
	end\n\
	action:ClearTargetList()\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_OnCleanUp(actor, action)\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_OnLeave(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	local	kCurAction = actor:GetAction()\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Act_Mon_SummonBone_Play_OnEvent(actor,textKey)\n\
	ODS(\"Act_Mon_SummonBone_Play_OnEvent:\"..textKey..\"\\n\",false,987)\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local animDone = actor:IsAnimationDone()\n\
--	local iCurrentSlot = action:GetCurrentSlot();\n\
	-- local iState = action:GetParamInt(3);\n\
	\n\
	-- --local   kMoveDir = Point3(action:GetParamFloat(4),action:GetParamFloat(5),action:GetParamFloat(6));\n\
	-- local   kMoveDir = Point3(-1,0,0);\n\
	-- local   fMoveSpeed = actor:GetAbil(AT_C_MOVESPEED);\n\
	-- if fMoveSpeed == 0 then\n\
	    -- fMoveSpeed = 100\n\
    -- end\n\
	-- ODS(\"SP:\"..fMoveSpeed..\"\\n\",false,987)\n\
	-- ODS(\"X:\"..kMoveDir:GetX()..\" Y:\"..kMoveDir:GetY()..\" Z:\"..kMoveDir:GetZ()..\"\\n\",false,987)\n\
	\n\
	-- kMoveDir:Multiply(fMoveSpeed);	\n\
	-- actor:SetMovingDelta(kMoveDir);\n\
\n\
	-- if iState == 0 then\n\
		-- ODS(\"aa\\n\",false,987)\n\
		-- local fElapsedTIme = accumTime - action:GetParamFloat(1);\n\
		-- if actor:IsUnderMyControl() then\n\
		-- ODS(\"bb\\n\",false,987)\n\
			-- local fTickTime = action:GetParamFloat(100);\n\
\n\
			-- if fTickTime == nil then\n\
				-- fTickTime = 1.0\n\
			-- end\n\
			\n\
			-- if fElapsedTIme > fTickTime then\n\
\n\
				-- action:SetParamFloat(1,accumTime);\n\
				-- action:CreateActionTargetList(actor);\n\
			    \n\
				-- if IsSingleMode() or action:GetTargetCount() == 0 then\n\
					-- Act_Mon_SummonBone_Play_OnTargetListModified(actor,action,false);	    \n\
				-- else		    \n\
					-- action:BroadCastTargetListModify(actor:GetPilot());\n\
					-- action:ClearTargetList();\n\
				-- end\n\
			-- end\n\
		-- end\n\
	-- end\n\
\n\
	-- local   fLifeTime = actor:GetAbil(AT_LIFETIME)/1000.0;\n\
	-- if fLifeTime == 0 then\n\
	    -- fLifeTime = 2.0;\n\
    -- end	\n\
\n\
    -- local   fTotalElapsedTime = accumTime - action:GetParamFloat(0);\n\
\n\
	-- if iState == 0 then\n\
		-- if fLifeTime - fTotalElapsedTime < 1.5 then\n\
			-- actor:SetTargetAlpha(actor:GetAlpha(),0, 0.5);\n\
			-- action:SetParamInt(3, 1);\n\
			-- actor:SetHideShadow(true);\n\
		-- end\n\
	-- end    \n\
\n\
    -- if fTotalElapsedTime > fLifeTime then\n\
        -- return  false\n\
    -- end	\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_SummonBone_Play_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);\n\
        action:GetTargetList():ApplyActionEffects();    \n\
    end\n\
\n\
end") );
	m_kContLuaText.push_back(std::string("local iExplosionParticleTargetRadius = 79\n\
local iExplosionParticleRadius = 100--110\n\
local iExplosionTerm = 1\n\
\n\
function Act_Mon_DarkBreath_SetState(actor,action,kState)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	actor:FreeMove(true)\n\
	--ODS(\"State : \"..kState..\"\\n\",false,987)\n\
	local	iNewState = -1;\n\
	if kState == \"START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	\n\
	elseif kState == \"IDLE\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
			action:SetSlot(6);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1\n\
		\n\
	elseif kState == \"RUN\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
		\n\
	elseif kState == \"FIREREADY\" then\n\
		action:SetSlot(3)\n\
		iNewState = 3\n\
		\n\
	elseif kState == \"BATTLEIDLE\" then\n\
		action:SetSlot(4)\n\
		iNewState = 4\n\
	\n\
	elseif kState == \"FINISH\" then\n\
		action:SetSlot(5)\n\
		iNewState = 5\n\
	elseif kState == \"END_IDLE\" then\n\
		action:SetSlot(6)\n\
		iNewState = 6\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(7)\n\
		iNewState = 7\n\
	\n\
		\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_DarkBreath_OnEnter(actor, action)\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	action:SetParamAsPoint(1, actor:GetPos())\n\
	actor:FreeMove(true)\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	--g_world:SetCameraAdjustInfo(50,-300,50,0,0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_DarkBreath_SetState(actor,action,\"FIRE\")\n\
		--ODS(\"Act_Mon_DarkBreath_OnEnter FIRE\\n\",false,987)\n\
	else\n\
		if( Act_Mon_DarkBreath_SetState(actor,action,\"START\") == false) then\n\
			Act_Mon_DarkBreath_SetState(actor,action,\"IDLE\")\n\
		end	\n\
	end\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local kTopLeft = g_world:GetObjectPosByName(\"breath_L_top\")		-- left top\n\
	local kTopRight = g_world:GetObjectPosByName(\"breath_R_top\")	-- right top\n\
	local kBottomLeft = g_world:GetObjectPosByName(\"breath_L_bottom\")	-- left bottom\n\
	local kBottomRight = g_world:GetObjectPosByName(\"breath_R_bottom\")	-- right bottom\n\
\n\
	local kUpperBase = Point3((kTopRight:GetX()+kTopLeft:GetX())/2, (kTopRight:GetY()+kTopLeft:GetY())/2, (kTopRight:GetZ()+kTopLeft:GetZ())/2)\n\
	local kRightBase = Point3((kTopRight:GetX()+kBottomRight:GetX())/2, (kTopRight:GetY()+kBottomRight:GetY())/2, (kTopRight:GetZ()+kBottomRight:GetZ())/2)\n\
	local kBottomBase = Point3((kBottomRight:GetX()+kBottomLeft:GetX())/2, (kBottomRight:GetY()+kBottomLeft:GetY())/2, (kBottomRight:GetZ()+kBottomLeft:GetZ())/2)\n\
	local kLeftBase = Point3((kTopLeft:GetX()+kBottomLeft:GetX())/2, (kTopLeft:GetY()+kBottomLeft:GetY())/2, (kTopLeft:GetZ()+kBottomLeft:GetZ())/2)\n\
	\n\
	local fHorLen =  kUpperBase:GetY() - kBottomBase:GetY()\n\
	local fVerLen = kRightBase:GetX() - kLeftBase:GetX()\n\
	\n\
	local kStartPoint = Point3(kLeftBase:GetX(), kBottomBase:GetY(), kBottomBase:GetZ())\n\
\n\
	action:SetParamAsPoint(111, kStartPoint)\n\
	\n\
	-- ODS(\"Pos X : \"..kUpperBase:GetX()..\" Y : \"..kUpperBase:GetY()..\" Z : \"..kUpperBase:GetZ()..\"\\n\",false,987)\n\
	-- ODS(\"Pos X : \"..kBottomBase:GetX()..\" Y : \"..kBottomBase:GetY()..\" Z : \"..kBottomBase:GetZ()..\"\\n\",false,987)\n\
	-- ODS(\"Pos X : \"..kRightBase:GetX()..\" Y : \"..kRightBase:GetY()..\" Z : \"..kRightBase:GetZ()..\"\\n\",false,987)\n\
	-- ODS(\"Pos X : \"..kLeftBase:GetX()..\" Y : \"..kLeftBase:GetY()..\" Z : \"..kLeftBase:GetZ()..\"\\n\",false,987)\n\
	\n\
	local iHorMaxCount = 4\n\
	local iVerMaxCount = 20\n\
	\n\
	local fLen = fHorLen / iHorMaxCount;\n\
	local fHalfLen = fLen / 2;\n\
	action:SetParamFloat(200, fLen)\n\
	\n\
	--ODS(\"a:\"..fHorLen..\" \"..fVerLen..\"\\n\",false,987)\n\
\n\
	local iHor = kPacket:PopInt()\n\
	ODS(\"iHor : \"..iHor..\"\\n\",false,987)\n\
	--action:SetParamInt(100, iHor)\n\
	for it=1,80 do\n\
		action:SetParamInt(i, 0)\n\
	end\n\
	for ih=1,iHor do\n\
		local iPos = kPacket:PopInt() - 1\n\
		--ODS(\"iPos : \"..iPos..\"\\n\",false,987)\n\
		for i=1,20 do\n\
			action:SetParamInt(iPos*20 + i, 1)\n\
		end\n\
	end\n\
	local iVer = kPacket:PopInt()\n\
	--ODS(\"iVer : \"..iVer..\"\\n\",false,987)\n\
	for iv=1,iVer do\n\
		local iPos = kPacket:PopInt()\n\
		--ODS(\"iPos : \"..iPos..\"\\n\",false,987)\n\
		for i=0,3 do\n\
			action:SetParamInt(i*20 + iPos, 1)\n\
		end\n\
	end\n\
	\n\
	action:DeleteParamPacket()\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_DarkBreath_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	local	action = actor:GetAction()\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local	iState = action:GetParamInt(0)\n\
	--ODS(iState..\" \\n\",false,987)\n\
	\n\
	\n\
	--if action:GetActionParam() == AP_FIRE then\n\
		if iState == 7 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_DarkBreath_SetState(actor,action,\"FINISH\")\n\
				actor:SetTranslate(action:GetParamAsPoint(1))\n\
				--g_world:RecoverCameraAdjustInfo()\n\
			end\n\
		end\n\
	--elseif action:GetActionParam() == AP_CASTING then\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				--g_world:SetCameraAdjustInfo(143,-96,50,0,0)\n\
				\n\
				Act_Mon_DarkBreath_SetState(actor,action,\"RUN\")\n\
				--g_world:SetParamAsPoint(112, actor:GetPos())\n\
				\n\
				action:SetParamFloat(88, g_world:GetAccumTime())\n\
				\n\
				-- local ptLookat = Point3(actor:GetPos():GetX()-2000, actor:GetPos():GetY(), actor:GetPos():GetZ())\n\
				-- actor:LookAt(ptLookat)\n\
				--ODS(\"Lookat x : \"..ptLookat:GetX()..\" y : \"..ptLookat:GetY()..\" z : \"..ptLookat:GetZ()..\"\\n\",false,987)\n\
			end\n\
\n\
		elseif iState == 2 then\n\
			local kMoveDir = Point3(-1,0,0)\n\
			local fMoveSpeed = 2000\n\
			local OldPos = action:GetParamAsPoint(112)\n\
			local CurPos = actor:GetPos()\n\
			\n\
			-- ODS(\"Old \"..OldPos:GetX()..\" Old \"..OldPos:GetY()..\" Old \"..OldPos:GetZ()..\"\\n\",false,987)\n\
			-- ODS(\"Cur \"..CurPos:GetX()..\" Cur \"..CurPos:GetY()..\" Cur \"..CurPos:GetZ()..\"\\n\",false,987)\n\
			\n\
			-- if CurPos:GetX() ~= OldPos:GetX() then\n\
				kMoveDir:Multiply(fMoveSpeed)\n\
				--kMoveDir:Add(Point3(0,0,100))\n\
				actor:SetMovingDelta(kMoveDir)\n\
			-- else\n\
				-- CurPos:SetZ(CurPos:GetZ() + 500)\n\
				-- actor:SetTranslate(CurPos,true)\n\
			-- end\n\
						\n\
			--action:SetParamAsPoint(112, actor:GetPos())\n\
			\n\
			local fCurTime = g_world:GetAccumTime()\n\
			if fCurTime - action:GetParamFloat(88) > 1.8 then\n\
				local ptMiddle = g_world:GetObjectPosByName(\"fly_end\")		-- left top\n\
				actor:SetTranslate(ptMiddle)\n\
				Act_Mon_DarkBreath_SetState(actor,action,\"FIREREADY\")\n\
			end\n\
		elseif iState == 3 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_DarkBreath_SetState(actor,action,\"BATTLEIDLE\")\n\
			end\n\
		elseif iState == 4 then\n\
			-- local ptMiddle = g_world:GetObjectPosByName(\"fly_end\")		-- left top\n\
			-- actor:SetTranslate(ptMiddle)\n\
		elseif iState == 5 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_DarkBreath_SetState(actor,action,\"END_IDLE\")\n\
				--g_world:RecoverCameraAdjustInfo()\n\
			end\n\
		end\n\
\n\
	--end\n\
\n\
	-- actor:SeeFront(true, true)\n\
\n\
	-- local action = actor:GetAction()		--    \n\
	-- local actionParam = action:GetActionParam()\n\
	-- local curSlot = action:GetCurrentSlot()	--     \n\
	-- local curStage = action:GetCurrentStage()\n\
\n\
	-- local iNbExp = action:GetParamInt(0)\n\
	-- if actor:IsAnimationDone() == true then\n\
		-- if curSlot == 0 then\n\
			-- actor:PlayNext()\n\
		-- elseif curSlot == 2 and\n\
			-- curStage > iNbExp and\n\
			-- action:GetParam(219857) == \"TheEnd\" then\n\
			-- --  .\n\
			-- return false\n\
		-- end\n\
	-- elseif actionParam == AP_CASTING and\n\
		-- curSlot == 1 then\n\
		-- return true\n\
	-- end\n\
\n\
	--    .\n\
	-- if curStage >= 1 and actionParam == AP_FIRE then\n\
\n\
		-- --   .\n\
		-- --     !\n\
		-- local kLastExplosionTime = action:GetParamInt(982389);\n\
		-- local iNbExp = action:GetParamInt(0)\n\
		-- local iNbIdx = 0\n\
\n\
		-- local iStartParticleIDX = action:GetParamInt(90000)\n\
		-- if kLastExplosionTime == 0 or\n\
			-- iExplosionTerm < math.floor(accumTime * 1000 - kLastExplosionTime) then\n\
			\n\
			-- while iNbIdx < iNbExp and curStage <= iNbExp do\n\
				-- local kStartPos = action:GetParamAsPoint(iNbIdx * 2 + 1)\n\
				-- local kEndPos = action:GetParamAsPoint(iNbIdx * 2 + 2)\n\
\n\
				-- local kProgress = 0.0\n\
				-- while kProgress < 1.0 do\n\
					-- local kExplosionVector = kEndPos:_Subtract(kStartPos)\n\
					-- local kExpPos = kExplosionVector:_Multiply(kProgress)\n\
					-- kExpPos:Add(kStartPos)\n\
					-- kExpPos:SetZ(kExpPos:GetZ() + 100)\n\
					\n\
					-- local kFloorPos = g_world:ThrowRay(kExpPos, Point3(0,0,-1), 200)\n\
					-- if -1 ~= kFloorPos:GetX() and -1 ~= kFloorPos:GetY() and -1 ~= kFloorPos:GetZ() then\n\
						-- GetPlayer():AttachParticleToPointS(90000+iStartParticleIDX, kExpPos, \"e_ef_fossilearth_explosion\", 1.0)\n\
					-- end\n\
					\n\
					-- kProgress = math.min(kProgress + iExplosionParticleRadius / kExplosionVector:Length(), 1.0)\n\
					-- iStartParticleIDX = iStartParticleIDX + 1\n\
				-- end\n\
				-- action:NextStage()\n\
				-- iNbIdx = iNbIdx + 1\n\
			-- end\n\
		\n\
			-- action:SetParamInt(982389, math.floor(accumTime * 1000))\n\
\n\
			-- if curStage > iNbExp then\n\
				-- -- Action .\n\
				-- action:SetParam(219857 , \"TheEnd\")\n\
			\n\
				-- local kTargetList = action:GetTargetList()\n\
				-- kTargetList:ApplyActionEffects()\n\
			-- end\n\
		-- end\n\
		-- action:SetParamInt(90000, iStartParticleIDX)\n\
	-- end\n\
\n\
	return true\n\
end\n\
function Act_Mon_DarkBreath_OnCleanUp(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
	--g_world:RecoverCameraAdjustInfo()\n\
	return true\n\
end\n\
\n\
function Act_Mon_DarkBreath_OnLeave(actor, action)\n\
	local	iState = action:GetParamInt(0)\n\
	if iState == 5 then\n\
		if actor:IsAnimationDone() then\n\
			ODS(\"Act_Mon_DarkBreath_OnLeave\\n\",false,987)\n\
			return true\n\
		end\n\
	end\n\
	return false\n\
end\n\
\n\
\n\
function Act_Mon_DarkBreath_OnCastingCompleted(actor, action)\n\
	ODS(\"Act_Mon_DarkBreath_OnCastingCompleted\\n\",false,987)\n\
	Act_Mon_DarkBreath_SetState(actor, action, \"FIRE\")\n\
	return true\n\
end\n\
\n\
function Act_Mon_DarkBreath_OnEvent(actor, textKey, seqID)\n\
	--ODS(\"Key: \"..textKey..\"\\n\",false,987)\n\
	if textKey == \"set\" then\n\
		local	action = actor:GetAction()\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
		\n\
		local iHorMaxCount = 4\n\
		local iVerMaxCount = 20\n\
		\n\
		local fLen = action:GetParamFloat(200)\n\
		local fHalfLen = fLen / 2\n\
		\n\
		local kStartPoint = action:GetParamAsPoint(111)\n\
		\n\
		for it=1,80 do\n\
			local ibool = action:GetParamInt(it)\n\
			if ibool == 1 then\n\
				if( CheckNil(g_world == nil) ) then return false end\n\
				if( CheckNil(g_world:IsNil()) ) then return false end\n\
				local vPos = ((it-1) / iVerMaxCount) + 1\n\
				local hPos = ((it-1) % iVerMaxCount) + 1\n\
				local Offset = Point3(hPos * fLen - fHalfLen, vPos * fLen - fHalfLen, 0)\n\
				local kPoint = Point3(kStartPoint:GetX(), kStartPoint:GetY(), kStartPoint:GetZ())\n\
				kPoint:Add(Offset)\n\
				local kWarnPos = Point3(kPoint:GetX(), kPoint:GetY(), kPoint:GetZ()+100)\n\
				local kFloorPos = g_world:ThrowRay(kWarnPos, Point3(0,0,-1), 200)\n\
				\n\
				if -1 ~= kFloorPos:GetX() and -1 ~= kFloorPos:GetY() and -1 ~= kFloorPos:GetZ() then\n\
					GetPlayer():AttachParticleToPointS(90000 + it, kFloorPos, \"e_ef_fossilearth_target_01\", 1.0)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	if textKey == \"begin\" then\n\
		-- local kAction = actor:GetAction()\n\
		-- kAction:NextStage()\n\
		-- QuakeCamera(1,1,1,1,1)\n\
		local	action = actor:GetAction()\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
		\n\
		local iHorMaxCount = 4\n\
		local iVerMaxCount = 20\n\
		\n\
		local fLen = action:GetParamFloat(200)\n\
		local fHalfLen = fLen / 2\n\
		\n\
		local kStartPoint = action:GetParamAsPoint(111)\n\
		\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		for it=1,80 do\n\
			local ibool = action:GetParamInt(it)\n\
			if ibool == 1 then\n\
			\n\
				local vPos = ((it-1) / iVerMaxCount) + 1\n\
				local hPos = ((it-1) % iVerMaxCount) + 1\n\
				local Offset = Point3(hPos * fLen - fHalfLen, vPos * fLen - fHalfLen, 0)\n\
				local kPoint = Point3(kStartPoint:GetX(), kStartPoint:GetY(), kStartPoint:GetZ())\n\
				kPoint:Add(Offset)\n\
				local kWarnPos = Point3(kPoint:GetX(), kPoint:GetY(), kPoint:GetZ()+100)\n\
				local kFloorPos = g_world:ThrowRay(kWarnPos, Point3(0,0,-1), 200)\n\
				\n\
				if -1 ~= kFloorPos:GetX() and -1 ~= kFloorPos:GetY() and -1 ~= kFloorPos:GetZ() then\n\
					--ODS(\"Pos X : \"..kFloorPos:GetX()..\" Y : \"..kFloorPos:GetY()..\" Z : \"..kFloorPos:GetZ()..\"\\n\",false,987)\n\
					GetPlayer():AttachParticleToPointS(80000 + it, kFloorPos, \"ef_BoneDragon_skill_03_02_char_root\", 1.0)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	if textKey == \"fire\" or textKey == \"hit\" then\n\
		local	action = actor:GetAction()\n\
		if action:GetTargetList():IsNil() == false then\n\
			action:GetTargetList():ApplyActionEffects();\n\
		end\n\
		action:ClearTargetList();\n\
	end\n\
	\n\
	if textKey == \"quake\" then\n\
		Act_Mon_QuakeCamera(actor)\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_QuakeCamera(actor)\n\
	local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
	if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
		local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
		if  nil == QuakeFactor then\n\
			QuakeFactor = 1.0\n\
		else\n\
			QuakeFactor = tonumber(QuakeFactor)\n\
		end\n\
		QuakeCamera(QuakeTime, QuakeFactor)\n\
	end\n\
end\n\
\n\
function Act_Mon_DarkBreath_OnTargetListModified(actor,action,bIsBefore)\n\
	Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_BoneDragon_Die_CreateEndingActor(iNo, kPos)\n\
	local guid = GUID(\"123\")\n\
	guid:Generate()\n\
	\n\
	local pilot = g_pilotMan:NewPilot(guid, iNo, 0,\"NPC\")\n\
	\n\
	if pilot == nil or pilot:IsNil() == true then\n\
		return true\n\
	end\n\
	\n\
	local kActor = pilot:GetActor()\n\
	if kActor == nil or kActor:IsNil() == true then\n\
		return true\n\
	end\n\
	\n\
	if IsSingleMode() == false then\n\
		g_pilotMan:InsertPilot(guid,pilot);\n\
	end\n\
	\n\
	kActor:FreeMove(true)\n\
	kActor:SetUseLOD(false)\n\
	kActor:SetUseSmoothShow(false)\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:AddActor(guid, pilot:GetActor(), kPos, 6)\n\
	\n\
	-- local kTime = g_world:GetAccumTime()\n\
	-- kActor:SetAnimationStartTime(kTime)\n\
	\n\
	--pilot:SetName(kName);\n\
	pilot:GetActor():ClearReservedAction()\n\
	local kAction = pilot:GetActor():ReserveTransitAction(\"a_bonedragon_ending_movie\")\n\
	kAction:SetSlot(0)\n\
	kActor:ResetAnimation();\n\
	--kActor:PlayCurrentSlot();\n\
\n\
	pilot:GetActor():ClearActionState()\n\
	pilot:SetAbil(AT_HP, 1000000);\n\
	pilot:SetAbil(AT_UNIT_SIZE,2);\n\
	pilot:SetAbil(AT_DAMAGEACTION_TYPE,0);\n\
	pilot:SetAbil(AT_NOT_SEE_PLAYER, 0)\n\
	pilot:SetAbil(AT_DAMAGEACTION_TYPE, 0)	\n\
	\n\
	g_world:SetCameraModeMovie2(kActor, 2, 1000000, \"nop()\")\n\
end\n\
\n\
function Act_BoneDragon_Die_OnEnter(actor, action)\n\
	local ifirst = action:GetParamInt(20)\n\
	if ifirst == 1 then\n\
		return true\n\
	end\n\
	\n\
	local kEnding = actor:GetParam(\"ending\")\n\
	if kEnding == \"start\" then\n\
		return true\n\
	end\n\
	\n\
	action:SetParamInt(20,1)\n\
	\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Die_Start(actor, action)\n\
	\n\
	actor:SetParam(\"ending\", \"start\")\n\
\n\
	Act_BoneDragon_Die_Ready()\n\
	\n\
	local iActor = actor:GetAnimationInfoFromAniName(\"DIE_ACTOR\", \"die_01\")\n\
	if nil==iActor or true==iActor:IsNil() then\n\
		iActor = 6000952\n\
	else\n\
		iActor = tonumber(iActor:GetStr())\n\
	end	\n\
\n\
	local kPos = Point3(0, 0, -3500)\n\
	local kX = actor:GetAnimationInfoFromAniName(\"ENDING_ACTOR_X\", \"die_01\")\n\
	local kY = actor:GetAnimationInfoFromAniName(\"ENDING_ACTOR_Y\", \"die_01\")\n\
	local kZ = actor:GetAnimationInfoFromAniName(\"ENDING_ACTOR_Z\", \"die_01\")\n\
	if nil~=kX and false==kX:IsNil() then\n\
		kPos:SetX(tonumber(kX:GetStr()))\n\
	end\n\
	if nil~=kY and false==kY:IsNil() then\n\
		kPos:SetY(tonumber(kY:GetStr()))\n\
	end\n\
	if nil~=kZ and false==kZ:IsNil() then\n\
		kPos:SetZ(tonumber(kZ:GetStr()))\n\
	end\n\
\n\
	Act_BoneDragon_Die_CreateEndingActor(iActor, kPos)\n\
	actor:SetHide(true);\n\
	actor:SetHideShadow(true);\n\
\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Die_Ready()\n\
	LockPlayerInputMove(8) -- for aram lock\n\
	LockPlayerInput(8)\n\
	CloseAllUI()\n\
	\n\
	CallUI(\"FRM_MOVIE_IN\")\n\
	StopBgSound()	-- \n\
end\n\
\n\
function Act_BoneDragon_Die_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	action = actor:GetAction()\n\
	curSlot = action:GetCurrentSlot()\n\
	\n\
	if actor:IsAnimationDone() == true then\n\
		local kEnding = actor:GetParam(\"ending\")\n\
		if kEnding == \"start\" then\n\
			return true\n\
		end\n\
		Act_BoneDragon_Die_Start(actor, action)\n\
		action:SetSlot(1)\n\
		actor:PlayCurrentSlot()\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
\n\
\n\
function Act_BoneDragon_Die_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_BoneDragon_Die_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Die_OnLeave(actor, action)\n\
	if actor == nil then\n\
		return true\n\
	end\n\
	if actor:IsAnimationDone() ~= true then\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_BoneDragon_Ending_Movie_OnEnter(actor, action)\n\
\n\
	action:SetParamInt(20,1)\n\
	\n\
	action:SetSlot(0)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(1,0)\n\
\n\
	actor:SetParam(\"movie\", \"none\")\n\
	\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Ending_Movie_OnUpdate(actor, accumTime, frameTime)\n\
	if actor == nil or actor:IsNil() then\n\
		return false\n\
	end\n\
\n\
	action = actor:GetAction()		--    \n\
	curSlot = action:GetCurrentSlot()	--     \n\
\n\
	if curSlot == 0 and actor:IsAnimationDone() then	--   \n\
		local kPlay = action:GetParamInt(20)\n\
		if kPlay == 1 then\n\
			--  \n\
			local movie = actor:GetAnimationInfoFromAniName(\"DIE_MOVIE\", \"ending_movie\")\n\
			if nil~=movie and false==movie:IsNil() then\n\
				local kParam = actor:GetParam(\"movie\")\n\
				if kParam==\"none\" then	--  \n\
					g_MovieMgr:Play(movie:GetStr())\n\
					actor:SetParam(\"movie\", \"start\")\n\
					actor:SetHide(true);\n\
					actor:SetHideShadow(true);\n\
					return true\n\
				else-- \n\
					if g_MovieMgr:IsPlay() == true then	--   \n\
						return true\n\
					end\n\
				end\n\
			end\n\
			action:SetParamInt(20,0)\n\
			Act_BoneDragon_Ending_Movie_RemoveActor(actor)\n\
		end\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Ending_Movie_RemoveEndingActor(iNo)\n\
	if nil==iNo or 0==iNo then\n\
		iNo = 6000952\n\
	end\n\
	local kActor = g_pilotMan:FindActorByClassNo(iNo);\n\
	\n\
	if kActor == nil or kActor:IsNil() then\n\
		return	true\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:RemoveActorOnNextUpdate(kActor:GetPilotGuid())\n\
	g_world:RemoveCameraAM()\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Ending_Movie_RemoveActor(actor)\n\
	OnRecoveryMiniQuest(false)\n\
	-- \n\
	PlayBgSound(0)\n\
\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	g_world:SetShowWorldFocusFilterColorAlpha( 0x000000, 1.0, 0.0, 3.0, false )\n\
\n\
	Act_BoneDragon_Ending_Movie_RemoveEndingActor(actor:GetAbil(AT_CLASS))\n\
\n\
	if false==GetMyActor():IsNil() then\n\
		g_world:SetCameraMode(1, GetMyActor())\n\
	end\n\
	g_world:SetCameraFixed(true) --  \n\
\n\
	CloseUI(\"FRM_MOVIE_IN\")\n\
	UI_DefaultActivate( true )\n\
	UnLockPlayerInputMove(8) -- for aram lock\n\
	UnLockPlayerInput(8)\n\
	CallMapMove(false)\n\
	g_world:SetCameraZoom(1.0) -- \n\
	actor:SetParam(\"ending\", \"\")\n\
end\n\
\n\
function Act_BoneDragon_Ending_Movie_OnCleanUp(actor, action)\n\
	Act_BoneDragon_Ending_Movie_RemoveActor(actor)\n\
end\n\
\n\
function Act_BoneDragon_Ending_Movie_OnLeave(actor, action)\n\
   	if actor == nil then\n\
		return true\n\
	end\n\
	if actor:IsAnimationDone() ~= true then\n\
		return false\n\
	end\n\
\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_BoneDragon_Summon_Monster_OnCheckCanEnter(actor, action)\n\
	\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_SetState(actor,action,kState)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
		action:SetSlot(0)\n\
		iNewState = 0\n\
	elseif kState == \"IDLE\" then\n\
		action:SetSlot(1)\n\
		iNewState = 1\n\
	elseif kState == \"ATTACK\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2\n\
	elseif kState == \"LOOP\" then\n\
		action:SetSlot(3)\n\
		iNewState = 3\n\
	elseif kState == \"FINISH\" then\n\
		action:SetSlot(4)\n\
		iNewState = 4\n\
	end\n\
	ODS(\"state : \"..iNewState..\"\\n\",false,987)\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if actor:IsEqualObjectName(\"B_cleef_BoneDragon\") == true then\n\
		CallUI(\"FRM_GOGO_LEFT\")\n\
		AddWarnDataTT(403300)\n\
	end\n\
	\n\
	local kAniTime = action:GetAbil(AT_ANIMATION_TIME)\n\
	if kAniTime == 0 then\n\
		kAniTime = 8000\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(1, g_world:GetAccumTime())\n\
	action:SetParamFloat(2, kAniTime*0.001)\n\
	\n\
	ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_BoneDragon_Summon_Monster_SetState(actor,action,\"START\") == false) then\n\
			Act_BoneDragon_Summon_Monster_SetState(actor,action,\"IDLE\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_Melee_OnEnter Start Casting\\n\");\n\
		\n\
		--     .\n\
		local	kTargetList = action:GetTargetList();\n\
		local	iTargetCount = kTargetList:size();\n\
	\n\
		ODS(\"Act_Mon_Melee Casting Start iTargetCount :\"..iTargetCount..\"\\n\");\n\
\n\
		\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0);\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID());\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor();\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						--actor:LookAtBidirection(kTargetActor:GetPos());\n\
						actor:LookAt(kTargetActor:GetPos(),true,true);\n\
					\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
\n\
	return true\n\
end\n\
function Act_BoneDragon_Summon_Monster_OnCastingCompleted(actor,action)	\n\
\n\
	Act_BoneDragon_Summon_Monster_SetState(actor,action,\"ATTACK\")\n\
	Act_BoneDragon_Summon_Monster_FireEffect(actor)\n\
	Act_Mon_Melee_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local bAnimationDone = actor:IsAnimationDone()\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if iState == 2 then\n\
			if bAnimationDone == true then\n\
				Act_BoneDragon_Summon_Monster_SetState(actor,action,\"LOOP\")\n\
			end\n\
		elseif iState == 3 then\n\
			local kAccumTime = action:GetParamFloat(1)\n\
			local kAniTime = action:GetParamFloat(2)\n\
			if( CheckNil(g_world == nil) ) then return false end\n\
			if( CheckNil(g_world:IsNil()) ) then return false end\n\
			if g_world:GetAccumTime() - kAccumTime > kAniTime then\n\
				Act_BoneDragon_Summon_Monster_SetState(actor,action,\"FINISH\")\n\
			end\n\
		elseif iState == 4 then\n\
			if bAnimationDone == true then\n\
				return false\n\
			end\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if bAnimationDone then\n\
				Act_BoneDragon_Summon_Monster_SetState(actor,action,\"IDLE\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_OnCleanUp(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(125)\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	--ODS(\"Act_Mon_Melee_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
       ODS(\"Act_Mon_Melee_OnEvent actor:\"..actor:GetID()..\" textKey:\"..textKey..\"\\n\");\n\
       \n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
        local   action = actor:GetAction();\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
	\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
		Act_BoneDragon_Summon_Monster_FireEffect(actor)\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_FireEffect(actor)\n\
	local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
	if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
		local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")	\n\
		if  nil == QuakeFactor then\n\
			QuakeFactor = 1.0\n\
		else\n\
			QuakeFactor = tonumber(QuakeFactor)\n\
		end\n\
		QuakeCamera(QuakeTime, QuakeFactor)\n\
	end\n\
\n\
	local EffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
	local Effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	local EffectScale = actor:GetAnimationInfo(\"FIRE_EFFECT_SCALE\")\n\
	if nil==EffectScale or \"\"==EffectScale then\n\
		EffectScale = 1\n\
	else\n\
		EffectScale = tonumber(EffectScale)\n\
	end\n\
\n\
	if nil~=EffectNode and nil~=Effect then\n\
		actor:AttachParticleS(125, EffectNode, Effect, EffectScale)\n\
	end\n\
end\n\
\n\
function Act_BoneDragon_Summon_Monster_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Mon_SummonBone2_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_SummonBone2_SetState(actor,action,kState)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iNewState = -1;\n\
	if kState == \"BATTLEIDLE_START\" then\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
	\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
	\n\
		action:SetSlot(4)\n\
		iNewState = 3;\n\
\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
	\n\
	return	true;\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone2_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	local iStartPos = kPacket:PopInt()\n\
	local kStartPos = \"bone_start\"..iStartPos\n\
	\n\
	\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local ptStartPos = g_world:GetObjectPosByName(kStartPos)\n\
	\n\
	action:SetParamAsPoint(1, ptStartPos)\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_SummonBone2_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_SummonBone2_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_SummonBone2_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
	end\n\
	\n\
	action:DeleteParamPacket()\n\
	return true\n\
end\n\
function Act_Mon_SummonBone2_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_SummonBone2_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_SummonBone2_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_SummonBone2_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone2_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
		\n\
			local	iHitCount = action:GetParamInt(1)\n\
		\n\
			return iHitCount<10\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_SummonBone2_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_SummonBone2_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_SummonBone2_OnCleanUp(actor, action)\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone2_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Act_Mon_SummonBone2_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if bIsBefore == false then\n\
	\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
	\n\
	end\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone2_OnTimer(actor,accumtime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	iHitCount = action:GetParamInt(1)\n\
	if iHitCount == 10 then\n\
		return	false\n\
	end\n\
	\n\
	local	kLookDir = Point3(-1,0,0)\n\
	local	fPreDistance = 200\n\
	local	fDistance = 30.0\n\
	local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
	if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
		--fPreDistance = kSkillDef:GetAbil(AT_SKILL_MIN_RANGE)\n\
		\n\
		local iSkillRange = kSkillDef:GetAbil(AT_ATTACK_RANGE)\n\
		-- if 0 < iSkillRange then\n\
			-- fDistance = iSkillRange*0.1 --10 \n\
		-- end\n\
		\n\
		fDistance = action:GetParamFloat(211)\n\
	end\n\
	local ptStartPos = action:GetParamAsPoint(1)\n\
	local	kNextPos = ptStartPos:_Add(kLookDir:_Multiply(fPreDistance+iHitCount*fDistance))\n\
	\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
	if fireEffect == nil or \"\" == fireEffect then\n\
		fireEffect = \"ef_BoneDragon_skill_01_02_char_root\"\n\
	end	\n\
	if fireEffect ~= nil and \"\" ~= fireEffect then\n\
		local rot = 0--Random()%(math.pi)\n\
		local scale = actor:GetAnimationInfo(\"RANDOM_SCALE\")\n\
		if nil == scale then\n\
			scale = 1\n\
		end\n\
\n\
		actor:AttachParticleToPoint(3251, kNextPos ,fireEffect)\n\
	end				\n\
\n\
	local	kSoundID = actor:GetAnimationInfo(\"HIT_SOUND_ID\");\n\
	if kSoundID~=\"\" then\n\
		actor:AttachSound(2784+iHitCount,kSoundID)\n\
	end\n\
\n\
	iHitCount = iHitCount +1;\n\
	action:SetParamInt(1,iHitCount);\n\
	\n\
	return	iHitCount<10;\n\
\n\
end\n\
\n\
function Act_Mon_SummonBone2_OnEvent(actor,textKey)\n\
\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
		CheckNil(nil==actor);\n\
		CheckNil(actor:IsNil());		\n\
	\n\
		local FireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT2\")\n\
		if nil~=FireEffect and \"\"~=FireEffect then\n\
			local FireEffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE2\")\n\
			if nil==FireEffectNode or \"\"==FireEffectNode then\n\
				FireEffectNode = \"char_root\"\n\
			end\n\
			--actor:AttachParticle(3252, FireEffectNode ,FireEffect)\n\
		end\n\
		\n\
		Act_Mon_QuakeCamera(actor)\n\
			\n\
        local   action = actor:GetAction();\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
		local	kSkillDef = GetSkillDef(action:GetActionNo())\n\
		local kTotalTime = 1.0\n\
		\n\
		local kSpeed = kSkillDef:GetAbil(AT_MOVESPEED)\n\
		\n\
		if nil~=kSkillDef and false==kSkillDef:IsNil() then\n\
			\n\
			--ODS(\"speed : \"..kSpeed..\"\\n\",false,987)\n\
			if kSpeed <= 0 then\n\
				kSpeed = 200\n\
			end\n\
			local kRange = kSkillDef:GetAbil(AT_ATTACK_RANGE)\n\
			if kRange <= 0 then\n\
				kRange = 300\n\
			end\n\
\n\
			kTotalTime = kRange/kSpeed\n\
		end\n\
		local kTimeInter = kTotalTime*0.1\n\
	    action:StartTimer(kTotalTime,kTimeInter,0)\n\
		\n\
		local kMove = kTimeInter * kSpeed\n\
		action:SetParamFloat(211, kMove)\n\
		--ODS(\"Move : \"..kMove..\" inter :\"..kTimeInter..\" speed : \"..kSpeed..\"\\n\",false,987)\n\
--	    action:StartTimer(1.0,0.1,0)\n\
	    \n\
	end\n\
	\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("function Act_Mon_Target_Loc_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_Target_Loc_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kPacket = action:GetParamAsPacket()\n\
	local iPCount = kPacket:PopInt()\n\
	action:SetParamInt(1,iPCount)\n\
	\n\
	if iPCount == 0 then\n\
		return false\n\
	end\n\
	\n\
	local i = 0\n\
	while i < iPCount do\n\
		action:AddNewGUID(kPacket:PopGuid())\n\
		i = i + 1\n\
	end\n\
	\n\
\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Target_Loc_OnCastingCompleted(actor,action)\n\
	else\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
		\n\
	    ODS(\"Act_Mon_Target_Loc_OnEnter Start Casting\\n\");\n\
		\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_Target_Loc_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Target_Loc_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Target_Loc_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
	--   .\n\
\n\
end\n\
\n\
function Act_Mon_Target_Loc_OnUpdate(actor, accumTime, frameTime)\n\
\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
			return false\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Target_Loc_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Mon_Target_Loc_OnCleanUp(actor, action)\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	-- action:DeleteParamPacket()\n\
end\n\
\n\
function Act_Mon_Target_Loc_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Act_Mon_Target_Loc_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
\n\
function Act_Mon_Target_Loc_LoadToWeapon(kActor, kAction)\n\
	\n\
	local	kProjectileMan = GetProjectileMan()\n\
	local	kProjectileID = kActor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	if nil == kProjectileID then\n\
		return nil\n\
	end\n\
	\n\
	local	fProjetileScale = tonumber(kActor:GetAnimationInfo(\"PROJECTILE_SCALE\"))\n\
	if nil  == fProjetileScale then\n\
		fProjetileScale = 1.0\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID, kAction, kActor:GetPilotGuid())\n\
	if kNewArrow:IsNil() then\n\
		return nil\n\
	end\n\
	\n\
	local	kTargetNodeID = kActor:GetAnimationInfo(\"FIRE_START_NODE\")\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_heart\"\n\
	end\n\
	\n\
	local	fProjectileSpeed = kActor:GetAnimationInfo(\"PROJECTILE_SPEED\")\n\
	if nil ~= fProjectileSpeed then\n\
		fProjectileSpeed = tonumber(fProjectileSpeed)\n\
		kNewArrow:SetSpeed(fProjectileSpeed)\n\
	end\n\
	\n\
	kNewArrow:SetScale(fProjetileScale*kNewArrow:GetScale())\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID)\n\
	\n\
	return kNewArrow\n\
end\n\
\n\
function Act_Mon_Target_Loc_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	local	action = actor:GetAction()\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		local iPCount = action:GetParamInt(1)\n\
		local i = 0\n\
		while i < iPCount do\n\
			local kGuid = action:GetGUIDInContainer(i)\n\
			local kPilot = g_pilotMan:FindPilot(kGuid)\n\
			if kPilot ~= nil and kPilot:IsNil() == false then\n\
				local kArrow = Act_Mon_Target_Loc_LoadToWeapon(actor,action)\n\
				if kArrow ~= nil and kArrow:IsNil() == false then\n\
					kArrow:SetTargetLoc(kPilot:GetActor():GetNodeTranslate(\"p_ef_head\") )\n\
					kArrow:SetTargetGuidFromServer(kGuid)\n\
					kArrow:Fire()\n\
				end\n\
			end\n\
			i = i + 1\n\
		end\n\
		action:ClearTargetList()\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Target_Loc_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Mon_Multi_Shot_byS_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Act_Mon_Multi_Shot_byS_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local kPacket = action:GetParamAsPacket()\n\
	if kPacket:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	action:SetParamFloat(91, kPacket:PopFloat())\n\
	action:SetParamFloat(92, kPacket:PopFloat())\n\
	action:SetParamFloat(93, kPacket:PopFloat())\n\
\n\
	local	prevAction = actor:GetAction()\n\
	if prevAction:GetID() ~= \"a_jump\" then\n\
		actor:Stop()\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Multi_Shot_byS_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
	end\n\
	\n\
	return true\n\
end\n\
function Act_Mon_Multi_Shot_byS_OnCastingCompleted(actor,action)	\n\
\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	\n\
	Act_Mon_Multi_Shot_byS_Fire(actor,action);\n\
	\n\
end\n\
\n\
function Act_Mon_Multi_Shot_byS_Fire(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--GetActionResultCS(action, actor)\n\
\n\
end\n\
\n\
function Act_Mon_Multi_Shot_byS_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
	\n\
		if actor:IsAnimationDone() == true then\n\
		\n\
			local iHitCount = action:GetParamInt(1)\n\
			local iMax = action:GetParamInt(2)\n\
			if iMax == 0 then\n\
				iMax = 10\n\
			end\n\
			return iHitCount<=iMax\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Multi_Shot_byS_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	\n\
	end\n\
	return true\n\
end\n\
function Act_Mon_Multi_Shot_byS_OnCleanUp(actor, action)\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	-- action:DeleteParamPacket()\n\
end\n\
\n\
function Act_Mon_Multi_Shot_byS_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Act_Mon_Multi_Shot_byS_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if bIsBefore == false then\n\
		Act_Mon_Melee_DoDamage(actor,action);\n\
	end\n\
end\n\
\n\
function Act_Mon_Multi_Shot_byS_OnTimer(actor,accumtime,action,iTimerID)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local iMax = action:GetParamInt(2)\n\
	local iHitCount = action:GetParamInt(1)\n\
	if iHitCount == iMax then\n\
		return	false\n\
	end\n\
	\n\
	local fireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")	\n\
	if fireEffect == nil or \"\" == fireEffect then\n\
		fireEffect = \"ef_BoneDragon_skill_01_02_char_root\"\n\
	end	\n\
	local scale = actor:GetAnimationInfo(\"RANDOM_SCALE\")\n\
	if nil == scale then\n\
		scale = 1\n\
	end\n\
	\n\
	local	kSoundID = actor:GetAnimationInfo(\"HIT_SOUND_ID\");\n\
	\n\
	local fDistance = action:GetParamFloat(211)\n\
	local iPCount = action:GetParamInt(3)\n\
	\n\
	local iCount = 1\n\
	while iCount <= iPCount do\n\
		local ptStartPos = action:GetParamAsPoint(0)\n\
		local kDir = action:GetParamAsPoint(iCount)\n\
		local kNextPos = ptStartPos:_Add(kDir:_Multiply(iHitCount*fDistance))\n\
		\n\
		actor:AttachParticleToPoint(3000+iHitCount+(iCount*100), kNextPos ,fireEffect)\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2700+iHitCount,kSoundID)\n\
		end\n\
		iCount = iCount + 1\n\
	end\n\
\n\
	iHitCount = iHitCount +1\n\
	action:SetParamInt(1,iHitCount)\n\
	\n\
	return	iHitCount<=iMax\n\
\n\
end\n\
\n\
function Act_Mon_Multi_Shot_byS_OnEvent(actor,textKey)\n\
\n\
    if textKey == \"hit\" or textKey == \"fire\" then\n\
		\n\
		CheckNil(nil==actor);\n\
		CheckNil(actor:IsNil());		\n\
	\n\
		local FireEffect = actor:GetAnimationInfo(\"FIRE_EFFECT2\")\n\
		if nil~=FireEffect and \"\"~=FireEffect then\n\
			local FireEffectNode = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE2\")\n\
			if nil==FireEffectNode or \"\"==FireEffectNode then\n\
				FireEffectNode = \"char_root\"\n\
			end\n\
			actor:AttachParticle(3000, FireEffectNode ,FireEffect)\n\
		end\n\
		\n\
		Act_Mon_QuakeCamera(actor)\n\
			\n\
        local   action = actor:GetAction()\n\
		\n\
		CheckNil(nil==action)\n\
		CheckNil(action:IsNil())\n\
		\n\
		local kSkill = GetSkillDef(action:GetActionNo())\n\
		if nil==kSkill or kSkill:IsNil() then\n\
			return false\n\
		end\n\
\n\
		local kSpeed = kSkill:GetAbil(AT_MOVESPEED)\n\
		\n\
		if kSpeed <= 0 then\n\
			kSpeed = 100\n\
		end\n\
		local kRange = kSkill:GetAbil(AT_ATTACK_RANGE)\n\
		if kRange <= 0 then\n\
			kRange = 1000\n\
		end\n\
\n\
		local kTotalTime = kRange/kSpeed\n\
\n\
		\n\
		local kTimeInter = kTotalTime*0.1\n\
		local kMove = kTimeInter * kSpeed\n\
		action:SetParamFloat(211, kMove)\n\
		action:SetParamInt(2,kTotalTime/kTimeInter)\n\
\n\
		local ptStartPos = actor:GetTranslate()\n\
		action:SetParamAsPoint(0, ptStartPos)\n\
		action:SetParamInt(1,1)\n\
\n\
		local kTargetPos = Point3(action:GetParamFloat(91), action:GetParamFloat(92), action:GetParamFloat(93))\n\
		local kDir = kTargetPos:_Subtract(ptStartPos)\n\
		kDir:Unitize()\n\
\n\
		local iPCount = kSkill:GetAbil(AT_MON_PROJECTILE_NUM)\n\
		local iAngle = kSkill:GetAbil(AT_MON_PROJECTILE_ANGLE)\n\
		\n\
		local iFirstAngle = (iPCount - 1) * iAngle / 2\n\
		\n\
		local fFirstAngle = math.pi * iFirstAngle / 180.0\n\
		local fAngle = math.pi * iAngle / 180.0\n\
		\n\
		local fFirstCos = math.cos(fFirstAngle)\n\
		local fFirstSin = math.sin(fFirstAngle)\n\
		\n\
		local kFirst = Point3(0,0,0)\n\
		kFirst:SetX((kDir:GetX() * fFirstCos) + (kDir:GetY() * fFirstSin))\n\
		kFirst:SetY((kDir:GetX() * fFirstSin) + (kDir:GetY() * fFirstCos))\n\
		kFirst:Unitize()\n\
		\n\
		action:SetParamInt(3,iPCount)\n\
		action:SetParamAsPoint(1, kFirst)\n\
\n\
		local iCount = 2\n\
		while iCount <= iPCount do\n\
			local fCos = math.cos(-(fAngle*iCount))\n\
			local fSin = math.sin(-(fAngle*iCount))\n\
			local kRot = Point3(0,0,0)\n\
			kRot:SetX((kFirst:GetX() * fCos) + (kFirst:GetY() + fSin))\n\
			kRot:SetY((kFirst:GetX() + fSin) + (kFirst:GetY() + fCos))\n\
			kRot:Unitize()\n\
			action:SetParamAsPoint(iCount, kRot)\n\
			\n\
			iCount = iCount + 1\n\
		end\n\
		\n\
	    action:StartTimer(kTotalTime,kTimeInter,0)\n\
	end\n\
	\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_Paris_Laser_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_Paris_Laser_OnCastingCompleted(actor, action)\n\
\n\
	ODS(\"Act_Mon_Paris_Laser_OnCastingCompleted\\n\");\n\
	\n\
	Act_Mon_Melee_SetState(actor,action,\"FIRE\")\n\
	Act_Mon_Paris_Laser_Fire(actor,action);\n\
	actor:DetachFrom(91)	\n\
	\n\
end\n\
\n\
function	Act_Mon_Paris_Laser_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kProjectileID = actor:GetAnimationInfo(\"PROJECTILE_ID\")\n\
	\n\
	if kProjectileID == nil then\n\
--		kProjectileID = \"PROJECTILE_ANTARES_LASER\"\n\
		kProjectileID = \"PROJECTILE_MAGE_DEFAULT_SHOT\"\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..iProjectileIndex);\n\
	if kTargetNodeID == nil then\n\
		kTargetNodeID = \"p_ef_weapon\"\n\
	end\n\
	\n\
	kNewArrow:LoadToHelper(actor,kTargetNodeID);	--	\n\
	return kNewArrow;\n\
\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Fire(actor,action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	kEffect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	if nil==kEffect or \"\"==kEffect then\n\
		--kEffect = \"e_b_palis_skill_02_BlackBeem_char_roor\"\n\
		return\n\
	end\n\
\n\
	local kFireCount = action:GetParamInt(11)\n\
	local kNotFirePos = action:GetParamInt(12)\n\
	for i=0,kFireCount do\n\
		local	kTargetNodeID = actor:GetAnimationInfoFromAniName(\"FIRE_START_NODE\"..i, \"skill_shot_01\")\n\
		if nil~=kTargetNodeID and false==kTargetNodeID:IsNil() and i~=kNotFirePos then\n\
			actor:AttachParticle(231+i, kTargetNodeID:GetStr(), kEffect)\n\
		end\n\
	end\n\
end\n\
\n\
function Act_Mon_Paris_Laser_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Act_Mon_Melee_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
		\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Paris_Laser_OnCastingCompleted(actor,action)\n\
	else\n\
		local Effect = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT\", \"btlidle_01_skill_shot\")\n\
		if false==Effect:IsNil() and \"\"~=Effect:GetStr() then\n\
			action:SetParam(88,Effect:GetStr())\n\
			local EffectNode = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT_NODE\", \"btlidle_01_skill_shot\")\n\
			if true==EffectNode:IsNil() or \"\"==EffectNode:GetStr() then\n\
				EffectNode = \"char_root\"\n\
			end\n\
			action:SetParam(89,EffectNode:GetStr())\n\
			local EffectScale = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT_SCALE\", \"btlidle_01_skill_shot\")\n\
			if false==EffectScale:IsNil() and \"\"~=EffectScale:GetStr() then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale:GetStr())\n\
			end\n\
			action:SetParamFloat(90,EffectScale)\n\
		end\n\
\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			local Effect = action:GetParam(88)\n\
			if nil~=Effect and \"\"~=Effect and \"null\"~=Effect then\n\
				actor:AttachParticleS(91, action:GetParam(89), Effect, action:GetParamFloat(90))\n\
			end\n\
		end	\n\
				\n\
		actor:SeeFront(true, true)	\n\
	end\n\
\n\
	action:SetParamFloat(4, 0)	-- \n\
	action:SetParamInt(5, 0)	--  \n\
	action:SetParam(6, \"end\")	--,   \n\
	action:SetParamFloat(7, 0)	-- \n\
\n\
	local	fSpeed = actor:GetAnimationInfo(\"ROT_SPEED\")	--\n\
	if nil==fSpeed or \"\"==fSpeed then\n\
		fSpeed = 180\n\
	else\n\
		fSpeed = tonumber(fSpeed)\n\
	end\n\
	local	fTotalAngle = actor:GetAnimationInfo(\"ROT_ANGLE\")\n\
	if nil==fTotalAngle or 0==fTotalAngle then\n\
		fTotalAngle = 90\n\
	end\n\
\n\
	action:SetParamFloat(8, fSpeed)	--\n\
	action:SetParamFloat(9, fTotalAngle)	--\n\
	local iMainTime = action:GetAbil(AT_MAINTENANCE_TIME)\n\
	if 0>=iMainTime  then\n\
		iMainTime = 3000\n\
	end\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(10, g_world:GetAccumTime() + iMainTime*0.001)	--\n\
\n\
	actor:SeeFront(true)\n\
\n\
	local kFireCount = action:GetAbil(AT_CUSTOMDATA1)\n\
	if 0==kFireCount then\n\
		kFireCount = 3\n\
	end\n\
\n\
	action:SetParamInt(11, kFireCount)	-- \n\
\n\
	local kNotFirePos = action:GetAbil(AT_CUSTOMDATA2)\n\
	if 0==kNotFirePos then	--0     ;;;;;;\n\
		kNotFirePos = -1\n\
	end\n\
	action:SetParamInt(12, kNotFirePos)	--  \n\
	\n\
	return true\n\
end \n\
\n\
function Act_Mon_Paris_Laser_FireProjectile(actor, action, iProjectileIndex)\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..iProjectileIndex);\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_weapon\"\n\
	end\n\
\n\
	local	kArrow = Act_Mon_Paris_Laser_LoadToWeapon(actor,action,iProjectileIndex);\n\
	if kArrow == nil or kArrow:IsNil() then\n\
		return false\n\
	end\n\
\n\
	if kArrow:IsNil() == false then\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
	end\n\
\n\
	local weaponrot = actor:GetNodeRotateAxis(kTargetNodeID,2, true)\n\
	weaponrot:Multiply(-1)\n\
	local weaponpos = actor:GetNodeWorldPos(kTargetNodeID)\n\
	local kEndnode = kTargetNodeID..\"_end\"\n\
	local weaponendpos = actor:GetNodeWorldPos(kEndnode)\n\
	local dir = Point3(weaponendpos:GetX() - weaponpos:GetX(), weaponendpos:GetY() - weaponpos:GetY(), weaponendpos:GetZ() - weaponpos:GetZ())\n\
	\n\
	dir:Unitize()\n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	local TargetPos = g_world:ThrowRay(weaponpos,dir,500)	--   \n\
	if -1==TargetPos:GetX() and -1==TargetPos:GetY() and -1==TargetPos:GetZ() then	--  \n\
		dir:Multiply(action:GetAbil(AT_ATTACK_RANGE))\n\
		TargetPos = weaponpos\n\
		TargetPos:Add(dir)\n\
	end\n\
\n\
	kArrow:SetTargetLoc(TargetPos)	\n\
	kArrow:Fire(true);\n\
	action:SetParamInt(5, action:GetParamInt(5)+1)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Paris_Laser_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		actor:IncRotate(action:GetParamFloat(8)*math.pi/180*frameTime)\n\
		local kFireCount = action:GetParamInt(11)\n\
		local kNotFirePos = action:GetParamInt(12)\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			for i=0,kFireCount do \n\
				if i~=kNotFirePos then\n\
	 				actor:DetachFrom(231+i) \n\
				end\n\
			end\n\
			return false\n\
		else\n\
			if accumTime > action:GetParamFloat(10) then\n\
				for i=0,kFireCount do \n\
					if i~=kNotFirePos then\n\
						actor:DetachFrom(231+i) \n\
					end\n\
				end\n\
				return false\n\
			end\n\
		end\n\
		local pasttime = action:GetParamFloat(4)\n\
		local delta = accumTime - action:GetParamFloat(4)\n\
\n\
		if \"fire\"==action:GetParam(6) or \"hit\"==action:GetParam(6) then\n\
\n\
			local inter = actor:GetAnimationInfo(\"SHOT_INTER_TIME\")\n\
			if inter == nil then\n\
				inter = 0.3\n\
			else\n\
				inter = tonumber(inter)\n\
			end\n\
\n\
			if inter < delta then\n\
\n\
				action:SetParamFloat(4, accumTime) \n\
\n\
				for i=0,kFireCount do\n\
					if i~=kNotFirePos then\n\
						Act_Mon_Paris_Laser_FireProjectile(actor, action, i)\n\
					end\n\
				end\n\
			end\n\
\n\
		end\n\
\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
				local Effect = action:GetParam(88)\n\
				if nil~=Effect and \"\"~=Effect and \"null\"~=Effect  then\n\
					actor:AttachParticleS(91, action:GetParam(89), Effect, action:GetParamFloat(90))\n\
				end\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Paris_Laser_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Mon_Paris_Laser_OnCleanUp(actor)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	if actor:GetAction():GetParamInt(4) == 1 then\n\
		actor:HideParts(EQUIP_POS_WEAPON, false)	--	  \n\
		actor:GetAction():SetParamInt(4,0);\n\
	end	\n\
	local kFireCount = actor:GetAction():GetParamInt(11)\n\
	for i=0,kFireCount do actor:DetachFrom(231+i) end\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Paris_Laser_OnLeave(actor, action)\n\
	local kFireCount = actor:GetAction():GetParamInt(11)\n\
\n\
	for i=0,kFireCount do actor:DetachFrom(231+i) end\n\
	return true;\n\
end\n\
\n\
function Act_Mon_Paris_Laser_OnEvent(actor,textKey)\n\
\n\
	ODS(\"Act_Mon_Paris_Laser_OnEvent textKey:\"..textKey..\"\\n\");\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	if kAction:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		kAction:SetParam(6,textKey)\n\
\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			actor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,actor);\n\
		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
--		local	kProjectileMan = GetProjectileMan();\n\
		\n\
--		local	iProjectileIndex = 0\n\
\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
				\n\
		local	iTargetCount = kAction:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
		local	kActionTargetInfo = nil\n\
\n\
	end\n\
\n\
	return	true;\n\
end\n\
\n\
function Act_Mon_Paris_Laser_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- Melee\n\
function Act_Mon_Paris_Laser_Multi_OnCheckCanEnter(actor,action)\n\
\n\
	return		true;\n\
	\n\
end\n\
function Act_Mon_Paris_Laser_Multi_OnCastingCompleted(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());		\n\
	Act_Mon_Paris_Laser_OnCastingCompleted(actor, action)\n\
	actor:DetachFrom(91)\n\
end\n\
\n\
function	Act_Mon_Paris_Laser_Multi_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
	return Act_Mon_Paris_Laser_LoadToWeapon(actor,action,iProjectileIndex)\n\
\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_Fire(actor,action)\n\
	Act_Mon_Paris_Laser_Fire(actor,action)\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_OnEnter(actor, action)\n\
	\n\
	if false==Act_Mon_Paris_Laser_OnEnter(actor, action) then\n\
		return false\n\
	end\n\
\n\
	action:SetParamFloat(8, 0)	-- \n\
	action:SetParamInt(11,0)	-- \n\
	\n\
	local kProjCount = action:GetAbil(AT_COUNT)\n\
	if 0==kProjCount then\n\
		kProjCount = 3\n\
	end\n\
	action:SetParamInt(13, kProjCount)	--  \n\
\n\
	local	iInterAngle = actor:GetAbil(AT_MON_PROJECTILE_ANGLE)\n\
	if nil==iInterAngle or 0==iInterAngle then\n\
		iInterAngle = 10\n\
	end\n\
\n\
	iInterAngle = iInterAngle*math.pi/180.0\n\
	action:SetParamFloat(140,iInterAngle) \n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Act_Mon_Paris_Laser_Multi_OnCastingCompleted(actor,action)\n\
	else\n\
		local Effect = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT\", \"btlidle_02_skill_shot\")\n\
		if false==Effect:IsNil() and \"\"~=Effect:GetStr() then\n\
			action:SetParam(88,Effect:GetStr())\n\
			local EffectNode = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT_NODE\", \"btlidle_02_skill_shot\")\n\
			if true==EffectNode:IsNil() or \"\"==EffectNode:GetStr() then\n\
				EffectNode = \"char_root\"\n\
			end\n\
			action:SetParam(89,EffectNode:GetStr())\n\
			local EffectScale = actor:GetAnimationInfoFromAniName(\"CAST_EFFECT_SCALE\", \"btlidle_02_skill_shot\")\n\
			if false==EffectScale:IsNil() and \"\"~=EffectScale:GetStr() then\n\
				EffectScale = 1\n\
			else\n\
				EffectScale = tonumber(EffectScale:GetStr())\n\
			end\n\
			action:SetParamFloat(99,EffectScale)\n\
		end\n\
		if( Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			local Effect = action:GetParam(89)\n\
			if nil~=Effect and \"\"~=Effect and \"null\"~=Effect then\n\
				actor:AttachParticleS(91, action:GetParam(90), Effect, action:GetParamFloat(99))\n\
			end\n\
		end	\n\
				\n\
		--     .\n\
		local	kTargetList = action:GetTargetList()\n\
		local	iTargetCount = kTargetList:size()\n\
	\n\
		if iTargetCount>0 then\n\
			local	kTargetInfo = kTargetList:GetTargetInfo(0)\n\
			if kTargetInfo:IsNil() == false then\n\
			\n\
				local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
				if kTargetPilot:IsNil() == false then\n\
				\n\
					local	kTargetActor = kTargetPilot:GetActor()\n\
					if kTargetActor:IsNil() == false then\n\
					\n\
						actor:LookAt(kTargetActor:GetPos(),true,true)\n\
					end\n\
				end\n\
			end\n\
		end\n\
	end\n\
	\n\
	return true\n\
end \n\
\n\
function Act_Mon_Paris_Laser_Multi_FireProjectile(actor, action, iProjectileIndex)\n\
\n\
	local	kTargetNodeID = actor:GetAnimationInfo(\"FIRE_START_NODE\"..iProjectileIndex);\n\
	if nil == kTargetNodeID then\n\
		kTargetNodeID = \"p_ef_weapon\"\n\
	end\n\
\n\
	local weaponrot = actor:GetNodeRotateAxis(kTargetNodeID,2, true)\n\
	weaponrot:Multiply(-1)\n\
	local weaponpos = actor:GetNodeWorldPos(kTargetNodeID)\n\
	local kEndnode = kTargetNodeID..\"_end\"\n\
	local weaponendpos = actor:GetNodeWorldPos(kEndnode)\n\
	--ODS(\"FireProjectile : \" .. weaponendpos:GetX() .. \", \" .. weaponendpos:GetY() .. \", \" .. weaponendpos:GetZ() .. \"\\n\")\n\
	local dir\n\
	if 0~=weaponendpos:GetX() and 0~=weaponendpos:GetY() and 0~= weaponendpos:GetZ() then\n\
		dir = Point3(weaponendpos:GetX() - weaponpos:GetX(), weaponendpos:GetY() - weaponpos:GetY(), weaponendpos:GetZ() - weaponpos:GetZ())\n\
	else\n\
		dir = actor:GetLookingDir()\n\
	end\n\
	\n\
	dir:Unitize()\n\
	local kOrigin = Point3(dir:GetX(), dir:GetY(), dir:GetZ())\n\
	local	kRotateAxis = Point3(0,0,1)\n\
\n\
	local kProjCount = action:GetParamInt(13)\n\
	local iInterAngle = action:GetParamFloat(140)\n\
	local iInitRot = (iInterAngle*0.5)*(kProjCount-1)\n\
	dir:Rotate(kRotateAxis, iInitRot)	--    \n\
	for i=1,kProjCount do\n\
		dir:Rotate(kRotateAxis, -iInterAngle)	\n\
	\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		local TargetPos = g_world:ThrowRay(weaponpos,dir,500)	--   \n\
		if -1==TargetPos:GetX() and -1==TargetPos:GetY() and -1==TargetPos:GetZ() then	--  \n\
			dir:Multiply(action:GetAbil(AT_ATTACK_RANGE))\n\
			TargetPos = weaponpos\n\
			TargetPos:Add(dir)\n\
		end\n\
\n\
		local	kArrow = Act_Mon_Paris_Laser_Multi_LoadToWeapon(actor,action,iProjectileIndex);\n\
		if kArrow == nil or kArrow:IsNil() then\n\
			return false\n\
		end\n\
\n\
		if 0 < kArrow:GetHomingTime() then\n\
			local	kTargetList = action:GetTargetList()\n\
			local	iTargetCount = kTargetList:size()\n\
			if iTargetCount>0 then\n\
				local	kRandIdx = math.random(0,iTargetCount-1)\n\
				local	kTargetInfo = kTargetList:GetTargetInfo(kRandIdx)\n\
				if kTargetInfo:IsNil() == false then\n\
					local	kTargetPilot = g_pilotMan:FindPilot(kTargetInfo:GetTargetGUID())\n\
					if kTargetPilot:IsNil() == false and kTargetPilot:IsAlive() then\n\
						kArrow:SetTargetGuidFromServer(kTargetInfo:GetTargetGUID())\n\
					end\n\
				end\n\
			end\n\
		end\n\
\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp())\n\
		kArrow:SetTargetLoc(TargetPos)	\n\
		kArrow:Fire(true);\n\
	end\n\
	action:SetParamInt(5, action:GetParamInt(5)+1)\n\
\n\
\n\
	return true\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
--	local nextActionName = action:GetNextActionName()\n\
	local actionID = action:GetID();\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		local kFireCount = action:GetParamInt(11)\n\
		local kNotFirePos = action:GetParamInt(12)\n\
		if animDone == true then\n\
			action:SetParam(1, \"end\")\n\
			for i=0,kFireCount do \n\
				if i~=kNotFirePos then\n\
	 				actor:DetachFrom(231+i) \n\
				end\n\
			end\n\
\n\
			if 2==iState then\n\
				Act_Mon_Melee_SetState(actor,action,\"RETURN\")\n\
			else\n\
				return false\n\
			end\n\
		else\n\
			if accumTime > action:GetParamFloat(10) then\n\
				for i=0,kFireCount do \n\
					if i~=kNotFirePos then\n\
						actor:DetachFrom(231+i) \n\
					end\n\
				end\n\
				return false\n\
			end\n\
		end\n\
		local pasttime = action:GetParamFloat(4)\n\
		local delta = accumTime - action:GetParamFloat(4)\n\
\n\
		if \"fire\"==action:GetParam(6) or \"hit\"==action:GetParam(6) then\n\
\n\
			local bOneShot = actor:GetAnimationInfo(\"IS_FIRE_ONE_SHOT\")\n\
			if bOneShot == \"TRUE\" then\n\
				action:SetParam(6, \"end\")\n\
			end\n\
\n\
			local inter = actor:GetAnimationInfo(\"SHOT_INTER_TIME\")\n\
			if inter == nil then\n\
				inter = 0.4\n\
			else\n\
				inter = tonumber(inter)\n\
			end\n\
\n\
			if inter < delta then\n\
\n\
				action:SetParamFloat(4, accumTime) \n\
\n\
				for i=0,kFireCount do\n\
					if i~=kNotFirePos then\n\
						Act_Mon_Paris_Laser_Multi_FireProjectile(actor, action, i)\n\
					end\n\
				end\n\
			end\n\
\n\
		end\n\
\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
	\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Act_Mon_Melee_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
				local Effect = action:GetParam(88)\n\
				if nil~=Effect and \"\"~=Effect and \"null\"~=Effect then\n\
					actor:AttachParticleS(91, action:GetParam(89), Effect, action:GetParamFloat(99))\n\
				end\n\
			end\n\
		end\n\
			\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Act_Mon_Paris_Laser_Multi_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
		\n\
	end\n\
	return true\n\
\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_OnCleanUp(actor)\n\
	return Act_Mon_Paris_Laser_OnCleanUp(actor)\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_OnLeave(actor, action)\n\
	return Act_Mon_Paris_Laser_OnLeave(actor, action)\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_OnEvent(actor,textKey)\n\
	return Act_Mon_Paris_Laser_OnEvent(actor,textKey)\n\
end\n\
\n\
function Act_Mon_Paris_Laser_Multi_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
function IsJobSkill(kAction)\n\
	if(nil == kAction) then return false; end	\n\
	if( false == kAction:IsNil() ) then\n\
		if( 7 == kAction:GetAbil(AT_SKILL_DIVIDE_TYPE) ) then\n\
			return true;\n\
		end\n\
	end\n\
	return false;\n\
end\n\
\n\
-- Melee\n\
function JobSkill_Begin_OnCheckCanEnter(actor,action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	return true\n\
end\n\
\n\
function JobSkill_Begin_OnEnter(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local actionID = action:GetID()	\n\
	--ODS(\"JobSkill_Begin_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\" SkillLevel:\"..action:GetSkillLevel()..\"\\n\", false, 912)\n\
	\n\
	\n\
	--   \n\
	\n\
	SkillHelpFunc_InitHitCount(action)					-- HitCount 	\n\
	SkillHelpFunc_ExpressCastingEffect(actor, action)	--     	\n\
	SkillHelpFunc_PlayCastingSound(actor, action) 		--  	\n\
	SkillHelpFunc_PlaySound(actor, action, \"JOB_SKILL_TOOL_SOUND1\")\n\
	SkillHelpFunc_AttachParticleToNode(10001, \"JOB_SKILL_TOOL_EFFECT_ID1\", \"JOB_SKILL_TOOL_TARGET_NODE1\", 1, actor, action)\n\
	SkillHelpFunc_AttachParticleToNode(10002, \"JOB_SKILL_EFFECT_ID1\", \"JOB_SKILL_EFFECT_TARGET_NODE1\", 1, actor, action)\n\
	\n\
	--  \n\
	if action:GetActionParam() == AP_CASTING then\n\
		return	true\n\
	end\n\
	\n\
	--  \n\
	JobSkill_Begin_OnCastingCompleted(actor,action) \n\
\n\
	local kMulptiple = action:GetScriptParam(\"EXPRESS_FAKE_MULTIPLE_ATTACK\")\n\
	if kMulptiple~=\"\" then	--     \n\
		action:SetParamInt(100,1)\n\
		action:SetParamInt(10,1) -- Timer  CreateTargetList 1    \n\
	end	\n\
\n\
	actor:LockBidirection(false)	-- 8  \n\
	\n\
	if not actor:IsMyActor() then\n\
		--     \n\
		local kPacket = action:GetParamAsPacket()\n\
		local kLookAtPos = kPacket:PopPoint3()\n\
		actor:LookAt(kLookAtPos)\n\
		--ODS(\" X:\"..kLookAtPos:GetX()..\" Y:\"..kLookAtPos:GetY()..\" Z:\"..kLookAtPos:GetZ()..\"\\n\", false, 912)\n\
	else\n\
		local	kTrigger = actor:GetCurrentTrigger()\n\
		if kTrigger:IsNil() == false then\n\
			action:SetParam(9875, kTrigger:GetID())\n\
		end\n\
	end\n\
	\n\
	--    \n\
	local kPrevAction = actor:GetAction()\n\
	local fAniSpeed = 1\n\
	if(false == kPrevAction:IsNil()) then\n\
		local iTotalTime =  kPrevAction:GetParamInt(20110817)\n\
		if(0 >= iTotalTime) then iTotalTime = 10000 end\n\
		fAniSpeed = 10000 / iTotalTime\n\
		if( 1 > fAniSpeed ) then fAniSpeed = 1 end\n\
			\n\
		actor:SetAnimSpeed(fAniSpeed)\n\
		--ODS(\"iTotalTime:\"..iTotalTime..\" fAniSpeed:\"..fAniSpeed..\"\\n\", false, 912)\n\
	end\n\
	action:SetParamFloat(20110817, fAniSpeed)\n\
	return true\n\
end\n\
\n\
function JobSkill_Begin_OnOverridePacket(actor, action, packet)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local kLookAtPos = actor:GetLookingDir()\n\
	kLookAtPos:Add(actor:GetPos())\n\
	packet:PushPoint3(kLookAtPos)\n\
	\n\
	--ODS(\" X:\"..kLookAtPos:GetX()..\" Y:\"..kLookAtPos:GetY()..\" Z:\"..kLookAtPos:GetZ()..\"\\n\", false, 912)\n\
	\n\
end\n\
\n\
function JobSkill_Begin_OnCastingCompleted(actor, action)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	JobSkill_Begin_Fire(actor,action)\n\
--	action:SetSlot(action:GetCurrentSlot()+1)\n\
	actor:PlayCurrentSlot()\n\
	\n\
	SkillHelpFunc_SetNoneCastingState(action)	--  \n\
	\n\
	--       \n\
	SkillHelpFunc_PlaySound(actor, action, \"JOB_SKILL_CRITICAL_SOUND\")\n\
	SkillHelpFunc_AttachParticleToNode(10005, \"JOB_SKILL_CRITICAL_EFFECT_ID\", \"JOB_SKILL_CRITICAL_TARGET_NODE\", 1, actor, action)\n\
\n\
	--ODS(\"JobSkill_Begin_OnCastingpleted \\n\", false, 912)\n\
end\n\
\n\
function JobSkill_Begin_OnUpdate(actor, accumTime, frameTime)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot()\n\
	local iMaxActionSlot = action:GetSlotCount()\n\
\n\
	if animDone == true then\n\
		if( iSlot < iMaxActionSlot) then\n\
			action:SetSlot(iSlot+1)\n\
			actor:DetachFrom(10001, true)\n\
			actor:DetachFrom(10002, true)\n\
			SkillHelpFunc_StopSound(actor, action, \"JOB_SKILL_TOOL_SOUND1\")\n\
			SkillHelpFunc_PlaySound(actor, action, \"JOB_SKILL_TOOL_SOUND2\")\n\
			SkillHelpFunc_AttachParticleToNode(10003, \"JOB_SKILL_TOOL_EFFECT_ID2\", \"JOB_SKILL_TOOL_TARGET_NODE2\", 1, actor, action)\n\
			SkillHelpFunc_AttachParticleToNode(10004, \"JOB_SKILL_EFFECT_ID2\", \"JOB_SKILL_EFFECT_TARGET_NODE2\", 1, actor, action)\n\
		end\n\
		\n\
		if action:GetParam(1) == \"end\" then\n\
			action:SetParam(2, \"end\")\n\
			return false\n\
		else\n\
			actor:ResetAnimation()\n\
			actor:PlayCurrentSlot()\n\
			local fAniSpeed = action:GetParamFloat(20110817)\n\
			if( 1 < fAniSpeed ) then\n\
				action:SetParamInt(20110818, 1)\n\
				actor:SetAnimSpeed(fAniSpeed)\n\
			end\n\
		end\n\
		\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function JobSkill_Begin_OnLeave(actor, action)\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	local curAction = actor:GetAction()\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local curParam2 = curAction:GetParam(2)\n\
	local actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
	--ODS(\"JobSkill_Begin_OnLeave 1\\n\", false, 912)\n\
		return true\n\
	end\n\
	\n\
	if(false == action:GetEnable() ) then \n\
		return false\n\
	end\n\
	\n\
	if curParam == \"end\" and curParam2 == \"end\"	then \n\
		--ODS(\"JobSkill_Begin_OnLeave 2\\n\", false, 912)\n\
		action:SetParam(20010, curAction:GetParam(20010))		--    ?\n\
		local iMainSkillNo = curAction:GetAbil(AT_CUSTOMDATA1)  --   \n\
		action:SetParamInt(20100, iMainSkillNo)\n\
		action:SetParam(20200, curAction:GetParam(20200))		--    ? \n\
		SkillHelpFunc_StopSound(actor, curAction, \"JOB_SKILL_TOOL_SOUND1\")\n\
		SkillHelpFunc_StopSound(actor, curAction, \"JOB_SKILL_TOOL_SOUND2\")\n\
		return true\n\
	end\n\
\n\
	if(\"a_hi\" == actionID) then --        \n\
		return false \n\
	end\n\
--	ODS(\"curAction:GetNextActionName():\"..curAction:GetNextActionName()..\"\\n\",false, 912)\n\
--	ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
	\n\
	if curAction:GetNextActionName() ~= actionID then\n\
		\n\
		curAction:SetParam(1, \"end\")\n\
		curAction:SetParam(2, \"end\")\n\
		curAction:SetNextActionName(actionID)\n\
		--curAction:ChangeToNextActionOnNextUpdate(true,true)\n\
		JobSkill_Net_ReqCancelJobSkill(actor)\n\
		actor:RestoreLockBidirection()\n\
\n\
		SkillHelpFunc_RestoreWeapon(actor, curAction)					--   	\n\
		SkillHelpFunc_DetachWeaponTrail(actor, curAction)				--    	\n\
		SkillHelpFunc_RestoreShape(actor, curAction)					--  	\n\
		SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, curAction)	--      	\n\
		SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, curAction)--     	\n\
		SkillHelpFunc_ExpressCleanUpEffect(actor, curAction)			-- CleanUp( )    	\n\
		SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
		SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
		return true\n\
	end\n\
		\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\")\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\")\n\
		return false\n\
	end\n\
\n\
	--ODS(\"JobSkill_Begin_OnLeave  \\n\",false, 912)\n\
	return false \n\
end\n\
\n\
function JobSkill_Begin_OnCleanUp(actor)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	    \n\
	local   kCurAction = actor:GetAction()\n\
	if( CheckNil(nil==kCurAction) ) then return false end\n\
	if( CheckNil(kCurAction:IsNil()) ) then return false end\n\
	local iAlreadyExecuted = kCurAction:GetParamInt(20001)\n\
	if(iAlreadyExecuted == 0) then\n\
		--ODS(\"RestoreItemModel JobSkill_Begin_ReallyLeave\\n\", false, 912)		\n\
		kCurAction:SetParamInt(20001, 1)\n\
		SkillHelpFunc_RestoreWeapon(actor, kCurAction)					--   	\n\
		SkillHelpFunc_ShowWeapon(actor, kCurAction)						--   	(1 )\n\
		SkillHelpFunc_DetachWeaponTrail(actor, kCurAction)				--    	\n\
		SkillHelpFunc_RestoreShape(actor, kCurAction)					--  	\n\
		SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, kCurAction)	--      	\n\
		SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, kCurAction)--     	\n\
		SkillHelpFunc_ExpressCleanUpEffect(actor, kCurAction)			-- CleanUp( )    	\n\
		SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
		SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
		SkillHelpFunc_StopSound(actor, kCurAction, \"JOB_SKILL_TOOL_SOUND2\")\n\
		if( not actor:IsMyActor() ) then\n\
			actor:RestoreLockBidirection()\n\
		end\n\
\n\
		actor:DetachFrom(10001, true)\n\
		actor:DetachFrom(10002, true)\n\
		actor:DetachFrom(10003, true)\n\
		actor:DetachFrom(10004, true)\n\
		actor:DetachFrom(10005, true)\n\
	end\n\
	return true\n\
end\n\
\n\
\n\
function JobSkill_Begin_Fire(actor,action)\n\
	--ODS(\"RestoreItemModel JobSkill_Begin_Fire\\n\")	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	SkillHelpFunc_PlayFireSound(actor, action)	--  		\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	SkillHelpFunc_ChangeWeapon(actor, action)	--   	\n\
	SkillHelpFunc_ExpressFireEffect(actor, action)	--   \n\
    SkillHelpFunc_AttachWeaponTrail(actor, action)	--   \n\
	SkillHelpFunc_TransformShape(actor, action)		--   \n\
		\n\
end\n\
\n\
function JobSkill_Begin_DoDamage(actor,actorTarget,kActionResult,actionTargetInfo)\n\
	SkillHelpFunc_DefaultDoDamage(actor,actorTarget,kActionResult,actionTargetInfo)\n\
end\n\
\n\
function JobSkill_Begin_OnTargetListModified(actor,action,bIsBefore)\n\
	--ODS(\"JobSkill_Begin_OnTargetListModified\\n\", false, 912)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if(0 == action:GetParamInt(100) ) then\n\
") + std::string("		\n\
		if bIsBefore == false then	--  hit  ,   .			\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)	\n\
		end\n\
		\n\
	end\n\
	\n\
end\n\
\n\
function JobSkill_Begin_OnEvent(actor,textKey)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local action = actor:GetAction()\n\
		\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsUnderMyControl() then\n\
			local iTimerTotalTime = action:GetScriptParamAsFloat(\"HIT_TIMER_TIME\")\n\
			if 0 == action:GetParamInt(31) then -- hit          .			\n\
				action:SetParamInt(31,1)		--   , \n\
				\n\
				if 0 == iTimerTotalTime then --     .     Timer  .\n\
					action:CreateActionTargetList(actor)\n\
					if IsSingleMode() then    \n\
						SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
						JobSkill_Begin_OnTargetListModified(actor,action,false)\n\
						return\n\
					else\n\
						action:BroadCastTargetListModify(actor:GetPilot())\n\
					end\n\
					\n\
				else --   ,   \n\
				\n\
					local iTimeTick = action:GetScriptParamAsFloat(\"HIT_TIMER_TICK\")\n\
					local iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
					-- iTimerTotalTime , iTimeTick  OnTimer . (Timer 0)\n\
					if(0 == iTimeTick and 0 < iTotalHit) then\n\
						action:StartTimer(iTimerTime, iTimerTime/iTotalHit, 0)\n\
					else\n\
						action:StartTimer(iTimerTotalTime, iTimeTick, 0)\n\
					end\n\
					\n\
				end\n\
				\n\
			end\n\
		end\n\
		\n\
	end\n\
		\n\
	return	true\n\
end\n\
\n\
function JobSkill_Begin_OnTimer(actor,fAccumTime,action,iTimerID)	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if 0 == iTimerID then\n\
		local	iHitCount = SkillHelpFunc_GetHitCount(action)\n\
		local	iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
		\n\
		if iHitCount == iTotalHit then\n\
			--ODS(\"TotalHit iHit \"..iHitCount..\":\"..iTotalHit..\"\\n\", false, 912)\n\
			return true\n\
		end\n\
\n\
		local iCreateLimitCnt = action:GetParamInt(10)\n\
		if(0 < iCreateLimitCnt) then\n\
			--ODS(\"iCreateLimitCnt \\n\", false, 912)\n\
			action:CreateActionTargetList(actor)\n\
			iCreateLimitCnt = iCreateLimitCnt-1\n\
			action:SetParamInt(10, iCreateLimitCnt)			\n\
			action:BroadCastTargetListModify(actor:GetPilot())\n\
			action:GetTargetList():SetActionEffectApplied(true)		\n\
		end\n\
		\n\
		if IsSingleMode() then	    \n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
			JobSkill_Begin_OnTargetListModified(actor,action,false)	        \n\
			return true\n\
		else\n\
			--  1 ,    \n\
			SkillHelpFunc_DoDividedDamage(actor, action, iHitCount)\n\
			if iHitCount == iTotalHit-1 then\n\
				action:SetParam(1, \"end\")\n\
			end\n\
		end\n\
		SkillHelpFunc_IncHitCount(action, 1)\n\
	end	\n\
	return true\n\
end\n\
\n\
function JobSkill_Begin_OnFindTarget(actor,action,kTargets)\n\
	return	0\n\
end\n\
\n\
function JobSkill_Net_ReqCancelJobSkill(actor)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
\n\
	if actor:IsUnderMyControl() then \n\
		CloseJobSkillGatherTimer()\n\
		local	kTriggerID = action:GetParam(9875)\n\
		if nil~=kTriggerID and \"\"~=kTriggerID and \"null\"~=kTriggerID then\n\
			local kPacket = NewPacket(PT_C_M_REQ_CANCEL_JOBSKILL)\n\
			kPacket:PushString(kTriggerID)\n\
			kPacket:PushGuid(actor:GetPilotGuid())\n\
			Net_Send(kPacket)\n\
			DeletePacket(kPacket)\n\
			\n\
			TogleOffAllJobSkillQuicIcon()\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			actor:ReserveTransitAction(\"a_idle\")\n\
			\n\
			action:SetParam(9875, \"\")\n\
		end\n\
	end\n\
end") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [HIT_SOUND_ID_MALE] : HIT     ID - \n\
-- [HIT_SOUND_ID_FEMALE] : HIT     ID - \n\
-- [FIRE_SOUND_ID] :     ID\n\
-- [CASTING_SOUND_ID_MALE] :      ID - \n\
-- [CASTING_SOUND_ID_FEMALE] :      ID - \n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_CASTER_EFFECT_ID] : HIT     ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE_TO_WORLD_POS_WITH_ROTATE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID] :       ID\n\
-- [FIRE_CASTER_EFFECT_TARGET_NODE2] :      ,  \n\
-- [FIRE_CASTER_EFFECT_ID2] :       ID\n\
-- [FIRE_CASTER_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [FIRE_CASTER_EFFECT_ID2_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_TARGET_NODE_TO_WORLD_POS] :    ,  \n\
-- [CASTING_EFFECT_TARGET_NODE] :    ,  \n\
-- [CASTING_EFFECT_EFFECT_ID] :     ID\n\
-- [CASTING_EFFECT_ID_DEFAULT_DETACH] :    Detach  \n\
-- [CASTING_EFFECT_SIZE_TO_SKILLRANGE] :    Size     \n\
-- [DETACH_FIRE_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [DETACH_CASTING_EFFECT_AT_FINISH] :   FIRE_CASTER_EFFECT   \n\
-- [HIT_TARGET_EFFECT_TARGET_NODE] : HIT    ,  \n\
-- [HIT_TARGET_EFFECT_ID] : HIT     ID\n\
-- [NO_DEFAULT_HIT_EFFECT] :     .\n\
-- [NO_WEAPON_TRAIL] :    \n\
-- [NO_DAMAGE_HOLD] :     \n\
-- [TRANSFORM_XML] :  XML ID\n\
-- [TRANSFORM_ID] :  Status Effect ID\n\
-- [MULTI_HIT_RANDOM_OFFSET] :          .\n\
-- [HIT_TARGET_EFFECT_RANDOM_OFFSET] :   Hit    .\n\
-- [APPLY_EFFECT_ONLY_LAST_HIT] :     .\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
-- [HIDE_WEAPON] :  \n\
-- [CLEANUP_CASTER_EFFECT_ID] :    ID\n\
-- [CLEANUP_CASTER_EFFECT_TARGET_NODE] :    \n\
-- [CLEANUP_CASTER_EFFECT_SCALE] :    \n\
-- [SUMMON_CLASSNO] :   ClassNo\n\
-- [SUMMON_RESERVE_ACTION] :    \n\
-- [HIT_TIMER_TIME] : Hit     \n\
-- [HIT_TIMER_TICK] : Hit    Tick \n\
\n\
-- Melee\n\
function JobSkill_End_OnCheckCanEnter(actor,action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local weapontype = actor:GetEquippedWeaponType()\n\
	\n\
	if weapontype == 0 then\n\
		return	false\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function JobSkill_End_OnEnter(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local actionID = action:GetID()	\n\
	--ODS(\"JobSkill_End_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\" SkillLevel:\"..action:GetSkillLevel()..\"\\n\", false, 912)\n\
	\n\
	SkillHelpFunc_InitHitCount(action)					-- HitCount 	\n\
	SkillHelpFunc_ExpressCastingEffect(actor, action)	--     	\n\
	SkillHelpFunc_PlayCastingSound(actor, action) 		--  	\n\
\n\
	SkillHelpFunc_PlaySound(actor, action, \"JOB_SKILL_TOOL_SOUND3\")\n\
	SkillHelpFunc_AttachParticleToNode(10001, \"JOB_SKILL_TOOL_EFFECT_ID3\", \"JOB_SKILL_TOOL_TARGET_NODE3\", 1, actor, action)\n\
	SkillHelpFunc_AttachParticleToNode(10002, \"JOB_SKILL_EFFECT_ID3\", \"JOB_SKILL_EFFECT_TARGET_NODE3\", 1, actor, action)\n\
	--actor:AttachParticleS(10001,\"p_ef_star\",\"ef_Job_Axe\", 1)\n\
	--  \n\
	if action:GetActionParam() == AP_CASTING then\n\
		return	true\n\
	end\n\
	\n\
	if not actor:IsMyActor() then	--      		\n\
		local kPacket = action:GetParamAsPacket()\n\
		local bSuccess = kPacket:PopBool()\n\
		if(bSuccess) then\n\
			action:SetParam(20010,\"SUCCESS\")\n\
		end\n\
	end\n\
	\n\
	--  \n\
	JobSkill_End_OnCastingCompleted(actor,action) \n\
\n\
	local kMulptiple = action:GetScriptParam(\"EXPRESS_FAKE_MULTIPLE_ATTACK\")\n\
	if kMulptiple~=\"\" then	--     \n\
		action:SetParamInt(100,1)\n\
		action:SetParamInt(10,1) -- Timer  CreateTargetList 1    \n\
	end	\n\
	\n\
	return true\n\
end\n\
\n\
function JobSkill_End_OnOverridePacket(actor, action, packet)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	if(\"SUCCESS\" == action:GetParam(20010)) then\n\
		packet:PushBool(true)\n\
	else\n\
		packet:PushBool(false)\n\
	end		\n\
	\n\
end\n\
\n\
function JobSkill_End_OnCastingCompleted(actor, action)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	JobSkill_End_Fire(actor,action)\n\
\n\
	if(\"SUCCESS\" == action:GetParam(20010)) then\n\
		action:SetSlot(action:GetCurrentSlot()+1)\n\
		actor:LockBidirection(false)\n\
		actor:SeeFront(true)\n\
	end\n\
	actor:PlayCurrentSlot()\n\
	\n\
	SkillHelpFunc_SetNoneCastingState(action)	--  \n\
	\n\
	--ODS(\"JobSkill_End_OnCastingpleted \\n\", false, 912)\n\
	\n\
	\n\
end\n\
\n\
function JobSkill_End_OnUpdate(actor, accumTime, frameTime)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
		\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
	local iSlot = action:GetCurrentSlot()\n\
	local iMaxActionSlot = action:GetSlotCount()\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false\n\
	end\n\
\n\
	if animDone == true then\n\
		--if(false == actor:PlayNext()) then	--   			\n\
			local curActionParam = action:GetParam(0)\n\
			if curActionParam == \"GoNext\" then\n\
				action:SetParam(0, \"null\")\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			else\n\
				action:SetParam(1, \"end\")\n\
				return false\n\
			end\n\
		--end		\n\
	end	\n\
\n\
	return true\n\
end\n\
\n\
function JobSkill_End_OnLeave(actor, action)\n\
	--ODS(\"JobSkill_End_OnLeave\\n\", false, 912)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	local curAction = actor:GetAction()\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		--ODS(\"1\\n\", false, 912)\n\
		return true\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		--ODS(\"JobSkill_End_OnLeave 2\\n\", false, 912)\n\
		return true\n\
	end\n\
	\n\
	if(\"a_hi\" == actionID) then --       \n\
		return false \n\
	end	\n\
	\n\
	if curAction:GetNextActionName() ~= actionID then\n\
		--ODS(\" :\"..actionID..\"\\n\",false, 912)\n\
		curAction:SetParam(1, \"end\")\n\
		curAction:SetNextActionName(actionID)\n\
		--curAction:ChangeToNextActionOnNextUpdate(true,true)\n\
		JobSkill_Net_ReqCancelJobSkill(actor)\n\
		SkillHelpFunc_StopSound(actor, curAction, \"JOB_SKILL_TOOL_SOUND3\")\n\
		\n\
		SkillHelpFunc_RestoreWeapon(actor, curAction)					--   	\n\
		SkillHelpFunc_DetachWeaponTrail(actor, curAction)				--    	\n\
		SkillHelpFunc_RestoreShape(actor, curAction)					--  	\n\
		SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, curAction)	--      	\n\
		SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, curAction)--     	\n\
		SkillHelpFunc_ExpressCleanUpEffect(actor, curAction)			-- CleanUp( )    	\n\
		SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
		SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
		return false\n\
	end\n\
\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\")\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\")\n\
		return false\n\
	end\n\
	\n\
	return false \n\
end\n\
\n\
function JobSkill_End_OnCleanUp(actor)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
\n\
	local   kCurAction = actor:GetAction()\n\
	CheckNil(nil==kCurAction)\n\
	CheckNil(kCurAction:IsNil())\n\
	local iAlreadyExecuted = kCurAction:GetParamInt(20001)\n\
	if(iAlreadyExecuted == 0) then\n\
		--ODS(\"RestoreItemModel JobSkill_End_ReallyLeave\\n\", false, 912)\n\
		kCurAction:SetParamInt(20001, 1)\n\
		SkillHelpFunc_RestoreWeapon(actor, kCurAction)					--   	\n\
		SkillHelpFunc_ShowWeapon(actor, kCurAction)						--   	(1 )\n\
		SkillHelpFunc_DetachWeaponTrail(actor, kCurAction)				--    	\n\
		SkillHelpFunc_RestoreShape(actor, kCurAction)					--  	\n\
		SkillHelpFunc_DetachFireEffectWhenSkillEnd(actor, kCurAction)	--      	\n\
		SkillHelpFunc_DetachCastingEffectWhenSkillEnd(actor, kCurAction)--     	\n\
		SkillHelpFunc_ExpressCleanUpEffect(actor, kCurAction)			-- CleanUp( )    	\n\
		SkillHelpFunc_IfCastingCancelThenDoBattleIdle(actor)			--        	\n\
		SkillHelpFunc_DetachHitCasterEffect(actor)						--     \n\
		actor:DetachFrom(10001, true)\n\
		actor:DetachFrom(10002, true)\n\
		actor:RestoreLockBidirection()\n\
				\n\
		local kStopParam = kCurAction:GetParam(20200)\n\
		if(\"STOP_LOOP\" ~= kStopParam) then		\n\
			--   ,  ,   \n\
			local kTrigger = actor:GetCurrentTrigger()\n\
			if kTrigger:IsNil() == false then\n\
				if(kTrigger:GetConditionType() == CT_ACTION and	kTrigger:GetTriggerType() == TRIGGER_TYPE_JOB_SKILL) then\n\
					--kTrigger:OnAction(actor)\n\
					local iMainActionNo = kCurAction:GetParamInt(20100)\n\
					if(nil ~= iMainActionNo and 0 < iMainActionNo) then\n\
						World_JobSkill( kTrigger, actor, iMainActionNo, true)\n\
					end\n\
					--ODS(\"  \"..iMainActionNo..\"\\n\", false, 912)\n\
				else\n\
					--ODS(\"  \\n\", false, 912)\n\
				end\n\
			end\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
\n\
function JobSkill_End_Fire(actor,action)\n\
	--ODS(\"RestoreItemModel JobSkill_End_Fire\\n\")	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	SkillHelpFunc_PlayFireSound(actor, action)	--  		\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	SkillHelpFunc_ChangeWeapon(actor, action)	--   	\n\
	SkillHelpFunc_ExpressFireEffect(actor, action)	--   \n\
    SkillHelpFunc_AttachWeaponTrail(actor, action)	--   \n\
	SkillHelpFunc_TransformShape(actor, action)		--   \n\
		\n\
end\n\
\n\
function JobSkill_End_DoDamage(actor,actorTarget,kActionResult,actionTargetInfo)\n\
	SkillHelpFunc_DefaultDoDamage(actor,actorTarget,kActionResult,actionTargetInfo)\n\
end\n\
\n\
function JobSkill_End_OnTargetListModified(actor,action,bIsBefore)\n\
	ODS(\"JobSkill_End_OnTargetListModified\\n\", false, 912)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if(0 == action:GetParamInt(100) ) then\n\
		\n\
		if bIsBefore == false then	--  hit  ,   .			\n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)	\n\
		end\n\
		\n\
	end\n\
	\n\
end\n\
\n\
function JobSkill_End_OnEvent(actor,textKey)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
		\n\
	local action = actor:GetAction()\n\
		\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
\n\
		if actor:IsUnderMyControl() then\n\
			local iTimerTotalTime = action:GetScriptParamAsFloat(\"HIT_TIMER_TIME\")\n\
			if 0 == action:GetParamInt(31) then -- hit          .			\n\
				action:SetParamInt(31,1)		--   , \n\
				\n\
				if 0 == iTimerTotalTime then --     .     Timer  .\n\
					action:CreateActionTargetList(actor)\n\
					if IsSingleMode() then    \n\
						SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
						JobSkill_End_OnTargetListModified(actor,action,false)\n\
						return\n\
					else\n\
						action:BroadCastTargetListModify(actor:GetPilot())\n\
					end\n\
					\n\
				else --   ,   \n\
				\n\
					local iTimeTick = action:GetScriptParamAsFloat(\"HIT_TIMER_TICK\")\n\
					local iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
					-- iTimerTotalTime , iTimeTick  OnTimer . (Timer 0)\n\
					if(0 == iTimeTick and 0 < iTotalHit) then\n\
						action:StartTimer(iTimerTime, iTimerTime/iTotalHit, 0)\n\
					else\n\
						action:StartTimer(iTimerTotalTime, iTimeTick, 0)\n\
					end\n\
					\n\
				end\n\
				\n\
			end\n\
		end\n\
		\n\
	end\n\
		\n\
	return	true\n\
end\n\
\n\
function JobSkill_End_OnTimer(actor,fAccumTime,action,iTimerID)	\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
	\n\
	if 0 == iTimerID then\n\
		local	iHitCount = SkillHelpFunc_GetHitCount(action)\n\
		local	iTotalHit = SkillHelpFunc_GetTotalHitCount(action)\n\
		\n\
		if iHitCount == iTotalHit then\n\
			--ODS(\"TotalHit iHit \"..iHitCount..\":\"..iTotalHit..\"\\n\", false, 912)\n\
			return true\n\
		end\n\
\n\
		local iCreateLimitCnt = action:GetParamInt(10)\n\
		if(0 < iCreateLimitCnt) then\n\
			ODS(\"iCreateLimitCnt \\n\", false, 912)\n\
			action:CreateActionTargetList(actor)\n\
			iCreateLimitCnt = iCreateLimitCnt-1\n\
			action:SetParamInt(10, iCreateLimitCnt)			\n\
			action:BroadCastTargetListModify(actor:GetPilot())\n\
			action:GetTargetList():SetActionEffectApplied(true)		\n\
		end\n\
		\n\
		if IsSingleMode() then	    \n\
			SkillHelpFunc_DefaultHitOneTime(actor,action)\n\
			JobSkill_End_OnTargetListModified(actor,action,false)	        \n\
			return true\n\
		else\n\
			--  1 ,    \n\
			SkillHelpFunc_DoDividedDamage(actor, action, iHitCount)\n\
") + std::string("			if iHitCount == iTotalHit-1 then\n\
				action:SetParam(1, \"end\")\n\
			end\n\
		end\n\
		SkillHelpFunc_IncHitCount(action, 1)\n\
	end	\n\
	return true\n\
end\n\
\n\
function JobSkill_End_OnFindTarget(actor,action,kTargets)\n\
	return	0\n\
end") );
	m_kContLuaText.push_back(std::string("--[[\n\
function Manufacture_OnOverridePacket(actor, action, packet)\n\
	CheckNil(nil==actor)\n\
	CheckNil(actor:IsNil())\n\
	\n\
	CheckNil(nil==action)\n\
	CheckNil(action:IsNil())\n\
\n\
	--local kLookAtPos = actor:GetLookingDir()\n\
	--kLookAtPos:Add(actor:GetPos())\n\
	--packet:PushPoint3(kLookAtPos)\n\
	\n\
	--ODS(\" X:\"..kLookAtPos:GetX()..\" Y:\"..kLookAtPos:GetY()..\" Z:\"..kLookAtPos:GetZ()..\"\\n\", false, 912)\n\
	\n\
end\n\
]]--\n\
function Manufacture_OnEvent(actor,textKey)\n\
	return true\n\
end\n\
\n\
function Manufacture_OnCheckCanEnter(actor,action)\n\
	local kCurAction = actor:GetAction()\n\
	if kCurAction == nil or kCurAction:IsNil() then\n\
		return false\n\
	end\n\
	\n\
	if actor:IsRidingPet() then --    \n\
		return false\n\
	end\n\
	\n\
	local kCurActionID = kCurAction:GetID() --      \n\
	if (kCurActionID ~= \"a_idle\" and kCurActionID ~= \"a_Man_Cook\" and\n\
		kCurActionID ~= \"a_Man_Spell\" and kCurActionID ~= \"a_Man_Workmanship\") or\n\
		actor:IsMeetFloor() == false then\n\
		return false\n\
	end\n\
\n\
	return CheckCanUseManufacture() --   \n\
end\n\
\n\
function Manufacture_OnEnter(actor,action)\n\
	SkillHelpFunc_HideWeapon(actor, action)		--   \n\
	\n\
	actor:ResetAnimation()\n\
	action:SetSlot(0)\n\
	actor:PlayCurrentSlot()\n\
	SkillHelpFunc_PlaySound(actor, action, \"MANUFACTURE_TOOL_SOUND1\")\n\
	Manufacture_OnNextStep(actor, action, \"MANUFACTURE_TOOL_EFFECT_ID\", \"MANUFACTURE_TOOL_TARGET_NODE\", 10001)\n\
	Manufacture_OnNextStep(actor, action, \"MANUFACTURE_EFFECT_ID\", \"MANUFACTURE_EFFECT_TARGET_NODE\", 10002)\n\
\n\
\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		action:SetParamFloat(2, g_world:GetCameraZoom())\n\
		g_world:SetCameraZoom(0)\n\
		local kCalledUI = CallUI(\"FRM_MANUFACTURE_GAUGE\")\n\
		if kCalledUI == nil or kCalledUI:IsNil() then\n\
			ActivateUI(\"FRM_MANUFACTURE_GAUGE\")\n\
		end\n\
	end\n\
	return true\n\
end\n\
\n\
function Manufacture_OnUpdate(actor, accumTime, frameTime)\n\
	local action = actor:GetAction()\n\
	if action == nil or action:IsNil() then\n\
		return true\n\
	end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local iCurSlot = action:GetCurrentSlot()\n\
	if animDone then\n\
		if iCurSlot == 0 then\n\
			actor:ResetAnimation()\n\
			action:SetSlot(1)\n\
			actor:PlayCurrentSlot()\n\
			action:SetParamInt(0, 0)\n\
			SkillHelpFunc_StopSound(actor, action, \"MANUFACTURE_TOOL_SOUND1\")\n\
			SkillHelpFunc_PlaySound(actor, action, \"MANUFACTURE_TOOL_SOUND2\")	\n\
			Manufacture_OnNextStep(actor, action, \"MANUFACTURE_TOOL_EFFECT_ID\", \"MANUFACTURE_TOOL_TARGET_NODE\", 10001)\n\
			Manufacture_OnNextStep(actor, action, \"MANUFACTURE_EFFECT_ID\", \"MANUFACTURE_EFFECT_TARGET_NODE\", 10002)\n\
			return true\n\
		elseif iCurSlot == 1 then\n\
			actor:ResetAnimation()\n\
			actor:PlayCurrentSlot()\n\
			SkillHelpFunc_PlaySound(actor, action, \"MANUFACTURE_TOOL_SOUND2\")\n\
			return true\n\
		elseif iCurSlot > 1 then\n\
			return false\n\
		end\n\
	end\n\
\n\
	if iCurSlot == 1 and action:GetParamInt(0) == 0 and IsFinishedManufactureGaugeUI() == true then --  ..\n\
		SkillHelpFunc_StopSound(actor, action, \"MANUFACTURE_TOOL_SOUND2\")\n\
		local iScore = GetScoreManufactureGaugeUI()\n\
		if iScore == 0 then\n\
			local kWnd = GetUIWnd(\"FRM_MANUFACTURE_GAUGE\")\n\
			if kWnd ~= nil and kWnd:IsNil() == false then\n\
				OnHitEffectManufactureGaugeUI(kWnd)\n\
			end\n\
			action:SetSlot(2)\n\
			SkillHelpFunc_PlaySound(actor, action, \"MANUFACTURE_TOOL_SOUND3\")\n\
			Manufacture_OnNextStep(actor, action, \"MANUFACTURE_TOOL_EFFECT_ID\", \"MANUFACTURE_TOOL_TARGET_NODE\", 10001)\n\
			Manufacture_OnNextStep(actor, action, \"MANUFACTURE_EFFECT_ID\", \"MANUFACTURE_EFFECT_TARGET_NODE\", 10002)\n\
\n\
		else\n\
			action:SetSlot(3)\n\
			SkillHelpFunc_PlaySound(actor, action, \"MANUFACTURE_TOOL_SOUND4\")\n\
			Manufacture_OnNextStep(actor, action, \"MANUFACTURE_TOOL_EFFECT_ID\", \"MANUFACTURE_TOOL_TARGET_NODE\", 10001)\n\
			Manufacture_OnNextStep(actor, action, \"MANUFACTURE_EFFECT_ID\", \"MANUFACTURE_EFFECT_TARGET_NODE\", 10002)\n\
		end\n\
		actor:ResetAnimation()\n\
		actor:PlayCurrentSlot()\n\
		action:SetParamInt(0, 1)\n\
	elseif iCurSlot > 0 and action:GetParamInt(0) == 1 and IsFinishedManufactureGaugeUI() == false then --   ...\n\
		actor:ResetAnimation()\n\
		action:SetSlot(0) --  \n\
		actor:PlayCurrentSlot()\n\
		SkillHelpFunc_PlaySound(actor, action, \"MANUFACTURE_TOOL_SOUND1\")\n\
		Manufacture_OnNextStep(actor, action, \"MANUFACTURE_TOOL_EFFECT_ID\", \"MANUFACTURE_TOOL_TARGET_NODE\", 10001)\n\
		Manufacture_OnNextStep(actor, action, \"MANUFACTURE_EFFECT_ID\", \"MANUFACTURE_EFFECT_TARGET_NODE\", 10002)\n\
	end\n\
	\n\
	return true\n\
end\n\
\n\
function Manufacture_OnLeave(actor, action)\n\
\n\
	local kCurAction = actor:GetAction();\n\
	local kNextActionID = action:GetID()\n\
	\n\
	if(false == action:GetEnable() ) then \n\
		return false --      \n\
	end\n\
	\n\
	if CheckCanUseManufacture() == false then --       \n\
		return true\n\
	elseif kNextActionID == \"a_idle\" or kCurAction:GetID() == kNextActionID then\n\
		InitManufactureGaugeUI()\n\
		actor:ResetAnimation()\n\
		kCurAction:SetSlot(1)\n\
		actor:PlayCurrentSlot()\n\
		kCurAction:SetParamInt(0, 0)\n\
		SkillHelpFunc_StopSound(actor, kCurAction, \"MANUFACTURE_TOOL_SOUND1\")\n\
		SkillHelpFunc_PlaySound(actor, kCurAction, \"MANUFACTURE_TOOL_SOUND2\")	\n\
		Manufacture_OnNextStep(actor, kCurAction, \"MANUFACTURE_TOOL_EFFECT_ID\", \"MANUFACTURE_TOOL_TARGET_NODE\", 10001)\n\
		Manufacture_OnNextStep(actor, kCurAction, \"MANUFACTURE_EFFECT_ID\", \"MANUFACTURE_EFFECT_TARGET_NODE\", 10002)\n\
		return false\n\
	elseif kNextActionID == \"a_Man_Cook\" or\n\
	kNextActionID == \"a_Man_Spell\" or\n\
	kNextActionID == \"a_Man_Workmanship\" then\n\
		return true\n\
	elseif kNextActionID == \"a_run\" then\n\
--		local kChatBarWnd = GetUIWnd(\"ChatBar\") --    .      \"a_walk\" .  \n\
--		if kChatBarWnd ~= nil and kChatBarWnd:IsNil() == false then\n\
--			local kEditChat = kChatBarWnd:GetControl(\"EDT_CHAT\")\n\
--			if kEditChat ~= nil and kEditChat:IsNil() == false then\n\
--				if kEditChat:IsFocus() then\n\
--					return false\n\
--				end\n\
--			end\n\
--		end\n\
		return true\n\
	end\n\
	return false\n\
end\n\
\n\
function Manufacture_OnCleanUp(actor)\n\
	-- \n\
	local action = actor:GetAction()\n\
	if action ~= nil and action:IsNil() == false then\n\
		SkillHelpFunc_ShowWeapon(actor, action)						--   	(1 )\n\
\n\
		if action:GetCurrentSlot() == 0 then\n\
			SkillHelpFunc_StopSound(actor, action, \"MANUFACTURE_TOOL_SOUND1\")\n\
		elseif action:GetCurrentSlot() == 1 then\n\
			SkillHelpFunc_StopSound(actor, action, \"MANUFACTURE_TOOL_SOUND2\")\n\
		elseif action:GetCurrentSlot() == 2 then\n\
			SkillHelpFunc_StopSound(actor, action, \"MANUFACTURE_TOOL_SOUND3\")\n\
		elseif action:GetCurrentSlot() == 3 then\n\
			SkillHelpFunc_StopSound(actor, action, \"MANUFACTURE_TOOL_SOUND4\")\n\
		end\n\
		actor:DetachFrom(10001, true)\n\
		actor:DetachFrom(10002, true)\n\
		\n\
	end\n\
	\n\
	--UI \n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetCameraZoom(action:GetParamFloat(2)) --  \n\
		CloseUI(\"FRM_MANUFACTURE_GAUGE\")\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Manufacture_OnNextStep(actor, action, szDefName, szDefTargetNodeName, iEffectSlot)\n\
	local iCurSlot = action:GetCurrentSlot()\n\
\n\
	local szCurName = szDefName..(iCurSlot+1)\n\
	local szCurTargetNodeName = szDefTargetNodeName..(iCurSlot+1)\n\
	local kCurID = action:GetScriptParam(szCurName)\n\
	if iCurSlot > 0 then --       .\n\
		local iPrevSlot = iCurSlot - 1\n\
		if iCurSlot == 3 then\n\
			iPrevSlot = 1\n\
		end\n\
\n\
		local szPrevName = szDefName..(iPrevSlot+1)\n\
		local kPrevID = action:GetScriptParam(szPrevName)\n\
		if kPrevID ~= kCurID then\n\
			actor:DetachFrom(iEffectSlot, true)\n\
		end\n\
	end\n\
\n\
	if kCurID ~= \"\" then\n\
		SkillHelpFunc_AttachParticleToNode(iEffectSlot, szCurName, szCurTargetNodeName, 1, actor, action)\n\
	end\n\
\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Sum_Rifle_Shot_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end	\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	--   \n\
	if g_pilotMan:IsLockMyInput() == true then\n\
		return\n\
	end	\n\
			\n\
	return		true;\n\
	\n\
end\n\
function Sum_Rifle_Shot_FindTarget(kActor,kAction)\n\
	\n\
	if( CheckNil(nil==kActor) ) then return nil end\n\
	if( CheckNil(kActor:IsNil()) ) then return nil end\n\
	\n\
	if( CheckNil(nil==kAction) ) then return nil end\n\
	if( CheckNil(kAction:IsNil()) ) then return nil end\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Sum_Rifle_Shot_OnFindTarget(kActor,kAction,kTargets);\n\
	\n\
	return	kTargets;\n\
end\n\
function Sum_Rifle_Shot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return 0 end\n\
	if( CheckNil(actor:IsNil()) ) then return 0 end\n\
	\n\
	if( CheckNil(nil==action) ) then return 0 end\n\
	if( CheckNil(action:IsNil()) ) then return 0 end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,20,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
function Sum_Rifle_Shot_ToFloatAttack(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	if Act_Melee_IsToDownAttack(actor,action) then\n\
		kNextActionName = \"a_Air_Smash\";\n\
	else\n\
		kNextActionName = \"a_Sum_Rifle_Jump_Shot_01\";\n\
				\n\
	end\n\
	\n\
	\n\
	if action:CheckCanEnter(actor,kNextActionName) then\n\
		action:SetNextActionName(kNextActionName);\n\
		action:ChangeToNextActionOnNextUpdate(true, true)\n\
		return	true;\n\
	end\n\
	return	false;\n\
end\n\
\n\
function Sum_Rifle_Shot_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Sum_Rifle_Shot_OnEnter\\n\");\n\
	\n\
	if LOCALE.NC_DEVELOP == GetLocale() then\n\
		if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
			actor:ReserveTransitAction(\"a_gs_combo_a\");\n\
			actor:ResetAnimation();\n\
			return false;\n\
		end\n\
	end\n\
	\n\
	--	 \n\
	local	iTargetCount = 0;\n\
\n\
	if actor:IsMyActor() == true then\n\
\n\
		if actor:IsMeetFloor() == false then\n\
			if	Sum_Rifle_Shot_ToFloatAttack(actor,action)	then\n\
				return	true\n\
			else \n\
				return false\n\
			end\n\
		end	\n\
\n\
		local	iComboCount = actor:GetComboCount();\n\
		if iComboCount > 0 then\n\
		\n\
			if actor:CanNowConnectToNextComboAttack(1.0) == false 	 then\n\
				iComboCount = 0;\n\
			end	\n\
		end		\n\
		\n\
		if Act_Melee_IsToDownAttack(actor,action) then\n\
			if	Act_Melee_ToDownAttack(actor,action) then\n\
				return	true\n\
			end\n\
		elseif Act_Melee_IsToUpAttack(actor,action) then\n\
			if Act_Melee_ToDownAttack(actor,action,true) then\n\
				return	true\n\
			end\n\
		end\n\
		\n\
		--    \n\
		local iExtendSkillNo =  actor:GetAbil(AT_SKILL_EXTENDED)\n\
		if(0 < actor:GetAbil(AT_SKILL_EXTENDED)) then \n\
			actor:SetComboCount(0)\n\
			action:ClearTargetList()	\n\
			if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
				actor:ReserveTransitAction(\"a_smart_shot_fire_combo_a\");\n\
				actor:ResetAnimation();\n\
				return false;\n\
			end\n\
			actor:ReserveTransitActionByActionNo(iExtendSkillNo)	\n\
			action:ChangeToNextActionOnNextUpdate(true, true)			\n\
			return	true\n\
		end\n\
	\n\
		if 0 == Config_GetValue(HEADKEY_ETC, \"USE_OLD_COMBO\") then\n\
			actor:ReserveTransitAction(\"a_gs_combo_a\");\n\
			actor:ResetAnimation();\n\
			return false;\n\
		end\n\
		local	iNextComboCount = iComboCount+1;\n\
		\n\
		actor:SetComboCount(iNextComboCount);\n\
		ODS(\"Sum_Rifle Shot ComboCount : \"..iNextComboCount..\"\\n\");\n\
		\n\
			\n\
		--	  \n\
		local	fLastShotTime = tonumber(actor:GetParam(\"Sum_Rifle_Shot_TIME\"));\n\
		if fLastShotTime == nil then\n\
			fLastShotTime = 0\n\
		end\n\
		\n\
		local iAttackCoolTime = g_fSum_RifleDefaultAttackCoolTime + (actor:GetAbil(AT_ADD_ATTACK_COOL_TIME) / 1000);\n\
		if iAttackCoolTime < 0 then\n\
			iAttackCoolTime = 0.1;\n\
		end\n\
\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		ODS(\"g_fSum_RifleDefaultAttackCoolTime : \" ..iAttackCoolTime .. \"\\n\");\n\
		if	g_world:GetAccumTime() - fLastShotTime < iAttackCoolTime then\n\
			ODS(\"Shot Time Not Over\\n\");\n\
			action:ChangeToNextActionOnNextUpdate(true,true);\n\
			return	true;	\n\
		end\n\
		\n\
		actor:SetParam(\"FLOAT_SHOT_COUNT\",\"0\");\n\
		\n\
        GetComboAdvisor():OnNewActionEnter(action:GetID());\n\
        GetComboAdvisor():AddNextAction(action:GetID());\n\
        \n\
        --	  \n\
        actor:SetParam(\"Sum_Rifle_Shot_TIME\",\"\"..g_world:GetAccumTime());\n\
	end\n\
	\n\
\n\
	actor:ResetAnimation();\n\
	action:SetParamInt(6,0);\n\
	\n\
	actor:StopJump();\n\
	\n\
	return true\n\
end\n\
\n\
function	Sum_Rifle_Shot_LoadArrowToWeapon(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = action:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,actor:GetPilotGuid());\n\
	\n\
	local	kPosition = actor:GetNodeWorldPos(\"p_ef_fire\");\n\
	local	kDir = actor:GetLookingDir();\n\
	kPosition:Add(kDir);\n\
	\n\
	kNewArrow:SetWorldPos(kPosition);\n\
	\n\
	return	kNewArrow;\n\
	\n\
end\n\
\n\
function Sum_Rifle_Shot_Finished(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Sum_Rifle_Shot_Finished\\n\");\n\
\n\
	if actor:IsMeetFloor() == false then\n\
	    action:SetNextActionName(\"a_jump\");\n\
	end\n\
	\n\
		\n\
	local	nextActionName = action:GetNextActionName()\n\
--	local	iMaxActionSlot = action:GetSlotCount();\n\
--	local	actionID = action:GetID();\n\
			\n\
	actor:SetNormalAttackEndTime();\n\
\n\
		\n\
--	local	curActionSlot = action:GetCurrentSlot()\n\
	local	curActionParam = action:GetParam(0)\n\
	if curActionParam == \"GoNext\" then\n\
		nextActionName = action:GetParam(1);\n\
\n\
		action:SetParam(0, \"null\")\n\
		action:SetParam(1, \"end\")\n\
		\n\
		action:SetNextActionName(nextActionName)\n\
		return false;\n\
	else\n\
\n\
		action:SetParam(1, \"end\")\n\
\n\
		return false\n\
	end\n\
	\n\
	return	true;\n\
end\n\
\n\
function Sum_Rifle_Shot_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
--	local	actorID = actor:GetID()\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	local	weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if animDone == true then\n\
		return	Sum_Rifle_Shot_Finished(actor,action);\n\
	end\n\
	\n\
	return true\n\
end\n\
function Sum_Rifle_Shot_OnCleanUp(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	ODS(\"Sum_Rifle_Shot_ReallyLeave nextaction : \"..action:GetID()..\"\\n\");\n\
	\n\
	actor:FreeMove(false);\n\
	\n\
	return true;\n\
end\n\
function Sum_Rifle_Shot_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	ODS(\"Sum_Rifle_Shot_OnLeave NEXTACTION : \"..actionID..\" curParam:\"..curParam..\"\\n\");\n\
\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		action:SetDoNotBroadCast(true)\n\
		return  true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
		\n\
	local	kNextActionName = curAction:GetNextActionName();\n\
	if action:GetEnable() == false then\n\
		\n\
		if kNextActionName==actionID then\n\
			curAction:SetNextActionName(\"a_battle_idle\");\n\
			return false;\n\
		end\n\
		\n\
	end\n\
		\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
\n\
		-- if curAction:GetParamInt(7)==1 and actionID == \"a_run\" then	--	     .\n\
			-- return	true;\n\
		-- end\n\
		\n\
		if curAction:GetParamInt(7)==1 and actionID == \"a_jump\" then	--	     .\n\
			return	true;\n\
		end\n\
		\n\
		if curAction:GetParamInt(7)==1 \n\
			--or actionID == \"a_run\" \n\
		then\n\
			curAction:SetNextActionName(actionID);\n\
			curAction:SetNextActionInputSlotInfo(action:GetInputSlotInfo());\n\
        end\n\
\n\
		return false;\n\
	\n\
	 elseif (curParam == \"end\" or curAction:GetParamInt(7)==1) \n\
			--and (actionID == \"a_run\") \n\
		then\n\
		return true;\n\
	elseif actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Sum_Rifle_Shot_DoEffect(actor)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
    actor:FreeMove(false);\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor);\n\
	if iAttackRange == 0 then	--	 DB  ...\n\
		iAttackRange = 200\n\
	end\n\
	\n\
	action:SetParam(4,\"HIT\");\n\
	\n\
	\n\
--	local	kProjectileMan = GetProjectileMan();\n\
	local	kArrow = Sum_Rifle_Shot_LoadArrowToWeapon(actor,action);\n\
	\n\
\n\
--	local	targetobject = nil;\n\
\n\
	if kArrow:IsNil() == false then\n\
		local kHitEffectTargetNode = action:GetScriptParam(\"HIT_TARGET_EFFECT_TARGET_NODE\")\n\
		kArrow:SetParamValue(\"HIT_TARGET_EFFECT_TARGET_NODE\", kHitEffectTargetNode)\n\
		\n\
		local kHitEffectID = action:GetScriptParam(\"HIT_TARGET_EFFECT_ID\")\n\
		kArrow:SetParamValue(\"HIT_TARGET_EFFECT_ID\", kHitEffectID);\n\
		\n\
		local iPentrationCount = actor:GetAbil(AT_PENETRATION_COUNT);\n\
		kArrow:SetPenetrationCount(iPentrationCount);--   \n\
		if iPentrationCount ~= 0 then\n\
			kArrow:SetMultipleAttack(true);\n\
		end\n\
			\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local kAEffect = actor:GetAttackEffect(action:GetID())\n\
		if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
			actor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
			\n\
		kMovingDir:Multiply(iAttackRange-45);\n\
		kMovingDir:Add(arrow_worldpos);\n\
		kArrow:SetTargetLoc(kMovingDir);	\n\
		\n\
		kArrow:Fire();\n\
		actor:ClearIgnoreEffectList();\n\
	\n\
	end\n\
	\n\
end\n\
\n\
function Sum_Rifle_Shot_OnEvent(actor, textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	ODS(\"Sum_Rifle_Shot_OnEvent textKey:\"..textKey..\"\\n\");\n\
	if textKey == \"fire\" then\n\
	\n\
		actor:AttachParticleS(3851, \"p_ef_fire\", \"eff_sum_skill_smn_muzz00\", 1.0)\n\
		\n\
		if action:GetParamInt(7) == 0 then\n\
		\n\
			action:SetParamInt(7,1);\n\
			Sum_Rifle_Shot_DoEffect(actor);	\n\
	\n\
		end\n\
\n\
	end\n\
end\n\
\n\
function Sum_Rifle_Shot_OnCastingCompleted(actor, action)\n\
end") );
	m_kContLuaText.push_back(std::string("function Sum_Rifle_ChargeShot_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	if actor:IsMeetFloor() == false then		--    .\n\
		return	false;\n\
	end\n\
	\n\
	if actor:CheckStatusEffectExist(\"se_transform_to_metamorphosis\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_Dancer\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Fig\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Mag\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Arc\")\n\
	or actor:CheckStatusEffectExist(\"se_transform_to_mahalka_Thi\")then\n\
		return false\n\
	end\n\
	\n\
	return		true;\n\
	\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(1,0);\n\
	action:SetParamInt(5,0);			--   . .\n\
	\n\
	if actor:IsMyActor() == true then\n\
		if actor:IsMeetFloor() == false then		--    .\n\
			return	false;\n\
		end\n\
	end\n\
	\n\
	action:SetAutoBroadCastWhenCastingCompleted(false);\n\
	action:SetParamInt(3,0);\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return false end\n\
		if( CheckNil(g_world:IsNil()) ) then return false end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_fChargeFocusFilterValue[2]\n\
		, g_fChargeFocusFilterValue[3]\n\
		, g_fChargeFocusFilterValue[4]\n\
		,true\n\
		,true)\n\
	end\n\
		\n\
   return true\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_OnCastingCompleted(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetParamInt(5,1);\n\
	\n\
	if actor:IsMyActor() == false then\n\
		Sum_Rifle_ChargeShot_Fire(actor,action);\n\
	end\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_Fire(actor,action)\n\
\n\
	action:SetParamInt(1,1);\n\
	actor:PlayNext();\n\
	\n\
	if actor:IsMyActor() == true then\n\
		action:BroadCastTargetListModify(actor:GetPilot(), true);\n\
		action:SetActionInstanceID();\n\
		action:BroadCast(actor:GetPilot());\n\
	end\n\
\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone();\n\
	local	action = actor:GetAction();\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
		\n\
	local	curSlot = action:GetCurrentSlot();\n\
	local	iState = action:GetParamInt(3);\n\
	\n\
	local	bKeyCheck =  KeyIsDown( KEY_CHARGING_UKEY )\n\
	\n\
	if actor:IsMyActor() == false then\n\
		bKeyCheck = true;\n\
	end\n\
			\n\
	if iState == 0 then\n\
		if animDone == true then\n\
			if curSlot == 0 then\n\
				actor:PlayNext();\n\
				local	kActorID = actor:GetID();\n\
				actor:AttachParticle(10,\"p_ef_fire\",\"eff_charge_00\");\n\
			end\n\
			if curSlot == 2 then\n\
				action:SetParamInt(3,1);\n\
				action:SetParamFloat(4,accumTime);\n\
				return true;\n\
			end\n\
		end\n\
		\n\
		if bKeyCheck == false then\n\
			if curSlot == 0 then\n\
				return	false;\n\
			end\n\
			if curSlot == 1 and action:GetParamInt(5) == 1 then\n\
				actor:DetachFrom(10,false);\n\
				Sum_Rifle_ChargeShot_Fire(actor,action);\n\
			else\n\
				return	false;\n\
			end	\n\
		end\n\
	else\n\
	\n\
		--local	fElapsedTime = accumTime - action:GetParamFloat(4);\n\
		--if fElapsedTime>=g_fChargingFreezeTime then\n\
			action:SetParam(2,\"end\");\n\
			return	false;\n\
		--end				\n\
	\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:DetachFrom(10);\n\
	actor:EndWeaponTrail();\n\
	\n\
	if actor:IsMyActor() then\n\
		if( CheckNil(g_world == nil) ) then return true end\n\
		if( CheckNil(g_world:IsNil()) ) then return true end\n\
		g_world:SetShowWorldFocusFilterColorAlpha(g_fChargeFocusFilterValue[1]\n\
		, g_world:GetWorldFocusFilterAlpha()\n\
		, 0\n\
		, g_fChargeFilterReturnTime\n\
		,false\n\
		,true);\n\
	end\n\
	\n\
	return true;\n\
end\n\
\n\
\n\
function Sum_Rifle_ChargeShot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetEnable() == false then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetID() == \"a_jump\" then\n\
		return	false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end	\n\
	\n\
	local	curAction = actor:GetAction();\n\
	local 	curParam1 = curAction:GetParam(2)\n\
	if curAction:GetParamInt(1) == 1 and curAction:GetParam(2)~=\"end\" then\n\
		return	false;\n\
	end\n\
\n\
   return true;\n\
   \n\
end\n\
\n\
function Sum_Rifle_ChargeShot_FindTarget(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	kTargets = CreateActionTargetList(kActor:GetPilotGuid(),kAction:GetActionInstanceID(),kAction:GetActionNo());\n\
	local	iFound = Sum_Rifle_Shot_OnFindTarget(kActor,kAction,kTargets);\n\
	\n\
	return	kTargets;\n\
end\n\
function Sum_Rifle_ChargeShot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,20,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
function Sum_Rifle_ChargeShot_OnTargetListModified(actor,action,bIsBefore)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	--ODS(\"Sum_Rifle_ChargeShot_OnTargetListModified\\n\", false, 3851)\n\
	Act_Melee_Default_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_LoadArrowToWeapon(kActor,kAction)\n\
	\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
	\n\
	local	kProjectileMan = GetProjectileMan();\n\
	if kAction:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = kAction:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	if kProjectileID == \"\" then\n\
		kProjectileID = kActor:GetEquippedWeaponProjectileID();\n\
	end\n\
	\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,kAction,kActor:GetPilotGuid());\n\
		\n\
	local	kTargetNodeID = kAction:GetScriptParam(\"ATTACH_NODE_ID\");\n\
	kNewArrow:LoadToHelper(kActor,kTargetNodeID);	--	\n\
	\n\
	return	kNewArrow;\n\
end\n\
\n\
function Sum_Rifle_ChargeShot_OnEvent(kActor,textKey,seqID)\n\
		\n\
	CheckNil(nil==kActor);\n\
	CheckNil(kActor:IsNil());\n\
	\n\
	local kAction = kActor:GetAction();\n\
	CheckNil(nil==kAction);\n\
	CheckNil(kAction:IsNil());\n\
		\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
		ODS(\"Fire\\n\", false, 3851)\n\
		kActor:AttachParticleS(3851, \"p_ef_fire\", \"eff_sum_skill_smn_muzz00\", 1.0)\n\
		\n\
		local	kSoundID = kAction:GetScriptParam(\"HIT_SOUND_ID\");\n\
		if kSoundID~=\"\" then\n\
			kActor:AttachSound(2784,kSoundID);\n\
		end\n\
		\n\
		local	iAttackRange = kAction:GetSkillRange(0,kActor);		\n\
		if iAttackRange == 0 then\n\
			iAttackRange = 200; \n\
		end\n\
		\n\
		local	kArrow = Sum_Rifle_ChargeShot_LoadArrowToWeapon(kActor,kAction);\n\
		\n\
		if kArrow:IsNil() == false then\n\
					\n\
			local	kMovingDir = kActor:GetLookingDir();	--    \n\
			local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
			\n\
			kArrow:SetParentActionInfo(kAction:GetActionNo(),kAction:GetActionInstanceID(),kAction:GetTimeStamp());\n\
		\n\
			kMovingDir:Multiply(iAttackRange);\n\
			kMovingDir:Add(arrow_worldpos);\n\
			kArrow:SetTargetLoc(kMovingDir);	\n\
			\n\
			local	kPosition = kActor:GetNodeWorldPos(\"p_ef_fire\");\n\
			kArrow:SetWorldPos(kPosition);\n\
			\n\
			kArrow:Fire();\n\
			ODS(\"kArrow:Fire() \\n\", false, 3851)\n\
		end\n\
					\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Sum_Rifle_Jump_Shot_OnCastingCompleted(actor, action)\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	local kCurAction = actor:GetAction()\n\
	if( false == kCurAction:IsNil() ) then\n\
		if actor:GetJumpAccumHeight() < 50 then\n\
			kCurAction:SetNextActionName(\"a_idle\")\n\
			return false\n\
		end\n\
		\n\
		local weapontype = actor:GetEquippedWeaponType();\n\
		if weapontype == 0 then\n\
			kCurAction:SetNextActionName(\"a_jump\")\n\
			kCurAction:SetSlot(2)\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnEnter(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	return true\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnFindTarget(actor,action,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
\n\
	local	kParam = FindTargetParam();\n\
	\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,20,0,1);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	action:FindTargets(TAT_BAR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_FindTargets(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    action:CreateActionTargetList(actor,true);\n\
	\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_LoadToWeapon(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kProjectileID = actor:GetEquippedWeaponProjectileID();\n\
	local	kAttackNodeName = \"\";\n\
	\n\
	if action:GetScriptParam(\"PROJECTILE_ID\")~=\"\" then\n\
		kProjectileID = action:GetScriptParam(\"PROJECTILE_ID\");\n\
	end\n\
	\n\
	kAttackNodeName = \"p_ef_fire\";\n\
	\n\
	local	kPilotGuid = actor:GetPilotGuid();\n\
	local	kProjectileMan = GetProjectileMan();\n\
	local	kNewArrow = kProjectileMan:CreateNewProjectile(kProjectileID,action,kPilotGuid);\n\
	if kAttackNodeName == \"\" then\n\
		kNewArrow:LoadToWeapon(actor);	--	\n\
	else\n\
		kNewArrow:LoadToHelper(actor,kAttackNodeName);\n\
	end\n\
\n\
	return	kNewArrow;\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local	action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	animDone = actor:IsAnimationDone()\n\
	\n\
	if animDone == true then\n\
		--actor:FreeMove(false);	--   ,  \n\
		\n\
		if actor:IsMeetFloor() == false then\n\
			action:SetNextActionName(\"a_jump\");\n\
		end\n\
			\n\
		local	nextActionName = action:GetNextActionName()\n\
		actor:SetNormalAttackEndTime();\n\
\n\
		local	curActionParam = action:GetParam(0)\n\
		if curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnCleanUp(actor)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	return true;\n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnLeave(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local	curParam = curAction:GetParam(1)\n\
	local	actionID = action:GetID()\n\
	\n\
	ODS(\"Sum_Rifle_Shot_OnLeave actionID:\"..actionID..\"\\n\", 3851);\n\
	\n\
	if actor:IsMyActor() == false then\n\
	\n\
		if actionID == \"a_jump\" then\n\
			action:SetSlot(2)\n\
		end\n\
	\n\
		return true;\n\
	end\n\
	if action:GetActionType()==\"EFFECT\"  then\n\
		return true;\n\
	end	\n\
	if curParam == \"end\" and actionID == \"a_jump\" then \n\
		action:SetSlot(2)\n\
		return  true;\n\
	end\n\
\n\
	if action:GetEnable() == false then\n\
		\n\
		if curAction:GetParam(1)==actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
		\n\
	end	\n\
	if action:GetEnable() == true then\n\
		\n\
		if curParam == \"end\" then \n\
			return true;\n\
		end\n\
		\n\
		if actionID == \"a_Sum_Rifle_Shot\" then\n\
		    return  false\n\
        end\n\
	\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and\n\
		(actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
	return false \n\
end\n\
\n\
function Sum_Rifle_Jump_Shot_OnEvent(actor, textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
    ODS(\"Sum_Rifle_Jump_Shot_OnEvent textKey : \"..textKey..\"\\n\");\n\
\n\
	if textKey == \"fire\" or textKey==\"hit\" then\n\
	\n\
		actor:AttachParticleS(3851, \"p_ef_fire\", \"eff_sum_skill_smn_muzz00\", 1.0)\n\
		\n\
		local	action = actor:GetAction()\n\
		\n\
		CheckNil(nil==action);\n\
		CheckNil(action:IsNil());\n\
	\n\
	    if action:GetParam(7) == \"FIRED\" then\n\
	        return\n\
        end\n\
\n\
		local	iAttackRange = action:GetSkillRange(0,actor);\n\
		if iAttackRange == 0 then	--	 DB  ...\n\
			iAttackRange = 200\n\
		end\n\
			\n\
		local	kProjectileMan = GetProjectileMan();\n\
		\n\
		local	iTargetCount = action:GetTargetCount();\n\
		local	iTargetABVShapeIndex = 0;\n\
\n\
		local	i = 0;\n\
		\n\
		Sum_Rifle_Jump_Shot_FindTargets(actor,action);\n\
		\n\
		local	kActionTargetList = action:GetTargetList();\n\
		\n\
		local	kTargetActor = nil;\n\
		local	kActionTargetInfo = kActionTargetList:GetTargetInfo(0);\n\
		iTargetABVShapeIndex = 0;\n\
		\n\
		local pt = nil;\n\
		\n\
		if kActionTargetInfo:IsNil() == false then\n\
			iTargetABVShapeIndex = kActionTargetInfo:GetABVIndex();\n\
			local	kTargetPilot = g_pilotMan:FindPilot(kActionTargetInfo:GetTargetGUID());\n\
			if kTargetPilot:IsNil() == false then\n\
				kTargetActor = kTargetPilot:GetActor();\n\
				pt = kTargetActor:GetNodeWorldPos(\"p_ef_heart\");\n\
			end			\n\
		end\n\
\n\
		local	kArrow = Sum_Rifle_Jump_Shot_LoadToWeapon(actor,action);\n\
		local	kMovingDir = actor:GetLookingDir();	--    \n\
		local	arrow_worldpos = kArrow:GetWorldPos();	--	 \n\
	\n\
		local kAEffect = actor:GetAttackEffect(action:GetID())\n\
		if false==kAEffect:IsNil() and \"\"~=kAEffect:GetEffectName() then\n\
			actor:AttachParticleS(421,kAEffect:GetNodeName(),kAEffect:GetEffectName(),kAEffect:GetScale())\n\
		end\n\
		\n\
		kArrow:SetParentActionInfo(action:GetActionNo(),action:GetActionInstanceID(),action:GetTimeStamp());\n\
		\n\
		kMovingDir:Multiply(iAttackRange+45);\n\
		kMovingDir:Add(arrow_worldpos);\n\
		kArrow:SetTargetLoc(kMovingDir);	\n\
		\n\
		kArrow:Fire();\n\
		actor:ClearIgnoreEffectList();\n\
		\n\
		kArrow:Fire();--	!\n\
\n\
		action:SetParam(7,\"FIRED\");\n\
		kActionTargetList:clear();\n\
		actor:ClearIgnoreEffectList();\n\
		\n\
	end\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Air_Sprash_OnCheckCanEnter(actor,action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Air_Sprash_OnCastingCompleted(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Air_Sprash_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	ODS(\"Air_Sprash_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
		\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	local iFireCount = action:GetAbil(AT_COUNT);\n\
	--ODS(\"iFireCount : \"..iFireCount..\"\\n\", false, 3851)\n\
	action:SetParamInt(100,iFireCount)			--   \n\
	action:SetParamInt(101,1)					--    ()\n\
		\n\
	Air_Sprash_OnCastingCompleted(actor,action);\n\
	\n\
	return true\n\
end\n\
\n\
function Air_Sprash_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		local iFireCount = action:GetParamInt(100)\n\
		local iCurFireCount = action:GetParamInt(101)\n\
		\n\
		if iCurFireCount < iFireCount then\n\
			actor:ResetAnimation()\n\
			actor:PlayCurrentSlot(true);\n\
			action:SetParamInt(101, iCurFireCount+1)\n\
--			ODS(\"iCurFireCount : \"..iCurFireCount..\"\\n\", false, 3851)\n\
		elseif curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			action:SetParamInt(101,1)\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Air_Sprash_OnCleanUp(actor)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	ODS(\"RestoreItemModel Air_Sprash_ReallyLeave\\n\");\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Air_Sprash_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==curAction) ) then return true end\n\
	if( CheckNil(curAction:IsNil()) ) then return true end\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	\n\
	if actor:IsMyActor() == false then\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" then \n\
		return false;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then \n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Air_Sprash_OnFindTarget(actor,action,kTargets)\n\
--ODS(\"Air_Sprash_OnFindTarget\\n\", false, 3851)\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end	\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	return	Air_Sprash_OnFindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
end\n\
\n\
function Air_Sprash_OnFindTargetEx(actor,action,iActionID,iAttackRange,kTargets)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	arrow_worldpos = actor:GetPos();\n\
	\n\
--  \n\
	local	kRotateAxis = actor:GetLookingDir();\n\
	kRotateAxis:Cross(Point3(0,0,1));\n\
	kRotateAxis:Unitize();\n\
	local	fRotateAngle = 60.0*3.141592/180.0;\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = 30\n\
	end\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(actor:GetTranslate(),actor:GetLookingDir());\n\
	kParam:SetParam_2(iAttackRange,iParam2,0,0);\n\
	kParam:SetParam_3(true,FTO_BLOWUP);		\n\
\n\
	local	kFireTargetDir = actor:GetLookingDir();\n\
	kFireTargetDir:Rotate(kRotateAxis,fRotateAngle);\n\
	kParam:SetParam_1(arrow_worldpos,kFireTargetDir);\n\
	action:FindTargets(TAT_RAY_DIR,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
\n\
function Air_Sprash_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
    if bIsBefore == false then\n\
		--  hit  \n\
		--    .\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action);\n\
   end\n\
\n\
end\n\
function Air_Sprash_OnEvent(actor,textKey)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		actor:AttachParticleS(3851, \"p_ef_fire\", \"eff_sum_skill_smn_muzz02\", 1.0)\n\
			\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
		\n\
			if bUseTLM then\n\
				--ODS(\"CreateActionTargetList\\n\", false, 3851)\n\
				action:CreateActionTargetList(actor);\n\
				\n\
				if IsSingleMode() then		        \n\
					return;\n\
				else\n\
					local	kTargetList = action:GetTargetList();\n\
					local	iTargetCount = kTargetList:size();\n\
					--ODS(\"iTargetCount : \"..iTargetCount..\"\\n\", false, 3851)\n\
					action:BroadCastTargetListModify(actor:GetPilot());\n\
				end	\n\
			end	\n\
		end \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- spawn\n\
\n\
function Skill_Summon_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Summon_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Summon_OnUpdate(actor, accumTime, frameTime)\n\
	actor:SeeFront(1)\n\
	actorID = actor:GetID()\n\
	action = actor:GetAction()\n\
	animDone = actor:IsAnimationDone()\n\
	currentSlot = action:GetCurrentSlot()\n\
\n\
	if currentSlot == 0 and\n\
		animDone == true then\n\
		actor:PlayNext()\n\
		return false;\n\
	end\n\
	return true\n\
end\n\
function Skill_Summon_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_Summon_OnLeave(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Summon_OnEvent(actor,textKey)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	local kAction = actor:GetAction();\n\
	\n\
	\n\
	if textKey == \"hit\" then\n\
	end\n\
	\n\
	return true\n\
end") );
	m_kContLuaText.push_back(std::string("-- spawn\n\
function Skill_Regain_OnCheckCanEnter(actor, action)\n\
	return SkillFunc_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Skill_Regain_OnEnter(actor, action)\n\
	if SkillFunc_OnEnter(actor, action)  then\n\
		if action:GetActionParam() ~= AP_CASTING then\n\
			Skill_Regain_OnCastingCompleted(actor, action);\n\
		end\n\
		return true\n\
	end\n\
	return false\n\
end\n\
\n\
function Skill_Regain_OnCastingCompleted(actor, action)\n\
	SkillFunc_OnCastingCompleted(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Regain_OnUpdate(actor, accumTime, frameTime)\n\
	return SkillFunc_OnUpdate(actor, actor:GetAction(), accumTime, frameTime)	\n\
end\n\
function Skill_Regain_OnCleanUp(actor, action)\n\
	return SkillFunc_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_Regain_OnTargetListModified(actor, action, bIsBefore)\n\
	return SkillFunc_OnTargetListModified(actor, action, bIsBefore)\n\
end\n\
\n\
function Skill_Regain_OnLeave(actor, action)\n\
	return SkillFunc_OnLeave(actor, action)\n\
end\n\
\n\
function Skill_Regain_OnEvent(actor,textKey)\n\
	return SkillFunc_OnEvent(actor,textKey)\n\
end\n\
\n\
function Skill_Regain_OnFindTarget(actor,action,kTargets)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	CustomUISummoner_TargetList(kTargets)\n\
	return kTargets:size()\n\
end") );
	m_kContLuaText.push_back(std::string("-- spawn\n\
\n\
function Skill_Recall_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Recall_OnEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Recall_OnUpdate(actor, accumTime, frameTime)\n\
	actor:SeeFront(1)\n\
	actorID = actor:GetID()\n\
	action = actor:GetAction()\n\
	animDone = actor:IsAnimationDone()\n\
	currentSlot = action:GetCurrentSlot()\n\
\n\
	if currentSlot == 0 and\n\
		animDone == true then\n\
		actor:PlayNext()\n\
		return false;\n\
	end\n\
	return true\n\
end\n\
function Skill_Recall_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_Recall_OnLeave(actor, action)\n\
	return true\n\
end") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Shout_of_Life_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Shout_of_Life_OnEnter(actor, action)\n\
\n\
	action:CreateActionTargetList(actor, true)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Shout_of_Life_OnUpdate(actor, accumTime, frameTime)\n\
	actor:SeeFront(1)\n\
	actorID = actor:GetID()\n\
	action = actor:GetAction()\n\
	animDone = actor:IsAnimationDone()\n\
	currentSlot = action:GetCurrentSlot()\n\
\n\
	if currentSlot == 0 and\n\
		animDone == true then\n\
		actor:PlayNext()\n\
	else\n\
		return false\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Shout_of_Life_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Shout_of_Life_OnLeave(actor, action)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Nature_Blessing_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Nature_Blessing_OnEnter(actor, action)\n\
\n\
	action:CreateActionTargetList(actor, true)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Nature_Blessing_OnUpdate(actor, accumTime, frameTime)\n\
	actor:SeeFront(1)\n\
	actorID = actor:GetID()\n\
	action = actor:GetAction()\n\
	animDone = actor:IsAnimationDone()\n\
	currentSlot = action:GetCurrentSlot()\n\
\n\
	if currentSlot == 0 and\n\
		animDone == true then\n\
		actor:PlayNext()\n\
	else\n\
		return false\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Nature_Blessing_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Nature_Blessing_OnLeave(actor, action)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("\n\
function Act_Impact_Unsummon_OnCheckCanEnter(actor,action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
\n\
	\n\
	return true\n\
end\n\
\n\
function Act_Impact_Unsummon_OnEnter(actor, action)\n\
\n\
	action:CreateActionTargetList(actor, true)\n\
\n\
	return true\n\
end\n\
\n\
function Act_Impact_Unsummon_OnUpdate(actor, accumTime, frameTime)\n\
	actor:SeeFront(1)\n\
	actorID = actor:GetID()\n\
	action = actor:GetAction()\n\
	animDone = actor:IsAnimationDone()\n\
	currentSlot = action:GetCurrentSlot()\n\
\n\
	if currentSlot == 0 and\n\
		animDone == true then\n\
		actor:PlayNext()\n\
	else\n\
		return false\n\
	end\n\
	return true\n\
end\n\
\n\
function Act_Impact_Unsummon_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Impact_Unsummon_OnLeave(actor, action)\n\
	return true\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- [WEAPON_XML] :        XML .\n\
-- [HIT_SOUND_ID] : HIT     ID\n\
-- [MULTI_HIT_NUM] :   ,  \n\
-- [FIND_TARGET_TYPE] :    : RAY(DEFAULT),BAR,SPHERE\n\
-- [NO_USE_TLM] : Not Use TargetList Modified -> hit      (TRUE,FALSE)\n\
\n\
-- Melee\n\
function Air_Smash_OnCheckCanEnter(actor,action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
	if weapontype == 0 then\n\
		return	false;\n\
	end\n\
	\n\
	if actor:IsMeetFloor() then\n\
		return	false\n\
	end\n\
	\n\
	if actor:GetFloatHeight(70)<70 then\n\
		return	false;	\n\
	end\n\
\n\
	return		true;\n\
	\n\
end\n\
\n\
function Air_Smash_OnCastingCompleted(actor, action)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	action:SetSlot(action:GetCurrentSlot()+1);\n\
	actor:PlayCurrentSlot();\n\
\n\
end\n\
\n\
function Air_Smash_OnEnter(actor, action)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local actionID = action:GetID()\n\
--	local weapontype = actor:GetEquippedWeaponType();\n\
	\n\
--	ODS(\"Air_Smash_OnEnter actionID:\"..actionID..\" GetActionParam:\"..action:GetActionParam()..\"\\n\");\n\
		\n\
	if action:GetActionParam() == AP_CASTING then	--	  .\n\
		return	true;\n\
	end\n\
	\n\
	local iFireCount = action:GetAbil(AT_COUNT);\n\
	--ODS(\"iFireCount : \"..iFireCount..\"\\n\", false, 3851)\n\
	action:SetParamInt(100,iFireCount)			--   \n\
	action:SetParamInt(101,1)					--    ()\n\
		\n\
	Air_Smash_OnCastingCompleted(actor,action);\n\
	\n\
	actor:StopJump()\n\
	actor:FreeMove(true)\n\
	\n\
	return true\n\
end\n\
\n\
function Air_Smash_OnUpdate(actor, accumTime, frameTime)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
--	local actorID = actor:GetID()\n\
	local action = actor:GetAction()\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local animDone = actor:IsAnimationDone()\n\
	local nextActionName = action:GetNextActionName()\n\
--	local actionID = action:GetID();\n\
--	local iComboCount = actor:GetComboCount();\n\
	\n\
	if action:GetParam(1) == \"end\" then\n\
		return	false;\n\
	end\n\
	\n\
	if animDone == true then\n\
	\n\
		local curActionParam = action:GetParam(0)\n\
		local iFireCount = action:GetParamInt(100)\n\
		local iCurFireCount = action:GetParamInt(101)\n\
		\n\
		if iCurFireCount < iFireCount then\n\
			actor:PlayCurrentSlot(true);\n\
			action:SetParamInt(101, iCurFireCount+1)\n\
--			ODS(\"iCurFireCount : \"..iCurFireCount..\"\\n\", false, 3851)\n\
		elseif curActionParam == \"GoNext\" then\n\
			nextActionName = action:GetParam(1);\n\
\n\
			action:SetParam(0, \"null\")\n\
			action:SetParam(1, \"end\")\n\
			action:SetParamInt(101,1)\n\
			\n\
			action:SetNextActionName(nextActionName)\n\
			return false;\n\
		else\n\
		\n\
			action:SetParam(1, \"end\")\n\
			return false\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
\n\
function Air_Smash_OnCleanUp(actor)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	actor:FreeMove(false);\n\
			\n\
--	ODS(\"RestoreItemModel Air_Smash_ReallyLeave\\n\");\n\
	--	 \n\
	if actor:GetAction():GetScriptParam(\"WEAPON_XML\") ~= \"\" then\n\
		actor:RestoreItemModel(ITEM_WEAPON);\n\
	end\n\
\n\
	actor:EndWeaponTrail();\n\
	return true;\n\
end\n\
\n\
function Air_Smash_OnLeave(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local curAction = actor:GetAction();\n\
	\n\
	CheckNil(nil==curAction);\n\
	CheckNil(curAction:IsNil());\n\
	\n\
	local curParam = curAction:GetParam(1)\n\
	local actionID = action:GetID()\n\
	local curActionID = curAction:GetID()\n\
\n\
	if actor:IsMyActor() == false then\n\
		if actionID == \"a_jump\" then\n\
			action:SetSlot(2)\n\
		end\n\
		return true;\n\
	end\n\
	\n\
	if actionID == \"a_jump\" and curParam == \"end\" then \n\
		action:SetSlot(2)\n\
		return true;\n\
	end\n\
	\n\
	if curParam == \"end\" then 	\n\
		return true;\n\
	end\n\
	\n\
	if action:GetActionType()==\"EFFECT\" then\n\
		return true;\n\
	end\n\
	\n\
	if action:GetEnable() == false then\n\
		if curParam == actionID then\n\
			curAction:SetParam(0,\"\");\n\
		end\n\
	end\n\
	\n\
	if action:GetEnable() == true then\n\
		curAction:SetParam(0,\"GoNext\");\n\
		curAction:SetParam(1,actionID);\n\
		return false;\n\
	\n\
	elseif curParam == \"end\" and (actionID == \"a_run_right\" or actionID == \"a_run_left\") then\n\
		return true;\n\
	elseif 	actionID == \"a_idle\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true;\n\
	end\n\
\n\
	return false \n\
end\n\
\n\
function Air_Smash_OnFindTarget(actor,action,kTargets)\n\
	--ODS(\"Air_Smash_OnFindTarget\\n\", false, 3851)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	return	Air_Smash_OnFindTargetEx(actor,action,action:GetActionNo(),iAttackRange,kTargets);\n\
end\n\
\n\
function Air_Smash_OnFindTargetEx(actor,action,iActionID,iAttackRange,kTargets)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	local	kTargetPos = actor:GetLookingDir();\n\
	kTargetPos:Multiply(iAttackRange);\n\
	kTargetPos:Add(actor:GetPos());\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = iAttackRange\n\
	end\n\
	\n\
	--ODS(\"iAttackRange : \"..iAttackRange..\"\\n\", false, 3851)\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,Point3(0,0,-1));\n\
	kParam:SetParam_2(0,0,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	action:FindTargets(TAT_RAY_DIR_COLL_PATH,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
	\n\
end\n\
\n\
function Air_Smash_OnTargetListModified(actor,action,bIsBefore)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
    if bIsBefore == false then\n\
		--  hit  \n\
		--    .\n\
		SkillHelpFunc_DefaultHitOneTime(actor,action);\n\
   end\n\
\n\
end\n\
function Air_Smash_OnEvent(actor,textKey)\n\
	\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
		\n\
	local action = actor:GetAction();\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	if action:GetActionParam() == AP_CASTING then\n\
		return true;\n\
	end\n\
	\n\
	if textKey == \"hit\" or textKey == \"fire\" then\n\
	\n\
		actor:AttachParticleS(3851, \"p_ef_fire\", \"eff_sum_skill_smn_muzz02\", 1.0)\n\
			\n\
		if actor:IsUnderMyControl() then\n\
		\n\
			local	bUseTLM = (action:GetScriptParam(\"NO_USE_TLM\") ~= \"TRUE\");\n\
		\n\
			if bUseTLM then\n\
				action:CreateActionTargetList(actor);\n\
				\n\
				if IsSingleMode() then		        \n\
					return;\n\
				else\n\
					local	kTargetList = action:GetTargetList();\n\
					local	iTargetCount = kTargetList:size();\n\
					--ODS(\"iTargetCount : \"..iTargetCount..\"\\n\", false, 3851)\n\
					action:BroadCastTargetListModify(actor:GetPilot());\n\
				end	\n\
			end	\n\
		end \n\
	end\n\
\n\
	return	true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Sum_Rock_Punch_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Sum_Rock_Punch_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	local	iNewState = -1;\n\
	ODS(\"kState : \"..kState..\"\\n\", false, 1509)\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Sum_Rock_Punch_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(4)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	\n\
			action:SetSlot(3);	--	Finish     Idle  .\n\
		end\n\
\n\
		iNewState = 3;\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
\n\
	return	true;\n\
\n\
end\n\
\n\
function Sum_Rock_Punch_OnEnter(actor, action)\n\
	\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Sum_Rock_Punch_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\",false,6482);\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Sum_Rock_Punch_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Sum_Rock_Punch_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Sum_Rock_Punch_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end\n\
\n\
	end\n\
	\n\
	action:SetParamInt(12,0)\n\
\n\
	return true\n\
end\n\
\n\
function Sum_Rock_Punch_OnCastingCompleted(actor,action)	\n\
\n\
	Sum_Rock_Punch_SetState(actor,action,\"FIRE\")\n\
	\n\
	Sum_Rock_Punch_Fire(actor,action);	\n\
	\n\
end\n\
\n\
function Sum_Rock_Punch_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--	  \n\
	if( CheckNil(g_world == nil) ) then return false end\n\
	if( CheckNil(g_world:IsNil()) ) then return false end\n\
	action:SetParamFloat(10,g_world:GetAccumTime())\n\
	\n\
	--ODS(\"Sum_Rock_Punch_Fire: \"..action:GetParamFloat(10)..\"\\n\",false,6482)\n\
	\n\
	local	effect = actor:GetAnimationInfo(\"FIRE_EFFECT\")\n\
	if nil ~= effect then\n\
		local	node = actor:GetAnimationInfo(\"FIRE_EFFECT_NODE\")\n\
		if nil == node then\n\
			node = \"char_root\"\n\
		end\n\
		if \"NONE\"~=effect then\n\
			actor:AttachParticle(129,node,effect)\n\
		end\n\
	else\n\
		actor:AttachParticle(129,\"char_root\",\"efx_gorgon_rock_punch_02\");\n\
	end\n\
\n\
	local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID)\n\
	end\n\
end\n\
\n\
function Sum_Rock_Punch_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		\n\
		local	fElapsedTime = accumTime - action:GetParamFloat(10)\n\
		local	fTotalTime = action:GetAbil(AT_MAINTENANCE_TIME) / 1000.0\n\
\n\
		--ODS(\"ElapsedTime: \"..fElapsedTime..\", TotalTime: \"..fTotalTime..\"\\n\",false,6482)\n\
		\n\
		if fElapsedTime > fTotalTime then\n\
			\n\
			--ODS(\"Param10: \"..action:GetParamInt(12)..\"\\n\",false,6482)\n\
			\n\
			if 0 == action:GetParamInt(12) then\n\
				if 0 < actor:GetAnimationLength(action:GetSlotAnimName(4)) then	-- \n\
					Sum_Rock_Punch_SetState(actor,action,\"RETURN\")\n\
					action:SetParamInt(12,1)\n\
				else\n\
					return false	--   \n\
				end\n\
			else	-- \n\
				if actor:IsAnimationDone() then\n\
					--ODS(\" \\n\",false,6482)\n\
					return false\n\
				end\n\
			end\n\
		end\n\
\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Sum_Rock_Punch_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
\n\
	end\n\
\n\
	return true\n\
end\n\
function Sum_Rock_Punch_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	actor:DetachFrom(129)\n\
end\n\
\n\
function Sum_Rock_Punch_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Sum_Rock_Punch_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Sum_Rock_Punch_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
			\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
--	if bIsBefore == false then\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --   \n\
\n\
		local QuakeTime = actor:GetAnimationInfo(\"QUAKE_TIME\")\n\
		if nil ~= QuakeTime and \"\" ~= QuakeTime then\n\
			QuakeTime = tonumber(QuakeTime)\n\
			local QuakeFactor = actor:GetAnimationInfo(\"QUAKE_FACTOR\")\n\
			if  nil == QuakeFactor then\n\
				QuakeFactor = 1.0\n\
			else\n\
				QuakeFactor = tonumber(QuakeFactor)\n\
			end\n\
			QuakeCamera(QuakeTime, QuakeFactor)\n\
		end\n\
--	end\n\
\n\
end\n\
\n\
function Sum_Rock_Punch_OnEvent(actor,textKey)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Skill_Sum_Rolling_Attack_OnCheckCanEnter(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_SetState(actor,action,kState)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iNewState = -1;\n\
	ODS(\"kState : \"..kState..\"\\n\", false, 1509)\n\
	if kState == \"BATTLEIDLE_START\" then\n\
	\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(0)) == 0 then\n\
			return	false	\n\
		end\n\
				\n\
		action:SetSlot(0)\n\
		iNewState = 0;\n\
		\n\
		local	effect = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT\", action, 1000205)\n\
		if nil ~= effect then\n\
			local	node = actor:GetAnimationInfoFromAction(\"FIRE_EFFECT_NODE\", action, 1000205)\n\
			if nil == node then\n\
				node = \"char_root\"\n\
			end\n\
		    actor:AttachParticle(129,node,effect)\n\
		end\n\
	\n\
	elseif kState == \"BATTLEIDLE_LOOP\" then\n\
		\n\
		action:SetSlot(1)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(1)) == 0 then\n\
		\n\
			ODS(\"Skill_Sum_Rolling_Attack_SetState SlotName[\"..action:GetSlotAnimName(1)..\"] Not Exist -> SetSlot To Next\\n\");\n\
		\n\
			action:SetSlot(3);	--	 Idle     Idle  .\n\
		end\n\
		iNewState = 1;\n\
		\n\
	elseif kState == \"FIRE\" then\n\
		action:SetSlot(2)\n\
		iNewState = 2;\n\
		\n\
		actor:AttachParticle(586,\"char_root\",\"efx_gorgon_rolling_attack\");	\n\
	elseif kState == \"RETURN\" then\n\
		action:SetSlot(4)\n\
		if actor:GetAnimationLength(action:GetSlotAnimName(4)) == 0 then	\n\
			action:SetSlot(3);	--	Finish     Idle  .\n\
		end\n\
\n\
		iNewState = 3;\n\
		\n\
		actor:DetachFrom(586)\n\
	end\n\
	\n\
	actor:ResetAnimation();\n\
	actor:PlayCurrentSlot();\n\
	action:SetParamInt(0,iNewState)\n\
\n\
	return	true;\n\
\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_OnEnter(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	ODS(\"Skill_Sum_Rolling_Attack_OnEnter actor : \"..actor:GetID()..\" action: \"..action:GetID()..\" ActionParam : \"..action:GetActionParam()..\"\\n\");\n\
\n\
	actor:SetNoWalkingTarget(false)\n\
	actor:FreeMove(true)\n\
	\n\
	local	prevAction = actor:GetAction()\n\
	if( false == prevAction:IsNil() ) then\n\
		if prevAction:GetID() ~= \"a_jump\" then\n\
			actor:Stop()\n\
		end\n\
	end\n\
	\n\
	--	rush target pos\n\
	local	ptTargetPos = 0;\n\
	\n\
	if IsSingleMode() then\n\
		ptTargetPos = GetMyActor():GetPos();\n\
	else\n\
		local	kPacket = action:GetParamAsPacket();\n\
		if kPacket == nil or kPacket:IsNil() then\n\
			ODS(\"[SkillError] Skill_Sum_Rolling_Attack_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\")\n\
			return	false;\n\
		else\n\
			local iTargetNum = kPacket:PopInt()\n\
			for i=0, iTargetNum do\n\
				ptTargetPos = kPacket:PopPoint3()\n\
				if ptTargetPos:IsZero() then\n\
					break\n\
				end\n\
\n\
				action:SetParamAsPoint(20+i,ptTargetPos)\n\
			end\n\
			\n\
			ptTargetPos = action:GetParamAsPoint(20)\n\
		end\n\
	end\n\
\n\
	action:SetParamAsPoint(0,ptTargetPos);\n\
	action:SetParamInt(100,21) --NextTargetPos Index\n\
	actor:ResetAnimation()\n\
	\n\
	if action:GetActionParam() == AP_FIRE then\n\
		Skill_Sum_Rolling_Attack_OnCastingCompleted(actor,action)\n\
	else\n\
	\n\
		if( Skill_Sum_Rolling_Attack_SetState(actor,action,\"BATTLEIDLE_START\") == false) then\n\
			Skill_Sum_Rolling_Attack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
		end	\n\
\n\
		actor:LookAt(ptTargetPos,false,false,true);\n\
		actor:SetMovingDir(actor:GetLookingDir());\n\
\n\
	end\n\
	\n\
	action:SetParamInt(10,0)\n\
\n\
			local pilot = actor:GetPilot()\n\
			if false == pilot:IsNil() then\n\
				pilot:SetGoalPos(Point3(0,0,0))\n\
			end\n\
\n\
	return true\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_OnCastingCompleted(actor,action)	\n\
\n\
	Skill_Sum_Rolling_Attack_SetState(actor,action,\"FIRE\")\n\
	Skill_Sum_Rolling_Attack_Fire(actor,action);	\n\
\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_Fire(actor,action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
	\n\
	--	  \n\
	local	ptTargetPos = action:GetParamAsPoint(0)\n\
	actor:LookAt(ptTargetPos,false,false,true);\n\
	actor:SetMovingDir(actor:GetLookingDir());\n\
\n\
	local	kSoundID = actor:GetAnimationInfo(\"SOUND_ID\")\n\
	if nil~=kSoundID and kSoundID~=\"\" then\n\
		actor:AttachSound(2784,kSoundID)\n\
	end\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_OnUpdate(actor, accumTime, frameTime)\n\
\n\
	if( CheckNil(nil==actor) ) then return false end\n\
	if( CheckNil(actor:IsNil()) ) then return false end\n\
		\n\
	local pilot = actor:GetPilot()\n\
	if false == pilot:IsNil() then\n\
		pilot:SetGoalPos(Point3(0,0,0))\n\
	end\n\
\n\
	local	action = actor:GetAction()\n\
	\n\
	if( CheckNil(nil==action) ) then return false end\n\
	if( CheckNil(action:IsNil()) ) then return false end\n\
	\n\
	local	iState = action:GetParamInt(0)\n\
\n\
	if action:GetActionParam() == AP_FIRE then\n\
\n\
		local	kMovingDir = actor:GetMovingDir()\n\
		local	fMoveSpeed = actor:GetAbil(AT_MOVESPEED)*(1+action:GetAbil(AT_R_MOVESPEED)/10000.0);\n\
		local	ptTargetPos = action:GetParamAsPoint(0)\n\
		local 	bTargetPosZero = ptTargetPos:IsZero()\n\
		local	kCurrentPos = actor:GetPos()\n\
\n\
		local	kCurrentDir = ptTargetPos:_Subtract(kCurrentPos)\n\
		--ODS(\" : \" .. kCurrentDir:Length() .. \"\\n\")\n\
		kCurrentDir:Unitize()\n\
		\n\
		local	fDot = kCurrentDir:Dot(kMovingDir)\n\
		if fDot<0 or bTargetPosZero then\n\
			actor:DetachFrom(129)\n\
			if 0 == action:GetParamInt(10) then\n\
				local iNextTargetIdx = action:GetParamInt(100)\n\
				local ptNextTargetPos = action:GetParamAsPoint( iNextTargetIdx )\n\
				if false==ptNextTargetPos:IsZero() then\n\
					action:SetParamAsPoint(0,ptNextTargetPos)\n\
					action:SetParamInt(100, iNextTargetIdx+1)\n\
					Skill_Sum_Rolling_Attack_OnCastingCompleted(actor,action)\n\
					\n\
					-- ODS(\"Skill_Sum_Rolling_Attack_Fire, X: \"..kDirVector:GetX()..\", Y:\"..kDirVector:GetY()..\", Z:\"..kDirVector:GetZ()..\"\\n\",false,6482)\n\
					return true\n\
				end\n\
				\n\
				if 0 < actor:GetAnimationLength(action:GetSlotAnimName(4)) then	-- \n\
					Skill_Sum_Rolling_Attack_SetState(actor,action,\"RETURN\")\n\
					action:SetParamInt(10,1)\n\
				else\n\
					return false	--   \n\
				end\n\
			else	-- \n\
				if actor:IsAnimationDone() then\n\
					return false\n\
				end\n\
			end\n\
		else\n\
			actor:SetMovingDelta( kMovingDir:_Multiply(fMoveSpeed) );\n\
		end\n\
		\n\
	elseif action:GetActionParam() == AP_CASTING then\n\
 \n\
		local fAddZ = actor:GetAnimationInfo(\"ADD_Z\")\n\
		\n\
		if nil ~= fAddZ then\n\
\n\
			local pos = actor:GetPos()\n\
			fAddZ = tonumber(fAddZ)\n\
			pos:SetZ(pos:GetZ() + fAddZ*frameTime)\n\
			actor:SetTranslate(pos)\n\
		end\n\
		\n\
		if iState == 0 then\n\
			if actor:IsAnimationDone() then\n\
				Skill_Sum_Rolling_Attack_SetState(actor,action,\"BATTLEIDLE_LOOP\")\n\
			end\n\
		end\n\
	\n\
		if IsSingleMode() then\n\
			if accumTime - action:GetActionEnterTime() > action:GetAbil(AT_CAST_TIME)/1000.0 then\n\
			\n\
				action:SetActionParam(AP_FIRE)\n\
				Skill_Sum_Rolling_Attack_OnCastingCompleted(actor,action)\n\
			\n\
			end\n\
		end\n\
	end\n\
\n\
	return true\n\
end\n\
function Skill_Sum_Rolling_Attack_OnCleanUp(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
	\n\
	actor:DetachFrom(129)\n\
	actor:DetachFrom(586)\n\
	actor:FreeMove(false)\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_OnLeave(actor, action)\n\
\n\
	if( CheckNil(nil==actor) ) then return true end\n\
	if( CheckNil(actor:IsNil()) ) then return true end\n\
	\n\
	if( CheckNil(nil==action) ) then return true end\n\
	if( CheckNil(action:IsNil()) ) then return true end\n\
	\n\
	local	kCurAction = actor:GetAction();\n\
	local	actionID = action:GetID()\n\
	ODS(\"Skill_Sum_Rolling_Attack_OnLeave nextaction : \"..actionID..\" CurAction : \"..kCurAction:GetID()..\" CurAction AP:\"..kCurAction:GetActionParam()..\" \\n\");\n\
	if action:GetActionType()==\"EFFECT\" or\n\
		actionID == \"a_freeze\" or\n\
		actionID == \"a_reverse_gravity\" or\n\
		actionID == \"a_blow_up\" or\n\
		actionID == \"a_blow_up_small\" or\n\
		actionID == \"a_knock_back\" or\n\
		actionID == \"a_die\" or\n\
		actionID == \"a_idle\" or\n\
		actionID == \"a_run_right\" or\n\
		actionID == \"a_run_left\" or\n\
		actionID == \"a_handclaps\" then\n\
		return true\n\
	end\n\
	return false \n\
end\n\
function Skill_Sum_Rolling_Attack_OnTargetListModified(actor,action,bIsBefore)\n\
\n\
	if( CheckNil(nil==actor) ) then return end\n\
	if( CheckNil(actor:IsNil()) ) then return end\n\
			\n\
	if( CheckNil(nil==action) ) then return end\n\
	if( CheckNil(action:IsNil()) ) then return end\n\
\n\
	local pilot = actor:GetPilot()\n\
	if false == pilot:IsNil() then\n\
		pilot:SetGoalPos(Point3(0,0,0))\n\
	end\n\
	\n\
--	if bIsBefore == false then\n\
        Actor_Mob_Base_DoDefaultMeleeAttack(actor,action);   --    \n\
--	end\n\
\n\
end\n\
\n\
function Skill_Sum_Rolling_Attack_OnEvent(actor,textKey)\n\
	return true;\n\
end\n\
") );
	m_kContLuaText.push_back(std::string("-- spawn\n\
function Skill_bw_combo_Z_3_2_OnCheckCanEnter(actor, action)\n\
	return SkillFunc_OnCheckCanEnter(actor, action)\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnEnter(actor, action)\n\
	if SkillFunc_OnEnter(actor, action)  then \n\
		if action:GetActionParam() ~= AP_CASTING then\n\
			Skill_bw_combo_Z_3_2_OnCastingCompleted(actor, action);\n\
		end\n\
		return true\n\
	end\n\
	return false\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnCastingCompleted(actor, action)\n\
	SkillFunc_OnCastingCompleted(actor, action)\n\
	return true\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnUpdate(actor, accumTime, frameTime)\n\
	return SkillFunc_OnUpdate(actor, actor:GetAction(), accumTime, frameTime)	\n\
end\n\
function Skill_bw_combo_Z_3_2_OnCleanUp(actor, action)\n\
	return SkillFunc_OnCleanUp(actor, action)\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnTargetListModified(actor, action, bIsBefore)\n\
	return SkillFunc_OnTargetListModified(actor, action, bIsBefore)\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnLeave(actor, action)\n\
	return SkillFunc_OnLeave(actor, action)\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnEvent(actor,textKey)\n\
	return SkillFunc_OnEvent(actor,textKey)\n\
end\n\
\n\
function Skill_bw_combo_Z_3_2_OnFindTarget(actor,action,kTargets)\n\
\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	local	iAttackRange = action:GetSkillRange(0,actor)\n\
	\n\
	local	kTargetPos = actor:GetLookingDir();\n\
	kTargetPos:Multiply(iAttackRange);\n\
	kTargetPos:Add(actor:GetPos());\n\
\n\
	local iParam2 = action:GetAbil(AT_1ST_AREA_PARAM2)\n\
	if 0==iParam2 then\n\
		iParam2 = iAttackRange\n\
	end\n\
\n\
	local kParam = FindTargetParam();\n\
	kParam:SetParam_1(kTargetPos,Point3(0,0,-1));\n\
	kParam:SetParam_2(0,0,iParam2,0);\n\
	kParam:SetParam_3(true,FTO_NORMAL);\n\
	\n\
	action:FindTargets(TAT_RAY_DIR_COLL_PATH,kParam,kTargets,kTargets);\n\
	\n\
	return	kTargets:size();\n\
end") );
	m_kContLuaText.push_back(std::string("-- skill\n\
\n\
function Act_Mon_RegenPointChoose_OnCheckCanEnter(actor, action)\n\
	--if actor:GetAbil(AT_ATTACK_RANGE_C)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_SetState(actor,action,kState)\n\
	return	Act_Mon_Melee_SetState(actor,action,kState)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_OnEnter(actor, action)\n\
	CheckNil(nil==actor);\n\
	CheckNil(actor:IsNil());\n\
	\n\
	CheckNil(nil==action);\n\
	CheckNil(action:IsNil());\n\
	\n\
	ODS(\"Act_Mon_RegenPointChoose_OnEnter : \" .. actor:GetAniSequenceID().. \"\\n\",false,6482)\n\
	local Effect = actor:GetAnimationInfoFromAniName(\"CASTING_EFFECT\",action:GetSlotAnimName(0)):GetStr()\n\
	if \"\" == Effect then\n\
		Effect = \"e_b_palis_skill_03_CylinderBeem\"\n\
	end\n\
	\n\
	local EffectScale = actor:GetAnimationInfoFromAniName(\"CASTING_EFFECT_SCALE\",action:GetSlotAnimName(0)):GetStr()\n\
	if \"\"==EffectScale then\n\
		EffectScale = 1\n\
	else\n\
		EffectScale = tonumber(EffectScale)\n\
	end\n\
	\n\
	if nil~=Effect then\n\
		if action:GetActionParam() ~= AP_FIRE then\n\
			local	ptTargetPos = 0;\n\
			local	kPacket = action:GetParamAsPacket();\n\
			if kPacket == nil or kPacket:IsNil() then\n\
				ODS(\"[SkillError] Act_Mon_RegenPointChoose_OnEnter, kPacket is not valid. actor : \"..actor:GetPilotGuid():GetString()..\" action:\"..action:GetID()..\"\\n\")\n\
				return	false;\n\
			else\n\
				local iTargetNum = kPacket:PopInt()\n\
				for i=0, iTargetNum do\n\
					ptTargetPos = kPacket:PopPoint3()\n\
					if ptTargetPos:IsZero() then\n\
						break\n\
					end\n\
					\n\
					ODS(\"X: \"..ptTargetPos:GetX()..\", Y: \"..ptTargetPos:GetY()..\", Z: \"..ptTargetPos:GetZ()..\", Name: \" .. Effect..\"\\n\",false,6482)\n\
					actor:AttachParticleToPointS(12200+i, ptTargetPos, Effect, EffectScale)\n\
				end\n\
				action:SetParamInt(12200,iTargetNum)\n\
				\n\
				ODS(\"Act_Mon_RegenPointChoose_OnEnter iTargetNum : \".. iTargetNum ..\"\\n\",false,6482)\n\
			end\n\
		end\n\
	end\n\
\n\
	return Act_Mon_Melee_OnEnter(actor, action)	\n\
end\n\
function Act_Mon_RegenPointChoose_OnCastingCompleted(actor,action)	\n\
	Act_Mon_Melee_OnCastingCompleted(actor,action)\n\
	Act_Mon_RegenPointDetachEffect_Casting(actor, action)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_Fire(actor,action)\n\
	Act_Mon_Melee_Fire(actor,action)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_OnUpdate(actor, accumTime, frameTime)\n\
	return Act_Mon_Melee_OnUpdate(actor, accumTime, frameTime)\n\
end\n\
function Act_Mon_RegenPointChoose_OnCleanUp(actor, action)	\n\
	Act_Mon_Melee_OnCleanUp(actor, action)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_OnLeave(actor, action)\n\
\n\
	Act_Mon_RegenPointDetachEffect_Casting(actor, action)\n\
	\n\
	return	Act_Mon_Melee_OnLeave(actor, action)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_DoDamage(actor,action)\n\
	Act_Mon_Melee_DoDamage(actor,action)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_OnEvent(actor,textKey)\n\
	return	Act_Mon_Melee_OnEvent(actor,textKey)\n\
end\n\
\n\
function Act_Mon_RegenPointChoose_OnTargetListModified(actor,action,bIsBefore)\n\
	Act_Mon_Melee_OnTargetListModified(actor,action,bIsBefore)\n\
end\n\
\n\
function Act_Mon_RegenPointDetachEffect_Casting(actor,action)\n\
	local	iTargetNum = action:GetParamInt(12200)\n\
	ODS(\"Act_Mon_RegenPointDetachEffect_Casting : \"..iTargetNum..\"\\n\",false,6482)\n\
	iTargetNum = 10\n\
	for i=0, iTargetNum do\n\
		actor:DetachFrom(12200+i)\n\
	end\n\
end") );

	return true;
}
